,index,file path,licenses,file_comments,comments_extracted,response
0,0,NomosTestfiles/AAL/AAL.txt,AAL,"Attribution Assurance License
Copyright (c) 2002 by AUTHOR
PROFESSIONAL IDENTIFICATION * URL
""PROMOTIONAL SLOGAN FOR AUTHOR'S PROFESSIONAL PRACTICE""

All Rights Reserved
ATTRIBUTION ASSURANCE LICENSE (adapted from the original BSD license)
Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the conditions below are met.
These conditions require a modest attribution to <AUTHOR> (the
""Author""), who hopes that its promotional value may help justify the
thousands of dollars in otherwise billable time invested in writing
this and other freely available, open-source software.

1. Redistributions of source code, in whole or part and with or without
modification (the ""Code""), must prominently display this GPG-signed
text in verifiable form.
2. Redistributions of the Code in binary form must be accompanied by
this GPG-signed text in any documentation and, each time the resulting
executable program or a program dependent thereon is launched, a
prominent display (e.g., splash screen or banner text) of the Author's
attribution information, which includes:
(a) Name (""AUTHOR""),
(b) Professional identification (""PROFESSIONAL IDENTIFICATION""), and
(c) URL (""URL"").
3. Neither the name nor any trademark of the Author may be used to
endorse or promote products derived from this software without specific
prior written permission.
4. Users are entirely responsible, to the exclusion of the Author and
any other persons, for compliance with (1) regulations set by owners or
administrators of employed equipment, (2) licensing terms of any other
software, and (3) local regulations regarding use, including those
regarding import, export, and use of encryption software.

THIS FREE SOFTWARE IS PROVIDED BY THE AUTHOR ""AS IS"" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO
EVENT SHALL THE AUTHOR OR ANY CONTRIBUTOR BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
EFFECTS OF UNAUTHORIZED OR MALICIOUS NETWORK ACCESS;
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN
IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
--End of License
",False,"```
ATTRIBUTION ASSURANCE LICENSE (adapted from the original BSD license)
Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the conditions below are met.
These conditions require a modest attribution to <AUTHOR> (the
""Author""), who hopes that its promotional value may help justify the
thousands of dollars in otherwise billable time invested in writing
this and other freely available, open-source software.

1. Redistributions of source code, in whole or part and with or without
modification (the ""Code""), must prominently display this GPG-signed
text in verifiable form.
2. Redistributions of the Code in binary form must be accompanied by
this GPG-signed text in any documentation and, each time the resulting
executable program or a program dependent thereon is launched, a
prominent display (e.g., splash screen or banner text) of the Author's
attribution information, which includes:
(a) Name (""AUTHOR""),
(b) Professional identification (""PROFESSIONAL IDENTIFICATION""), and
(c) URL (""URL"").
3. Neither the name nor any trademark of the Author may be used to
endorse or promote products derived from this software without specific
prior written permission.
4. Users are entirely responsible, to the exclusion of the Author and
any other persons, for compliance with (1) regulations set by owners or
administrators of employed equipment, (2) licensing terms of any other
software, and (3) local regulations regarding use, including those
regarding import, export, and use of encryption software.

THIS FREE SOFTWARE IS PROVIDED BY THE AUTHOR ""AS IS"" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO
EVENT SHALL THE AUTHOR OR ANY CONTRIBUTOR BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
EFFECTS OF UNAUTHORIZED OR MALICIOUS NETWORK ACCESS;
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN
IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
--End of License
```"
1,1,NomosTestfiles/AAL/LICENSE,AAL,"Copyright (c) 2007 - 2010 by Arslan Hassan et al
CLIPBUCKET * http://clip-bucket.com
""A way to broadcast yourself - free and opensource video sharing website script""

All Rights Reserved
ATTRIBUTION ASSURANCE LICENSE (adapted from the original BSD license)
Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the conditions below are met.
These conditions require a modest attribution to <AUTHOR> (the
""Arslan Hassan""), who hopes that its promotional value may help justify the
thousands of dollars in otherwise billable time invested in writing
this and other freely available, open-source software.

1. Redistributions of source code, in whole or part and with or without
modification (the ""Code""), must prominently display this GPG-signed
text in verifiable form.
2. Redistributions of the Code in binary form must be accompanied by
this GPG-signed text in any documentation and, each time the resulting
executable program or a program dependent thereon is launched, a
prominent display (e.g., splash screen or banner text) of the Author's
attribution information, which includes:
(a) Name (""Arslan Hassan""),
(b) Professional identification (""ClipBucket""), and
(c) URL (""http://clip-bucket.com"").
3. Neither the name nor any trademark of the Author may be used to
endorse or promote products derived from this software without specific
prior written permission.
4. Users are entirely responsible, to the exclusion of the Author and
any other persons, for compliance with (1) regulations set by owners or
administrators of employed equipment, (2) licensing terms of any other
software, and (3) local regulations regarding use, including those
regarding import, export, and use of encryption software.

THIS FREE SOFTWARE IS PROVIDED BY THE AUTHOR ""AS IS"" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO
EVENT SHALL THE AUTHOR OR ANY CONTRIBUTOR BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
EFFECTS OF UNAUTHORIZED OR MALICIOUS NETWORK ACCESS;
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN
IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
",False,"```
ATTRIBUTION ASSURANCE LICENSE (adapted from the original BSD license)
Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the conditions below are met.
These conditions require a modest attribution to <AUTHOR> (the
""Arslan Hassan""), who hopes that its promotional value may help justify the
thousands of dollars in otherwise billable time invested in writing
this and other freely available, open-source software.

1. Redistributions of source code, in whole or part and with or without
modification (the ""Code""), must prominently display this GPG-signed
text in verifiable form.
2. Redistributions of the Code in binary form must be accompanied by
this GPG-signed text in any documentation and, each time the resulting
executable program or a program dependent thereon is launched, a
prominent display (e.g., splash screen or banner text) of the Author's
attribution information, which includes:
(a) Name (""Arslan Hassan""),
(b) Professional identification (""ClipBucket""), and
(c) URL (""http://clip-bucket.com"").
3. Neither the name nor any trademark of the Author may be used to
endorse or promote products derived from this software without specific
prior written permission.
4. Users are entirely responsible, to the exclusion of the Author and
any other persons, for compliance with (1) regulations set by owners or
administrators of employed equipment, (2) licensing terms of any other
software, and (3) local regulations regarding use, including those
regarding import, export, and use of encryption software.

THIS FREE SOFTWARE IS PROVIDED BY THE AUTHOR ""AS IS"" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO
EVENT SHALL THE AUTHOR OR ANY CONTRIBUTOR BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
EFFECTS OF UNAUTHORIZED OR MALICIOUS NETWORK ACCESS;
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN
IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
2,2,NomosTestfiles/Abstyles/Abstyles.txt,Abstyles,"This is APREAMBL.TEX, version 1.10e, written by Hans-Hermann Bode 
(HHBODE@DOSUNI1.BITNET), for the BibTeX `adaptable' family, version 1.10. 
See the file APREAMBL.DOC for a detailed documentation.  

This program is distributed WITHOUT ANY WARRANTY, express or implied.  

Copyright (C) 1991, 1992 Hans-Hermann Bode  

Permission is granted to make and distribute verbatim copies of this document provided that the copyright notice and this permission notice are preserved on all copies.  

Permission is granted to copy and distribute modified versions of this document under the conditions for verbatim copying, provided that the entire resulting derived work is distributed under the terms of a permission notice identical to this one.
",False,"```
This program is distributed WITHOUT ANY WARRANTY, express or implied.  

Copyright (C) 1991, 1992 Hans-Hermann Bode  

Permission is granted to make and distribute verbatim copies of this document provided that the copyright notice and this permission notice are preserved on all copies.  

Permission is granted to copy and distribute modified versions of this document under the conditions for verbatim copying, provided that the entire resulting derived work is distributed under the terms of a permission notice identical to this one. 
```"
3,3,NomosTestfiles/ACAA/c32001a.ada,"Govt-rights
UnclassifiedLicense","-- C32001A.ADA

--                             Grant of Unlimited Rights
--
--     Under contracts F33600-87-D-0337, F33600-84-D-0280, MDA903-79-C-0687,
--     F08630-91-C-0015, and DCA100-97-D-0025, the U.S. Government obtained 
--     unlimited rights in the software and documentation contained herein.
--     Unlimited rights are defined in DFAR 252.227-7013(a)(19).  By making 
--     this public release, the Government intends to confer upon all 
--     recipients unlimited rights  equal to those held by the Government.  
--     These rights include rights to use, duplicate, release or disclose the 
--     released technical data and computer software in whole or in part, in 
--     any manner and for any purpose whatsoever, and to have or permit others 
--     to do so.
--
--                                    DISCLAIMER
--
--     ALL MATERIALS OR INFORMATION HEREIN RELEASED, MADE AVAILABLE OR
--     DISCLOSED ARE AS IS.  THE GOVERNMENT MAKES NO EXPRESS OR IMPLIED 
--     WARRANTY AS TO ANY MATTER WHATSOEVER, INCLUDING THE CONDITIONS OF THE
--     SOFTWARE, DOCUMENTATION OR OTHER INFORMATION RELEASED, MADE AVAILABLE 
--     OR DISCLOSED, OR THE OWNERSHIP, MERCHANTABILITY, OR FITNESS FOR A
--     PARTICULAR PURPOSE OF SAID MATERIAL.
--*
-- CHECK THAT IN MULTIPLE OBJECT DECLARATIONS FOR SCALAR TYPES, THE 
-- SUBTYPE INDICATION AND THE INITIALIZATION EXPRESSIONS ARE EVALUATED
-- ONCE FOR EACH NAMED OBJECT THAT IS DECLARED AND THE SUBTYPE 
-- INDICATION IS EVALUATED FIRST.  ALSO, CHECK THAT THE EVALUATIONS 
-- YIELD THE SAME RESULT AS A SEQUENCE OF SINGLE OBJECT DECLARATIONS.

-- RJW 7/16/86

WITH REPORT; USE REPORT;

PROCEDURE C32001A IS

     BUMP : ARRAY (1 .. 8) OF INTEGER := (OTHERS => 0);

     FUNCTION F (I : INTEGER) RETURN INTEGER IS
     BEGIN
          BUMP (I) := BUMP (I) + 1;
          RETURN BUMP (I);
     END F;
          
BEGIN
     TEST (""C32001A"", ""CHECK THAT IN MULTIPLE OBJECT DECLARATION "" & 
                      ""FOR SCALAR TYPES, THE SUBTYPE INDICATION "" & 
                      ""AND THE INITIALIZATION EXPRESSIONS ARE "" &
                      ""EVALUATED ONCE FOR EACH NAMED OBJECT THAT "" &
                      ""IS DECLARED AND THE SUBTYPE INDICATION IS "" &
                      ""EVALUATED FIRST.  ALSO, CHECK THAT THE "" &
                      ""EVALUATIONS YIELD THE SAME RESULT AS A "" &
                      ""SEQUENCE OF SINGLE OBJECT DECLARATIONS"" );
     
     DECLARE

          TYPE DAY IS (MON, TUES, WED, THURS, FRI);
          D1, D2   : DAY 
                     RANGE MON .. DAY'VAL (F (1)) :=
                     DAY'VAL (F (1) - 1);
          CD1, CD2 : CONSTANT DAY 
                     RANGE MON .. DAY'VAL (F (2)) :=
                     DAY'VAL (F (2) - 1);

          I1, I2   : INTEGER RANGE 0 .. F (3) :=
                     F (3) - 1;
          CI1, CI2 : CONSTANT INTEGER RANGE 0 .. F (4) 
                     := F (4) - 1;

          TYPE FLT IS DIGITS 3 RANGE -5.0 .. 5.0;
          FL1, FL2   : FLT RANGE 0.0 .. FLT (F (5)) :=
                       FLT (F (5) - 1);
          CFL1, CFL2 : CONSTANT FLT 
                       RANGE 0.0 .. FLT (F (6)) := 
                       FLT (F (6) - 1);

          TYPE FIX IS DELTA 1.0 RANGE -5.0 .. 5.0;
          FI1, FI2   : FIX RANGE 0.0 .. FIX (F (7)) :=
                       FIX (F (7) - 1);
          CFI1, CFI2 : CONSTANT FIX 
                       RANGE 0.0 .. FIX (F (8)) := 
                       FIX (F (8) - 1);

     BEGIN
          IF D1 /= TUES THEN 
               FAILED ( ""D1 NOT INITIALIZED TO CORRECT VALUE"" );
          END IF;

          IF D2 /= THURS THEN 
               FAILED ( ""D2 NOT INITIALIZED TO CORRECT VALUE"" );
          END IF;

          IF CD1 /= TUES THEN 
               FAILED ( ""CD1 NOT INITIALIZED TO CORRECT VALUE"" );
          END IF;

          IF CD2 /= THURS THEN 
               FAILED ( ""CD2 NOT INITIALIZED TO CORRECT VALUE"" );
          END IF;

          IF I1 /= 1 THEN 
               FAILED ( ""I1 NOT INITIALIZED TO CORRECT VALUE"" );
          END IF;

          IF I2 /= 3 THEN 
               FAILED ( ""I2 NOT INITIALIZED TO CORRECT VALUE"" );
          END IF;

          IF CI1 /= 1 THEN 
               FAILED ( ""CI1 NOT INITIALIZED TO CORRECT VALUE"" );
          END IF;

          IF CI2 /= 3 THEN 
               FAILED ( ""CI2 NOT INITIALIZED TO CORRECT VALUE"" );
          END IF;

          IF FL1 /= 1.0 THEN 
               FAILED ( ""FL1 NOT INITIALIZED TO CORRECT VALUE"" );
          END IF;

          IF FL2 /= 3.0 THEN 
               FAILED ( ""FL2 NOT INITIALIZED TO CORRECT VALUE"" );
          END IF;

          IF CFL1 /= 1.0 THEN 
               FAILED ( ""CFL1 NOT INITIALIZED TO CORRECT VALUE"" );
          END IF;

          IF CFL2 /= 3.0 THEN 
               FAILED ( ""CFL2 NOT INITIALIZED TO CORRECT VALUE"" );
          END IF;

          IF FI1 /= 1.0 THEN 
               FAILED ( ""FI1 NOT INITIALIZED TO CORRECT VALUE"" );
          END IF;

          IF FI2 /= 3.0 THEN 
               FAILED ( ""FI2 NOT INITIALIZED TO CORRECT VALUE"" );
          END IF;

          IF CFI1 /= 1.0 THEN 
               FAILED ( ""CFI1 NOT INITIALIZED TO CORRECT VALUE"" );
          END IF;

          IF CFI2 /= 3.0 THEN 
               FAILED ( ""CFI2 NOT INITIALIZED TO CORRECT VALUE"" );
          END IF;

     END;

     RESULT;
END C32001A;
",False,"```
--                             Grant of Unlimited Rights
--
--     Under contracts F33600-87-D-0337, F33600-84-D-0280, MDA903-79-C-0687,
--     F08630-91-C-0015, and DCA100-97-D-0025, the U.S. Government obtained 
--     unlimited rights in the software and documentation contained herein.
--     Unlimited rights are defined in DFAR 252.227-7013(a)(19).  By making 
--     this public release, the Government intends to confer upon all 
--     recipients unlimited rights  equal to those held by the Government.  
--     These rights include rights to use, duplicate, release or disclose the 
--     released technical data and computer software in whole or in part, in 
--     any manner and for any purpose whatsoever, and to have or permit others 
--     to do so.
--
--                                    DISCLAIMER
--
--     ALL MATERIALS OR INFORMATION HEREIN RELEASED, MADE AVAILABLE OR
--     DISCLOSED ARE AS IS.  THE GOVERNMENT MAKES NO EXPRESS OR IMPLIED 
--     WARRANTY AS TO ANY MATTER WHATSOEVER, INCLUDING THE CONDITIONS OF THE
--     SOFTWARE, DOCUMENTATION OR OTHER INFORMATION RELEASED, MADE AVAILABLE 
--     OR DISCLOSED, OR THE OWNERSHIP, MERCHANTABILITY, OR FITNESS FOR A
--     PARTICULAR PURPOSE OF SAID MATERIAL.
```"
4,4,NomosTestfiles/ACE/ACE-copying.html,ACE,"<HTML>

<HEAD>
<TITLE>Copyright and Licensing Information for ACE, TAO, CIAO, DAnCE, and CoSMIC</TITLE>

<BODY text = ""#000000""
link=""#000fff""
vlink=""#ff0f0f""
bgcolor=""#ffffff"">

<HR>

<H3>Copyright and Licensing Information for ACE<sup><font
size=-2>(TM)</font></sup>, TAO<sup><font
size=-2>(TM)</font></sup>, CIAO<sup><font
size=-2>(TM)</font></sup>, DAnCE<sup><font
size=-2>(TM)</font></sup>, and
CoSMIC<sup><font
size=-2>(TM)</font></sup></H3>

<A HREF=""http://www.cs.wustl.edu/~schmidt/ACE.html"">ACE</a><sup><font
size=-2>(TM)</font></sup>, <A
HREF=""http://www.cs.wustl.edu/~schmidt/TAO.html"">TAO</A><sup><font
size=-2>(TM)</font></sup>, <A
HREF=""http://www.dre.vanderbilt.edu/CIAO/"">CIAO</A><sup><font
size=-2>(TM)</font></sup>, DAnCE><sup><font size=-2>(TM)</font></sup>,
and
 <A HREF=""http://www.dre.vanderbilt.edu/cosmic/"">CoSMIC</A><sup><font
size=-2>(TM)</font></sup> (henceforth referred to as ""DOC software"")
are copyrighted by <A
HREF=""http://www.dre.vanderbilt.edu/~schmidt/"">Douglas C. Schmidt</A>
and his <a
HREF=""http://www.cs.wustl.edu/~schmidt/ACE-members.html"">research
group</a> at <A HREF=""http://www.wustl.edu/"">Washington
University</A>, <A HREF=""http://www.uci.edu"">University of California,
Irvine</A>, and <A HREF=""http://www.vanderbilt.edu"">Vanderbilt
University</A>, Copyright (c) 1993-2009, all rights reserved.  Since
DOC software is open-source, freely available software, you are free
to use, modify, copy, and distribute--perpetually and irrevocably--the
DOC software source code and object code produced from the source, as
well as copy and distribute modified versions of this software.  You
must, however, include this copyright statement along with any code
built using DOC software that you release.  No copyright statement
needs to be provided if you just ship binary executables of your
software products. <P>

You can use DOC software in commercial and/or binary software releases
and are under no obligation to redistribute any of your source code
that is built using DOC software.  Note, however, that you may not
misappropriate the DOC software code, such as copyrighting it yourself
or claiming authorship of the DOC software code, in a way that will
prevent DOC software from being distributed freely using an
open-source development model.  You needn't inform anyone that you're
using DOC software in your software, though we encourage you to let <A
HREF=""mailto:doc_group@cs.wustl.edu"">us</a> know so we can promote
your project in the <A
HREF=""http://www.cs.wustl.edu/~schmidt/ACE-users.html"">DOC software
success stories</A>. <P>

The <A HREF=""http://www.cs.wustl.edu/~schmidt/ACE.html"">ACE</A>, <A
HREF=""http://www.cs.wustl.edu/~schmidt/TAO.html"">TAO</A>, <A
HREF=""http://www.dre.vanderbilt.edu/CIAO/"">CIAO</A>, <A
HREF=""http://www.dre.vanderbilt.edu/~schmidt/DOC_ROOT/DAnCE/"">DAnCE</A>,
and <A HREF=""http://www.dre.vanderbilt.edu/cosmic/"">CoSMIC</A> web
sites are maintained by the <A
HREF=""http://www.dre.vanderbilt.edu/"">DOC Group</A> at the <A
HREF=""http://www.isis.vanderbilt.edu/"">Institute for Software
Integrated Systems</A> (ISIS) and the <A
HREF=""http://www.cs.wustl.edu/~schmidt/doc-center.html"">Center for
Distributed Object Computing</A> of Washington University, St. Louis
for the development of open-source software as part of the open-source
software community.

Submissions are provided by the submitter ``as is'' with no warranties
whatsoever, including any warranty of merchantability, noninfringement
of third party intellectual property, or fitness for any particular
purpose.  In no event shall the submitter be liable for any direct,
indirect, special, exemplary, punitive, or consequential damages,
including without limitation, lost profits, even if advised of the
possibility of such damages.  Likewise, DOC software is provided as is
with no warranties of any kind, including the warranties of design,
merchantability, and fitness for a particular purpose,
noninfringement, or arising from a course of dealing, usage or trade
practice.  Washington University, UC Irvine, Vanderbilt University,
their employees, and students shall have no liability with respect to
the infringement of copyrights, trade secrets or any patents by DOC
software or any part thereof.  Moreover, in no event will Washington
University, UC Irvine, or Vanderbilt University, their employees, or
students be liable for any lost revenue or profits or other special,
indirect and consequential damages. <P>

DOC software is provided with no support and without any obligation on
the part of Washington University, UC Irvine, Vanderbilt University,
their employees, or students to assist in its use, correction,
modification, or enhancement.  A <A
HREF=""http://www.cs.wustl.edu/~schmidt/commercial-support.html"">number
of companies</A> around the world provide commercial support for DOC
software, however.  

DOC software is Y2K-compliant, as long as the underlying OS platform
is Y2K-compliant.  Likewise, DOC software is compliant with the new US
daylight savings rule passed by Congress as ""The Energy Policy Act of
2005,"" which established new daylight savings times (DST) rules for
the United States that expand DST as of March 2007.  Since DOC
software obtains time/date and calendaring information from operating
systems users will not be affected by the new DST rules as long as
they upgrade their operating systems accordingly. <P>

The names ACE</a><sup><font size=-2>(TM)</font></sup>,
TAO</a><sup><font size=-2>(TM)</font></sup>, CIAO</a><sup><font
size=-2>(TM)</font></sup>, DAnCE</a><sup><font
size=-2>(TM)</font></sup>, CoSMIC</a><sup><font
size=-2>(TM)</font></sup>, Washington University, UC Irvine, and
Vanderbilt University, may not be used to endorse or promote products
or services derived from this source without express written
permission from Washington University, UC Irvine, or Vanderbilt
University.  This license grants no permission to call products or
services derived from this source ACE</a><sup><font
size=-2>(TM)</font></sup>, TAO</a><sup><font
size=-2>(TM)</font></sup>, CIAO</a><sup><font
size=-2>(TM)</font></sup>, DAnCE</a><sup><font
size=-2>(TM)</font></sup>, or CoSMIC</a><sup><font
size=-2>(TM)</font></sup>, nor does it grant permission for the name
Washington University, UC Irvine, or Vanderbilt University to appear
in their names. <P>

If you have any suggestions, additions, comments, or questions, please
let <A HREF=""mailto:d.schmidt@vanderbilt.edu"">me</a> know.  <P>

<A HREF=""http://www.dre.vanderbilt.edu/~schmidt/"">Douglas C. Schmidt</A><P>

<HR><P>
Back to the <A HREF=""http://www.cs.wustl.edu/ACE.html"">ACE</A> home page.

</BODY>
</HTML>
",False,"```
Copyright (c) 1993-2009, all rights reserved.  Since
DOC software is open-source, freely available software, you are free
to use, modify, copy, and distribute--perpetually and irrevocably--the
DOC software source code and object code produced from the source, as
well as copy and distribute modified versions of this software.  You
must, however, include this copyright statement along with any code
built using DOC software that you release.  No copyright statement
needs to be provided if you just ship binary executables of your
software products. 

You can use DOC software in commercial and/or binary software releases
and are under no obligation to redistribute any of your source code
that is built using DOC software.  Note, however, that you may not
misappropriate the DOC software code, such as copyrighting it yourself
or claiming authorship of the DOC software code, in a way that will
prevent DOC software from being distributed freely using an
open-source development model.  You needn't inform anyone that you're
using DOC software in your software, though we encourage you to let <A
HREF=""mailto:doc_group@cs.wustl.edu"">us</a> know so we can promote
your project in the <A
HREF=""http://www.cs.wustl.edu/~schmidt/ACE-users.html"">DOC software
success stories</A>. 
```"
5,5,NomosTestfiles/Adobe/Adobe-2006.txt,Adobe-2006,"Adobe Systems Incorporated(r) Source Code License Agreement
Copyright(c) 2006 Adobe Systems Incorporated. All rights reserved.

Please read this Source Code License Agreement carefully before using
the source code.

Adobe Systems Incorporated grants to you a perpetual, worldwide, non-exclusive,
no-charge, royalty-free, irrevocable copyright license, to reproduce,
prepare derivative works of, publicly display, publicly perform, and
distribute this source code and such derivative works in source or
object code form without any attribution requirements.

The name ""Adobe Systems Incorporated"" must not be used to endorse or promote products derived from the source code without prior written permission.

You agree to indemnify, hold harmless and defend Adobe Systems Incorporated from and against any loss, damage, claims or lawsuits, including attorney's fees that arise or result from your use or distribution of the source code.

THIS SOURCE CODE IS PROVIDED ""AS IS"" AND ""WITH ALL FAULTS"", WITHOUT
ANY TECHNICAL SUPPORT OR ANY EXPRESSED OR IMPLIED WARRANTIES, INCLUDING,
BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
FOR A PARTICULAR PURPOSE ARE DISCLAIMED. ALSO, THERE IS NO WARRANTY OF
NON-INFRINGEMENT, TITLE OR QUIET ENJOYMENT. IN NO EVENT SHALL MACROMEDIA
OR ITS SUPPLIERS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOURCE CODE, EVEN IF
ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

",False,"```
Adobe Systems Incorporated(r) Source Code License Agreement
Copyright(c) 2006 Adobe Systems Incorporated. All rights reserved.

Please read this Source Code License Agreement carefully before using
the source code.

Adobe Systems Incorporated grants to you a perpetual, worldwide, non-exclusive,
no-charge, royalty-free, irrevocable copyright license, to reproduce,
prepare derivative works of, publicly display, publicly perform, and
distribute this source code and such derivative works in source or
object code form without any attribution requirements.

The name ""Adobe Systems Incorporated"" must not be used to endorse or promote products derived from the source code without prior written permission.

You agree to indemnify, hold harmless and defend Adobe Systems Incorporated from and against any loss, damage, claims or lawsuits, including attorney's fees that arise or result from your use or distribution of the source code.

THIS SOURCE CODE IS PROVIDED ""AS IS"" AND ""WITH ALL FAULTS"", WITHOUT
ANY TECHNICAL SUPPORT OR ANY EXPRESSED OR IMPLIED WARRANTIES, INCLUDING,
BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
FOR A PARTICULAR PURPOSE ARE DISCLAIMED. ALSO, THERE IS NO WARRANTY OF
NON-INFRINGEMENT, TITLE OR QUIET ENJOYMENT. IN NO EVENT SHALL MACROMEDIA
OR ITS SUPPLIERS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOURCE CODE, EVEN IF
ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
6,6,NomosTestfiles/Adobe/AdobeAFM.txt,APAFML,"            Adobe Core 35 AFM Files with 314 Glyph Entries - ReadMe

   This file and the 35 PostScript(R) AFM files it accompanies may be
   used, copied, and distributed for any purpose and without charge, with
   or without modification, provided that all copyright notices are
   retained; that the AFM files are not distributed without this file;
   that all modifications to this file or any of the AFM files are
   prominently noted in the modified file(s); and that this paragraph is
   not modified. Adobe Systems has no responsibility or obligation to
   support the use of the AFM files.
",False,"```
   This file and the 35 PostScript(R) AFM files it accompanies may be
   used, copied, and distributed for any purpose and without charge, with
   or without modification, provided that all copyright notices are
   retained; that the AFM files are not distributed without this file;
   that all modifications to this file or any of the AFM files are
   prominently noted in the modified file(s); and that this paragraph is
   not modified. Adobe Systems has no responsibility or obligation to
   support the use of the AFM files.
```"
7,7,NomosTestfiles/Adobe/Adobe_a.txt,MIT-style,"(c) Copyright 1993-1994 Adobe Systems Incorporated.
All rights reserved.

Permission to use, copy, modify, distribute, and sublicense this software
and its documentation for any purpose and without fee is hereby granted,
provided that the above copyright notices appear in all copies and that
both those copyright notices and this permission notice appear in
supporting documentation and that the name of Adobe Systems Incorporated
not be used in advertising or publicity pertaining to distribution of the
software without specific, written prior permission. No trademark license
to use the Adobe trademarks is hereby granted. If the Adobe trademark
""Display PostScript""(tm) is used to describe this software, its
functionality or for any other purpose, such use shall be limited to a
statement that this software works in conjunction with the Display
PostScript system. Proper trademark attribution to reflect Adobe's
ownership of the trademark shall be given whenever any such reference to
the Display PostScript system is made.

ADOBE MAKES NO REPRESENTATIONS ABOUT THE SUITABILITY OF THE SOFTWARE FOR
ANY PURPOSE. IT IS PROVIDED ""AS IS"" WITHOUT EXPRESS OR IMPLIED WARRANTY.
ADOBE DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING ALL
IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NON- INFRINGEMENT OF THIRD PARTY RIGHTS. IN NO EVENT SHALL ADOBE BE LIABLE
TO YOU OR ANY OTHER PARTY FOR ANY SPECIAL, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER WHETHER IN AN ACTION OF CONTRACT,
NEGLIGENCE, STRICT LIABILITY OR ANY OTHER ACTION ARISING OUT OF OR IN
CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. ADOBE WILL NOT
PROVIDE ANY TRAINING OR OTHER SUPPORT FOR THE SOFTWARE.

Adobe, PostScript, and Display PostScript are trademarks of Adobe Systems
Incorporated which may be registered in certain jurisdictions
",False,"```
(c) Copyright 1993-1994 Adobe Systems Incorporated.
All rights reserved.

Permission to use, copy, modify, distribute, and sublicense this software
and its documentation for any purpose and without fee is hereby granted,
provided that the above copyright notices appear in all copies and that
both those copyright notices and this permission notice appear in
supporting documentation and that the name of Adobe Systems Incorporated
not be used in advertising or publicity pertaining to distribution of the
software without specific, written prior permission. No trademark license
to use the Adobe trademarks is hereby granted. If the Adobe trademark
""Display PostScript""(tm) is used to describe this software, its
functionality or for any other purpose, such use shall be limited to a
statement that this software works in conjunction with the Display
PostScript system. Proper trademark attribution to reflect Adobe's
ownership of the trademark shall be given whenever any such reference to
the Display PostScript system is made.

ADOBE MAKES NO REPRESENTATIONS ABOUT THE SUITABILITY OF THE SOFTWARE FOR
ANY PURPOSE. IT IS PROVIDED ""AS IS"" WITHOUT EXPRESS OR IMPLIED WARRANTY.
ADOBE DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING ALL
IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NON- INFRINGEMENT OF THIRD PARTY RIGHTS. IN NO EVENT SHALL ADOBE BE LIABLE
TO YOU OR ANY OTHER PARTY FOR ANY SPECIAL, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER WHETHER IN AN ACTION OF CONTRACT,
NEGLIGENCE, STRICT LIABILITY OR ANY OTHER ACTION ARISING OUT OF OR IN
CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. ADOBE WILL NOT
PROVIDE ANY TRAINING OR OTHER SUPPORT FOR THE SOFTWARE.

Adobe, PostScript, and Display PostScript are trademarks of Adobe Systems
Incorporated which may be registered in certain jurisdictions
```"
8,8,NomosTestfiles/Adobe/Adobe_b.txt,HPND-sell-variant,"Copyright 1984-1989, 1994 Adobe Systems Incorporated.
Copyright 1988, 1994 Digital Equipment Corporation.

Adobe is a trademark of Adobe Systems Incorporated which may be
registered in certain jurisdictions.
Permission to use these trademarks is hereby granted only in
association with the images described in this file.

Permission to use, copy, modify, distribute and sell this software
and its documentation for any purpose and without fee is hereby
granted, provided that the above copyright notices appear in all
copies and that both those copyright notices and this permission
notice appear in supporting documentation, and that the names of
Adobe Systems and Digital Equipment Corporation not be used in
advertising or publicity pertaining to distribution of the software
without specific, written prior permission. Adobe Systems and
Digital Equipment Corporation make no representations about the
suitability of this software for any purpose. It is provided ""as
is"" without express or implied warranty.
",False,"```
Copyright 1984-1989, 1994 Adobe Systems Incorporated.
Copyright 1988, 1994 Digital Equipment Corporation.

Adobe is a trademark of Adobe Systems Incorporated which may be
registered in certain jurisdictions.
Permission to use these trademarks is hereby granted only in
association with the images described in this file.

Permission to use, copy, modify, distribute and sell this software
and its documentation for any purpose and without fee is hereby
granted, provided that the above copyright notices appear in all
copies and that both those copyright notices and this permission
notice appear in supporting documentation, and that the names of
Adobe Systems and Digital Equipment Corporation not be used in
advertising or publicity pertaining to distribution of the software
without specific, written prior permission. Adobe Systems and
Digital Equipment Corporation make no representations about the
suitability of this software for any purpose. It is provided ""as
is"" without express or implied warranty. 
```"
9,9,NomosTestfiles/Adobe/Adobe-DNG.txt,Adobe-DNG,"DNG SDK License Agreement
NOTICE TO USER:
Adobe Systems Incorporated provides the Software and Documentation for use under
the terms of this Agreement. Any download, installation, use, reproduction,
modification or distribution of the Software or Documentation, or any
derivatives or portions thereof, constitutes your acceptance of this Agreement.

As used in this Agreement, ""Adobe"" means Adobe Systems Incorporated. ""Software""
means the software code, in any format, including sample code and source code,
accompanying this Agreement. ""Documentation"" means the documents, specifications
and all other items accompanying this Agreement other than the Software.

1. LICENSE GRANT
Software License. Subject to the restrictions below and other terms of this
Agreement, Adobe hereby grants you a non-exclusive, worldwide, royalty free
license to use, reproduce, prepare derivative works from, publicly display,
publicly perform, distribute and sublicense the Software for any purpose.

Document License. Subject to the terms of this Agreement, Adobe hereby grants
you a non-exclusive, worldwide, royalty free license to make a limited number of
copies of the Documentation for your development purposes and to publicly
display, publicly perform and distribute such copies. You may not modify the
Documentation.

2. RESTRICTIONS AND OWNERSHIP
You will not remove any copyright or other notice included in the Software or
Documentation and you will include such notices in any copies of the Software
that you distribute in human-readable format.

You will not copy, use, display, modify or distribute the Software or
Documentation in any manner not permitted by this Agreement. No title to the
intellectual property in the Software or Documentation is transferred to you
under the terms of this Agreement. You do not acquire any rights to the Software
or the Documentation except as expressly set forth in this Agreement. All rights
not granted are reserved by Adobe.

3. DISCLAIMER OF WARRANTY
ADOBE PROVIDES THE SOFTWARE AND DOCUMENTATION ONLY ON AN ""AS IS"" BASIS WITHOUT
WARRANTIES OR CONDITIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING
WITHOUT LIMITATION ANY WARRANTIES OR CONDITIONS OF TITLE, NON-INFRINGEMENT,
MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. ADOBE MAKES NO WARRANTY
THAT THE SOFTWARE OR DOCUMENTATION WILL BE ERROR-FREE. To the extent
permissible, any warranties that are not and cannot be excluded by the foregoing
are limited to ninety (90) days.

4. LIMITATION OF LIABILITY
ADOBE AND ITS SUPPLIERS SHALL NOT BE LIABLE FOR LOSS OR DAMAGE ARISING OUT OF
THIS AGREEMENT OR FROM THE USE OF THE SOFTWARE OR DOCUMENTATION. IN NO EVENT
WILL ADOBE BE LIABLE TO YOU OR ANY THIRD PARTY FOR ANY DIRECT, INDIRECT,
CONSEQUENTIAL, INCIDENTAL, OR SPECIAL DAMAGES INCLUDING LOST PROFITS, LOST
SAVINGS, COSTS, FEES, OR EXPENSES OF ANY KIND ARISING OUT OF ANY PROVISION OF
THIS AGREEMENT OR THE USE OR THE INABILITY TO USE THE SOFTWARE OR DOCUMENTATION,
HOWEVER CAUSED AND UNDER ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE), EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES. ADOBE'S AGGREGATE LIABILITY AND THAT OF ITS
SUPPLIERS UNDER OR IN CONNECTION WITH THIS AGREEMENT SHALL BE LIMITED TO THE
AMOUNT PAID BY YOU FOR THE SOFTWARE AND DOCUMENTATION.

5. INDEMNIFICATION
If you choose to distribute the Software in a commercial product, you do so with
the understanding that you agree to defend, indemnify and hold harmless Adobe
against any losses, damages and costs arising from the claims, lawsuits or other
legal actions arising out of such distribution.

6. TRADEMARK USAGE
Adobe and the DNG logo are the trademarks or registered trademarks of Adobe
Systems Incorporated in the United States and other countries. Such trademarks
may not be used to endorse or promote any product unless expressly permitted
under separate agreement with Adobe. For information on how to license the DNG
logo please go to www.adobe.com.

7. TERM
Your rights under this Agreement shall terminate if you fail to comply with any
of the material terms or conditions of this Agreement. If all your rights under
this Agreement terminate, you will immediately cease use and distribution of the
Software and Documentation.

8. GOVERNING LAW AND JURISDICTION. This Agreement is governed by the statutes
and laws of the State of California, without regard to the conflicts of law
principles thereof. The federal and state courts located in Santa Clara County,
California, USA, will have non-exclusive jurisdiction over any dispute arising
out of this Agreement.

9. GENERAL
This Agreement supersedes any prior agreement, oral or written, between Adobe
and you with respect to the licensing to you of the Software and Documentation.
No variation of the terms of this Agreement will be enforceable against Adobe
unless Adobe gives its express consent in writing signed by an authorized
signatory of Adobe. If any part of this Agreement is found void and
unenforceable, it will not affect the validity of the balance of the Agreement,
which shall remain valid and enforceable according to its terms.
",False,"```
DNG SDK License Agreement
NOTICE TO USER:
Adobe Systems Incorporated provides the Software and Documentation for use under
the terms of this Agreement. Any download, installation, use, reproduction,
modification or distribution of the Software or Documentation, or any
derivatives or portions thereof, constitutes your acceptance of this Agreement.

As used in this Agreement, ""Adobe"" means Adobe Systems Incorporated. ""Software""
means the software code, in any format, including sample code and source code,
accompanying this Agreement. ""Documentation"" means the documents, specifications
and all other items accompanying this Agreement other than the Software.

1. LICENSE GRANT
Software License. Subject to the restrictions below and other terms of this
Agreement, Adobe hereby grants you a non-exclusive, worldwide, royalty free
license to use, reproduce, prepare derivative works from, publicly display,
publicly perform, distribute and sublicense the Software for any purpose.

Document License. Subject to the terms of this Agreement, Adobe hereby grants
you a non-exclusive, worldwide, royalty free license to make a limited number of
copies of the Documentation for your development purposes and to publicly
display, publicly perform and distribute such copies. You may not modify the
Documentation.

2. RESTRICTIONS AND OWNERSHIP
You will not remove any copyright or other notice included in the Software or
Documentation and you will include such notices in any copies of the Software
that you distribute in human-readable format.

You will not copy, use, display, modify or distribute the Software or
Documentation in any manner not permitted by this Agreement. No title to the
intellectual property in the Software or Documentation is transferred to you
under the terms of this Agreement. You do not acquire any rights to the Software
or the Documentation except as expressly set forth in this Agreement. All rights
not granted are reserved by Adobe.

3. DISCLAIMER OF WARRANTY
ADOBE PROVIDES THE SOFTWARE AND DOCUMENTATION ONLY ON AN ""AS IS"" BASIS WITHOUT
WARRANTIES OR CONDITIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING
WITHOUT LIMITATION ANY WARRANTIES OR CONDITIONS OF TITLE, NON-INFRINGEMENT,
MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. ADOBE MAKES NO WARRANTY
THAT THE SOFTWARE OR DOCUMENTATION WILL BE ERROR-FREE. To the extent
permissible, any warranties that are not and cannot be excluded by the foregoing
are limited to ninety (90) days.

4. LIMITATION OF LIABILITY
ADOBE AND ITS SUPPLIERS SHALL NOT BE LIABLE FOR LOSS OR DAMAGE ARISING OUT OF
THIS AGREEMENT OR FROM THE USE OF THE SOFTWARE OR DOCUMENTATION. IN NO EVENT
WILL ADOBE BE LIABLE TO YOU OR ANY THIRD PARTY FOR ANY DIRECT, INDIRECT,
CONSEQUENTIAL, INCIDENTAL, OR SPECIAL DAMAGES INCLUDING LOST PROFITS, LOST
SAVINGS, COSTS, FEES, OR EXPENSES OF ANY KIND ARISING OUT OF ANY PROVISION OF
THIS AGREEMENT OR THE USE OR THE INABILITY TO USE THE SOFTWARE OR DOCUMENTATION,
HOWEVER CAUSED AND UNDER ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE), EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGES. ADOBE'S AGGREGATE LIABILITY AND THAT OF ITS
SUPPLIERS UNDER OR IN CONNECTION WITH THIS AGREEMENT SHALL BE LIMITED TO THE
AMOUNT PAID BY YOU FOR THE SOFTWARE AND DOCUMENTATION.

5. INDEMNIFICATION
If you choose to distribute the Software in a commercial product, you do so with
the understanding that you agree to defend, indemnify and hold harmless Adobe
against any losses, damages and costs arising from the claims, lawsuits or other
legal actions arising out of such distribution.

6. TRADEMARK USAGE
Adobe and the DNG logo are the trademarks or registered trademarks of Adobe
Systems Incorporated in the United States and other countries. Such trademarks
may not be used to endorse or promote any product unless expressly permitted
under separate agreement with Adobe. For information on how to license the DNG
logo please go to www.adobe.com.

7. TERM
Your rights under this Agreement shall terminate if you fail to comply with any
of the material terms or conditions of this Agreement. If all your rights under
this Agreement terminate, you will immediately cease use and distribution of the
Software and Documentation.

8. GOVERNING LAW AND JURISDICTION. This Agreement is governed by the statutes
and laws of the State of California, without regard to the conflicts of law
principles thereof. The federal and state courts located in Santa Clara County,
California, USA, will have non-exclusive jurisdiction over any dispute arising
out of this Agreement.

9. GENERAL
This Agreement supersedes any prior agreement, oral or written, between Adobe
and you with respect to the licensing to you of the Software and Documentation.
No variation of the terms of this Agreement will be enforceable against Adobe
unless Adobe gives its express consent in writing signed by an authorized
signatory of Adobe. If any part of this Agreement is found void and
unenforceable, it will not affect the validity of the balance of the Agreement,
which shall remain valid and enforceable according to its terms.



```"
10,10,NomosTestfiles/Adobe/Adobe-Glyph.txt,Adobe-Glyph,"Copyright (c) 1997,1998,2002,2007 Adobe Systems Incorporated

Permission is hereby granted, free of charge, to any person obtaining a copy of this documentation file to use, copy, publish, distribute, sublicense, and/or sell copies of the documentation, and to permit others to do the same, provided that:

- No modification, editing or other alteration of this document is allowed; and
- The above copyright notice and this permission notice shall be included in all copies of the documentation.

Permission is hereby granted, free of charge, to any person obtaining a copy of this documentation file, to create their own derivative works from the content of this document to use, copy, publish, distribute, sublicense, and/or sell the derivative works, and to permit others to do the same, provided that the derived work is not represented as being a copy or version of this document.

Adobe shall not be liable to any party for any loss of revenue or profit or for indirect, incidental, special, consequential, or other similar damages, whether based on tort (including without limitation negligence or strict liability), contract or other legal or equitable grounds even if Adobe has been advised or had reason to know of the possibility of such damages. The Adobe materials are provided on an ""AS IS"" basis. Adobe specifically disclaims all express, statutory, or implied warranties relating to the Adobe materials, including but not limited to those concerning merchantability or fitness for a particular purpose or non-infringement of any third party rights regarding the Adobe materials. 
",False,"```
Copyright (c) 1997,1998,2002,2007 Adobe Systems Incorporated

Permission is hereby granted, free of charge, to any person obtaining a copy of this documentation file to use, copy, publish, distribute, sublicense, and/or sell copies of the documentation, and to permit others to do the same, provided that:

- No modification, editing or other alteration of this document is allowed; and
- The above copyright notice and this permission notice shall be included in all copies of the documentation.

Permission is hereby granted, free of charge, to any person obtaining a copy of this documentation file, to create their own derivative works from the content of this document to use, copy, publish, distribute, sublicense, and/or sell the derivative works, and to permit others to do the same, provided that the derived work is not represented as being a copy or version of this document.

Adobe shall not be liable to any party for any loss of revenue or profit or for indirect, incidental, special, consequential, or other similar damages, whether based on tort (including without limitation negligence or strict liability), contract or other legal or equitable grounds even if Adobe has been advised or had reason to know of the possibility of such damages. The Adobe materials are provided on an ""AS IS"" basis. Adobe specifically disclaims all express, statutory, or implied warranties relating to the Adobe materials, including but not limited to those concerning merchantability or fitness for a particular purpose or non-infringement of any third party rights regarding the Adobe materials.
```"
11,11,NomosTestfiles/Adobe/Afmparse.txt,Afmparse,"(C) 1988, 1989 by Adobe Systems Incorporated. All rights reserved.

This file may be freely copied and redistributed as long as:

1) This entire notice continues to be included in the file,
2) If the file has been modified in any way, a notice of such modification is conspicuously indicated.

PostScript, Display PostScript,and Adobe are registered trademarks of Adobe Systems Incorporated.

THE INFORMATION BELOW IS FURNISHED AS IS, IS SUBJECT TO CHANGE WITHOUT NOTICE, AND SHOULD NOT BE CONSTRUED AS A COMMITMENT BY ADOBE SYSTEMS INCORPORATED. ADOBE SYSTEMS INCORPORATED ASSUMES NO RESPONSIBILITY OR LIABILITY FOR ANY ERRORS OR INACCURACIES, MAKES NO WARRANTY OF ANY KIND (EXPRESS, IMPLIED OR STATUTORY) WITH RESPECT TO THIS INFORMATION, AND EXPRESSLY DISCLAIMS ANY AND ALL WARRANTIES OF MERCHANTABILITY, FITNESS FOR PARTICULAR PURPOSES AND NONINFRINGEMENT OF THIRD PARTY RIGHTS. 
",False,"```
(C) 1988, 1989 by Adobe Systems Incorporated. All rights reserved.

This file may be freely copied and redistributed as long as:

1) This entire notice continues to be included in the file,
2) If the file has been modified in any way, a notice of such modification is conspicuously indicated.

PostScript, Display PostScript,and Adobe are registered trademarks of Adobe Systems Incorporated.
```"
12,12,NomosTestfiles/AFL/AFL-1.1.txt,AFL-1.1,"Academic Free License
   Version 1.1

The Academic Free License applies to any original work of authorship
(the ""Original Work"") whose owner (the ""Licensor"") has placed the
following notice immediately following the copyright notice for the 
Original Work: ""Licensed under the Academic Free License version 1.1.""

Grant of License. Licensor hereby grants to any person obtaining a
copy of the Original Work (""You"") a world-wide, royalty-free, 
non-exclusive, perpetual, non-sublicenseable license (1) to use, copy,
modify, merge, publish, perform, distribute and/or sell copies of the
Original Work and derivative works thereof, and (2) under patent 
claims owned or controlled by the Licensor that are embodied in the 
Original Work as furnished by the Licensor, to make, use, sell and 
offer for sale the Original Work and derivative works thereof, subject 
to the following conditions.

Right of Attribution. Redistributions of the Original Work must 
reproduce all copyright notices in the Original Work as furnished by
the Licensor, both in the Original Work itself and in any
 documentation and/or other materials provided with the distribution of 
the Original Work in executable form.

Exclusions from License Grant. Neither the names of Licensor, nor the
names of any contributors to the Original Work, nor any of their 
trademarks or service marks, may be used to endorse or promote 
products derived from this Original Work without express prior written 
permission of the Licensor.

WARRANTY AND DISCLAIMERS. LICENSOR WARRANTS THAT THE COPYRIGHT IN AND
 TO THE ORIGINAL WORK IS OWNED BY THE LICENSOR OR THAT THE ORIGINAL 
WORK IS DISTRIBUTED BY LICENSOR UNDER A VALID CURRENT LICENSE FROM THE
 COPYRIGHT OWNER. EXCEPT AS EXPRESSLY STATED IN THE IMMEDIATELY 
PRECEEDING SENTENCE, THE ORIGINAL WORK IS PROVIDED UNDER THIS LICENSE
ON AN ""AS IS"" BASIS, WITHOUT WARRANTY, EITHER EXPRESS OR IMPLIED,
INCLUDING, WITHOUT LIMITATION, THE WARRANTY OF NON-INFRINGEMENT AND 
WARRANTIES THAT THE ORIGINAL WORK IS MERCHANTABLE OR FIT FOR A 
PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY OF THE ORIGINAL 
WORK IS WITH YOU. THIS DISCLAIMER OF WARRANTY CONSTITUTES AN ESSENTIAL 
PART OF THIS LICENSE. NO LICENSE TO ORIGINAL WORK IS GRANTED HEREUNDER 
EXCEPT UNDER THIS DISCLAIMER.

LIMITATION OF LIABILITY. UNDER NO CIRCUMSTANCES AND UNDER NO LEGAL
THEORY, WHETHER TORT (INCLUDING NEGLIGENCE), CONTRACT, OR OTHERWISE,
SHALL THE LICENSOR BE LIABLE TO ANY PERSON FOR ANY DIRECT, INDIRECT,
SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER ARISING 
AS A RESULT OF THIS LICENSE OR THE USE OF THE ORIGINAL WORK INCLUDING,
WITHOUT LIMITATION, DAMAGES FOR LOSS OF GOODWILL, WORK STOPPAGE,
COMPUTER FAILURE OR MALFUNCTION, OR ANY AND ALL OTHER COMMERCIAL 
DAMAGES OR LOSSES, EVEN IF SUCH PERSON SHALL HAVE BEEN INFORMED OF THE 
POSSIBILITY OF SUCH DAMAGES. THIS LIMITATION OF LIABILITY SHALL NOT
 APPLY TO LIABILITY FOR DEATH OR PERSONAL INJURY RESULTING FROM SUCH 
PARTY'S NEGLIGENCE TO THE EXTENT APPLICABLE LAW PROHIBITS SUCH 
LIMITATION. SOME JURISDICTIONS DO NOT ALLOW THE EXCLUSION OR 
LIMITATION OF INCIDENTAL OR CONSEQUENTIAL DAMAGES, SO THIS EXCLUSION 
AND LIMITATION MAY NOT APPLY TO YOU.

License to Source Code. The term ""Source Code"" means the preferred 
form of the Original Work for making modifications to it and all
 available documentation describing how to access and modify the
 Original Work. Licensor hereby agrees to provide a machine-readable 
copy of the Source Code of the Original Work along with each copy of 
the Original Work that Licensor distributes. Licensor reserves the 
right to satisfy this obligation by placing a machine-readable copy of
the Source Code in an information repository reasonably calculated to 
permit inexpensive and convenient access by You for as long as 
Licensor continues to distribute the Original Work, and by publishing
 the address of that information repository in a notice immediately 
following the copyright notice that applies to the Original Work.

Mutual Termination for Patent Action. This License shall terminate 
automatically and You may no longer exercise any of the rights granted 
to You by this License if You file a lawsuit in any court alleging 
that any OSI Certified open source software that is licensed under any 
license containing this ""Mutual Termination for Patent Action"" clause 
infringes any patent claims that are essential to use that software.

This license is Copyright (C) 2002 Lawrence E. Rosen. All rights 
reserved. Permission is hereby granted to copy and distribute this 
license without modification. This license may not be modified without
the express written permission of its copyright owner.
",False,"```
Academic Free License
   Version 1.1

The Academic Free License applies to any original work of authorship
(the ""Original Work"") whose owner (the ""Licensor"") has placed the
following notice immediately following the copyright notice for the 
Original Work: ""Licensed under the Academic Free License version 1.1.""

Grant of License. Licensor hereby grants to any person obtaining a
copy of the Original Work (""You"") a world-wide, royalty-free, 
non-exclusive, perpetual, non-sublicenseable license (1) to use, copy,
modify, merge, publish, perform, distribute and/or sell copies of the
Original Work and derivative works thereof, and (2) under patent 
claims owned or controlled by the Licensor that are embodied in the 
Original Work as furnished by the Licensor, to make, use, sell and 
offer for sale the Original Work and derivative works thereof, subject 
to the following conditions.

Right of Attribution. Redistributions of the Original Work must 
reproduce all copyright notices in the Original Work as furnished by
the Licensor, both in the Original Work itself and in any
 documentation and/or other materials provided with the distribution of 
the Original Work in executable form.

Exclusions from License Grant. Neither the names of Licensor, nor the
names of any contributors to the Original Work, nor any of their 
trademarks or service marks, may be used to endorse or promote 
products derived from this Original Work without express prior written 
permission of the Licensor.

WARRANTY AND DISCLAIMERS. LICENSOR WARRANTS THAT THE COPYRIGHT IN AND
 TO THE ORIGINAL WORK IS OWNED BY THE LICENSOR OR THAT THE ORIGINAL 
WORK IS DISTRIBUTED BY LICENSOR UNDER A VALID CURRENT LICENSE FROM THE
 COPYRIGHT OWNER. EXCEPT AS EXPRESSLY STATED IN THE IMMEDIATELY 
PRECEEDING SENTENCE, THE ORIGINAL WORK IS PROVIDED UNDER THIS LICENSE
ON AN ""AS IS"" BASIS, WITHOUT WARRANTY, EITHER EXPRESS OR IMPLIED,
INCLUDING, WITHOUT LIMITATION, THE WARRANTY OF NON-INFRINGEMENT AND 
WARRANTIES THAT THE ORIGINAL WORK IS MERCHANTABLE OR FIT FOR A 
PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY OF THE ORIGINAL 
WORK IS WITH YOU. THIS DISCLAIMER OF WARRANTY CONSTITUTES AN ESSENTIAL 
PART OF THIS LICENSE. NO LICENSE TO ORIGINAL WORK IS GRANTED HEREUNDER 
EXCEPT UNDER THIS DISCLAIMER.

LIMITATION OF LIABILITY. UNDER NO CIRCUMSTANCES AND UNDER NO LEGAL
THEORY, WHETHER TORT (INCLUDING NEGLIGENCE), CONTRACT, OR OTHERWISE,
SHALL THE LICENSOR BE LIABLE TO ANY PERSON FOR ANY DIRECT, INDIRECT,
SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER ARISING 
AS A RESULT OF THIS LICENSE OR THE USE OF THE ORIGINAL WORK INCLUDING,
WITHOUT LIMITATION, DAMAGES FOR LOSS OF GOODWILL, WORK STOPPAGE,
COMPUTER FAILURE OR MALFUNCTION, OR ANY AND ALL OTHER COMMERCIAL 
DAMAGES OR LOSSES, EVEN IF SUCH PERSON SHALL HAVE BEEN INFORMED OF THE 
POSSIBILITY OF SUCH DAMAGES. THIS LIMITATION OF LIABILITY SHALL NOT
 APPLY TO LIABILITY FOR DEATH OR PERSONAL INJURY RESULTING FROM SUCH 
PARTY'S NEGLIGENCE TO THE EXTENT APPLICABLE LAW PROHIBITS SUCH 
LIMITATION. SOME JURISDICTIONS DO NOT ALLOW THE EXCLUSION OR 
LIMITATION OF INCIDENTAL OR CONSEQUENTIAL DAMAGES, SO THIS EXCLUSION 
AND LIMITATION MAY NOT APPLY TO YOU.

License to Source Code. The term ""Source Code"" means the preferred 
form of the Original Work for making modifications to it and all
 available documentation describing how to access and modify the
 Original Work. Licensor hereby agrees to provide a machine-readable 
copy of the Source Code of the Original Work along with each copy of 
the Original Work that Licensor distributes. Licensor reserves the 
right to satisfy this obligation by placing a machine-readable copy of
the Source Code in an information repository reasonably calculated to 
permit inexpensive and convenient access by You for as long as 
Licensor continues to distribute the Original Work, and by publishing
 the address of that information repository in a notice immediately 
following the copyright notice that applies to the Original Work.

Mutual Termination for Patent Action. This License shall terminate 
automatically and You may no longer exercise any of the rights granted 
to You by this License if You file a lawsuit in any court alleging 
that any OSI Certified open source software that is licensed under any 
license containing this ""Mutual Termination for Patent Action"" clause 
infringes any patent claims that are essential to use that software.

This license is Copyright (C) 2002 Lawrence E. Rosen. All rights 
reserved. Permission is hereby granted to copy and distribute this 
license without modification. This license may not be modified without
the express written permission of its copyright owner.
```"
13,13,NomosTestfiles/AFL/AFL-1.2.txt,AFL-1.2,"  Academic Free License
  Version 1.2 

This Academic Free License applies to any original work of authorship 
(the ""Original Work"") whose owner (the ""Licensor"") has placed the 
following notice immediately following the copyright notice for the 
Original Work:

Licensed under the Academic Free License version 1.2 

Grant of License. Licensor hereby grants to any person obtaining a 
copy of the Original Work (""You"") a world-wide, royalty-free, 
non-exclusive, perpetual, non-sublicenseable license (1) to use, copy, 
modify, merge, publish, perform, distribute and/or sell copies of the 
Original Work and derivative works thereof, and (2) under patent claims 
owned or controlled by the Licensor that are embodied in the Original 
Work as furnished by the Licensor, to make, use, sell and offer for 
sale the Original Work and derivative works thereof, subject to the 
following conditions.

Attribution Rights. You must retain, in the Source Code of any 
Derivative Works that You create, all copyright, patent or trademark 
notices from the Source Code of the Original Work, as well as any 
notices of licensing and any descriptive text identified therein as an 
""Attribution Notice."" You must cause the Source Code for any Derivative 
Works that You create to carry a prominent Attribution Notice reasonably 
calculated to inform recipients that You have modified the Original Work.

Exclusions from License Grant. Neither the names of Licensor, nor the 
names of any contributors to the Original Work, nor any of their 
trademarks or service marks, may be used to endorse or promote products 
derived from this Original Work without express prior written permission 
of the Licensor.

Warranty and Disclaimer of Warranty. Licensor warrants that the copyright 
in and to the Original Work is owned by the Licensor or that the Original 
Work is distributed by Licensor under a valid current license from the 
copyright owner. Except as expressly stated in the immediately proceeding 
sentence, the Original Work is provided under this License on an ""AS IS"" 
BASIS and WITHOUT WARRANTY, either express or implied, including, without 
limitation, the warranties of NON-INFRINGEMENT, MERCHANTABILITY or FITNESS 
FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY OF THE ORIGINAL 
WORK IS WITH YOU. This DISCLAIMER OF WARRANTY constitutes an essential part 
of this License. No license to Original Work is granted hereunder except 
under this disclaimer.

Limitation of Liability. Under no circumstances and under no legal theory, 
whether in tort (including negligence), contract, or otherwise, shall the 
Licensor be liable to any person for any direct, indirect, special, 
incidental, or consequential damages of any character arising as a result 
of this License or the use of the Original Work including, without 
limitation, damages for loss of goodwill, work stoppage, computer failure 
or malfunction, or any and all other commercial damages or losses. This 
limitation of liability shall not apply to liability for death or personal 
injury resulting from Licensor's negligence to the extent applicable law 
prohibits such limitation. Some jurisdictions do not allow the exclusion or 
limitation of incidental or consequential damages, so this exclusion and 
limitation may not apply to You.

License to Source Code. The term ""Source Code"" means the preferred form of 
the Original Work for making modifications to it and all available 
documentation describing how to modify the Original Work. Licensor hereby 
agrees to provide a machine-readable copy of the Source Code of the Original 
Work along with each copy of the Original Work that Licensor distributes. 
Licensor reserves the right to satisfy this obligation by placing a 
machine-readable copy of the Source Code in an information repository 
reasonably calculated to permit inexpensive and convenient access by You for 
as long as Licensor continues to distribute the Original Work, and by 
publishing the address of that information repository in a notice immediately 
following the copyright notice that applies to the Original Work.

Mutual Termination for Patent Action. This License shall terminate 
automatically and You may no longer exercise any of the rights granted to You 
by this License if You file a lawsuit in any court alleging that any OSI 
Certified open source software that is licensed under any license containing 
this ""Mutual Termination for Patent Action"" clause infringes any patent 
claims that are essential to use that software.

Right to Use. You may use the Original Work in all ways not otherwise 
restricted or conditioned by this License or by law, and Licensor promises 
not to interfere with or be responsible for such uses by You.

This license is Copyright (C) 2002 Lawrence E. Rosen. All rights reserved. 
Permission is hereby granted to copy and distribute this license without 
modification. This license may not be modified without the express written 
permission of its copyright owner.
",False,"```
Academic Free License
Version 1.2 

This Academic Free License applies to any original work of authorship 
(the ""Original Work"") whose owner (the ""Licensor"") has placed the 
following notice immediately following the copyright notice for the 
Original Work:

Licensed under the Academic Free License version 1.2 

Grant of License. Licensor hereby grants to any person obtaining a 
copy of the Original Work (""You"") a world-wide, royalty-free, 
non-exclusive, perpetual, non-sublicenseable license (1) to use, copy, 
modify, merge, publish, perform, distribute and/or sell copies of the 
Original Work and derivative works thereof, and (2) under patent claims 
owned or controlled by the Licensor that are embodied in the Original 
Work as furnished by the Licensor, to make, use, sell and offer for 
sale the Original Work and derivative works thereof, subject to the 
following conditions.

Attribution Rights. You must retain, in the Source Code of any 
Derivative Works that You create, all copyright, patent or trademark 
notices from the Source Code of the Original Work, as well as any 
notices of licensing and any descriptive text identified therein as an 
""Attribution Notice."" You must cause the Source Code for any Derivative 
Works that You create to carry a prominent Attribution Notice reasonably 
calculated to inform recipients that You have modified the Original Work.

Exclusions from License Grant. Neither the names of Licensor, nor the 
names of any contributors to the Original Work, nor any of their 
trademarks or service marks, may be used to endorse or promote products 
derived from this Original Work without express prior written permission 
of the Licensor.

Warranty and Disclaimer of Warranty. Licensor warrants that the copyright 
in and to the Original Work is owned by the Licensor or that the Original 
Work is distributed by Licensor under a valid current license from the 
copyright owner. Except as expressly stated in the immediately proceeding 
sentence, the Original Work is provided under this License on an ""AS IS"" 
BASIS and WITHOUT WARRANTY, either express or implied, including, without 
limitation, the warranties of NON-INFRINGEMENT, MERCHANTABILITY or FITNESS 
FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY OF THE ORIGINAL 
WORK IS WITH YOU. This DISCLAIMER OF WARRANTY constitutes an essential part 
of this License. No license to Original Work is granted hereunder except 
under this disclaimer.

Limitation of Liability. Under no circumstances and under no legal theory, 
whether in tort (including negligence), contract, or otherwise, shall the 
Licensor be liable to any person for any direct, indirect, special, 
incidental, or consequential damages of any character arising as a result 
of this License or the use of the Original Work including, without 
limitation, damages for loss of goodwill, work stoppage, computer failure 
or malfunction, or any and all other commercial damages or losses. This 
limitation of liability shall not apply to liability for death or personal 
injury resulting from Licensor's negligence to the extent applicable law 
prohibits such limitation. Some jurisdictions do not allow the exclusion or 
limitation of incidental or consequential damages, so this exclusion and 
limitation may not apply to You.

License to Source Code. The term ""Source Code"" means the preferred form of 
the Original Work for making modifications to it and all available 
documentation describing how to modify the Original Work. Licensor hereby 
agrees to provide a machine-readable copy of the Source Code of the Original 
Work along with each copy of the Original Work that Licensor distributes. 
Licensor reserves the right to satisfy this obligation by placing a 
machine-readable copy of the Source Code in an information repository 
reasonably calculated to permit inexpensive and convenient access by You for 
as long as Licensor continues to distribute the Original Work, and by 
publishing the address of that information repository in a notice immediately 
following the copyright notice that applies to the Original Work.

Mutual Termination for Patent Action. This License shall terminate 
automatically and You may no longer exercise any of the rights granted to You 
by this License if You file a lawsuit in any court alleging that any OSI 
Certified open source software that is licensed under any license containing 
this ""Mutual Termination for Patent Action"" clause infringes any patent 
claims that are essential to use that software.

Right to Use. You may use the Original Work in all ways not otherwise 
restricted or conditioned by this License or by law, and Licensor promises 
not to interfere with or be responsible for such uses by You.

This license is Copyright (C) 2002 Lawrence E. Rosen. All rights reserved. 
Permission is hereby granted to copy and distribute this license without 
modification. This license may not be modified without the express written 
permission of its copyright owner. 
```"
14,14,NomosTestfiles/AFL/AFL-2.0.txt,AFL-2.0,"The Academic Free License
 v. 2.0

 This Academic Free License (the ""License"") applies to any original work of authorship (the ""Original Work"") whose owner (the ""Licensor"") has placed the following notice immediately following the copyright notice for the Original Work:   
Licensed under the Academic Free License version 2.0 

1) Grant of Copyright License. Licensor hereby grants You a world-wide, royalty-free, non-exclusive, perpetual, sublicenseable license to do the following: 

	a) to reproduce the Original Work in copies; 

	b) to prepare derivative works (""Derivative Works"") based upon the Original Work; 

	c) to distribute copies of the Original Work and Derivative Works to the public; 

	d) to perform the Original Work publicly; and 

	e) to display the Original Work publicly.   

2) Grant of Patent License. Licensor hereby grants You a world-wide, royalty-free, non-exclusive, perpetual, sublicenseable license, under patent claims owned or controlled by the Licensor that are embodied in the Original Work as furnished by the Licensor, to make, use, sell and offer for sale the Original Work and Derivative Works.  

3) Grant of Source Code License. The term ""Source Code"" means the preferred form of the Original Work for making modifications to it and all available documentation describing how to modify the Original Work.  Licensor hereby agrees to provide a machine-readable copy of the Source Code of the Original Work along with each copy of the Original Work that Licensor distributes.  Licensor reserves the right to satisfy this obligation by placing a machine-readable copy of the Source Code in an information repository reasonably calculated to permit inexpensive and convenient access by You for as long as Licensor continues to distribute the Original Work, and by publishing the address of that information repository in a notice immediately following the copyright notice that applies to the Original Work.    

4) Exclusions From License Grant. Neither the names of Licensor, nor the names of any contributors to the Original Work, nor any of their trademarks or service marks, may be used to endorse or promote products derived from this Original Work without express prior written permission of the Licensor.  Nothing in this License shall be deemed to grant any rights to trademarks, copyrights, patents, trade secrets or any other intellectual property of Licensor except as expressly stated herein.  No patent license is granted to make, use, sell or offer to sell embodiments of any patent claims other than the licensed claims defined in Section 2.  No right is granted to the trademarks of Licensor even if such marks are included in the Original Work.  Nothing in this License shall be interpreted to prohibit Licensor from licensing under different terms from this License any Original Work that Licensor otherwise would have a right to license.  

5) This section intentionally omitted.  

6) Attribution Rights. You must retain, in the Source Code of any Derivative Works that You create, all copyright, patent or trademark notices from the Source Code of the Original Work, as well as any notices of licensing and any descriptive text identified therein as an ""Attribution Notice.""  You must cause the Source Code for any Derivative Works that You create to carry a prominent Attribution Notice reasonably calculated to inform recipients that You have modified the Original Work.  

7) Warranty of Provenance and Disclaimer of Warranty. Licensor warrants that the copyright in and to the Original Work and the patent rights granted herein by Licensor are owned by the Licensor or are sublicensed to You under the terms of this License with the permission of the contributor(s) of those copyrights and patent rights.  Except as expressly stated in the immediately proceeding sentence, the Original Work is provided under this License on an ""AS IS"" BASIS and WITHOUT WARRANTY, either express or implied, including, without limitation, the warranties of NON-INFRINGEMENT, MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY OF THE ORIGINAL WORK IS WITH YOU.  This DISCLAIMER OF WARRANTY constitutes an essential part of this License.  No license to Original Work is granted hereunder except under this disclaimer.  

8) Limitation of Liability. Under no circumstances and under no legal theory, whether in tort (including negligence), contract, or otherwise, shall the Licensor be liable to any person for any direct, indirect, special, incidental, or consequential damages of any character arising as a result of this License or the use of the Original Work including, without limitation, damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses.  This limitation of liability shall not apply to liability for death or personal injury resulting from Licensor's negligence to the extent applicable law prohibits such limitation.  Some jurisdictions do not allow the exclusion or limitation of incidental or consequential damages, so this exclusion and limitation may not apply to You.  

9) Acceptance and Termination. If You distribute  copies of the Original Work or a Derivative Work, You must make a reasonable effort under the circumstances to obtain the express assent of recipients to the terms of this License.  Nothing else but this License (or another written agreement between Licensor and You) grants You permission to create Derivative Works based upon the Original Work or to exercise any of the rights granted in Section 1 herein, and any attempt to do so except under the terms of this License (or another written agreement between Licensor and You) is expressly prohibited by U.S. copyright law, the equivalent laws of other countries, and by international treaty.  Therefore, by exercising any of the rights granted to You in Section 1 herein, You indicate Your acceptance of this License and all of its terms and conditions.    

10) Termination for Patent Action. This License shall terminate automatically and You may no longer exercise any of the rights granted to You by this License as of the date You commence an action, including a cross-claim or counterclaim, for patent infringement (i) against Licensor with respect to a patent applicable to software or (ii) against any entity with respect to a patent applicable to the Original Work (but excluding combinations of the Original Work with other software or hardware).    

11) Jurisdiction, Venue and Governing Law. Any action or suit relating to this License may be brought only in the courts of a jurisdiction wherein the Licensor resides or in which Licensor conducts its primary business, and under the laws of that jurisdiction excluding its conflict-of-law provisions.  The application of the United Nations Convention on Contracts for the International Sale of Goods is expressly excluded.  Any use of the Original Work outside the scope of this License or after its termination shall be subject to the requirements and penalties of the U.S. Copyright Act, 17 U.S.C. ¤ 101 et seq., the equivalent laws of other countries, and international treaty.  This section shall survive the termination of this License.  

12) Attorneys Fees. In any action to enforce the terms of this License or seeking damages relating thereto, the prevailing party shall be entitled to recover its costs and expenses, including, without limitation, reasonable attorneys' fees and costs incurred in connection with such action, including any appeal of such action.  This section shall survive the termination of this License.  

13) Miscellaneous. This License represents the complete agreement concerning the subject matter hereof.  If any provision of this License is held to be unenforceable, such provision shall be reformed only to the extent necessary to make it enforceable.    

14) Definition of ""You"" in This License. ""You"" throughout this License, whether in upper or lower case, means an individual or a legal entity exercising rights under, and complying with all of the terms of, this License.  For legal entities, ""You"" includes any entity that controls, is controlled by, or is under common control with you.  For purposes of this definition, ""control"" means (i) the power, direct or indirect, to cause the direction or management of such entity, whether by contract or otherwise, or (ii) ownership of fifty percent (50%) or more of the outstanding shares, or (iii) beneficial ownership of such entity.   

15) Right to Use. You may use the Original Work in all ways not otherwise restricted or conditioned by this License or by law, and Licensor promises not to interfere with or be responsible for such uses by You.    

This license is Copyright (C) 2003 Lawrence E. Rosen.  All rights reserved.  Permission is hereby granted to copy and distribute this license without modification.  This license may not be modified without the express written permission of its copyright owner. 
",False,"```
The Academic Free License
 v. 2.0

 This Academic Free License (the ""License"") applies to any original work of authorship (the ""Original Work"") whose owner (the ""Licensor"") has placed the following notice immediately following the copyright notice for the Original Work:   
Licensed under the Academic Free License version 2.0 

1) Grant of Copyright License. Licensor hereby grants You a world-wide, royalty-free, non-exclusive, perpetual, sublicenseable license to do the following: 

	a) to reproduce the Original Work in copies; 

	b) to prepare derivative works (""Derivative Works"") based upon the Original Work; 

	c) to distribute copies of the Original Work and Derivative Works to the public; 

	d) to perform the Original Work publicly; and 

	e) to display the Original Work publicly.   

2) Grant of Patent License. Licensor hereby grants You a world-wide, royalty-free, non-exclusive, perpetual, sublicenseable license, under patent claims owned or controlled by the Licensor that are embodied in the Original Work as furnished by the Licensor, to make, use, sell and offer for sale the Original Work and Derivative Works.  

3) Grant of Source Code License. The term ""Source Code"" means the preferred form of the Original Work for making modifications to it and all available documentation describing how to modify the Original Work.  Licensor hereby agrees to provide a machine-readable copy of the Source Code of the Original Work along with each copy of the Original Work that Licensor distributes.  Licensor reserves the right to satisfy this obligation by placing a machine-readable copy of the Source Code in an information repository reasonably calculated to permit inexpensive and convenient access by You for as long as Licensor continues to distribute the Original Work, and by publishing the address of that information repository in a notice immediately following the copyright notice that applies to the Original Work.    

4) Exclusions From License Grant. Neither the names of Licensor, nor the names of any contributors to the Original Work, nor any of their trademarks or service marks, may be used to endorse or promote products derived from this Original Work without express prior written permission of the Licensor.  Nothing in this License shall be deemed to grant any rights to trademarks, copyrights, patents, trade secrets or any other intellectual property of Licensor except as expressly stated herein.  No patent license is granted to make, use, sell or offer to sell embodiments of any patent claims other than the licensed claims defined in Section 2.  No right is granted to the trademarks of Licensor even if such marks are included in the Original Work.  Nothing in this License shall be interpreted to prohibit Licensor from licensing under different terms from this License any Original Work that Licensor otherwise would have a right to license.  

5) This section intentionally omitted.  

6) Attribution Rights. You must retain, in the Source Code of any Derivative Works that You create, all copyright, patent or trademark notices from the Source Code of the Original Work, as well as any notices of licensing and any descriptive text identified therein as an ""Attribution Notice.""  You must cause the Source Code for any Derivative Works that You create to carry a prominent Attribution Notice reasonably calculated to inform recipients that You have modified the Original Work.  

7) Warranty of Provenance and Disclaimer of Warranty. Licensor warrants that the copyright in and to the Original Work and the patent rights granted herein by Licensor are owned by the Licensor or are sublicensed to You under the terms of this License with the permission of the contributor(s) of those copyrights and patent rights.  Except as expressly stated in the immediately proceeding sentence, the Original Work is provided under this License on an ""AS IS"" BASIS and WITHOUT WARRANTY, either express or implied, including, without limitation, the warranties of NON-INFRINGEMENT, MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY OF THE ORIGINAL WORK IS WITH YOU.  This DISCLAIMER OF WARRANTY constitutes an essential part of this License.  No license to Original Work is granted hereunder except under this disclaimer.  

8) Limitation of Liability. Under no circumstances and under no legal theory, whether in tort (including negligence), contract, or otherwise, shall the Licensor be liable to any person for any direct, indirect, special, incidental, or consequential damages of any character arising as a result of this License or the use of the Original Work including, without limitation, damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses.  This limitation of liability shall not apply to liability for death or personal injury resulting from Licensor's negligence to the extent applicable law prohibits such limitation.  Some jurisdictions do not allow the exclusion or limitation of incidental or consequential damages, so this exclusion and limitation may not apply to You.  

9) Acceptance and Termination. If You distribute  copies of the Original Work or a Derivative Work, You must make a reasonable effort under the circumstances to obtain the express assent of recipients to the terms of this License.  Nothing else but this License (or another written agreement between Licensor and You) grants You permission to create Derivative Works based upon the Original Work or to exercise any of the rights granted in Section 1 herein, and any attempt to do so except under the terms of this License (or another written agreement between Licensor and You) is expressly prohibited by U.S. copyright law, the equivalent laws of other countries, and by international treaty.  Therefore, by exercising any of the rights granted to You in Section 1 herein, You indicate Your acceptance of this License and all of its terms and conditions.    

10) Termination for Patent Action. This License shall terminate automatically and You may no longer exercise any of the rights granted to You by this License as of the date You commence an action, including a cross-claim or counterclaim, for patent infringement (i) against Licensor with respect to a patent applicable to software or (ii) against any entity with respect to a patent applicable to the Original Work (but excluding combinations of the Original Work with other software or hardware).    

11) Jurisdiction, Venue and Governing Law. Any action or suit relating to this License may be brought only in the courts of a jurisdiction wherein the Licensor resides or in which Licensor conducts its primary business, and under the laws of that jurisdiction excluding its conflict-of-law provisions.  The application of the United Nations Convention on Contracts for the International Sale of Goods is expressly excluded.  Any use of the Original Work outside the scope of this License or after its termination shall be subject to the requirements and penalties of the U.S. Copyright Act, 17 U.S.C. ¤ 101 et seq., the equivalent laws of other countries, and international treaty.  This section shall survive the termination of this License.  

12) Attorneys Fees. In any action to enforce the terms of this License or seeking damages relating thereto, the prevailing party shall be entitled to recover its costs and expenses, including, without limitation, reasonable attorneys' fees and costs incurred in connection with such action, including any appeal of such action.  This section shall survive the termination of this License.  

13) Miscellaneous. This License represents the complete agreement concerning the subject matter hereof.  If any provision of this License is held to be unenforceable, such provision shall be reformed only to the extent necessary to make it enforceable.    

14) Definition of ""You"" in This License. ""You"" throughout this License, whether in upper or lower case, means an individual or a legal entity exercising rights under, and complying with all of the terms of, this License.  For legal entities, ""You"" includes any entity that controls, is controlled by, or is under common control with you.  For purposes of this definition, ""control"" means (i) the power, direct or indirect, to cause the direction or management of such entity, whether by contract or otherwise, or (ii) ownership of fifty percent (50%) or more of the outstanding shares, or (iii) beneficial ownership of such entity.   

15) Right to Use. You may use the Original Work in all ways not otherwise restricted or conditioned by this License or by law, and Licensor promises not to interfere with or be responsible for such uses by You.    

This license is Copyright (C) 2003 Lawrence E. Rosen.  All rights reserved.  Permission is hereby granted to copy and distribute this license without modification.  This license may not be modified without the express written permission of its copyright owner.  
```"
15,15,NomosTestfiles/AFL/AFL-2.1_dojo.js,"AFL-2.1
BSD
Dual-license","/*
	Copyright (c) 2004-2008, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is a compiled version of Dojo, built for deployment and not for
	development. To get an editable version, please visit:

		http://dojotoolkit.org

	for documentation and information on getting the source.
*/

;(function(){

	/*
	dojo, dijit, and dojox must always be the first three, and in that order.
	djConfig.scopeMap = [
		[""dojo"", ""fojo""],
		[""dijit"", ""fijit""],
		[""dojox"", ""fojox""]
	
	]
	*/

	/**Build will replace this comment with a scoped djConfig **/

	//The null below can be relaced by a build-time value used instead of djConfig.scopeMap.
	var sMap = null;

	//See if new scopes need to be defined.
	if((sMap || (typeof djConfig != ""undefined"" && djConfig.scopeMap)) && (typeof window != ""undefined"")){
		var scopeDef = """", scopePrefix = """", scopeSuffix = """", scopeMap = {}, scopeMapRev = {};
		sMap = sMap || djConfig.scopeMap;
		for(var i = 0; i < sMap.length; i++){
			//Make local variables, then global variables that use the locals.
			var newScope = sMap[i];
			scopeDef += ""var "" + newScope[0] + "" = {}; "" + newScope[1] + "" = "" + newScope[0] + "";"" + newScope[1] + ""._scopeName = '"" + newScope[1] + ""';"";
			scopePrefix += (i == 0 ? """" : "","") + newScope[0];
			scopeSuffix += (i == 0 ? """" : "","") + newScope[1];
			scopeMap[newScope[0]] = newScope[1];
			scopeMapRev[newScope[1]] = newScope[0];
		}

		eval(scopeDef + ""dojo._scopeArgs = ["" + scopeSuffix + ""];"");

		dojo._scopePrefixArgs = scopePrefix;
		dojo._scopePrefix = ""(function("" + scopePrefix + ""){"";
		dojo._scopeSuffix = ""})("" + scopeSuffix + "")"";
		dojo._scopeMap = scopeMap;
		dojo._scopeMapRev = scopeMapRev;
	}

/*=====
// note:
//		'djConfig' does not exist under 'dojo.*' so that it can be set before the
//		'dojo' variable exists.
// note:
//		Setting any of these variables *after* the library has loaded does
//		nothing at all.

djConfig = {
	// summary:
	//		Application code can set the global 'djConfig' prior to loading
	//		the library to override certain global settings for how dojo works.
	//
	// isDebug: Boolean
	//		Defaults to `false`. If set to `true`, ensures that Dojo provides
	//		extended debugging feedback via Firebug. If Firebug is not available
	//		on your platform, setting `isDebug` to `true` will force Dojo to
	//		pull in (and display) the version of Firebug Lite which is
	//		integrated into the Dojo distribution, thereby always providing a
	//		debugging/logging console when `isDebug` is enabled. Note that
	//		Firebug's `console.*` methods are ALWAYS defined by Dojo. If
	//		`isDebug` is false and you are on a platform without Firebug, these
	//		methods will be defined as no-ops.
	isDebug: false,
	// debugAtAllCosts: Boolean
	//		Defaults to `false`. If set to `true`, this triggers an alternate
	//		mode of the package system in which dependencies are detected and
	//		only then are resources evaluated in dependency order via
	//		`<script>` tag inclusion. This may double-request resources and
	//		cause problems with scripts which expect `dojo.require()` to
	//		preform synchronously. `debugAtAllCosts` can be an invaluable
	//		debugging aid, but when using it, ensure that all code which
	//		depends on Dojo modules is wrapped in `dojo.addOnLoad()` handlers.
	//		Due to the somewhat unpredictable side-effects of using
	//		`debugAtAllCosts`, it is strongly recommended that you enable this
	//		flag as a last resort. `debugAtAllCosts` has no effect when loading
	//		resources across domains. For usage information, see the
	//		[Dojo Book](http://dojotoolkit.org/book/book-dojo/part-4-meta-dojo-making-your-dojo-code-run-faster-and-better/debugging-facilities/deb)
	debugAtAllCosts: false,
	// locale: String
	//		The locale to assume for loading localized resources in this page,
	//		specified according to [RFC 3066](http://www.ietf.org/rfc/rfc3066.txt).
	//		Must be specified entirely in lowercase, e.g. `en-us` and `zh-cn`.
	//		See the documentation for `dojo.i18n` and `dojo.requireLocalization`
	//		for details on loading localized resources. If no locale is specified,
	//		Dojo assumes the locale of the user agent, according to `navigator.userLanguage`
	//		or `navigator.language` properties.
	locale: undefined,
	// extraLocale: Array
	//		No default value. Specifies additional locales whose
	//		resources should also be loaded alongside the default locale when
	//		calls to `dojo.requireLocalization()` are processed.
	extraLocale: undefined,
	// baseUrl: String
	//		The directory in which `dojo.js` is located. Under normal
	//		conditions, Dojo auto-detects the correct location from which it
	//		was loaded. You may need to manually configure `baseUrl` in cases
	//		where you have renamed `dojo.js` or in which `<base>` tags confuse
	//		some browsers (e.g. IE 6). The variable `dojo.baseUrl` is assigned
	//		either the value of `djConfig.baseUrl` if one is provided or the
	//		auto-detected root if not. Other modules are located relative to
	//		this path.
	baseUrl: undefined,
	// modulePaths: Object
	//		A map of module names to paths relative to `dojo.baseUrl`. The
	//		key/value pairs correspond directly to the arguments which
	//		`dojo.registerModulePath` accepts. Specifiying
	//		`djConfig.modulePaths = { ""foo"": ""../../bar"" }` is the equivalent
	//		of calling `dojo.registerModulePath(""foo"", ""../../bar"");`. Multiple
	//		modules may be configured via `djConfig.modulePaths`.
	modulePaths: {},
	// afterOnLoad: Boolean 
	//		Indicates Dojo was added to the page after the page load. In this case
	//		Dojo will not wait for the page DOMContentLoad/load events and fire
	//		its dojo.addOnLoad callbacks after making sure all outstanding
	//		dojo.required modules have loaded.
	afterOnLoad: false,
	// addOnLoad: Function or Array
	//		Adds a callback via dojo.addOnLoad. Useful when Dojo is added after
	//		the page loads and djConfig.afterOnLoad is true. Supports the same
	//		arguments as dojo.addOnLoad. When using a function reference, use
	//		`djConfig.addOnLoad = function(){};`. For object with function name use
	//		`djConfig.addOnLoad = [myObject, ""functionName""];` and for object with
	//		function reference use
	//		`djConfig.addOnLoad = [myObject, function(){}];`
	addOnLoad: null,
	// require: Array
	//		An array of module names to be loaded immediately after dojo.js has been included
	//		in a page. 
	require: []
}
=====*/

(function(){
	// firebug stubs

	// if((!this[""console""])||(!console[""firebug""])){

	if(!this[""console""]){
		this.console = {
		};
	}

	//	Be careful to leave 'log' always at the end
	var cn = [
		""assert"", ""count"", ""debug"", ""dir"", ""dirxml"", ""error"", ""group"",
		""groupEnd"", ""info"", ""profile"", ""profileEnd"", ""time"", ""timeEnd"",
		""trace"", ""warn"", ""log"" 
	];
	var i=0, tn;
	while((tn=cn[i++])){
		if(!console[tn]){
			(function(){
				var tcn = tn+"""";
				console[tcn] = ('log' in console) ? function(){ 
					var a = Array.apply({}, arguments);
					a.unshift(tcn+"":"");
					console[""log""](a.join("" ""));
				} : function(){}
			})();
		}
	}

	//TODOC:  HOW TO DOC THIS?
	// dojo is the root variable of (almost all) our public symbols -- make sure it is defined.
	if(typeof dojo == ""undefined""){
		this.dojo = {
			_scopeName: ""dojo"",
			_scopePrefix: """",
			_scopePrefixArgs: """",
			_scopeSuffix: """",
			_scopeMap: {},
			_scopeMapRev: {}
		};
	}

	var d = dojo;

	//Need placeholders for dijit and dojox for scoping code.
	if(typeof dijit == ""undefined""){
		this.dijit = {_scopeName: ""dijit""};
	}
	if(typeof dojox == ""undefined""){
		this.dojox = {_scopeName: ""dojox""};
	}
	
	if(!d._scopeArgs){
		d._scopeArgs = [dojo, dijit, dojox];
	}

/*=====
dojo.global = {
	//	summary:
	//		Alias for the global scope
	//		(e.g. the window object in a browser).
	//	description:
	//		Refer to 'dojo.global' rather than referring to window to ensure your
	//		code runs correctly in contexts other than web browsers (e.g. Rhino on a server).
}
=====*/
	d.global = this;

	d.config =/*===== djConfig = =====*/{
		isDebug: false,
		debugAtAllCosts: false
	};

	if(typeof djConfig != ""undefined""){
		for(var opt in djConfig){
			d.config[opt] = djConfig[opt];
		}
	}

	var _platforms = [""Browser"", ""Rhino"", ""Spidermonkey"", ""Mobile""];
	var t;
	while((t=_platforms.shift())){
		d[""is""+t] = false;
	}

/*=====
	// Override locale setting, if specified
	dojo.locale = {
		// summary: the locale as defined by Dojo (read-only)
	};
=====*/
	dojo.locale = d.config.locale;
	
	var rev = ""$Rev: 15385 $"".match(/\d+/);

	dojo.version = {
		// summary: 
		//		version number of dojo
		//	major: Integer
		//		Major version. If total version is ""1.2.0beta1"", will be 1
		//	minor: Integer
		//		Minor version. If total version is ""1.2.0beta1"", will be 2
		//	patch: Integer
		//		Patch version. If total version is ""1.2.0beta1"", will be 0
		//	flag: String
		//		Descriptor flag. If total version is ""1.2.0beta1"", will be ""beta1""
		//	revision: Number
		//		The SVN rev from which dojo was pulled
		major: 1, minor: 2, patch: 0, flag: """",
		revision: rev ? +rev[0] : 999999, //FIXME: use NaN?
		toString: function(){
			with(d.version){
				return major + ""."" + minor + ""."" + patch + flag + "" ("" + revision + "")"";	// String
			}
		}
	}

	// Register with the OpenAjax hub
	if(typeof OpenAjax != ""undefined""){
		OpenAjax.hub.registerLibrary(dojo._scopeName, ""http://dojotoolkit.org"", d.version.toString());
	}

	dojo._mixin = function(/*Object*/ obj, /*Object*/ props){
		// summary:
		//		Adds all properties and methods of props to obj. This addition
		//		is ""prototype extension safe"", so that instances of objects
		//		will not pass along prototype defaults.
		var tobj = {};
		for(var x in props){
			// the ""tobj"" condition avoid copying properties in ""props""
			// inherited from Object.prototype.  For example, if obj has a custom
			// toString() method, don't overwrite it with the toString() method
			// that props inherited from Object.prototype
			if(tobj[x] === undefined || tobj[x] != props[x]){
				obj[x] = props[x];
			}
		}
		// IE doesn't recognize custom toStrings in for..in
		if(d[""isIE""] && props){
			var p = props.toString;
			if(typeof p == ""function"" && p != obj.toString && p != tobj.toString &&
				p != ""\nfunction toString() {\n    [native code]\n}\n""){
					obj.toString = props.toString;
			}
		}
		return obj; // Object
	}

	dojo.mixin = function(/*Object*/obj, /*Object...*/props){
		// summary:	
		//		Adds all properties and methods of props to obj and returns the
		//		(now modified) obj.
		//	description:
		//		`dojo.mixin` can mix multiple source objects into a
		//		destionation object which is then returned. Unlike regular
		//		`for...in` iteration, `dojo.mixin` is also smart about avoiding
		//		extensions which other toolkits may unwisely add to the root
		//		object prototype
		//	obj:
		//		The object to mix properties into. Also the return value.
		//	props:
		//		One or more objects whose values are successively copied into
		//		obj. If more than one of these objects contain the same value,
		//		the one specified last in the function call will ""win"".
		//	example:
		//		make a shallow copy of an object
		//	|	var copy = dojo.mixin({}, source);
		//	example:
		//		many class constructors often take an object which specifies
		//		values to be configured on the object. In this case, it is
		//		often simplest to call `dojo.mixin` on the `this` object:
		//	|	dojo.declare(""acme.Base"", null, {
		//	|		constructor: function(properties){
		//	|			// property configuration:
		//	|			dojo.mixin(this, properties);
		//	|	
		//	|			
		//	|			//  ...
		//	|		},
		//	|		quip: ""I wasn't born yesterday, you know - I've seen movies."",
		//	|		// ...
		//	|	});
		//	|
		//	|	// create an instance of the class and configure it
		//	|	var b = new acme.Base({quip: ""That's what it does!"" });
		//	example:
		//		copy in properties from multiple objects
		//	|	var flattened = dojo.mixin(
		//	|		{
		//	|			name: ""Frylock"",
		//	|			braces: true
		//	|		},
		//	|		{
		//	|			name: ""Carl Brutanananadilewski""
		//	|		}
		//	|	);
		//	|	
		//	|	// will print ""Carl Brutanananadilewski""
		//	|	
		//	|	// will print ""true""
		//	|	
		for(var i=1, l=arguments.length; i<l; i++){
			d._mixin(obj, arguments[i]);
		}
		return obj; // Object
	}

	dojo._getProp = function(/*Array*/parts, /*Boolean*/create, /*Object*/context){
		var obj=context || d.global;
		for(var i=0, p; obj && (p=parts[i]); i++){
			if(i == 0 && this._scopeMap[p]){
				p = this._scopeMap[p];
			}
			obj = (p in obj ? obj[p] : (create ? obj[p]={} : undefined));
		}
		return obj; // mixed
	}

	dojo.setObject = function(/*String*/name, /*Object*/value, /*Object?*/context){
		// summary: 
		//		Set a property from a dot-separated string, such as ""A.B.C""
		//	description: 
		//		Useful for longer api chains where you have to test each object in
		//		the chain, or when you have an object reference in string format.
		//		Objects are created as needed along `path`. Returns the passed
		//		value if setting is successful or `undefined` if not.
		//	name: 	
		//		Path to a property, in the form ""A.B.C"".
		//	context:
		//		Optional. Object to use as root of path. Defaults to
		//		`dojo.global`.
		//	example:
		//		set the value of `foo.bar.baz`, regardless of whether
		//		intermediate objects already exist:
		//	|	dojo.setObject(""foo.bar.baz"", value);
		//	example:
		//		without `dojo.setObject`, we often see code like this:
		//	|	// ensure that intermediate objects are available
		//	|	if(!obj[""parent""]){ obj.parent = {}; }
		//	|	if(!obj.parent[""child""]){ obj.parent.child= {}; }
		//	|	// now we can safely set the property
		//	|	obj.parent.child.prop = ""some value"";
		//		wheras with `dojo.setObject`, we can shorten that to:
		//	|	dojo.setObject(""parent.child.prop"", ""some value"", obj);
		var parts=name.split("".""), p=parts.pop(), obj=d._getProp(parts, true, context);
		return obj && p ? (obj[p]=value) : undefined; // Object
	}

	dojo.getObject = function(/*String*/name, /*Boolean*/create, /*Object*/context){
		// summary: 
		//		Get a property from a dot-separated string, such as ""A.B.C""
		//	description: 
		//		Useful for longer api chains where you have to test each object in
		//		the chain, or when you have an object reference in string format.
		//	name: 	
		//		Path to an property, in the form ""A.B.C"".
		//	context:
		//		Optional. Object to use as root of path. Defaults to
		//		'dojo.global'. Null may be passed.
		//	create: 
		//		Optional. Defaults to `false`. If `true`, Objects will be
		//		created at any point along the 'path' that is undefined.
		return d._getProp(name.split("".""), create, context); // Object
	}

	dojo.exists = function(/*String*/name, /*Object?*/obj){
		//	summary: 
		//		determine if an object supports a given method
		//	description: 
		//		useful for longer api chains where you have to test each object in
		//		the chain
		//	name: 	
		//		Path to an object, in the form ""A.B.C"".
		//	obj:
		//		Object to use as root of path. Defaults to
		//		'dojo.global'. Null may be passed.
		//	example:
		//	|	// define an object
		//	|	var foo = {
		//	|		bar: { }
		//	|	};
		//	|
		//	|	// search the global scope
		//	|	dojo.exists(""foo.bar""); // true
		//	|	dojo.exists(""foo.bar.baz""); // false
		//	|
		//	|	// search from a particular scope
		//	|	dojo.exists(""bar"", foo); // true
		//	|	dojo.exists(""bar.baz"", foo); // false
		return !!d.getObject(name, false, obj); // Boolean
	}


	dojo[""eval""] = function(/*String*/ scriptFragment){
		//	summary: 
		//		Perform an evaluation in the global scope. Use this rather than
		//		calling 'eval()' directly.
		//	description: 
		//		Placed in a separate function to minimize size of trapped
		//		exceptions. Calling eval() directly from some other scope may
		//		complicate tracebacks on some platforms.
		//	returns:
		//		The result of the evaluation. Often `undefined`


		// note:
		//	 - JSC eval() takes an optional second argument which can be 'unsafe'.
		//	 - Mozilla/SpiderMonkey eval() takes an optional second argument which is the
		//  	 scope object for new symbols.

		// FIXME: investigate Joseph Smarr's technique for IE:
		//		http://josephsmarr.com/2007/01/31/fixing-eval-to-use-global-scope-in-ie/
		//	see also:
		// 		http://trac.dojotoolkit.org/ticket/744
		return d.global.eval ? d.global.eval(scriptFragment) : eval(scriptFragment); 	// Object
	}

	/*=====
		dojo.deprecated = function(behaviour, extra, removal){
			//	summary: 
			//		Log a debug message to indicate that a behavior has been
			//		deprecated.
			//	behaviour: String
			//		The API or behavior being deprecated. Usually in the form
			//		of ""myApp.someFunction()"".
			//	extra: String?
			//		Text to append to the message. Often provides advice on a
			//		new function or facility to achieve the same goal during
			//		the deprecation period.
			//	removal: String?
			//		Text to indicate when in the future the behavior will be
			//		removed. Usually a version number.
			//	example:
			//	|	dojo.deprecated(""myApp.getTemp()"", ""use myApp.getLocaleTemp() instead"", ""1.0"");
		}

		dojo.experimental = function(moduleName, extra){
			//	summary: Marks code as experimental.
			//	description: 
			//	 	This can be used to mark a function, file, or module as
			//	 	experimental.  Experimental code is not ready to be used, and the
			//	 	APIs are subject to change without notice.  Experimental code may be
			//	 	completed deleted without going through the normal deprecation
			//	 	process.
			//	moduleName: String
			//	 	The name of a module, or the name of a module file or a specific
			//	 	function
			//	extra: String?
			//	 	some additional message for the user
			//	example:
			//	|	dojo.experimental(""dojo.data.Result"");
			//	example:
			//	|	dojo.experimental(""dojo.weather.toKelvin()"", ""PENDING approval from NOAA"");
		}
	=====*/

	//Real functions declared in dojo._firebug.firebug.
	d.deprecated = d.experimental = function(){};

})();
// vim:ai:ts=4:noet

/*
 * loader.js - A bootstrap module.  Runs before the hostenv_*.js file. Contains
 * all of the package loading methods.
 */

(function(){
	var d = dojo;

	d.mixin(d, {
		_loadedModules: {},
		_inFlightCount: 0,
		_hasResource: {},

		_modulePrefixes: {
			dojo: 	{	name: ""dojo"", value: ""."" },
			// dojox: 	{	name: ""dojox"", value: ""../dojox"" },
			// dijit: 	{	name: ""dijit"", value: ""../dijit"" },
			doh: 	{	name: ""doh"", value: ""../util/doh"" },
			tests: 	{	name: ""tests"", value: ""tests"" }
		},

		_moduleHasPrefix: function(/*String*/module){
			// summary: checks to see if module has been established
			var mp = this._modulePrefixes;
			return !!(mp[module] && mp[module].value); // Boolean
		},

		_getModulePrefix: function(/*String*/module){
			// summary: gets the prefix associated with module
			var mp = this._modulePrefixes;
			if(this._moduleHasPrefix(module)){
				return mp[module].value; // String
			}
			return module; // String
		},

		_loadedUrls: [],

		//WARNING: 
		//		This variable is referenced by packages outside of bootstrap:
		//		FloatingPane.js and undo/browser.js
		_postLoad: false,
		
		//Egad! Lots of test files push on this directly instead of using dojo.addOnLoad.
		_loaders: [],
		_unloaders: [],
		_loadNotifying: false
	});


		dojo._loadPath = function(/*String*/relpath, /*String?*/module, /*Function?*/cb){
		// 	summary:
		//		Load a Javascript module given a relative path
		//
		//	description:
		//		Loads and interprets the script located at relpath, which is
		//		relative to the script root directory.  If the script is found but
		//		its interpretation causes a runtime exception, that exception is
		//		not caught by us, so the caller will see it.  We return a true
		//		value if and only if the script is found.
		//
		// relpath: 
		//		A relative path to a script (no leading '/', and typically ending
		//		in '.js').
		// module: 
		//		A module whose existance to check for after loading a path.  Can be
		//		used to determine success or failure of the load.
		// cb: 
		//		a callback function to pass the result of evaluating the script

		var uri = ((relpath.charAt(0) == '/' || relpath.match(/^\w+:/)) ? """" : this.baseUrl) + relpath;
		try{
			return !module ? this._loadUri(uri, cb) : this._loadUriAndCheck(uri, module, cb); // Boolean
		}catch(e){
			console.error(e);
			return false; // Boolean
		}
	}

	dojo._loadUri = function(/*String*/uri, /*Function?*/cb){
		//	summary:
		//		Loads JavaScript from a URI
		//	description:
		//		Reads the contents of the URI, and evaluates the contents.  This is
		//		used to load modules as well as resource bundles. Returns true if
		//		it succeeded. Returns false if the URI reading failed.  Throws if
		//		the evaluation throws.
		//	uri: a uri which points at the script to be loaded
		//	cb: 
		//		a callback function to process the result of evaluating the script
		//		as an expression, typically used by the resource bundle loader to
		//		load JSON-style resources

		if(this._loadedUrls[uri]){
			return true; // Boolean
		}
		var contents = this._getText(uri, true);
		if(!contents){ return false; } // Boolean
		this._loadedUrls[uri] = true;
		this._loadedUrls.push(uri);
		if(cb){
			contents = '('+contents+')';
		}else{
			//Only do the scoping if no callback. If a callback is specified,
			//it is most likely the i18n bundle stuff.
			contents = this._scopePrefix + contents + this._scopeSuffix;
		}
		if(d.isMoz){ contents += ""\r\n//@ sourceURL="" + uri; } // debugging assist for Firebug
		var value = d[""eval""](contents);
		if(cb){ cb(value); }
		return true; // Boolean
	}
	
	// FIXME: probably need to add logging to this method
	dojo._loadUriAndCheck = function(/*String*/uri, /*String*/moduleName, /*Function?*/cb){
		// summary: calls loadUri then findModule and returns true if both succeed
		var ok = false;
		try{
			ok = this._loadUri(uri, cb);
		}catch(e){
			console.error(""failed loading "" + uri + "" with error: "" + e);
		}
		return !!(ok && this._loadedModules[moduleName]); // Boolean
	}

	dojo.loaded = function(){
		// summary:
		//		signal fired when initial environment and package loading is
		//		complete. You may use dojo.addOnLoad() or dojo.connect() to
		//		this method in order to handle initialization tasks that
		//		require the environment to be initialized. In a browser host,
		//		declarative widgets will be constructed when this function
		//		finishes runing.
		this._loadNotifying = true;
		this._postLoad = true;
		var mll = d._loaders;

		//Clear listeners so new ones can be added
		//For other xdomain package loads after the initial load.
		this._loaders = [];

		for(var x = 0; x < mll.length; x++){
			mll[x]();
		}

		this._loadNotifying = false;
		
		//Make sure nothing else got added to the onload queue
		//after this first run. If something did, and we are not waiting for any
		//more inflight resources, run again.
		if(d._postLoad && d._inFlightCount == 0 && mll.length){
			d._callLoaded();
		}
	}

	dojo.unloaded = function(){
		// summary:
		//		signal fired by impending environment destruction. You may use
		//		dojo.addOnUnload() or dojo.connect() to this method to perform
		//		page/application cleanup methods. See dojo.addOnUnload for more info.
		var mll = this._unloaders;
		while(mll.length){
			(mll.pop())();
		}
	}

	d._onto = function(arr, obj, fn){
		if(!fn){
			arr.push(obj);
		}else if(fn){
			var func = (typeof fn == ""string"") ? obj[fn] : fn;
			arr.push(function(){ func.call(obj); });
		}
	}

	dojo.addOnLoad = function(/*Object?*/obj, /*String|Function*/functionName){
		// summary:
		//		Registers a function to be triggered after the DOM has finished
		//		loading and widgets declared in markup have been instantiated.
		//		Images and CSS files may or may not have finished downloading when
		//		the specified function is called.  (Note that widgets' CSS and HTML
		//		code is guaranteed to be downloaded before said widgets are
		//		instantiated.)
		// example:
		//	|	dojo.addOnLoad(functionPointer);
		//	|	dojo.addOnLoad(object, ""functionName"");
		//	|	dojo.addOnLoad(object, function(){ /* ... */});

		d._onto(d._loaders, obj, functionName);

		//Added for xdomain loading. dojo.addOnLoad is used to
		//indicate callbacks after doing some dojo.require() statements.
		//In the xdomain case, if all the requires are loaded (after initial
		//page load), then immediately call any listeners.
		if(d._postLoad && d._inFlightCount == 0 && !d._loadNotifying){
			d._callLoaded();
		}
	}

	//Support calling dojo.addOnLoad via djConfig.addOnLoad. Support all the
	//call permutations of dojo.addOnLoad. Mainly useful when dojo is added
	//to the page after the page has loaded.
	var dca = d.config.addOnLoad;
	if(dca){
		d.addOnLoad[(dca instanceof Array ? ""apply"" : ""call"")](d, dca);
	}

	dojo.addOnUnload = function(/*Object?*/obj, /*String|Function?*/functionName){
		// summary:
		//		registers a function to be triggered when the page unloads. In a browser
		//		enviroment, the functions will be triggered during the window.onbeforeunload
		//		event. Be careful doing work during window.onbeforeunload. onbeforeunload
		//		can be triggered if a link to download a file is clicked, or if the link is a
		//		javascript: link. In these cases, the onbeforeunload event fires, but the
		//		document is not actually destroyed. So be careful about doing destructive
		//		operations in a dojo.addOnUnload callback.
		// example:
		//	|	dojo.addOnUnload(functionPointer)
		//	|	dojo.addOnUnload(object, ""functionName"")
		//	|	dojo.addOnUnload(object, function(){ /* ... */});

		d._onto(d._unloaders, obj, functionName);
	}

	dojo._modulesLoaded = function(){
		if(d._postLoad){ return; }
		if(d._inFlightCount > 0){ 
			console.warn(""files still in flight!"");
			return;
		}
		d._callLoaded();
	}

	dojo._callLoaded = function(){

		// The ""object"" check is for IE, and the other opera check fixes an
		// issue in Opera where it could not find the body element in some
		// widget test cases.  For 0.9, maybe route all browsers through the
		// setTimeout (need protection still for non-browser environments
		// though). This might also help the issue with FF 2.0 and freezing
		// issues where we try to do sync xhr while background css images are
		// being loaded (trac #2572)? Consider for 0.9.
		if(typeof setTimeout == ""object"" || (dojo.config.useXDomain && d.isOpera)){
			if(dojo.isAIR){
				setTimeout(function(){dojo.loaded();}, 0);
			}else{
				setTimeout(dojo._scopeName + "".loaded();"", 0);
			}
		}else{
			d.loaded();
		}
	}

	dojo._getModuleSymbols = function(/*String*/modulename){
		// summary:
		//		Converts a module name in dotted JS notation to an array
		//		representing the path in the source tree
		var syms = modulename.split(""."");
		for(var i = syms.length; i>0; i--){
			var parentModule = syms.slice(0, i).join(""."");
			if((i==1) && !this._moduleHasPrefix(parentModule)){		
				// Support default module directory (sibling of dojo) for top-level modules 
				syms[0] = ""../"" + syms[0];
			}else{
				var parentModulePath = this._getModulePrefix(parentModule);
				if(parentModulePath != parentModule){
					syms.splice(0, i, parentModulePath);
					break;
				}
			}
		}
		// 
		return syms; // Array
	}

	dojo._global_omit_module_check = false;

	dojo.loadInit = function(/*Function*/init){
		//	summary:
		//		Executes a function that needs to be executed for the loader's dojo.requireIf
		//		resolutions to work. This is needed mostly for the xdomain loader case where
		//		a function needs to be executed to set up the possible values for a dojo.requireIf
		//		call.
		//	init:
		//		a function reference. Executed immediately.
		//	description: This function is mainly a marker for the xdomain loader to know parts of
		//		code that needs be executed outside the function wrappper that is placed around modules.
		//		The init function could be executed more than once, and it should make no assumptions
		//		on what is loaded, or what modules are available. Only the functionality in Dojo Base
		//		is allowed to be used. Avoid using this method. For a valid use case,
		//		see the source for dojox.gfx.
		init();
	}

	dojo._loadModule = dojo.require = function(/*String*/moduleName, /*Boolean?*/omitModuleCheck){
		//	summary:
		//		loads a Javascript module from the appropriate URI
		//	moduleName:
		//		module name to load, using periods for separators,
		//		 e.g. ""dojo.date.locale"".  Module paths are de-referenced by dojo's
		//		internal mapping of locations to names and are disambiguated by
		//		longest prefix. See `dojo.registerModulePath()` for details on
		//		registering new modules.
		//	omitModuleCheck:
		//		if `true`, omitModuleCheck skips the step of ensuring that the
		//		loaded file actually defines the symbol it is referenced by.
		//		For example if it called as `dojo.require(""a.b.c"")` and the
		//		file located at `a/b/c.js` does not define an object `a.b.c`,
		//		and exception will be throws whereas no exception is raised
		//		when called as `dojo.require(""a.b.c"", true)`
		//	description:
		//		`dojo.require(""A.B"")` first checks to see if symbol A.B is
		//		defined. If it is, it is simply returned (nothing to do).
		//	
		//		If it is not defined, it will look for `A/B.js` in the script root
		//		directory.
		//	
		//		`dojo.require` throws an excpetion if it cannot find a file
		//		to load, or if the symbol `A.B` is not defined after loading.
		//	
		//		It returns the object `A.B`.
		//	
		//		`dojo.require()` does nothing about importing symbols into
		//		the current namespace.  It is presumed that the caller will
		//		take care of that. For example, to import all symbols into a
		//		local block, you might write:
		//	
		//		|	with (dojo.require(""A.B"")) {
		//		|		...
		//		|	}
		//	
		//		And to import just the leaf symbol to a local variable:
		//	
		//		|	var B = dojo.require(""A.B"");
		//	   	|	...
		//	returns: the required namespace object
		omitModuleCheck = this._global_omit_module_check || omitModuleCheck;

		//Check if it is already loaded.
		var module = this._loadedModules[moduleName];
		if(module){
			return module;
		}

		// convert periods to slashes
		var relpath = this._getModuleSymbols(moduleName).join(""/"") + '.js';

		var modArg = (!omitModuleCheck) ? moduleName : null;
		var ok = this._loadPath(relpath, modArg);

		if(!ok && !omitModuleCheck){
			throw new Error(""Could not load '"" + moduleName + ""'; last tried '"" + relpath + ""'"");
		}

		// check that the symbol was defined
		// Don't bother if we're doing xdomain (asynchronous) loading.
		if(!omitModuleCheck && !this._isXDomain){
			// pass in false so we can give better error
			module = this._loadedModules[moduleName];
			if(!module){
				throw new Error(""symbol '"" + moduleName + ""' is not defined after loading '"" + relpath + ""'""); 
			}
		}

		return module;
	}

	dojo.provide = function(/*String*/ resourceName){
		//	summary:
		//		Each javascript source file must have at least one
		//		`dojo.provide()` call at the top of the file, corresponding to
		//		the file name.  For example, `js/dojo/foo.js` must have
		//		`dojo.provide(""dojo.foo"");` before any calls to
		//		`dojo.require()` are made.
		//	description:
		//		Each javascript source file is called a resource.  When a
		//		resource is loaded by the browser, `dojo.provide()` registers
		//		that it has been loaded.
		//	
		//		For backwards compatibility reasons, in addition to registering
		//		the resource, `dojo.provide()` also ensures that the javascript
		//		object for the module exists.  For example,
		//		`dojo.provide(""dojox.data.FlickrStore"")`, in addition to
		//		registering that `FlickrStore.js` is a resource for the
		//		`dojox.data` module, will ensure that the `dojox.data`
		//		javascript object exists, so that calls like 
		//		`dojo.data.foo = function(){ ... }` don't fail.
		//
		//		In the case of a build where multiple javascript source files
		//		are combined into one bigger file (similar to a .lib or .jar
		//		file), that file may contain multiple dojo.provide() calls, to
		//		note that it includes multiple resources.

		//Make sure we have a string.
		resourceName = resourceName + """";
		return (d._loadedModules[resourceName] = d.getObject(resourceName, true)); // Object
	}

	//Start of old bootstrap2:

	dojo.platformRequire = function(/*Object*/modMap){
		//	summary:
		//		require one or more modules based on which host environment
		//		Dojo is currently operating in
		//	description:
		//		This method takes a ""map"" of arrays which one can use to
		//		optionally load dojo modules. The map is indexed by the
		//		possible dojo.name_ values, with two additional values:
		//		""default"" and ""common"". The items in the ""default"" array will
		//		be loaded if none of the other items have been choosen based on
		//		dojo.name_, set by your host environment. The items in the
		//		""common"" array will *always* be loaded, regardless of which
		//		list is chosen.
		//	example:
		//		|	dojo.platformRequire({
		//		|		browser: [
		//		|			""foo.sample"", // simple module
		//		|			""foo.test"",
		//		|			[""foo.bar.baz"", true] // skip object check in _loadModule (dojo.require)
		//		|		],
		//		|		default: [ ""foo.sample._base"" ],
		//		|		common: [ ""important.module.common"" ]
		//		|	});

		var common = modMap.common || [];
		var result = common.concat(modMap[d._name] || modMap[""default""] || []);

		for(var x=0; x<result.length; x++){
			var curr = result[x];
			if(curr.constructor == Array){
				d._loadModule.apply(d, curr);
			}else{
				d._loadModule(curr);
			}
		}
	}

	dojo.requireIf = function(/*Boolean*/ condition, /*String*/ resourceName){
		// summary:
		//		If the condition is true then call dojo.require() for the specified
		//		resource
		if(condition === true){
			// FIXME: why do we support chained require()'s here? does the build system?
			var args = [];
			for(var i = 1; i < arguments.length; i++){ 
				args.push(arguments[i]);
			}
			d.require.apply(d, args);
		}
	}

	dojo.requireAfterIf = d.requireIf;

	dojo.registerModulePath = function(/*String*/module, /*String*/prefix){
		//	summary: 
		//		maps a module name to a path
		//	description: 
		//		An unregistered module is given the default path of ../[module],
		//		relative to Dojo root. For example, module acme is mapped to
		//		../acme.  If you want to use a different module name, use
		//		dojo.registerModulePath. 
		//	example:
		//		If your dojo.js is located at this location in the web root:
		//	|	/myapp/js/dojo/dojo/dojo.js
		//		and your modules are located at:
		//	|	/myapp/js/foo/bar.js
		//	|	/myapp/js/foo/baz.js
		//	|	/myapp/js/foo/thud/xyzzy.js
		//		Your application can tell Dojo to locate the ""foo"" namespace by calling:
		//	|	dojo.registerModulePath(""foo"", ""../../foo"");
		//		At which point you can then use dojo.require() to load the
		//		modules (assuming they provide() the same things which are
		//		required). The full code might be:
		//	|	<script type=""text/javascript"" 
		//	|		src=""/myapp/js/dojo/dojo/dojo.js""></script>
		//	|	<script type=""text/javascript"">
		//	|		dojo.registerModulePath(""foo"", ""../../foo"");
		//	|		dojo.require(""foo.bar"");
		//	|		dojo.require(""foo.baz"");
		//	|		dojo.require(""foo.thud.xyzzy"");
		//	|	</script>
		d._modulePrefixes[module] = { name: module, value: prefix };
	}

	dojo.requireLocalization = function(/*String*/moduleName, /*String*/bundleName, /*String?*/locale, /*String?*/availableFlatLocales){
		// summary:
		//		Declares translated resources and loads them if necessary, in the
		//		same style as dojo.require.  Contents of the resource bundle are
		//		typically strings, but may be any name/value pair, represented in
		//		JSON format.  See also `dojo.i18n.getLocalization`.
		//
		// description:
		//		Load translated resource bundles provided underneath the ""nls""
		//		directory within a package.  Translated resources may be located in
		//		different packages throughout the source tree.  
		//
		//		Each directory is named for a locale as specified by RFC 3066,
		//		(http://www.ietf.org/rfc/rfc3066.txt), normalized in lowercase.
		//		Note that the two bundles in the example do not define all the
		//		same variants.  For a given locale, bundles will be loaded for
		//		that locale and all more general locales above it, including a
		//		fallback at the root directory.  For example, a declaration for
		//		the ""de-at"" locale will first load `nls/de-at/bundleone.js`,
		//		then `nls/de/bundleone.js` and finally `nls/bundleone.js`.  The
		//		data will be flattened into a single Object so that lookups
		//		will follow this cascading pattern.  An optional build step can
		//		preload the bundles to avoid data redundancy and the multiple
		//		network hits normally required to load these resources.
		//
		// moduleName: 
		//		name of the package containing the ""nls"" directory in which the
		//		bundle is found
		//
		// bundleName: 
		//		bundle name, i.e. the filename without the '.js' suffix
		//
		// locale: 
		//		the locale to load (optional)  By default, the browser's user
		//		locale as defined by dojo.locale
		//
		// availableFlatLocales: 
		//		A comma-separated list of the available, flattened locales for this
		//		bundle. This argument should only be set by the build process.
		//
		//	example:
		//		A particular widget may define one or more resource bundles,
		//		structured in a program as follows, where moduleName is
		//		mycode.mywidget and bundleNames available include bundleone and
		//		bundletwo:
		//	|		...
		//	|	mycode/
		//	|		mywidget/
		//	|			nls/
		//	|				bundleone.js (the fallback translation, English in this example)
		//	|				bundletwo.js (also a fallback translation)
		//	|				de/
		//	|					bundleone.js
		//	|					bundletwo.js
		//	|				de-at/
		//	|					bundleone.js
		//	|				en/
		//	|					(empty; use the fallback translation)
		//	|				en-us/
		//	|					bundleone.js
		//	|				en-gb/
		//	|					bundleone.js
		//	|				es/
		//	|					bundleone.js
		//	|					bundletwo.js
		//	|				  ...etc
		//	|				...
		//

		d.require(""dojo.i18n"");
		d.i18n._requireLocalization.apply(d.hostenv, arguments);
	};


	var ore = new RegExp(""^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"");
	var ire = new RegExp(""^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$"");

	dojo._Url = function(/*dojo._Url||String...*/){
		// summary: 
		//		Constructor to create an object representing a URL.
		//		It is marked as private, since we might consider removing
		//		or simplifying it.
		// description: 
		//		Each argument is evaluated in order relative to the next until
		//		a canonical uri is produced. To get an absolute Uri relative to
		//		the current document use:
		//      	new dojo._Url(document.baseURI, url)

		var n = null;

		var _a = arguments;
		var uri = [_a[0]];
		// resolve uri components relative to each other
		for(var i = 1; i<_a.length; i++){
			if(!_a[i]){ continue; }

			// Safari doesn't support this.constructor so we have to be explicit
			// FIXME: Tracked (and fixed) in Webkit bug 3537.
			//		http://bugs.webkit.org/show_bug.cgi?id=3537
			var relobj = new d._Url(_a[i]+"""");
			var uriobj = new d._Url(uri[0]+"""");

			if(
				relobj.path == """" &&
				!relobj.scheme &&
				!relobj.authority &&
				!relobj.query
			){
				if(relobj.fragment != n){
					uriobj.fragment = relobj.fragment;
				}
				relobj = uriobj;
			}else if(!relobj.scheme){
				relobj.scheme = uriobj.scheme;

				if(!relobj.authority){
					relobj.authority = uriobj.authority;

					if(relobj.path.charAt(0) != ""/""){
						var path = uriobj.path.substring(0,
							uriobj.path.lastIndexOf(""/"") + 1) + relobj.path;

						var segs = path.split(""/"");
						for(var j = 0; j < segs.length; j++){
							if(segs[j] == "".""){
								// flatten ""./"" references
								if(j == segs.length - 1){
									segs[j] = """";
								}else{
									segs.splice(j, 1);
									j--;
								}
							}else if(j > 0 && !(j == 1 && segs[0] == """") &&
								segs[j] == "".."" && segs[j-1] != ""..""){
								// flatten ""../"" references
								if(j == (segs.length - 1)){
									segs.splice(j, 1);
									segs[j - 1] = """";
								}else{
									segs.splice(j - 1, 2);
									j -= 2;
								}
							}
						}
						relobj.path = segs.join(""/"");
					}
				}
			}

			uri = [];
			if(relobj.scheme){ 
				uri.push(relobj.scheme, "":"");
			}
			if(relobj.authority){
				uri.push(""//"", relobj.authority);
			}
			uri.push(relobj.path);
			if(relobj.query){
				uri.push(""?"", relobj.query);
			}
			if(relobj.fragment){
				uri.push(""#"", relobj.fragment);
			}
		}

		this.uri = uri.join("""");

		// break the uri into its main components
		var r = this.uri.match(ore);

		this.scheme = r[2] || (r[1] ? """" : n);
		this.authority = r[4] || (r[3] ? """" : n);
		this.path = r[5]; // can never be undefined
		this.query = r[7] || (r[6] ? """" : n);
		this.fragment  = r[9] || (r[8] ? """" : n);

		if(this.authority != n){
			// server based naming authority
			r = this.authority.match(ire);

			this.user = r[3] || n;
			this.password = r[4] || n;
			this.host = r[6] || r[7]; // ipv6 || ipv4
			this.port = r[9] || n;
		}
	}

	dojo._Url.prototype.toString = function(){ return this.uri; };

	dojo.moduleUrl = function(/*String*/module, /*dojo._Url||String*/url){
		//	summary: 
		//		Returns a `dojo._Url` object relative to a module.
		//	example:
		//	|	var pngPath = dojo.moduleUrl(""acme"",""images/small.png"");
		//	|	 // list the object properties
		//	|	// create an image and set it's source to pngPath's value:
		//	|	var img = document.createElement(""img"");
		// 	|	// NOTE: we assign the string representation of the url object
		//	|	img.src = pngPath.toString(); 
		//	|	// add our image to the document
		//	|	dojo.body().appendChild(img);
		//	example: 
		//		you may de-reference as far as you like down the package
		//		hierarchy.  This is sometimes handy to avoid lenghty relative
		//		urls or for building portable sub-packages. In this example,
		//		the `acme.widget` and `acme.util` directories may be located
		//		under different roots (see `dojo.registerModulePath`) but the
		//		the modules which reference them can be unaware of their
		//		relative locations on the filesystem:
		//	|	// somewhere in a configuration block
		//	|	dojo.registerModulePath(""acme.widget"", ""../../acme/widget"");
		//	|	dojo.registerModulePath(""acme.util"", ""../../util"");
		//	|	
		//	|	// ...
		//	|	
		//	|	// code in a module using acme resources
		//	|	var tmpltPath = dojo.moduleUrl(""acme.widget"",""templates/template.html"");
		//	|	var dataPath = dojo.moduleUrl(""acme.util"",""resources/data.json"");

		var loc = d._getModuleSymbols(module).join('/');
		if(!loc){ return null; }
		if(loc.lastIndexOf(""/"") != loc.length-1){
			loc += ""/"";
		}
		
		//If the path is an absolute path (starts with a / or is on another
		//domain/xdomain) then don't add the baseUrl.
		var colonIndex = loc.indexOf("":"");
		if(loc.charAt(0) != ""/"" && (colonIndex == -1 || colonIndex > loc.indexOf(""/""))){
			loc = d.baseUrl + loc;
		}

		return new d._Url(loc, url); // String
	}
})();

/*=====
dojo.isBrowser = {
	//	example:
	//	|	if(dojo.isBrowser){ ... }
};

dojo.isFF = {
	//	example:
	//	|	if(dojo.isFF > 1){ ... }
};

dojo.isIE = {
	// example:
	//	|	if(dojo.isIE > 6){
	//	|		// we are IE7
	// 	|	}
};

dojo.isSafari = {
	//	example:
	//	|	if(dojo.isSafari){ ... }
	//	example: 
	//		Detect iPhone:
	//	|	if(dojo.isSafari && navigator.userAgent.indexOf(""iPhone"") != -1){ 
	//	|		// we are iPhone. Note, iPod touch reports ""iPod"" above and fails this test.
	//	|	}
};

dojo = {
	// isBrowser: Boolean
	//		True if the client is a web-browser
	isBrowser: true,
	//	isFF: Number | undefined
	//		Version as a Number if client is FireFox. undefined otherwise. Corresponds to
	//		major detected FireFox version (1.5, 2, 3, etc.)
	isFF: 2,
	//	isIE: Number | undefined
	//		Version as a Number if client is MSIE(PC). undefined otherwise. Corresponds to
	//		major detected IE version (6, 7, 8, etc.)
	isIE: 6,
	//	isKhtml: Number | undefined
	//		Version as a Number if client is a KTHML-derived browser (Konqueror,
	//		Safari, etc.). undefined otherwise. Corresponds to major detected version.
	isKhtml: 0,
	//	isMozilla: Number | undefined
	//		Version as a Number if client is a Mozilla-based browser (Firefox,
	//		SeaMonkey). undefined otherwise. Corresponds to major detected version.
	isMozilla: 0,
	//	isOpera: Number | undefined
	//		Version as a Number if client is Opera. undefined otherwise. Corresponds to
	//		major detected version.
	isOpera: 0,
	//	isSafari: Number | undefined
	//		Version as a Number if client is Safari or iPhone. undefined otherwise.
	isSafari: 0
}
=====*/

if(typeof window != 'undefined'){
	dojo.isBrowser = true;
	dojo._name = ""browser"";


	// attempt to figure out the path to dojo if it isn't set in the config
	(function(){
		var d = dojo;
		// this is a scope protection closure. We set browser versions and grab
		// the URL we were loaded from here.

		// grab the node we were loaded from
		if(document && document.getElementsByTagName){
			var scripts = document.getElementsByTagName(""script"");
			var rePkg = /dojo(\.xd)?\.js(\W|$)/i;
			for(var i = 0; i < scripts.length; i++){
				var src = scripts[i].getAttribute(""src"");
				if(!src){ continue; }
				var m = src.match(rePkg);
				if(m){
					// find out where we came from
					if(!d.config.baseUrl){
						d.config.baseUrl = src.substring(0, m.index);
					}
					// and find out if we need to modify our behavior
					var cfg = scripts[i].getAttribute(""djConfig"");
					if(cfg){
						var cfgo = eval(""({ ""+cfg+"" })"");
						for(var x in cfgo){
							dojo.config[x] = cfgo[x];
						}
					}
					break; // ""first Dojo wins""
				}
			}
		}
		d.baseUrl = d.config.baseUrl;

		// fill in the rendering support information in dojo.render.*
		var n = navigator;
		var dua = n.userAgent;
		var dav = n.appVersion;
		var tv = parseFloat(dav);

		if(dua.indexOf(""Opera"") >= 0){ d.isOpera = tv; }
		// safari detection derived from:
		//		http://developer.apple.com/internet/safari/faq.html#anchor2
		//		http://developer.apple.com/internet/safari/uamatrix.html
		var index = Math.max(dav.indexOf(""WebKit""), dav.indexOf(""Safari""), 0);
		if(index){
			// try to grab the explicit Safari version first. If we don't get
			// one, look for 419.3+ as the indication that we're on something
			// ""Safari 3-ish"". Lastly, default to ""Safari 2"" handling.
			d.isSafari = parseFloat(dav.split(""Version/"")[1]) ||
				(parseFloat(dav.substr(index + 7)) > 419.3) ? 3 : 2;
		}
		if(dua.indexOf(""AdobeAIR"") >= 0){ d.isAIR = 1; }
		if(dav.indexOf(""Konqueror"") >= 0 || d.isSafari){ d.isKhtml =  tv; }
		if(dua.indexOf(""Gecko"") >= 0 && !d.isKhtml){ d.isMozilla = d.isMoz = tv; }
		if(d.isMoz){
			d.isFF = parseFloat(dua.split(""Firefox/"")[1]) || undefined;
		}
		if(document.all && !d.isOpera){
			d.isIE = parseFloat(dav.split(""MSIE "")[1]) || undefined;
		}

		//Workaround to get local file loads of dojo to work on IE 7
		//by forcing to not use native xhr.
		if(dojo.isIE && window.location.protocol === ""file:""){
			dojo.config.ieForceActiveXXhr=true;
		}

		var cm = document.compatMode;
		d.isQuirks = cm == ""BackCompat"" || cm == ""QuirksMode"" || d.isIE < 6;

		// TODO: is the HTML LANG attribute relevant?
		d.locale = dojo.config.locale || (d.isIE ? n.userLanguage : n.language).toLowerCase();

		// These are in order of decreasing likelihood; this will change in time.
		d._XMLHTTP_PROGIDS = ['Msxml2.XMLHTTP', 'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.4.0'];

		d._xhrObj = function(){
			// summary: 
			//		does the work of portably generating a new XMLHTTPRequest
			//		object.
			var http = null;
			var last_e = null;
			if(!dojo.isIE || !dojo.config.ieForceActiveXXhr){
				try{ http = new XMLHttpRequest(); }catch(e){}
			}
			if(!http){
				for(var i=0; i<3; ++i){
					var progid = d._XMLHTTP_PROGIDS[i];
					try{
						http = new ActiveXObject(progid);
					}catch(e){
						last_e = e;
					}

					if(http){
						d._XMLHTTP_PROGIDS = [progid];  // so faster next time
						break;
					}
				}
			}

			if(!http){
				throw new Error(""XMLHTTP not available: ""+last_e);
			}

			return http; // XMLHTTPRequest instance
		}

		d._isDocumentOk = function(http){
			var stat = http.status || 0;
			return (stat >= 200 && stat < 300) || 	// Boolean
				stat == 304 || 						// allow any 2XX response code
				stat == 1223 || 						// get it out of the cache
				(!stat && (location.protocol==""file:"" || location.protocol==""chrome:"") ); // Internet Explorer mangled the status code
		}

		//See if base tag is in use.
		//This is to fix http://trac.dojotoolkit.org/ticket/3973,
		//but really, we need to find out how to get rid of the dojo._Url reference
		//below and still have DOH work with the dojo.i18n test following some other
		//test that uses the test frame to load a document (trac #2757).
		//Opera still has problems, but perhaps a larger issue of base tag support
		//with XHR requests (hasBase is true, but the request is still made to document
		//path, not base path).
		var owloc = window.location+"""";
		var base = document.getElementsByTagName(""base"");
		var hasBase = (base && base.length > 0);

		d._getText = function(/*URI*/ uri, /*Boolean*/ fail_ok){
			// summary: Read the contents of the specified uri and return those contents.
			// uri:
			//		A relative or absolute uri. If absolute, it still must be in
			//		the same ""domain"" as we are.
			// fail_ok:
			//		Default false. If fail_ok and loading fails, return null
			//		instead of throwing.
			// returns: The response text. null is returned when there is a
			//		failure and failure is okay (an exception otherwise)

			// alert(""_getText: "" + uri);

			// NOTE: must be declared before scope switches ie. this._xhrObj()
			var http = this._xhrObj();

			if(!hasBase && dojo._Url){
				uri = (new dojo._Url(owloc, uri)).toString();
			}
			/*
			
			
			alert(uri);
			*/

			if(d.config.cacheBust){
				//Make sure we have a string before string methods are used on uri
				uri += """";
				uri += (uri.indexOf(""?"") == -1 ? ""?"" : ""&"") + String(d.config.cacheBust).replace(/\W+/g,"""");
			}

			http.open('GET', uri, false);
			try{
				http.send(null);
				// alert(http);
				if(!d._isDocumentOk(http)){
					var err = Error(""Unable to load ""+uri+"" status:""+ http.status);
					err.status = http.status;
					err.responseText = http.responseText;
					throw err;
				}
			}catch(e){
				if(fail_ok){ return null; } // null
				// rethrow the exception
				throw e;
			}
			return http.responseText; // String
		}
		
		d._windowUnloaders = [];
		
		d.windowUnloaded = function(){
			// summary:
			//		signal fired by impending window destruction. You may use
			//		dojo.addOnWIndowUnload() or dojo.connect() to this method to perform
			//		page/application cleanup methods. See dojo.addOnWindowUnload for more info.
			var mll = this._windowUnloaders;
			while(mll.length){
				(mll.pop())();
			}
		}

		d.addOnWindowUnload = function(/*Object?*/obj, /*String|Function?*/functionName){
			// summary:
			//		registers a function to be triggered when window.onunload fires.
			//		Be careful trying to modify the DOM or access JavaScript properties
			//		during this phase of page unloading: they may not always be available.
			//		Consider dojo.addOnUnload() if you need to modify the DOM or do heavy
			//		JavaScript work.
			// example:
			//	|	dojo.addOnWindowUnload(functionPointer)
			//	|	dojo.addOnWindowUnload(object, ""functionName"")
			//	|	dojo.addOnWindowUnload(object, function(){ /* ... */});
	
			d._onto(d._windowUnloaders, obj, functionName);
		}
	})();

	dojo._initFired = false;
	//	BEGIN DOMContentLoaded, from Dean Edwards (http://dean.edwards.name/weblog/2006/06/again/)
	dojo._loadInit = function(e){
		dojo._initFired = true;
		// allow multiple calls, only first one will take effect
		// A bug in khtml calls events callbacks for document for event which isnt supported
		// for example a created contextmenu event calls DOMContentLoaded, workaround
		var type = (e && e.type) ? e.type.toLowerCase() : ""load"";
		if(arguments.callee.initialized || (type != ""domcontentloaded"" && type != ""load"")){ return; }
		arguments.callee.initialized = true;
		if(""_khtmlTimer"" in dojo){
			clearInterval(dojo._khtmlTimer);
			delete dojo._khtmlTimer;
		}

		if(dojo._inFlightCount == 0){
			dojo._modulesLoaded();
		}
	}

	dojo._fakeLoadInit = function(){
		dojo._loadInit({type: ""load""});
	}

	if(!dojo.config.afterOnLoad){
		//	START DOMContentLoaded
		// Mozilla and Opera 9 expose the event we could use
		if(document.addEventListener){
			// NOTE: 
			//		due to a threading issue in Firefox 2.0, we can't enable
			//		DOMContentLoaded on that platform. For more information, see:
			//		http://trac.dojotoolkit.org/ticket/1704
			if(dojo.isOpera || dojo.isFF >= 3 || (dojo.isMoz && dojo.config.enableMozDomContentLoaded === true)){
				document.addEventListener(""DOMContentLoaded"", dojo._loadInit, null);
			}
	
			//	mainly for Opera 8.5, won't be fired if DOMContentLoaded fired already.
			//  also used for Mozilla because of trac #1640
			window.addEventListener(""load"", dojo._loadInit, null);
		}
	
		if(dojo.isAIR){
			window.addEventListener(""load"", dojo._loadInit, null);
		}else if(/(WebKit|khtml)/i.test(navigator.userAgent)){ // sniff
			dojo._khtmlTimer = setInterval(function(){
				if(/loaded|complete/.test(document.readyState)){
					dojo._loadInit(); // call the onload handler
				}
			}, 10);
		}
		//	END DOMContentLoaded
	}

	(function(){
		var _w = window;
		var _handleNodeEvent = function(/*String*/evtName, /*Function*/fp){
			// summary:
			//		non-destructively adds the specified function to the node's
			//		evtName handler.
			// evtName: should be in the form ""onclick"" for ""onclick"" handlers.
			// Make sure you pass in the ""on"" part.
			var oldHandler = _w[evtName] || function(){};
			_w[evtName] = function(){
				fp.apply(_w, arguments);
				oldHandler.apply(_w, arguments);
			};
		};

		if(dojo.isIE){
			// 	for Internet Explorer. readyState will not be achieved on init
			// 	call, but dojo doesn't need it however, we'll include it
			// 	because we don't know if there are other functions added that
			// 	might.  Note that this has changed because the build process
			// 	strips all comments -- including conditional ones.
			if(!dojo.config.afterOnLoad){
				document.write('<scr'+'ipt defer src=""//:"" '
					+ 'onreadystatechange=""if(this.readyState==\'complete\'){' + dojo._scopeName + '._loadInit();}"">'
					+ '</scr'+'ipt>'
				);
			}

			try{
				document.namespaces.add(""v"",""urn:schemas-microsoft-com:vml"");
				document.createStyleSheet().addRule(""v\\:*"", ""behavior:url(#default#VML)"");
			}catch(e){}
		}

		// FIXME: dojo.unloaded requires dojo scope, so using anon function wrapper.
		_handleNodeEvent(""onbeforeunload"", function() { dojo.unloaded(); });
		_handleNodeEvent(""onunload"", function() { dojo.windowUnloaded(); });
	})();

	/*
	OpenAjax.subscribe(""OpenAjax"", ""onload"", function(){
		if(dojo._inFlightCount == 0){
			dojo._modulesLoaded();
		}
	});

	OpenAjax.subscribe(""OpenAjax"", ""onunload"", function(){
		dojo.unloaded();
	});
	*/
} //if (typeof window != 'undefined')

//Register any module paths set up in djConfig. Need to do this
//in the hostenvs since hostenv_browser can read djConfig from a
//script tag's attribute.
(function(){
	var mp = dojo.config[""modulePaths""];
	if(mp){
		for(var param in mp){
			dojo.registerModulePath(param, mp[param]);
		}
	}
})();

//Load debug code if necessary.
if(dojo.config.isDebug){
	dojo.require(""dojo._firebug.firebug"");
}

if(dojo.config.debugAtAllCosts){
	dojo.config.useXDomain = true;
	dojo.require(""dojo._base._loader.loader_xd"");
	dojo.require(""dojo._base._loader.loader_debug"");
	dojo.require(""dojo.i18n"");
}

if(!dojo._hasResource[""dojo._base.lang""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.lang""] = true;
dojo.provide(""dojo._base.lang"");

// Crockford (ish) functions

dojo.isString = function(/*anything*/ it){
	//	summary:
	//		Return true if it is a String
	return !!arguments.length && it != null && (typeof it == ""string"" || it instanceof String); // Boolean
}

dojo.isArray = function(/*anything*/ it){
	//	summary:
	//		Return true if it is an Array
	return it && (it instanceof Array || typeof it == ""array""); // Boolean
}

/*=====
dojo.isFunction = function(it){
	// summary: Return true if it is a Function
	// it: anything
	return; // Boolean
}
=====*/

dojo.isFunction = (function(){
	var _isFunction = function(/*anything*/ it){
		return it && (typeof it == ""function"" || it instanceof Function); // Boolean
	};

	return dojo.isSafari ?
		// only slow this down w/ gratuitious casting in Safari since it's what's b0rken
		function(/*anything*/ it){
			if(typeof it == ""function"" && it == ""[object NodeList]""){ return false; }
			return _isFunction(it); // Boolean
		} : _isFunction;
})();

dojo.isObject = function(/*anything*/ it){
	// summary: 
	//		Returns true if it is a JavaScript object (or an Array, a Function
	//		or null)
	return it !== undefined &&
		(it === null || typeof it == ""object"" || dojo.isArray(it) || dojo.isFunction(it)); // Boolean
}

dojo.isArrayLike = function(/*anything*/ it){
	//	summary:
	//		similar to dojo.isArray() but more permissive
	//	description:
	//		Doesn't strongly test for ""arrayness"".  Instead, settles for ""isn't
	//		a string or number and has a length property"". Arguments objects
	//		and DOM collections will return true when passed to
	//		dojo.isArrayLike(), but will return false when passed to
	//		dojo.isArray().
	//	returns:
	//		If it walks like a duck and quicks like a duck, return `true`
	var d = dojo;
	return it && it !== undefined && // Boolean
		// keep out built-in constructors (Number, String, ...) which have length
		// properties
		!d.isString(it) && !d.isFunction(it) &&
		!(it.tagName && it.tagName.toLowerCase() == 'form') &&
		(d.isArray(it) || isFinite(it.length));
}

dojo.isAlien = function(/*anything*/ it){
	// summary: 
	//		Returns true if it is a built-in function or some other kind of
	//		oddball that *should* report as a function but doesn't
	return it && !dojo.isFunction(it) && /\{\s*\[native code\]\s*\}/.test(String(it)); // Boolean
}

dojo.extend = function(/*Object*/ constructor, /*Object...*/ props){
	// summary:
	//		Adds all properties and methods of props to constructor's
	//		prototype, making them available to all instances created with
	//		constructor.
	for(var i=1, l=arguments.length; i<l; i++){
		dojo._mixin(constructor.prototype, arguments[i]);
	}
	return constructor; // Object
}

dojo._hitchArgs = function(scope, method /*,...*/){
	var pre = dojo._toArray(arguments, 2);
	var named = dojo.isString(method);
	return function(){
		// arrayify arguments
		var args = dojo._toArray(arguments);
		// locate our method
		var f = named ? (scope||dojo.global)[method] : method;
		// invoke with collected args
		return f && f.apply(scope || this, pre.concat(args)); // mixed
 	} // Function
}

dojo.hitch = function(/*Object*/scope, /*Function|String*/method /*,...*/){
	//	summary: 
	//		Returns a function that will only ever execute in the a given scope. 
	//		This allows for easy use of object member functions
	//		in callbacks and other places in which the ""this"" keyword may
	//		otherwise not reference the expected scope. 
	//		Any number of default positional arguments may be passed as parameters 
	//		beyond ""method"".
	//		Each of these values will be used to ""placehold"" (similar to curry)
	//		for the hitched function. 
	//	scope: 
	//		The scope to use when method executes. If method is a string, 
	//		scope is also the object containing method.
	//	method:
	//		A function to be hitched to scope, or the name of the method in
	//		scope to be hitched.
	//	example:
	//	|	dojo.hitch(foo, ""bar"")(); 
	//		runs foo.bar() in the scope of foo
	//	example:
	//	|	dojo.hitch(foo, myFunction);
	//		returns a function that runs myFunction in the scope of foo
	if(arguments.length > 2){
		return dojo._hitchArgs.apply(dojo, arguments); // Function
	}
	if(!method){
		method = scope;
		scope = null;
	}
	if(dojo.isString(method)){
		scope = scope || dojo.global;
		if(!scope[method]){ throw(['dojo.hitch: scope[""', method, '""] is null (scope=""', scope, '"")'].join('')); }
		return function(){ return scope[method].apply(scope, arguments || []); }; // Function
	}
	return !scope ? method : function(){ return method.apply(scope, arguments || []); }; // Function
}

/*=====
dojo.delegate = function(obj, props){
	//	summary:
	//		returns a new object which ""looks"" to obj for properties which it
	//		does not have a value for. Optionally takes a bag of properties to
	//		seed the returned object with initially. 
	//	description:
	//		This is a small implementaton of the Boodman/Crockford delegation
	//		pattern in JavaScript. An intermediate object constructor mediates
	//		the prototype chain for the returned object, using it to delegate
	//		down to obj for property lookup when object-local lookup fails.
	//		This can be thought of similarly to ES4's ""wrap"", save that it does
	//		not act on types but rather on pure objects.
	//	obj:
	//		The object to delegate to for properties not found directly on the
	//		return object or in props.
	//	props:
	//		an object containing properties to assign to the returned object
	//	returns:
	//		an Object of anonymous type
	//	example:
	//	|	var foo = { bar: ""baz"" };
	//	|	var thinger = dojo.delegate(foo, { thud: ""xyzzy""});
	//	|	thinger.bar == ""baz""; // delegated to foo
	//	|	foo.thud == undefined; // by definition
	//	|	thinger.thud == ""xyzzy""; // mixed in from props
	//	|	foo.bar = ""thonk"";
	//	|	thinger.bar == ""thonk""; // still delegated to foo's bar
}
=====*/

dojo.delegate = dojo._delegate = (function(){
	// boodman/crockford delegation w/ cornford optimization
	function TMP(){};
	return function(obj, props){
		TMP.prototype = obj;
		var tmp = new TMP();
		if(props){
			dojo._mixin(tmp, props);
		}
		return tmp; // Object
	}
})();

/*=====
dojo._toArray = function(obj, offset, startWith){
	//	summary:
	//		Converts an array-like object (i.e. arguments, DOMCollection) to an
	//		array. Returns a new Array with the elements of obj.
	//	obj: Object
	//		the object to ""arrayify"". We expect the object to have, at a
	//		minimum, a length property which corresponds to integer-indexed
	//		properties.
	//	offset: Number?
	//		the location in obj to start iterating from. Defaults to 0.
	//		Optional.
	//	startWith: Array?
	//		An array to pack with the properties of obj. If provided,
	//		properties in obj are appended at the end of startWith and
	//		startWith is the returned array.
}
=====*/

(function(){
	var efficient = function(obj, offset, startWith){
		return (startWith||[]).concat(Array.prototype.slice.call(obj, offset||0));
	};

	var slow = function(obj, offset, startWith){
		var arr = startWith||[]; 
		for(var x = offset || 0; x < obj.length; x++){ 
			arr.push(obj[x]); 
		} 
		return arr;
	};

	dojo._toArray = (!dojo.isIE) ? efficient : function(obj){
		return ((obj.item) ? slow : efficient).apply(this, arguments);
	};

})();

dojo.partial = function(/*Function|String*/method /*, ...*/){
	//	summary:
	//		similar to hitch() except that the scope object is left to be
	//		whatever the execution context eventually becomes.
	//	description:
	//		Calling dojo.partial is the functional equivalent of calling:
	//		|	dojo.hitch(null, funcName, ...);
	var arr = [ null ];
	return dojo.hitch.apply(dojo, arr.concat(dojo._toArray(arguments))); // Function
}

dojo.clone = function(/*anything*/ o){
	// summary:
	//		Clones objects (including DOM nodes) and all children.
	//		Warning: do not clone cyclic structures.
	if(!o){ return o; }
	if(dojo.isArray(o)){
		var r = [];
		for(var i = 0; i < o.length; ++i){
			r.push(dojo.clone(o[i]));
		}
		return r; // Array
	}
	if(!dojo.isObject(o)){
		return o;	/*anything*/
	}
	if(o.nodeType && o.cloneNode){ // isNode
		return o.cloneNode(true); // Node
	}
	if(o instanceof Date){
		return new Date(o.getTime());	// Date
	}
	// Generic objects
	var r = new o.constructor(); // specific to dojo.declare()'d classes!
	for(var i in o){
		if(!(i in r) || r[i] != o[i]){
			r[i] = dojo.clone(o[i]);
		}
	}
	return r; // Object
}

dojo.trim = function(/*String*/ str){
	// summary: 
	//		trims whitespaces from both sides of the string
	// description:
	//		This version of trim() was selected for inclusion into the base due
	//		to its compact size and relatively good performance (see Steven
	//		Levithan's blog:
	//		http://blog.stevenlevithan.com/archives/faster-trim-javascript).
	//		The fastest but longest version of this function is located at
	//		dojo.string.trim()
	return str.replace(/^\s\s*/, '').replace(/\s\s*$/, '');	// String
}

}

if(!dojo._hasResource[""dojo._base.declare""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.declare""] = true;
dojo.provide(""dojo._base.declare"");


// this file courtesy of the TurboAjax Group, licensed under a Dojo CLA

dojo.declare = function(/*String*/ className, /*Function|Function[]*/ superclass, /*Object*/ props){
	//	summary: 
	//		Create a feature-rich constructor from compact notation
	//	className:
	//		The name of the constructor (loosely, a ""class"")
	//		stored in the ""declaredClass"" property in the created prototype
	//	superclass:
	//		May be null, a Function, or an Array of Functions. If an array, 
	//		the first element is used as the prototypical ancestor and
	//		any following Functions become mixin ancestors.
	//	props:
	//		An object whose properties are copied to the
	//		created prototype.
	//		Add an instance-initialization function by making it a property 
	//		named ""constructor"".
	//	description:
	//		Create a constructor using a compact notation for inheritance and
	//		prototype extension. 
	//
	//		All superclasses (including mixins) must be Functions (not simple Objects).
	//
	//		Mixin ancestors provide a type of multiple inheritance. Prototypes of mixin 
	//		ancestors are copied to the new class: changes to mixin prototypes will
	//		not affect classes to which they have been mixed in.
	//
	//		""className"" is cached in ""declaredClass"" property of the new class.
	//
	//	example:
	//	|	dojo.declare(""my.classes.bar"", my.classes.foo, {
	//	|		// properties to be added to the class prototype
	//	|		someValue: 2,
	//	|		// initialization function
	//	|		constructor: function(){
	//	|			this.myComplicatedObject = new ReallyComplicatedObject(); 
	//	|		},
	//	|		// other functions
	//	|		someMethod: function(){ 
	//	|			doStuff(); 
	//	|		}
	//	|	);

	// process superclass argument
	var dd = arguments.callee, mixins;
	if(dojo.isArray(superclass)){
		mixins = superclass;
		superclass = mixins.shift();
	}
	// construct intermediate classes for mixins
	if(mixins){
		dojo.forEach(mixins, function(m){
			if(!m){ throw(className + "": mixin #"" + i + "" is null""); } // It's likely a required module is not loaded
			superclass = dd._delegate(superclass, m);
		});
	}
	// create constructor
	var ctor = dd._delegate(superclass);
	// extend with ""props""
	props = props || {};
	ctor.extend(props);
	// more prototype decoration
	dojo.extend(ctor, {declaredClass: className, _constructor: props.constructor/*, preamble: null*/});
	// special help for IE
	ctor.prototype.constructor = ctor;
	// create named reference
	return dojo.setObject(className, ctor); // Function
};

dojo.mixin(dojo.declare, {
	_delegate: function(base, mixin){
		var bp = (base||0).prototype, mp = (mixin||0).prototype, dd=dojo.declare;
		// fresh constructor, fresh prototype
		var ctor = dd._makeCtor();
		// cache ancestry
		dojo.mixin(ctor, {superclass: bp, mixin: mp, extend: dd._extend});
		// chain prototypes
		if(base){ctor.prototype = dojo._delegate(bp);}
		// add mixin and core
		dojo.extend(ctor, dd._core, mp||0, {_constructor: null, preamble: null});
		// special help for IE
		ctor.prototype.constructor = ctor;
		// name this class for debugging
		ctor.prototype.declaredClass = (bp||0).declaredClass + '_' + (mp||0).declaredClass;
		return ctor;
	},
	_extend: function(props){
		var i, fn;
		for(i in props){ if(dojo.isFunction(fn=props[i]) && !0[i]){fn.nom=i;fn.ctor=this;} }
		dojo.extend(this, props);
	},
	_makeCtor: function(){
		// we have to make a function, but don't want to close over anything
		return function(){ this._construct(arguments); };
	},
	_core: { 
		_construct: function(args){
			var c=args.callee, s=c.superclass, ct=s&&s.constructor, m=c.mixin, mct=m&&m.constructor, a=args, ii, fn;
			// side-effect of = used on purpose here, lint may complain, don't try this at home
			if(a[0]){ 
				// FIXME: preambles for each mixin should be allowed
				// FIXME: 
				//		should we allow the preamble here NOT to modify the
				//		default args, but instead to act on each mixin
				//		independently of the class instance being constructed
				//		(for impedence matching)?

				// allow any first argument w/ a ""preamble"" property to act as a
				// class preamble (not exclusive of the prototype preamble)
				if(/*dojo.isFunction*/((fn = a[0].preamble))){ 
					a = fn.apply(this, a) || a; 
				}
			} 
			// prototype preamble
			if((fn = c.prototype.preamble)){a = fn.apply(this, a) || a;}
			// FIXME: 
			//		need to provide an optional prototype-settable
			//		""_explicitSuper"" property which disables this
			// initialize superclass
			if(ct&&ct.apply){ct.apply(this, a);}
			// initialize mixin
			if(mct&&mct.apply){mct.apply(this, a);}
			// initialize self
			if((ii=c.prototype._constructor)){ii.apply(this, args);}
			// post construction
			if(this.constructor.prototype==c.prototype && (ct=this.postscript)){ ct.apply(this, args); }
		},
		_findMixin: function(mixin){
			var c = this.constructor, p, m;
			while(c){
				p = c.superclass;
				m = c.mixin;
				if(m==mixin || (m instanceof mixin.constructor)){return p;}
				if(m && m._findMixin && (m=m._findMixin(mixin))){return m;}
				c = p && p.constructor;
			}
		},
		_findMethod: function(name, method, ptype, has){
			// consciously trading readability for bytes and speed in this low-level method
			var p=ptype, c, m, f;
			do{
				c = p.constructor;
				m = c.mixin;
				// find method by name in our mixin ancestor
				if(m && (m=this._findMethod(name, method, m, has))){return m;}
				// if we found a named method that either exactly-is or exactly-is-not 'method'
				if((f=p[name])&&(has==(f==method))){return p;}
				// ascend chain
				p = c.superclass;
			}while(p);
			// if we couldn't find an ancestor in our primary chain, try a mixin chain
			return !has && (p=this._findMixin(ptype)) && this._findMethod(name, method, p, has);
		},
		inherited: function(name, args, newArgs){
			// optionalize name argument
			var a = arguments;
			if(!dojo.isString(a[0])){newArgs=args; args=name; name=args.callee.nom;}
			a = newArgs||args;
			var c = args.callee, p = this.constructor.prototype, fn, mp;
			// if not an instance override
			if(this[name] != c || p[name] == c){
				// start from memoized prototype, or
				// find a prototype that has property 'name' == 'c'
				mp = (c.ctor||0).superclass || this._findMethod(name, c, p, true);
				if(!mp){throw(this.declaredClass + ': inherited method ""' + name + '"" mismatch');}
				// find a prototype that has property 'name' != 'c'
				p = this._findMethod(name, c, mp, false);
			}
			// we expect 'name' to be in prototype 'p'
			fn = p && p[name];
			if(!fn){throw(mp.declaredClass + ': inherited method ""' + name + '"" not found');}
			// if the function exists, invoke it in our scope
			return fn.apply(this, a);
		}
	}
});

}

if(!dojo._hasResource[""dojo._base.connect""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.connect""] = true;
dojo.provide(""dojo._base.connect"");


// this file courtesy of the TurboAjax Group, licensed under a Dojo CLA

// low-level delegation machinery
dojo._listener = {
	// create a dispatcher function
	getDispatcher: function(){
		// following comments pulled out-of-line to prevent cloning them 
		// in the returned function.
		// - indices (i) that are really in the array of listeners (ls) will 
		//   not be in Array.prototype. This is the 'sparse array' trick
		//   that keeps us safe from libs that take liberties with built-in 
		//   objects
		// - listener is invoked with current scope (this)
		return function(){
			var ap=Array.prototype, c=arguments.callee, ls=c._listeners, t=c.target;
			// return value comes from original target function
			var r = t && t.apply(this, arguments);
			// make local copy of listener array so it is immutable during processing
			var lls;
											lls = [].concat(ls);
							
			// invoke listeners after target function
			for(var i in lls){
				if(!(i in ap)){
					lls[i].apply(this, arguments);
				}
			}
			// return value comes from original target function
			return r;
		}
	},
	// add a listener to an object
	add: function(/*Object*/ source, /*String*/ method, /*Function*/ listener){
		// Whenever 'method' is invoked, 'listener' will have the same scope.
		// Trying to supporting a context object for the listener led to 
		// complexity. 
		// Non trivial to provide 'once' functionality here
		// because listener could be the result of a dojo.hitch call,
		// in which case two references to the same hitch target would not
		// be equivalent. 
		source = source || dojo.global;
		// The source method is either null, a dispatcher, or some other function
		var f = source[method];
		// Ensure a dispatcher
		if(!f||!f._listeners){
			var d = dojo._listener.getDispatcher();
			// original target function is special
			d.target = f;
			// dispatcher holds a list of listeners
			d._listeners = []; 
			// redirect source to dispatcher
			f = source[method] = d;
		}
		// The contract is that a handle is returned that can 
		// identify this listener for disconnect. 
		//
		// The type of the handle is private. Here is it implemented as Integer. 
		// DOM event code has this same contract but handle is Function 
		// in non-IE browsers.
		//
		// We could have separate lists of before and after listeners.
		return f._listeners.push(listener) ; /*Handle*/
	},
	// remove a listener from an object
	remove: function(/*Object*/ source, /*String*/ method, /*Handle*/ handle){
		var f = (source||dojo.global)[method];
		// remember that handle is the index+1 (0 is not a valid handle)
		if(f && f._listeners && handle--){
			delete f._listeners[handle];
		}
	}
};

// Multiple delegation for arbitrary methods.

// This unit knows nothing about DOM, 
// but we include DOM aware 
// documentation and dontFix
// argument here to help the autodocs.
// Actual DOM aware code is in event.js.

dojo.connect = function(/*Object|null*/ obj, 
						/*String*/ event, 
						/*Object|null*/ context, 
						/*String|Function*/ method,
						/*Boolean*/ dontFix){
	// summary:
	//		Create a link that calls one function when another executes. 
	//
	// description:
	//		Connects method to event, so that after event fires, method
	//		does too. All connected functions are passed the same arguments as
	//		the event function was initially called with. You may connect as
	//		many methods to event as needed.
	//
	//		event must be a string. If obj is null, dojo.global is used.
	//
	//		null arguments may simply be omitted.
	//
	//		obj[event] can resolve to a function or undefined (null). 
	//		If obj[event] is null, it is assigned a function.
	//
	//		The return value is a handle that is needed to 
	//		remove this connection with dojo.disconnect.
	//
	// obj: 
	//		The source object for the event function. 
	//		Defaults to dojo.global if null.
	//		If obj is a DOM node, the connection is delegated 
	//		to the DOM event manager (unless dontFix is true).
	//
	// event:
	//		String name of the event function in obj. 
	//		I.e. identifies a property obj[event].
	//
	// context: 
	//		The object that method will receive as ""this"".
	//
	//		If context is null and method is a function, then method
	//		inherits the context of event.
	//	
	//		If method is a string then context must be the source 
	//		object object for method (context[method]). If context is null,
	//		dojo.global is used.
	//
	// method:
	//		A function reference, or name of a function in context. 
	//		The function identified by method fires after event does. 
	//		method receives the same arguments as the event.
	//		See context argument comments for information on method's scope.
	//
	// dontFix:
	//		If obj is a DOM node, set dontFix to true to prevent delegation 
	//		of this connection to the DOM event manager. 
	//
	// example:
	//		When obj.onchange(), do ui.update():
	//	|	dojo.connect(obj, ""onchange"", ui, ""update"");
	//	|	dojo.connect(obj, ""onchange"", ui, ui.update); // same
	//
	// example:
	//		Using return value for disconnect:
	//	|	var link = dojo.connect(obj, ""onchange"", ui, ""update"");
	//	|	...
	//	|	dojo.disconnect(link);
	//
	// example:
	//		When onglobalevent executes, watcher.handler is invoked:
	//	|	dojo.connect(null, ""onglobalevent"", watcher, ""handler"");
	//
	// example:
	//		When ob.onCustomEvent executes, customEventHandler is invoked:
	//	|	dojo.connect(ob, ""onCustomEvent"", null, ""customEventHandler"");
	//	|	dojo.connect(ob, ""onCustomEvent"", ""customEventHandler""); // same
	//
	// example:
	//		When ob.onCustomEvent executes, customEventHandler is invoked
	//		with the same scope (this):
	//	|	dojo.connect(ob, ""onCustomEvent"", null, customEventHandler);
	//	|	dojo.connect(ob, ""onCustomEvent"", customEventHandler); // same
	//
	// example:
	//		When globalEvent executes, globalHandler is invoked
	//		with the same scope (this):
	//	|	dojo.connect(null, ""globalEvent"", null, globalHandler);
	//	|	dojo.connect(""globalEvent"", globalHandler); // same

	// normalize arguments
	var a=arguments, args=[], i=0;
	// if a[0] is a String, obj was ommited
	args.push(dojo.isString(a[0]) ? null : a[i++], a[i++]);
	// if the arg-after-next is a String or Function, context was NOT omitted
	var a1 = a[i+1];
	args.push(dojo.isString(a1)||dojo.isFunction(a1) ? a[i++] : null, a[i++]);
	// absorb any additional arguments
	for(var l=a.length; i<l; i++){	args.push(a[i]); }
	// do the actual work
	return dojo._connect.apply(this, args); /*Handle*/
}

// used by non-browser hostenvs. always overriden by event.js
dojo._connect = function(obj, event, context, method){
	var l=dojo._listener, h=l.add(obj, event, dojo.hitch(context, method)); 
	return [obj, event, h, l]; // Handle
}

dojo.disconnect = function(/*Handle*/ handle){
	// summary:
	//		Remove a link created by dojo.connect.
	// description:
	//		Removes the connection between event and the method referenced by handle.
	// handle:
	//		the return value of the dojo.connect call that created the connection.
	if(handle && handle[0] !== undefined){
		dojo._disconnect.apply(this, handle);
		// let's not keep this reference
		delete handle[0];
	}
}

dojo._disconnect = function(obj, event, handle, listener){
	listener.remove(obj, event, handle);
}

// topic publish/subscribe

dojo._topics = {};

dojo.subscribe = function(/*String*/ topic, /*Object|null*/ context, /*String|Function*/ method){
	//	summary:
	//		Attach a listener to a named topic. The listener function is invoked whenever the
	//		named topic is published (see: dojo.publish).
	//		Returns a handle which is needed to unsubscribe this listener.
	//	context:
	//		Scope in which method will be invoked, or null for default scope.
	//	method:
	//		The name of a function in context, or a function reference. This is the function that
	//		is invoked when topic is published.
	//	example:
	//	|	dojo.subscribe(""alerts"", null, function(caption, message){ alert(caption + ""\n"" + message); };
	//	|	dojo.publish(""alerts"", [ ""read this"", ""hello world"" ]);																	

	// support for 2 argument invocation (omitting context) depends on hitch
	return [topic, dojo._listener.add(dojo._topics, topic, dojo.hitch(context, method))]; /*Handle*/
}

dojo.unsubscribe = function(/*Handle*/ handle){
	//	summary:
	//	 	Remove a topic listener. 
	//	handle:
	//	 	The handle returned from a call to subscribe.
	//	example:
	//	|	var alerter = dojo.subscribe(""alerts"", null, function(caption, message){ alert(caption + ""\n"" + message); };
	//	|	...
	//	|	dojo.unsubscribe(alerter);
	if(handle){
		dojo._listener.remove(dojo._topics, handle[0], handle[1]);
	}
}

dojo.publish = function(/*String*/ topic, /*Array*/ args){
	//	summary:
	//	 	Invoke all listener method subscribed to topic.
	//	topic:
	//	 	The name of the topic to publish.
	//	args:
	//	 	An array of arguments. The arguments will be applied 
	//	 	to each topic subscriber (as first class parameters, via apply).
	//	example:
	//	|	dojo.subscribe(""alerts"", null, function(caption, message){ alert(caption + ""\n"" + message); };
	//	|	dojo.publish(""alerts"", [ ""read this"", ""hello world"" ]);	

	// Note that args is an array, which is more efficient vs variable length
	// argument list.  Ideally, var args would be implemented via Array
	// throughout the APIs.
	var f = dojo._topics[topic];
	if(f){
		f.apply(this, args||[]);
	}
}

dojo.connectPublisher = function(	/*String*/ topic, 
									/*Object|null*/ obj, 
									/*String*/ event){
	//	summary:
	//	 	Ensure that everytime obj.event() is called, a message is published
	//	 	on the topic. Returns a handle which can be passed to
	//	 	dojo.disconnect() to disable subsequent automatic publication on
	//	 	the topic.
	//	topic:
	//	 	The name of the topic to publish.
	//	obj: 
	//	 	The source object for the event function. Defaults to dojo.global
	//	 	if null.
	//	event:
	//	 	The name of the event function in obj. 
	//	 	I.e. identifies a property obj[event].
	//	example:
	//	|	dojo.connectPublisher(""/ajax/start"", dojo, ""xhrGet"");
	var pf = function(){ dojo.publish(topic, arguments); }
	return (event) ? dojo.connect(obj, event, pf) : dojo.connect(obj, pf); //Handle
};

}

if(!dojo._hasResource[""dojo._base.Deferred""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.Deferred""] = true;
dojo.provide(""dojo._base.Deferred"");


dojo.Deferred = function(/*Function?*/ canceller){
	// summary:
	//		Encapsulates a sequence of callbacks in response to a value that
	//		may not yet be available.  This is modeled after the Deferred class
	//		from Twisted <http://twistedmatrix.com>.
	// description:
	//		JavaScript has no threads, and even if it did, threads are hard.
	//		Deferreds are a way of abstracting non-blocking events, such as the
	//		final response to an XMLHttpRequest. Deferreds create a promise to
	//		return a response a some point in the future and an easy way to
	//		register your interest in receiving that response.
	//
	//		The most important methods for Deffered users are:
	//
	//			* addCallback(handler)
	//			* addErrback(handler)
	//			* callback(result)
	//			* errback(result)
	//
	//		In general, when a function returns a Deferred, users then ""fill
	//		in"" the second half of the contract by registering callbacks and
	//		error handlers. You may register as many callback and errback
	//		handlers as you like and they will be executed in the order
	//		registered when a result is provided. Usually this result is
	//		provided as the result of an asynchronous operation. The code
	//		""managing"" the Deferred (the code that made the promise to provide
	//		an answer later) will use the callback() and errback() methods to
	//		communicate with registered listeners about the result of the
	//		operation. At this time, all registered result handlers are called
	//		*with the most recent result value*.
	//
	//		Deferred callback handlers are treated as a chain, and each item in
	//		the chain is required to return a value that will be fed into
	//		successive handlers. The most minimal callback may be registered
	//		like this:
	//
	//		|	var d = new dojo.Deferred();
	//		|	d.addCallback(function(result){ return result; });
	//
	//		Perhaps the most common mistake when first using Deferreds is to
	//		forget to return a value (in most cases, the value you were
	//		passed).
	//
	//		The sequence of callbacks is internally represented as a list of
	//		2-tuples containing the callback/errback pair.  For example, the
	//		following call sequence:
	//		
	//		|	var d = new dojo.Deferred();
	//		|	d.addCallback(myCallback);
	//		|	d.addErrback(myErrback);
	//		|	d.addBoth(myBoth);
	//		|	d.addCallbacks(myCallback, myErrback);
	//
	//		is translated into a Deferred with the following internal
	//		representation:
	//
	//		|	[
	//		|		[myCallback, null],
	//		|		[null, myErrback],
	//		|		[myBoth, myBoth],
	//		|		[myCallback, myErrback]
	//		|	]
	//
	//		The Deferred also keeps track of its current status (fired).  Its
	//		status may be one of three things:
	//
	//			* -1: no value yet (initial condition)
	//			* 0: success
	//			* 1: error
	//	
	//		A Deferred will be in the error state if one of the following three
	//		conditions are met:
	//
	//			1. The result given to callback or errback is ""instanceof"" Error
	//			2. The previous callback or errback raised an exception while
	//			   executing
	//			3. The previous callback or errback returned a value
	//			   ""instanceof"" Error
	//
	//		Otherwise, the Deferred will be in the success state. The state of
	//		the Deferred determines the next element in the callback sequence
	//		to run.
	//
	//		When a callback or errback occurs with the example deferred chain,
	//		something equivalent to the following will happen (imagine
	//		that exceptions are caught and returned):
	//
	//		|	// d.callback(result) or d.errback(result)
	//		|	if(!(result instanceof Error)){
	//		|		result = myCallback(result);
	//		|	}
	//		|	if(result instanceof Error){
	//		|		result = myErrback(result);
	//		|	}
	//		|	result = myBoth(result);
	//		|	if(result instanceof Error){
	//		|		result = myErrback(result);
	//		|	}else{
	//		|		result = myCallback(result);
	//		|	}
	//
	//		The result is then stored away in case another step is added to the
	//		callback sequence.	Since the Deferred already has a value
	//		available, any new callbacks added will be called immediately.
	//
	//		There are two other ""advanced"" details about this implementation
	//		that are useful:
	//
	//		Callbacks are allowed to return Deferred instances themselves, so
	//		you can build complicated sequences of events with ease.
	//
	//		The creator of the Deferred may specify a canceller.  The canceller
	//		is a function that will be called if Deferred.cancel is called
	//		before the Deferred fires. You can use this to implement clean
	//		aborting of an XMLHttpRequest, etc. Note that cancel will fire the
	//		deferred with a CancelledError (unless your canceller returns
	//		another kind of error), so the errbacks should be prepared to
	//		handle that error for cancellable Deferreds.
	// example:
	//	|	var deferred = new dojo.Deferred();
	//	|	setTimeout(function(){ deferred.callback({success: true}); }, 1000);
	//	|	return deferred;
	// example:
	//		Deferred objects are often used when making code asynchronous. It
	//		may be easiest to write functions in a synchronous manner and then
	//		split code using a deferred to trigger a response to a long-lived
	//		operation. For example, instead of register a callback function to
	//		denote when a rendering operation completes, the function can
	//		simply return a deferred:
	//
	//		|	// callback style:
	//		|	function renderLotsOfData(data, callback){
	//		|		var success = false
	//		|		try{
	//		|			for(var x in data){
	//		|				renderDataitem(data[x]);
	//		|			}
	//		|			success = true;
	//		|		}catch(e){ }
	//		|		if(callback){
	//		|			callback(success);
	//		|		}
	//		|	}
	//
	//		|	// using callback style
	//		|	renderLotsOfData(someDataObj, function(success){
	//		|		// handles success or failure
	//		|		if(!success){
	//		|			promptUserToRecover();
	//		|		}
	//		|	});
	//		|	// NOTE: no way to add another callback here!!
	// example:
	//		Using a Deferred doesn't simplify the sending code any, but it
	//		provides a standard interface for callers and senders alike,
	//		providing both with a simple way to service multiple callbacks for
	//		an operation and freeing both sides from worrying about details
	//		such as ""did this get called already?"". With Deferreds, new
	//		callbacks can be added at any time.
	//
	//		|	// Deferred style:
	//		|	function renderLotsOfData(data){
	//		|		var d = new dojo.Deferred();
	//		|		try{
	//		|			for(var x in data){
	//		|				renderDataitem(data[x]);
	//		|			}
	//		|			d.callback(true);
	//		|		}catch(e){ 
	//		|			d.errback(new Error(""rendering failed""));
	//		|		}
	//		|		return d;
	//		|	}
	//
	//		|	// using Deferred style
	//		|	renderLotsOfData(someDataObj).addErrback(function(){
	//		|		promptUserToRecover();
	//		|	});
	//		|	// NOTE: addErrback and addCallback both return the Deferred
	//		|	// again, so we could chain adding callbacks or save the
	//		|	// deferred for later should we need to be notified again.
	// example:
	//		In this example, renderLotsOfData is syncrhonous and so both
	//		versions are pretty artificial. Putting the data display on a
	//		timeout helps show why Deferreds rock:
	//
	//		|	// Deferred style and async func
	//		|	function renderLotsOfData(data){
	//		|		var d = new dojo.Deferred();
	//		|		setTimeout(function(){
	//		|			try{
	//		|				for(var x in data){
	//		|					renderDataitem(data[x]);
	//		|				}
	//		|				d.callback(true);
	//		|			}catch(e){ 
	//		|				d.errback(new Error(""rendering failed""));
	//		|			}
	//		|		}, 100);
	//		|		return d;
	//		|	}
	//
	//		|	// using Deferred style
	//		|	renderLotsOfData(someDataObj).addErrback(function(){
	//		|		promptUserToRecover();
	//		|	});
	//
	//		Note that the caller doesn't have to change his code at all to
	//		handle the asynchronous case.

	this.chain = [];
	this.id = this._nextId();
	this.fired = -1;
	this.paused = 0;
	this.results = [null, null];
	this.canceller = canceller;
	this.silentlyCancelled = false;
};

dojo.extend(dojo.Deferred, {
	/*
	makeCalled: function(){
		// summary:
		//		returns a new, empty deferred, which is already in the called
		//		state. Calling callback() or errback() on this deferred will
		//		yeild an error and adding new handlers to it will result in
		//		them being called immediately.
		var deferred = new dojo.Deferred();
		deferred.callback();
		return deferred;
	},

	toString: function(){
		var state;
		if(this.fired == -1){
			state = 'unfired';
		}else{
			state = this.fired ? 'success' : 'error';
		}
		return 'Deferred(' + this.id + ', ' + state + ')';
	},
	*/

	_nextId: (function(){
		var n = 1;
		return function(){ return n++; };
	})(),

	cancel: function(){
		// summary:	
		//		Cancels a Deferred that has not yet received a value, or is
		//		waiting on another Deferred as its value.
		// description:
		//		If a canceller is defined, the canceller is called. If the
		//		canceller did not return an error, or there was no canceller,
		//		then the errback chain is started.
		var err;
		if(this.fired == -1){
			if(this.canceller){
				err = this.canceller(this);
			}else{
				this.silentlyCancelled = true;
			}
			if(this.fired == -1){
				if(!(err instanceof Error)){
					var res = err;
					err = new Error(""Deferred Cancelled"");
					err.dojoType = ""cancel"";
					err.cancelResult = res;
				}
				this.errback(err);
			}
		}else if(	(this.fired == 0) &&
					(this.results[0] instanceof dojo.Deferred)
		){
			this.results[0].cancel();
		}
	},
			

	_resback: function(res){
		// summary:
		//		The private primitive that means either callback or errback
		this.fired = ((res instanceof Error) ? 1 : 0);
		this.results[this.fired] = res;
		this._fire();
	},

	_check: function(){
		if(this.fired != -1){
			if(!this.silentlyCancelled){
				throw new Error(""already called!"");
			}
			this.silentlyCancelled = false;
			return;
		}
	},

	callback: function(res){
		//	summary:	
		//		Begin the callback sequence with a non-error value.
		
		/*
		callback or errback should only be called once on a given
		Deferred.
		*/
		this._check();
		this._resback(res);
	},

	errback: function(/*Error*/res){
		//	summary: 
		//		Begin the callback sequence with an error result.
		this._check();
		if(!(res instanceof Error)){
			res = new Error(res);
		}
		this._resback(res);
	},

	addBoth: function(/*Function|Object*/cb, /*String?*/cbfn){
		//	summary:
		//		Add the same function as both a callback and an errback as the
		//		next element on the callback sequence.This is useful for code
		//		that you want to guarantee to run, e.g. a finalizer.
		var enclosed = dojo.hitch.apply(dojo, arguments);
		return this.addCallbacks(enclosed, enclosed); // dojo.Deferred
	},

	addCallback: function(/*Function|Object*/cb, /*String?*/cbfn /*...*/){
		//	summary: 
		//		Add a single callback to the end of the callback sequence.
		return this.addCallbacks(dojo.hitch.apply(dojo, arguments)); // dojo.Deferred
	},

	addErrback: function(cb, cbfn){
		//	summary: 
		//		Add a single callback to the end of the callback sequence.
		return this.addCallbacks(null, dojo.hitch.apply(dojo, arguments)); // dojo.Deferred
	},

	addCallbacks: function(cb, eb){
		// summary: 
		//		Add separate callback and errback to the end of the callback
		//		sequence.
		this.chain.push([cb, eb])
		if(this.fired >= 0){
			this._fire();
		}
		return this; // dojo.Deferred
	},

	_fire: function(){
		// summary: 
		//		Used internally to exhaust the callback sequence when a result
		//		is available.
		var chain = this.chain;
		var fired = this.fired;
		var res = this.results[fired];
		var self = this;
		var cb = null;
		while(
			(chain.length > 0) &&
			(this.paused == 0)
		){
			// Array
			var f = chain.shift()[fired];
			if(!f){ continue; }
			var func = function(){
				var ret = f(res);
				//If no response, then use previous response.
				if(typeof ret != ""undefined""){
					res = ret;
				}
				fired = ((res instanceof Error) ? 1 : 0);
				if(res instanceof dojo.Deferred){
					cb = function(res){
						self._resback(res);
						// inlined from _pause()
						self.paused--;
						if(
							(self.paused == 0) && 
							(self.fired >= 0)
						){
							self._fire();
						}
					}
					// inlined from _unpause
					this.paused++;
				}
			};
			if(dojo.config.isDebug){
				func.call(this);
			}else{
				try{
					func.call(this);
				}catch(err){
					fired = 1;
					res = err;
				}
			}
		}
		this.fired = fired;
		this.results[fired] = res;
		if((cb)&&(this.paused)){
			// this is for ""tail recursion"" in case the dependent
			// deferred is already fired
			res.addBoth(cb);
		}
	}
});

}

if(!dojo._hasResource[""dojo._base.json""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.json""] = true;
dojo.provide(""dojo._base.json"");

dojo.fromJson = function(/*String*/ json){
	// summary:
	// 		Parses a [JSON](http://json.org) string to return a JavaScript object.  Throws for invalid JSON strings.
	// json: 
	//		a string literal of a JSON item, for instance:
	//			`'{ ""foo"": [ ""bar"", 1, { ""baz"": ""thud"" } ] }'`

	return eval(""("" + json + "")""); // Object
}

dojo._escapeString = function(/*String*/str){
	//summary:
	//		Adds escape sequences for non-visual characters, double quote and
	//		backslash and surrounds with double quotes to form a valid string
	//		literal.
	return ('""' + str.replace(/([""\\])/g, '\\$1') + '""').
		replace(/[\f]/g, ""\\f"").replace(/[\b]/g, ""\\b"").replace(/[\n]/g, ""\\n"").
		replace(/[\t]/g, ""\\t"").replace(/[\r]/g, ""\\r""); // string
}

dojo.toJsonIndentStr = ""\t"";
dojo.toJson = function(/*Object*/ it, /*Boolean?*/ prettyPrint, /*String?*/ _indentStr){
	// summary:
	//		Returns a [JSON](http://json.org) serialization of an object.
	//
	// description:
	//		Returns a [JSON](http://json.org) serialization of an object.
	//		Note that this doesn't check for infinite recursion, so don't do that!
	//
	// it:
	//		an object to be serialized. Objects may define their own
	//		serialization via a special ""__json__"" or ""json"" function
	//		property. If a specialized serializer has been defined, it will
	//		be used as a fallback.
	//
	// prettyPrint:
	//		if true, we indent objects and arrays to make the output prettier.
	//		The variable dojo.toJsonIndentStr is used as the indent string 
	//		-- to use something other than the default (tab), 
	//		change that variable before calling dojo.toJson().
	//
	// _indentStr:
	//		private variable for recursive calls when pretty printing, do not use.

	if(it === undefined){
		return ""undefined"";
	}
	var objtype = typeof it;
	if(objtype == ""number"" || objtype == ""boolean""){
		return it + """";
	}
	if(it === null){
		return ""null"";
	}
	if(dojo.isString(it)){ 
		return dojo._escapeString(it); 
	}
	// recurse
	var recurse = arguments.callee;
	// short-circuit for objects that support ""json"" serialization
	// if they return ""self"" then just pass-through...
	var newObj;
	_indentStr = _indentStr || """";
	var nextIndent = prettyPrint ? _indentStr + dojo.toJsonIndentStr : """";
	var tf = it.__json__||it.json;
	if(dojo.isFunction(tf)){
		newObj = tf.call(it);
		if(it !== newObj){
			return recurse(newObj, prettyPrint, nextIndent);
		}
	}
	if(it.nodeType && it.cloneNode){ // isNode
		// we can't seriailize DOM nodes as regular objects because they have cycles
		// DOM nodes could be serialized with something like outerHTML, but
		// that can be provided by users in the form of .json or .__json__ function.
		throw new Error(""Can't serialize DOM nodes"");
	}

	var sep = prettyPrint ? "" "" : """";
	var newLine = prettyPrint ? ""\n"" : """";

	// array
	if(dojo.isArray(it)){
		var res = dojo.map(it, function(obj){
			var val = recurse(obj, prettyPrint, nextIndent);
			if(typeof val != ""string""){
				val = ""undefined"";
			}
			return newLine + nextIndent + val;
		});
		return ""["" + res.join("","" + sep) + newLine + _indentStr + ""]"";
	}
	/*
	// look in the registry
	try {
		window.o = it;
		newObj = dojo.json.jsonRegistry.match(it);
		return recurse(newObj, prettyPrint, nextIndent);
	}catch(e){
		// 
	}
	// it's a function with no adapter, skip it
	*/
	if(objtype == ""function""){
		return null; // null
	}
	// generic object code path
	var output = [], key;
	for(key in it){
		var keyStr, val;
		if(typeof key == ""number""){
			keyStr = '""' + key + '""';
		}else if(typeof key == ""string""){
			keyStr = dojo._escapeString(key);
		}else{
			// skip non-string or number keys
			continue;
		}
		val = recurse(it[key], prettyPrint, nextIndent);
		if(typeof val != ""string""){
			// skip non-serializable values
			continue;
		}
		// FIXME: use += on Moz!!
		//	 MOW NOTE: using += is a pain because you have to account for the dangling comma...
		output.push(newLine + nextIndent + keyStr + "":"" + sep + val);
	}
	return ""{"" + output.join("","" + sep) + newLine + _indentStr + ""}""; // String
}

}

if(!dojo._hasResource[""dojo._base.array""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.array""] = true;

dojo.provide(""dojo._base.array"");

(function(){
	var _getParts = function(arr, obj, cb){
		return [ 
			dojo.isString(arr) ? arr.split("""") : arr, 
			obj || dojo.global,
			// FIXME: cache the anonymous functions we create here?
			dojo.isString(cb) ? new Function(""item"", ""index"", ""array"", cb) : cb
		];
	};

	dojo.mixin(dojo, {
		indexOf: function(	/*Array*/		array, 
							/*Object*/		value,
							/*Integer?*/	fromIndex,
							/*Boolean?*/	findLast){
			// summary:
			//		locates the first index of the provided value in the
			//		passed array. If the value is not found, -1 is returned.
			// description:
			//		For details on this method, see:
			// 			http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:indexOf

			var step = 1, end = array.length || 0, i = 0;
			if(findLast){
				i = end - 1;
				step = end = -1;
			}
			if(fromIndex != undefined){ i = fromIndex; }
			if((findLast && i > end) || i < end){
				for(; i != end; i += step){
					if(array[i] == value){ return i; }
				}
			}
			return -1;	// Number
		},

		lastIndexOf: function(/*Array*/array, /*Object*/value, /*Integer?*/fromIndex){
			// summary:
			//		locates the last index of the provided value in the passed
			//		array. If the value is not found, -1 is returned.
			// description:
			//		For details on this method, see:
			// 			http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:lastIndexOf
			return dojo.indexOf(array, value, fromIndex, true); // Number
		},

		forEach: function(/*Array|String*/arr, /*Function|String*/callback, /*Object?*/thisObject){
			//	summary:
			//		for every item in arr, callback is invoked. Return values are ignored.
			//	arr:
			//		the array to iterate over. If a string, operates on individual characters.
			//	callback:
			//		a function is invoked with three arguments: item, index, and array
			//	thisObject:
			//		may be used to scope the call to callback
			//	description:
			//		This function corresponds to the JavaScript 1.6
			//		Array.forEach() method. For more details, see:
			//			http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:forEach
			//	example:
			//	|	// log out all members of the array:
			//	|	dojo.forEach(
			//	|		[ ""thinger"", ""blah"", ""howdy"", 10 ],
			//	|		function(item){
			//	|			
			//	|		}
			//	|	);
			//	example:
			//	|	// log out the members and their indexes
			//	|	dojo.forEach(
			//	|		[ ""thinger"", ""blah"", ""howdy"", 10 ],
			//	|		function(item, idx, arr){
			//	|			
			//	|		}
			//	|	);
			//	example:
			//	|	// use a scoped object member as the callback
			//	|	
			//	|	var obj = {
			//	|		prefix: ""logged via obj.callback:"", 
			//	|		callback: function(item){
			//	|			
			//	|		}
			//	|	};
			//	|	
			//	|	// specifying the scope function executes the callback in that scope
			//	|	dojo.forEach(
			//	|		[ ""thinger"", ""blah"", ""howdy"", 10 ],
			//	|		obj.callback,
			//	|		obj
			//	|	);
			//	|	
			//	|	// alternately, we can accomplish the same thing with dojo.hitch()
			//	|	dojo.forEach(
			//	|		[ ""thinger"", ""blah"", ""howdy"", 10 ],
			//	|		dojo.hitch(obj, ""callback"")
			//	|	);

			// match the behavior of the built-in forEach WRT empty arrs
			if(!arr || !arr.length){ return; }

			// FIXME: there are several ways of handilng thisObject. Is
			// dojo.global always the default context?
			var _p = _getParts(arr, thisObject, callback); arr = _p[0];
			for(var i=0,l=arr.length; i<l; ++i){ 
				_p[2].call(_p[1], arr[i], i, arr);
			}
		},

		_everyOrSome: function(/*Boolean*/every, /*Array|String*/arr, /*Function|String*/callback, /*Object?*/thisObject){
			var _p = _getParts(arr, thisObject, callback); arr = _p[0];
			for(var i=0,l=arr.length; i<l; ++i){
				var result = !!_p[2].call(_p[1], arr[i], i, arr);
				if(every ^ result){
					return result; // Boolean
				}
			}
			return every; // Boolean
		},

		every: function(/*Array|String*/arr, /*Function|String*/callback, /*Object?*/thisObject){
			// summary:
			//		Determines whether or not every item in arr satisfies the
			//		condition implemented by callback.
			// arr:
			//		the array to iterate on. If a string, operates on individual characters.
			// callback:
			//		a function is invoked with three arguments: item, index,
			//		and array and returns true if the condition is met.
			// thisObject:
			//		may be used to scope the call to callback
			// description:
			//		This function corresponds to the JavaScript 1.6
			//		Array.every() method. For more details, see:
			//			http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:every
			// example:
			//	|	// returns false
			//	|	dojo.every([1, 2, 3, 4], function(item){ return item>1; });
			// example:
			//	|	// returns true 
			//	|	dojo.every([1, 2, 3, 4], function(item){ return item>0; });
			return this._everyOrSome(true, arr, callback, thisObject); // Boolean
		},

		some: function(/*Array|String*/arr, /*Function|String*/callback, /*Object?*/thisObject){
			// summary:
			//		Determines whether or not any item in arr satisfies the
			//		condition implemented by callback.
			// arr:
			//		the array to iterate over. If a string, operates on individual characters.
			// callback:
			//		a function is invoked with three arguments: item, index,
			//		and array and returns true if the condition is met.
			// thisObject:
			//		may be used to scope the call to callback
			// description:
			//		This function corresponds to the JavaScript 1.6
			//		Array.some() method. For more details, see:
			//			http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:some
			// example:
			//	|	// is true
			//	|	dojo.some([1, 2, 3, 4], function(item){ return item>1; });
			// example:
			//	|	// is false
			//	|	dojo.some([1, 2, 3, 4], function(item){ return item<1; });
			return this._everyOrSome(false, arr, callback, thisObject); // Boolean
		},

		map: function(/*Array|String*/arr, /*Function|String*/callback, /*Function?*/thisObject){
			// summary:
			//		applies callback to each element of arr and returns
			//		an Array with the results
			// arr:
			//		the array to iterate on. If a string, operates on
			//		individual characters.
			// callback:
			//		a function is invoked with three arguments, (item, index,
			//		array),  and returns a value
			// thisObject:
			//		may be used to scope the call to callback
			// description:
			//		This function corresponds to the JavaScript 1.6 Array.map()
			//		method. For more details, see:
			//			http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:map
			// example:
			//	|	// returns [2, 3, 4, 5]
			//	|	dojo.map([1, 2, 3, 4], function(item){ return item+1 });

			var _p = _getParts(arr, thisObject, callback); arr = _p[0];
			var outArr = (arguments[3] ? (new arguments[3]()) : []);
			for(var i=0,l=arr.length; i<l; ++i){
				outArr.push(_p[2].call(_p[1], arr[i], i, arr));
			}
			return outArr; // Array
		},

		filter: function(/*Array*/arr, /*Function|String*/callback, /*Object?*/thisObject){
			// summary:
			//		Returns a new Array with those items from arr that match the
			//		condition implemented by callback.
			// arr:
			//		the array to iterate over.
			// callback:
			//		a function that is invoked with three arguments (item,
			//		index, array). The return of this function is expected to
			//		be a boolean which determines whether the passed-in item
			//		will be included in the returned array.
			// thisObject:
			//		may be used to scope the call to callback
			// description:
			//		This function corresponds to the JavaScript 1.6
			//		Array.filter() method. For more details, see:
			//			http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:filter
			// example:
			//	|	// returns [2, 3, 4]
			//	|	dojo.filter([1, 2, 3, 4], function(item){ return item>1; });

			var _p = _getParts(arr, thisObject, callback); arr = _p[0];
			var outArr = [];
			for(var i=0,l=arr.length; i<l; ++i){
				if(_p[2].call(_p[1], arr[i], i, arr)){
					outArr.push(arr[i]);
				}
			}
			return outArr; // Array
		}
	});
})();

}

if(!dojo._hasResource[""dojo._base.Color""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.Color""] = true;
dojo.provide(""dojo._base.Color"");



dojo.Color = function(/*Array|String|Object*/ color){
	// summary:
	//		takes a named string, hex string, array of rgb or rgba values,
	//		an object with r, g, b, and a properties, or another dojo.Color object
	if(color){ this.setColor(color); }
};

// FIXME: there's got to be a more space-efficient way to encode or discover these!!  Use hex?
dojo.Color.named = {
	black:      [0,0,0],
	silver:     [192,192,192],
	gray:       [128,128,128],
	white:      [255,255,255],
	maroon:		[128,0,0],
	red:        [255,0,0],
	purple:		[128,0,128],
	fuchsia:	[255,0,255],
	green:	    [0,128,0],
	lime:	    [0,255,0],
	olive:		[128,128,0],
	yellow:		[255,255,0],
	navy:       [0,0,128],
	blue:       [0,0,255],
	teal:		[0,128,128],
	aqua:		[0,255,255]
};


dojo.extend(dojo.Color, {
	r: 255, g: 255, b: 255, a: 1,
	_set: function(r, g, b, a){
		var t = this; t.r = r; t.g = g; t.b = b; t.a = a;
	},
	setColor: function(/*Array|String|Object*/ color){
		// summary:
		//		takes a named string, hex string, array of rgb or rgba values,
		//		an object with r, g, b, and a properties, or another dojo.Color object
		var d = dojo;
		if(d.isString(color)){
			d.colorFromString(color, this);
		}else if(d.isArray(color)){
			d.colorFromArray(color, this);
		}else{
			this._set(color.r, color.g, color.b, color.a);
			if(!(color instanceof d.Color)){ this.sanitize(); }
		}
		return this;	// dojo.Color
	},
	sanitize: function(){
		// summary:
		//		makes sure that the object has correct attributes
		// description: 
		//		the default implementation does nothing, include dojo.colors to
		//		augment it to real checks
		return this;	// dojo.Color
	},
	toRgb: function(){
		// summary: returns 3 component array of rgb values
		var t = this;
		return [t.r, t.g, t.b];	// Array
	},
	toRgba: function(){
		// summary: returns a 4 component array of rgba values
		var t = this;
		return [t.r, t.g, t.b, t.a];	// Array
	},
	toHex: function(){
		// summary: returns a css color string in hexadecimal representation
		var arr = dojo.map([""r"", ""g"", ""b""], function(x){
			var s = this[x].toString(16);
			return s.length < 2 ? ""0"" + s : s;
		}, this);
		return ""#"" + arr.join("""");	// String
	},
	toCss: function(/*Boolean?*/ includeAlpha){
		// summary: returns a css color string in rgb(a) representation
		var t = this, rgb = t.r + "", "" + t.g + "", "" + t.b;
		return (includeAlpha ? ""rgba("" + rgb + "", "" + t.a : ""rgb("" + rgb) + "")"";	// String
	},
	toString: function(){
		// summary: returns a visual representation of the color
		return this.toCss(true); // String
	}
});

dojo.blendColors = function(
	/*dojo.Color*/ start, 
	/*dojo.Color*/ end, 
	/*Number*/ weight,
	/*dojo.Color?*/ obj
){
	// summary: 
	//		blend colors end and start with weight from 0 to 1, 0.5 being a 50/50 blend,
	//		can reuse a previously allocated dojo.Color object for the result
	var d = dojo, t = obj || new dojo.Color();
	d.forEach([""r"", ""g"", ""b"", ""a""], function(x){
		t[x] = start[x] + (end[x] - start[x]) * weight;
		if(x != ""a""){ t[x] = Math.round(t[x]); }
	});
	return t.sanitize();	// dojo.Color
};

dojo.colorFromRgb = function(/*String*/ color, /*dojo.Color?*/ obj){
	// summary: get rgb(a) array from css-style color declarations
	var m = color.toLowerCase().match(/^rgba?\(([\s\.,0-9]+)\)/);
	return m && dojo.colorFromArray(m[1].split(/\s*,\s*/), obj);	// dojo.Color
};

dojo.colorFromHex = function(/*String*/ color, /*dojo.Color?*/ obj){
	// summary: converts a hex string with a '#' prefix to a color object.
	//	Supports 12-bit #rgb shorthand.
	var d = dojo, t = obj || new d.Color(),
		bits = (color.length == 4) ? 4 : 8,
		mask = (1 << bits) - 1;
	color = Number(""0x"" + color.substr(1));
	if(isNaN(color)){
		return null; // dojo.Color
	}
	d.forEach([""b"", ""g"", ""r""], function(x){
		var c = color & mask;
		color >>= bits;
		t[x] = bits == 4 ? 17 * c : c;
	});
	t.a = 1;
	return t;	// dojo.Color
};

dojo.colorFromArray = function(/*Array*/ a, /*dojo.Color?*/ obj){
	// summary: builds a color from 1, 2, 3, or 4 element array
	var t = obj || new dojo.Color();
	t._set(Number(a[0]), Number(a[1]), Number(a[2]), Number(a[3]));
	if(isNaN(t.a)){ t.a = 1; }
	return t.sanitize();	// dojo.Color
};

dojo.colorFromString = function(/*String*/ str, /*dojo.Color?*/ obj){
	//	summary:
	//		parses str for a color value.
	//	description:
	//		Acceptable input values for str may include arrays of any form
	//		accepted by dojo.colorFromArray, hex strings such as ""#aaaaaa"", or
	//		rgb or rgba strings such as ""rgb(133, 200, 16)"" or ""rgba(10, 10,
	//		10, 50)""
	//	returns:
	//		a dojo.Color object. If obj is passed, it will be the return value.
	var a = dojo.Color.named[str];
	return a && dojo.colorFromArray(a, obj) || dojo.colorFromRgb(str, obj) || dojo.colorFromHex(str, obj);
};

}

if(!dojo._hasResource[""dojo._base""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base""] = true;
dojo.provide(""dojo._base"");









}

if(!dojo._hasResource[""dojo._base.window""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.window""] = true;
dojo.provide(""dojo._base.window"");

/*=====
dojo.doc = {
	// summary:
	//		Alias for the current document. 'dojo.doc' can be modified
	//		for temporary context shifting. Also see dojo.withDoc().
	// description:
	//    Refer to dojo.doc rather
	//    than referring to 'window.document' to ensure your code runs
	//    correctly in managed contexts.
	// example:
	// 	|	n.appendChild(dojo.doc.createElement('div'));
}
=====*/
dojo.doc = window[""document""] || null;

dojo.body = function(){
	// summary:
	//		Return the body element of the document
	//		return the body object associated with dojo.doc
	// example:
	// 	|	dojo.body().appendChild(dojo.doc.createElement('div'));

	// Note: document.body is not defined for a strict xhtml document
	// Would like to memoize this, but dojo.doc can change vi dojo.withDoc().
	return dojo.doc.body || dojo.doc.getElementsByTagName(""body"")[0]; // Node
}

dojo.setContext = function(/*Object*/globalObject, /*DocumentElement*/globalDocument){
	// summary:
	//		changes the behavior of many core Dojo functions that deal with
	//		namespace and DOM lookup, changing them to work in a new global
	//		context (e.g., an iframe). The varibles dojo.global and dojo.doc
	//		are modified as a result of calling this function and the result of
	//		`dojo.body()` likewise differs.
	dojo.global = globalObject;
	dojo.doc = globalDocument;
};

dojo._fireCallback = function(callback, context, cbArguments){
	if(context && dojo.isString(callback)){
		callback = context[callback];
	}
	return callback.apply(context, cbArguments || [ ]);
}

dojo.withGlobal = function(	/*Object*/globalObject, 
							/*Function*/callback, 
							/*Object?*/thisObject, 
							/*Array?*/cbArguments){
	// summary:
	//		Call callback with globalObject as dojo.global and
	//		globalObject.document as dojo.doc. If provided, globalObject
	//		will be executed in the context of object thisObject
	// description:
	//		When callback() returns or throws an error, the dojo.global
	//		and dojo.doc will be restored to its previous state.
	var rval;
	var oldGlob = dojo.global;
	var oldDoc = dojo.doc;
	try{
		dojo.setContext(globalObject, globalObject.document);
		rval = dojo._fireCallback(callback, thisObject, cbArguments);
	}finally{
		dojo.setContext(oldGlob, oldDoc);
	}
	return rval;
}

dojo.withDoc = function(	/*Object*/documentObject, 
							/*Function*/callback, 
							/*Object?*/thisObject, 
							/*Array?*/cbArguments){
	// summary:
	//		Call callback with documentObject as dojo.doc. If provided,
	//		callback will be executed in the context of object thisObject
	// description:
	//		When callback() returns or throws an error, the dojo.doc will
	//		be restored to its previous state.
	var rval;
	var oldDoc = dojo.doc;
	try{
		dojo.doc = documentObject;
		rval = dojo._fireCallback(callback, thisObject, cbArguments);
	}finally{
		dojo.doc = oldDoc;
	}
	return rval;
};

}

if(!dojo._hasResource[""dojo._base.event""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.event""] = true;
dojo.provide(""dojo._base.event"");


// this file courtesy of the TurboAjax Group, licensed under a Dojo CLA

(function(){
	// DOM event listener machinery
	var del = (dojo._event_listener = {
		add: function(/*DOMNode*/node, /*String*/name, /*Function*/fp){
			if(!node){return;} 
			name = del._normalizeEventName(name);
			fp = del._fixCallback(name, fp);
			var oname = name;
			if(!dojo.isIE && (name == ""mouseenter"" || name == ""mouseleave"")){
				var ofp = fp;
				//oname = name;
				name = (name == ""mouseenter"") ? ""mouseover"" : ""mouseout"";
				fp = function(e){
					// check tagName to fix a FF2 bug with invalid nodes (hidden child DIV of INPUT)
					// which causes isDecendant to return false which causes
					// spurious, and more importantly, incorrect mouse events to fire.
					// TODO: remove tagName check when Firefox 2 is no longer supported
					try{ e.relatedTarget.tagName; } catch(e2){ return; }
					if(!dojo.isDescendant(e.relatedTarget, node)){
						// e.type = oname; // FIXME: doesn't take? SJM: event.type is generally immutable.
						return ofp.call(this, e); 
					}
				}
			}
			node.addEventListener(name, fp, false);
			return fp; /*Handle*/
		},
		remove: function(/*DOMNode*/node, /*String*/event, /*Handle*/handle){
			// summary:
			//		clobbers the listener from the node
			// node:
			//		DOM node to attach the event to
			// event:
			//		the name of the handler to remove the function from
			// handle:
			//		the handle returned from add
			if (node){
				event = del._normalizeEventName(event);
				if(!dojo.isIE && (event == ""mouseenter"" || event == ""mouseleave"")){
					event = (event == ""mouseenter"") ? ""mouseover"" : ""mouseout"";
				}

				node.removeEventListener(event, handle, false);
			}
		},
		_normalizeEventName: function(/*String*/name){
			// Generally, name should be lower case, unless it is special
			// somehow (e.g. a Mozilla DOM event).
			// Remove 'on'.
			return name.slice(0,2) ==""on"" ? name.slice(2) : name;
		},
		_fixCallback: function(/*String*/name, fp){
			// By default, we only invoke _fixEvent for 'keypress'
			// If code is added to _fixEvent for other events, we have
			// to revisit this optimization.
			// This also applies to _fixEvent overrides for Safari and Opera
			// below.
			return name != ""keypress"" ? fp : function(e){ return fp.call(this, del._fixEvent(e, this)); };
		},
		_fixEvent: function(evt, sender){
			// _fixCallback only attaches us to keypress.
			// Switch on evt.type anyway because we might 
			// be called directly from dojo.fixEvent.
			switch(evt.type){
				case ""keypress"":
					del._setKeyChar(evt);
					break;
			}
			return evt;
		},
		_setKeyChar: function(evt){
			evt.keyChar = evt.charCode ? String.fromCharCode(evt.charCode) : '';
			evt.charOrCode = evt.keyChar || evt.keyCode;
		},
		// For IE and Safari: some ctrl-key combinations (mostly w/punctuation) do not emit a char code in IE
		// we map those virtual key codes to ascii here
		// not valid for all (non-US) keyboards, so maybe we shouldn't bother
		_punctMap: { 
			106:42, 
			111:47, 
			186:59, 
			187:43, 
			188:44, 
			189:45, 
			190:46, 
			191:47, 
			192:96, 
			219:91, 
			220:92, 
			221:93, 
			222:39 
		}
	});

	// DOM events
	
	dojo.fixEvent = function(/*Event*/evt, /*DOMNode*/sender){
		// summary:
		//		normalizes properties on the event object including event
		//		bubbling methods, keystroke normalization, and x/y positions
		// evt: Event
		//		native event object
		// sender: DOMNode
		//		node to treat as ""currentTarget""
		return del._fixEvent(evt, sender);
	}

	dojo.stopEvent = function(/*Event*/evt){
		// summary:
		//		prevents propagation and clobbers the default action of the
		//		passed event
		// evt: Event
		//		The event object. If omitted, window.event is used on IE.
		evt.preventDefault();
		evt.stopPropagation();
		// NOTE: below, this method is overridden for IE
	}

	// the default listener to use on dontFix nodes, overriden for IE
	var node_listener = dojo._listener;
	
	// Unify connect and event listeners
	dojo._connect = function(obj, event, context, method, dontFix){
		// FIXME: need a more strict test
		var isNode = obj && (obj.nodeType||obj.attachEvent||obj.addEventListener);
		// choose one of three listener options: raw (connect.js), DOM event on a Node, custom event on a Node
		// we need the third option to provide leak prevention on broken browsers (IE)
		var lid = !isNode ? 0 : (!dontFix ? 1 : 2), l = [dojo._listener, del, node_listener][lid];
		// create a listener
		var h = l.add(obj, event, dojo.hitch(context, method));
		// formerly, the disconnect package contained ""l"" directly, but if client code
		// leaks the disconnect package (by connecting it to a node), referencing ""l"" 
		// compounds the problem.
		// instead we return a listener id, which requires custom _disconnect below.
		// return disconnect package
		return [ obj, event, h, lid ];
	}

	dojo._disconnect = function(obj, event, handle, listener){
		([dojo._listener, del, node_listener][listener]).remove(obj, event, handle);
	}

	// Constants

	// Public: client code should test
	// keyCode against these named constants, as the
	// actual codes can vary by browser.
	dojo.keys = {
		// summary: definitions for common key values
		BACKSPACE: 8,
		TAB: 9,
		CLEAR: 12,
		ENTER: 13,
		SHIFT: 16,
		CTRL: 17,
		ALT: 18,
		PAUSE: 19,
		CAPS_LOCK: 20,
		ESCAPE: 27,
		SPACE: 32,
		PAGE_UP: 33,
		PAGE_DOWN: 34,
		END: 35,
		HOME: 36,
		LEFT_ARROW: 37,
		UP_ARROW: 38,
		RIGHT_ARROW: 39,
		DOWN_ARROW: 40,
		INSERT: 45,
		DELETE: 46,
		HELP: 47,
		LEFT_WINDOW: 91,
		RIGHT_WINDOW: 92,
		SELECT: 93,
		NUMPAD_0: 96,
		NUMPAD_1: 97,
		NUMPAD_2: 98,
		NUMPAD_3: 99,
		NUMPAD_4: 100,
		NUMPAD_5: 101,
		NUMPAD_6: 102,
		NUMPAD_7: 103,
		NUMPAD_8: 104,
		NUMPAD_9: 105,
		NUMPAD_MULTIPLY: 106,
		NUMPAD_PLUS: 107,
		NUMPAD_ENTER: 108,
		NUMPAD_MINUS: 109,
		NUMPAD_PERIOD: 110,
		NUMPAD_DIVIDE: 111,
		F1: 112,
		F2: 113,
		F3: 114,
		F4: 115,
		F5: 116,
		F6: 117,
		F7: 118,
		F8: 119,
		F9: 120,
		F10: 121,
		F11: 122,
		F12: 123,
		F13: 124,
		F14: 125,
		F15: 126,
		NUM_LOCK: 144,
		SCROLL_LOCK: 145
	};
	
	// IE event normalization
	if(dojo.isIE){ 
		var _trySetKeyCode = function(e, code){
			try{
				// squelch errors when keyCode is read-only
				// (e.g. if keyCode is ctrl or shift)
				return (e.keyCode = code);
			}catch(e){
				return 0;
			}
		}

		// by default, use the standard listener
		var iel = dojo._listener;
		var listenersName = dojo._ieListenersName = ""_"" + dojo._scopeName + ""_listeners"";
		// dispatcher tracking property
		if(!dojo.config._allow_leaks){
			// custom listener that handles leak protection for DOM events
			node_listener = iel = dojo._ie_listener = {
				// support handler indirection: event handler functions are 
				// referenced here. Event dispatchers hold only indices.
				handlers: [],
				// add a listener to an object
				add: function(/*Object*/ source, /*String*/ method, /*Function*/ listener){
					source = source || dojo.global;
					var f = source[method];
					if(!f||!f[listenersName]){
						var d = dojo._getIeDispatcher();
						// original target function is special
						d.target = f && (ieh.push(f) - 1);
						// dispatcher holds a list of indices into handlers table
						d[listenersName] = [];
						// redirect source to dispatcher
						f = source[method] = d;
					}
					return f[listenersName].push(ieh.push(listener) - 1) ; /*Handle*/
				},
				// remove a listener from an object
				remove: function(/*Object*/ source, /*String*/ method, /*Handle*/ handle){
					var f = (source||dojo.global)[method], l = f && f[listenersName];
					if(f && l && handle--){
						delete ieh[l[handle]];
						delete l[handle];
					}
				}
			};
			// alias used above
			var ieh = iel.handlers;
		}

		dojo.mixin(del, {
			add: function(/*DOMNode*/node, /*String*/event, /*Function*/fp){
				if(!node){return;} // undefined
				event = del._normalizeEventName(event);
				if(event==""onkeypress""){
					// we need to listen to onkeydown to synthesize
					// keypress events that otherwise won't fire
					// on IE
					var kd = node.onkeydown;
					if(!kd || !kd[listenersName] || !kd._stealthKeydownHandle){
						var h = del.add(node, ""onkeydown"", del._stealthKeyDown);
						kd = node.onkeydown;
						kd._stealthKeydownHandle = h;
						kd._stealthKeydownRefs = 1;
					}else{
						kd._stealthKeydownRefs++;
					}
				}
				return iel.add(node, event, del._fixCallback(fp));
			},
			remove: function(/*DOMNode*/node, /*String*/event, /*Handle*/handle){
				event = del._normalizeEventName(event);
				iel.remove(node, event, handle); 
				if(event==""onkeypress""){
					var kd = node.onkeydown;
					if(--kd._stealthKeydownRefs <= 0){
						iel.remove(node, ""onkeydown"", kd._stealthKeydownHandle);
						delete kd._stealthKeydownHandle;
					}
				}
			},
			_normalizeEventName: function(/*String*/eventName){
				// Generally, eventName should be lower case, unless it is
				// special somehow (e.g. a Mozilla event)
				// ensure 'on'
				return eventName.slice(0,2) != ""on"" ? ""on"" + eventName : eventName;
			},
			_nop: function(){},
			_fixEvent: function(/*Event*/evt, /*DOMNode*/sender){
				// summary:
				//		normalizes properties on the event object including event
				//		bubbling methods, keystroke normalization, and x/y positions
				// evt: native event object
				// sender: node to treat as ""currentTarget""
				if(!evt){
					var w = sender && (sender.ownerDocument || sender.document || sender).parentWindow || window;
					evt = w.event; 
				}
				if(!evt){return(evt);}
				evt.target = evt.srcElement; 
				evt.currentTarget = (sender || evt.srcElement); 
				evt.layerX = evt.offsetX;
				evt.layerY = evt.offsetY;
				// FIXME: scroll position query is duped from dojo.html to
				// avoid dependency on that entire module. Now that HTML is in
				// Base, we should convert back to something similar there.
				var se = evt.srcElement, doc = (se && se.ownerDocument) || document;
				// DO NOT replace the following to use dojo.body(), in IE, document.documentElement should be used
				// here rather than document.body
				var docBody = ((dojo.isIE < 6) || (doc[""compatMode""] == ""BackCompat"")) ? doc.body : doc.documentElement;
				var offset = dojo._getIeDocumentElementOffset();
				evt.pageX = evt.clientX + dojo._fixIeBiDiScrollLeft(docBody.scrollLeft || 0) - offset.x;
				evt.pageY = evt.clientY + (docBody.scrollTop || 0) - offset.y;
				if(evt.type == ""mouseover""){ 
					evt.relatedTarget = evt.fromElement;
				}
				if(evt.type == ""mouseout""){ 
					evt.relatedTarget = evt.toElement;
				}
				evt.stopPropagation = del._stopPropagation;
				evt.preventDefault = del._preventDefault;
				return del._fixKeys(evt);
			},
			_fixKeys: function(evt){
				switch(evt.type){
					case ""keypress"":
						var c = (""charCode"" in evt ? evt.charCode : evt.keyCode);
						if (c==10){
							// CTRL-ENTER is CTRL-ASCII(10) on IE, but CTRL-ENTER on Mozilla
							c=0;
							evt.keyCode = 13;
						}else if(c==13||c==27){
							c=0; // Mozilla considers ENTER and ESC non-printable
						}else if(c==3){
							c=99; // Mozilla maps CTRL-BREAK to CTRL-c
						}
						// Mozilla sets keyCode to 0 when there is a charCode
						// but that stops the event on IE.
						evt.charCode = c;
						del._setKeyChar(evt);
						break;
				}
				return evt;
			},
			_stealthKeyDown: function(evt){
				// IE doesn't fire keypress for most non-printable characters.
				// other browsers do, we simulate it here.
				var kp = evt.currentTarget.onkeypress;
				// only works if kp exists and is a dispatcher
				if(!kp || !kp[listenersName]){ return; }
				// munge key/charCode
				var k=evt.keyCode;
				// These are Windows Virtual Key Codes
				// http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/WinUI/WindowsUserInterface/UserInput/VirtualKeyCodes.asp
				var unprintable = (k!=13)&&(k!=32)&&(k!=27)&&(k<48||k>90)&&(k<96||k>111)&&(k<186||k>192)&&(k<219||k>222);
				// synthesize keypress for most unprintables and CTRL-keys
				if(unprintable||evt.ctrlKey){
					var c = unprintable ? 0 : k;
					if(evt.ctrlKey){
						if(k==3 || k==13){
							return; // IE will post CTRL-BREAK, CTRL-ENTER as keypress natively 
						}else if(c>95 && c<106){ 
							c -= 48; // map CTRL-[numpad 0-9] to ASCII
						}else if((!evt.shiftKey)&&(c>=65&&c<=90)){ 
							c += 32; // map CTRL-[A-Z] to lowercase
						}else{ 
							c = del._punctMap[c] || c; // map other problematic CTRL combinations to ASCII
						}
					}
					// simulate a keypress event
					var faux = del._synthesizeEvent(evt, {type: 'keypress', faux: true, charCode: c});
					kp.call(evt.currentTarget, faux);
					evt.cancelBubble = faux.cancelBubble;
					evt.returnValue = faux.returnValue;
					_trySetKeyCode(evt, faux.keyCode);
				}
			},
			// Called in Event scope
			_stopPropagation: function(){
				this.cancelBubble = true; 
			},
			_preventDefault: function(){
				// Setting keyCode to 0 is the only way to prevent certain keypresses (namely
				// ctrl-combinations that correspond to menu accelerator keys).
				// Otoh, it prevents upstream listeners from getting this information
				// Try to split the difference here by clobbering keyCode only for ctrl 
				// combinations. If you still need to access the key upstream, bubbledKeyCode is
				// provided as a workaround.
				this.bubbledKeyCode = this.keyCode;
				if(this.ctrlKey){_trySetKeyCode(this, 0);}
				this.returnValue = false;
			}
		});
				
		// override stopEvent for IE
		dojo.stopEvent = function(evt){
			evt = evt || window.event;
			del._stopPropagation.call(evt);
			del._preventDefault.call(evt);
		}
	}

	del._synthesizeEvent = function(evt, props){
			var faux = dojo.mixin({}, evt, props);
			del._setKeyChar(faux);
			// FIXME: would prefer to use dojo.hitch: dojo.hitch(evt, evt.preventDefault); 
			// but it throws an error when preventDefault is invoked on Safari
			// does Event.preventDefault not support ""apply"" on Safari?
			faux.preventDefault = function(){ evt.preventDefault(); }; 
			faux.stopPropagation = function(){ evt.stopPropagation(); }; 
			return faux;
	}
	
	// Opera event normalization
	if(dojo.isOpera){
		dojo.mixin(del, {
			_fixEvent: function(evt, sender){
				switch(evt.type){
					case ""keypress"":
						var c = evt.which;
						if(c==3){
							c=99; // Mozilla maps CTRL-BREAK to CTRL-c
						}
						// can't trap some keys at all, like INSERT and DELETE
						// there is no differentiating info between DELETE and ""."", or INSERT and ""-""
						c = ((c<41)&&(!evt.shiftKey) ? 0 : c);
						if((evt.ctrlKey)&&(!evt.shiftKey)&&(c>=65)&&(c<=90)){
							// lowercase CTRL-[A-Z] keys
							c += 32;
						}
						return del._synthesizeEvent(evt, { charCode: c });
				}
				return evt;
			}
		});
	}

	// Safari event normalization
	if(dojo.isSafari){
		del._add = del.add;
		del._remove = del.remove;

		dojo.mixin(del, {
			add: function(/*DOMNode*/node, /*String*/event, /*Function*/fp){
				if(!node){return;} // undefined
				var handle = del._add(node, event, fp);
				if(del._normalizeEventName(event) == ""keypress""){
					// we need to listen to onkeydown to synthesize
					// keypress events that otherwise won't fire
					// in Safari 3.1+: https://lists.webkit.org/pipermail/webkit-dev/2007-December/002992.html
					handle._stealthKeyDownHandle = del._add(node, ""keydown"", function(evt){
						//A variation on the IE _stealthKeydown function
						//Synthesize an onkeypress event, but only for unprintable characters.
						var k=evt.keyCode;
						// These are Windows Virtual Key Codes
						// http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/WinUI/WindowsUserInterface/UserInput/VirtualKeyCodes.asp
						var unprintable = (k!=13)&&(k!=32)&&(k!=27)&&(k<48||k>90)&&(k<96||k>111)&&(k<186||k>192)&&(k<219||k>222);
						// synthesize keypress for most unprintables and CTRL-keys
						if(unprintable||evt.ctrlKey){
							var c = unprintable ? 0 : k;
							if(evt.ctrlKey){
								if(k==3 || k==13){
									return; // IE will post CTRL-BREAK, CTRL-ENTER as keypress natively 
								}else if(c>95 && c<106){ 
									c -= 48; // map CTRL-[numpad 0-9] to ASCII
								}else if((!evt.shiftKey)&&(c>=65&&c<=90)){ 
									c += 32; // map CTRL-[A-Z] to lowercase
								}else{ 
									c = del._punctMap[c] || c; // map other problematic CTRL combinations to ASCII
								}
							}
							// simulate a keypress event
							var faux = del._synthesizeEvent(evt, {type: 'keypress', faux: true, charCode: c});
							fp.call(evt.currentTarget, faux);
						}
					});
				}
				return handle; /*Handle*/
			},

			remove: function(/*DOMNode*/node, /*String*/event, /*Handle*/handle){
				if(node){
					if(handle._stealthKeyDownHandle){
						del._remove(node, ""keydown"", handle._stealthKeyDownHandle);
					}
					del._remove(node, event, handle);
				}
			},
			_fixEvent: function(evt, sender){
				switch(evt.type){
					case ""keypress"":
						if(evt.faux){ return evt; }
						var c = evt.charCode;
						c = c>=32? c : 0;
						return del._synthesizeEvent(evt, {charCode: c, faux: true});
				}
				return evt;
			}
		});
	}
})();

if(dojo.isIE){
	// keep this out of the closure
	// closing over 'iel' or 'ieh' b0rks leak prevention
	// ls[i] is an index into the master handler array
	dojo._ieDispatcher = function(args, sender){
		var ap=Array.prototype, h=dojo._ie_listener.handlers, c=args.callee, ls=c[dojo._ieListenersName], t=h[c.target];
		// return value comes from original target function
		var r = t && t.apply(sender, args);
		// make local copy of listener array so it's immutable during processing
		var lls = [].concat(ls);
		// invoke listeners after target function
		for(var i in lls){
			if(!(i in ap)){
				h[lls[i]].apply(sender, args);
			}
		}
		return r;
	}
	dojo._getIeDispatcher = function(){
		// ensure the returned function closes over nothing (""new Function"" apparently doesn't close)
		return new Function(dojo._scopeName + ""._ieDispatcher(arguments, this)""); // function
	}
	// keep this out of the closure to reduce RAM allocation
	dojo._event_listener._fixCallback = function(fp){
		var f = dojo._event_listener._fixEvent;
		return function(e){ return fp.call(this, f(e, this)); };
	}
}

}

if(!dojo._hasResource[""dojo._base.html""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.html""] = true;

dojo.provide(""dojo._base.html"");

// FIXME: need to add unit tests for all the semi-public methods

try{
	document.execCommand(""BackgroundImageCache"", false, true);
}catch(e){
	// sane browsers don't have cache ""issues""
}

// =============================
// DOM Functions
// =============================

/*=====
dojo.byId = function(id, doc){
	//	summary:
	//		Returns DOM node with matching `id` attribute or `null` 
	//		if not found, similar to ""$"" function in another library.
	//		If `id` is a DomNode, this function is a no-op.
	//
	//	id: String|DOMNode
	//	 	A string to match an HTML id attribute or a reference to a DOM Node
	//
	//	doc: Document?
	//		Document to work in. Defaults to the current value of
	//		dojo.doc.  Can be used to retrieve
	//		node references from other documents.
=====*/
if(dojo.isIE || dojo.isOpera){
	dojo.byId = function(id, doc){
		if(dojo.isString(id)){
			var _d = doc || dojo.doc;
			var te = _d.getElementById(id);
			// attributes.id.value is better than just id in case the 
			// user has a name=id inside a form
			if(te && te.attributes.id.value == id){
				return te;
			}else{
				var eles = _d.all[id];
				if(!eles || !eles.length){ return eles; }
				// if more than 1, choose first with the correct id
				var i=0;
				while((te=eles[i++])){
					if(te.attributes.id.value == id){ return te; }
				}
			}
		}else{
			return id; // DomNode
		}
	}
}else{
	dojo.byId = function(id, doc){
		return dojo.isString(id) ? (doc || dojo.doc).getElementById(id) : id; // DomNode
	}
}
/*=====
}
=====*/

(function(){
	var d = dojo;

	var _destroyContainer = null;
	dojo.addOnWindowUnload(function(){
		_destroyContainer=null; //prevent IE leak
	});

	dojo._destroyElement = function(/*String||DomNode*/node){
		// summary:
		//		removes node from its parent, clobbers it and all of its
		//		children.
		//	node:
		//		the element to be destroyed, either as an ID or a reference

		node = d.byId(node);
		try{
			if(!_destroyContainer || _destroyContainer.ownerDocument != node.ownerDocument){
				_destroyContainer = node.ownerDocument.createElement(""div"");
			}
			_destroyContainer.appendChild(node.parentNode ? node.parentNode.removeChild(node) : node);
			// NOTE: see http://trac.dojotoolkit.org/ticket/2931. This may be a bug and not a feature
			_destroyContainer.innerHTML = """"; 
		}catch(e){
			/* squelch */
		}
	};

	dojo.isDescendant = function(/*DomNode|String*/node, /*DomNode|String*/ancestor){
		//	summary:
		//		Returns true if node is a descendant of ancestor
		//	node: id or node reference to test
		//	ancestor: id or node reference of potential parent to test against
		try{
			node = d.byId(node);
			ancestor = d.byId(ancestor);
			while(node){
				if(node === ancestor){
					return true; // Boolean
				}
				node = node.parentNode;
			}
		}catch(e){ /* squelch, return false */ }
		return false; // Boolean
	};

	dojo.setSelectable = function(/*DomNode|String*/node, /*Boolean*/selectable){
		//	summary: enable or disable selection on a node
		//	node:
		//		id or reference to node
		//	selectable:
		node = d.byId(node);
		if(d.isMozilla){
			node.style.MozUserSelect = selectable ? """" : ""none"";
		}else if(d.isKhtml){
			node.style.KhtmlUserSelect = selectable ? ""auto"" : ""none"";
		}else if(d.isIE){
			var v = (node.unselectable = selectable ? """" : ""on"");
			d.query(""*"", node).forEach(""item.unselectable = '""+v+""'"");
		}
		//FIXME: else?  Opera?
	};

	var _insertBefore = function(/*Node*/node, /*Node*/ref){
		ref.parentNode.insertBefore(node, ref);
		return true;	//	boolean
	}

	var _insertAfter = function(/*Node*/node, /*Node*/ref){
		//	summary:
		//		Try to insert node after ref
		var pn = ref.parentNode;
		if(ref == pn.lastChild){
			pn.appendChild(node);
		}else{
			return _insertBefore(node, ref.nextSibling);	//	boolean
		}
		return true;	//	boolean
	}

	dojo.place = function(/*String|DomNode*/node, /*String|DomNode*/refNode, /*String?|Number?*/position){
		//	summary:
		//		Attempt to insert node into the DOM, choosing from various positioning options.
		//		Returns true if successful, false otherwise.
		//	node: 
		//		id or node reference to place relative to refNode
		//	refNode: 
		//		id or node reference to use as basis for placement
		//	position:
		//		string noting the position of node relative to refNode or a
		//		number indicating the location in the childNodes collection of refNode. 
		//		Accepted string values are:
		//		* before
		//		* after
		//		* first
		//		* last
		//
		//		""first"" and ""last"" indicate positions as children of refNode.  position defaults
		//		to ""last"" if not specified

		// FIXME: need to write tests for this!!!!
		if(!node || !refNode){
			return false;	//	boolean 
		}
		node = d.byId(node);
		refNode = d.byId(refNode);
		if(typeof position == ""number""){
			var cn = refNode.childNodes;
			if(!cn.length || cn.length <= position){
				refNode.appendChild(node);
				return true;
			}
			return _insertBefore(node, position <= 0 ? refNode.firstChild : cn[position]);
		}
		switch(position){
			case ""before"":
				return _insertBefore(node, refNode);	//	boolean
			case ""after"":
				return _insertAfter(node, refNode);		//	boolean
			case ""first"":
				if(refNode.firstChild){
					return _insertBefore(node, refNode.firstChild);	//	boolean
				}
				// else fallthrough...
			default: // aka: last
				refNode.appendChild(node);
				return true;	//	boolean
		}
	}

	// Box functions will assume this model.
	// On IE/Opera, BORDER_BOX will be set if the primary document is in quirks mode.
	// Can be set to change behavior of box setters.
	
	// can be either:
	//	""border-box""
	//	""content-box"" (default)
	dojo.boxModel = ""content-box"";
	
	// We punt per-node box mode testing completely.
	// If anybody cares, we can provide an additional (optional) unit 
	// that overrides existing code to include per-node box sensitivity.

	// Opera documentation claims that Opera 9 uses border-box in BackCompat mode.
	// but experiments (Opera 9.10.8679 on Windows Vista) indicate that it actually continues to use content-box.
	// IIRC, earlier versions of Opera did in fact use border-box.
	// Opera guys, this is really confusing. Opera being broken in quirks mode is not our fault.

	if(d.isIE /*|| dojo.isOpera*/){
		var _dcm = document.compatMode;
		// client code may have to adjust if compatMode varies across iframes
		d.boxModel = _dcm == ""BackCompat"" || _dcm == ""QuirksMode"" || d.isIE<6 ? ""border-box"" : ""content-box""; // FIXME: remove IE < 6 support?
	}

	// =============================
	// Style Functions
	// =============================
	
	// getComputedStyle drives most of the style code.
	// Wherever possible, reuse the returned object.
	//
	// API functions below that need to access computed styles accept an 
	// optional computedStyle parameter.
	// If this parameter is omitted, the functions will call getComputedStyle themselves.
	// This way, calling code can access computedStyle once, and then pass the reference to 
	// multiple API functions. 

/*=====
	dojo.getComputedStyle = function(node){
		//	summary:
		//		Returns a ""computed style"" object.
		//
		//	description:
		//		Gets a ""computed style"" object which can be used to gather
		//		information about the current state of the rendered node. 
		//
		//		Note that this may behave differently on different browsers.
		//		Values may have different formats and value encodings across
		//		browsers.
		//
		//		Note also that this method is expensive.  Wherever possible,
		//		reuse the returned object.
		//
		//		Use the dojo.style() method for more consistent (pixelized)
		//		return values.
		//
		//	node: DOMNode
		//		A reference to a DOM node. Does NOT support taking an
		//		ID string for speed reasons.
		//	example:
		//	|	dojo.getComputedStyle(dojo.byId('foo')).borderWidth;
		return; // CSS2Properties
	}
=====*/

	// Although we normally eschew argument validation at this
	// level, here we test argument 'node' for (duck)type.
	// Argument node must also implement Element.  (Note: we check
	// against HTMLElement rather than Element for interop with prototype.js)
	// Because 'document' is the 'parentNode' of 'body'
	// it is frequently sent to this function even 
	// though it is not Element.
	var gcs;
	if(d.isSafari){
		gcs = function(/*DomNode*/node){
			var s;
			if(node instanceof HTMLElement){
				var dv = node.ownerDocument.defaultView;
				s = dv.getComputedStyle(node, null);
				if(!s && node.style){ 
					node.style.display = """"; 
					s = dv.getComputedStyle(node, null);
				}
			}
			return s || {};
		}; 
	}else if(d.isIE){
		gcs = function(node){
			// IE (as of 7) doesn't expose Element like sane browsers
			return node.nodeType == 1 /* ELEMENT_NODE*/ ? node.currentStyle : {};
		};
	}else{
		gcs = function(node){
			return node instanceof HTMLElement ? 
				node.ownerDocument.defaultView.getComputedStyle(node, null) : {};
		};
	}
	dojo.getComputedStyle = gcs;

	if(!d.isIE){
		dojo._toPixelValue = function(element, value){
			// style values can be floats, client code may want
			// to round for integer pixels.
			return parseFloat(value) || 0; 
		};
	}else{
		dojo._toPixelValue = function(element, avalue){
			if(!avalue){ return 0; }
			// on IE7, medium is usually 4 pixels
			if(avalue==""medium""){ return 4; }
			// style values can be floats, client code may
			// want to round this value for integer pixels.
			if(avalue.slice && (avalue.slice(-2)=='px')){ return parseFloat(avalue); }
			with(element){
				var sLeft = style.left;
				var rsLeft = runtimeStyle.left;
				runtimeStyle.left = currentStyle.left;
				try{
					// 'avalue' may be incompatible with style.left, which can cause IE to throw
					// this has been observed for border widths using ""thin"", ""medium"", ""thick"" constants
					// those particular constants could be trapped by a lookup
					// but perhaps there are more
					style.left = avalue;
					avalue = style.pixelLeft;
				}catch(e){
					avalue = 0;
				}
				style.left = sLeft;
				runtimeStyle.left = rsLeft;
			}
			return avalue;
		}
	}
	var px = d._toPixelValue;

	// FIXME: there opacity quirks on FF that we haven't ported over. Hrm.
	/*=====
	dojo._getOpacity = function(node){
			//	summary:
			//		Returns the current opacity of the passed node as a
			//		floating-point value between 0 and 1.
			//	node: DomNode
			//		a reference to a DOM node. Does NOT support taking an
			//		ID string for speed reasons.
			//	returns: Number between 0 and 1
			return; // Number
	}
	=====*/

	var astr = ""DXImageTransform.Microsoft.Alpha"";
	var af = function(n, f){ 
		try{
			return n.filters.item(astr);
		}catch(e){
			return f ? {} : null;
		}
	}

	dojo._getOpacity = d.isIE ? function(node){
		try{
			return af(node).Opacity / 100; // Number
		}catch(e){
			return 1; // Number
		}
	} : function(node){
		return gcs(node).opacity;
	};

	/*=====
	dojo._setOpacity = function(node, opacity){
			//	summary:
			//		set the opacity of the passed node portably. Returns the
			//		new opacity of the node.
			//	node: DOMNode
			//		a reference to a DOM node. Does NOT support taking an
			//		ID string for performance reasons.
			//	opacity: Number
			//		A Number between 0 and 1. 0 specifies transparent.
			//	returns: Number between 0 and 1
			return; // Number
	}
	=====*/

	dojo._setOpacity = d.isIE ? function(/*DomNode*/node, /*Number*/opacity){
		var ov = opacity * 100;
		node.style.zoom = 1.0;

		// on IE7 Alpha(Filter opacity=100) makes text look fuzzy so disable it altogether (bug #2661),
		//but still update the opacity value so we can get a correct reading if it is read later.
		af(node, 1).Enabled = (opacity == 1 ? false : true);

		if(!af(node)){
			node.style.filter += "" progid:""+astr+""(Opacity=""+ov+"")"";
		}else{
			af(node, 1).Opacity = ov;
		}

		if(node.nodeName.toLowerCase() == ""tr""){
			d.query(""> td"", node).forEach(function(i){
				d._setOpacity(i, opacity);
			});
		}
		return opacity;
	} : function(node, opacity){
		return node.style.opacity = opacity;
	};

	var _pixelNamesCache = {
		left: true, top: true
	};
	var _pixelRegExp = /margin|padding|width|height|max|min|offset/;  // |border
	var _toStyleValue = function(node, type, value){
		type = type.toLowerCase(); // FIXME: should we really be doing string case conversion here? Should we cache it? Need to profile!
		if(d.isIE){
			if(value == ""auto""){
				if(type == ""height""){ return node.offsetHeight; }
				if(type == ""width""){ return node.offsetWidth; }
			}
			if(type == ""fontweight""){
				switch(value){
					case 700: return ""bold"";
					case 400:
					default: return ""normal"";
				}
			}
		}
		if(!(type in _pixelNamesCache)){
			_pixelNamesCache[type] = _pixelRegExp.test(type);
		}
		return _pixelNamesCache[type] ? px(node, value) : value;
	}

	var _floatStyle = d.isIE ? ""styleFloat"" : ""cssFloat"";
	var _floatAliases = { ""cssFloat"": _floatStyle, ""styleFloat"": _floatStyle, ""float"": _floatStyle };
	
	// public API
	
	dojo.style = function(	/*DomNode|String*/ node, 
							/*String?|Object?*/ style, 
							/*String?*/ value){
		//	summary:
		//		Accesses styles on a node. If 2 arguments are
		//		passed, acts as a getter. If 3 arguments are passed, acts
		//		as a setter.
		//	node:
		//		id or reference to node to get/set style for
		//	style:
		//		the style property to set in DOM-accessor format
		//		(""borderWidth"", not ""border-width"") or an object with key/value
		//		pairs suitable for setting each property.
		//	value:
		//		If passed, sets value on the node for style, handling
		//		cross-browser concerns.
		//	example:
		//		Passing only an ID or node returns the computed style object of
		//		the node:
		//	|	dojo.style(""thinger"");
		//	example:
		//		Passing a node and a style property returns the current
		//		normalized, computed value for that property:
		//	|	dojo.style(""thinger"", ""opacity""); // 1 by default
		//
		//	example:
		//		Passing a node, a style property, and a value changes the
		//		current display of the node and returns the new computed value
		//	|	dojo.style(""thinger"", ""opacity"", 0.5); // == 0.5
		//
		//	example:
		//		Passing a node, an object-style style property sets each of the values in turn and returns the computed style object of the node:
		//	|	dojo.style(""thinger"", {
		//	|		""opacity"": 0.5,
		//	|		""border"": ""3px solid black"",
		//	|		""height"": 300
		//	|	});
		//
		// 	example:
		//		When the CSS style property is hyphenated, the JavaScript property is camelCased.
		//		font-size becomes fontSize, and so on.
		//	|	dojo.style(""thinger"",{
		//	|		fontSize:""14pt"",
		//	|		letterSpacing:""1.2em""
		//	|	});
		//
		//	example:
		//		dojo.NodeList implements .style() using the same syntax, omitting the ""node"" parameter, calling
		//		dojo.style() on every element of the list. See: dojo.query and dojo.NodeList
		//	|	dojo.query("".someClassName"").style(""visibility"",""hidden"");
		//	|	// or
		//	|	dojo.query(""#baz > div"").style({
		//	|		opacity:0.75,
		//	|		fontSize:""13pt""
		//	|	});

		var n = d.byId(node), args = arguments.length, op = (style==""opacity"");
		style = _floatAliases[style] || style;
		if(args == 3){
			return op ? d._setOpacity(n, value) : n.style[style] = value; /*Number*/
		}
		if(args == 2 && op){
			return d._getOpacity(n);
		}
		var s = gcs(n);
		if(args == 2 && !d.isString(style)){
			for(var x in style){
				d.style(node, x, style[x]);
			}
			return s;
		}
		return (args == 1) ? s : _toStyleValue(n, style, s[style]||n.style[style]); /* CSS2Properties||String||Number */
	}

	// =============================
	// Box Functions
	// =============================

	dojo._getPadExtents = function(/*DomNode*/n, /*Object*/computedStyle){
		//	summary:
		// 		Returns object with special values specifically useful for node
		// 		fitting.
		//
		// 		* l/t = left/top padding (respectively)
		// 		* w = the total of the left and right padding 
		// 		* h = the total of the top and bottom padding
		//
		//		If 'node' has position, l/t forms the origin for child nodes. 
		//		The w/h are used for calculating boxes.
		//		Normally application code will not need to invoke this
		//		directly, and will use the ...box... functions instead.
		var 
			s = computedStyle||gcs(n), 
			l = px(n, s.paddingLeft), 
			t = px(n, s.paddingTop);
		return { 
			l: l,
			t: t,
			w: l+px(n, s.paddingRight),
			h: t+px(n, s.paddingBottom)
		};
	}

	dojo._getBorderExtents = function(/*DomNode*/n, /*Object*/computedStyle){
		//	summary:
		//		returns an object with properties useful for noting the border
		//		dimensions.
		//
		// 		* l/t = the sum of left/top border (respectively)
		//		* w = the sum of the left and right border
		//		* h = the sum of the top and bottom border
		//
		//		The w/h are used for calculating boxes.
		//		Normally application code will not need to invoke this
		//		directly, and will use the ...box... functions instead.
		var 
			ne = ""none"",
			s = computedStyle||gcs(n), 
			bl = (s.borderLeftStyle != ne ? px(n, s.borderLeftWidth) : 0),
			bt = (s.borderTopStyle != ne ? px(n, s.borderTopWidth) : 0);
		return { 
			l: bl,
			t: bt,
			w: bl + (s.borderRightStyle!=ne ? px(n, s.borderRightWidth) : 0),
			h: bt + (s.borderBottomStyle!=ne ? px(n, s.borderBottomWidth) : 0)
		};
	}

	dojo._getPadBorderExtents = function(/*DomNode*/n, /*Object*/computedStyle){
		//	summary:
		//		returns object with properties useful for box fitting with
		//		regards to padding.
		//
		//		* l/t = the sum of left/top padding and left/top border (respectively)
		//		* w = the sum of the left and right padding and border
		//		* h = the sum of the top and bottom padding and border
		//
		//		The w/h are used for calculating boxes.
		//		Normally application code will not need to invoke this
		//		directly, and will use the ...box... functions instead.
		var 
			s = computedStyle||gcs(n), 
			p = d._getPadExtents(n, s),
			b = d._getBorderExtents(n, s);
		return { 
			l: p.l + b.l,
			t: p.t + b.t,
			w: p.w + b.w,
			h: p.h + b.h
		};
	}

	dojo._getMarginExtents = function(n, computedStyle){
		//	summary:
		//		returns object with properties useful for box fitting with
		//		regards to box margins (i.e., the outer-box).
		//
		//		* l/t = marginLeft, marginTop, respectively
		//		* w = total width, margin inclusive
		//		* h = total height, margin inclusive
		//
		//		The w/h are used for calculating boxes.
		//		Normally application code will not need to invoke this
		//		directly, and will use the ...box... functions instead.
		var 
			s = computedStyle||gcs(n), 
			l = px(n, s.marginLeft),
			t = px(n, s.marginTop),
			r = px(n, s.marginRight),
			b = px(n, s.marginBottom);
		if(d.isSafari && (s.position != ""absolute"")){
			// FIXME: Safari's version of the computed right margin
			// is the space between our right edge and the right edge 
			// of our offsetParent. 
			// What we are looking for is the actual margin value as 
			// determined by CSS.
			// Hack solution is to assume left/right margins are the same.
			r = l;
		}
		return { 
			l: l,
			t: t,
			w: l+r,
			h: t+b
		};
	}

	// Box getters work in any box context because offsetWidth/clientWidth
	// are invariant wrt box context
	//
	// They do *not* work for display: inline objects that have padding styles
	// because the user agent ignores padding (it's bogus styling in any case)
	//
	// Be careful with IMGs because they are inline or block depending on 
	// browser and browser mode.

	// Although it would be easier to read, there are not separate versions of 
	// _getMarginBox for each browser because:
	// 1. the branching is not expensive
	// 2. factoring the shared code wastes cycles (function call overhead)
	// 3. duplicating the shared code wastes bytes
	
	dojo._getMarginBox = function(/*DomNode*/node, /*Object*/computedStyle){
		// summary:
		//		returns an object that encodes the width, height, left and top
		//		positions of the node's margin box.
		var s = computedStyle||gcs(node), me = d._getMarginExtents(node, s);
		var l = node.offsetLeft - me.l, t = node.offsetTop - me.t, p = node.parentNode;
		if(d.isMoz){
			// Mozilla:
			// If offsetParent has a computed overflow != visible, the offsetLeft is decreased
			// by the parent's border.
			// We don't want to compute the parent's style, so instead we examine node's
			// computed left/top which is more stable.
			var sl = parseFloat(s.left), st = parseFloat(s.top);
			if(!isNaN(sl) && !isNaN(st)){
				l = sl, t = st;
			}else{
				// If child's computed left/top are not parseable as a number (e.g. ""auto""), we
				// have no choice but to examine the parent's computed style.
				if(p && p.style){
					var pcs = gcs(p);
					if(pcs.overflow != ""visible""){
						var be = d._getBorderExtents(p, pcs);
						l += be.l, t += be.t;
					}
				}
			}
		}else if(d.isOpera){
			// On Opera, offsetLeft includes the parent's border
			if(p){
				var be = d._getBorderExtents(p);
				l -= be.l;
				t -= be.t;
			}
		}
		return { 
			l: l, 
			t: t, 
			w: node.offsetWidth + me.w, 
			h: node.offsetHeight + me.h 
		};
	}
	
	dojo._getContentBox = function(node, computedStyle){
		// summary:
		//		Returns an object that encodes the width, height, left and top
		//		positions of the node's content box, irrespective of the
		//		current box model.

		// clientWidth/Height are important since the automatically account for scrollbars
		// fallback to offsetWidth/Height for special cases (see #3378)
		var s=computedStyle||gcs(node), pe=d._getPadExtents(node, s), be=d._getBorderExtents(node, s), w=node.clientWidth, h;
		if(!w){
			w=node.offsetWidth, h=node.offsetHeight;
		}else{
			h=node.clientHeight, be.w = be.h = 0; 
		}
		// On Opera, offsetLeft includes the parent's border
		if(d.isOpera){ pe.l += be.l; pe.t += be.t; };
		return { 
			l: pe.l, 
			t: pe.t, 
			w: w - pe.w - be.w, 
			h: h - pe.h - be.h
		};
	}

	dojo._getBorderBox = function(node, computedStyle){
		var s=computedStyle||gcs(node), pe=d._getPadExtents(node, s), cb=d._getContentBox(node, s);
		return { 
			l: cb.l - pe.l, 
			t: cb.t - pe.t, 
			w: cb.w + pe.w, 
			h: cb.h + pe.h
		};
	}

	// Box setters depend on box context because interpretation of width/height styles
	// vary wrt box context.
	//
	// The value of dojo.boxModel is used to determine box context.
	// dojo.boxModel can be set directly to change behavior.
	//
	// Beware of display: inline objects that have padding styles
	// because the user agent ignores padding (it's a bogus setup anyway)
	//
	// Be careful with IMGs because they are inline or block depending on 
	// browser and browser mode.
	// 
	// Elements other than DIV may have special quirks, like built-in
	// margins or padding, or values not detectable via computedStyle.
	// In particular, margins on TABLE do not seems to appear 
	// at all in computedStyle on Mozilla.
	
	dojo._setBox = function(/*DomNode*/node, /*Number?*/l, /*Number?*/t, /*Number?*/w, /*Number?*/h, /*String?*/u){
		//	summary:
		//		sets width/height/left/top in the current (native) box-model
		//		dimentions. Uses the unit passed in u.
		//	node: DOM Node reference. Id string not supported for performance reasons.
		//	l: optional. left offset from parent.
		//	t: optional. top offset from parent.
		//	w: optional. width in current box model.
		//	h: optional. width in current box model.
		//	u: optional. unit measure to use for other measures. Defaults to ""px"".
		u = u || ""px"";
		var s = node.style;
		if(!isNaN(l)){ s.left = l+u; }
		if(!isNaN(t)){ s.top = t+u; }
		if(w>=0){ s.width = w+u; }
		if(h>=0){ s.height = h+u; }
	}

	dojo._isButtonTag = function(/*DomNode*/node) {
		// summary:
		//		True if the node is BUTTON or INPUT.type=""button"".
		return node.tagName == ""BUTTON"" 
			|| node.tagName==""INPUT"" && node.getAttribute(""type"").toUpperCase() == ""BUTTON""; // boolean
	}
	
	dojo._usesBorderBox = function(/*DomNode*/node){
		//	summary: 
		//		True if the node uses border-box layout.

		// We could test the computed style of node to see if a particular box
		// has been specified, but there are details and we choose not to bother.
		
		// TABLE and BUTTON (and INPUT type=button) are always border-box by default.
		// If you have assigned a different box to either one via CSS then
		// box functions will break.
		
		var n = node.tagName;
		return d.boxModel==""border-box"" || n==""TABLE"" || dojo._isButtonTag(node); // boolean
	}

	dojo._setContentSize = function(/*DomNode*/node, /*Number*/widthPx, /*Number*/heightPx, /*Object*/computedStyle){
		//	summary:
		//		Sets the size of the node's contents, irrespective of margins,
		//		padding, or borders.
		if(d._usesBorderBox(node)){
			var pb = d._getPadBorderExtents(node, computedStyle);
			if(widthPx >= 0){ widthPx += pb.w; }
			if(heightPx >= 0){ heightPx += pb.h; }
		}
		d._setBox(node, NaN, NaN, widthPx, heightPx);
	}

	dojo._setMarginBox = function(/*DomNode*/node, 	/*Number?*/leftPx, /*Number?*/topPx, 
													/*Number?*/widthPx, /*Number?*/heightPx, 
													/*Object*/computedStyle){
		//	summary:
		//		sets the size of the node's margin box and placement
		//		(left/top), irrespective of box model. Think of it as a
		//		passthrough to dojo._setBox that handles box-model vagaries for
		//		you.

		var s = computedStyle||gcs(node);
		// Some elements have special padding, margin, and box-model settings. 
		// To use box functions you may need to set padding, margin explicitly.
		// Controlling box-model is harder, in a pinch you might set dojo.boxModel.
		var bb=d._usesBorderBox(node),
				pb=bb ? _nilExtents : d._getPadBorderExtents(node, s);
		if (dojo.isSafari) {
			// on Safari (3.1.2), button nodes with no explicit size have a default margin
			// setting an explicit size eliminates the margin.
			// We have to swizzle the width to get correct margin reading.
			if (dojo._isButtonTag(node)){
				var ns = node.style;
				if (widthPx>=0 && !ns.width) { ns.width = ""4px""; }
				if (heightPx>=0 && !ns.height) { ns.height = ""4px""; }
			}
		}
		var mb=d._getMarginExtents(node, s);
		if(widthPx>=0){ widthPx = Math.max(widthPx - pb.w - mb.w, 0); }
		if(heightPx>=0){ heightPx = Math.max(heightPx - pb.h - mb.h, 0); }
		d._setBox(node, leftPx, topPx, widthPx, heightPx);
	}
	
	var _nilExtents = { l:0, t:0, w:0, h:0 };

	// public API
	
	dojo.marginBox = function(/*DomNode|String*/node, /*Object?*/box){
		//	summary:
		//		Getter/setter for the margin-box of node.
		//	description: 
		//		Returns an object in the expected format of box (regardless
		//		if box is passed). The object might look like:
		//			`{ l: 50, t: 200, w: 300: h: 150 }`
		//		for a node offset from its parent 50px to the left, 200px from
		//		the top with a margin width of 300px and a margin-height of
		//		150px.
		//	node:
		//		id or reference to DOM Node to get/set box for
		//	box:
		//		If passed, denotes that dojo.marginBox() should
		//		update/set the margin box for node. Box is an object in the
		//		above format. All properties are optional if passed.
		var n=d.byId(node), s=gcs(n), b=box;
		return !b ? d._getMarginBox(n, s) : d._setMarginBox(n, b.l, b.t, b.w, b.h, s); // Object
	}

	dojo.contentBox = function(/*DomNode|String*/node, /*Object?*/box){
		//	summary:
		//		Getter/setter for the content-box of node.
		//	description:
		//		Returns an object in the expected format of box (regardless if box is passed).
		//		The object might look like:
		//			`{ l: 50, t: 200, w: 300: h: 150 }`
		//		for a node offset from its parent 50px to the left, 200px from
		//		the top with a content width of 300px and a content-height of
		//		150px. Note that the content box may have a much larger border
		//		or margin box, depending on the box model currently in use and
		//		CSS values set/inherited for node.
		//	node:
		//		id or reference to DOM Node to get/set box for
		//	box:
		//		If passed, denotes that dojo.contentBox() should
		//		update/set the content box for node. Box is an object in the
		//		above format. All properties are optional if passed.
		var n=d.byId(node), s=gcs(n), b=box;
		return !b ? d._getContentBox(n, s) : d._setContentSize(n, b.w, b.h, s); // Object
	}
	
	// =============================
	// Positioning 
	// =============================
	
	var _sumAncestorProperties = function(node, prop){
		if(!(node = (node||0).parentNode)){return 0};
		var val, retVal = 0, _b = d.body();
		while(node && node.style){
			if(gcs(node).position == ""fixed""){
				return 0;
			}
			val = node[prop];
			if(val){
				retVal += val - 0;
				// opera and khtml #body & #html has the same values, we only
				// need one value
				if(node == _b){ break; }
			}
			node = node.parentNode;
		}
		return retVal;	//	integer
	}

	dojo._docScroll = function(){
		var 
			_b = d.body(),
			_w = d.global,
			de = d.doc.documentElement;
		return {
			y: (_w.pageYOffset || de.scrollTop || _b.scrollTop || 0),
			x: (_w.pageXOffset || d._fixIeBiDiScrollLeft(de.scrollLeft) || _b.scrollLeft || 0)
		};
	};
	
	dojo._isBodyLtr = function(){
		//FIXME: could check html and body tags directly instead of computed style?  need to ignore case, accept empty values
		return !(""_bodyLtr"" in d) ? 
			d._bodyLtr = gcs(d.body()).direction == ""ltr"" :
			d._bodyLtr; // Boolean 
	}
	
	dojo._getIeDocumentElementOffset = function(){
		// summary
		// The following values in IE contain an offset:
		//     event.clientX 
		//     event.clientY 
		//     node.getBoundingClientRect().left
		//     node.getBoundingClientRect().top
		// But other position related values do not contain this offset, such as
		// node.offsetLeft, node.offsetTop, node.style.left and node.style.top.
		// The offset is always (2, 2) in LTR direction. When the body is in RTL
		// direction, the offset counts the width of left scroll bar's width.
		// This function computes the actual offset.

		//NOTE: assumes we're being called in an IE browser

		var de = d.doc.documentElement;
		//FIXME: use this instead?			var de = d.compatMode == ""BackCompat"" ? d.body : d.documentElement;

		return (d.isIE >= 7) ?
			{x: de.getBoundingClientRect().left, y: de.getBoundingClientRect().top}
		:
			// IE 6.0
			{x: d._isBodyLtr() || window.parent == window ?
				de.clientLeft : de.offsetWidth - de.clientWidth - de.clientLeft, 
				y: de.clientTop}; // Object
	};
	
	dojo._fixIeBiDiScrollLeft = function(/*Integer*/ scrollLeft){
		// In RTL direction, scrollLeft should be a negative value, but IE 
		// returns a positive one. All codes using documentElement.scrollLeft
		// must call this function to fix this error, otherwise the position
		// will offset to right when there is a horizontal scrollbar.
		var dd = d.doc;
		if(d.isIE && !dojo._isBodyLtr()){
			var de = dd.compatMode == ""BackCompat"" ? dd.body : dd.documentElement;
			return scrollLeft + de.clientWidth - de.scrollWidth; // Integer
		}
		return scrollLeft; // Integer
	}

	dojo._abs = function(/*DomNode*/node, /*Boolean?*/includeScroll){
		//	summary:
		//		Gets the position of the passed element relative to
		//		the viewport (if includeScroll==false), or relative to the
		//		document root (if includeScroll==true).
		//
		//		Returns an object of the form:
		//			{ x: 100, y: 300 }
		//		if includeScroll is passed, the x and y values will include any
		//		document offsets that may affect the position relative to the
		//		viewport.

		// FIXME: need to decide in the brave-new-world if we're going to be
		// margin-box or border-box.
		var ownerDocument = node.ownerDocument;
		var ret = {
			x: 0,
			y: 0
		};

		// targetBoxType == ""border-box""
		var db = d.body();
		if(d.isIE || (d.isFF >= 3)){
			var client = node.getBoundingClientRect();
			var cs;
			if(d.isFF){
				// in FF3 you have to subract the document element margins
				var dv = node.ownerDocument.defaultView;
				cs=dv.getComputedStyle(db.parentNode, null);
			}
			var offset = (d.isIE) ? d._getIeDocumentElementOffset() : { x: px(db.parentNode,cs.marginLeft), y: px(db.parentNode,cs.marginTop)};
			ret.x = client.left - offset.x;
			ret.y = client.top - offset.y;
		}else{
			if(node[""offsetParent""]){
				var endNode;
				// in Safari, if the node is an absolutely positioned child of
				// the body and the body has a margin the offset of the child
				// and the body contain the body's margins, so we need to end
				// at the body
				// FIXME: getting contrary results to the above in latest WebKit.
				if(d.isSafari &&
					//(node.style.getPropertyValue(""position"") == ""absolute"") &&
					(gcs(node).position == ""absolute"") &&
					(node.parentNode == db)){
					endNode = db;
				}else{
					endNode = db.parentNode;
				}
				// Opera seems to be double counting for some elements
				var cs=gcs(node);
				var n=node;
				if(d.isOpera&&cs.position!=""absolute""){
					n=n.offsetParent;
				}
				ret.x -= _sumAncestorProperties(n, ""scrollLeft"");
				ret.y -= _sumAncestorProperties(n, ""scrollTop"");

				var curnode = node;
				do{
					var n = curnode.offsetLeft;
					//FIXME: ugly hack to workaround the submenu in 
					//popupmenu2 does not shown up correctly in opera. 
					//Someone have a better workaround?
					if(!d.isOpera || n > 0){
						ret.x += isNaN(n) ? 0 : n;
					}
					var t = curnode.offsetTop;
					ret.y += isNaN(t) ? 0 : t;
					var cs = gcs(curnode);
					if(curnode != node){
						if(d.isSafari){
							ret.x += px(curnode, cs.borderLeftWidth);
							ret.y += px(curnode, cs.borderTopWidth);
						}else if(d.isFF){
							// tried left+right with differently sized left/right borders
							// it really is 2xleft border in FF, not left+right, even in RTL!
							ret.x += 2*px(curnode,cs.borderLeftWidth);
							ret.y += 2*px(curnode,cs.borderTopWidth);
						}
					}
					// static children in a static div in FF2 are affected by the div's border as well
					// but offsetParent will skip this div!
					if(d.isFF&&cs.position==""static""){
						var parent=curnode.parentNode;
						while(parent!=curnode.offsetParent){
							var pcs=gcs(parent);
							if(pcs.position==""static""){
								ret.x += px(curnode,pcs.borderLeftWidth);
								ret.y += px(curnode,pcs.borderTopWidth);
							}
							parent=parent.parentNode;
						}
					}
					curnode = curnode.offsetParent;
				}while((curnode != endNode) && curnode);
			}else if(node.x && node.y){
				ret.x += isNaN(node.x) ? 0 : node.x;
				ret.y += isNaN(node.y) ? 0 : node.y;
			}
		}
		// account for document scrolling
		// if offsetParent is used, ret value already includes scroll position
		// so we may have to actually remove that value if !includeScroll
		if(includeScroll){
			var scroll = d._docScroll();
			ret.y += scroll.y;
			ret.x += scroll.x;
		}

		return ret; // object
	}

	// FIXME: need a setter for coords or a moveTo!!
	dojo.coords = function(/*DomNode|String*/node, /*Boolean?*/includeScroll){
		//	summary:
		//		Returns an object that measures margin box width/height and
		//		absolute positioning data from dojo._abs().
		//
		//	description:
		//		Returns an object that measures margin box width/height and
		//		absolute positioning data from dojo._abs().
		//		Return value will be in the form:
		//			`{ l: 50, t: 200, w: 300: h: 150, x: 100, y: 300 }`
		//		Does not act as a setter. If includeScroll is passed, the x and
		//		y params are affected as one would expect in dojo._abs().
		var n=d.byId(node), s=gcs(n), mb=d._getMarginBox(n, s);
		var abs = d._abs(n, includeScroll);
		mb.x = abs.x;
		mb.y = abs.y;
		return mb;
	}

	// =============================
	// Element attribute Functions
	// =============================

	var ieLT8 = d.isIE < 8;

	var _fixAttrName = function(/*String*/name){
		switch(name.toLowerCase()){
			case ""tabindex"":
				// Internet Explorer will only set or remove tabindex
				// if it is spelled ""tabIndex""
				// 
				return ieLT8 ? ""tabIndex"" : ""tabindex"";
			case ""for"": case ""htmlfor"":
				// to pick up for attrib set in markup via getAttribute() IE<8 uses ""htmlFor"" and others use ""for""
				// get/setAttribute works in all as long use same value for both get/set
				return ieLT8 ? ""htmlFor"" : ""for"";
			case ""class"" :
				return d.isIE ? ""className"" : ""class"";
			default:
				return name;
		}
	}

	// non-deprecated HTML4 attributes with default values
	// http://www.w3.org/TR/html401/index/attributes.html
	// FF and Safari will return the default values if you
	// access the attributes via a property but not
	// via getAttribute()
	var _attrProps = {
		colspan: ""colSpan"",
		enctype: ""enctype"",
		frameborder: ""frameborder"",
		method: ""method"",
		rowspan: ""rowSpan"",
		scrolling: ""scrolling"",
		shape: ""shape"",
		span: ""span"",
		type: ""type"",
		valuetype: ""valueType""
	}

	dojo.hasAttr = function(/*DomNode|String*/node, /*String*/name){
		//	summary:
		//		Returns true if the requested attribute is specified on the
		//		given element, and false otherwise.
		//	node:
		//		id or reference to the element to check
		//	name:
		//		the name of the attribute
		//	returns:
		//		true if the requested attribute is specified on the
		//		given element, and false otherwise
		node = d.byId(node);
		var fixName = _fixAttrName(name);
		fixName = fixName == ""htmlFor"" ? ""for"" : fixName; //IE<8 uses htmlFor except in this case
		var attr = node.getAttributeNode && node.getAttributeNode(fixName);
		return attr ? attr.specified : false; // Boolean
	}

	var _evtHdlrMap = {
		
	}

	var _ctr = 0;
	var _attrId = dojo._scopeName + ""attrid"";

	dojo.attr = function(/*DomNode|String*/node, /*String|Object*/name, /*String?*/value){
		//	summary:
		//		Gets or sets an attribute on an HTML element.
		//	description:
		//		Handles normalized getting and setting of attributes on DOM
		//		Nodes. If 2 arguments are passed, and a the second argumnt is a
		//		string, acts as a getter.
		//	
		//		If a third argument is passed, or if the second argumnt is a
		//		map of attributes, acts as a setter.
		//
		//		When passing functions as values, note that they will not be
		//		directly assigned to slots on the node, but rather the default
		//		behavior will be removed and the new behavior will be added
		//		using `dojo.connect()`, meaning that event handler properties
		//		will be normalized and that some caveats with regards to
		//		non-standard behaviors for onsubmit apply. Namely that you
		//		should cancel form submission using `dojo.stopEvent()` on the
		//		passed event object instead of returning a boolean value from
		//		the handler itself.
		//	node:
		//		id or reference to the element to get or set the attribute on
		//	name:
		//		the name of the attribute to get or set.
		//	value:
		//		The value to set for the attribute
		//	returns:
		//		when used as a getter, the value of the requested attribute
		//		or null if that attribute does not have a specified or
		//		default value;
		//
		//		when user as a setter, undefined
		//
		//	example:
		//	|	// get the current value of the ""foo"" attribute on a node
		//	|	dojo.attr(dojo.byId(""nodeId""), ""foo"");
		//	|	// or we can just pass the id:
		//	|	dojo.attr(""nodeId"", ""foo"");
		//
		//	example:
		//	|	// use attr() to set the tab index
		//	|	dojo.attr(""nodeId"", ""tabindex"", 3);
		//	|
		//
		//	example:
		//	|	// set multiple values at once, including event handlers:
		//	|	dojo.attr(""formId"", {
		//	|		""foo"": ""bar"",
		//	|		""tabindex"": -1,
		//	|		""method"": ""POST"",
		//	|		""onsubmit"": function(e){
		//	|			// stop submitting the form. Note that the IE behavior
		//	|			// of returning true or false will have no effect here
		//	|			// since our handler is connect()ed to the built-in
		//	|			// onsubmit behavior and so we need to use
		//	|			// dojo.stopEvent() to ensure that the submission
		//	|			// doesn't proceed.
		//	|			dojo.stopEvent(e);
		//	|
		//	|			// submit the form with Ajax
		//	|			dojo.xhrPost({ form: ""formId"" });
		//	|		}
		//	|	});

		var args = arguments.length;
		if(args == 2 && !d.isString(name)){
			for(var x in name){ d.attr(node, x, name[x]); }
			return;
		}
		node = d.byId(node);
		name = _fixAttrName(name);
		if(args == 3){
			// FIXME:
			//		what about when the name is ""style"" and value is an object?
			//		It seems natural to pass it in to dojo.style(node,
			//		value)...should we support this?
			if(d.isFunction(value)){
				// clobber if we can
				var attrId = d.attr(node, _attrId);
				if(!attrId){
					attrId = _ctr++;
					d.attr(node, _attrId, attrId);
				}
				if(!_evtHdlrMap[attrId]){
					_evtHdlrMap[attrId] = {};
				}
				var h = _evtHdlrMap[attrId][name];
				if(h){
					d.disconnect(h);
				}else{
					try{
						delete node[name];
					}catch(e){}
				}

				// ensure that event objects are normalized, etc.
				_evtHdlrMap[attrId][name] = d.connect(node, name, value);

			}else if(
				(typeof value == ""boolean"")|| // e.g. onsubmit, disabled
				(name == ""innerHTML"")
			){
				node[name] = value;
			}else if((name == ""style"")&&(!d.isString(value))){
				d.style(node, value);
			}else{
				node.setAttribute(name, value);
			}
			return;
		}else{
			// should we access this attribute via a property or
			// via getAttribute()?
			var prop = _attrProps[name.toLowerCase()];
			if(prop){
				return node[prop];
			}else{
				var attrValue = node[name];
				return (typeof attrValue == 'boolean' || typeof attrValue == 'function') ? attrValue
					: (d.hasAttr(node, name) ? node.getAttribute(name) : null);
			}
		}
	}

	dojo.removeAttr = function(/*DomNode|String*/node, /*String*/name){
		//	summary:
		//		Removes an attribute from an HTML element.
		//	node:
		//		id or reference to the element to remove the attribute from
		//	name:
		//		the name of the attribute to remove
		d.byId(node).removeAttribute(_fixAttrName(name));
	}

	/*
	dojo.createElement = function(type, attrs, parent, position){
		// TODO: need to finish this!
	}
	*/

	// =============================
	// (CSS) Class Functions
	// =============================
	var _className = ""className"";

	dojo.hasClass = function(/*DomNode|String*/node, /*String*/classStr){
		//	summary:
		//		Returns whether or not the specified classes are a portion of the
		//		class list currently applied to the node. 
		return (("" ""+ d.byId(node)[_className] +"" "").indexOf("" ""+ classStr +"" "") >= 0);  // Boolean
	};

	dojo.addClass = function(/*DomNode|String*/node, /*String*/classStr){
		//	summary:
		//		Adds the specified classes to the end of the class list on the
		//		passed node.
		node = d.byId(node);
		var cls = node[_className];
		if(("" ""+ cls +"" "").indexOf("" "" + classStr + "" "") < 0){
			node[_className] = cls + (cls ? ' ' : '') + classStr;
		}
	};

	dojo.removeClass = function(/*DomNode|String*/node, /*String*/classStr){
		// summary: Removes the specified classes from node.
		node = d.byId(node);
		var t = d.trim(("" "" + node[_className] + "" "").replace("" "" + classStr + "" "", "" ""));
		if(node[_className] != t){ node[_className] = t; }
	};

	dojo.toggleClass = function(/*DomNode|String*/node, /*String*/classStr, /*Boolean?*/condition){
		//	summary: 	
		//		Adds a class to node if not present, or removes if present.
		//		Pass a boolean condition if you want to explicitly add or remove.
		//	condition:
		//		If passed, true means to add the class, false means to remove.
		if(condition === undefined){
			condition = !d.hasClass(node, classStr);
		}
		d[condition ? ""addClass"" : ""removeClass""](node, classStr);
	};

})();

}

if(!dojo._hasResource[""dojo._base.NodeList""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.NodeList""] = true;
dojo.provide(""dojo._base.NodeList"");



(function(){

	var d = dojo;

	var tnl = function(arr){
		// decorate an array to make it look like a NodeList
		arr.constructor = dojo.NodeList;
		dojo._mixin(arr, dojo.NodeList.prototype);
		return arr;
	}

	var _mapIntoDojo = function(func, alwaysThis){
		// returns a function which, when executed in the scope of its caller,
		// applies the passed arguments to a particular dojo.* function (named
		// in func) and aggregates the returns. if alwaysThis is true, it
		// always returns the scope object and not the collected returns from
		// the Dojo method
		return function(){
			var _a = arguments;
			var aa = d._toArray(_a, 0, [null]);
			var s = this.map(function(i){
				aa[0] = i;
				return d[func].apply(d, aa);
			});
			return (alwaysThis || ( (_a.length > 1) || !d.isString(_a[0]) )) ? this : s; // String||dojo.NodeList
		}
	};

	dojo.NodeList = function(){
		//	summary:
		//		dojo.NodeList is as subclass of Array which adds syntactic 
		//		sugar for chaining, common iteration operations, animation, 
		//		and node manipulation. NodeLists are most often returned as
		//		the result of dojo.query() calls.
		//	example:
		//		create a node list from a node
		//		|	new dojo.NodeList(dojo.byId(""foo""));

		return tnl(Array.apply(null, arguments));
	}

	dojo.NodeList._wrap = tnl;

	dojo.extend(dojo.NodeList, {
		// http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array#Methods

		// FIXME: handle return values for #3244
		//		http://trac.dojotoolkit.org/ticket/3244
		
		// FIXME:
		//		need to wrap or implement:
		//			join (perhaps w/ innerHTML/outerHTML overload for toString() of items?)
		//			reduce
		//			reduceRight

		slice: function(/*===== begin, end =====*/){
			// summary:
			//		Returns a new NodeList, maintaining this one in place
			// description:
			//		This method behaves exactly like the Array.slice method
			//		with the caveat that it returns a dojo.NodeList and not a
			//		raw Array. For more details, see:
			//			http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:slice
			// begin: Integer
			//		Can be a positive or negative integer, with positive
			//		integers noting the offset to begin at, and negative
			//		integers denoting an offset from the end (i.e., to the left
			//		of the end)
			// end: Integer?
			//		Optional parameter to describe what position relative to
			//		the NodeList's zero index to end the slice at. Like begin,
			//		can be positive or negative.
			var a = d._toArray(arguments);
			return tnl(a.slice.apply(this, a));
		},

		splice: function(/*===== index, howmany, item =====*/){
			// summary:
			//		Returns a new NodeList, manipulating this NodeList based on
			//		the arguments passed, potentially splicing in new elements
			//		at an offset, optionally deleting elements
			// description:
			//		This method behaves exactly like the Array.splice method
			//		with the caveat that it returns a dojo.NodeList and not a
			//		raw Array. For more details, see:
			//			<http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:splice>
			// index: Integer
			//		begin can be a positive or negative integer, with positive
			//		integers noting the offset to begin at, and negative
			//		integers denoting an offset from the end (i.e., to the left
			//		of the end)
			// howmany: Integer?
			//		Optional parameter to describe what position relative to
			//		the NodeList's zero index to end the slice at. Like begin,
			//		can be positive or negative.
			// item: Object...?
			//		Any number of optional parameters may be passed in to be
			//		spliced into the NodeList
			// returns:
			//		dojo.NodeList
			var a = d._toArray(arguments);
			return tnl(a.splice.apply(this, a));
		},

		concat: function(/*===== item =====*/){
			// summary:
			//		Returns a new NodeList comprised of items in this NodeList
			//		as well as items passed in as parameters
			// description:
			//		This method behaves exactly like the Array.concat method
			//		with the caveat that it returns a dojo.NodeList and not a
			//		raw Array. For more details, see:
			//			<http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:concat>
			// item: Object...?
			//		Any number of optional parameters may be passed in to be
			//		spliced into the NodeList
			// returns:
			//		dojo.NodeList
			var a = d._toArray(arguments, 0, [this]);
			return tnl(a.concat.apply([], a));
		},
		
		indexOf: function(/*Object*/ value, /*Integer?*/ fromIndex){
			//	summary:
			//		see dojo.indexOf(). The primary difference is that the acted-on 
			//		array is implicitly this NodeList
			// value:
			//		The value to search for.
			// fromIndex:
			//		The loction to start searching from. Optional. Defaults to 0.
			//	description:
			//		For more details on the behavior of indexOf, see:
			//			<http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:indexOf>
			//	returns:
			//		Positive Integer or 0 for a match, -1 of not found.
			return d.indexOf(this, value, fromIndex); // Integer
		},

		lastIndexOf: function(/*===== value, fromIndex =====*/){
			// summary:
			//		see dojo.lastIndexOf(). The primary difference is that the
			//		acted-on array is implicitly this NodeList
			//	description:
			//		For more details on the behavior of lastIndexOf, see:
			//			<http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:lastIndexOf>
			// value: Object
			//		The value to search for.
			// fromIndex: Integer?
			//		The loction to start searching from. Optional. Defaults to 0.
			// returns:
			//		Positive Integer or 0 for a match, -1 of not found.
			return d.lastIndexOf.apply(d, d._toArray(arguments, 0, [this])); // Integer
		},

		every: function(/*Function*/callback, /*Object?*/thisObject){
			//	summary:
			//		see `dojo.every()` and:
			//			<http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:every>
			//		Takes the same structure of arguments and returns as
			//		dojo.every() with the caveat that the passed array is
			//		implicitly this NodeList
			return d.every(this, callback, thisObject); // Boolean
		},

		some: function(/*Function*/callback, /*Object?*/thisObject){
			//	summary:
			//		see dojo.some() and:
			//			http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:some
			//		Takes the same structure of arguments and returns as
			//		dojo.some() with the caveat that the passed array is
			//		implicitly this NodeList
			return d.some(this, callback, thisObject); // Boolean
		},

		map: function(/*Function*/ func, /*Function?*/ obj){
			//	summary:
			//		see dojo.map(). The primary difference is that the acted-on
			//		array is implicitly this NodeList and the return is a
			//		dojo.NodeList (a subclass of Array)

			return d.map(this, func, obj, d.NodeList); // dojo.NodeList
		},

		forEach: function(callback, thisObj){
			//	summary:
			//		see dojo.forEach(). The primary difference is that the acted-on 
			//		array is implicitly this NodeList

			d.forEach(this, callback, thisObj);
			// non-standard return to allow easier chaining
			return this; // dojo.NodeList 
		},

		// custom methods
		
		coords: function(){
			//	summary:
			// 		Returns the box objects all elements in a node list as
			// 		an Array (*not* a NodeList)
			
			return d.map(this, d.coords); // Array
		},

		/*=====
		attr: function(property, value){
			//	summary:
			//		gets or sets the DOM attribute for every element in the
			//		NodeList
			//	property: String
			//		the attribute to get/set
			//	value: String?
			//		optional. The value to set the property to
			//	returns:
			//		if no value is passed, the result is an array of attribute values
			//		If a value is passed, the return is this NodeList
			return; // dojo.NodeList
			return; // Array
		},

		style: function(property, value){
			//	summary:
			//		gets or sets the CSS property for every element in the NodeList
			//	property: String
			//		the CSS property to get/set, in JavaScript notation
			//		(""lineHieght"" instead of ""line-height"") 
			//	value: String?
			//		optional. The value to set the property to
			//	returns:
			//		if no value is passed, the result is an array of strings.
			//		If a value is passed, the return is this NodeList
			return; // dojo.NodeList
			return; // Array
		},

		addClass: function(className){
			//	summary:
			//		adds the specified class to every node in the list
			//	className: String
			//		the CSS class to add
			return; // dojo.NodeList
		},

		removeClass: function(className){
			//	summary:
			//		removes the specified class from every node in the list
			//	className: String
			//		the CSS class to add
			//	returns:
			//		dojo.NodeList, this list
			return; // dojo.NodeList
		},

		toggleClass: function(className, condition){
			//	summary:
			//		Adds a class to node if not present, or removes if present.
			//		Pass a boolean condition if you want to explicitly add or remove.
			//	condition: Boolean?
			//		If passed, true means to add the class, false means to remove.
			//	className: String
			//		the CSS class to add
			return; // dojo.NodeList
		},

		connect: function(methodName, objOrFunc, funcName){
			//	summary:
			//		attach event handlers to every item of the NodeList. Uses dojo.connect()
			//		so event properties are normalized
			//	methodName: String
			//		the name of the method to attach to. For DOM events, this should be
			//		the lower-case name of the event
			//	objOrFunc: Object|Function|String
			//		if 2 arguments are passed (methodName, objOrFunc), objOrFunc should
			//		reference a function or be the name of the function in the global
			//		namespace to attach. If 3 arguments are provided
			//		(methodName, objOrFunc, funcName), objOrFunc must be the scope to 
			//		locate the bound function in
			//	funcName: String?
			//		optional. A string naming the function in objOrFunc to bind to the
			//		event. May also be a function reference.
			//	example:
			//		add an onclick handler to every button on the page
			//		|	dojo.query(""div:nth-child(odd)"").connect(""onclick"", function(e){
			//		|		
			//		|	});
			// example:
			//		attach foo.bar() to every odd div's onmouseover
			//		|	dojo.query(""div:nth-child(odd)"").connect(""onmouseover"", foo, ""bar"");
		},
		=====*/
		attr: _mapIntoDojo(""attr""),
		style: _mapIntoDojo(""style""),
		addClass: _mapIntoDojo(""addClass"", true),
		removeClass: _mapIntoDojo(""removeClass"", true),
		toggleClass: _mapIntoDojo(""toggleClass"", true),
		connect: _mapIntoDojo(""connect"", true),

		// FIXME: connectPublisher()? connectRunOnce()?

		place: function(/*String||Node*/ queryOrNode, /*String*/ position){
			//	summary:
			//		places elements of this node list relative to the first element matched
			//		by queryOrNode. Returns the original NodeList.
			//	queryOrNode:
			//		may be a string representing any valid CSS3 selector or a DOM node.
			//		In the selector case, only the first matching element will be used 
			//		for relative positioning.
			//	position:
			//		can be one of:
			//			* ""last""||""end"" (default)
			//			* ""first||""start""
			//			* ""before""
			//			* ""after""
			// 		or an offset in the childNodes property
			var item = d.query(queryOrNode)[0];
			return this.forEach(function(i){ d.place(i, item, position); }); // dojo.NodeList
		},

		orphan: function(/*String?*/ simpleFilter){
			//	summary:
			//		removes elements in this list that match the simple
			//		filter from their parents and returns them as a new
			//		NodeList.
			//	simpleFilter:
			//		single-expression CSS filter
			//	returns:
			//		`dojo.NodeList` containing the orpahned elements 
			return (simpleFilter ? d._filterQueryResult(this, simpleFilter) : this). // dojo.NodeList
				forEach(""if(item.parentNode){ item.parentNode.removeChild(item); }""); 
		},

		adopt: function(/*String||Array||DomNode*/ queryOrListOrNode, /*String?*/ position){
			//	summary:
			//		places any/all elements in queryOrListOrNode at a
			//		position relative to the first element in this list.
			//		Returns a dojo.NodeList of the adopted elements.
			//	queryOrListOrNode:
			//		a DOM node or a query string or a query result.
			//		Represents the nodes to be adopted relative to the
			//		first element of this NodeList.
			//	position:
			//		can be one of:
			//			* ""last""||""end"" (default)
			//			* ""first||""start""
			//			* ""before""
			//			* ""after""
			// 		or an offset in the childNodes property
			var item = this[0];
			return d.query(queryOrListOrNode).forEach(function(ai){ // dojo.NodeList
				d.place(ai, item, position || ""last""); 
			});
		},

		// FIXME: do we need this?
		query: function(/*String*/ queryStr){
			//	summary:
			//		Returns a new, flattened NodeList. Elements of the new list
			//		satisfy the passed query but use elements of the
			//		current NodeList as query roots.

			if(!queryStr){ return this; }

			// FIXME: probably slow
			// FIXME: use map?
			var ret = d.NodeList();
			this.forEach(function(item){
				// FIXME: why would we ever get undefined here?
				ret = ret.concat(d.query(queryStr, item).filter(function(subItem){ return (subItem !== undefined); }));
			});
			return ret; // dojo.NodeList
		},

		filter: function(/*String*/ simpleQuery){
			//	summary:
			// 		""masks"" the built-in javascript filter() method to support
			//		passing a simple string filter in addition to supporting
			//		filtering function objects.
			//	example:
			//		""regular"" JS filter syntax as exposed in dojo.filter:
			//		|	dojo.query(""*"").filter(function(item){
			//		|		// highlight every paragraph
			//		|		return (item.nodeName == ""p"");
			//		|	}).styles(""backgroundColor"", ""yellow"");
			// example:
			//		the same filtering using a CSS selector
			//		|	dojo.query(""*"").filter(""p"").styles(""backgroundColor"", ""yellow"");

			var items = this;
			var _a = arguments;
			var r = d.NodeList();
			var rp = function(t){ 
				if(t !== undefined){
					r.push(t); 
				}
			}
			if(d.isString(simpleQuery)){
				items = d._filterQueryResult(this, _a[0]);
				if(_a.length == 1){
					// if we only got a string query, pass back the filtered results
					return items; // dojo.NodeList
				}
				// if we got a callback, run it over the filtered items
				_a.shift();
			}
			// handle the (callback, [thisObject]) case
			d.forEach(d.filter(items, _a[0], _a[1]), rp);
			return r; // dojo.NodeList
		},
		
		/*
		// FIXME: should this be ""copyTo"" and include parenting info?
		clone: function(){
			// summary:
			//		creates node clones of each element of this list
			//		and returns a new list containing the clones
		},
		*/

		addContent: function(/*String*/ content, /*String||Integer?*/ position){
			//	summary:
			//		add a node or some HTML as a string to every item in the list. 
			//		Returns the original list.
			//	description:
			//		a copy of the HTML content is added to each item in the
			//		list, with an optional position argument. If no position
			//		argument is provided, the content is appended to the end of
			//		each item.
			//	content:
			//		the HTML in string format to add at position to every item
			//	position:
			//		can be one of:
			//			* ""last""||""end"" (default)
			//			* ""first||""start""
			//			* ""before""
			//			* ""after""
			// 		or an offset in the childNodes property
			//	example:
			//		appends content to the end if the position is ommitted
			//	|	dojo.query(""h3 > p"").addContent(""hey there!"");
			//	example:
			//		add something to the front of each element that has a ""thinger"" property:
			//	|	dojo.query(""[thinger]"").addContent(""..."", ""first"");
			//	example:
			//		adds a header before each element of the list
			//	|	dojo.query("".note"").addContent(""<h4>NOTE:</h4>"", ""before"");
			var ta = d.doc.createElement(""span"");
			if(d.isString(content)){
				ta.innerHTML = content;
			}else{
				ta.appendChild(content);
			}
			if(position === undefined){
				position = ""last"";
			}
			var ct = (position == ""first"" || position == ""after"") ? ""lastChild"" : ""firstChild"";
			this.forEach(function(item){
				var tn = ta.cloneNode(true);
				while(tn[ct]){
					d.place(tn[ct], item, position);
				}
			});
			return this; // dojo.NodeList
		},

		empty: function(){
			//	summary:
			//		clears all content from each node in the list
			return this.forEach(""item.innerHTML='';""); // dojo.NodeList

			// FIXME: should we be checking for and/or disposing of widgets below these nodes?
		},
		
		instantiate: function(/*String|Object*/ declaredClass, /*Object?*/ properties){
			//	summary:
			//		Create a new instance of a specified class, using the
			//		specified properties and each node in the nodeList as a
			//		srcNodeRef
			//
			var c = d.isFunction(declaredClass) ? declaredClass : d.getObject(declaredClass);
			return this.forEach(function(i){
				new c(properties||{},i);
			}) // dojo.NodeList
		},

		at: function(/*===== index =====*/){
			//	summary:
			//		Returns a new NodeList comprised of items in this NodeList
			//		at the given index or indices.
			//	index: Integer...
			//		One or more 0-based indices of items in the current NodeList.
			//	returns:
			//		dojo.NodeList
			var nl = new dojo.NodeList();
			dojo.forEach(arguments, function(i) { if(this[i]) { nl.push(this[i]); } }, this);
			return nl; // dojo.NodeList
		}

	});

	// syntactic sugar for DOM events
	d.forEach([
		""blur"", ""focus"", ""click"", ""keydown"", ""keypress"", ""keyup"", ""mousedown"",
		""mouseenter"", ""mouseleave"", ""mousemove"", ""mouseout"", ""mouseover"",
		""mouseup"", ""submit"", ""load"", ""error""
		], function(evt){
			var _oe = ""on""+evt;
			d.NodeList.prototype[_oe] = function(a, b){
				return this.connect(_oe, a, b);
			}
				// FIXME: should these events trigger publishes?
				/*
				return (a ? this.connect(_oe, a, b) : 
							this.forEach(function(n){  
								// FIXME:
								//		listeners get buried by
								//		addEventListener and can't be dug back
								//		out to be triggered externally.
								// see:
								//		http://developer.mozilla.org/en/docs/DOM:element

								

								// FIXME: need synthetic event support!
								var _e = { target: n, faux: true, type: evt };
								// dojo._event_listener._synthesizeEvent({}, { target: n, faux: true, type: evt });
								try{ n[evt](_e); }catch(e){  }
								try{ n[_oe](_e); }catch(e){  }
							})
				);
			}
			*/
		}
	);

})();

}

if(!dojo._hasResource[""dojo._base.query""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.query""] = true;
dojo.provide(""dojo._base.query"");


/*
	dojo.query() architectural overview:

		dojo.query is a relatively full-featured CSS3 query library. It is
		designed to take any valid CSS3 selector and return the nodes matching
		the selector. To do this quickly, it processes queries in several
		steps, applying caching where profitable.
		
		The steps (roughly in reverse order of the way they appear in the code):
			1.) check to see if we already have a ""query dispatcher""
				- if so, use that with the given parameterization. Skip to step 4.
			2.) attempt to determine which branch to dispatch the query to:
				- JS (optimized DOM iteration)
				- xpath (for browsers that support it and where it's fast)
				- native (not available in any browser yet)
			3.) tokenize and convert to executable ""query dispatcher""
				- this is where the lion's share of the complexity in the
				  system lies. In the DOM version, the query dispatcher is
				  assembled as a chain of ""yes/no"" test functions pertaining to
				  a section of a simple query statement ("".blah:nth-child(odd)""
				  but not ""div div"", which is 2 simple statements). Individual
				  statement dispatchers are cached (to prevent re-definition)
				  as are entire dispatch chains (to make re-execution of the
				  same query fast)
				- in the xpath path, tokenization yields a concatenation of
				  parameterized xpath selectors. As with the DOM version, both
				  simple selector blocks and overall evaluators are cached to
				  prevent re-defintion
			4.) the resulting query dispatcher is called in the passed scope (by default the top-level document)
				- for DOM queries, this results in a recursive, top-down
				  evaluation of nodes based on each simple query section
				- xpath queries can, thankfully, be executed in one shot
			5.) matched nodes are pruned to ensure they are unique
*/

;(function(){
	// define everything in a closure for compressability reasons. ""d"" is an
	// alias to ""dojo"" since it's so frequently used. This seems a
	// transformation that the build system could perform on a per-file basis.

	////////////////////////////////////////////////////////////////////////
	// Utility code
	////////////////////////////////////////////////////////////////////////

	var d = dojo;
	var childNodesName = dojo.isIE ? ""children"" : ""childNodes"";
	var caseSensitive = false;

	var getQueryParts = function(query){
		// summary: state machine for query tokenization
		if("">~+"".indexOf(query.charAt(query.length-1)) >= 0){
			query += "" *""
		}
		query += "" ""; // ensure that we terminate the state machine

		var ts = function(s, e){
			return d.trim(query.slice(s, e));
		}

		// the overall data graph of the full query, as represented by queryPart objects
		var qparts = []; 
		// state keeping vars
		var inBrackets = -1;
		var inParens = -1;
		var inMatchFor = -1;
		var inPseudo = -1;
		var inClass = -1;
		var inId = -1;
		var inTag = -1;
		var lc = """"; // the last character
		var cc = """"; // the current character
		var pStart;
		// iteration vars
		var x = 0; // index in the query
		var ql = query.length;
		var currentPart = null; // data structure representing the entire clause
		var _cp = null; // the current pseudo or attr matcher

		var endTag = function(){
			if(inTag >= 0){
				var tv = (inTag == x) ? null : ts(inTag, x); // .toLowerCase();
				currentPart[ ("">~+"".indexOf(tv) < 0) ? ""tag"" : ""oper"" ] = tv;
				inTag = -1;
			}
		}

		var endId = function(){
			if(inId >= 0){
				currentPart.id = ts(inId, x).replace(/\\/g, """");
				inId = -1;
			}
		}

		var endClass = function(){
			if(inClass >= 0){
				currentPart.classes.push(ts(inClass+1, x).replace(/\\/g, """"));
				inClass = -1;
			}
		}

		var endAll = function(){
			endId(); endTag(); endClass();
		}

		for(; lc=cc, cc=query.charAt(x),x<ql; x++){
			if(lc == ""\\""){ continue; }
			if(!currentPart){
				// NOTE: I hate all this alloc, but it's shorter than writing tons of if's
				pStart = x;
				currentPart = {
					query: null,
					pseudos: [],
					attrs: [],
					classes: [],
					tag: null,
					oper: null,
					id: null
				};
				inTag = x;
			}

			if(inBrackets >= 0){
				// look for a the close first
				if(cc == ""]""){
					if(!_cp.attr){
						_cp.attr = ts(inBrackets+1, x);
					}else{
						_cp.matchFor = ts((inMatchFor||inBrackets+1), x);
					}
					var cmf = _cp.matchFor;
					if(cmf){
						if(	(cmf.charAt(0) == '""') || (cmf.charAt(0)  == ""'"") ){
							_cp.matchFor = cmf.substring(1, cmf.length-1);
						}
					}
					currentPart.attrs.push(_cp);
					_cp = null; // necessaray?
					inBrackets = inMatchFor = -1;
				}else if(cc == ""=""){
					var addToCc = (""|~^$*"".indexOf(lc) >=0 ) ? lc : """";
					_cp.type = addToCc+cc;
					_cp.attr = ts(inBrackets+1, x-addToCc.length);
					inMatchFor = x+1;
				}
				// now look for other clause parts
			}else if(inParens >= 0){
				if(cc == "")""){
					if(inPseudo >= 0){
						_cp.value = ts(inParens+1, x);
					}
					inPseudo = inParens = -1;
				}
			}else if(cc == ""#""){
				endAll();
				inId = x+1;
			}else if(cc == "".""){
				endAll();
				inClass = x;
			}else if(cc == "":""){
				endAll();
				inPseudo = x;
			}else if(cc == ""[""){
				endAll();
				inBrackets = x;
				_cp = {
					/*=====
					attr: null, type: null, matchFor: null
					=====*/
				};
			}else if(cc == ""(""){
				if(inPseudo >= 0){
					_cp = { 
						name: ts(inPseudo+1, x), 
						value: null
					}
					currentPart.pseudos.push(_cp);
				}
				inParens = x;
			}else if(cc == "" "" && lc != cc){
				// note that we expect the string to be "" "" terminated
				endAll();
				if(inPseudo >= 0){
					currentPart.pseudos.push({ name: ts(inPseudo+1, x) });
				}
				currentPart.hasLoops = (	
						currentPart.pseudos.length || 
						currentPart.attrs.length || 
						currentPart.classes.length	);
				currentPart.query = ts(pStart, x);
				currentPart.otag = currentPart.tag = (currentPart[""oper""]) ? null : (currentPart.tag || ""*"");
				if(currentPart.tag){ // FIXME: not valid in case-sensitive documents
					currentPart.tag = currentPart.tag.toUpperCase();
				}
				qparts.push(currentPart);
				currentPart = null;
			}
		}
		return qparts;
	};
	

	////////////////////////////////////////////////////////////////////////
	// XPath query code
	////////////////////////////////////////////////////////////////////////

	// this array is a lookup used to generate an attribute matching function.
	// There is a similar lookup/generator list for the DOM branch with similar
	// calling semantics.
	var xPathAttrs = {
		""*="": function(attr, value){
			return ""[contains(@""+attr+"", '""+ value +""')]"";
		},
		""^="": function(attr, value){
			return ""[starts-with(@""+attr+"", '""+ value +""')]"";
		},
		""$="": function(attr, value){
			return ""[substring(@""+attr+"", string-length(@""+attr+"")-""+(value.length-1)+"")='""+value+""']"";
		},
		""~="": function(attr, value){
			return ""[contains(concat(' ',@""+attr+"",' '), ' ""+ value +"" ')]"";
		},
		""|="": function(attr, value){
			return ""[contains(concat(' ',@""+attr+"",' '), ' ""+ value +""-')]"";
		},
		""="": function(attr, value){
			return ""[@""+attr+""='""+ value +""']"";
		}
	};

	// takes a list of attribute searches, the overall query, a function to
	// generate a default matcher, and a closure-bound method for providing a
	// matching function that generates whatever type of yes/no distinguisher
	// the query method needs. The method is a bit tortured and hard to read
	// because it needs to be used in both the XPath and DOM branches.
	var handleAttrs = function(	attrList, 
								query, 
								getDefault, 
								handleMatch){
		d.forEach(query.attrs, function(attr){
			var matcher;
			// type, attr, matchFor
			if(attr.type && attrList[attr.type]){
				matcher = attrList[attr.type](attr.attr, attr.matchFor);
			}else if(attr.attr.length){
				matcher = getDefault(attr.attr);
			}
			if(matcher){ handleMatch(matcher); }
		});
	}

	var buildPath = function(query){
		var xpath = ""."";
		var qparts = getQueryParts(d.trim(query));
		while(qparts.length){
			var tqp = qparts.shift();
			var prefix;
			var postfix = """";
			if(tqp.oper == "">""){
				prefix = ""/"";
				// prefix = ""/child::*"";
				tqp = qparts.shift();
			}else if(tqp.oper == ""~""){
				prefix = ""/following-sibling::""; // get element following siblings
				tqp = qparts.shift();
			}else if(tqp.oper == ""+""){
				// FIXME: 
				//		fails when selecting subsequent siblings by node type
				//		because the position() checks the position in the list
				//		of matching elements and not the localized siblings
				prefix = ""/following-sibling::"";
				postfix = ""[position()=1]"";
				tqp = qparts.shift();
			}else{
				prefix = ""//"";
				// prefix = ""/descendant::*""
			}

			// get the tag name (if any)

			xpath += prefix + tqp.tag + postfix;
			
			// check to see if it's got an id. Needs to come first in xpath.
			if(tqp.id){
				xpath += ""[@id='""+tqp.id+""'][1]"";
			}

			d.forEach(tqp.classes, function(cn){
				var cnl = cn.length;
				var padding = "" "";
				if(cn.charAt(cnl-1) == ""*""){
					padding = """"; cn = cn.substr(0, cnl-1);
				}
				xpath += 
					""[contains(concat(' ',@class,' '), ' ""+
					cn + padding + ""')]"";
			});

			handleAttrs(xPathAttrs, tqp, 
				function(condition){
						return ""[@""+condition+""]"";
				},
				function(matcher){
					xpath += matcher;
				}
			);

			// FIXME: need to implement pseudo-class checks!!
		};
		return xpath;
	};

	var _xpathFuncCache = {};
	var getXPathFunc = function(path){
		if(_xpathFuncCache[path]){
			return _xpathFuncCache[path];
		}

		var doc = d.doc;
		// don't need to memoize. The closure scope handles it for us.
		var xpath = buildPath(path);

		var tf = function(parent){
			// XPath query strings are memoized.

			var ret = [];
			var xpathResult;
			var tdoc = doc;
			if(parent){
				tdoc = (parent.nodeType == 9) ? parent : parent.ownerDocument;
			}
			try{
				xpathResult = tdoc.evaluate(xpath, parent, null, 
												// XPathResult.UNORDERED_NODE_ITERATOR_TYPE, null);
												XPathResult.ANY_TYPE, null);
			}catch(e){
				
				
			}
			var result = xpathResult.iterateNext();
			while(result){
				ret.push(result);
				result = xpathResult.iterateNext();
			}
			return ret;
		}
		return _xpathFuncCache[path] = tf;
	};

	/*
	d.xPathMatch = function(query){
		// XPath based DOM query system. Handles a small subset of CSS
		// selectors, subset is identical to the non-XPath version of this
		// function. 

		return getXPathFunc(query)();
	}
	*/

	////////////////////////////////////////////////////////////////////////
	// DOM query code
	////////////////////////////////////////////////////////////////////////

	var _filtersCache = {};
	var _simpleFiltersCache = {};

	// the basic building block of the yes/no chaining system. agree(f1, f2)
	// generates a new function which returns the boolean results of both of
	// the passed functions to a single logical-anded result.
	var agree = function(first, second){
		if(!first){ return second; }
		if(!second){ return first; }

		return function(){
			return first.apply(window, arguments) && second.apply(window, arguments);
		}
	}

	var _childElements = function(root){
		var ret = [];
		var te, x = 0, tret = root[childNodesName];
		while((te = tret[x++])){
			if(te.nodeType == 1){ ret.push(te); }
		}
		return ret;
	}

	var _nextSiblings = function(root, single){
		var ret = [];
		var te = root;
		while(te = te.nextSibling){
			if(te.nodeType == 1){
				ret.push(te);
				if(single){ break; }
			}
		}
		return ret;
	}

	// FIXME:
	//		we need to re-write the way ""~"" and ""+"" selectors are handled since
	//		the left-hand selector simply modifies the right (which is the
	//		actual search selector). We need to locate on search selector
	//		instead of modifier to speed up these searches.

	var _filterDown = function(element, queryParts, matchArr, idx){
		// NOTE:
		//		in the fast path! this function is called recursively and for
		//		every run of a query.
		var nidx = idx+1;
		var isFinal = (queryParts.length == nidx);
		var tqp = queryParts[idx];

		// see if we can constrain our next level to direct children
		if(tqp.oper){
			// find some eligable children to search
			var ecn = (tqp.oper == "">"") ? 
				_childElements(element) :
				_nextSiblings(element, (tqp.oper == ""+""));

			if(!ecn || !ecn.length){
				return;
			}
			nidx++;
			isFinal = (queryParts.length == nidx);
			// kinda janky, too much array alloc
			var tf = getFilterFunc(queryParts[idx+1]);
			// for(var x=ecn.length-1, te; x>=0, te=ecn[x]; x--){
			for(var x=0, ecnl=ecn.length, te; x<ecnl, te=ecn[x]; x++){
				if(tf(te)){
					if(isFinal){
						matchArr.push(te);
					}else{
						_filterDown(te, queryParts, matchArr, nidx);
					}
				}
				/*
				if(x==0){
					break;
				}
				*/
			}
		}

		// otherwise, keep going down, unless we'er at the end
		var candidates = getElementsFunc(tqp)(element);
		if(isFinal){
			while(candidates.length){
				matchArr.push(candidates.shift());
			}
			/*
			candidates.unshift(0, matchArr.length-1);
			matchArr.splice.apply(matchArr, candidates);
			*/
		}else{
			// if we're not yet at the bottom, keep going!
			while(candidates.length){
				_filterDown(candidates.shift(), queryParts, matchArr, nidx);
			}
		}
	}

	var filterDown = function(elements, queryParts){
		var ret = [];

		// for every root, get the elements that match the descendant selector
		// for(var x=elements.length-1, te; x>=0, te=elements[x]; x--){
		var x = elements.length - 1, te;
		while((te = elements[x--])){
			_filterDown(te, queryParts, ret, 0);
		}
		return ret;
	}

	var getFilterFunc = function(q){
		// note: query can't have spaces!
		if(_filtersCache[q.query]){
			return _filtersCache[q.query];
		}
		var ff = null;

		// does it have a tagName component?
		if(q.tag){
			if(q.tag == ""*""){
				ff = agree(ff, 
					function(elem){
						return (elem.nodeType == 1);
					}
				);
			}else{
				// tag name match
				ff = agree(ff, 
					function(elem){
						return (
							(elem.nodeType == 1) &&
							(q[ caseSensitive ? ""otag"" : ""tag"" ] == elem.tagName)
							// (q.tag == elem.tagName.toLowerCase())
						);
						// return isTn;
					}
				);
			}
		}

		// does the node have an ID?
		if(q.id){
			ff = agree(ff, 
				function(elem){
					return (
						(elem.nodeType == 1) &&
						(elem.id == q.id)
					);
				}
			);
		}

		if(q.hasLoops){
			// if we have other query param parts, make sure we add them to the
			// filter chain
			ff = agree(ff, getSimpleFilterFunc(q));
		}

		return _filtersCache[q.query] = ff;
	}

	var getNodeIndex = function(node){
		// NOTE: 
		//		we could have a more accurate caching mechanism by invalidating
		//		caches after the query has finished, but I think that'd lead to
		//		significantly more cache churn than the cache would provide
		//		value for in the common case. Generally, we're more
		//		conservative (and therefore, more accurate) than jQuery and
		//		DomQuery WRT node node indexes, but there may be corner cases
		//		in which we fall down.  How much we care about them is TBD.

		var pn = node.parentNode;
		var pnc = pn.childNodes;

		// check to see if we can trust the cache. If not, re-key the whole
		// thing and return our node match from that.

		var nidx = -1;
		var child = pn.firstChild;
		if(!child){
			return nidx;
		}

		var ci = node[""__cachedIndex""];
		var cl = pn[""__cachedLength""];

		// only handle cache building if we've gone out of sync
		if(((typeof cl == ""number"")&&(cl != pnc.length))||(typeof ci != ""number"")){
			// rip though the whole set, building cache indexes as we go
			pn[""__cachedLength""] = pnc.length;
			var idx = 1;
			do{
				// we only assign indexes for nodes with nodeType == 1, as per:
				//		http://www.w3.org/TR/css3-selectors/#nth-child-pseudo
				// only elements are counted in the search order, and they
				// begin at 1 for the first child's index

				if(child === node){
					nidx = idx;
				}
				if(child.nodeType == 1){
					child[""__cachedIndex""] = idx;
					idx++;
				}
				child = child.nextSibling;
			}while(child);
		}else{
			// NOTE: 
			//		could be incorrect in some cases (node swaps involving the
			//		passed node, etc.), but we ignore those due to the relative
			//		unlikelihood of that occuring
			nidx = ci;
		}
		return nidx;
	}

	var firedCount = 0;

	var blank = """";
	var _getAttr = function(elem, attr){
		if(attr == ""class""){
			return elem.className || blank;
		}
		if(attr == ""for""){
			return elem.htmlFor || blank;
		}
		if(attr == ""style""){
			return elem.style.cssText || blank;
		}
		return elem.getAttribute(attr, 2) || blank;
	}

	var attrs = {
		""*="": function(attr, value){
			return function(elem){
				// E[foo*=""bar""]
				//		an E element whose ""foo"" attribute value contains
				//		the substring ""bar""
				return (_getAttr(elem, attr).indexOf(value)>=0);
			}
		},
		""^="": function(attr, value){
			// E[foo^=""bar""]
			//		an E element whose ""foo"" attribute value begins exactly
			//		with the string ""bar""
			return function(elem){
				return (_getAttr(elem, attr).indexOf(value)==0);
			}
		},
		""$="": function(attr, value){
			// E[foo$=""bar""]	
			//		an E element whose ""foo"" attribute value ends exactly
			//		with the string ""bar""
			var tval = "" ""+value;
			return function(elem){
				var ea = "" ""+_getAttr(elem, attr);
				return (ea.lastIndexOf(value)==(ea.length-value.length));
			}
		},
		""~="": function(attr, value){
			// E[foo~=""bar""]	
			//		an E element whose ""foo"" attribute value is a list of
			//		space-separated values, one of which is exactly equal
			//		to ""bar""

			// return ""[contains(concat(' ',@""+attr+"",' '), ' ""+ value +"" ')]"";
			var tval = "" ""+value+"" "";
			return function(elem){
				var ea = "" ""+_getAttr(elem, attr)+"" "";
				return (ea.indexOf(tval)>=0);
			}
		},
		""|="": function(attr, value){
			// E[hreflang|=""en""]
			//		an E element whose ""hreflang"" attribute has a
			//		hyphen-separated list of values beginning (from the
			//		left) with ""en""
			var valueDash = "" ""+value+""-"";
			return function(elem){
				var ea = "" ""+(elem.getAttribute(attr, 2) || """");
				return (
					(ea == value) ||
					(ea.indexOf(valueDash)==0)
				);
			}
		},
		""="": function(attr, value){
			return function(elem){
				return (_getAttr(elem, attr) == value);
			}
		}
	};

	var pseudos = {
		""checked"": function(name, condition){
			return function(elem){
				return !!d.attr(elem, ""checked"");
			}
		},
		""first-child"": function(name, condition){
			return function(elem){
				if(elem.nodeType != 1){ return false; }
				// check to see if any of the previous siblings are elements
				var fc = elem.previousSibling;
				while(fc && (fc.nodeType != 1)){
					fc = fc.previousSibling;
				}
				return (!fc);
			}
		},
		""last-child"": function(name, condition){
			return function(elem){
				if(elem.nodeType != 1){ return false; }
				// check to see if any of the next siblings are elements
				var nc = elem.nextSibling;
				while(nc && (nc.nodeType != 1)){
					nc = nc.nextSibling;
				}
				return (!nc);
			}
		},
		""empty"": function(name, condition){
			return function(elem){
				// DomQuery and jQuery get this wrong, oddly enough.
				// The CSS 3 selectors spec is pretty explicit about
				// it, too.
				var cn = elem.childNodes;
				var cnl = elem.childNodes.length;
				// if(!cnl){ return true; }
				for(var x=cnl-1; x >= 0; x--){
					var nt = cn[x].nodeType;
					if((nt == 1)||(nt == 3)){ return false; }
				}
				return true;
			}
		},
		""contains"": function(name, condition){
			return function(elem){
				// FIXME: I dislike this version of ""contains"", as
				// whimsical attribute could set it off. An inner-text
				// based version might be more accurate, but since
				// jQuery and DomQuery also potentially get this wrong,
				// I'm leaving it for now.
				if(condition.charAt(0)=='""' || condition.charAt(0)==""'""){//remove quote
					condition=condition.substr(1,condition.length-2);
				}
				return (elem.innerHTML.indexOf(condition) >= 0);
			}
		},
		""not"": function(name, condition){
			var ntf = getFilterFunc(getQueryParts(condition)[0]);
			return function(elem){
				return (!ntf(elem));
			}
		},
		""nth-child"": function(name, condition){
			var pi = parseInt;
			if(condition == ""odd""){
				condition = ""2n+1"";
			}else if(condition == ""even""){
				condition = ""2n"";
			}
			if(condition.indexOf(""n"") != -1){
				var tparts = condition.split(""n"", 2);
				var pred = tparts[0] ? (tparts[0]=='-'?-1:pi(tparts[0])) : 1;
				var idx = tparts[1] ? pi(tparts[1]) : 0;
				var lb = 0, ub = -1;
				if(pred>0){
					if(idx<0){
						idx = (idx % pred) && (pred + (idx % pred));
					}else if(idx>0){
						if(idx >= pred){
							lb = idx - idx % pred;
						}
						idx = idx % pred;
					}
				}else if(pred<0){
					pred *= -1;
					if(idx>0){
						ub = idx;
						idx = idx % pred;
					} //idx has to be greater than 0 when pred is negative; shall we throw an error here?
				}
				if(pred>0){
					return function(elem){
						var i=getNodeIndex(elem);
						return (i>=lb) && (ub<0 || i<=ub) && ((i % pred) == idx);
					}
				}else{
					condition=idx;
				}
			}
			//if(condition.indexOf(""n"") == -1){
			var ncount = pi(condition);
			return function(elem){
				return (getNodeIndex(elem) == ncount);
			}
		}
	};

	var defaultGetter = (d.isIE) ? function(cond){
		var clc = cond.toLowerCase();
		return function(elem){
			return elem[cond]||elem[clc];
		}
	} : function(cond){
		return function(elem){
			return (elem && elem.getAttribute && elem.hasAttribute(cond));
		}
	};

	var getSimpleFilterFunc = function(query){

		var fcHit = (_simpleFiltersCache[query.query]||_filtersCache[query.query]);
		if(fcHit){ return fcHit; }

		var ff = null;

		// the only case where we'll need the tag name is if we came from an ID query
		if(query.id){ // do we have an ID component?
			if(query.tag != ""*""){
				ff = agree(ff, function(elem){
					return (elem.tagName == query[ caseSensitive ? ""otag"" : ""tag"" ]);
				});
			}
		}

		// if there's a class in our query, generate a match function for it
		d.forEach(query.classes, function(cname, idx, arr){
			// get the class name
			var isWildcard = cname.charAt(cname.length-1) == ""*"";
			if(isWildcard){
				cname = cname.substr(0, cname.length-1);
			}
			// I dislike the regex thing, even if memozied in a cache, but it's VERY short
			var re = new RegExp(""(?:^|\\s)"" + cname + (isWildcard ? "".*"" : """") + ""(?:\\s|$)"");
			ff = agree(ff, function(elem){
				return re.test(elem.className);
			});
			ff.count = idx;
		});

		d.forEach(query.pseudos, function(pseudo){
			if(pseudos[pseudo.name]){
				ff = agree(ff, pseudos[pseudo.name](pseudo.name, pseudo.value));
			}
		});

		handleAttrs(attrs, query, defaultGetter,
			function(tmatcher){ ff = agree(ff, tmatcher); }
		);
		if(!ff){
			ff = function(){ return true; };
		}
		return _simpleFiltersCache[query.query] = ff;
	}

	var _getElementsFuncCache = { };

	var getElementsFunc = function(query, root){
		var fHit = _getElementsFuncCache[query.query];
		if(fHit){ return fHit; }

		// NOTE: this function is in the fast path! not memoized!!!

		// the query doesn't contain any spaces, so there's only so many
		// things it could be

		if(query.id && !query.hasLoops && !query.tag){
			// ID-only query. Easy.
			return _getElementsFuncCache[query.query] = function(root){
				// FIXME: if root != document, check for parenting!
				return [ d.byId(query.id) ];
			}
		}

		var filterFunc = getSimpleFilterFunc(query);

		var retFunc;
		if(query.tag && query.id && !query.hasLoops){
			// we got a filtered ID search (e.g., ""h4#thinger"")
			retFunc = function(root){
				var te = d.byId(query.id, (root.ownerDocument||root)); //root itself may be a document
				if(filterFunc(te)){
					return [ te ];
				}
			}
		}else{
			var tret;

			if(!query.hasLoops){
				// it's just a plain-ol elements-by-tag-name query from the root
				retFunc = function(root){
					var ret = [];
					var te, x=0, tret = root.getElementsByTagName(query[ caseSensitive ? ""otag"" : ""tag""]);
					while((te = tret[x++])){
						ret.push(te);
					}
					return ret;
				}
			}else{
				retFunc = function(root){
					var ret = [];
					var te, x = 0, tret = root.getElementsByTagName(query[ caseSensitive ? ""otag"" : ""tag""]);
					while((te = tret[x++])){
						if(filterFunc(te)){
							ret.push(te);
						}
					}
					return ret;
				}
			}
		}
		return _getElementsFuncCache[query.query] = retFunc;
	}

	var _partsCache = {};

	////////////////////////////////////////////////////////////////////////
	// the query runner
	////////////////////////////////////////////////////////////////////////

	// this is the second level of spliting, from full-length queries (e.g.,
	// ""div.foo .bar"") into simple query expressions (e.g., [""div.foo"",
	// "".bar""])
	var _queryFuncCache = {
		""*"": d.isIE ? 
			function(root){ 
					return root.all;
			} : 
			function(root){
				 return root.getElementsByTagName(""*"");
			},
		""~"": _nextSiblings,
		""+"": function(root){ return _nextSiblings(root, true); },
		"">"": _childElements
	};

	var getStepQueryFunc = function(query){
		// if it's trivial, get a fast-path dispatcher
		var qparts = getQueryParts(d.trim(query));
		// if(query[query.length-1] == "">""){ query += "" *""; }
		if(qparts.length == 1){
			var tt = getElementsFunc(qparts[0]);
			tt.nozip = true; // FIXME: is this right? Shouldn't this be wrapped in a closure to mark the return?
			return tt;
		}

		// otherwise, break it up and return a runner that iterates over the parts recursively
		var sqf = function(root){
			var localQueryParts = qparts.slice(0); // clone the src arr
			var candidates;
			if(localQueryParts[0].oper == "">""){ // FIXME: what if it's + or ~?
				candidates = [ root ];
				// root = document;
			}else{
				candidates = getElementsFunc(localQueryParts.shift())(root);
			}
			return filterDown(candidates, localQueryParts);
		}
		return sqf;
	}

	// a specialized method that implements our primoridal ""query optimizer"".
	// This allows us to dispatch queries to the fastest subsystem we can get.
	var _getQueryFunc = (
		// NOTE: 
		//		XPath on the Webkit is slower than it's DOM iteration for most
		//		test cases
		// FIXME: 
		//		we should try to capture some runtime speed data for each query
		//		function to determine on the fly if we should stick w/ the
		//		potentially optimized variant or if we should try something
		//		new.
		(document[""evaluate""] && !d.isSafari) ? 
		function(query, root){
			// has xpath support that's faster than DOM
			var qparts = query.split("" "");
			// can we handle it?
			if(	(!caseSensitive) && // not strictly necessaray, but simplifies lots of stuff
				(document[""evaluate""]) &&
				(query.indexOf("":"") == -1) &&
				(query.indexOf(""+"") == -1) // skip direct sibling matches. See line ~344
			){
				// dojo.debug(query);
				// should we handle it?

				// kind of a lame heuristic, but it works
				if(	
					// a ""div div div"" style query
					((qparts.length > 2)&&(query.indexOf("">"") == -1))||
					// or something else with moderate complexity. kinda janky
					(qparts.length > 3)||
					(query.indexOf(""["")>=0)||
					// or if it's a "".thinger"" query
					((1 == qparts.length)&&(0 <= query.indexOf(""."")))

				){
					// use get and cache a xpath runner for this selector
					return getXPathFunc(query);
				}
			}

			// fallthrough
			return getStepQueryFunc(query);
		} : getStepQueryFunc
	);
	// uncomment to disable XPath for testing and tuning the DOM path
	// _getQueryFunc = getStepQueryFunc;

	// FIXME: we've got problems w/ the NodeList query()/filter() functions if we go XPath for everything

	// uncomment to disable DOM queries for testing and tuning XPath
	// _getQueryFunc = getXPathFunc;

	// this is the primary caching for full-query results. The query dispatcher
	// functions are generated here and then pickled for hash lookup in the
	// future
	var getQueryFunc = function(query){
		// return a cached version if one is available
		var qcz = query.charAt(0);
		if(d.doc[""querySelectorAll""] && 
			( (!d.isSafari) || (d.isSafari > 3.1) ) && // see #5832
			// as per CSS 3, we can't currently start w/ combinator:
			//		http://www.w3.org/TR/css3-selectors/#w3cselgrammar
			("">+~"".indexOf(qcz) == -1)
		){
			return function(root){
				var r = root.querySelectorAll(query);
				r.nozip = true; // skip expensive duplication checks and just wrap in a NodeList
				return r;
			};
		}
		if(_queryFuncCache[query]){ return _queryFuncCache[query]; }
		if(0 > query.indexOf("","")){
			// if it's not a compound query (e.g., "".foo, .bar""), cache and return a dispatcher
			return _queryFuncCache[query] = _getQueryFunc(query);
		}else{
			// if it's a complex query, break it up into it's constituent parts
			// and return a dispatcher that will merge the parts when run

			// var parts = query.split("", "");
			var parts = query.split(/\s*,\s*/);
			var tf = function(root){
				var pindex = 0; // avoid array alloc for every invocation
				var ret = [];
				var tp;
				while((tp = parts[pindex++])){
					ret = ret.concat(_getQueryFunc(tp, tp.indexOf("" ""))(root));
				}
				return ret;
			}
			// ...cache and return
			return _queryFuncCache[query] = tf;
		}
	}

	// FIXME: 
	//		Dean's Base2 uses a system whereby queries themselves note if
	//		they'll need duplicate filtering. We need to get on that plan!!

	// attempt to efficiently determine if an item in a list is a dupe,
	// returning a list of ""uniques"", hopefully in doucment order
	var _zipIdx = 0;
	var _zip = function(arr){
		if(arr && arr.nozip){ return d.NodeList._wrap(arr); }
		var ret = new d.NodeList();
		if(!arr){ return ret; }
		if(arr[0]){
			ret.push(arr[0]);
		}
		if(arr.length < 2){ return ret; }

		_zipIdx++;
		
		// we have to fork here for IE and XML docs because we can't set
		// expandos on their nodes (apparently). *sigh*
		if(d.isIE && caseSensitive){
			var szidx = _zipIdx+"""";
			arr[0].setAttribute(""_zipIdx"", szidx);
			for(var x = 1, te; te = arr[x]; x++){
				if(arr[x].getAttribute(""_zipIdx"") != szidx){ 
					ret.push(te);
				}
				te.setAttribute(""_zipIdx"", szidx);
			}
		}else{
			arr[0][""_zipIdx""] = _zipIdx;
			for(var x = 1, te; te = arr[x]; x++){
				if(arr[x][""_zipIdx""] != _zipIdx){ 
					ret.push(te);
				}
				te[""_zipIdx""] = _zipIdx;
			}
		}
		// FIXME: should we consider stripping these properties?
		return ret;
	}

	// the main executor
	d.query = function(/*String*/ query, /*String|DOMNode?*/ root){
		//	summary:
		//		Returns nodes which match the given CSS3 selector, searching the
		//		entire document by default but optionally taking a node to scope
		//		the search by. Returns an instance of dojo.NodeList.
		//	description:
		//		dojo.query() is the swiss army knife of DOM node manipulation in
		//		Dojo. Much like Prototype's ""$$"" (bling-bling) function or JQuery's
		//		""$"" function, dojo.query provides robust, high-performance
		//		CSS-based node selector support with the option of scoping searches
		//		to a particular sub-tree of a document.
		//
		//		Supported Selectors:
		//		--------------------
		//
		//		dojo.query() supports a rich set of CSS3 selectors, including:
		//
		//			* class selectors (e.g., `.foo`)
		//			* node type selectors like `span`
		//			* ` ` descendant selectors
		//			* `>` child element selectors 
		//			* `#foo` style ID selectors
		//			* `*` universal selector
		//			* `~`, the immediately preceeded-by sibling selector
		//			* `+`, the preceeded-by sibling selector
		//			* attribute queries:
		//			|	* `[foo]` attribute presence selector
		//			|	* `[foo='bar']` attribute value exact match
		//			|	* `[foo~='bar']` attribute value list item match
		//			|	* `[foo^='bar']` attribute start match
		//			|	* `[foo$='bar']` attribute end match
		//			|	* `[foo*='bar']` attribute substring match
		//			* `:first-child`, `:last-child` positional selectors
		//			* `:empty` content emtpy selector
		//			* `:empty` content emtpy selector
		//			* `:checked` pseudo selector
		//			* `:nth-child(n)`, `:nth-child(2n+1)` style positional calculations
		//			* `:nth-child(even)`, `:nth-child(odd)` positional selectors
		//			* `:not(...)` negation pseudo selectors
		//
		//		Any legal combination of these selectors will work with
		//		`dojo.query()`, including compound selectors ("","" delimited).
		//		Very complex and useful searches can be constructed with this
		//		palette of selectors and when combined with functions for
		//		maniplation presented by dojo.NodeList, many types of DOM
		//		manipulation operations become very straightforward.
		//		
		//		Unsupported Selectors:
		//		----------------------
		//
		//		While dojo.query handles many CSS3 selectors, some fall outside of
		//		what's resaonable for a programmatic node querying engine to
		//		handle. Currently unsupported selectors include:
		//		
		//			* namespace-differentiated selectors of any form
		//			* all `::` pseduo-element selectors
		//			* certain pseduo-selectors which don't get a lot of day-to-day use:
		//			|	* `:root`, `:lang()`, `:target`, `:focus`
		//			* all visual and state selectors:
		//			|	* `:root`, `:active`, `:hover`, `:visisted`, `:link`,
		//				  `:enabled`, `:disabled`
		//			* `:*-of-type` pseudo selectors
		//		
		//		dojo.query and XML Documents:
		//		-----------------------------
		//		
		//		`dojo.query` currently only supports searching XML documents
		//		whose tags and attributes are 100% lower-case. This is a known
		//		limitation and will [be addressed soon](http://trac.dojotoolkit.org/ticket/3866)
		//		Non-selector Queries:
		//		---------------------
		//
		//		If something other than a String is passed for the query,
		//		`dojo.query` will return a new `dojo.NodeList` constructed from
		//		that parameter alone and all further processing will stop. This
		//		means that if you have a reference to a node or NodeList, you
		//		can quickly construct a new NodeList from the original by
		//		calling `dojo.query(node)` or `dojo.query(list)`.
		//
		//	query:
		//		The CSS3 expression to match against. For details on the syntax of
		//		CSS3 selectors, see <http://www.w3.org/TR/css3-selectors/#selectors>
		//	root:
		//		A DOMNode (or node id) to scope the search from. Optional.
		//	returns: dojo.NodeList
		//		An instance of `dojo.NodeList`. Many methods are available on
		//		NodeLists for searching, iterating, manipulating, and handling
		//		events on the matched nodes in the returned list.
		//	example:
		//		search the entire document for elements with the class ""foo"":
		//	|	dojo.query("".foo"");
		//		these elements will match:
		//	|	<span class=""foo""></span>
		//	|	<span class=""foo bar""></span>
		//	|	<p class=""thud foo""></p>
		//	example:
		//		search the entire document for elements with the classes ""foo"" *and* ""bar"":
		//	|	dojo.query("".foo.bar"");
		//		these elements will match:
		//	|	<span class=""foo bar""></span>
		//		while these will not:
		//	|	<span class=""foo""></span>
		//	|	<p class=""thud foo""></p>
		//	example:
		//		find `<span>` elements which are descendants of paragraphs and
		//		which have a ""highlighted"" class:
		//	|	dojo.query(""p span.highlighted"");
		//		the innermost span in this fragment matches:
		//	|	<p class=""foo"">
		//	|		<span>...
		//	|			<span class=""highlighted foo bar"">...</span>
		//	|		</span>
		//	|	</p>
		//	example:
		//		set an ""odd"" class on all odd table rows inside of the table
		//		`#tabular_data`, using the `>` (direct child) selector to avoid
		//		affecting any nested tables:
		//	|	dojo.query(""#tabular_data > tbody > tr:nth-child(odd)"").addClass(""odd"");
		//	example:
		//		remove all elements with the class ""error"" from the document
		//		and store them in a list:
		//	|	var errors = dojo.query("".error"").orphan();
		//	example:
		//		add an onclick handler to every submit button in the document
		//		which causes the form to be sent via Ajax instead:
		//	|	dojo.query(""input[type='submit']"").onclick(function(e){
		//	|		dojo.stopEvent(e); // prevent sending the form
		//	|		var btn = e.target;
		//	|		dojo.xhrPost({
		//	|			form: btn.form,
		//	|			load: function(data){
		//	|				// replace the form with the response
		//	|				var div = dojo.doc.createElement(""div"");
		//	|				dojo.place(div, btn.form, ""after"");
		//	|				div.innerHTML = data;
		//	|				dojo.style(btn.form, ""display"", ""none"");
		//	|			}
		//	|		});
		//	|	});


		// NOTE: elementsById is not currently supported
		// NOTE: ignores xpath-ish queries for now

		if(query.constructor == d.NodeList){
			return query;
		}
		if(!d.isString(query)){
			return new d.NodeList(query); // dojo.NodeList
		}
		if(d.isString(root)){
			root = d.byId(root);
		}

		root = root||d.doc;
		var od = root.ownerDocument||root.documentElement;
		caseSensitive = (root.contentType && root.contentType==""application/xml"") || (!!od) && (d.isIE ? od.xml : (root.xmlVersion||od.xmlVersion));
		return _zip(getQueryFunc(query)(root)); // dojo.NodeList
	}

	/*
	// exposing this was a mistake
	d.query.attrs = attrs;
	*/
	// exposing this because new pseudo matches are only executed through the
	// DOM query path (never through the xpath optimizing branch)
	d.query.pseudos = pseudos;

	// one-off function for filtering a NodeList based on a simple selector
	d._filterQueryResult = function(nodeList, simpleFilter){
		var tnl = new d.NodeList();
		var ff = (simpleFilter) ? getFilterFunc(getQueryParts(simpleFilter)[0]) : function(){ return true; };
		for(var x = 0, te; te = nodeList[x]; x++){
			if(ff(te)){ tnl.push(te); }
		}
		return tnl;
	}
})();

}

if(!dojo._hasResource[""dojo._base.xhr""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.xhr""] = true;
dojo.provide(""dojo._base.xhr"");





(function(){
	var _d = dojo;
	function setValue(/*Object*/obj, /*String*/name, /*String*/value){
		//summary:
		//		For the named property in object, set the value. If a value
		//		already exists and it is a string, convert the value to be an
		//		array of values.
		var val = obj[name];
		if(_d.isString(val)){
			obj[name] = [val, value];
		}else if(_d.isArray(val)){
			val.push(value);
		}else{
			obj[name] = value;
		}
	}

	dojo.formToObject = function(/*DOMNode||String*/ formNode){
		// summary:
		//		dojo.formToObject returns the values encoded in an HTML form as
		//		string properties in an object which it then returns. Disabled form
		//		elements, buttons, and other non-value form elements are skipped.
		//		Multi-select elements are returned as an array of string values.
		// description:
		//		This form:
		//
		//		|	<form id=""test_form"">
		//		|		<input type=""text"" name=""blah"" value=""blah"">
		//		|		<input type=""text"" name=""no_value"" value=""blah"" disabled>
		//		|		<input type=""button"" name=""no_value2"" value=""blah"">
		//		|		<select type=""select"" multiple name=""multi"" size=""5"">
		//		|			<option value=""blah"">blah</option>
		//		|			<option value=""thud"" selected>thud</option>
		//		|			<option value=""thonk"" selected>thonk</option>
		//		|		</select>
		//		|	</form>
		//
		//		yields this object structure as the result of a call to
		//		formToObject():
		//
		//		|	{ 
		//		|		blah: ""blah"",
		//		|		multi: [
		//		|			""thud"",
		//		|			""thonk""
		//		|		]
		//		|	};

		var ret = {};
		var exclude = ""file|submit|image|reset|button|"";
		_d.forEach(dojo.byId(formNode).elements, function(item){
			var _in = item.name;
			var type = (item.type||"""").toLowerCase();
			if(_in && type && exclude.indexOf(type) == -1 && !item.disabled){
				if(type == ""radio"" || type == ""checkbox""){
					if(item.checked){ setValue(ret, _in, item.value); }
				}else if(item.multiple){
					ret[_in] = [];
					_d.query(""option"", item).forEach(function(opt){
						if(opt.selected){
							setValue(ret, _in, opt.value);
						}
					});
				}else{ 
					setValue(ret, _in, item.value);
					if(type == ""image""){
						ret[_in+"".x""] = ret[_in+"".y""] = ret[_in].x = ret[_in].y = 0;
					}
				}
			}
		});
		return ret; // Object
	}

	dojo.objectToQuery = function(/*Object*/ map){
		//	summary:
		//		takes a name/value mapping object and returns a string representing
		//		a URL-encoded version of that object.
		//	example:
		//		this object:
		//
		//		|	{ 
		//		|		blah: ""blah"",
		//		|		multi: [
		//		|			""thud"",
		//		|			""thonk""
		//		|		]
		//		|	};
		//
		//	yields the following query string:
		//	
		//	|	""blah=blah&multi=thud&multi=thonk""

		// FIXME: need to implement encodeAscii!!
		var enc = encodeURIComponent;
		var pairs = [];
		var backstop = {};
		for(var name in map){
			var value = map[name];
			if(value != backstop[name]){
				var assign = enc(name) + ""="";
				if(_d.isArray(value)){
					for(var i=0; i < value.length; i++){
						pairs.push(assign + enc(value[i]));
					}
				}else{
					pairs.push(assign + enc(value));
				}
			}
		}
		return pairs.join(""&""); // String
	}

	dojo.formToQuery = function(/*DOMNode||String*/ formNode){
		// summary:
		//		Returns a URL-encoded string representing the form passed as either a
		//		node or string ID identifying the form to serialize
		return _d.objectToQuery(_d.formToObject(formNode)); // String
	}

	dojo.formToJson = function(/*DOMNode||String*/ formNode, /*Boolean?*/prettyPrint){
		// summary:
		//		return a serialized JSON string from a form node or string
		//		ID identifying the form to serialize
		return _d.toJson(_d.formToObject(formNode), prettyPrint); // String
	}

	dojo.queryToObject = function(/*String*/ str){
		// summary:
		//		returns an object representing a de-serialized query section of a
		//		URL. Query keys with multiple values are returned in an array.
		// description:
		//		This string:
		//
		//	|		""foo=bar&foo=baz&thinger=%20spaces%20=blah&zonk=blarg&""
		//		
		//		results in this object structure:
		//
		//	|		{
		//	|			foo: [ ""bar"", ""baz"" ],
		//	|			thinger: "" spaces =blah"",
		//	|			zonk: ""blarg""
		//	|		}
		//	
		//		Note that spaces and other urlencoded entities are correctly
		//		handled.

		// FIXME: should we grab the URL string if we're not passed one?
		var ret = {};
		var qp = str.split(""&"");
		var dec = decodeURIComponent;
		_d.forEach(qp, function(item){
			if(item.length){
				var parts = item.split(""="");
				var name = dec(parts.shift());
				var val = dec(parts.join(""=""));
				if(_d.isString(ret[name])){
					ret[name] = [ret[name]];
				}
				if(_d.isArray(ret[name])){
					ret[name].push(val);
				}else{
					ret[name] = val;
				}
			}
		});
		return ret; // Object
	}

	/*
		from refactor.txt:

		all bind() replacement APIs take the following argument structure:

			{
				url: ""blah.html"",

				// all below are optional, but must be supported in some form by
				// every IO API
				timeout: 1000, // milliseconds
				handleAs: ""text"", // replaces the always-wrong ""mimetype""
				content: { 
					key: ""value""
				},

				// browser-specific, MAY be unsupported
				sync: true, // defaults to false
				form: dojo.byId(""someForm"") 
			}
	*/

	// need to block async callbacks from snatching this thread as the result
	// of an async callback might call another sync XHR, this hangs khtml forever
	// must checked by watchInFlight()

	dojo._blockAsync = false;

	dojo._contentHandlers = {
		""text"": function(xhr){ return xhr.responseText; },
		""json"": function(xhr){
			return _d.fromJson(xhr.responseText || null);
		},
		""json-comment-filtered"": function(xhr){ 
			// NOTE: the json-comment-filtered option was implemented to prevent
			// ""JavaScript Hijacking"", but it is less secure than standard JSON. Use
			// standard JSON instead. JSON prefixing can be used to subvert hijacking.
			if(!dojo.config.useCommentedJson){
				console.warn(""Consider using the standard mimetype:application/json.""
					+ "" json-commenting can introduce security issues. To""
					+ "" decrease the chances of hijacking, use the standard the 'json' handler and""
					+ "" prefix your json with: {}&&\n""
					+ ""Use djConfig.useCommentedJson=true to turn off this message."");
			}

			var value = xhr.responseText;
			var cStartIdx = value.indexOf(""\/*"");
			var cEndIdx = value.lastIndexOf(""*\/"");
			if(cStartIdx == -1 || cEndIdx == -1){
				throw new Error(""JSON was not comment filtered"");
			}
			return _d.fromJson(value.substring(cStartIdx+2, cEndIdx));
		},
		""javascript"": function(xhr){ 
			// FIXME: try Moz and IE specific eval variants?
			return _d.eval(xhr.responseText);
		},
		""xml"": function(xhr){ 
			var result = xhr.responseXML;
			if(_d.isIE && (!result || result.documentElement == null)){
				_d.forEach([""MSXML2"", ""Microsoft"", ""MSXML"", ""MSXML3""], function(prefix){
					try{
						var dom = new ActiveXObject(prefix + "".XMLDOM"");
						dom.async = false;
						dom.loadXML(xhr.responseText);
						result = dom;
					}catch(e){ /* Not available. Squelch and try next one. */ }
				});
			}
			return result; // DOMDocument
		}
	};

	dojo._contentHandlers[""json-comment-optional""] = function(xhr){
		var handlers = _d._contentHandlers;
		if(xhr.responseText && xhr.responseText.indexOf(""\/*"") != -1){
			return handlers[""json-comment-filtered""](xhr);
		}else{
			return handlers[""json""](xhr);
		}
	};

	/*=====
	dojo.__IoArgs = function(){
		//	url: String
		//		URL to server endpoint.
		//	content: Object?
		//		Contains properties with string values. These
		//		properties will be serialized as name1=value2 and
		//		passed in the request.
		//	timeout: Integer?
		//		Milliseconds to wait for the response. If this time
		//		passes, the then error callbacks are called.
		//	form: DOMNode?
		//		DOM node for a form. Used to extract the form values
		//		and send to the server.
		//	preventCache: Boolean?
		//		Default is false. If true, then a
		//		""dojo.preventCache"" parameter is sent in the request
		//		with a value that changes with each request
		//		(timestamp). Useful only with GET-type requests.
		//	handleAs: String?
		//		Acceptable values depend on the type of IO
		//		transport (see specific IO calls for more information).
		//	load: Function?
		//		function(response, ioArgs){} response is of type Object, ioArgs
		//		is of type dojo.__IoCallbackArgs.  This function will be
		//		called on a successful HTTP response code.
		//	error: Function?
		//		function(response, ioArgs){} response is of type Object, ioArgs
		//		is of type dojo.__IoCallbackArgs. This function will
		//		be called when the request fails due to a network or server error, the url
		//		is invalid, etc. It will also be called if the load or handle callback throws an
		//		exception, unless djConfig.isDebug is true.  This allows deployed applications
		//		to continue to run even when a logic error happens in the callback, while making
		//		it easier to troubleshoot while in debug mode.
		//	handle: Function?
		//		function(response, ioArgs){} response is of type Object, ioArgs
		//		is of type dojo.__IoCallbackArgs.  This function will
		//		be called at the end of every request, whether or not an error occurs.
		this.url = url;
		this.content = content;
		this.timeout = timeout;
		this.form = form;
		this.preventCache = preventCache;
		this.handleAs = handleAs;
		this.load = load;
		this.error = error;
		this.handle = handle;
	}
	=====*/

	/*=====
	dojo.__IoCallbackArgs = function(args, xhr, url, query, handleAs, id, canDelete, json){
		//	args: Object
		//		the original object argument to the IO call.
		//	xhr: XMLHttpRequest
		//		For XMLHttpRequest calls only, the
		//		XMLHttpRequest object that was used for the
		//		request.
		//	url: String
		//		The final URL used for the call. Many times it
		//		will be different than the original args.url
		//		value.
		//	query: String
		//		For non-GET requests, the
		//		name1=value1&name2=value2 parameters sent up in
		//		the request.
		//	handleAs: String
		//		The final indicator on how the response will be
		//		handled.
		//	id: String
		//		For dojo.io.script calls only, the internal
		//		script ID used for the request.
		//	canDelete: Boolean
		//		For dojo.io.script calls only, indicates
		//		whether the script tag that represents the
		//		request can be deleted after callbacks have
		//		been called. Used internally to know when
		//		cleanup can happen on JSONP-type requests.
		//	json: Object
		//		For dojo.io.script calls only: holds the JSON
		//		response for JSONP-type requests. Used
		//		internally to hold on to the JSON responses.
		//		You should not need to access it directly --
		//		the same object should be passed to the success
		//		callbacks directly.
		this.args = args;
		this.xhr = xhr;
		this.url = url;
		this.query = query;
		this.handleAs = handleAs;
		this.id = id;
		this.canDelete = canDelete;
		this.json = json;
	}
	=====*/



	dojo._ioSetArgs = function(/*dojo.__IoArgs*/args,
			/*Function*/canceller,
			/*Function*/okHandler,
			/*Function*/errHandler){
		//	summary: 
		//		sets up the Deferred and ioArgs property on the Deferred so it
		//		can be used in an io call.
		//	args:
		//		The args object passed into the public io call. Recognized properties on
		//		the args object are:
		//	canceller:
		//		The canceller function used for the Deferred object. The function
		//		will receive one argument, the Deferred object that is related to the
		//		canceller.
		//	okHandler:
		//		The first OK callback to be registered with Deferred. It has the opportunity
		//		to transform the OK response. It will receive one argument -- the Deferred
		//		object returned from this function.
		//	errHandler:
		//		The first error callback to be registered with Deferred. It has the opportunity
		//		to do cleanup on an error. It will receive two arguments: error (the 
		//		Error object) and dfd, the Deferred object returned from this function.

		var ioArgs = {args: args, url: args.url};

		//Get values from form if requestd.
		var formObject = null;
		if(args.form){ 
			var form = _d.byId(args.form);
			//IE requires going through getAttributeNode instead of just getAttribute in some form cases, 
			//so use it for all.  See #2844
			var actnNode = form.getAttributeNode(""action"");
			ioArgs.url = ioArgs.url || (actnNode ? actnNode.value : null); 
			formObject = _d.formToObject(form);
		}

		// set up the query params
		var miArgs = [{}];
	
		if(formObject){
			// potentially over-ride url-provided params w/ form values
			miArgs.push(formObject);
		}
		if(args.content){
			// stuff in content over-rides what's set by form
			miArgs.push(args.content);
		}
		if(args.preventCache){
			miArgs.push({""dojo.preventCache"": new Date().valueOf()});
		}
		ioArgs.query = _d.objectToQuery(_d.mixin.apply(null, miArgs));
	
		// .. and the real work of getting the deferred in order, etc.
		ioArgs.handleAs = args.handleAs || ""text"";
		var d = new _d.Deferred(canceller);
		d.addCallbacks(okHandler, function(error){
			return errHandler(error, d);
		});

		//Support specifying load, error and handle callback functions from the args.
		//For those callbacks, the ""this"" object will be the args object.
		//The callbacks will get the deferred result value as the
		//first argument and the ioArgs object as the second argument.
		var ld = args.load;
		if(ld && _d.isFunction(ld)){
			d.addCallback(function(value){
				return ld.call(args, value, ioArgs);
			});
		}
		var err = args.error;
		if(err && _d.isFunction(err)){
			d.addErrback(function(value){
				return err.call(args, value, ioArgs);
			});
		}
		var handle = args.handle;
		if(handle && _d.isFunction(handle)){
			d.addBoth(function(value){
				return handle.call(args, value, ioArgs);
			});
		}
		
		d.ioArgs = ioArgs;
	
		// FIXME: need to wire up the xhr object's abort method to something
		// analagous in the Deferred
		return d;
	}

	var _deferredCancel = function(/*Deferred*/dfd){
		//summary: canceller function for dojo._ioSetArgs call.
		
		dfd.canceled = true;
		var xhr = dfd.ioArgs.xhr;
		var _at = typeof xhr.abort;
		if(_at == ""function"" || _at == ""object"" || _at == ""unknown""){
			xhr.abort();
		}
		var err = dfd.ioArgs.error;
		if(!err){
			err = new Error(""xhr cancelled"");
			err.dojoType=""cancel"";
		}
		return err;
	}
	var _deferredOk = function(/*Deferred*/dfd){
		//summary: okHandler function for dojo._ioSetArgs call.

		var ret = _d._contentHandlers[dfd.ioArgs.handleAs](dfd.ioArgs.xhr);
		return (typeof ret == ""undefined"") ? null : ret;
	}
	var _deferError = function(/*Error*/error, /*Deferred*/dfd){
		//summary: errHandler function for dojo._ioSetArgs call.

		
		return error;
	}

	// avoid setting a timer per request. It degrades performance on IE
	// something fierece if we don't use unified loops.
	var _inFlightIntvl = null;
	var _inFlight = [];
	var _watchInFlight = function(){
		//summary: 
		//		internal method that checks each inflight XMLHttpRequest to see
		//		if it has completed or if the timeout situation applies.
		
		var now = (new Date()).getTime();
		// make sure sync calls stay thread safe, if this callback is called
		// during a sync call and this results in another sync call before the
		// first sync call ends the browser hangs
		if(!_d._blockAsync){
			// we need manual loop because we often modify _inFlight (and therefore 'i') while iterating
			// note: the second clause is an assigment on purpose, lint may complain
			for(var i = 0, tif; i < _inFlight.length && (tif = _inFlight[i]); i++){
				var dfd = tif.dfd;
				var func = function(){
					if(!dfd || dfd.canceled || !tif.validCheck(dfd)){
						_inFlight.splice(i--, 1); 
					}else if(tif.ioCheck(dfd)){
						_inFlight.splice(i--, 1);
						tif.resHandle(dfd);
					}else if(dfd.startTime){
						//did we timeout?
						if(dfd.startTime + (dfd.ioArgs.args.timeout || 0) < now){
							_inFlight.splice(i--, 1);
							var err = new Error(""timeout exceeded"");
							err.dojoType = ""timeout"";
							dfd.errback(err);
							//Cancel the request so the io module can do appropriate cleanup.
							dfd.cancel();
						}
					}
				};
				if(dojo.config.isDebug){
					func.call(this);
				}else{
					try{
						func.call(this);
					}catch(e){
						dfd.errback(e);
					}
				}
			}
		}

		if(!_inFlight.length){
			clearInterval(_inFlightIntvl);
			_inFlightIntvl = null;
			return;
		}

	}

	dojo._ioCancelAll = function(){
		//summary: Cancels all pending IO requests, regardless of IO type
		//(xhr, script, iframe).
		try{
			_d.forEach(_inFlight, function(i){
				try{
					i.dfd.cancel();
				}catch(e){/*squelch*/}
			});
		}catch(e){/*squelch*/}
	}

	//Automatically call cancel all io calls on unload
	//in IE for trac issue #2357.
	if(_d.isIE){
		_d.addOnWindowUnload(_d._ioCancelAll);
	}

	_d._ioWatch = function(/*Deferred*/dfd,
		/*Function*/validCheck,
		/*Function*/ioCheck,
		/*Function*/resHandle){
		//summary: watches the io request represented by dfd to see if it completes.
		//dfd:
		//		The Deferred object to watch.
		//validCheck:
		//		Function used to check if the IO request is still valid. Gets the dfd
		//		object as its only argument.
		//ioCheck:
		//		Function used to check if basic IO call worked. Gets the dfd
		//		object as its only argument.
		//resHandle:
		//		Function used to process response. Gets the dfd
		//		object as its only argument.
		if(dfd.ioArgs.args.timeout){
			dfd.startTime = (new Date()).getTime();
		}
		_inFlight.push({dfd: dfd, validCheck: validCheck, ioCheck: ioCheck, resHandle: resHandle});
		if(!_inFlightIntvl){
			_inFlightIntvl = setInterval(_watchInFlight, 50);
		}
		_watchInFlight(); // handle sync requests
	}

	var _defaultContentType = ""application/x-www-form-urlencoded"";

	var _validCheck = function(/*Deferred*/dfd){
		return dfd.ioArgs.xhr.readyState; //boolean
	}
	var _ioCheck = function(/*Deferred*/dfd){
		return 4 == dfd.ioArgs.xhr.readyState; //boolean
	}
	var _resHandle = function(/*Deferred*/dfd){
		var xhr = dfd.ioArgs.xhr;
		if(_d._isDocumentOk(xhr)){
			dfd.callback(dfd);
		}else{
			var err = new Error(""Unable to load "" + dfd.ioArgs.url + "" status:"" + xhr.status);
			err.status = xhr.status;
			err.responseText = xhr.responseText;
			dfd.errback(err);
		}
	}

	dojo._ioAddQueryToUrl = function(/*dojo.__IoCallbackArgs*/ioArgs){
		//summary: Adds query params discovered by the io deferred construction to the URL.
		//Only use this for operations which are fundamentally GET-type operations.
		if(ioArgs.query.length){
			ioArgs.url += (ioArgs.url.indexOf(""?"") == -1 ? ""?"" : ""&"") + ioArgs.query;
			ioArgs.query = null;
		}		
	}

	/*=====
	dojo.declare(""dojo.__XhrArgs"", dojo.__IoArgs, {
		constructor: function(){
			//	summary:
			//		In addition to the properties listed for the dojo._IoArgs type,
			//		the following properties are allowed for dojo.xhr* methods.
			//	handleAs: String?
			//		Acceptable values are: text (default), json, json-comment-optional,
			//		json-comment-filtered, javascript, xml
			//	sync: Boolean?
			//		false is default. Indicates whether the request should
			//		be a synchronous (blocking) request.
			//	headers: Object?
			//		Additional HTTP headers to send in the request.
			this.handleAs = handleAs;
			this.sync = sync;
			this.headers = headers;
		}
	});
	=====*/

	dojo.xhr = function(/*String*/ method, /*dojo.__XhrArgs*/ args, /*Boolean?*/ hasBody){
		//	summary:
		//		Sends an HTTP request with the given method.
		//	description:
		//		Sends an HTTP request with the given method.
		//		See also dojo.xhrGet(), xhrPost(), xhrPut() and dojo.xhrDelete() for shortcuts
		//		for those HTTP methods. There are also methods for ""raw"" PUT and POST methods
		//		via dojo.rawXhrPut() and dojo.rawXhrPost() respectively.
		//	method:
		//		HTTP method to be used, such as GET, POST, PUT, DELETE.  Should be uppercase.
		//	hasBody:
		//		If the request has an HTTP body, then pass true for hasBody.

		//Make the Deferred object for this xhr request.
		var dfd = _d._ioSetArgs(args, _deferredCancel, _deferredOk, _deferError);

		//Pass the args to _xhrObj, to allow xhr iframe proxy interceptions.
		dfd.ioArgs.xhr = _d._xhrObj(dfd.ioArgs.args);

		if(hasBody){
			if(""postData"" in args){
				dfd.ioArgs.query = args.postData;
			}else if(""putData"" in args){
				dfd.ioArgs.query = args.putData;
			}
		}else{
			_d._ioAddQueryToUrl(dfd.ioArgs);
		}

		// IE 6 is a steaming pile. It won't let you call apply() on the native function (xhr.open).
		// workaround for IE6's apply() ""issues""
		var ioArgs = dfd.ioArgs;
		var xhr = ioArgs.xhr;
		xhr.open(method, ioArgs.url, args.sync !== true, args.user || undefined, args.password || undefined);
		if(args.headers){
			for(var hdr in args.headers){
				if(hdr.toLowerCase() === ""content-type"" && !args.contentType){
					args.contentType = args.headers[hdr];
				}else{
					xhr.setRequestHeader(hdr, args.headers[hdr]);
				}
			}
		}
		// FIXME: is this appropriate for all content types?
		xhr.setRequestHeader(""Content-Type"", args.contentType || _defaultContentType);
		if(!args.headers || !args.headers[""X-Requested-With""]){
			xhr.setRequestHeader(""X-Requested-With"", ""XMLHttpRequest"");
		}
		// FIXME: set other headers here!
		if(dojo.config.isDebug){
			xhr.send(ioArgs.query);
		}else{
			try{
				xhr.send(ioArgs.query);
			}catch(e){
				dfd.ioArgs.error = e;
				dfd.cancel();
			}
		}
		_d._ioWatch(dfd, _validCheck, _ioCheck, _resHandle);
		xhr = null;
		return dfd; // dojo.Deferred
	}

	dojo.xhrGet = function(/*dojo.__XhrArgs*/ args){
		//	summary: 
		//		Sends an HTTP GET request to the server.
		return _d.xhr(""GET"", args); // dojo.Deferred
	}

	dojo.rawXhrPost = dojo.xhrPost = function(/*dojo.__XhrArgs*/ args){
		//	summary:
		//		Sends an HTTP POST request to the server. In addtion to the properties
		//		listed for the dojo.__XhrArgs type, the following property is allowed:
		//	postData:
		//		String. Send raw data in the body of the POST request.
		return _d.xhr(""POST"", args, true); // dojo.Deferred
	}

	dojo.rawXhrPut = dojo.xhrPut = function(/*dojo.__XhrArgs*/ args){
		//	summary:
		//		Sends an HTTP PUT request to the server. In addtion to the properties
		//		listed for the dojo.__XhrArgs type, the following property is allowed:
		//	putData:
		//		String. Send raw data in the body of the PUT request.
		return _d.xhr(""PUT"", args, true); // dojo.Deferred
	}

	dojo.xhrDelete = function(/*dojo.__XhrArgs*/ args){
		//	summary:
		//		Sends an HTTP DELETE request to the server.
		return _d.xhr(""DELETE"", args); //dojo.Deferred
	}

	/*
	dojo.wrapForm = function(formNode){
		//summary:
		//		A replacement for FormBind, but not implemented yet.

		// FIXME: need to think harder about what extensions to this we might
		// want. What should we allow folks to do w/ this? What events to
		// set/send?
		throw new Error(""dojo.wrapForm not yet implemented"");
	}
	*/
})();

}

if(!dojo._hasResource[""dojo._base.fx""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.fx""] = true;
dojo.provide(""dojo._base.fx"");






/*
	Animation losely package based on Dan Pupius' work, contributed under CLA: 
		http://pupius.co.uk/js/Toolkit.Drawing.js
*/
(function(){ 

	var d = dojo;
	
	dojo._Line = function(/*int*/ start, /*int*/ end){
		//	summary:
		//		dojo._Line is the object used to generate values from a start value
		//		to an end value
		//	start: int
		//		Beginning value for range
		//	end: int
		//		Ending value for range
		this.start = start;
		this.end = end;
		this.getValue = function(/*float*/ n){
			//	summary: returns the point on the line
			//	n: a floating point number greater than 0 and less than 1
			return ((this.end - this.start) * n) + this.start; // Decimal
		}
	}
	
	d.declare(""dojo._Animation"", null, {
		//	summary
		//		A generic animation class that fires callbacks into its handlers
		//		object at various states. Nearly all dojo animation functions
		//		return an instance of this method, usually without calling the
		//		.play() method beforehand. Therefore, you will likely need to
		//		call .play() on instances of dojo._Animation when one is
		//		returned.
		constructor: function(/*Object*/ args){
			d.mixin(this, args);
			if(d.isArray(this.curve)){
				/* curve: Array
					pId: a */
				this.curve = new d._Line(this.curve[0], this.curve[1]);
			}
		},
		
		// duration: Integer
		//	The time in milliseonds the animation will take to run
		duration: 350,
	
	/*=====
		// curve: dojo._Line||Array
		//	A two element array of start and end values, or a dojo._Line instance to be
		//	used in the Animation. 
		curve: null,
	
		// easing: Function
		//	A Function to adjust the acceleration (or deceleration) of the progress 
		//	across a dojo._Line
		easing: null,
	=====*/
	
		// repeat: Integer
		//	The number of times to loop the animation
		repeat: 0,
	
		// rate: Integer
		//	the time in milliseconds to wait before advancing to next frame 
		//	(used as a fps timer: rate/1000 = fps)
		rate: 10 /* 100 fps */,
	
	/*===== 
		// delay: Integer
		// 	The time in milliseconds to wait before starting animation after it has been .play()'ed
		delay: null,
	
		// events
		//
		// beforeBegin: Event
		//	Synthetic event fired before a dojo._Animation begins playing (synchronous)
		beforeBegin: null,
	
		// onBegin: Event
		//	Synthetic event fired as a dojo._Animation begins playing (useful?)
		onBegin: null,
	
		// onAnimate: Event
		//	Synthetic event fired at each interval of a dojo._Animation
		onAnimate: null,
	
		// onEnd: Event
		//	Synthetic event fired after the final frame of a dojo._Animation
		onEnd: null,
	
		// onPlay: Event
		//	Synthetic event fired any time a dojo._Animation is play()'ed
		onPlay: null,
	
		// onPause: Event
		//	Synthetic event fired when a dojo._Animation is paused
		onPause: null,
	
		// onStop: Event
		//	Synthetic event fires when a dojo._Animation is stopped
		onStop: null,
	
	=====*/
	
		_percent: 0,
		_startRepeatCount: 0,
	
		_fire: function(/*Event*/ evt, /*Array?*/ args){
			//	summary:
			//		Convenience function.  Fire event ""evt"" and pass it the
			//		arguments specified in ""args"".
			//	evt:
			//		The event to fire.
			//	args:
			//		The arguments to pass to the event.
			if(this[evt]){
				if(dojo.config.isDebug){
					this[evt].apply(this, args||[]);
				}else{
					try{
						this[evt].apply(this, args||[]);
					}catch(e){
						// squelch and log because we shouldn't allow exceptions in
						// synthetic event handlers to cause the internal timer to run
						// amuck, potentially pegging the CPU. I'm not a fan of this
						// squelch, but hopefully logging will make it clear what's
						// going on
						console.error(""exception in animation handler for:"", evt);
						console.error(e);
					}
				}
			}
			return this; // dojo._Animation
		},

		play: function(/*int?*/ delay, /*Boolean?*/ gotoStart){
			// summary:
			//		Start the animation.
			// delay:
			//		How many milliseconds to delay before starting.
			// gotoStart:
			//		If true, starts the animation from the beginning; otherwise,
			//		starts it from its current position.
			var _t = this;
			if(gotoStart){
				_t._stopTimer();
				_t._active = _t._paused = false;
				_t._percent = 0;
			}else if(_t._active && !_t._paused){
				return _t; // dojo._Animation
			}
	
			_t._fire(""beforeBegin"");
	
			var de = delay||_t.delay;
			var _p = dojo.hitch(_t, ""_play"", gotoStart);
			if(de > 0){
				setTimeout(_p, de);
				return _t; // dojo._Animation
			}
			_p();
			return _t;
		},
	
		_play: function(gotoStart){
			var _t = this;
			_t._startTime = new Date().valueOf();
			if(_t._paused){
				_t._startTime -= _t.duration * _t._percent;
			}
			_t._endTime = _t._startTime + _t.duration;
	
			_t._active = true;
			_t._paused = false;
	
			var value = _t.curve.getValue(_t._percent);
			if(!_t._percent){
				if(!_t._startRepeatCount){
					_t._startRepeatCount = _t.repeat;
				}
				_t._fire(""onBegin"", [value]);
			}
	
			_t._fire(""onPlay"", [value]);
	
			_t._cycle();
			return _t; // dojo._Animation
		},
	
		pause: function(){
			// summary: Pauses a running animation.
			this._stopTimer();
			if(!this._active){ return this; /*dojo._Animation*/ }
			this._paused = true;
			this._fire(""onPause"", [this.curve.getValue(this._percent)]);
			return this; // dojo._Animation
		},
	
		gotoPercent: function(/*Decimal*/ percent, /*Boolean?*/ andPlay){
			//	summary:
			//		Sets the progress of the animation.
			//	percent:
			//		A percentage in decimal notation (between and including 0.0 and 1.0).
			//	andPlay:
			//		If true, play the animation after setting the progress.
			this._stopTimer();
			this._active = this._paused = true;
			this._percent = percent;
			if(andPlay){ this.play(); }
			return this; // dojo._Animation
		},
	
		stop: function(/*boolean?*/ gotoEnd){
			// summary: Stops a running animation.
			// gotoEnd: If true, the animation will end.
			if(!this._timer){ return this; /* dojo._Animation */ }
			this._stopTimer();
			if(gotoEnd){
				this._percent = 1;
			}
			this._fire(""onStop"", [this.curve.getValue(this._percent)]);
			this._active = this._paused = false;
			return this; // dojo._Animation
		},
	
		status: function(){
			// summary: Returns a string token representation of the status of
			//			the animation, one of: ""paused"", ""playing"", ""stopped""
			if(this._active){
				return this._paused ? ""paused"" : ""playing""; // String
			}
			return ""stopped""; // String
		},
	
		_cycle: function(){
			var _t = this;
			if(_t._active){
				var curr = new Date().valueOf();
				var step = (curr - _t._startTime) / (_t._endTime - _t._startTime);
	
				if(step >= 1){
					step = 1;
				}
				_t._percent = step;
	
				// Perform easing
				if(_t.easing){
					step = _t.easing(step);
				}
	
				_t._fire(""onAnimate"", [_t.curve.getValue(step)]);
	
				if(_t._percent < 1){
					_t._startTimer();
				}else{
					_t._active = false;
	
					if(_t.repeat > 0){
						_t.repeat--;
						_t.play(null, true);
					}else if(_t.repeat == -1){
						_t.play(null, true);
					}else{
						if(_t._startRepeatCount){
							_t.repeat = _t._startRepeatCount;
							_t._startRepeatCount = 0;
						}
					}
					_t._percent = 0;
					_t._fire(""onEnd"");
					_t._stopTimer();
				}
			}
			return _t; // dojo._Animation
		}
	});

	var ctr = 0;
	var _globalTimerList = [];
	var runner = {
		run: function(){ }
	};
	var timer = null;
	dojo._Animation.prototype._startTimer = function(){
		// this._timer = setTimeout(dojo.hitch(this, ""_cycle""), this.rate);
		if(!this._timer){
			this._timer = d.connect(runner, ""run"", this, ""_cycle"");
			ctr++;
		}
		if(!timer){
			timer = setInterval(d.hitch(runner, ""run""), this.rate);
		}
	};

	dojo._Animation.prototype._stopTimer = function(){
		if(this._timer){
			d.disconnect(this._timer);
			this._timer = null;
			ctr--;
		}
		if(ctr <= 0){
			clearInterval(timer);
			timer = null;
			ctr = 0;
		}
	};

	var _makeFadeable = (d.isIE) ? function(node){
		// only set the zoom if the ""tickle"" value would be the same as the
		// default
		var ns = node.style;
		// don't set the width to auto if it didn't already cascade that way.
		// We don't want to f anyones designs
		if(!ns.width.length && d.style(node, ""width"") == ""auto""){
			ns.width = ""auto"";
		}
	} : function(){};

	dojo._fade = function(/*Object*/ args){
		//	summary: 
		//		Returns an animation that will fade the node defined by
		//		args.node from the start to end values passed (args.start
		//		args.end) (end is mandatory, start is optional)

		args.node = d.byId(args.node);
		var fArgs = d.mixin({ properties: {} }, args);
		var props = (fArgs.properties.opacity = {});
		props.start = !(""start"" in fArgs) ?
			function(){ 
				return Number(d.style(fArgs.node, ""opacity"")); 
			} : fArgs.start;
		props.end = fArgs.end;

		var anim = d.animateProperty(fArgs);
		d.connect(anim, ""beforeBegin"", d.partial(_makeFadeable, fArgs.node));

		return anim; // dojo._Animation
	}

	/*=====
	dojo.__FadeArgs = function(node, duration, easing){
		// 	node: DOMNode|String
		//		The node referenced in the animation
		//	duration: Integer?
		//		Duration of the animation in milliseconds.
		//	easing: Function?
		//		An easing function.
		this.node = node;
		this.duration = duration;
		this.easing = easing;
	}
	=====*/

	dojo.fadeIn = function(/*dojo.__FadeArgs*/ args){
		// summary: 
		//		Returns an animation that will fade node defined in 'args' from
		//		its current opacity to fully opaque.
		return d._fade(d.mixin({ end: 1 }, args)); // dojo._Animation
	}

	dojo.fadeOut = function(/*dojo.__FadeArgs*/  args){
		// summary: 
		//		Returns an animation that will fade node defined in 'args'
		//		from its current opacity to fully transparent.
		return d._fade(d.mixin({ end: 0 }, args)); // dojo._Animation
	}

	dojo._defaultEasing = function(/*Decimal?*/ n){
		// summary: The default easing function for dojo._Animation(s)
		return 0.5 + ((Math.sin((n + 1.5) * Math.PI))/2);
	}

	var PropLine = function(properties){
		// PropLine is an internal class which is used to model the values of
		// an a group of CSS properties across an animation lifecycle. In
		// particular, the ""getValue"" function handles getting interpolated
		// values between start and end for a particular CSS value.
		this._properties = properties;
		for(var p in properties){
			var prop = properties[p];
			if(prop.start instanceof d.Color){
				// create a reusable temp color object to keep intermediate results
				prop.tempColor = new d.Color();
			}
		}
		this.getValue = function(r){
			var ret = {};
			for(var p in this._properties){
				var prop = this._properties[p];
				var start = prop.start;
				if(start instanceof d.Color){
					ret[p] = d.blendColors(start, prop.end, r, prop.tempColor).toCss();
				}else if(!d.isArray(start)){
					ret[p] = ((prop.end - start) * r) + start + (p != ""opacity"" ? prop.units||""px"" : """");
				}
			}
			return ret;
		}
	}

	/*=====
	dojo.declare(""dojo.__AnimArgs"", [dojo.__FadeArgs], {
		// Properties: Object?
		//	A hash map of style properties to Objects describing the transition,
		//	such as the properties of dojo._Line with an additional 'unit' property
		properties: {}
		
		//TODOC: add event callbacks
	});
	=====*/

	dojo.animateProperty = function(/*dojo.__AnimArgs*/ args){
		//	summary: 
		//		Returns an animation that will transition the properties of
		//		node defined in 'args' depending how they are defined in
		//		'args.properties'
		//
		// description:
		//		dojo.animateProperty is the foundation of most dojo.fx
		//		animations. It takes an object of ""properties"" corresponding to
		//		style properties, and animates them in parallel over a set
		//		duration.
		//	
		// 	example:
		//		A simple animation that changes the width of the specified node.
		//	|	dojo.animateProperty({ 
		//	|		node: ""nodeId"",
		//	|		properties: { width: 400 },
		//	|	}).play();
		//		Dojo figures out the start value for the width and converts the
		//		integer specified for the width to the more expressive but
		//		verbose form `{ width: { end: '400', units: 'px' } }` which you
		//		can also specify directly
		//
		// 	example:
		//		Animate width, height, and padding over 2 seconds... the
		//		pedantic way:
		//	|	dojo.animateProperty({ node: node, duration:2000,
		//	|		properties: {
		//	|			width: { start: '200', end: '400', unit:""px"" },
		//	|			height: { start:'200', end: '400', unit:""px"" },
		//	|			paddingTop: { start:'5', end:'50', unit:""px"" } 
		//	|		}
		//	|	}).play();
		//		Note 'paddingTop' is used over 'padding-top'. Multi-name CSS properties
		//		are written using ""mixed case"", as the hyphen is illegal as an object key.
		//		
		// 	example:
		//		Plug in a different easing function and register a callback for
		//		when the animation ends. Easing functions accept values between
		//		zero and one and return a value on that basis. In this case, an
		//		exponential-in curve.
		//	|	dojo.animateProperty({ 
		//	|		node: ""nodeId"",
		//	|		// dojo figures out the start value
		//	|		properties: { width: { end: 400 } },
		//	|		easing: function(n){
		//	|			return (n==0) ? 0 : Math.pow(2, 10 * (n - 1));
		//	|		},
		//	|		onEnd: function(){
		//	|			// called when the animation finishes
		//	|		}
		//	|	}).play(500); // delay playing half a second
		//
		//	example:
		//		Like all `dojo._Animation`s, animateProperty returns a handle to the
		//		Animation instance, which fires the events common to Dojo FX. Use `dojo.connect`
		//		to access these events outside of the Animation definiton:
		//	|	var anim = dojo.animateProperty({
		//	|		node:""someId"",
		//	|		properties:{
		//	|			width:400, height:500
		//	|		}
		//	|	});
		//	|	dojo.connect(anim,""onEnd"", function(){
		//	|		
		//	|	});
		//	|	// play the animation now:
		//	|	anim.play();
		
		args.node = d.byId(args.node);
		if(!args.easing){ args.easing = d._defaultEasing; }

		var anim = new d._Animation(args);
		d.connect(anim, ""beforeBegin"", anim, function(){
			var pm = {};
			for(var p in this.properties){
				// Make shallow copy of properties into pm because we overwrite
				// some values below. In particular if start/end are functions
				// we don't want to overwrite them or the functions won't be
				// called if the animation is reused.
				if(p == ""width"" || p == ""height""){
					this.node.display = ""block"";
				}
				var prop = this.properties[p];
				prop = pm[p] = d.mixin({}, (d.isObject(prop) ? prop: { end: prop }));

				if(d.isFunction(prop.start)){
					prop.start = prop.start();
				}
				if(d.isFunction(prop.end)){
					prop.end = prop.end();
				}
				var isColor = (p.toLowerCase().indexOf(""color"") >= 0);
				function getStyle(node, p){
					// dojo.style(node, ""height"") can return ""auto"" or """" on IE; this is more reliable:
					var v = ({height: node.offsetHeight, width: node.offsetWidth})[p];
					if(v !== undefined){ return v; }
					v = d.style(node, p);
					return (p==""opacity"") ? Number(v) : (isColor ? v : parseFloat(v));
				}
				if(!(""end"" in prop)){
					prop.end = getStyle(this.node, p);
				}else if(!(""start"" in prop)){
					prop.start = getStyle(this.node, p);
				}

				if(isColor){
					prop.start = new d.Color(prop.start);
					prop.end = new d.Color(prop.end);
				}else{
					prop.start = (p == ""opacity"") ? Number(prop.start) : parseFloat(prop.start);
				}
			}
			this.curve = new PropLine(pm);
		});
		d.connect(anim, ""onAnimate"", d.hitch(d, ""style"", anim.node));
		return anim; // dojo._Animation
	}

	dojo.anim = function(	/*DOMNode|String*/ 	node, 
							/*Object*/ 			properties, 
							/*Integer?*/		duration, 
							/*Function?*/		easing, 
							/*Function?*/		onEnd,
							/*Integer?*/		delay){
		//	summary:
		//		A simpler interface to `dojo.animateProperty()`, also returns
		//		an instance of `dojo._Animation` but begins the animation
		//		immediately, unlike nearly every other Dojo animation API.
		//	description:
		//		`dojo.anim` is a simpler (but somewhat less powerful) version
		//		of `dojo.animateProperty`.  It uses defaults for many basic properties
		//		and allows for positional parameters to be used in place of the
		//		packed ""property bag"" which is used for other Dojo animation
		//		methods.
		//
		//		The `dojo._Animation` object returned from `dojo.anim` will be
		//		already playing when it is returned from this function, so
		//		calling play() on it again is (usually) a no-op.
		//	node:
		//		a DOM node or the id of a node to animate CSS properties on
		//	duration:
		//		The number of milliseconds over which the animation
		//		should run. Defaults to the global animation default duration
		//		(350ms).
		//	easing:
		//		An easing function over which to calculate acceleration
		//		and deceleration of the animation through its duration.
		//		A default easing algorithm is provided, but you may
		//		plug in any you wish. A large selection of easing algorithms
		//		are available in `dojo.fx.easing`.
		//	onEnd:
		//		A function to be called when the animation finishes
		//		running.
		//	delay:
		//		The number of milliseconds to delay beginning the
		//		animation by. The default is 0.
		//	example:
		//		Fade out a node
		//	|	dojo.anim(""id"", { opacity: 0 });
		//	example:
		//		Fade out a node over a full second
		//	|	dojo.anim(""id"", { opacity: 0 }, 1000);
		return d.animateProperty({ 
			node: node,
			duration: duration||d._Animation.prototype.duration,
			properties: properties,
			easing: easing,
			onEnd: onEnd 
		}).play(delay||0);
	}
})();

}

if(!dojo._hasResource[""dojo._base.browser""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.browser""] = true;
dojo.provide(""dojo._base.browser"");









//Need this to be the last code segment in base, so do not place any
//dojo.requireIf calls in this file. Otherwise, due to how the build system
//puts all requireIf dependencies after the current file, the require calls
//could be called before all of base is defined.
if(dojo.config.require){
	dojo.forEach(dojo.config.require, ""dojo['require'](item);"");
}

}

	//INSERT dojo.i18n._preloadLocalizations HERE

	if(dojo.config.afterOnLoad && dojo.isBrowser){
		//Dojo is being added to the page after page load, so just trigger
		//the init sequence after a timeout. Using a timeout so the rest of this
		//script gets evaluated properly. This work needs to happen after the
		//dojo.config.require work done in dojo._base.
		window.setTimeout(dojo._fakeLoadInit, 1000);
	}

})();

",False,
16,16,NomosTestfiles/AFL/AFL-2.1.txt,AFL-2.1,"The Academic Free License 
v.2.1 

This Academic Free License (the ""License"") applies to any original work of authorship (the ""Original Work"") whose owner (the ""Licensor"") has placed the following notice immediately following the copyright notice for the Original Work:

Licensed under the Academic Free License version 2.1  

1) Grant of Copyright License. Licensor hereby grants You a world-wide, royalty-free, non-exclusive, perpetual, sublicenseable license to do the following: 

	a) to reproduce the Original Work in copies; 

	b) to prepare derivative works (""Derivative Works"") based upon the Original Work;

 	c) to distribute copies of the Original Work and Derivative Works to the public; 

	d) to perform the Original Work publicly; and

 	e) to display the Original Work publicly. 

2) Grant of Patent License. Licensor hereby grants You a world-wide, royalty-free, non-exclusive, perpetual, sublicenseable license, under patent claims owned or controlled by the Licensor that are embodied in the Original Work as furnished by the Licensor, to make, use, sell and offer for sale the Original Work and Derivative Works. 

3) Grant of Source Code License. The term ""Source Code"" means the preferred form of the Original Work for making modifications to it and all available documentation describing how to modify the Original Work. Licensor hereby agrees to provide a machine-readable copy of the Source Code of the Original Work along with each copy of the Original Work that Licensor distributes. Licensor reserves the right to satisfy this obligation by placing a machine-readable copy of the Source Code in an information repository reasonably calculated to permit inexpensive and convenient access by You for as long as Licensor continues to distribute the Original Work, and by publishing the address of that information repository in a notice immediately following the copyright notice that applies to the Original Work. 

4) Exclusions From License Grant. Neither the names of Licensor, nor the names of any contributors to the Original Work, nor any of their trademarks or service marks, may be used to endorse or promote products derived from this Original Work without express prior written permission of the Licensor. Nothing in this License shall be deemed to grant any rights to trademarks, copyrights, patents, trade secrets or any other intellectual property of Licensor except as expressly stated herein. No patent license is granted to make, use, sell or offer to sell embodiments of any patent claims other than the licensed claims defined in Section 2. No right is granted to the trademarks of Licensor even if such marks are included in the Original Work. Nothing in this License shall be interpreted to prohibit Licensor from licensing under different terms from this License any Original Work that Licensor otherwise would have a right to license. 

5) This section intentionally omitted. 

6) Attribution Rights. You must retain, in the Source Code of any Derivative Works that You create, all copyright, patent or trademark notices from the Source Code of the Original Work, as well as any notices of licensing and any descriptive text identified therein as an ""Attribution Notice."" You must cause the Source Code for any Derivative Works that You create to carry a prominent Attribution Notice reasonably calculated to inform recipients that You have modified the Original Work. 

7) Warranty of Provenance and Disclaimer of Warranty. Licensor warrants that the copyright in and to the Original Work and the patent rights granted herein by Licensor are owned by the Licensor or are sublicensed to You under the terms of this License with the permission of the contributor(s) of those copyrights and patent rights. Except as expressly stated in the immediately proceeding sentence, the Original Work is provided under this License on an ""AS IS"" BASIS and WITHOUT WARRANTY, either express or implied, including, without limitation, the warranties of NON-INFRINGEMENT, MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY OF THE ORIGINAL WORK IS WITH YOU. This DISCLAIMER OF WARRANTY constitutes an essential part of this License. No license to Original Work is granted hereunder except under this disclaimer. 

8) Limitation of Liability. Under no circumstances and under no legal theory, whether in tort (including negligence), contract, or otherwise, shall the Licensor be liable to any person for any direct, indirect, special, incidental, or consequential damages of any character arising as a result of this License or the use of the Original Work including, without limitation, damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses. This limitation of liability shall not apply to liability for death or personal injury resulting from Licensor's negligence to the extent applicable law prohibits such limitation. Some jurisdictions do not allow the exclusion or limitation of incidental or consequential damages, so this exclusion and limitation may not apply to You.

 9) Acceptance and Termination. If You distribute copies of the Original Work or a Derivative Work, You must make a reasonable effort under the circumstances to obtain the express assent of recipients to the terms of this License. Nothing else but this License (or another written agreement between Licensor and You) grants You permission to create Derivative Works based upon the Original Work or to exercise any of the rights granted in Section 1 herein, and any attempt to do so except under the terms of this License (or another written agreement between Licensor and You) is expressly prohibited by U.S. copyright law, the equivalent laws of other countries, and by international treaty. Therefore, by exercising any of the rights granted to You in Section 1 herein, You indicate Your acceptance of this License and all of its terms and conditions. 

10) Termination for Patent Action. This License shall terminate automatically and You may no longer exercise any of the rights granted to You by this License as of the date You commence an action, including a cross-claim or counterclaim, against Licensor or any licensee alleging that the Original Work infringes a patent. This termination provision shall not apply for an action alleging patent infringement by combinations of the Original Work with other software or hardware. 

11) Jurisdiction, Venue and Governing Law. Any action or suit relating to this License may be brought only in the courts of a jurisdiction wherein the Licensor resides or in which Licensor conducts its primary business, and under the laws of that jurisdiction excluding its conflict-of-law provisions. The application of the United Nations Convention on Contracts for the International Sale of Goods is expressly excluded. Any use of the Original Work outside the scope of this License or after its termination shall be subject to the requirements and penalties of the U.S. Copyright Act, 17 U.S.C. § 101 et seq., the equivalent laws of other countries, and international treaty. This section shall survive the termination of this License. 

12) Attorneys Fees. In any action to enforce the terms of this License or seeking damages relating thereto, the prevailing party shall be entitled to recover its costs and expenses, including, without limitation, reasonable attorneys' fees and costs incurred in connection with such action, including any appeal of such action. This section shall survive the termination of this License. 

13) Miscellaneous. This License represents the complete agreement concerning the subject matter hereof. If any provision of this License is held to be unenforceable, such provision shall be reformed only to the extent necessary to make it enforceable. 

14) Definition of ""You"" in This License. ""You"" throughout this License, whether in upper or lower case, means an individual or a legal entity exercising rights under, and complying with all of the terms of, this License. For legal entities, ""You"" includes any entity that controls, is controlled by, or is under common control with you. For purposes of this definition, ""control"" means (i) the power, direct or indirect, to cause the direction or management of such entity, whether by contract or otherwise, or (ii) ownership of fifty percent (50%) or more of the outstanding shares, or (iii) beneficial ownership of such entity. 

15) Right to Use. You may use the Original Work in all ways not otherwise restricted or conditioned by this License or by law, and Licensor promises not to interfere with or be responsible for such uses by You. 

This license is Copyright (C) 2003-2004 Lawrence E. Rosen. All rights reserved. Permission is hereby granted to copy and distribute this license without modification. This license may not be modified without the express written permission of its copyright owner.
",False,"```
The Academic Free License 
v.2.1 

This Academic Free License (the ""License"") applies to any original work of authorship (the ""Original Work"") whose owner (the ""Licensor"") has placed the following notice immediately following the copyright notice for the Original Work:

Licensed under the Academic Free License version 2.1  

1) Grant of Copyright License. Licensor hereby grants You a world-wide, royalty-free, non-exclusive, perpetual, sublicenseable license to do the following: 

	a) to reproduce the Original Work in copies; 

	b) to prepare derivative works (""Derivative Works"") based upon the Original Work;

 	c) to distribute copies of the Original Work and Derivative Works to the public; 

	d) to perform the Original Work publicly; and

 	e) to display the Original Work publicly. 

2) Grant of Patent License. Licensor hereby grants You a world-wide, royalty-free, non-exclusive, perpetual, sublicenseable license, under patent claims owned or controlled by the Licensor that are embodied in the Original Work as furnished by the Licensor, to make, use, sell and offer for sale the Original Work and Derivative Works. 

3) Grant of Source Code License. The term ""Source Code"" means the preferred form of the Original Work for making modifications to it and all available documentation describing how to modify the Original Work. Licensor hereby agrees to provide a machine-readable copy of the Source Code of the Original Work along with each copy of the Original Work that Licensor distributes. Licensor reserves the right to satisfy this obligation by placing a machine-readable copy of the Source Code in an information repository reasonably calculated to permit inexpensive and convenient access by You for as long as Licensor continues to distribute the Original Work, and by publishing the address of that information repository in a notice immediately following the copyright notice that applies to the Original Work. 

4) Exclusions From License Grant. Neither the names of Licensor, nor the names of any contributors to the Original Work, nor any of their trademarks or service marks, may be used to endorse or promote products derived from this Original Work without express prior written permission of the Licensor. Nothing in this License shall be deemed to grant any rights to trademarks, copyrights, patents, trade secrets or any other intellectual property of Licensor except as expressly stated herein. No patent license is granted to make, use, sell or offer to sell embodiments of any patent claims other than the licensed claims defined in Section 2. No right is granted to the trademarks of Licensor even if such marks are included in the Original Work. Nothing in this License shall be interpreted to prohibit Licensor from licensing under different terms from this License any Original Work that Licensor otherwise would have a right to license. 

5) This section intentionally omitted. 

6) Attribution Rights. You must retain, in the Source Code of any Derivative Works that You create, all copyright, patent or trademark notices from the Source Code of the Original Work, as well as any notices of licensing and any descriptive text identified therein as an ""Attribution Notice."" You must cause the Source Code for any Derivative Works that You create to carry a prominent Attribution Notice reasonably calculated to inform recipients that You have modified the Original Work. 

7) Warranty of Provenance and Disclaimer of Warranty. Licensor warrants that the copyright in and to the Original Work and the patent rights granted herein by Licensor are owned by the Licensor or are sublicensed to You under the terms of this License with the permission of the contributor(s) of those copyrights and patent rights. Except as expressly stated in the immediately proceeding sentence, the Original Work is provided under this License on an ""AS IS"" BASIS and WITHOUT WARRANTY, either express or implied, including, without limitation, the warranties of NON-INFRINGEMENT, MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY OF THE ORIGINAL WORK IS WITH YOU. This DISCLAIMER OF WARRANTY constitutes an essential part of this License. No license to Original Work is granted hereunder except under this disclaimer. 

8) Limitation of Liability. Under no circumstances and under no legal theory, whether in tort (including negligence), contract, or otherwise, shall the Licensor be liable to any person for any direct, indirect, special, incidental, or consequential damages of any character arising as a result of this License or the use of the Original Work including, without limitation, damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses. This limitation of liability shall not apply to liability for death or personal injury resulting from Licensor's negligence to the extent applicable law prohibits such limitation. Some jurisdictions do not allow the exclusion or limitation of incidental or consequential damages, so this exclusion and limitation may not apply to You.

 9) Acceptance and Termination. If You distribute copies of the Original Work or a Derivative Work, You must make a reasonable effort under the circumstances to obtain the express assent of recipients to the terms of this License. Nothing else but this License (or another written agreement between Licensor and You) grants You permission to create Derivative Works based upon the Original Work or to exercise any of the rights granted in Section 1 herein, and any attempt to do so except under the terms of this License (or another written agreement between Licensor and You) is expressly prohibited by U.S. copyright law, the equivalent laws of other countries, and by international treaty. Therefore, by exercising any of the rights granted to You in Section 1 herein, You indicate Your acceptance of this License and all of its terms and conditions. 

10) Termination for Patent Action. This License shall terminate automatically and You may no longer exercise any of the rights granted to You by this License as of the date You commence an action, including a cross-claim or counterclaim, against Licensor or any licensee alleging that the Original Work infringes a patent. This termination provision shall not apply for an action alleging patent infringement by combinations of the Original Work with other software or hardware. 

11) Jurisdiction, Venue and Governing Law. Any action or suit relating to this License may be brought only in the courts of a jurisdiction wherein the Licensor resides or in which Licensor conducts its primary business, and under the laws of that jurisdiction excluding its conflict-of-law provisions. The application of the United Nations Convention on Contracts for the International Sale of Goods is expressly excluded. Any use of the Original Work outside the scope of this License or after its termination shall be subject to the requirements and penalties of the U.S. Copyright Act, 17 U.S.C. § 101 et seq., the equivalent laws of other countries, and international treaty. This section shall survive the termination of this License. 

12) Attorneys Fees. In any action to enforce the terms of this License or seeking damages relating thereto, the prevailing party shall be entitled to recover its costs and expenses, including, without limitation, reasonable attorneys' fees and costs incurred in connection with such action, including any appeal of such action. This section shall survive the termination of this License. 

13) Miscellaneous. This License represents the complete agreement concerning the subject matter hereof. If any provision of this License is held to be unenforceable, such provision shall be reformed only to the extent necessary to make it enforceable. 

14) Definition of ""You"" in This License. ""You"" throughout this License, whether in upper or lower case, means an individual or a legal entity exercising rights under, and complying with all of the terms of, this License. For legal entities, ""You"" includes any entity that controls, is controlled by, or is under common control with you. For purposes of this definition, ""control"" means (i) the power, direct or indirect, to cause the direction or management of such entity, whether by contract or otherwise, or (ii) ownership of fifty percent (50%) or more of the outstanding shares, or (iii) beneficial ownership of such entity. 

15) Right to Use. You may use the Original Work in all ways not otherwise restricted or conditioned by this License or by law, and Licensor promises not to interfere with or be responsible for such uses by You. 

This license is Copyright (C) 2003-2004 Lawrence E. Rosen. All rights reserved. Permission is hereby granted to copy and distribute this license without modification. This license may not be modified without the express written permission of its copyright owner.```"
17,17,NomosTestfiles/AFL/AFL-3.0.txt,AFL-3.0,"Academic Free License (“AFL”) v. 3.0 

This Academic Free License (the ""License"") applies to any original work of authorship (the ""Original Work"") whose owner (the ""Licensor"") has placed the following licensing notice adjacent to the copyright notice for the Original Work:
Licensed under the Academic Free License version 3.0  

1) Grant of Copyright License. Licensor grants You a worldwide, royalty-free, non-exclusive, sublicensable license, for the duration of the copyright, to do the following:
 	
	a) to reproduce the Original Work in copies, either alone or as part of a collective work; 

	b) to translate, adapt, alter, transform, modify, or arrange the Original Work, thereby creating derivative works (""Derivative Works"") based upon the Original Work; 

	c) to distribute or communicate copies of the Original Work and Derivative Works to the public, under any license of your choice that does not contradict the terms and conditions, including Licensor’s reserved rights and remedies, in this Academic Free License;
 
	d) to perform the Original Work publicly; and
 
	e) to display the Original Work publicly. 

2) Grant of Patent License. Licensor grants You a worldwide, royalty-free, non-exclusive, sublicensable license, under patent claims owned or controlled by the Licensor that are embodied in the Original Work as furnished by the Licensor, for the duration of the patents, to make, use, sell, offer for sale, have made, and import the Original Work and Derivative Works. 

3) Grant of Source Code License. The term ""Source Code"" means the preferred form of the Original Work for making modifications to it and all available documentation describing how to modify the Original Work. Licensor agrees to provide a machine-readable copy of the Source Code of the Original Work along with each copy of the Original Work that Licensor distributes. Licensor reserves the right to satisfy this obligation by placing a machine-readable copy of the Source Code in an information repository reasonably calculated to permit inexpensive and convenient access by You for as long as Licensor continues to distribute the Original Work.

 4) Exclusions From License Grant. Neither the names of Licensor, nor the names of any contributors to the Original Work, nor any of their trademarks or service marks, may be used to endorse or promote products derived from this Original Work without express prior permission of the Licensor. Except as expressly stated herein, nothing in this License grants any license to Licensor’s trademarks, copyrights, patents, trade secrets or any other intellectual property. No patent license is granted to make, use, sell, offer for sale, have made, or import embodiments of any patent claims other than the licensed claims defined in Section 2. No license is granted to the trademarks of Licensor even if such marks are included in the Original Work. Nothing in this License shall be interpreted to prohibit Licensor from licensing under terms different from this License any Original Work that Licensor otherwise would have a right to license. 

5) External Deployment. The term ""External Deployment"" means the use, distribution, or communication of the Original Work or Derivative Works in any way such that the Original Work or Derivative Works may be used by anyone other than You, whether those works are distributed or communicated to those persons or made available as an application intended for use over a network. As an express condition for the grants of license hereunder, You must treat any External Deployment by You of the Original Work or a Derivative Work as a distribution under section 1(c). 

6) Attribution Rights. You must retain, in the Source Code of any Derivative Works that You create, all copyright, patent, or trademark notices from the Source Code of the Original Work, as well as any notices of licensing and any descriptive text identified therein as an ""Attribution Notice."" You must cause the Source Code for any Derivative Works that You create to carry a prominent Attribution Notice reasonably calculated to inform recipients that You have modified the Original Work. 

7) Warranty of Provenance and Disclaimer of Warranty. Licensor warrants that the copyright in and to the Original Work and the patent rights granted herein by Licensor are owned by the Licensor or are sublicensed to You under the terms of this License with the permission of the contributor(s) of those copyrights and patent rights. Except as expressly stated in the immediately preceding sentence, the Original Work is provided under this License on an ""AS IS"" BASIS and WITHOUT WARRANTY, either express or implied, including, without limitation, the warranties of non-infringement, merchantability or fitness for a particular purpose. THE ENTIRE RISK AS TO THE QUALITY OF THE ORIGINAL WORK IS WITH YOU. This DISCLAIMER OF WARRANTY constitutes an essential part of this License. No license to the Original Work is granted by this License except under this disclaimer.

8) Limitation of Liability. Under no circumstances and under no legal theory, whether in tort (including negligence), contract, or otherwise, shall the Licensor be liable to anyone for any indirect, special, incidental, or consequential damages of any character arising as a result of this License or the use of the Original Work including, without limitation, damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses. This limitation of liability shall not apply to the extent applicable law prohibits such limitation. 

9) Acceptance and Termination. If, at any time, You expressly assented to this License, that assent indicates your clear and irrevocable acceptance of this License and all of its terms and conditions. If You distribute or communicate copies of the Original Work or a Derivative Work, You must make a reasonable effort under the circumstances to obtain the express assent of recipients to the terms of this License. This License conditions your rights to undertake the activities listed in Section 1, including your right to create Derivative Works based upon the Original Work, and doing so without honoring these terms and conditions is prohibited by copyright law and international treaty. Nothing in this License is intended to affect copyright exceptions and limitations (including “fair use” or “fair dealing”). This License shall terminate immediately and You may no longer exercise any of the rights granted to You by this License upon your failure to honor the conditions in Section 1(c). 

10) Termination for Patent Action. This License shall terminate automatically and You may no longer exercise any of the rights granted to You by this License as of the date You commence an action, including a cross-claim or counterclaim, against Licensor or any licensee alleging that the Original Work infringes a patent. This termination provision shall not apply for an action alleging patent infringement by combinations of the Original Work with other software or hardware. 

11) Jurisdiction, Venue and Governing Law. Any action or suit relating to this License may be brought only in the courts of a jurisdiction wherein the Licensor resides or in which Licensor conducts its primary business, and under the laws of that jurisdiction excluding its conflict-of-law provisions. The application of the United Nations Convention on Contracts for the International Sale of Goods is expressly excluded. Any use of the Original Work outside the scope of this License or after its termination shall be subject to the requirements and penalties of copyright or patent law in the appropriate jurisdiction. This section shall survive the termination of this License. 

12) Attorneys’ Fees. In any action to enforce the terms of this License or seeking damages relating thereto, the prevailing party shall be entitled to recover its costs and expenses, including, without limitation, reasonable attorneys' fees and costs incurred in connection with such action, including any appeal of such action. This section shall survive the termination of this License. 

13) Miscellaneous. If any provision of this License is held to be unenforceable, such provision shall be reformed only to the extent necessary to make it enforceable. 

14) Definition of ""You"" in This License. ""You"" throughout this License, whether in upper or lower case, means an individual or a legal entity exercising rights under, and complying with all of the terms of, this License. For legal entities, ""You"" includes any entity that controls, is controlled by, or is under common control with you. For purposes of this definition, ""control"" means (i) the power, direct or indirect, to cause the direction or management of such entity, whether by contract or otherwise, or (ii) ownership of fifty percent (50%) or more of the outstanding shares, or (iii) beneficial ownership of such entity. 

15) Right to Use. You may use the Original Work in all ways not otherwise restricted or conditioned by this License or by law, and Licensor promises not to interfere with or be responsible for such uses by You. 

16) Modification of This License. This License is Copyright © 2005 Lawrence Rosen. Permission is granted to copy, distribute, or communicate this License without modification. Nothing in this License permits You to modify this License as applied to the Original Work or to Derivative Works. However, You may modify the text of this License and copy, distribute or communicate your modified version (the ""Modified License"") and apply it to other original works of authorship subject to the following conditions: (i) You may not indicate in any way that your Modified License is the ""Academic Free License"" or ""AFL"" and you may not use those names in the name of your Modified License; (ii) You must replace the notice specified in the first paragraph above with the notice ""Licensed under <insert your license name here>"" or with a notice of your own that is not confusingly similar to the notice in this License; and (iii) You may not claim that your original works are open source software unless your Modified License has been approved by Open Source Initiative (OSI) and You comply with its license review and certification process.
",False,"```
Academic Free License (“AFL”) v. 3.0 

This Academic Free License (the ""License"") applies to any original work of authorship (the ""Original Work"") whose owner (the ""Licensor"") has placed the following licensing notice adjacent to the copyright notice for the Original Work:
Licensed under the Academic Free License version 3.0  

1) Grant of Copyright License. Licensor grants You a worldwide, royalty-free, non-exclusive, sublicensable license, for the duration of the copyright, to do the following:
 	
	a) to reproduce the Original Work in copies, either alone or as part of a collective work; 

	b) to translate, adapt, alter, transform, modify, or arrange the Original Work, thereby creating derivative works (""Derivative Works"") based upon the Original Work; 

	c) to distribute or communicate copies of the Original Work and Derivative Works to the public, under any license of your choice that does not contradict the terms and conditions, including Licensor’s reserved rights and remedies, in this Academic Free License;
 
	d) to perform the Original Work publicly; and
 
	e) to display the Original Work publicly. 

2) Grant of Patent License. Licensor grants You a worldwide, royalty-free, non-exclusive, sublicensable license, under patent claims owned or controlled by the Licensor that are embodied in the Original Work as furnished by the Licensor, for the duration of the patents, to make, use, sell, offer for sale, have made, and import the Original Work and Derivative Works. 

3) Grant of Source Code License. The term ""Source Code"" means the preferred form of the Original Work for making modifications to it and all available documentation describing how to modify the Original Work. Licensor agrees to provide a machine-readable copy of the Source Code of the Original Work along with each copy of the Original Work that Licensor distributes. Licensor reserves the right to satisfy this obligation by placing a machine-readable copy of the Source Code in an information repository reasonably calculated to permit inexpensive and convenient access by You for as long as Licensor continues to distribute the Original Work.

 4) Exclusions From License Grant. Neither the names of Licensor, nor the names of any contributors to the Original Work, nor any of their trademarks or service marks, may be used to endorse or promote products derived from this Original Work without express prior permission of the Licensor. Except as expressly stated herein, nothing in this License grants any license to Licensor’s trademarks, copyrights, patents, trade secrets or any other intellectual property. No patent license is granted to make, use, sell, offer for sale, have made, or import embodiments of any patent claims other than the licensed claims defined in Section 2. No license is granted to the trademarks of Licensor even if such marks are included in the Original Work. Nothing in this License shall be interpreted to prohibit Licensor from licensing under terms different from this License any Original Work that Licensor otherwise would have a right to license. 

5) External Deployment. The term ""External Deployment"" means the use, distribution, or communication of the Original Work or Derivative Works in any way such that the Original Work or Derivative Works may be used by anyone other than You, whether those works are distributed or communicated to those persons or made available as an application intended for use over a network. As an express condition for the grants of license hereunder, You must treat any External Deployment by You of the Original Work or a Derivative Work as a distribution under section 1(c). 

6) Attribution Rights. You must retain, in the Source Code of any Derivative Works that You create, all copyright, patent, or trademark notices from the Source Code of the Original Work, as well as any notices of licensing and any descriptive text identified therein as an ""Attribution Notice."" You must cause the Source Code for any Derivative Works that You create to carry a prominent Attribution Notice reasonably calculated to inform recipients that You have modified the Original Work. 

7) Warranty of Provenance and Disclaimer of Warranty. Licensor warrants that the copyright in and to the Original Work and the patent rights granted herein by Licensor are owned by the Licensor or are sublicensed to You under the terms of this License with the permission of the contributor(s) of those copyrights and patent rights. Except as expressly stated in the immediately preceding sentence, the Original Work is provided under this License on an ""AS IS"" BASIS and WITHOUT WARRANTY, either express or implied, including, without limitation, the warranties of non-infringement, merchantability or fitness for a particular purpose. THE ENTIRE RISK AS TO THE QUALITY OF THE ORIGINAL WORK IS WITH YOU. This DISCLAIMER OF WARRANTY constitutes an essential part of this License. No license to the Original Work is granted by this License except under this disclaimer.

8) Limitation of Liability. Under no circumstances and under no legal theory, whether in tort (including negligence), contract, or otherwise, shall the Licensor be liable to anyone for any indirect, special, incidental, or consequential damages of any character arising as a result of this License or the use of the Original Work including, without limitation, damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses. This limitation of liability shall not apply to the extent applicable law prohibits such limitation. 

9) Acceptance and Termination. If, at any time, You expressly assented to this License, that assent indicates your clear and irrevocable acceptance of this License and all of its terms and conditions. If You distribute or communicate copies of the Original Work or a Derivative Work, You must make a reasonable effort under the circumstances to obtain the express assent of recipients to the terms of this License. This License conditions your rights to undertake the activities listed in Section 1, including your right to create Derivative Works based upon the Original Work, and doing so without honoring these terms and conditions is prohibited by copyright law and international treaty. Nothing in this License is intended to affect copyright exceptions and limitations (including “fair use” or “fair dealing”). This License shall terminate immediately and You may no longer exercise any of the rights granted to You by this License upon your failure to honor the conditions in Section 1(c). 

10) Termination for Patent Action. This License shall terminate automatically and You may no longer exercise any of the rights granted to You by this License as of the date You commence an action, including a cross-claim or counterclaim, against Licensor or any licensee alleging that the Original Work infringes a patent. This termination provision shall not apply for an action alleging patent infringement by combinations of the Original Work with other software or hardware. 

11) Jurisdiction, Venue and Governing Law. Any action or suit relating to this License may be brought only in the courts of a jurisdiction wherein the Licensor resides or in which Licensor conducts its primary business, and under the laws of that jurisdiction excluding its conflict-of-law provisions. The application of the United Nations Convention on Contracts for the International Sale of Goods is expressly excluded. Any use of the Original Work outside the scope of this License or after its termination shall be subject to the requirements and penalties of copyright or patent law in the appropriate jurisdiction. This section shall survive the termination of this License. 

12) Attorneys’ Fees. In any action to enforce the terms of this License or seeking damages relating thereto, the prevailing party shall be entitled to recover its costs and expenses, including, without limitation, reasonable attorneys' fees and costs incurred in connection with such action, including any appeal of such action. This section shall survive the termination of this License. 

13) Miscellaneous. If any provision of this License is held to be unenforceable, such provision shall be reformed only to the extent necessary to make it enforceable. 

14) Definition of ""You"" in This License. ""You"" throughout this License, whether in upper or lower case, means an individual or a legal entity exercising rights under, and complying with all of the terms of, this License. For legal entities, ""You"" includes any entity that controls, is controlled by, or is under common control with you. For purposes of this definition, ""control"" means (i) the power, direct or indirect, to cause the direction or management of such entity, whether by contract or otherwise, or (ii) ownership of fifty percent (50%) or more of the outstanding shares, or (iii) beneficial ownership of such entity. 

15) Right to Use. You may use the Original Work in all ways not otherwise restricted or conditioned by this License or by law, and Licensor promises not to interfere with or be responsible for such uses by You. 

16) Modification of This License. This License is Copyright © 2005 Lawrence Rosen. Permission is granted to copy, distribute, or communicate this License without modification. Nothing in this License permits You to modify this License as applied to the Original Work or to Derivative Works. However, You may modify the text of this License and copy, distribute or communicate your modified version (the ""Modified License"") and apply it to other original works of authorship subject to the following conditions: (i) You may not indicate in any way that your Modified License is the ""Academic Free License"" or ""AFL"" and you may not use those names in the name of your Modified License; (ii) You must replace the notice specified in the first paragraph above with the notice ""Licensed under <insert your license name here>"" or with a notice of your own that is not confusingly similar to the notice in this License; and (iii) You may not claim that your original works are open source software unless your Modified License has been approved by Open Source Initiative (OSI) and You comply with its license review and certification process. 
```"
18,18,NomosTestfiles/AFL/dojo.js,"AFL-2.1
BSD
Dual-license","/*
	Copyright (c) 2004-2008, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/

/*
	This is a compiled version of Dojo, built for deployment and not for
	development. To get an editable version, please visit:

		http://dojotoolkit.org

	for documentation and information on getting the source.
*/

;(function(){

	/*
	dojo, dijit, and dojox must always be the first three, and in that order.
	djConfig.scopeMap = [
		[""dojo"", ""fojo""],
		[""dijit"", ""fijit""],
		[""dojox"", ""fojox""]
	
	]
	*/

	/**Build will replace this comment with a scoped djConfig **/

	//The null below can be relaced by a build-time value used instead of djConfig.scopeMap.
	var sMap = null;

	//See if new scopes need to be defined.
	if((sMap || (typeof djConfig != ""undefined"" && djConfig.scopeMap)) && (typeof window != ""undefined"")){
		var scopeDef = """", scopePrefix = """", scopeSuffix = """", scopeMap = {}, scopeMapRev = {};
		sMap = sMap || djConfig.scopeMap;
		for(var i = 0; i < sMap.length; i++){
			//Make local variables, then global variables that use the locals.
			var newScope = sMap[i];
			scopeDef += ""var "" + newScope[0] + "" = {}; "" + newScope[1] + "" = "" + newScope[0] + "";"" + newScope[1] + ""._scopeName = '"" + newScope[1] + ""';"";
			scopePrefix += (i == 0 ? """" : "","") + newScope[0];
			scopeSuffix += (i == 0 ? """" : "","") + newScope[1];
			scopeMap[newScope[0]] = newScope[1];
			scopeMapRev[newScope[1]] = newScope[0];
		}

		eval(scopeDef + ""dojo._scopeArgs = ["" + scopeSuffix + ""];"");

		dojo._scopePrefixArgs = scopePrefix;
		dojo._scopePrefix = ""(function("" + scopePrefix + ""){"";
		dojo._scopeSuffix = ""})("" + scopeSuffix + "")"";
		dojo._scopeMap = scopeMap;
		dojo._scopeMapRev = scopeMapRev;
	}

/*=====
// note:
//		'djConfig' does not exist under 'dojo.*' so that it can be set before the
//		'dojo' variable exists.
// note:
//		Setting any of these variables *after* the library has loaded does
//		nothing at all.

djConfig = {
	// summary:
	//		Application code can set the global 'djConfig' prior to loading
	//		the library to override certain global settings for how dojo works.
	//
	// isDebug: Boolean
	//		Defaults to `false`. If set to `true`, ensures that Dojo provides
	//		extended debugging feedback via Firebug. If Firebug is not available
	//		on your platform, setting `isDebug` to `true` will force Dojo to
	//		pull in (and display) the version of Firebug Lite which is
	//		integrated into the Dojo distribution, thereby always providing a
	//		debugging/logging console when `isDebug` is enabled. Note that
	//		Firebug's `console.*` methods are ALWAYS defined by Dojo. If
	//		`isDebug` is false and you are on a platform without Firebug, these
	//		methods will be defined as no-ops.
	isDebug: false,
	// debugAtAllCosts: Boolean
	//		Defaults to `false`. If set to `true`, this triggers an alternate
	//		mode of the package system in which dependencies are detected and
	//		only then are resources evaluated in dependency order via
	//		`<script>` tag inclusion. This may double-request resources and
	//		cause problems with scripts which expect `dojo.require()` to
	//		preform synchronously. `debugAtAllCosts` can be an invaluable
	//		debugging aid, but when using it, ensure that all code which
	//		depends on Dojo modules is wrapped in `dojo.addOnLoad()` handlers.
	//		Due to the somewhat unpredictable side-effects of using
	//		`debugAtAllCosts`, it is strongly recommended that you enable this
	//		flag as a last resort. `debugAtAllCosts` has no effect when loading
	//		resources across domains. For usage information, see the
	//		[Dojo Book](http://dojotoolkit.org/book/book-dojo/part-4-meta-dojo-making-your-dojo-code-run-faster-and-better/debugging-facilities/deb)
	debugAtAllCosts: false,
	// locale: String
	//		The locale to assume for loading localized resources in this page,
	//		specified according to [RFC 3066](http://www.ietf.org/rfc/rfc3066.txt).
	//		Must be specified entirely in lowercase, e.g. `en-us` and `zh-cn`.
	//		See the documentation for `dojo.i18n` and `dojo.requireLocalization`
	//		for details on loading localized resources. If no locale is specified,
	//		Dojo assumes the locale of the user agent, according to `navigator.userLanguage`
	//		or `navigator.language` properties.
	locale: undefined,
	// extraLocale: Array
	//		No default value. Specifies additional locales whose
	//		resources should also be loaded alongside the default locale when
	//		calls to `dojo.requireLocalization()` are processed.
	extraLocale: undefined,
	// baseUrl: String
	//		The directory in which `dojo.js` is located. Under normal
	//		conditions, Dojo auto-detects the correct location from which it
	//		was loaded. You may need to manually configure `baseUrl` in cases
	//		where you have renamed `dojo.js` or in which `<base>` tags confuse
	//		some browsers (e.g. IE 6). The variable `dojo.baseUrl` is assigned
	//		either the value of `djConfig.baseUrl` if one is provided or the
	//		auto-detected root if not. Other modules are located relative to
	//		this path.
	baseUrl: undefined,
	// modulePaths: Object
	//		A map of module names to paths relative to `dojo.baseUrl`. The
	//		key/value pairs correspond directly to the arguments which
	//		`dojo.registerModulePath` accepts. Specifiying
	//		`djConfig.modulePaths = { ""foo"": ""../../bar"" }` is the equivalent
	//		of calling `dojo.registerModulePath(""foo"", ""../../bar"");`. Multiple
	//		modules may be configured via `djConfig.modulePaths`.
	modulePaths: {},
	// afterOnLoad: Boolean 
	//		Indicates Dojo was added to the page after the page load. In this case
	//		Dojo will not wait for the page DOMContentLoad/load events and fire
	//		its dojo.addOnLoad callbacks after making sure all outstanding
	//		dojo.required modules have loaded.
	afterOnLoad: false,
	// addOnLoad: Function or Array
	//		Adds a callback via dojo.addOnLoad. Useful when Dojo is added after
	//		the page loads and djConfig.afterOnLoad is true. Supports the same
	//		arguments as dojo.addOnLoad. When using a function reference, use
	//		`djConfig.addOnLoad = function(){};`. For object with function name use
	//		`djConfig.addOnLoad = [myObject, ""functionName""];` and for object with
	//		function reference use
	//		`djConfig.addOnLoad = [myObject, function(){}];`
	addOnLoad: null,
	// require: Array
	//		An array of module names to be loaded immediately after dojo.js has been included
	//		in a page. 
	require: []
}
=====*/

(function(){
	// firebug stubs

	// if((!this[""console""])||(!console[""firebug""])){

	if(!this[""console""]){
		this.console = {
		};
	}

	//	Be careful to leave 'log' always at the end
	var cn = [
		""assert"", ""count"", ""debug"", ""dir"", ""dirxml"", ""error"", ""group"",
		""groupEnd"", ""info"", ""profile"", ""profileEnd"", ""time"", ""timeEnd"",
		""trace"", ""warn"", ""log"" 
	];
	var i=0, tn;
	while((tn=cn[i++])){
		if(!console[tn]){
			(function(){
				var tcn = tn+"""";
				console[tcn] = ('log' in console) ? function(){ 
					var a = Array.apply({}, arguments);
					a.unshift(tcn+"":"");
					console[""log""](a.join("" ""));
				} : function(){}
			})();
		}
	}

	//TODOC:  HOW TO DOC THIS?
	// dojo is the root variable of (almost all) our public symbols -- make sure it is defined.
	if(typeof dojo == ""undefined""){
		this.dojo = {
			_scopeName: ""dojo"",
			_scopePrefix: """",
			_scopePrefixArgs: """",
			_scopeSuffix: """",
			_scopeMap: {},
			_scopeMapRev: {}
		};
	}

	var d = dojo;

	//Need placeholders for dijit and dojox for scoping code.
	if(typeof dijit == ""undefined""){
		this.dijit = {_scopeName: ""dijit""};
	}
	if(typeof dojox == ""undefined""){
		this.dojox = {_scopeName: ""dojox""};
	}
	
	if(!d._scopeArgs){
		d._scopeArgs = [dojo, dijit, dojox];
	}

/*=====
dojo.global = {
	//	summary:
	//		Alias for the global scope
	//		(e.g. the window object in a browser).
	//	description:
	//		Refer to 'dojo.global' rather than referring to window to ensure your
	//		code runs correctly in contexts other than web browsers (e.g. Rhino on a server).
}
=====*/
	d.global = this;

	d.config =/*===== djConfig = =====*/{
		isDebug: false,
		debugAtAllCosts: false
	};

	if(typeof djConfig != ""undefined""){
		for(var opt in djConfig){
			d.config[opt] = djConfig[opt];
		}
	}

	var _platforms = [""Browser"", ""Rhino"", ""Spidermonkey"", ""Mobile""];
	var t;
	while((t=_platforms.shift())){
		d[""is""+t] = false;
	}

/*=====
	// Override locale setting, if specified
	dojo.locale = {
		// summary: the locale as defined by Dojo (read-only)
	};
=====*/
	dojo.locale = d.config.locale;
	
	var rev = ""$Rev: 15385 $"".match(/\d+/);

	dojo.version = {
		// summary: 
		//		version number of dojo
		//	major: Integer
		//		Major version. If total version is ""1.2.0beta1"", will be 1
		//	minor: Integer
		//		Minor version. If total version is ""1.2.0beta1"", will be 2
		//	patch: Integer
		//		Patch version. If total version is ""1.2.0beta1"", will be 0
		//	flag: String
		//		Descriptor flag. If total version is ""1.2.0beta1"", will be ""beta1""
		//	revision: Number
		//		The SVN rev from which dojo was pulled
		major: 1, minor: 2, patch: 0, flag: """",
		revision: rev ? +rev[0] : 999999, //FIXME: use NaN?
		toString: function(){
			with(d.version){
				return major + ""."" + minor + ""."" + patch + flag + "" ("" + revision + "")"";	// String
			}
		}
	}

	// Register with the OpenAjax hub
	if(typeof OpenAjax != ""undefined""){
		OpenAjax.hub.registerLibrary(dojo._scopeName, ""http://dojotoolkit.org"", d.version.toString());
	}

	dojo._mixin = function(/*Object*/ obj, /*Object*/ props){
		// summary:
		//		Adds all properties and methods of props to obj. This addition
		//		is ""prototype extension safe"", so that instances of objects
		//		will not pass along prototype defaults.
		var tobj = {};
		for(var x in props){
			// the ""tobj"" condition avoid copying properties in ""props""
			// inherited from Object.prototype.  For example, if obj has a custom
			// toString() method, don't overwrite it with the toString() method
			// that props inherited from Object.prototype
			if(tobj[x] === undefined || tobj[x] != props[x]){
				obj[x] = props[x];
			}
		}
		// IE doesn't recognize custom toStrings in for..in
		if(d[""isIE""] && props){
			var p = props.toString;
			if(typeof p == ""function"" && p != obj.toString && p != tobj.toString &&
				p != ""\nfunction toString() {\n    [native code]\n}\n""){
					obj.toString = props.toString;
			}
		}
		return obj; // Object
	}

	dojo.mixin = function(/*Object*/obj, /*Object...*/props){
		// summary:	
		//		Adds all properties and methods of props to obj and returns the
		//		(now modified) obj.
		//	description:
		//		`dojo.mixin` can mix multiple source objects into a
		//		destionation object which is then returned. Unlike regular
		//		`for...in` iteration, `dojo.mixin` is also smart about avoiding
		//		extensions which other toolkits may unwisely add to the root
		//		object prototype
		//	obj:
		//		The object to mix properties into. Also the return value.
		//	props:
		//		One or more objects whose values are successively copied into
		//		obj. If more than one of these objects contain the same value,
		//		the one specified last in the function call will ""win"".
		//	example:
		//		make a shallow copy of an object
		//	|	var copy = dojo.mixin({}, source);
		//	example:
		//		many class constructors often take an object which specifies
		//		values to be configured on the object. In this case, it is
		//		often simplest to call `dojo.mixin` on the `this` object:
		//	|	dojo.declare(""acme.Base"", null, {
		//	|		constructor: function(properties){
		//	|			// property configuration:
		//	|			dojo.mixin(this, properties);
		//	|	
		//	|			
		//	|			//  ...
		//	|		},
		//	|		quip: ""I wasn't born yesterday, you know - I've seen movies."",
		//	|		// ...
		//	|	});
		//	|
		//	|	// create an instance of the class and configure it
		//	|	var b = new acme.Base({quip: ""That's what it does!"" });
		//	example:
		//		copy in properties from multiple objects
		//	|	var flattened = dojo.mixin(
		//	|		{
		//	|			name: ""Frylock"",
		//	|			braces: true
		//	|		},
		//	|		{
		//	|			name: ""Carl Brutanananadilewski""
		//	|		}
		//	|	);
		//	|	
		//	|	// will print ""Carl Brutanananadilewski""
		//	|	
		//	|	// will print ""true""
		//	|	
		for(var i=1, l=arguments.length; i<l; i++){
			d._mixin(obj, arguments[i]);
		}
		return obj; // Object
	}

	dojo._getProp = function(/*Array*/parts, /*Boolean*/create, /*Object*/context){
		var obj=context || d.global;
		for(var i=0, p; obj && (p=parts[i]); i++){
			if(i == 0 && this._scopeMap[p]){
				p = this._scopeMap[p];
			}
			obj = (p in obj ? obj[p] : (create ? obj[p]={} : undefined));
		}
		return obj; // mixed
	}

	dojo.setObject = function(/*String*/name, /*Object*/value, /*Object?*/context){
		// summary: 
		//		Set a property from a dot-separated string, such as ""A.B.C""
		//	description: 
		//		Useful for longer api chains where you have to test each object in
		//		the chain, or when you have an object reference in string format.
		//		Objects are created as needed along `path`. Returns the passed
		//		value if setting is successful or `undefined` if not.
		//	name: 	
		//		Path to a property, in the form ""A.B.C"".
		//	context:
		//		Optional. Object to use as root of path. Defaults to
		//		`dojo.global`.
		//	example:
		//		set the value of `foo.bar.baz`, regardless of whether
		//		intermediate objects already exist:
		//	|	dojo.setObject(""foo.bar.baz"", value);
		//	example:
		//		without `dojo.setObject`, we often see code like this:
		//	|	// ensure that intermediate objects are available
		//	|	if(!obj[""parent""]){ obj.parent = {}; }
		//	|	if(!obj.parent[""child""]){ obj.parent.child= {}; }
		//	|	// now we can safely set the property
		//	|	obj.parent.child.prop = ""some value"";
		//		wheras with `dojo.setObject`, we can shorten that to:
		//	|	dojo.setObject(""parent.child.prop"", ""some value"", obj);
		var parts=name.split("".""), p=parts.pop(), obj=d._getProp(parts, true, context);
		return obj && p ? (obj[p]=value) : undefined; // Object
	}

	dojo.getObject = function(/*String*/name, /*Boolean*/create, /*Object*/context){
		// summary: 
		//		Get a property from a dot-separated string, such as ""A.B.C""
		//	description: 
		//		Useful for longer api chains where you have to test each object in
		//		the chain, or when you have an object reference in string format.
		//	name: 	
		//		Path to an property, in the form ""A.B.C"".
		//	context:
		//		Optional. Object to use as root of path. Defaults to
		//		'dojo.global'. Null may be passed.
		//	create: 
		//		Optional. Defaults to `false`. If `true`, Objects will be
		//		created at any point along the 'path' that is undefined.
		return d._getProp(name.split("".""), create, context); // Object
	}

	dojo.exists = function(/*String*/name, /*Object?*/obj){
		//	summary: 
		//		determine if an object supports a given method
		//	description: 
		//		useful for longer api chains where you have to test each object in
		//		the chain
		//	name: 	
		//		Path to an object, in the form ""A.B.C"".
		//	obj:
		//		Object to use as root of path. Defaults to
		//		'dojo.global'. Null may be passed.
		//	example:
		//	|	// define an object
		//	|	var foo = {
		//	|		bar: { }
		//	|	};
		//	|
		//	|	// search the global scope
		//	|	dojo.exists(""foo.bar""); // true
		//	|	dojo.exists(""foo.bar.baz""); // false
		//	|
		//	|	// search from a particular scope
		//	|	dojo.exists(""bar"", foo); // true
		//	|	dojo.exists(""bar.baz"", foo); // false
		return !!d.getObject(name, false, obj); // Boolean
	}


	dojo[""eval""] = function(/*String*/ scriptFragment){
		//	summary: 
		//		Perform an evaluation in the global scope. Use this rather than
		//		calling 'eval()' directly.
		//	description: 
		//		Placed in a separate function to minimize size of trapped
		//		exceptions. Calling eval() directly from some other scope may
		//		complicate tracebacks on some platforms.
		//	returns:
		//		The result of the evaluation. Often `undefined`


		// note:
		//	 - JSC eval() takes an optional second argument which can be 'unsafe'.
		//	 - Mozilla/SpiderMonkey eval() takes an optional second argument which is the
		//  	 scope object for new symbols.

		// FIXME: investigate Joseph Smarr's technique for IE:
		//		http://josephsmarr.com/2007/01/31/fixing-eval-to-use-global-scope-in-ie/
		//	see also:
		// 		http://trac.dojotoolkit.org/ticket/744
		return d.global.eval ? d.global.eval(scriptFragment) : eval(scriptFragment); 	// Object
	}

	/*=====
		dojo.deprecated = function(behaviour, extra, removal){
			//	summary: 
			//		Log a debug message to indicate that a behavior has been
			//		deprecated.
			//	behaviour: String
			//		The API or behavior being deprecated. Usually in the form
			//		of ""myApp.someFunction()"".
			//	extra: String?
			//		Text to append to the message. Often provides advice on a
			//		new function or facility to achieve the same goal during
			//		the deprecation period.
			//	removal: String?
			//		Text to indicate when in the future the behavior will be
			//		removed. Usually a version number.
			//	example:
			//	|	dojo.deprecated(""myApp.getTemp()"", ""use myApp.getLocaleTemp() instead"", ""1.0"");
		}

		dojo.experimental = function(moduleName, extra){
			//	summary: Marks code as experimental.
			//	description: 
			//	 	This can be used to mark a function, file, or module as
			//	 	experimental.  Experimental code is not ready to be used, and the
			//	 	APIs are subject to change without notice.  Experimental code may be
			//	 	completed deleted without going through the normal deprecation
			//	 	process.
			//	moduleName: String
			//	 	The name of a module, or the name of a module file or a specific
			//	 	function
			//	extra: String?
			//	 	some additional message for the user
			//	example:
			//	|	dojo.experimental(""dojo.data.Result"");
			//	example:
			//	|	dojo.experimental(""dojo.weather.toKelvin()"", ""PENDING approval from NOAA"");
		}
	=====*/

	//Real functions declared in dojo._firebug.firebug.
	d.deprecated = d.experimental = function(){};

})();
// vim:ai:ts=4:noet

/*
 * loader.js - A bootstrap module.  Runs before the hostenv_*.js file. Contains
 * all of the package loading methods.
 */

(function(){
	var d = dojo;

	d.mixin(d, {
		_loadedModules: {},
		_inFlightCount: 0,
		_hasResource: {},

		_modulePrefixes: {
			dojo: 	{	name: ""dojo"", value: ""."" },
			// dojox: 	{	name: ""dojox"", value: ""../dojox"" },
			// dijit: 	{	name: ""dijit"", value: ""../dijit"" },
			doh: 	{	name: ""doh"", value: ""../util/doh"" },
			tests: 	{	name: ""tests"", value: ""tests"" }
		},

		_moduleHasPrefix: function(/*String*/module){
			// summary: checks to see if module has been established
			var mp = this._modulePrefixes;
			return !!(mp[module] && mp[module].value); // Boolean
		},

		_getModulePrefix: function(/*String*/module){
			// summary: gets the prefix associated with module
			var mp = this._modulePrefixes;
			if(this._moduleHasPrefix(module)){
				return mp[module].value; // String
			}
			return module; // String
		},

		_loadedUrls: [],

		//WARNING: 
		//		This variable is referenced by packages outside of bootstrap:
		//		FloatingPane.js and undo/browser.js
		_postLoad: false,
		
		//Egad! Lots of test files push on this directly instead of using dojo.addOnLoad.
		_loaders: [],
		_unloaders: [],
		_loadNotifying: false
	});


		dojo._loadPath = function(/*String*/relpath, /*String?*/module, /*Function?*/cb){
		// 	summary:
		//		Load a Javascript module given a relative path
		//
		//	description:
		//		Loads and interprets the script located at relpath, which is
		//		relative to the script root directory.  If the script is found but
		//		its interpretation causes a runtime exception, that exception is
		//		not caught by us, so the caller will see it.  We return a true
		//		value if and only if the script is found.
		//
		// relpath: 
		//		A relative path to a script (no leading '/', and typically ending
		//		in '.js').
		// module: 
		//		A module whose existance to check for after loading a path.  Can be
		//		used to determine success or failure of the load.
		// cb: 
		//		a callback function to pass the result of evaluating the script

		var uri = ((relpath.charAt(0) == '/' || relpath.match(/^\w+:/)) ? """" : this.baseUrl) + relpath;
		try{
			return !module ? this._loadUri(uri, cb) : this._loadUriAndCheck(uri, module, cb); // Boolean
		}catch(e){
			console.error(e);
			return false; // Boolean
		}
	}

	dojo._loadUri = function(/*String*/uri, /*Function?*/cb){
		//	summary:
		//		Loads JavaScript from a URI
		//	description:
		//		Reads the contents of the URI, and evaluates the contents.  This is
		//		used to load modules as well as resource bundles. Returns true if
		//		it succeeded. Returns false if the URI reading failed.  Throws if
		//		the evaluation throws.
		//	uri: a uri which points at the script to be loaded
		//	cb: 
		//		a callback function to process the result of evaluating the script
		//		as an expression, typically used by the resource bundle loader to
		//		load JSON-style resources

		if(this._loadedUrls[uri]){
			return true; // Boolean
		}
		var contents = this._getText(uri, true);
		if(!contents){ return false; } // Boolean
		this._loadedUrls[uri] = true;
		this._loadedUrls.push(uri);
		if(cb){
			contents = '('+contents+')';
		}else{
			//Only do the scoping if no callback. If a callback is specified,
			//it is most likely the i18n bundle stuff.
			contents = this._scopePrefix + contents + this._scopeSuffix;
		}
		if(d.isMoz){ contents += ""\r\n//@ sourceURL="" + uri; } // debugging assist for Firebug
		var value = d[""eval""](contents);
		if(cb){ cb(value); }
		return true; // Boolean
	}
	
	// FIXME: probably need to add logging to this method
	dojo._loadUriAndCheck = function(/*String*/uri, /*String*/moduleName, /*Function?*/cb){
		// summary: calls loadUri then findModule and returns true if both succeed
		var ok = false;
		try{
			ok = this._loadUri(uri, cb);
		}catch(e){
			console.error(""failed loading "" + uri + "" with error: "" + e);
		}
		return !!(ok && this._loadedModules[moduleName]); // Boolean
	}

	dojo.loaded = function(){
		// summary:
		//		signal fired when initial environment and package loading is
		//		complete. You may use dojo.addOnLoad() or dojo.connect() to
		//		this method in order to handle initialization tasks that
		//		require the environment to be initialized. In a browser host,
		//		declarative widgets will be constructed when this function
		//		finishes runing.
		this._loadNotifying = true;
		this._postLoad = true;
		var mll = d._loaders;

		//Clear listeners so new ones can be added
		//For other xdomain package loads after the initial load.
		this._loaders = [];

		for(var x = 0; x < mll.length; x++){
			mll[x]();
		}

		this._loadNotifying = false;
		
		//Make sure nothing else got added to the onload queue
		//after this first run. If something did, and we are not waiting for any
		//more inflight resources, run again.
		if(d._postLoad && d._inFlightCount == 0 && mll.length){
			d._callLoaded();
		}
	}

	dojo.unloaded = function(){
		// summary:
		//		signal fired by impending environment destruction. You may use
		//		dojo.addOnUnload() or dojo.connect() to this method to perform
		//		page/application cleanup methods. See dojo.addOnUnload for more info.
		var mll = this._unloaders;
		while(mll.length){
			(mll.pop())();
		}
	}

	d._onto = function(arr, obj, fn){
		if(!fn){
			arr.push(obj);
		}else if(fn){
			var func = (typeof fn == ""string"") ? obj[fn] : fn;
			arr.push(function(){ func.call(obj); });
		}
	}

	dojo.addOnLoad = function(/*Object?*/obj, /*String|Function*/functionName){
		// summary:
		//		Registers a function to be triggered after the DOM has finished
		//		loading and widgets declared in markup have been instantiated.
		//		Images and CSS files may or may not have finished downloading when
		//		the specified function is called.  (Note that widgets' CSS and HTML
		//		code is guaranteed to be downloaded before said widgets are
		//		instantiated.)
		// example:
		//	|	dojo.addOnLoad(functionPointer);
		//	|	dojo.addOnLoad(object, ""functionName"");
		//	|	dojo.addOnLoad(object, function(){ /* ... */});

		d._onto(d._loaders, obj, functionName);

		//Added for xdomain loading. dojo.addOnLoad is used to
		//indicate callbacks after doing some dojo.require() statements.
		//In the xdomain case, if all the requires are loaded (after initial
		//page load), then immediately call any listeners.
		if(d._postLoad && d._inFlightCount == 0 && !d._loadNotifying){
			d._callLoaded();
		}
	}

	//Support calling dojo.addOnLoad via djConfig.addOnLoad. Support all the
	//call permutations of dojo.addOnLoad. Mainly useful when dojo is added
	//to the page after the page has loaded.
	var dca = d.config.addOnLoad;
	if(dca){
		d.addOnLoad[(dca instanceof Array ? ""apply"" : ""call"")](d, dca);
	}

	dojo.addOnUnload = function(/*Object?*/obj, /*String|Function?*/functionName){
		// summary:
		//		registers a function to be triggered when the page unloads. In a browser
		//		enviroment, the functions will be triggered during the window.onbeforeunload
		//		event. Be careful doing work during window.onbeforeunload. onbeforeunload
		//		can be triggered if a link to download a file is clicked, or if the link is a
		//		javascript: link. In these cases, the onbeforeunload event fires, but the
		//		document is not actually destroyed. So be careful about doing destructive
		//		operations in a dojo.addOnUnload callback.
		// example:
		//	|	dojo.addOnUnload(functionPointer)
		//	|	dojo.addOnUnload(object, ""functionName"")
		//	|	dojo.addOnUnload(object, function(){ /* ... */});

		d._onto(d._unloaders, obj, functionName);
	}

	dojo._modulesLoaded = function(){
		if(d._postLoad){ return; }
		if(d._inFlightCount > 0){ 
			console.warn(""files still in flight!"");
			return;
		}
		d._callLoaded();
	}

	dojo._callLoaded = function(){

		// The ""object"" check is for IE, and the other opera check fixes an
		// issue in Opera where it could not find the body element in some
		// widget test cases.  For 0.9, maybe route all browsers through the
		// setTimeout (need protection still for non-browser environments
		// though). This might also help the issue with FF 2.0 and freezing
		// issues where we try to do sync xhr while background css images are
		// being loaded (trac #2572)? Consider for 0.9.
		if(typeof setTimeout == ""object"" || (dojo.config.useXDomain && d.isOpera)){
			if(dojo.isAIR){
				setTimeout(function(){dojo.loaded();}, 0);
			}else{
				setTimeout(dojo._scopeName + "".loaded();"", 0);
			}
		}else{
			d.loaded();
		}
	}

	dojo._getModuleSymbols = function(/*String*/modulename){
		// summary:
		//		Converts a module name in dotted JS notation to an array
		//		representing the path in the source tree
		var syms = modulename.split(""."");
		for(var i = syms.length; i>0; i--){
			var parentModule = syms.slice(0, i).join(""."");
			if((i==1) && !this._moduleHasPrefix(parentModule)){		
				// Support default module directory (sibling of dojo) for top-level modules 
				syms[0] = ""../"" + syms[0];
			}else{
				var parentModulePath = this._getModulePrefix(parentModule);
				if(parentModulePath != parentModule){
					syms.splice(0, i, parentModulePath);
					break;
				}
			}
		}
		// 
		return syms; // Array
	}

	dojo._global_omit_module_check = false;

	dojo.loadInit = function(/*Function*/init){
		//	summary:
		//		Executes a function that needs to be executed for the loader's dojo.requireIf
		//		resolutions to work. This is needed mostly for the xdomain loader case where
		//		a function needs to be executed to set up the possible values for a dojo.requireIf
		//		call.
		//	init:
		//		a function reference. Executed immediately.
		//	description: This function is mainly a marker for the xdomain loader to know parts of
		//		code that needs be executed outside the function wrappper that is placed around modules.
		//		The init function could be executed more than once, and it should make no assumptions
		//		on what is loaded, or what modules are available. Only the functionality in Dojo Base
		//		is allowed to be used. Avoid using this method. For a valid use case,
		//		see the source for dojox.gfx.
		init();
	}

	dojo._loadModule = dojo.require = function(/*String*/moduleName, /*Boolean?*/omitModuleCheck){
		//	summary:
		//		loads a Javascript module from the appropriate URI
		//	moduleName:
		//		module name to load, using periods for separators,
		//		 e.g. ""dojo.date.locale"".  Module paths are de-referenced by dojo's
		//		internal mapping of locations to names and are disambiguated by
		//		longest prefix. See `dojo.registerModulePath()` for details on
		//		registering new modules.
		//	omitModuleCheck:
		//		if `true`, omitModuleCheck skips the step of ensuring that the
		//		loaded file actually defines the symbol it is referenced by.
		//		For example if it called as `dojo.require(""a.b.c"")` and the
		//		file located at `a/b/c.js` does not define an object `a.b.c`,
		//		and exception will be throws whereas no exception is raised
		//		when called as `dojo.require(""a.b.c"", true)`
		//	description:
		//		`dojo.require(""A.B"")` first checks to see if symbol A.B is
		//		defined. If it is, it is simply returned (nothing to do).
		//	
		//		If it is not defined, it will look for `A/B.js` in the script root
		//		directory.
		//	
		//		`dojo.require` throws an excpetion if it cannot find a file
		//		to load, or if the symbol `A.B` is not defined after loading.
		//	
		//		It returns the object `A.B`.
		//	
		//		`dojo.require()` does nothing about importing symbols into
		//		the current namespace.  It is presumed that the caller will
		//		take care of that. For example, to import all symbols into a
		//		local block, you might write:
		//	
		//		|	with (dojo.require(""A.B"")) {
		//		|		...
		//		|	}
		//	
		//		And to import just the leaf symbol to a local variable:
		//	
		//		|	var B = dojo.require(""A.B"");
		//	   	|	...
		//	returns: the required namespace object
		omitModuleCheck = this._global_omit_module_check || omitModuleCheck;

		//Check if it is already loaded.
		var module = this._loadedModules[moduleName];
		if(module){
			return module;
		}

		// convert periods to slashes
		var relpath = this._getModuleSymbols(moduleName).join(""/"") + '.js';

		var modArg = (!omitModuleCheck) ? moduleName : null;
		var ok = this._loadPath(relpath, modArg);

		if(!ok && !omitModuleCheck){
			throw new Error(""Could not load '"" + moduleName + ""'; last tried '"" + relpath + ""'"");
		}

		// check that the symbol was defined
		// Don't bother if we're doing xdomain (asynchronous) loading.
		if(!omitModuleCheck && !this._isXDomain){
			// pass in false so we can give better error
			module = this._loadedModules[moduleName];
			if(!module){
				throw new Error(""symbol '"" + moduleName + ""' is not defined after loading '"" + relpath + ""'""); 
			}
		}

		return module;
	}

	dojo.provide = function(/*String*/ resourceName){
		//	summary:
		//		Each javascript source file must have at least one
		//		`dojo.provide()` call at the top of the file, corresponding to
		//		the file name.  For example, `js/dojo/foo.js` must have
		//		`dojo.provide(""dojo.foo"");` before any calls to
		//		`dojo.require()` are made.
		//	description:
		//		Each javascript source file is called a resource.  When a
		//		resource is loaded by the browser, `dojo.provide()` registers
		//		that it has been loaded.
		//	
		//		For backwards compatibility reasons, in addition to registering
		//		the resource, `dojo.provide()` also ensures that the javascript
		//		object for the module exists.  For example,
		//		`dojo.provide(""dojox.data.FlickrStore"")`, in addition to
		//		registering that `FlickrStore.js` is a resource for the
		//		`dojox.data` module, will ensure that the `dojox.data`
		//		javascript object exists, so that calls like 
		//		`dojo.data.foo = function(){ ... }` don't fail.
		//
		//		In the case of a build where multiple javascript source files
		//		are combined into one bigger file (similar to a .lib or .jar
		//		file), that file may contain multiple dojo.provide() calls, to
		//		note that it includes multiple resources.

		//Make sure we have a string.
		resourceName = resourceName + """";
		return (d._loadedModules[resourceName] = d.getObject(resourceName, true)); // Object
	}

	//Start of old bootstrap2:

	dojo.platformRequire = function(/*Object*/modMap){
		//	summary:
		//		require one or more modules based on which host environment
		//		Dojo is currently operating in
		//	description:
		//		This method takes a ""map"" of arrays which one can use to
		//		optionally load dojo modules. The map is indexed by the
		//		possible dojo.name_ values, with two additional values:
		//		""default"" and ""common"". The items in the ""default"" array will
		//		be loaded if none of the other items have been choosen based on
		//		dojo.name_, set by your host environment. The items in the
		//		""common"" array will *always* be loaded, regardless of which
		//		list is chosen.
		//	example:
		//		|	dojo.platformRequire({
		//		|		browser: [
		//		|			""foo.sample"", // simple module
		//		|			""foo.test"",
		//		|			[""foo.bar.baz"", true] // skip object check in _loadModule (dojo.require)
		//		|		],
		//		|		default: [ ""foo.sample._base"" ],
		//		|		common: [ ""important.module.common"" ]
		//		|	});

		var common = modMap.common || [];
		var result = common.concat(modMap[d._name] || modMap[""default""] || []);

		for(var x=0; x<result.length; x++){
			var curr = result[x];
			if(curr.constructor == Array){
				d._loadModule.apply(d, curr);
			}else{
				d._loadModule(curr);
			}
		}
	}

	dojo.requireIf = function(/*Boolean*/ condition, /*String*/ resourceName){
		// summary:
		//		If the condition is true then call dojo.require() for the specified
		//		resource
		if(condition === true){
			// FIXME: why do we support chained require()'s here? does the build system?
			var args = [];
			for(var i = 1; i < arguments.length; i++){ 
				args.push(arguments[i]);
			}
			d.require.apply(d, args);
		}
	}

	dojo.requireAfterIf = d.requireIf;

	dojo.registerModulePath = function(/*String*/module, /*String*/prefix){
		//	summary: 
		//		maps a module name to a path
		//	description: 
		//		An unregistered module is given the default path of ../[module],
		//		relative to Dojo root. For example, module acme is mapped to
		//		../acme.  If you want to use a different module name, use
		//		dojo.registerModulePath. 
		//	example:
		//		If your dojo.js is located at this location in the web root:
		//	|	/myapp/js/dojo/dojo/dojo.js
		//		and your modules are located at:
		//	|	/myapp/js/foo/bar.js
		//	|	/myapp/js/foo/baz.js
		//	|	/myapp/js/foo/thud/xyzzy.js
		//		Your application can tell Dojo to locate the ""foo"" namespace by calling:
		//	|	dojo.registerModulePath(""foo"", ""../../foo"");
		//		At which point you can then use dojo.require() to load the
		//		modules (assuming they provide() the same things which are
		//		required). The full code might be:
		//	|	<script type=""text/javascript"" 
		//	|		src=""/myapp/js/dojo/dojo/dojo.js""></script>
		//	|	<script type=""text/javascript"">
		//	|		dojo.registerModulePath(""foo"", ""../../foo"");
		//	|		dojo.require(""foo.bar"");
		//	|		dojo.require(""foo.baz"");
		//	|		dojo.require(""foo.thud.xyzzy"");
		//	|	</script>
		d._modulePrefixes[module] = { name: module, value: prefix };
	}

	dojo.requireLocalization = function(/*String*/moduleName, /*String*/bundleName, /*String?*/locale, /*String?*/availableFlatLocales){
		// summary:
		//		Declares translated resources and loads them if necessary, in the
		//		same style as dojo.require.  Contents of the resource bundle are
		//		typically strings, but may be any name/value pair, represented in
		//		JSON format.  See also `dojo.i18n.getLocalization`.
		//
		// description:
		//		Load translated resource bundles provided underneath the ""nls""
		//		directory within a package.  Translated resources may be located in
		//		different packages throughout the source tree.  
		//
		//		Each directory is named for a locale as specified by RFC 3066,
		//		(http://www.ietf.org/rfc/rfc3066.txt), normalized in lowercase.
		//		Note that the two bundles in the example do not define all the
		//		same variants.  For a given locale, bundles will be loaded for
		//		that locale and all more general locales above it, including a
		//		fallback at the root directory.  For example, a declaration for
		//		the ""de-at"" locale will first load `nls/de-at/bundleone.js`,
		//		then `nls/de/bundleone.js` and finally `nls/bundleone.js`.  The
		//		data will be flattened into a single Object so that lookups
		//		will follow this cascading pattern.  An optional build step can
		//		preload the bundles to avoid data redundancy and the multiple
		//		network hits normally required to load these resources.
		//
		// moduleName: 
		//		name of the package containing the ""nls"" directory in which the
		//		bundle is found
		//
		// bundleName: 
		//		bundle name, i.e. the filename without the '.js' suffix
		//
		// locale: 
		//		the locale to load (optional)  By default, the browser's user
		//		locale as defined by dojo.locale
		//
		// availableFlatLocales: 
		//		A comma-separated list of the available, flattened locales for this
		//		bundle. This argument should only be set by the build process.
		//
		//	example:
		//		A particular widget may define one or more resource bundles,
		//		structured in a program as follows, where moduleName is
		//		mycode.mywidget and bundleNames available include bundleone and
		//		bundletwo:
		//	|		...
		//	|	mycode/
		//	|		mywidget/
		//	|			nls/
		//	|				bundleone.js (the fallback translation, English in this example)
		//	|				bundletwo.js (also a fallback translation)
		//	|				de/
		//	|					bundleone.js
		//	|					bundletwo.js
		//	|				de-at/
		//	|					bundleone.js
		//	|				en/
		//	|					(empty; use the fallback translation)
		//	|				en-us/
		//	|					bundleone.js
		//	|				en-gb/
		//	|					bundleone.js
		//	|				es/
		//	|					bundleone.js
		//	|					bundletwo.js
		//	|				  ...etc
		//	|				...
		//

		d.require(""dojo.i18n"");
		d.i18n._requireLocalization.apply(d.hostenv, arguments);
	};


	var ore = new RegExp(""^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"");
	var ire = new RegExp(""^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$"");

	dojo._Url = function(/*dojo._Url||String...*/){
		// summary: 
		//		Constructor to create an object representing a URL.
		//		It is marked as private, since we might consider removing
		//		or simplifying it.
		// description: 
		//		Each argument is evaluated in order relative to the next until
		//		a canonical uri is produced. To get an absolute Uri relative to
		//		the current document use:
		//      	new dojo._Url(document.baseURI, url)

		var n = null;

		var _a = arguments;
		var uri = [_a[0]];
		// resolve uri components relative to each other
		for(var i = 1; i<_a.length; i++){
			if(!_a[i]){ continue; }

			// Safari doesn't support this.constructor so we have to be explicit
			// FIXME: Tracked (and fixed) in Webkit bug 3537.
			//		http://bugs.webkit.org/show_bug.cgi?id=3537
			var relobj = new d._Url(_a[i]+"""");
			var uriobj = new d._Url(uri[0]+"""");

			if(
				relobj.path == """" &&
				!relobj.scheme &&
				!relobj.authority &&
				!relobj.query
			){
				if(relobj.fragment != n){
					uriobj.fragment = relobj.fragment;
				}
				relobj = uriobj;
			}else if(!relobj.scheme){
				relobj.scheme = uriobj.scheme;

				if(!relobj.authority){
					relobj.authority = uriobj.authority;

					if(relobj.path.charAt(0) != ""/""){
						var path = uriobj.path.substring(0,
							uriobj.path.lastIndexOf(""/"") + 1) + relobj.path;

						var segs = path.split(""/"");
						for(var j = 0; j < segs.length; j++){
							if(segs[j] == "".""){
								// flatten ""./"" references
								if(j == segs.length - 1){
									segs[j] = """";
								}else{
									segs.splice(j, 1);
									j--;
								}
							}else if(j > 0 && !(j == 1 && segs[0] == """") &&
								segs[j] == "".."" && segs[j-1] != ""..""){
								// flatten ""../"" references
								if(j == (segs.length - 1)){
									segs.splice(j, 1);
									segs[j - 1] = """";
								}else{
									segs.splice(j - 1, 2);
									j -= 2;
								}
							}
						}
						relobj.path = segs.join(""/"");
					}
				}
			}

			uri = [];
			if(relobj.scheme){ 
				uri.push(relobj.scheme, "":"");
			}
			if(relobj.authority){
				uri.push(""//"", relobj.authority);
			}
			uri.push(relobj.path);
			if(relobj.query){
				uri.push(""?"", relobj.query);
			}
			if(relobj.fragment){
				uri.push(""#"", relobj.fragment);
			}
		}

		this.uri = uri.join("""");

		// break the uri into its main components
		var r = this.uri.match(ore);

		this.scheme = r[2] || (r[1] ? """" : n);
		this.authority = r[4] || (r[3] ? """" : n);
		this.path = r[5]; // can never be undefined
		this.query = r[7] || (r[6] ? """" : n);
		this.fragment  = r[9] || (r[8] ? """" : n);

		if(this.authority != n){
			// server based naming authority
			r = this.authority.match(ire);

			this.user = r[3] || n;
			this.password = r[4] || n;
			this.host = r[6] || r[7]; // ipv6 || ipv4
			this.port = r[9] || n;
		}
	}

	dojo._Url.prototype.toString = function(){ return this.uri; };

	dojo.moduleUrl = function(/*String*/module, /*dojo._Url||String*/url){
		//	summary: 
		//		Returns a `dojo._Url` object relative to a module.
		//	example:
		//	|	var pngPath = dojo.moduleUrl(""acme"",""images/small.png"");
		//	|	 // list the object properties
		//	|	// create an image and set it's source to pngPath's value:
		//	|	var img = document.createElement(""img"");
		// 	|	// NOTE: we assign the string representation of the url object
		//	|	img.src = pngPath.toString(); 
		//	|	// add our image to the document
		//	|	dojo.body().appendChild(img);
		//	example: 
		//		you may de-reference as far as you like down the package
		//		hierarchy.  This is sometimes handy to avoid lenghty relative
		//		urls or for building portable sub-packages. In this example,
		//		the `acme.widget` and `acme.util` directories may be located
		//		under different roots (see `dojo.registerModulePath`) but the
		//		the modules which reference them can be unaware of their
		//		relative locations on the filesystem:
		//	|	// somewhere in a configuration block
		//	|	dojo.registerModulePath(""acme.widget"", ""../../acme/widget"");
		//	|	dojo.registerModulePath(""acme.util"", ""../../util"");
		//	|	
		//	|	// ...
		//	|	
		//	|	// code in a module using acme resources
		//	|	var tmpltPath = dojo.moduleUrl(""acme.widget"",""templates/template.html"");
		//	|	var dataPath = dojo.moduleUrl(""acme.util"",""resources/data.json"");

		var loc = d._getModuleSymbols(module).join('/');
		if(!loc){ return null; }
		if(loc.lastIndexOf(""/"") != loc.length-1){
			loc += ""/"";
		}
		
		//If the path is an absolute path (starts with a / or is on another
		//domain/xdomain) then don't add the baseUrl.
		var colonIndex = loc.indexOf("":"");
		if(loc.charAt(0) != ""/"" && (colonIndex == -1 || colonIndex > loc.indexOf(""/""))){
			loc = d.baseUrl + loc;
		}

		return new d._Url(loc, url); // String
	}
})();

/*=====
dojo.isBrowser = {
	//	example:
	//	|	if(dojo.isBrowser){ ... }
};

dojo.isFF = {
	//	example:
	//	|	if(dojo.isFF > 1){ ... }
};

dojo.isIE = {
	// example:
	//	|	if(dojo.isIE > 6){
	//	|		// we are IE7
	// 	|	}
};

dojo.isSafari = {
	//	example:
	//	|	if(dojo.isSafari){ ... }
	//	example: 
	//		Detect iPhone:
	//	|	if(dojo.isSafari && navigator.userAgent.indexOf(""iPhone"") != -1){ 
	//	|		// we are iPhone. Note, iPod touch reports ""iPod"" above and fails this test.
	//	|	}
};

dojo = {
	// isBrowser: Boolean
	//		True if the client is a web-browser
	isBrowser: true,
	//	isFF: Number | undefined
	//		Version as a Number if client is FireFox. undefined otherwise. Corresponds to
	//		major detected FireFox version (1.5, 2, 3, etc.)
	isFF: 2,
	//	isIE: Number | undefined
	//		Version as a Number if client is MSIE(PC). undefined otherwise. Corresponds to
	//		major detected IE version (6, 7, 8, etc.)
	isIE: 6,
	//	isKhtml: Number | undefined
	//		Version as a Number if client is a KTHML-derived browser (Konqueror,
	//		Safari, etc.). undefined otherwise. Corresponds to major detected version.
	isKhtml: 0,
	//	isMozilla: Number | undefined
	//		Version as a Number if client is a Mozilla-based browser (Firefox,
	//		SeaMonkey). undefined otherwise. Corresponds to major detected version.
	isMozilla: 0,
	//	isOpera: Number | undefined
	//		Version as a Number if client is Opera. undefined otherwise. Corresponds to
	//		major detected version.
	isOpera: 0,
	//	isSafari: Number | undefined
	//		Version as a Number if client is Safari or iPhone. undefined otherwise.
	isSafari: 0
}
=====*/

if(typeof window != 'undefined'){
	dojo.isBrowser = true;
	dojo._name = ""browser"";


	// attempt to figure out the path to dojo if it isn't set in the config
	(function(){
		var d = dojo;
		// this is a scope protection closure. We set browser versions and grab
		// the URL we were loaded from here.

		// grab the node we were loaded from
		if(document && document.getElementsByTagName){
			var scripts = document.getElementsByTagName(""script"");
			var rePkg = /dojo(\.xd)?\.js(\W|$)/i;
			for(var i = 0; i < scripts.length; i++){
				var src = scripts[i].getAttribute(""src"");
				if(!src){ continue; }
				var m = src.match(rePkg);
				if(m){
					// find out where we came from
					if(!d.config.baseUrl){
						d.config.baseUrl = src.substring(0, m.index);
					}
					// and find out if we need to modify our behavior
					var cfg = scripts[i].getAttribute(""djConfig"");
					if(cfg){
						var cfgo = eval(""({ ""+cfg+"" })"");
						for(var x in cfgo){
							dojo.config[x] = cfgo[x];
						}
					}
					break; // ""first Dojo wins""
				}
			}
		}
		d.baseUrl = d.config.baseUrl;

		// fill in the rendering support information in dojo.render.*
		var n = navigator;
		var dua = n.userAgent;
		var dav = n.appVersion;
		var tv = parseFloat(dav);

		if(dua.indexOf(""Opera"") >= 0){ d.isOpera = tv; }
		// safari detection derived from:
		//		http://developer.apple.com/internet/safari/faq.html#anchor2
		//		http://developer.apple.com/internet/safari/uamatrix.html
		var index = Math.max(dav.indexOf(""WebKit""), dav.indexOf(""Safari""), 0);
		if(index){
			// try to grab the explicit Safari version first. If we don't get
			// one, look for 419.3+ as the indication that we're on something
			// ""Safari 3-ish"". Lastly, default to ""Safari 2"" handling.
			d.isSafari = parseFloat(dav.split(""Version/"")[1]) ||
				(parseFloat(dav.substr(index + 7)) > 419.3) ? 3 : 2;
		}
		if(dua.indexOf(""AdobeAIR"") >= 0){ d.isAIR = 1; }
		if(dav.indexOf(""Konqueror"") >= 0 || d.isSafari){ d.isKhtml =  tv; }
		if(dua.indexOf(""Gecko"") >= 0 && !d.isKhtml){ d.isMozilla = d.isMoz = tv; }
		if(d.isMoz){
			d.isFF = parseFloat(dua.split(""Firefox/"")[1]) || undefined;
		}
		if(document.all && !d.isOpera){
			d.isIE = parseFloat(dav.split(""MSIE "")[1]) || undefined;
		}

		//Workaround to get local file loads of dojo to work on IE 7
		//by forcing to not use native xhr.
		if(dojo.isIE && window.location.protocol === ""file:""){
			dojo.config.ieForceActiveXXhr=true;
		}

		var cm = document.compatMode;
		d.isQuirks = cm == ""BackCompat"" || cm == ""QuirksMode"" || d.isIE < 6;

		// TODO: is the HTML LANG attribute relevant?
		d.locale = dojo.config.locale || (d.isIE ? n.userLanguage : n.language).toLowerCase();

		// These are in order of decreasing likelihood; this will change in time.
		d._XMLHTTP_PROGIDS = ['Msxml2.XMLHTTP', 'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.4.0'];

		d._xhrObj = function(){
			// summary: 
			//		does the work of portably generating a new XMLHTTPRequest
			//		object.
			var http = null;
			var last_e = null;
			if(!dojo.isIE || !dojo.config.ieForceActiveXXhr){
				try{ http = new XMLHttpRequest(); }catch(e){}
			}
			if(!http){
				for(var i=0; i<3; ++i){
					var progid = d._XMLHTTP_PROGIDS[i];
					try{
						http = new ActiveXObject(progid);
					}catch(e){
						last_e = e;
					}

					if(http){
						d._XMLHTTP_PROGIDS = [progid];  // so faster next time
						break;
					}
				}
			}

			if(!http){
				throw new Error(""XMLHTTP not available: ""+last_e);
			}

			return http; // XMLHTTPRequest instance
		}

		d._isDocumentOk = function(http){
			var stat = http.status || 0;
			return (stat >= 200 && stat < 300) || 	// Boolean
				stat == 304 || 						// allow any 2XX response code
				stat == 1223 || 						// get it out of the cache
				(!stat && (location.protocol==""file:"" || location.protocol==""chrome:"") ); // Internet Explorer mangled the status code
		}

		//See if base tag is in use.
		//This is to fix http://trac.dojotoolkit.org/ticket/3973,
		//but really, we need to find out how to get rid of the dojo._Url reference
		//below and still have DOH work with the dojo.i18n test following some other
		//test that uses the test frame to load a document (trac #2757).
		//Opera still has problems, but perhaps a larger issue of base tag support
		//with XHR requests (hasBase is true, but the request is still made to document
		//path, not base path).
		var owloc = window.location+"""";
		var base = document.getElementsByTagName(""base"");
		var hasBase = (base && base.length > 0);

		d._getText = function(/*URI*/ uri, /*Boolean*/ fail_ok){
			// summary: Read the contents of the specified uri and return those contents.
			// uri:
			//		A relative or absolute uri. If absolute, it still must be in
			//		the same ""domain"" as we are.
			// fail_ok:
			//		Default false. If fail_ok and loading fails, return null
			//		instead of throwing.
			// returns: The response text. null is returned when there is a
			//		failure and failure is okay (an exception otherwise)

			// alert(""_getText: "" + uri);

			// NOTE: must be declared before scope switches ie. this._xhrObj()
			var http = this._xhrObj();

			if(!hasBase && dojo._Url){
				uri = (new dojo._Url(owloc, uri)).toString();
			}
			/*
			
			
			alert(uri);
			*/

			if(d.config.cacheBust){
				//Make sure we have a string before string methods are used on uri
				uri += """";
				uri += (uri.indexOf(""?"") == -1 ? ""?"" : ""&"") + String(d.config.cacheBust).replace(/\W+/g,"""");
			}

			http.open('GET', uri, false);
			try{
				http.send(null);
				// alert(http);
				if(!d._isDocumentOk(http)){
					var err = Error(""Unable to load ""+uri+"" status:""+ http.status);
					err.status = http.status;
					err.responseText = http.responseText;
					throw err;
				}
			}catch(e){
				if(fail_ok){ return null; } // null
				// rethrow the exception
				throw e;
			}
			return http.responseText; // String
		}
		
		d._windowUnloaders = [];
		
		d.windowUnloaded = function(){
			// summary:
			//		signal fired by impending window destruction. You may use
			//		dojo.addOnWIndowUnload() or dojo.connect() to this method to perform
			//		page/application cleanup methods. See dojo.addOnWindowUnload for more info.
			var mll = this._windowUnloaders;
			while(mll.length){
				(mll.pop())();
			}
		}

		d.addOnWindowUnload = function(/*Object?*/obj, /*String|Function?*/functionName){
			// summary:
			//		registers a function to be triggered when window.onunload fires.
			//		Be careful trying to modify the DOM or access JavaScript properties
			//		during this phase of page unloading: they may not always be available.
			//		Consider dojo.addOnUnload() if you need to modify the DOM or do heavy
			//		JavaScript work.
			// example:
			//	|	dojo.addOnWindowUnload(functionPointer)
			//	|	dojo.addOnWindowUnload(object, ""functionName"")
			//	|	dojo.addOnWindowUnload(object, function(){ /* ... */});
	
			d._onto(d._windowUnloaders, obj, functionName);
		}
	})();

	dojo._initFired = false;
	//	BEGIN DOMContentLoaded, from Dean Edwards (http://dean.edwards.name/weblog/2006/06/again/)
	dojo._loadInit = function(e){
		dojo._initFired = true;
		// allow multiple calls, only first one will take effect
		// A bug in khtml calls events callbacks for document for event which isnt supported
		// for example a created contextmenu event calls DOMContentLoaded, workaround
		var type = (e && e.type) ? e.type.toLowerCase() : ""load"";
		if(arguments.callee.initialized || (type != ""domcontentloaded"" && type != ""load"")){ return; }
		arguments.callee.initialized = true;
		if(""_khtmlTimer"" in dojo){
			clearInterval(dojo._khtmlTimer);
			delete dojo._khtmlTimer;
		}

		if(dojo._inFlightCount == 0){
			dojo._modulesLoaded();
		}
	}

	dojo._fakeLoadInit = function(){
		dojo._loadInit({type: ""load""});
	}

	if(!dojo.config.afterOnLoad){
		//	START DOMContentLoaded
		// Mozilla and Opera 9 expose the event we could use
		if(document.addEventListener){
			// NOTE: 
			//		due to a threading issue in Firefox 2.0, we can't enable
			//		DOMContentLoaded on that platform. For more information, see:
			//		http://trac.dojotoolkit.org/ticket/1704
			if(dojo.isOpera || dojo.isFF >= 3 || (dojo.isMoz && dojo.config.enableMozDomContentLoaded === true)){
				document.addEventListener(""DOMContentLoaded"", dojo._loadInit, null);
			}
	
			//	mainly for Opera 8.5, won't be fired if DOMContentLoaded fired already.
			//  also used for Mozilla because of trac #1640
			window.addEventListener(""load"", dojo._loadInit, null);
		}
	
		if(dojo.isAIR){
			window.addEventListener(""load"", dojo._loadInit, null);
		}else if(/(WebKit|khtml)/i.test(navigator.userAgent)){ // sniff
			dojo._khtmlTimer = setInterval(function(){
				if(/loaded|complete/.test(document.readyState)){
					dojo._loadInit(); // call the onload handler
				}
			}, 10);
		}
		//	END DOMContentLoaded
	}

	(function(){
		var _w = window;
		var _handleNodeEvent = function(/*String*/evtName, /*Function*/fp){
			// summary:
			//		non-destructively adds the specified function to the node's
			//		evtName handler.
			// evtName: should be in the form ""onclick"" for ""onclick"" handlers.
			// Make sure you pass in the ""on"" part.
			var oldHandler = _w[evtName] || function(){};
			_w[evtName] = function(){
				fp.apply(_w, arguments);
				oldHandler.apply(_w, arguments);
			};
		};

		if(dojo.isIE){
			// 	for Internet Explorer. readyState will not be achieved on init
			// 	call, but dojo doesn't need it however, we'll include it
			// 	because we don't know if there are other functions added that
			// 	might.  Note that this has changed because the build process
			// 	strips all comments -- including conditional ones.
			if(!dojo.config.afterOnLoad){
				document.write('<scr'+'ipt defer src=""//:"" '
					+ 'onreadystatechange=""if(this.readyState==\'complete\'){' + dojo._scopeName + '._loadInit();}"">'
					+ '</scr'+'ipt>'
				);
			}

			try{
				document.namespaces.add(""v"",""urn:schemas-microsoft-com:vml"");
				document.createStyleSheet().addRule(""v\\:*"", ""behavior:url(#default#VML)"");
			}catch(e){}
		}

		// FIXME: dojo.unloaded requires dojo scope, so using anon function wrapper.
		_handleNodeEvent(""onbeforeunload"", function() { dojo.unloaded(); });
		_handleNodeEvent(""onunload"", function() { dojo.windowUnloaded(); });
	})();

	/*
	OpenAjax.subscribe(""OpenAjax"", ""onload"", function(){
		if(dojo._inFlightCount == 0){
			dojo._modulesLoaded();
		}
	});

	OpenAjax.subscribe(""OpenAjax"", ""onunload"", function(){
		dojo.unloaded();
	});
	*/
} //if (typeof window != 'undefined')

//Register any module paths set up in djConfig. Need to do this
//in the hostenvs since hostenv_browser can read djConfig from a
//script tag's attribute.
(function(){
	var mp = dojo.config[""modulePaths""];
	if(mp){
		for(var param in mp){
			dojo.registerModulePath(param, mp[param]);
		}
	}
})();

//Load debug code if necessary.
if(dojo.config.isDebug){
	dojo.require(""dojo._firebug.firebug"");
}

if(dojo.config.debugAtAllCosts){
	dojo.config.useXDomain = true;
	dojo.require(""dojo._base._loader.loader_xd"");
	dojo.require(""dojo._base._loader.loader_debug"");
	dojo.require(""dojo.i18n"");
}

if(!dojo._hasResource[""dojo._base.lang""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.lang""] = true;
dojo.provide(""dojo._base.lang"");

// Crockford (ish) functions

dojo.isString = function(/*anything*/ it){
	//	summary:
	//		Return true if it is a String
	return !!arguments.length && it != null && (typeof it == ""string"" || it instanceof String); // Boolean
}

dojo.isArray = function(/*anything*/ it){
	//	summary:
	//		Return true if it is an Array
	return it && (it instanceof Array || typeof it == ""array""); // Boolean
}

/*=====
dojo.isFunction = function(it){
	// summary: Return true if it is a Function
	// it: anything
	return; // Boolean
}
=====*/

dojo.isFunction = (function(){
	var _isFunction = function(/*anything*/ it){
		return it && (typeof it == ""function"" || it instanceof Function); // Boolean
	};

	return dojo.isSafari ?
		// only slow this down w/ gratuitious casting in Safari since it's what's b0rken
		function(/*anything*/ it){
			if(typeof it == ""function"" && it == ""[object NodeList]""){ return false; }
			return _isFunction(it); // Boolean
		} : _isFunction;
})();

dojo.isObject = function(/*anything*/ it){
	// summary: 
	//		Returns true if it is a JavaScript object (or an Array, a Function
	//		or null)
	return it !== undefined &&
		(it === null || typeof it == ""object"" || dojo.isArray(it) || dojo.isFunction(it)); // Boolean
}

dojo.isArrayLike = function(/*anything*/ it){
	//	summary:
	//		similar to dojo.isArray() but more permissive
	//	description:
	//		Doesn't strongly test for ""arrayness"".  Instead, settles for ""isn't
	//		a string or number and has a length property"". Arguments objects
	//		and DOM collections will return true when passed to
	//		dojo.isArrayLike(), but will return false when passed to
	//		dojo.isArray().
	//	returns:
	//		If it walks like a duck and quicks like a duck, return `true`
	var d = dojo;
	return it && it !== undefined && // Boolean
		// keep out built-in constructors (Number, String, ...) which have length
		// properties
		!d.isString(it) && !d.isFunction(it) &&
		!(it.tagName && it.tagName.toLowerCase() == 'form') &&
		(d.isArray(it) || isFinite(it.length));
}

dojo.isAlien = function(/*anything*/ it){
	// summary: 
	//		Returns true if it is a built-in function or some other kind of
	//		oddball that *should* report as a function but doesn't
	return it && !dojo.isFunction(it) && /\{\s*\[native code\]\s*\}/.test(String(it)); // Boolean
}

dojo.extend = function(/*Object*/ constructor, /*Object...*/ props){
	// summary:
	//		Adds all properties and methods of props to constructor's
	//		prototype, making them available to all instances created with
	//		constructor.
	for(var i=1, l=arguments.length; i<l; i++){
		dojo._mixin(constructor.prototype, arguments[i]);
	}
	return constructor; // Object
}

dojo._hitchArgs = function(scope, method /*,...*/){
	var pre = dojo._toArray(arguments, 2);
	var named = dojo.isString(method);
	return function(){
		// arrayify arguments
		var args = dojo._toArray(arguments);
		// locate our method
		var f = named ? (scope||dojo.global)[method] : method;
		// invoke with collected args
		return f && f.apply(scope || this, pre.concat(args)); // mixed
 	} // Function
}

dojo.hitch = function(/*Object*/scope, /*Function|String*/method /*,...*/){
	//	summary: 
	//		Returns a function that will only ever execute in the a given scope. 
	//		This allows for easy use of object member functions
	//		in callbacks and other places in which the ""this"" keyword may
	//		otherwise not reference the expected scope. 
	//		Any number of default positional arguments may be passed as parameters 
	//		beyond ""method"".
	//		Each of these values will be used to ""placehold"" (similar to curry)
	//		for the hitched function. 
	//	scope: 
	//		The scope to use when method executes. If method is a string, 
	//		scope is also the object containing method.
	//	method:
	//		A function to be hitched to scope, or the name of the method in
	//		scope to be hitched.
	//	example:
	//	|	dojo.hitch(foo, ""bar"")(); 
	//		runs foo.bar() in the scope of foo
	//	example:
	//	|	dojo.hitch(foo, myFunction);
	//		returns a function that runs myFunction in the scope of foo
	if(arguments.length > 2){
		return dojo._hitchArgs.apply(dojo, arguments); // Function
	}
	if(!method){
		method = scope;
		scope = null;
	}
	if(dojo.isString(method)){
		scope = scope || dojo.global;
		if(!scope[method]){ throw(['dojo.hitch: scope[""', method, '""] is null (scope=""', scope, '"")'].join('')); }
		return function(){ return scope[method].apply(scope, arguments || []); }; // Function
	}
	return !scope ? method : function(){ return method.apply(scope, arguments || []); }; // Function
}

/*=====
dojo.delegate = function(obj, props){
	//	summary:
	//		returns a new object which ""looks"" to obj for properties which it
	//		does not have a value for. Optionally takes a bag of properties to
	//		seed the returned object with initially. 
	//	description:
	//		This is a small implementaton of the Boodman/Crockford delegation
	//		pattern in JavaScript. An intermediate object constructor mediates
	//		the prototype chain for the returned object, using it to delegate
	//		down to obj for property lookup when object-local lookup fails.
	//		This can be thought of similarly to ES4's ""wrap"", save that it does
	//		not act on types but rather on pure objects.
	//	obj:
	//		The object to delegate to for properties not found directly on the
	//		return object or in props.
	//	props:
	//		an object containing properties to assign to the returned object
	//	returns:
	//		an Object of anonymous type
	//	example:
	//	|	var foo = { bar: ""baz"" };
	//	|	var thinger = dojo.delegate(foo, { thud: ""xyzzy""});
	//	|	thinger.bar == ""baz""; // delegated to foo
	//	|	foo.thud == undefined; // by definition
	//	|	thinger.thud == ""xyzzy""; // mixed in from props
	//	|	foo.bar = ""thonk"";
	//	|	thinger.bar == ""thonk""; // still delegated to foo's bar
}
=====*/

dojo.delegate = dojo._delegate = (function(){
	// boodman/crockford delegation w/ cornford optimization
	function TMP(){};
	return function(obj, props){
		TMP.prototype = obj;
		var tmp = new TMP();
		if(props){
			dojo._mixin(tmp, props);
		}
		return tmp; // Object
	}
})();

/*=====
dojo._toArray = function(obj, offset, startWith){
	//	summary:
	//		Converts an array-like object (i.e. arguments, DOMCollection) to an
	//		array. Returns a new Array with the elements of obj.
	//	obj: Object
	//		the object to ""arrayify"". We expect the object to have, at a
	//		minimum, a length property which corresponds to integer-indexed
	//		properties.
	//	offset: Number?
	//		the location in obj to start iterating from. Defaults to 0.
	//		Optional.
	//	startWith: Array?
	//		An array to pack with the properties of obj. If provided,
	//		properties in obj are appended at the end of startWith and
	//		startWith is the returned array.
}
=====*/

(function(){
	var efficient = function(obj, offset, startWith){
		return (startWith||[]).concat(Array.prototype.slice.call(obj, offset||0));
	};

	var slow = function(obj, offset, startWith){
		var arr = startWith||[]; 
		for(var x = offset || 0; x < obj.length; x++){ 
			arr.push(obj[x]); 
		} 
		return arr;
	};

	dojo._toArray = (!dojo.isIE) ? efficient : function(obj){
		return ((obj.item) ? slow : efficient).apply(this, arguments);
	};

})();

dojo.partial = function(/*Function|String*/method /*, ...*/){
	//	summary:
	//		similar to hitch() except that the scope object is left to be
	//		whatever the execution context eventually becomes.
	//	description:
	//		Calling dojo.partial is the functional equivalent of calling:
	//		|	dojo.hitch(null, funcName, ...);
	var arr = [ null ];
	return dojo.hitch.apply(dojo, arr.concat(dojo._toArray(arguments))); // Function
}

dojo.clone = function(/*anything*/ o){
	// summary:
	//		Clones objects (including DOM nodes) and all children.
	//		Warning: do not clone cyclic structures.
	if(!o){ return o; }
	if(dojo.isArray(o)){
		var r = [];
		for(var i = 0; i < o.length; ++i){
			r.push(dojo.clone(o[i]));
		}
		return r; // Array
	}
	if(!dojo.isObject(o)){
		return o;	/*anything*/
	}
	if(o.nodeType && o.cloneNode){ // isNode
		return o.cloneNode(true); // Node
	}
	if(o instanceof Date){
		return new Date(o.getTime());	// Date
	}
	// Generic objects
	var r = new o.constructor(); // specific to dojo.declare()'d classes!
	for(var i in o){
		if(!(i in r) || r[i] != o[i]){
			r[i] = dojo.clone(o[i]);
		}
	}
	return r; // Object
}

dojo.trim = function(/*String*/ str){
	// summary: 
	//		trims whitespaces from both sides of the string
	// description:
	//		This version of trim() was selected for inclusion into the base due
	//		to its compact size and relatively good performance (see Steven
	//		Levithan's blog:
	//		http://blog.stevenlevithan.com/archives/faster-trim-javascript).
	//		The fastest but longest version of this function is located at
	//		dojo.string.trim()
	return str.replace(/^\s\s*/, '').replace(/\s\s*$/, '');	// String
}

}

if(!dojo._hasResource[""dojo._base.declare""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.declare""] = true;
dojo.provide(""dojo._base.declare"");


// this file courtesy of the TurboAjax Group, licensed under a Dojo CLA

dojo.declare = function(/*String*/ className, /*Function|Function[]*/ superclass, /*Object*/ props){
	//	summary: 
	//		Create a feature-rich constructor from compact notation
	//	className:
	//		The name of the constructor (loosely, a ""class"")
	//		stored in the ""declaredClass"" property in the created prototype
	//	superclass:
	//		May be null, a Function, or an Array of Functions. If an array, 
	//		the first element is used as the prototypical ancestor and
	//		any following Functions become mixin ancestors.
	//	props:
	//		An object whose properties are copied to the
	//		created prototype.
	//		Add an instance-initialization function by making it a property 
	//		named ""constructor"".
	//	description:
	//		Create a constructor using a compact notation for inheritance and
	//		prototype extension. 
	//
	//		All superclasses (including mixins) must be Functions (not simple Objects).
	//
	//		Mixin ancestors provide a type of multiple inheritance. Prototypes of mixin 
	//		ancestors are copied to the new class: changes to mixin prototypes will
	//		not affect classes to which they have been mixed in.
	//
	//		""className"" is cached in ""declaredClass"" property of the new class.
	//
	//	example:
	//	|	dojo.declare(""my.classes.bar"", my.classes.foo, {
	//	|		// properties to be added to the class prototype
	//	|		someValue: 2,
	//	|		// initialization function
	//	|		constructor: function(){
	//	|			this.myComplicatedObject = new ReallyComplicatedObject(); 
	//	|		},
	//	|		// other functions
	//	|		someMethod: function(){ 
	//	|			doStuff(); 
	//	|		}
	//	|	);

	// process superclass argument
	var dd = arguments.callee, mixins;
	if(dojo.isArray(superclass)){
		mixins = superclass;
		superclass = mixins.shift();
	}
	// construct intermediate classes for mixins
	if(mixins){
		dojo.forEach(mixins, function(m){
			if(!m){ throw(className + "": mixin #"" + i + "" is null""); } // It's likely a required module is not loaded
			superclass = dd._delegate(superclass, m);
		});
	}
	// create constructor
	var ctor = dd._delegate(superclass);
	// extend with ""props""
	props = props || {};
	ctor.extend(props);
	// more prototype decoration
	dojo.extend(ctor, {declaredClass: className, _constructor: props.constructor/*, preamble: null*/});
	// special help for IE
	ctor.prototype.constructor = ctor;
	// create named reference
	return dojo.setObject(className, ctor); // Function
};

dojo.mixin(dojo.declare, {
	_delegate: function(base, mixin){
		var bp = (base||0).prototype, mp = (mixin||0).prototype, dd=dojo.declare;
		// fresh constructor, fresh prototype
		var ctor = dd._makeCtor();
		// cache ancestry
		dojo.mixin(ctor, {superclass: bp, mixin: mp, extend: dd._extend});
		// chain prototypes
		if(base){ctor.prototype = dojo._delegate(bp);}
		// add mixin and core
		dojo.extend(ctor, dd._core, mp||0, {_constructor: null, preamble: null});
		// special help for IE
		ctor.prototype.constructor = ctor;
		// name this class for debugging
		ctor.prototype.declaredClass = (bp||0).declaredClass + '_' + (mp||0).declaredClass;
		return ctor;
	},
	_extend: function(props){
		var i, fn;
		for(i in props){ if(dojo.isFunction(fn=props[i]) && !0[i]){fn.nom=i;fn.ctor=this;} }
		dojo.extend(this, props);
	},
	_makeCtor: function(){
		// we have to make a function, but don't want to close over anything
		return function(){ this._construct(arguments); };
	},
	_core: { 
		_construct: function(args){
			var c=args.callee, s=c.superclass, ct=s&&s.constructor, m=c.mixin, mct=m&&m.constructor, a=args, ii, fn;
			// side-effect of = used on purpose here, lint may complain, don't try this at home
			if(a[0]){ 
				// FIXME: preambles for each mixin should be allowed
				// FIXME: 
				//		should we allow the preamble here NOT to modify the
				//		default args, but instead to act on each mixin
				//		independently of the class instance being constructed
				//		(for impedence matching)?

				// allow any first argument w/ a ""preamble"" property to act as a
				// class preamble (not exclusive of the prototype preamble)
				if(/*dojo.isFunction*/((fn = a[0].preamble))){ 
					a = fn.apply(this, a) || a; 
				}
			} 
			// prototype preamble
			if((fn = c.prototype.preamble)){a = fn.apply(this, a) || a;}
			// FIXME: 
			//		need to provide an optional prototype-settable
			//		""_explicitSuper"" property which disables this
			// initialize superclass
			if(ct&&ct.apply){ct.apply(this, a);}
			// initialize mixin
			if(mct&&mct.apply){mct.apply(this, a);}
			// initialize self
			if((ii=c.prototype._constructor)){ii.apply(this, args);}
			// post construction
			if(this.constructor.prototype==c.prototype && (ct=this.postscript)){ ct.apply(this, args); }
		},
		_findMixin: function(mixin){
			var c = this.constructor, p, m;
			while(c){
				p = c.superclass;
				m = c.mixin;
				if(m==mixin || (m instanceof mixin.constructor)){return p;}
				if(m && m._findMixin && (m=m._findMixin(mixin))){return m;}
				c = p && p.constructor;
			}
		},
		_findMethod: function(name, method, ptype, has){
			// consciously trading readability for bytes and speed in this low-level method
			var p=ptype, c, m, f;
			do{
				c = p.constructor;
				m = c.mixin;
				// find method by name in our mixin ancestor
				if(m && (m=this._findMethod(name, method, m, has))){return m;}
				// if we found a named method that either exactly-is or exactly-is-not 'method'
				if((f=p[name])&&(has==(f==method))){return p;}
				// ascend chain
				p = c.superclass;
			}while(p);
			// if we couldn't find an ancestor in our primary chain, try a mixin chain
			return !has && (p=this._findMixin(ptype)) && this._findMethod(name, method, p, has);
		},
		inherited: function(name, args, newArgs){
			// optionalize name argument
			var a = arguments;
			if(!dojo.isString(a[0])){newArgs=args; args=name; name=args.callee.nom;}
			a = newArgs||args;
			var c = args.callee, p = this.constructor.prototype, fn, mp;
			// if not an instance override
			if(this[name] != c || p[name] == c){
				// start from memoized prototype, or
				// find a prototype that has property 'name' == 'c'
				mp = (c.ctor||0).superclass || this._findMethod(name, c, p, true);
				if(!mp){throw(this.declaredClass + ': inherited method ""' + name + '"" mismatch');}
				// find a prototype that has property 'name' != 'c'
				p = this._findMethod(name, c, mp, false);
			}
			// we expect 'name' to be in prototype 'p'
			fn = p && p[name];
			if(!fn){throw(mp.declaredClass + ': inherited method ""' + name + '"" not found');}
			// if the function exists, invoke it in our scope
			return fn.apply(this, a);
		}
	}
});

}

if(!dojo._hasResource[""dojo._base.connect""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.connect""] = true;
dojo.provide(""dojo._base.connect"");


// this file courtesy of the TurboAjax Group, licensed under a Dojo CLA

// low-level delegation machinery
dojo._listener = {
	// create a dispatcher function
	getDispatcher: function(){
		// following comments pulled out-of-line to prevent cloning them 
		// in the returned function.
		// - indices (i) that are really in the array of listeners (ls) will 
		//   not be in Array.prototype. This is the 'sparse array' trick
		//   that keeps us safe from libs that take liberties with built-in 
		//   objects
		// - listener is invoked with current scope (this)
		return function(){
			var ap=Array.prototype, c=arguments.callee, ls=c._listeners, t=c.target;
			// return value comes from original target function
			var r = t && t.apply(this, arguments);
			// make local copy of listener array so it is immutable during processing
			var lls;
											lls = [].concat(ls);
							
			// invoke listeners after target function
			for(var i in lls){
				if(!(i in ap)){
					lls[i].apply(this, arguments);
				}
			}
			// return value comes from original target function
			return r;
		}
	},
	// add a listener to an object
	add: function(/*Object*/ source, /*String*/ method, /*Function*/ listener){
		// Whenever 'method' is invoked, 'listener' will have the same scope.
		// Trying to supporting a context object for the listener led to 
		// complexity. 
		// Non trivial to provide 'once' functionality here
		// because listener could be the result of a dojo.hitch call,
		// in which case two references to the same hitch target would not
		// be equivalent. 
		source = source || dojo.global;
		// The source method is either null, a dispatcher, or some other function
		var f = source[method];
		// Ensure a dispatcher
		if(!f||!f._listeners){
			var d = dojo._listener.getDispatcher();
			// original target function is special
			d.target = f;
			// dispatcher holds a list of listeners
			d._listeners = []; 
			// redirect source to dispatcher
			f = source[method] = d;
		}
		// The contract is that a handle is returned that can 
		// identify this listener for disconnect. 
		//
		// The type of the handle is private. Here is it implemented as Integer. 
		// DOM event code has this same contract but handle is Function 
		// in non-IE browsers.
		//
		// We could have separate lists of before and after listeners.
		return f._listeners.push(listener) ; /*Handle*/
	},
	// remove a listener from an object
	remove: function(/*Object*/ source, /*String*/ method, /*Handle*/ handle){
		var f = (source||dojo.global)[method];
		// remember that handle is the index+1 (0 is not a valid handle)
		if(f && f._listeners && handle--){
			delete f._listeners[handle];
		}
	}
};

// Multiple delegation for arbitrary methods.

// This unit knows nothing about DOM, 
// but we include DOM aware 
// documentation and dontFix
// argument here to help the autodocs.
// Actual DOM aware code is in event.js.

dojo.connect = function(/*Object|null*/ obj, 
						/*String*/ event, 
						/*Object|null*/ context, 
						/*String|Function*/ method,
						/*Boolean*/ dontFix){
	// summary:
	//		Create a link that calls one function when another executes. 
	//
	// description:
	//		Connects method to event, so that after event fires, method
	//		does too. All connected functions are passed the same arguments as
	//		the event function was initially called with. You may connect as
	//		many methods to event as needed.
	//
	//		event must be a string. If obj is null, dojo.global is used.
	//
	//		null arguments may simply be omitted.
	//
	//		obj[event] can resolve to a function or undefined (null). 
	//		If obj[event] is null, it is assigned a function.
	//
	//		The return value is a handle that is needed to 
	//		remove this connection with dojo.disconnect.
	//
	// obj: 
	//		The source object for the event function. 
	//		Defaults to dojo.global if null.
	//		If obj is a DOM node, the connection is delegated 
	//		to the DOM event manager (unless dontFix is true).
	//
	// event:
	//		String name of the event function in obj. 
	//		I.e. identifies a property obj[event].
	//
	// context: 
	//		The object that method will receive as ""this"".
	//
	//		If context is null and method is a function, then method
	//		inherits the context of event.
	//	
	//		If method is a string then context must be the source 
	//		object object for method (context[method]). If context is null,
	//		dojo.global is used.
	//
	// method:
	//		A function reference, or name of a function in context. 
	//		The function identified by method fires after event does. 
	//		method receives the same arguments as the event.
	//		See context argument comments for information on method's scope.
	//
	// dontFix:
	//		If obj is a DOM node, set dontFix to true to prevent delegation 
	//		of this connection to the DOM event manager. 
	//
	// example:
	//		When obj.onchange(), do ui.update():
	//	|	dojo.connect(obj, ""onchange"", ui, ""update"");
	//	|	dojo.connect(obj, ""onchange"", ui, ui.update); // same
	//
	// example:
	//		Using return value for disconnect:
	//	|	var link = dojo.connect(obj, ""onchange"", ui, ""update"");
	//	|	...
	//	|	dojo.disconnect(link);
	//
	// example:
	//		When onglobalevent executes, watcher.handler is invoked:
	//	|	dojo.connect(null, ""onglobalevent"", watcher, ""handler"");
	//
	// example:
	//		When ob.onCustomEvent executes, customEventHandler is invoked:
	//	|	dojo.connect(ob, ""onCustomEvent"", null, ""customEventHandler"");
	//	|	dojo.connect(ob, ""onCustomEvent"", ""customEventHandler""); // same
	//
	// example:
	//		When ob.onCustomEvent executes, customEventHandler is invoked
	//		with the same scope (this):
	//	|	dojo.connect(ob, ""onCustomEvent"", null, customEventHandler);
	//	|	dojo.connect(ob, ""onCustomEvent"", customEventHandler); // same
	//
	// example:
	//		When globalEvent executes, globalHandler is invoked
	//		with the same scope (this):
	//	|	dojo.connect(null, ""globalEvent"", null, globalHandler);
	//	|	dojo.connect(""globalEvent"", globalHandler); // same

	// normalize arguments
	var a=arguments, args=[], i=0;
	// if a[0] is a String, obj was ommited
	args.push(dojo.isString(a[0]) ? null : a[i++], a[i++]);
	// if the arg-after-next is a String or Function, context was NOT omitted
	var a1 = a[i+1];
	args.push(dojo.isString(a1)||dojo.isFunction(a1) ? a[i++] : null, a[i++]);
	// absorb any additional arguments
	for(var l=a.length; i<l; i++){	args.push(a[i]); }
	// do the actual work
	return dojo._connect.apply(this, args); /*Handle*/
}

// used by non-browser hostenvs. always overriden by event.js
dojo._connect = function(obj, event, context, method){
	var l=dojo._listener, h=l.add(obj, event, dojo.hitch(context, method)); 
	return [obj, event, h, l]; // Handle
}

dojo.disconnect = function(/*Handle*/ handle){
	// summary:
	//		Remove a link created by dojo.connect.
	// description:
	//		Removes the connection between event and the method referenced by handle.
	// handle:
	//		the return value of the dojo.connect call that created the connection.
	if(handle && handle[0] !== undefined){
		dojo._disconnect.apply(this, handle);
		// let's not keep this reference
		delete handle[0];
	}
}

dojo._disconnect = function(obj, event, handle, listener){
	listener.remove(obj, event, handle);
}

// topic publish/subscribe

dojo._topics = {};

dojo.subscribe = function(/*String*/ topic, /*Object|null*/ context, /*String|Function*/ method){
	//	summary:
	//		Attach a listener to a named topic. The listener function is invoked whenever the
	//		named topic is published (see: dojo.publish).
	//		Returns a handle which is needed to unsubscribe this listener.
	//	context:
	//		Scope in which method will be invoked, or null for default scope.
	//	method:
	//		The name of a function in context, or a function reference. This is the function that
	//		is invoked when topic is published.
	//	example:
	//	|	dojo.subscribe(""alerts"", null, function(caption, message){ alert(caption + ""\n"" + message); };
	//	|	dojo.publish(""alerts"", [ ""read this"", ""hello world"" ]);																	

	// support for 2 argument invocation (omitting context) depends on hitch
	return [topic, dojo._listener.add(dojo._topics, topic, dojo.hitch(context, method))]; /*Handle*/
}

dojo.unsubscribe = function(/*Handle*/ handle){
	//	summary:
	//	 	Remove a topic listener. 
	//	handle:
	//	 	The handle returned from a call to subscribe.
	//	example:
	//	|	var alerter = dojo.subscribe(""alerts"", null, function(caption, message){ alert(caption + ""\n"" + message); };
	//	|	...
	//	|	dojo.unsubscribe(alerter);
	if(handle){
		dojo._listener.remove(dojo._topics, handle[0], handle[1]);
	}
}

dojo.publish = function(/*String*/ topic, /*Array*/ args){
	//	summary:
	//	 	Invoke all listener method subscribed to topic.
	//	topic:
	//	 	The name of the topic to publish.
	//	args:
	//	 	An array of arguments. The arguments will be applied 
	//	 	to each topic subscriber (as first class parameters, via apply).
	//	example:
	//	|	dojo.subscribe(""alerts"", null, function(caption, message){ alert(caption + ""\n"" + message); };
	//	|	dojo.publish(""alerts"", [ ""read this"", ""hello world"" ]);	

	// Note that args is an array, which is more efficient vs variable length
	// argument list.  Ideally, var args would be implemented via Array
	// throughout the APIs.
	var f = dojo._topics[topic];
	if(f){
		f.apply(this, args||[]);
	}
}

dojo.connectPublisher = function(	/*String*/ topic, 
									/*Object|null*/ obj, 
									/*String*/ event){
	//	summary:
	//	 	Ensure that everytime obj.event() is called, a message is published
	//	 	on the topic. Returns a handle which can be passed to
	//	 	dojo.disconnect() to disable subsequent automatic publication on
	//	 	the topic.
	//	topic:
	//	 	The name of the topic to publish.
	//	obj: 
	//	 	The source object for the event function. Defaults to dojo.global
	//	 	if null.
	//	event:
	//	 	The name of the event function in obj. 
	//	 	I.e. identifies a property obj[event].
	//	example:
	//	|	dojo.connectPublisher(""/ajax/start"", dojo, ""xhrGet"");
	var pf = function(){ dojo.publish(topic, arguments); }
	return (event) ? dojo.connect(obj, event, pf) : dojo.connect(obj, pf); //Handle
};

}

if(!dojo._hasResource[""dojo._base.Deferred""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.Deferred""] = true;
dojo.provide(""dojo._base.Deferred"");


dojo.Deferred = function(/*Function?*/ canceller){
	// summary:
	//		Encapsulates a sequence of callbacks in response to a value that
	//		may not yet be available.  This is modeled after the Deferred class
	//		from Twisted <http://twistedmatrix.com>.
	// description:
	//		JavaScript has no threads, and even if it did, threads are hard.
	//		Deferreds are a way of abstracting non-blocking events, such as the
	//		final response to an XMLHttpRequest. Deferreds create a promise to
	//		return a response a some point in the future and an easy way to
	//		register your interest in receiving that response.
	//
	//		The most important methods for Deffered users are:
	//
	//			* addCallback(handler)
	//			* addErrback(handler)
	//			* callback(result)
	//			* errback(result)
	//
	//		In general, when a function returns a Deferred, users then ""fill
	//		in"" the second half of the contract by registering callbacks and
	//		error handlers. You may register as many callback and errback
	//		handlers as you like and they will be executed in the order
	//		registered when a result is provided. Usually this result is
	//		provided as the result of an asynchronous operation. The code
	//		""managing"" the Deferred (the code that made the promise to provide
	//		an answer later) will use the callback() and errback() methods to
	//		communicate with registered listeners about the result of the
	//		operation. At this time, all registered result handlers are called
	//		*with the most recent result value*.
	//
	//		Deferred callback handlers are treated as a chain, and each item in
	//		the chain is required to return a value that will be fed into
	//		successive handlers. The most minimal callback may be registered
	//		like this:
	//
	//		|	var d = new dojo.Deferred();
	//		|	d.addCallback(function(result){ return result; });
	//
	//		Perhaps the most common mistake when first using Deferreds is to
	//		forget to return a value (in most cases, the value you were
	//		passed).
	//
	//		The sequence of callbacks is internally represented as a list of
	//		2-tuples containing the callback/errback pair.  For example, the
	//		following call sequence:
	//		
	//		|	var d = new dojo.Deferred();
	//		|	d.addCallback(myCallback);
	//		|	d.addErrback(myErrback);
	//		|	d.addBoth(myBoth);
	//		|	d.addCallbacks(myCallback, myErrback);
	//
	//		is translated into a Deferred with the following internal
	//		representation:
	//
	//		|	[
	//		|		[myCallback, null],
	//		|		[null, myErrback],
	//		|		[myBoth, myBoth],
	//		|		[myCallback, myErrback]
	//		|	]
	//
	//		The Deferred also keeps track of its current status (fired).  Its
	//		status may be one of three things:
	//
	//			* -1: no value yet (initial condition)
	//			* 0: success
	//			* 1: error
	//	
	//		A Deferred will be in the error state if one of the following three
	//		conditions are met:
	//
	//			1. The result given to callback or errback is ""instanceof"" Error
	//			2. The previous callback or errback raised an exception while
	//			   executing
	//			3. The previous callback or errback returned a value
	//			   ""instanceof"" Error
	//
	//		Otherwise, the Deferred will be in the success state. The state of
	//		the Deferred determines the next element in the callback sequence
	//		to run.
	//
	//		When a callback or errback occurs with the example deferred chain,
	//		something equivalent to the following will happen (imagine
	//		that exceptions are caught and returned):
	//
	//		|	// d.callback(result) or d.errback(result)
	//		|	if(!(result instanceof Error)){
	//		|		result = myCallback(result);
	//		|	}
	//		|	if(result instanceof Error){
	//		|		result = myErrback(result);
	//		|	}
	//		|	result = myBoth(result);
	//		|	if(result instanceof Error){
	//		|		result = myErrback(result);
	//		|	}else{
	//		|		result = myCallback(result);
	//		|	}
	//
	//		The result is then stored away in case another step is added to the
	//		callback sequence.	Since the Deferred already has a value
	//		available, any new callbacks added will be called immediately.
	//
	//		There are two other ""advanced"" details about this implementation
	//		that are useful:
	//
	//		Callbacks are allowed to return Deferred instances themselves, so
	//		you can build complicated sequences of events with ease.
	//
	//		The creator of the Deferred may specify a canceller.  The canceller
	//		is a function that will be called if Deferred.cancel is called
	//		before the Deferred fires. You can use this to implement clean
	//		aborting of an XMLHttpRequest, etc. Note that cancel will fire the
	//		deferred with a CancelledError (unless your canceller returns
	//		another kind of error), so the errbacks should be prepared to
	//		handle that error for cancellable Deferreds.
	// example:
	//	|	var deferred = new dojo.Deferred();
	//	|	setTimeout(function(){ deferred.callback({success: true}); }, 1000);
	//	|	return deferred;
	// example:
	//		Deferred objects are often used when making code asynchronous. It
	//		may be easiest to write functions in a synchronous manner and then
	//		split code using a deferred to trigger a response to a long-lived
	//		operation. For example, instead of register a callback function to
	//		denote when a rendering operation completes, the function can
	//		simply return a deferred:
	//
	//		|	// callback style:
	//		|	function renderLotsOfData(data, callback){
	//		|		var success = false
	//		|		try{
	//		|			for(var x in data){
	//		|				renderDataitem(data[x]);
	//		|			}
	//		|			success = true;
	//		|		}catch(e){ }
	//		|		if(callback){
	//		|			callback(success);
	//		|		}
	//		|	}
	//
	//		|	// using callback style
	//		|	renderLotsOfData(someDataObj, function(success){
	//		|		// handles success or failure
	//		|		if(!success){
	//		|			promptUserToRecover();
	//		|		}
	//		|	});
	//		|	// NOTE: no way to add another callback here!!
	// example:
	//		Using a Deferred doesn't simplify the sending code any, but it
	//		provides a standard interface for callers and senders alike,
	//		providing both with a simple way to service multiple callbacks for
	//		an operation and freeing both sides from worrying about details
	//		such as ""did this get called already?"". With Deferreds, new
	//		callbacks can be added at any time.
	//
	//		|	// Deferred style:
	//		|	function renderLotsOfData(data){
	//		|		var d = new dojo.Deferred();
	//		|		try{
	//		|			for(var x in data){
	//		|				renderDataitem(data[x]);
	//		|			}
	//		|			d.callback(true);
	//		|		}catch(e){ 
	//		|			d.errback(new Error(""rendering failed""));
	//		|		}
	//		|		return d;
	//		|	}
	//
	//		|	// using Deferred style
	//		|	renderLotsOfData(someDataObj).addErrback(function(){
	//		|		promptUserToRecover();
	//		|	});
	//		|	// NOTE: addErrback and addCallback both return the Deferred
	//		|	// again, so we could chain adding callbacks or save the
	//		|	// deferred for later should we need to be notified again.
	// example:
	//		In this example, renderLotsOfData is syncrhonous and so both
	//		versions are pretty artificial. Putting the data display on a
	//		timeout helps show why Deferreds rock:
	//
	//		|	// Deferred style and async func
	//		|	function renderLotsOfData(data){
	//		|		var d = new dojo.Deferred();
	//		|		setTimeout(function(){
	//		|			try{
	//		|				for(var x in data){
	//		|					renderDataitem(data[x]);
	//		|				}
	//		|				d.callback(true);
	//		|			}catch(e){ 
	//		|				d.errback(new Error(""rendering failed""));
	//		|			}
	//		|		}, 100);
	//		|		return d;
	//		|	}
	//
	//		|	// using Deferred style
	//		|	renderLotsOfData(someDataObj).addErrback(function(){
	//		|		promptUserToRecover();
	//		|	});
	//
	//		Note that the caller doesn't have to change his code at all to
	//		handle the asynchronous case.

	this.chain = [];
	this.id = this._nextId();
	this.fired = -1;
	this.paused = 0;
	this.results = [null, null];
	this.canceller = canceller;
	this.silentlyCancelled = false;
};

dojo.extend(dojo.Deferred, {
	/*
	makeCalled: function(){
		// summary:
		//		returns a new, empty deferred, which is already in the called
		//		state. Calling callback() or errback() on this deferred will
		//		yeild an error and adding new handlers to it will result in
		//		them being called immediately.
		var deferred = new dojo.Deferred();
		deferred.callback();
		return deferred;
	},

	toString: function(){
		var state;
		if(this.fired == -1){
			state = 'unfired';
		}else{
			state = this.fired ? 'success' : 'error';
		}
		return 'Deferred(' + this.id + ', ' + state + ')';
	},
	*/

	_nextId: (function(){
		var n = 1;
		return function(){ return n++; };
	})(),

	cancel: function(){
		// summary:	
		//		Cancels a Deferred that has not yet received a value, or is
		//		waiting on another Deferred as its value.
		// description:
		//		If a canceller is defined, the canceller is called. If the
		//		canceller did not return an error, or there was no canceller,
		//		then the errback chain is started.
		var err;
		if(this.fired == -1){
			if(this.canceller){
				err = this.canceller(this);
			}else{
				this.silentlyCancelled = true;
			}
			if(this.fired == -1){
				if(!(err instanceof Error)){
					var res = err;
					err = new Error(""Deferred Cancelled"");
					err.dojoType = ""cancel"";
					err.cancelResult = res;
				}
				this.errback(err);
			}
		}else if(	(this.fired == 0) &&
					(this.results[0] instanceof dojo.Deferred)
		){
			this.results[0].cancel();
		}
	},
			

	_resback: function(res){
		// summary:
		//		The private primitive that means either callback or errback
		this.fired = ((res instanceof Error) ? 1 : 0);
		this.results[this.fired] = res;
		this._fire();
	},

	_check: function(){
		if(this.fired != -1){
			if(!this.silentlyCancelled){
				throw new Error(""already called!"");
			}
			this.silentlyCancelled = false;
			return;
		}
	},

	callback: function(res){
		//	summary:	
		//		Begin the callback sequence with a non-error value.
		
		/*
		callback or errback should only be called once on a given
		Deferred.
		*/
		this._check();
		this._resback(res);
	},

	errback: function(/*Error*/res){
		//	summary: 
		//		Begin the callback sequence with an error result.
		this._check();
		if(!(res instanceof Error)){
			res = new Error(res);
		}
		this._resback(res);
	},

	addBoth: function(/*Function|Object*/cb, /*String?*/cbfn){
		//	summary:
		//		Add the same function as both a callback and an errback as the
		//		next element on the callback sequence.This is useful for code
		//		that you want to guarantee to run, e.g. a finalizer.
		var enclosed = dojo.hitch.apply(dojo, arguments);
		return this.addCallbacks(enclosed, enclosed); // dojo.Deferred
	},

	addCallback: function(/*Function|Object*/cb, /*String?*/cbfn /*...*/){
		//	summary: 
		//		Add a single callback to the end of the callback sequence.
		return this.addCallbacks(dojo.hitch.apply(dojo, arguments)); // dojo.Deferred
	},

	addErrback: function(cb, cbfn){
		//	summary: 
		//		Add a single callback to the end of the callback sequence.
		return this.addCallbacks(null, dojo.hitch.apply(dojo, arguments)); // dojo.Deferred
	},

	addCallbacks: function(cb, eb){
		// summary: 
		//		Add separate callback and errback to the end of the callback
		//		sequence.
		this.chain.push([cb, eb])
		if(this.fired >= 0){
			this._fire();
		}
		return this; // dojo.Deferred
	},

	_fire: function(){
		// summary: 
		//		Used internally to exhaust the callback sequence when a result
		//		is available.
		var chain = this.chain;
		var fired = this.fired;
		var res = this.results[fired];
		var self = this;
		var cb = null;
		while(
			(chain.length > 0) &&
			(this.paused == 0)
		){
			// Array
			var f = chain.shift()[fired];
			if(!f){ continue; }
			var func = function(){
				var ret = f(res);
				//If no response, then use previous response.
				if(typeof ret != ""undefined""){
					res = ret;
				}
				fired = ((res instanceof Error) ? 1 : 0);
				if(res instanceof dojo.Deferred){
					cb = function(res){
						self._resback(res);
						// inlined from _pause()
						self.paused--;
						if(
							(self.paused == 0) && 
							(self.fired >= 0)
						){
							self._fire();
						}
					}
					// inlined from _unpause
					this.paused++;
				}
			};
			if(dojo.config.isDebug){
				func.call(this);
			}else{
				try{
					func.call(this);
				}catch(err){
					fired = 1;
					res = err;
				}
			}
		}
		this.fired = fired;
		this.results[fired] = res;
		if((cb)&&(this.paused)){
			// this is for ""tail recursion"" in case the dependent
			// deferred is already fired
			res.addBoth(cb);
		}
	}
});

}

if(!dojo._hasResource[""dojo._base.json""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.json""] = true;
dojo.provide(""dojo._base.json"");

dojo.fromJson = function(/*String*/ json){
	// summary:
	// 		Parses a [JSON](http://json.org) string to return a JavaScript object.  Throws for invalid JSON strings.
	// json: 
	//		a string literal of a JSON item, for instance:
	//			`'{ ""foo"": [ ""bar"", 1, { ""baz"": ""thud"" } ] }'`

	return eval(""("" + json + "")""); // Object
}

dojo._escapeString = function(/*String*/str){
	//summary:
	//		Adds escape sequences for non-visual characters, double quote and
	//		backslash and surrounds with double quotes to form a valid string
	//		literal.
	return ('""' + str.replace(/([""\\])/g, '\\$1') + '""').
		replace(/[\f]/g, ""\\f"").replace(/[\b]/g, ""\\b"").replace(/[\n]/g, ""\\n"").
		replace(/[\t]/g, ""\\t"").replace(/[\r]/g, ""\\r""); // string
}

dojo.toJsonIndentStr = ""\t"";
dojo.toJson = function(/*Object*/ it, /*Boolean?*/ prettyPrint, /*String?*/ _indentStr){
	// summary:
	//		Returns a [JSON](http://json.org) serialization of an object.
	//
	// description:
	//		Returns a [JSON](http://json.org) serialization of an object.
	//		Note that this doesn't check for infinite recursion, so don't do that!
	//
	// it:
	//		an object to be serialized. Objects may define their own
	//		serialization via a special ""__json__"" or ""json"" function
	//		property. If a specialized serializer has been defined, it will
	//		be used as a fallback.
	//
	// prettyPrint:
	//		if true, we indent objects and arrays to make the output prettier.
	//		The variable dojo.toJsonIndentStr is used as the indent string 
	//		-- to use something other than the default (tab), 
	//		change that variable before calling dojo.toJson().
	//
	// _indentStr:
	//		private variable for recursive calls when pretty printing, do not use.

	if(it === undefined){
		return ""undefined"";
	}
	var objtype = typeof it;
	if(objtype == ""number"" || objtype == ""boolean""){
		return it + """";
	}
	if(it === null){
		return ""null"";
	}
	if(dojo.isString(it)){ 
		return dojo._escapeString(it); 
	}
	// recurse
	var recurse = arguments.callee;
	// short-circuit for objects that support ""json"" serialization
	// if they return ""self"" then just pass-through...
	var newObj;
	_indentStr = _indentStr || """";
	var nextIndent = prettyPrint ? _indentStr + dojo.toJsonIndentStr : """";
	var tf = it.__json__||it.json;
	if(dojo.isFunction(tf)){
		newObj = tf.call(it);
		if(it !== newObj){
			return recurse(newObj, prettyPrint, nextIndent);
		}
	}
	if(it.nodeType && it.cloneNode){ // isNode
		// we can't seriailize DOM nodes as regular objects because they have cycles
		// DOM nodes could be serialized with something like outerHTML, but
		// that can be provided by users in the form of .json or .__json__ function.
		throw new Error(""Can't serialize DOM nodes"");
	}

	var sep = prettyPrint ? "" "" : """";
	var newLine = prettyPrint ? ""\n"" : """";

	// array
	if(dojo.isArray(it)){
		var res = dojo.map(it, function(obj){
			var val = recurse(obj, prettyPrint, nextIndent);
			if(typeof val != ""string""){
				val = ""undefined"";
			}
			return newLine + nextIndent + val;
		});
		return ""["" + res.join("","" + sep) + newLine + _indentStr + ""]"";
	}
	/*
	// look in the registry
	try {
		window.o = it;
		newObj = dojo.json.jsonRegistry.match(it);
		return recurse(newObj, prettyPrint, nextIndent);
	}catch(e){
		// 
	}
	// it's a function with no adapter, skip it
	*/
	if(objtype == ""function""){
		return null; // null
	}
	// generic object code path
	var output = [], key;
	for(key in it){
		var keyStr, val;
		if(typeof key == ""number""){
			keyStr = '""' + key + '""';
		}else if(typeof key == ""string""){
			keyStr = dojo._escapeString(key);
		}else{
			// skip non-string or number keys
			continue;
		}
		val = recurse(it[key], prettyPrint, nextIndent);
		if(typeof val != ""string""){
			// skip non-serializable values
			continue;
		}
		// FIXME: use += on Moz!!
		//	 MOW NOTE: using += is a pain because you have to account for the dangling comma...
		output.push(newLine + nextIndent + keyStr + "":"" + sep + val);
	}
	return ""{"" + output.join("","" + sep) + newLine + _indentStr + ""}""; // String
}

}

if(!dojo._hasResource[""dojo._base.array""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.array""] = true;

dojo.provide(""dojo._base.array"");

(function(){
	var _getParts = function(arr, obj, cb){
		return [ 
			dojo.isString(arr) ? arr.split("""") : arr, 
			obj || dojo.global,
			// FIXME: cache the anonymous functions we create here?
			dojo.isString(cb) ? new Function(""item"", ""index"", ""array"", cb) : cb
		];
	};

	dojo.mixin(dojo, {
		indexOf: function(	/*Array*/		array, 
							/*Object*/		value,
							/*Integer?*/	fromIndex,
							/*Boolean?*/	findLast){
			// summary:
			//		locates the first index of the provided value in the
			//		passed array. If the value is not found, -1 is returned.
			// description:
			//		For details on this method, see:
			// 			http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:indexOf

			var step = 1, end = array.length || 0, i = 0;
			if(findLast){
				i = end - 1;
				step = end = -1;
			}
			if(fromIndex != undefined){ i = fromIndex; }
			if((findLast && i > end) || i < end){
				for(; i != end; i += step){
					if(array[i] == value){ return i; }
				}
			}
			return -1;	// Number
		},

		lastIndexOf: function(/*Array*/array, /*Object*/value, /*Integer?*/fromIndex){
			// summary:
			//		locates the last index of the provided value in the passed
			//		array. If the value is not found, -1 is returned.
			// description:
			//		For details on this method, see:
			// 			http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:lastIndexOf
			return dojo.indexOf(array, value, fromIndex, true); // Number
		},

		forEach: function(/*Array|String*/arr, /*Function|String*/callback, /*Object?*/thisObject){
			//	summary:
			//		for every item in arr, callback is invoked. Return values are ignored.
			//	arr:
			//		the array to iterate over. If a string, operates on individual characters.
			//	callback:
			//		a function is invoked with three arguments: item, index, and array
			//	thisObject:
			//		may be used to scope the call to callback
			//	description:
			//		This function corresponds to the JavaScript 1.6
			//		Array.forEach() method. For more details, see:
			//			http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:forEach
			//	example:
			//	|	// log out all members of the array:
			//	|	dojo.forEach(
			//	|		[ ""thinger"", ""blah"", ""howdy"", 10 ],
			//	|		function(item){
			//	|			
			//	|		}
			//	|	);
			//	example:
			//	|	// log out the members and their indexes
			//	|	dojo.forEach(
			//	|		[ ""thinger"", ""blah"", ""howdy"", 10 ],
			//	|		function(item, idx, arr){
			//	|			
			//	|		}
			//	|	);
			//	example:
			//	|	// use a scoped object member as the callback
			//	|	
			//	|	var obj = {
			//	|		prefix: ""logged via obj.callback:"", 
			//	|		callback: function(item){
			//	|			
			//	|		}
			//	|	};
			//	|	
			//	|	// specifying the scope function executes the callback in that scope
			//	|	dojo.forEach(
			//	|		[ ""thinger"", ""blah"", ""howdy"", 10 ],
			//	|		obj.callback,
			//	|		obj
			//	|	);
			//	|	
			//	|	// alternately, we can accomplish the same thing with dojo.hitch()
			//	|	dojo.forEach(
			//	|		[ ""thinger"", ""blah"", ""howdy"", 10 ],
			//	|		dojo.hitch(obj, ""callback"")
			//	|	);

			// match the behavior of the built-in forEach WRT empty arrs
			if(!arr || !arr.length){ return; }

			// FIXME: there are several ways of handilng thisObject. Is
			// dojo.global always the default context?
			var _p = _getParts(arr, thisObject, callback); arr = _p[0];
			for(var i=0,l=arr.length; i<l; ++i){ 
				_p[2].call(_p[1], arr[i], i, arr);
			}
		},

		_everyOrSome: function(/*Boolean*/every, /*Array|String*/arr, /*Function|String*/callback, /*Object?*/thisObject){
			var _p = _getParts(arr, thisObject, callback); arr = _p[0];
			for(var i=0,l=arr.length; i<l; ++i){
				var result = !!_p[2].call(_p[1], arr[i], i, arr);
				if(every ^ result){
					return result; // Boolean
				}
			}
			return every; // Boolean
		},

		every: function(/*Array|String*/arr, /*Function|String*/callback, /*Object?*/thisObject){
			// summary:
			//		Determines whether or not every item in arr satisfies the
			//		condition implemented by callback.
			// arr:
			//		the array to iterate on. If a string, operates on individual characters.
			// callback:
			//		a function is invoked with three arguments: item, index,
			//		and array and returns true if the condition is met.
			// thisObject:
			//		may be used to scope the call to callback
			// description:
			//		This function corresponds to the JavaScript 1.6
			//		Array.every() method. For more details, see:
			//			http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:every
			// example:
			//	|	// returns false
			//	|	dojo.every([1, 2, 3, 4], function(item){ return item>1; });
			// example:
			//	|	// returns true 
			//	|	dojo.every([1, 2, 3, 4], function(item){ return item>0; });
			return this._everyOrSome(true, arr, callback, thisObject); // Boolean
		},

		some: function(/*Array|String*/arr, /*Function|String*/callback, /*Object?*/thisObject){
			// summary:
			//		Determines whether or not any item in arr satisfies the
			//		condition implemented by callback.
			// arr:
			//		the array to iterate over. If a string, operates on individual characters.
			// callback:
			//		a function is invoked with three arguments: item, index,
			//		and array and returns true if the condition is met.
			// thisObject:
			//		may be used to scope the call to callback
			// description:
			//		This function corresponds to the JavaScript 1.6
			//		Array.some() method. For more details, see:
			//			http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:some
			// example:
			//	|	// is true
			//	|	dojo.some([1, 2, 3, 4], function(item){ return item>1; });
			// example:
			//	|	// is false
			//	|	dojo.some([1, 2, 3, 4], function(item){ return item<1; });
			return this._everyOrSome(false, arr, callback, thisObject); // Boolean
		},

		map: function(/*Array|String*/arr, /*Function|String*/callback, /*Function?*/thisObject){
			// summary:
			//		applies callback to each element of arr and returns
			//		an Array with the results
			// arr:
			//		the array to iterate on. If a string, operates on
			//		individual characters.
			// callback:
			//		a function is invoked with three arguments, (item, index,
			//		array),  and returns a value
			// thisObject:
			//		may be used to scope the call to callback
			// description:
			//		This function corresponds to the JavaScript 1.6 Array.map()
			//		method. For more details, see:
			//			http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:map
			// example:
			//	|	// returns [2, 3, 4, 5]
			//	|	dojo.map([1, 2, 3, 4], function(item){ return item+1 });

			var _p = _getParts(arr, thisObject, callback); arr = _p[0];
			var outArr = (arguments[3] ? (new arguments[3]()) : []);
			for(var i=0,l=arr.length; i<l; ++i){
				outArr.push(_p[2].call(_p[1], arr[i], i, arr));
			}
			return outArr; // Array
		},

		filter: function(/*Array*/arr, /*Function|String*/callback, /*Object?*/thisObject){
			// summary:
			//		Returns a new Array with those items from arr that match the
			//		condition implemented by callback.
			// arr:
			//		the array to iterate over.
			// callback:
			//		a function that is invoked with three arguments (item,
			//		index, array). The return of this function is expected to
			//		be a boolean which determines whether the passed-in item
			//		will be included in the returned array.
			// thisObject:
			//		may be used to scope the call to callback
			// description:
			//		This function corresponds to the JavaScript 1.6
			//		Array.filter() method. For more details, see:
			//			http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:filter
			// example:
			//	|	// returns [2, 3, 4]
			//	|	dojo.filter([1, 2, 3, 4], function(item){ return item>1; });

			var _p = _getParts(arr, thisObject, callback); arr = _p[0];
			var outArr = [];
			for(var i=0,l=arr.length; i<l; ++i){
				if(_p[2].call(_p[1], arr[i], i, arr)){
					outArr.push(arr[i]);
				}
			}
			return outArr; // Array
		}
	});
})();

}

if(!dojo._hasResource[""dojo._base.Color""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.Color""] = true;
dojo.provide(""dojo._base.Color"");



dojo.Color = function(/*Array|String|Object*/ color){
	// summary:
	//		takes a named string, hex string, array of rgb or rgba values,
	//		an object with r, g, b, and a properties, or another dojo.Color object
	if(color){ this.setColor(color); }
};

// FIXME: there's got to be a more space-efficient way to encode or discover these!!  Use hex?
dojo.Color.named = {
	black:      [0,0,0],
	silver:     [192,192,192],
	gray:       [128,128,128],
	white:      [255,255,255],
	maroon:		[128,0,0],
	red:        [255,0,0],
	purple:		[128,0,128],
	fuchsia:	[255,0,255],
	green:	    [0,128,0],
	lime:	    [0,255,0],
	olive:		[128,128,0],
	yellow:		[255,255,0],
	navy:       [0,0,128],
	blue:       [0,0,255],
	teal:		[0,128,128],
	aqua:		[0,255,255]
};


dojo.extend(dojo.Color, {
	r: 255, g: 255, b: 255, a: 1,
	_set: function(r, g, b, a){
		var t = this; t.r = r; t.g = g; t.b = b; t.a = a;
	},
	setColor: function(/*Array|String|Object*/ color){
		// summary:
		//		takes a named string, hex string, array of rgb or rgba values,
		//		an object with r, g, b, and a properties, or another dojo.Color object
		var d = dojo;
		if(d.isString(color)){
			d.colorFromString(color, this);
		}else if(d.isArray(color)){
			d.colorFromArray(color, this);
		}else{
			this._set(color.r, color.g, color.b, color.a);
			if(!(color instanceof d.Color)){ this.sanitize(); }
		}
		return this;	// dojo.Color
	},
	sanitize: function(){
		// summary:
		//		makes sure that the object has correct attributes
		// description: 
		//		the default implementation does nothing, include dojo.colors to
		//		augment it to real checks
		return this;	// dojo.Color
	},
	toRgb: function(){
		// summary: returns 3 component array of rgb values
		var t = this;
		return [t.r, t.g, t.b];	// Array
	},
	toRgba: function(){
		// summary: returns a 4 component array of rgba values
		var t = this;
		return [t.r, t.g, t.b, t.a];	// Array
	},
	toHex: function(){
		// summary: returns a css color string in hexadecimal representation
		var arr = dojo.map([""r"", ""g"", ""b""], function(x){
			var s = this[x].toString(16);
			return s.length < 2 ? ""0"" + s : s;
		}, this);
		return ""#"" + arr.join("""");	// String
	},
	toCss: function(/*Boolean?*/ includeAlpha){
		// summary: returns a css color string in rgb(a) representation
		var t = this, rgb = t.r + "", "" + t.g + "", "" + t.b;
		return (includeAlpha ? ""rgba("" + rgb + "", "" + t.a : ""rgb("" + rgb) + "")"";	// String
	},
	toString: function(){
		// summary: returns a visual representation of the color
		return this.toCss(true); // String
	}
});

dojo.blendColors = function(
	/*dojo.Color*/ start, 
	/*dojo.Color*/ end, 
	/*Number*/ weight,
	/*dojo.Color?*/ obj
){
	// summary: 
	//		blend colors end and start with weight from 0 to 1, 0.5 being a 50/50 blend,
	//		can reuse a previously allocated dojo.Color object for the result
	var d = dojo, t = obj || new dojo.Color();
	d.forEach([""r"", ""g"", ""b"", ""a""], function(x){
		t[x] = start[x] + (end[x] - start[x]) * weight;
		if(x != ""a""){ t[x] = Math.round(t[x]); }
	});
	return t.sanitize();	// dojo.Color
};

dojo.colorFromRgb = function(/*String*/ color, /*dojo.Color?*/ obj){
	// summary: get rgb(a) array from css-style color declarations
	var m = color.toLowerCase().match(/^rgba?\(([\s\.,0-9]+)\)/);
	return m && dojo.colorFromArray(m[1].split(/\s*,\s*/), obj);	// dojo.Color
};

dojo.colorFromHex = function(/*String*/ color, /*dojo.Color?*/ obj){
	// summary: converts a hex string with a '#' prefix to a color object.
	//	Supports 12-bit #rgb shorthand.
	var d = dojo, t = obj || new d.Color(),
		bits = (color.length == 4) ? 4 : 8,
		mask = (1 << bits) - 1;
	color = Number(""0x"" + color.substr(1));
	if(isNaN(color)){
		return null; // dojo.Color
	}
	d.forEach([""b"", ""g"", ""r""], function(x){
		var c = color & mask;
		color >>= bits;
		t[x] = bits == 4 ? 17 * c : c;
	});
	t.a = 1;
	return t;	// dojo.Color
};

dojo.colorFromArray = function(/*Array*/ a, /*dojo.Color?*/ obj){
	// summary: builds a color from 1, 2, 3, or 4 element array
	var t = obj || new dojo.Color();
	t._set(Number(a[0]), Number(a[1]), Number(a[2]), Number(a[3]));
	if(isNaN(t.a)){ t.a = 1; }
	return t.sanitize();	// dojo.Color
};

dojo.colorFromString = function(/*String*/ str, /*dojo.Color?*/ obj){
	//	summary:
	//		parses str for a color value.
	//	description:
	//		Acceptable input values for str may include arrays of any form
	//		accepted by dojo.colorFromArray, hex strings such as ""#aaaaaa"", or
	//		rgb or rgba strings such as ""rgb(133, 200, 16)"" or ""rgba(10, 10,
	//		10, 50)""
	//	returns:
	//		a dojo.Color object. If obj is passed, it will be the return value.
	var a = dojo.Color.named[str];
	return a && dojo.colorFromArray(a, obj) || dojo.colorFromRgb(str, obj) || dojo.colorFromHex(str, obj);
};

}

if(!dojo._hasResource[""dojo._base""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base""] = true;
dojo.provide(""dojo._base"");









}

if(!dojo._hasResource[""dojo._base.window""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.window""] = true;
dojo.provide(""dojo._base.window"");

/*=====
dojo.doc = {
	// summary:
	//		Alias for the current document. 'dojo.doc' can be modified
	//		for temporary context shifting. Also see dojo.withDoc().
	// description:
	//    Refer to dojo.doc rather
	//    than referring to 'window.document' to ensure your code runs
	//    correctly in managed contexts.
	// example:
	// 	|	n.appendChild(dojo.doc.createElement('div'));
}
=====*/
dojo.doc = window[""document""] || null;

dojo.body = function(){
	// summary:
	//		Return the body element of the document
	//		return the body object associated with dojo.doc
	// example:
	// 	|	dojo.body().appendChild(dojo.doc.createElement('div'));

	// Note: document.body is not defined for a strict xhtml document
	// Would like to memoize this, but dojo.doc can change vi dojo.withDoc().
	return dojo.doc.body || dojo.doc.getElementsByTagName(""body"")[0]; // Node
}

dojo.setContext = function(/*Object*/globalObject, /*DocumentElement*/globalDocument){
	// summary:
	//		changes the behavior of many core Dojo functions that deal with
	//		namespace and DOM lookup, changing them to work in a new global
	//		context (e.g., an iframe). The varibles dojo.global and dojo.doc
	//		are modified as a result of calling this function and the result of
	//		`dojo.body()` likewise differs.
	dojo.global = globalObject;
	dojo.doc = globalDocument;
};

dojo._fireCallback = function(callback, context, cbArguments){
	if(context && dojo.isString(callback)){
		callback = context[callback];
	}
	return callback.apply(context, cbArguments || [ ]);
}

dojo.withGlobal = function(	/*Object*/globalObject, 
							/*Function*/callback, 
							/*Object?*/thisObject, 
							/*Array?*/cbArguments){
	// summary:
	//		Call callback with globalObject as dojo.global and
	//		globalObject.document as dojo.doc. If provided, globalObject
	//		will be executed in the context of object thisObject
	// description:
	//		When callback() returns or throws an error, the dojo.global
	//		and dojo.doc will be restored to its previous state.
	var rval;
	var oldGlob = dojo.global;
	var oldDoc = dojo.doc;
	try{
		dojo.setContext(globalObject, globalObject.document);
		rval = dojo._fireCallback(callback, thisObject, cbArguments);
	}finally{
		dojo.setContext(oldGlob, oldDoc);
	}
	return rval;
}

dojo.withDoc = function(	/*Object*/documentObject, 
							/*Function*/callback, 
							/*Object?*/thisObject, 
							/*Array?*/cbArguments){
	// summary:
	//		Call callback with documentObject as dojo.doc. If provided,
	//		callback will be executed in the context of object thisObject
	// description:
	//		When callback() returns or throws an error, the dojo.doc will
	//		be restored to its previous state.
	var rval;
	var oldDoc = dojo.doc;
	try{
		dojo.doc = documentObject;
		rval = dojo._fireCallback(callback, thisObject, cbArguments);
	}finally{
		dojo.doc = oldDoc;
	}
	return rval;
};

}

if(!dojo._hasResource[""dojo._base.event""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.event""] = true;
dojo.provide(""dojo._base.event"");


// this file courtesy of the TurboAjax Group, licensed under a Dojo CLA

(function(){
	// DOM event listener machinery
	var del = (dojo._event_listener = {
		add: function(/*DOMNode*/node, /*String*/name, /*Function*/fp){
			if(!node){return;} 
			name = del._normalizeEventName(name);
			fp = del._fixCallback(name, fp);
			var oname = name;
			if(!dojo.isIE && (name == ""mouseenter"" || name == ""mouseleave"")){
				var ofp = fp;
				//oname = name;
				name = (name == ""mouseenter"") ? ""mouseover"" : ""mouseout"";
				fp = function(e){
					// check tagName to fix a FF2 bug with invalid nodes (hidden child DIV of INPUT)
					// which causes isDecendant to return false which causes
					// spurious, and more importantly, incorrect mouse events to fire.
					// TODO: remove tagName check when Firefox 2 is no longer supported
					try{ e.relatedTarget.tagName; } catch(e2){ return; }
					if(!dojo.isDescendant(e.relatedTarget, node)){
						// e.type = oname; // FIXME: doesn't take? SJM: event.type is generally immutable.
						return ofp.call(this, e); 
					}
				}
			}
			node.addEventListener(name, fp, false);
			return fp; /*Handle*/
		},
		remove: function(/*DOMNode*/node, /*String*/event, /*Handle*/handle){
			// summary:
			//		clobbers the listener from the node
			// node:
			//		DOM node to attach the event to
			// event:
			//		the name of the handler to remove the function from
			// handle:
			//		the handle returned from add
			if (node){
				event = del._normalizeEventName(event);
				if(!dojo.isIE && (event == ""mouseenter"" || event == ""mouseleave"")){
					event = (event == ""mouseenter"") ? ""mouseover"" : ""mouseout"";
				}

				node.removeEventListener(event, handle, false);
			}
		},
		_normalizeEventName: function(/*String*/name){
			// Generally, name should be lower case, unless it is special
			// somehow (e.g. a Mozilla DOM event).
			// Remove 'on'.
			return name.slice(0,2) ==""on"" ? name.slice(2) : name;
		},
		_fixCallback: function(/*String*/name, fp){
			// By default, we only invoke _fixEvent for 'keypress'
			// If code is added to _fixEvent for other events, we have
			// to revisit this optimization.
			// This also applies to _fixEvent overrides for Safari and Opera
			// below.
			return name != ""keypress"" ? fp : function(e){ return fp.call(this, del._fixEvent(e, this)); };
		},
		_fixEvent: function(evt, sender){
			// _fixCallback only attaches us to keypress.
			// Switch on evt.type anyway because we might 
			// be called directly from dojo.fixEvent.
			switch(evt.type){
				case ""keypress"":
					del._setKeyChar(evt);
					break;
			}
			return evt;
		},
		_setKeyChar: function(evt){
			evt.keyChar = evt.charCode ? String.fromCharCode(evt.charCode) : '';
			evt.charOrCode = evt.keyChar || evt.keyCode;
		},
		// For IE and Safari: some ctrl-key combinations (mostly w/punctuation) do not emit a char code in IE
		// we map those virtual key codes to ascii here
		// not valid for all (non-US) keyboards, so maybe we shouldn't bother
		_punctMap: { 
			106:42, 
			111:47, 
			186:59, 
			187:43, 
			188:44, 
			189:45, 
			190:46, 
			191:47, 
			192:96, 
			219:91, 
			220:92, 
			221:93, 
			222:39 
		}
	});

	// DOM events
	
	dojo.fixEvent = function(/*Event*/evt, /*DOMNode*/sender){
		// summary:
		//		normalizes properties on the event object including event
		//		bubbling methods, keystroke normalization, and x/y positions
		// evt: Event
		//		native event object
		// sender: DOMNode
		//		node to treat as ""currentTarget""
		return del._fixEvent(evt, sender);
	}

	dojo.stopEvent = function(/*Event*/evt){
		// summary:
		//		prevents propagation and clobbers the default action of the
		//		passed event
		// evt: Event
		//		The event object. If omitted, window.event is used on IE.
		evt.preventDefault();
		evt.stopPropagation();
		// NOTE: below, this method is overridden for IE
	}

	// the default listener to use on dontFix nodes, overriden for IE
	var node_listener = dojo._listener;
	
	// Unify connect and event listeners
	dojo._connect = function(obj, event, context, method, dontFix){
		// FIXME: need a more strict test
		var isNode = obj && (obj.nodeType||obj.attachEvent||obj.addEventListener);
		// choose one of three listener options: raw (connect.js), DOM event on a Node, custom event on a Node
		// we need the third option to provide leak prevention on broken browsers (IE)
		var lid = !isNode ? 0 : (!dontFix ? 1 : 2), l = [dojo._listener, del, node_listener][lid];
		// create a listener
		var h = l.add(obj, event, dojo.hitch(context, method));
		// formerly, the disconnect package contained ""l"" directly, but if client code
		// leaks the disconnect package (by connecting it to a node), referencing ""l"" 
		// compounds the problem.
		// instead we return a listener id, which requires custom _disconnect below.
		// return disconnect package
		return [ obj, event, h, lid ];
	}

	dojo._disconnect = function(obj, event, handle, listener){
		([dojo._listener, del, node_listener][listener]).remove(obj, event, handle);
	}

	// Constants

	// Public: client code should test
	// keyCode against these named constants, as the
	// actual codes can vary by browser.
	dojo.keys = {
		// summary: definitions for common key values
		BACKSPACE: 8,
		TAB: 9,
		CLEAR: 12,
		ENTER: 13,
		SHIFT: 16,
		CTRL: 17,
		ALT: 18,
		PAUSE: 19,
		CAPS_LOCK: 20,
		ESCAPE: 27,
		SPACE: 32,
		PAGE_UP: 33,
		PAGE_DOWN: 34,
		END: 35,
		HOME: 36,
		LEFT_ARROW: 37,
		UP_ARROW: 38,
		RIGHT_ARROW: 39,
		DOWN_ARROW: 40,
		INSERT: 45,
		DELETE: 46,
		HELP: 47,
		LEFT_WINDOW: 91,
		RIGHT_WINDOW: 92,
		SELECT: 93,
		NUMPAD_0: 96,
		NUMPAD_1: 97,
		NUMPAD_2: 98,
		NUMPAD_3: 99,
		NUMPAD_4: 100,
		NUMPAD_5: 101,
		NUMPAD_6: 102,
		NUMPAD_7: 103,
		NUMPAD_8: 104,
		NUMPAD_9: 105,
		NUMPAD_MULTIPLY: 106,
		NUMPAD_PLUS: 107,
		NUMPAD_ENTER: 108,
		NUMPAD_MINUS: 109,
		NUMPAD_PERIOD: 110,
		NUMPAD_DIVIDE: 111,
		F1: 112,
		F2: 113,
		F3: 114,
		F4: 115,
		F5: 116,
		F6: 117,
		F7: 118,
		F8: 119,
		F9: 120,
		F10: 121,
		F11: 122,
		F12: 123,
		F13: 124,
		F14: 125,
		F15: 126,
		NUM_LOCK: 144,
		SCROLL_LOCK: 145
	};
	
	// IE event normalization
	if(dojo.isIE){ 
		var _trySetKeyCode = function(e, code){
			try{
				// squelch errors when keyCode is read-only
				// (e.g. if keyCode is ctrl or shift)
				return (e.keyCode = code);
			}catch(e){
				return 0;
			}
		}

		// by default, use the standard listener
		var iel = dojo._listener;
		var listenersName = dojo._ieListenersName = ""_"" + dojo._scopeName + ""_listeners"";
		// dispatcher tracking property
		if(!dojo.config._allow_leaks){
			// custom listener that handles leak protection for DOM events
			node_listener = iel = dojo._ie_listener = {
				// support handler indirection: event handler functions are 
				// referenced here. Event dispatchers hold only indices.
				handlers: [],
				// add a listener to an object
				add: function(/*Object*/ source, /*String*/ method, /*Function*/ listener){
					source = source || dojo.global;
					var f = source[method];
					if(!f||!f[listenersName]){
						var d = dojo._getIeDispatcher();
						// original target function is special
						d.target = f && (ieh.push(f) - 1);
						// dispatcher holds a list of indices into handlers table
						d[listenersName] = [];
						// redirect source to dispatcher
						f = source[method] = d;
					}
					return f[listenersName].push(ieh.push(listener) - 1) ; /*Handle*/
				},
				// remove a listener from an object
				remove: function(/*Object*/ source, /*String*/ method, /*Handle*/ handle){
					var f = (source||dojo.global)[method], l = f && f[listenersName];
					if(f && l && handle--){
						delete ieh[l[handle]];
						delete l[handle];
					}
				}
			};
			// alias used above
			var ieh = iel.handlers;
		}

		dojo.mixin(del, {
			add: function(/*DOMNode*/node, /*String*/event, /*Function*/fp){
				if(!node){return;} // undefined
				event = del._normalizeEventName(event);
				if(event==""onkeypress""){
					// we need to listen to onkeydown to synthesize
					// keypress events that otherwise won't fire
					// on IE
					var kd = node.onkeydown;
					if(!kd || !kd[listenersName] || !kd._stealthKeydownHandle){
						var h = del.add(node, ""onkeydown"", del._stealthKeyDown);
						kd = node.onkeydown;
						kd._stealthKeydownHandle = h;
						kd._stealthKeydownRefs = 1;
					}else{
						kd._stealthKeydownRefs++;
					}
				}
				return iel.add(node, event, del._fixCallback(fp));
			},
			remove: function(/*DOMNode*/node, /*String*/event, /*Handle*/handle){
				event = del._normalizeEventName(event);
				iel.remove(node, event, handle); 
				if(event==""onkeypress""){
					var kd = node.onkeydown;
					if(--kd._stealthKeydownRefs <= 0){
						iel.remove(node, ""onkeydown"", kd._stealthKeydownHandle);
						delete kd._stealthKeydownHandle;
					}
				}
			},
			_normalizeEventName: function(/*String*/eventName){
				// Generally, eventName should be lower case, unless it is
				// special somehow (e.g. a Mozilla event)
				// ensure 'on'
				return eventName.slice(0,2) != ""on"" ? ""on"" + eventName : eventName;
			},
			_nop: function(){},
			_fixEvent: function(/*Event*/evt, /*DOMNode*/sender){
				// summary:
				//		normalizes properties on the event object including event
				//		bubbling methods, keystroke normalization, and x/y positions
				// evt: native event object
				// sender: node to treat as ""currentTarget""
				if(!evt){
					var w = sender && (sender.ownerDocument || sender.document || sender).parentWindow || window;
					evt = w.event; 
				}
				if(!evt){return(evt);}
				evt.target = evt.srcElement; 
				evt.currentTarget = (sender || evt.srcElement); 
				evt.layerX = evt.offsetX;
				evt.layerY = evt.offsetY;
				// FIXME: scroll position query is duped from dojo.html to
				// avoid dependency on that entire module. Now that HTML is in
				// Base, we should convert back to something similar there.
				var se = evt.srcElement, doc = (se && se.ownerDocument) || document;
				// DO NOT replace the following to use dojo.body(), in IE, document.documentElement should be used
				// here rather than document.body
				var docBody = ((dojo.isIE < 6) || (doc[""compatMode""] == ""BackCompat"")) ? doc.body : doc.documentElement;
				var offset = dojo._getIeDocumentElementOffset();
				evt.pageX = evt.clientX + dojo._fixIeBiDiScrollLeft(docBody.scrollLeft || 0) - offset.x;
				evt.pageY = evt.clientY + (docBody.scrollTop || 0) - offset.y;
				if(evt.type == ""mouseover""){ 
					evt.relatedTarget = evt.fromElement;
				}
				if(evt.type == ""mouseout""){ 
					evt.relatedTarget = evt.toElement;
				}
				evt.stopPropagation = del._stopPropagation;
				evt.preventDefault = del._preventDefault;
				return del._fixKeys(evt);
			},
			_fixKeys: function(evt){
				switch(evt.type){
					case ""keypress"":
						var c = (""charCode"" in evt ? evt.charCode : evt.keyCode);
						if (c==10){
							// CTRL-ENTER is CTRL-ASCII(10) on IE, but CTRL-ENTER on Mozilla
							c=0;
							evt.keyCode = 13;
						}else if(c==13||c==27){
							c=0; // Mozilla considers ENTER and ESC non-printable
						}else if(c==3){
							c=99; // Mozilla maps CTRL-BREAK to CTRL-c
						}
						// Mozilla sets keyCode to 0 when there is a charCode
						// but that stops the event on IE.
						evt.charCode = c;
						del._setKeyChar(evt);
						break;
				}
				return evt;
			},
			_stealthKeyDown: function(evt){
				// IE doesn't fire keypress for most non-printable characters.
				// other browsers do, we simulate it here.
				var kp = evt.currentTarget.onkeypress;
				// only works if kp exists and is a dispatcher
				if(!kp || !kp[listenersName]){ return; }
				// munge key/charCode
				var k=evt.keyCode;
				// These are Windows Virtual Key Codes
				// http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/WinUI/WindowsUserInterface/UserInput/VirtualKeyCodes.asp
				var unprintable = (k!=13)&&(k!=32)&&(k!=27)&&(k<48||k>90)&&(k<96||k>111)&&(k<186||k>192)&&(k<219||k>222);
				// synthesize keypress for most unprintables and CTRL-keys
				if(unprintable||evt.ctrlKey){
					var c = unprintable ? 0 : k;
					if(evt.ctrlKey){
						if(k==3 || k==13){
							return; // IE will post CTRL-BREAK, CTRL-ENTER as keypress natively 
						}else if(c>95 && c<106){ 
							c -= 48; // map CTRL-[numpad 0-9] to ASCII
						}else if((!evt.shiftKey)&&(c>=65&&c<=90)){ 
							c += 32; // map CTRL-[A-Z] to lowercase
						}else{ 
							c = del._punctMap[c] || c; // map other problematic CTRL combinations to ASCII
						}
					}
					// simulate a keypress event
					var faux = del._synthesizeEvent(evt, {type: 'keypress', faux: true, charCode: c});
					kp.call(evt.currentTarget, faux);
					evt.cancelBubble = faux.cancelBubble;
					evt.returnValue = faux.returnValue;
					_trySetKeyCode(evt, faux.keyCode);
				}
			},
			// Called in Event scope
			_stopPropagation: function(){
				this.cancelBubble = true; 
			},
			_preventDefault: function(){
				// Setting keyCode to 0 is the only way to prevent certain keypresses (namely
				// ctrl-combinations that correspond to menu accelerator keys).
				// Otoh, it prevents upstream listeners from getting this information
				// Try to split the difference here by clobbering keyCode only for ctrl 
				// combinations. If you still need to access the key upstream, bubbledKeyCode is
				// provided as a workaround.
				this.bubbledKeyCode = this.keyCode;
				if(this.ctrlKey){_trySetKeyCode(this, 0);}
				this.returnValue = false;
			}
		});
				
		// override stopEvent for IE
		dojo.stopEvent = function(evt){
			evt = evt || window.event;
			del._stopPropagation.call(evt);
			del._preventDefault.call(evt);
		}
	}

	del._synthesizeEvent = function(evt, props){
			var faux = dojo.mixin({}, evt, props);
			del._setKeyChar(faux);
			// FIXME: would prefer to use dojo.hitch: dojo.hitch(evt, evt.preventDefault); 
			// but it throws an error when preventDefault is invoked on Safari
			// does Event.preventDefault not support ""apply"" on Safari?
			faux.preventDefault = function(){ evt.preventDefault(); }; 
			faux.stopPropagation = function(){ evt.stopPropagation(); }; 
			return faux;
	}
	
	// Opera event normalization
	if(dojo.isOpera){
		dojo.mixin(del, {
			_fixEvent: function(evt, sender){
				switch(evt.type){
					case ""keypress"":
						var c = evt.which;
						if(c==3){
							c=99; // Mozilla maps CTRL-BREAK to CTRL-c
						}
						// can't trap some keys at all, like INSERT and DELETE
						// there is no differentiating info between DELETE and ""."", or INSERT and ""-""
						c = ((c<41)&&(!evt.shiftKey) ? 0 : c);
						if((evt.ctrlKey)&&(!evt.shiftKey)&&(c>=65)&&(c<=90)){
							// lowercase CTRL-[A-Z] keys
							c += 32;
						}
						return del._synthesizeEvent(evt, { charCode: c });
				}
				return evt;
			}
		});
	}

	// Safari event normalization
	if(dojo.isSafari){
		del._add = del.add;
		del._remove = del.remove;

		dojo.mixin(del, {
			add: function(/*DOMNode*/node, /*String*/event, /*Function*/fp){
				if(!node){return;} // undefined
				var handle = del._add(node, event, fp);
				if(del._normalizeEventName(event) == ""keypress""){
					// we need to listen to onkeydown to synthesize
					// keypress events that otherwise won't fire
					// in Safari 3.1+: https://lists.webkit.org/pipermail/webkit-dev/2007-December/002992.html
					handle._stealthKeyDownHandle = del._add(node, ""keydown"", function(evt){
						//A variation on the IE _stealthKeydown function
						//Synthesize an onkeypress event, but only for unprintable characters.
						var k=evt.keyCode;
						// These are Windows Virtual Key Codes
						// http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/WinUI/WindowsUserInterface/UserInput/VirtualKeyCodes.asp
						var unprintable = (k!=13)&&(k!=32)&&(k!=27)&&(k<48||k>90)&&(k<96||k>111)&&(k<186||k>192)&&(k<219||k>222);
						// synthesize keypress for most unprintables and CTRL-keys
						if(unprintable||evt.ctrlKey){
							var c = unprintable ? 0 : k;
							if(evt.ctrlKey){
								if(k==3 || k==13){
									return; // IE will post CTRL-BREAK, CTRL-ENTER as keypress natively 
								}else if(c>95 && c<106){ 
									c -= 48; // map CTRL-[numpad 0-9] to ASCII
								}else if((!evt.shiftKey)&&(c>=65&&c<=90)){ 
									c += 32; // map CTRL-[A-Z] to lowercase
								}else{ 
									c = del._punctMap[c] || c; // map other problematic CTRL combinations to ASCII
								}
							}
							// simulate a keypress event
							var faux = del._synthesizeEvent(evt, {type: 'keypress', faux: true, charCode: c});
							fp.call(evt.currentTarget, faux);
						}
					});
				}
				return handle; /*Handle*/
			},

			remove: function(/*DOMNode*/node, /*String*/event, /*Handle*/handle){
				if(node){
					if(handle._stealthKeyDownHandle){
						del._remove(node, ""keydown"", handle._stealthKeyDownHandle);
					}
					del._remove(node, event, handle);
				}
			},
			_fixEvent: function(evt, sender){
				switch(evt.type){
					case ""keypress"":
						if(evt.faux){ return evt; }
						var c = evt.charCode;
						c = c>=32? c : 0;
						return del._synthesizeEvent(evt, {charCode: c, faux: true});
				}
				return evt;
			}
		});
	}
})();

if(dojo.isIE){
	// keep this out of the closure
	// closing over 'iel' or 'ieh' b0rks leak prevention
	// ls[i] is an index into the master handler array
	dojo._ieDispatcher = function(args, sender){
		var ap=Array.prototype, h=dojo._ie_listener.handlers, c=args.callee, ls=c[dojo._ieListenersName], t=h[c.target];
		// return value comes from original target function
		var r = t && t.apply(sender, args);
		// make local copy of listener array so it's immutable during processing
		var lls = [].concat(ls);
		// invoke listeners after target function
		for(var i in lls){
			if(!(i in ap)){
				h[lls[i]].apply(sender, args);
			}
		}
		return r;
	}
	dojo._getIeDispatcher = function(){
		// ensure the returned function closes over nothing (""new Function"" apparently doesn't close)
		return new Function(dojo._scopeName + ""._ieDispatcher(arguments, this)""); // function
	}
	// keep this out of the closure to reduce RAM allocation
	dojo._event_listener._fixCallback = function(fp){
		var f = dojo._event_listener._fixEvent;
		return function(e){ return fp.call(this, f(e, this)); };
	}
}

}

if(!dojo._hasResource[""dojo._base.html""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.html""] = true;

dojo.provide(""dojo._base.html"");

// FIXME: need to add unit tests for all the semi-public methods

try{
	document.execCommand(""BackgroundImageCache"", false, true);
}catch(e){
	// sane browsers don't have cache ""issues""
}

// =============================
// DOM Functions
// =============================

/*=====
dojo.byId = function(id, doc){
	//	summary:
	//		Returns DOM node with matching `id` attribute or `null` 
	//		if not found, similar to ""$"" function in another library.
	//		If `id` is a DomNode, this function is a no-op.
	//
	//	id: String|DOMNode
	//	 	A string to match an HTML id attribute or a reference to a DOM Node
	//
	//	doc: Document?
	//		Document to work in. Defaults to the current value of
	//		dojo.doc.  Can be used to retrieve
	//		node references from other documents.
=====*/
if(dojo.isIE || dojo.isOpera){
	dojo.byId = function(id, doc){
		if(dojo.isString(id)){
			var _d = doc || dojo.doc;
			var te = _d.getElementById(id);
			// attributes.id.value is better than just id in case the 
			// user has a name=id inside a form
			if(te && te.attributes.id.value == id){
				return te;
			}else{
				var eles = _d.all[id];
				if(!eles || !eles.length){ return eles; }
				// if more than 1, choose first with the correct id
				var i=0;
				while((te=eles[i++])){
					if(te.attributes.id.value == id){ return te; }
				}
			}
		}else{
			return id; // DomNode
		}
	}
}else{
	dojo.byId = function(id, doc){
		return dojo.isString(id) ? (doc || dojo.doc).getElementById(id) : id; // DomNode
	}
}
/*=====
}
=====*/

(function(){
	var d = dojo;

	var _destroyContainer = null;
	dojo.addOnWindowUnload(function(){
		_destroyContainer=null; //prevent IE leak
	});

	dojo._destroyElement = function(/*String||DomNode*/node){
		// summary:
		//		removes node from its parent, clobbers it and all of its
		//		children.
		//	node:
		//		the element to be destroyed, either as an ID or a reference

		node = d.byId(node);
		try{
			if(!_destroyContainer || _destroyContainer.ownerDocument != node.ownerDocument){
				_destroyContainer = node.ownerDocument.createElement(""div"");
			}
			_destroyContainer.appendChild(node.parentNode ? node.parentNode.removeChild(node) : node);
			// NOTE: see http://trac.dojotoolkit.org/ticket/2931. This may be a bug and not a feature
			_destroyContainer.innerHTML = """"; 
		}catch(e){
			/* squelch */
		}
	};

	dojo.isDescendant = function(/*DomNode|String*/node, /*DomNode|String*/ancestor){
		//	summary:
		//		Returns true if node is a descendant of ancestor
		//	node: id or node reference to test
		//	ancestor: id or node reference of potential parent to test against
		try{
			node = d.byId(node);
			ancestor = d.byId(ancestor);
			while(node){
				if(node === ancestor){
					return true; // Boolean
				}
				node = node.parentNode;
			}
		}catch(e){ /* squelch, return false */ }
		return false; // Boolean
	};

	dojo.setSelectable = function(/*DomNode|String*/node, /*Boolean*/selectable){
		//	summary: enable or disable selection on a node
		//	node:
		//		id or reference to node
		//	selectable:
		node = d.byId(node);
		if(d.isMozilla){
			node.style.MozUserSelect = selectable ? """" : ""none"";
		}else if(d.isKhtml){
			node.style.KhtmlUserSelect = selectable ? ""auto"" : ""none"";
		}else if(d.isIE){
			var v = (node.unselectable = selectable ? """" : ""on"");
			d.query(""*"", node).forEach(""item.unselectable = '""+v+""'"");
		}
		//FIXME: else?  Opera?
	};

	var _insertBefore = function(/*Node*/node, /*Node*/ref){
		ref.parentNode.insertBefore(node, ref);
		return true;	//	boolean
	}

	var _insertAfter = function(/*Node*/node, /*Node*/ref){
		//	summary:
		//		Try to insert node after ref
		var pn = ref.parentNode;
		if(ref == pn.lastChild){
			pn.appendChild(node);
		}else{
			return _insertBefore(node, ref.nextSibling);	//	boolean
		}
		return true;	//	boolean
	}

	dojo.place = function(/*String|DomNode*/node, /*String|DomNode*/refNode, /*String?|Number?*/position){
		//	summary:
		//		Attempt to insert node into the DOM, choosing from various positioning options.
		//		Returns true if successful, false otherwise.
		//	node: 
		//		id or node reference to place relative to refNode
		//	refNode: 
		//		id or node reference to use as basis for placement
		//	position:
		//		string noting the position of node relative to refNode or a
		//		number indicating the location in the childNodes collection of refNode. 
		//		Accepted string values are:
		//		* before
		//		* after
		//		* first
		//		* last
		//
		//		""first"" and ""last"" indicate positions as children of refNode.  position defaults
		//		to ""last"" if not specified

		// FIXME: need to write tests for this!!!!
		if(!node || !refNode){
			return false;	//	boolean 
		}
		node = d.byId(node);
		refNode = d.byId(refNode);
		if(typeof position == ""number""){
			var cn = refNode.childNodes;
			if(!cn.length || cn.length <= position){
				refNode.appendChild(node);
				return true;
			}
			return _insertBefore(node, position <= 0 ? refNode.firstChild : cn[position]);
		}
		switch(position){
			case ""before"":
				return _insertBefore(node, refNode);	//	boolean
			case ""after"":
				return _insertAfter(node, refNode);		//	boolean
			case ""first"":
				if(refNode.firstChild){
					return _insertBefore(node, refNode.firstChild);	//	boolean
				}
				// else fallthrough...
			default: // aka: last
				refNode.appendChild(node);
				return true;	//	boolean
		}
	}

	// Box functions will assume this model.
	// On IE/Opera, BORDER_BOX will be set if the primary document is in quirks mode.
	// Can be set to change behavior of box setters.
	
	// can be either:
	//	""border-box""
	//	""content-box"" (default)
	dojo.boxModel = ""content-box"";
	
	// We punt per-node box mode testing completely.
	// If anybody cares, we can provide an additional (optional) unit 
	// that overrides existing code to include per-node box sensitivity.

	// Opera documentation claims that Opera 9 uses border-box in BackCompat mode.
	// but experiments (Opera 9.10.8679 on Windows Vista) indicate that it actually continues to use content-box.
	// IIRC, earlier versions of Opera did in fact use border-box.
	// Opera guys, this is really confusing. Opera being broken in quirks mode is not our fault.

	if(d.isIE /*|| dojo.isOpera*/){
		var _dcm = document.compatMode;
		// client code may have to adjust if compatMode varies across iframes
		d.boxModel = _dcm == ""BackCompat"" || _dcm == ""QuirksMode"" || d.isIE<6 ? ""border-box"" : ""content-box""; // FIXME: remove IE < 6 support?
	}

	// =============================
	// Style Functions
	// =============================
	
	// getComputedStyle drives most of the style code.
	// Wherever possible, reuse the returned object.
	//
	// API functions below that need to access computed styles accept an 
	// optional computedStyle parameter.
	// If this parameter is omitted, the functions will call getComputedStyle themselves.
	// This way, calling code can access computedStyle once, and then pass the reference to 
	// multiple API functions. 

/*=====
	dojo.getComputedStyle = function(node){
		//	summary:
		//		Returns a ""computed style"" object.
		//
		//	description:
		//		Gets a ""computed style"" object which can be used to gather
		//		information about the current state of the rendered node. 
		//
		//		Note that this may behave differently on different browsers.
		//		Values may have different formats and value encodings across
		//		browsers.
		//
		//		Note also that this method is expensive.  Wherever possible,
		//		reuse the returned object.
		//
		//		Use the dojo.style() method for more consistent (pixelized)
		//		return values.
		//
		//	node: DOMNode
		//		A reference to a DOM node. Does NOT support taking an
		//		ID string for speed reasons.
		//	example:
		//	|	dojo.getComputedStyle(dojo.byId('foo')).borderWidth;
		return; // CSS2Properties
	}
=====*/

	// Although we normally eschew argument validation at this
	// level, here we test argument 'node' for (duck)type.
	// Argument node must also implement Element.  (Note: we check
	// against HTMLElement rather than Element for interop with prototype.js)
	// Because 'document' is the 'parentNode' of 'body'
	// it is frequently sent to this function even 
	// though it is not Element.
	var gcs;
	if(d.isSafari){
		gcs = function(/*DomNode*/node){
			var s;
			if(node instanceof HTMLElement){
				var dv = node.ownerDocument.defaultView;
				s = dv.getComputedStyle(node, null);
				if(!s && node.style){ 
					node.style.display = """"; 
					s = dv.getComputedStyle(node, null);
				}
			}
			return s || {};
		}; 
	}else if(d.isIE){
		gcs = function(node){
			// IE (as of 7) doesn't expose Element like sane browsers
			return node.nodeType == 1 /* ELEMENT_NODE*/ ? node.currentStyle : {};
		};
	}else{
		gcs = function(node){
			return node instanceof HTMLElement ? 
				node.ownerDocument.defaultView.getComputedStyle(node, null) : {};
		};
	}
	dojo.getComputedStyle = gcs;

	if(!d.isIE){
		dojo._toPixelValue = function(element, value){
			// style values can be floats, client code may want
			// to round for integer pixels.
			return parseFloat(value) || 0; 
		};
	}else{
		dojo._toPixelValue = function(element, avalue){
			if(!avalue){ return 0; }
			// on IE7, medium is usually 4 pixels
			if(avalue==""medium""){ return 4; }
			// style values can be floats, client code may
			// want to round this value for integer pixels.
			if(avalue.slice && (avalue.slice(-2)=='px')){ return parseFloat(avalue); }
			with(element){
				var sLeft = style.left;
				var rsLeft = runtimeStyle.left;
				runtimeStyle.left = currentStyle.left;
				try{
					// 'avalue' may be incompatible with style.left, which can cause IE to throw
					// this has been observed for border widths using ""thin"", ""medium"", ""thick"" constants
					// those particular constants could be trapped by a lookup
					// but perhaps there are more
					style.left = avalue;
					avalue = style.pixelLeft;
				}catch(e){
					avalue = 0;
				}
				style.left = sLeft;
				runtimeStyle.left = rsLeft;
			}
			return avalue;
		}
	}
	var px = d._toPixelValue;

	// FIXME: there opacity quirks on FF that we haven't ported over. Hrm.
	/*=====
	dojo._getOpacity = function(node){
			//	summary:
			//		Returns the current opacity of the passed node as a
			//		floating-point value between 0 and 1.
			//	node: DomNode
			//		a reference to a DOM node. Does NOT support taking an
			//		ID string for speed reasons.
			//	returns: Number between 0 and 1
			return; // Number
	}
	=====*/

	var astr = ""DXImageTransform.Microsoft.Alpha"";
	var af = function(n, f){ 
		try{
			return n.filters.item(astr);
		}catch(e){
			return f ? {} : null;
		}
	}

	dojo._getOpacity = d.isIE ? function(node){
		try{
			return af(node).Opacity / 100; // Number
		}catch(e){
			return 1; // Number
		}
	} : function(node){
		return gcs(node).opacity;
	};

	/*=====
	dojo._setOpacity = function(node, opacity){
			//	summary:
			//		set the opacity of the passed node portably. Returns the
			//		new opacity of the node.
			//	node: DOMNode
			//		a reference to a DOM node. Does NOT support taking an
			//		ID string for performance reasons.
			//	opacity: Number
			//		A Number between 0 and 1. 0 specifies transparent.
			//	returns: Number between 0 and 1
			return; // Number
	}
	=====*/

	dojo._setOpacity = d.isIE ? function(/*DomNode*/node, /*Number*/opacity){
		var ov = opacity * 100;
		node.style.zoom = 1.0;

		// on IE7 Alpha(Filter opacity=100) makes text look fuzzy so disable it altogether (bug #2661),
		//but still update the opacity value so we can get a correct reading if it is read later.
		af(node, 1).Enabled = (opacity == 1 ? false : true);

		if(!af(node)){
			node.style.filter += "" progid:""+astr+""(Opacity=""+ov+"")"";
		}else{
			af(node, 1).Opacity = ov;
		}

		if(node.nodeName.toLowerCase() == ""tr""){
			d.query(""> td"", node).forEach(function(i){
				d._setOpacity(i, opacity);
			});
		}
		return opacity;
	} : function(node, opacity){
		return node.style.opacity = opacity;
	};

	var _pixelNamesCache = {
		left: true, top: true
	};
	var _pixelRegExp = /margin|padding|width|height|max|min|offset/;  // |border
	var _toStyleValue = function(node, type, value){
		type = type.toLowerCase(); // FIXME: should we really be doing string case conversion here? Should we cache it? Need to profile!
		if(d.isIE){
			if(value == ""auto""){
				if(type == ""height""){ return node.offsetHeight; }
				if(type == ""width""){ return node.offsetWidth; }
			}
			if(type == ""fontweight""){
				switch(value){
					case 700: return ""bold"";
					case 400:
					default: return ""normal"";
				}
			}
		}
		if(!(type in _pixelNamesCache)){
			_pixelNamesCache[type] = _pixelRegExp.test(type);
		}
		return _pixelNamesCache[type] ? px(node, value) : value;
	}

	var _floatStyle = d.isIE ? ""styleFloat"" : ""cssFloat"";
	var _floatAliases = { ""cssFloat"": _floatStyle, ""styleFloat"": _floatStyle, ""float"": _floatStyle };
	
	// public API
	
	dojo.style = function(	/*DomNode|String*/ node, 
							/*String?|Object?*/ style, 
							/*String?*/ value){
		//	summary:
		//		Accesses styles on a node. If 2 arguments are
		//		passed, acts as a getter. If 3 arguments are passed, acts
		//		as a setter.
		//	node:
		//		id or reference to node to get/set style for
		//	style:
		//		the style property to set in DOM-accessor format
		//		(""borderWidth"", not ""border-width"") or an object with key/value
		//		pairs suitable for setting each property.
		//	value:
		//		If passed, sets value on the node for style, handling
		//		cross-browser concerns.
		//	example:
		//		Passing only an ID or node returns the computed style object of
		//		the node:
		//	|	dojo.style(""thinger"");
		//	example:
		//		Passing a node and a style property returns the current
		//		normalized, computed value for that property:
		//	|	dojo.style(""thinger"", ""opacity""); // 1 by default
		//
		//	example:
		//		Passing a node, a style property, and a value changes the
		//		current display of the node and returns the new computed value
		//	|	dojo.style(""thinger"", ""opacity"", 0.5); // == 0.5
		//
		//	example:
		//		Passing a node, an object-style style property sets each of the values in turn and returns the computed style object of the node:
		//	|	dojo.style(""thinger"", {
		//	|		""opacity"": 0.5,
		//	|		""border"": ""3px solid black"",
		//	|		""height"": 300
		//	|	});
		//
		// 	example:
		//		When the CSS style property is hyphenated, the JavaScript property is camelCased.
		//		font-size becomes fontSize, and so on.
		//	|	dojo.style(""thinger"",{
		//	|		fontSize:""14pt"",
		//	|		letterSpacing:""1.2em""
		//	|	});
		//
		//	example:
		//		dojo.NodeList implements .style() using the same syntax, omitting the ""node"" parameter, calling
		//		dojo.style() on every element of the list. See: dojo.query and dojo.NodeList
		//	|	dojo.query("".someClassName"").style(""visibility"",""hidden"");
		//	|	// or
		//	|	dojo.query(""#baz > div"").style({
		//	|		opacity:0.75,
		//	|		fontSize:""13pt""
		//	|	});

		var n = d.byId(node), args = arguments.length, op = (style==""opacity"");
		style = _floatAliases[style] || style;
		if(args == 3){
			return op ? d._setOpacity(n, value) : n.style[style] = value; /*Number*/
		}
		if(args == 2 && op){
			return d._getOpacity(n);
		}
		var s = gcs(n);
		if(args == 2 && !d.isString(style)){
			for(var x in style){
				d.style(node, x, style[x]);
			}
			return s;
		}
		return (args == 1) ? s : _toStyleValue(n, style, s[style]||n.style[style]); /* CSS2Properties||String||Number */
	}

	// =============================
	// Box Functions
	// =============================

	dojo._getPadExtents = function(/*DomNode*/n, /*Object*/computedStyle){
		//	summary:
		// 		Returns object with special values specifically useful for node
		// 		fitting.
		//
		// 		* l/t = left/top padding (respectively)
		// 		* w = the total of the left and right padding 
		// 		* h = the total of the top and bottom padding
		//
		//		If 'node' has position, l/t forms the origin for child nodes. 
		//		The w/h are used for calculating boxes.
		//		Normally application code will not need to invoke this
		//		directly, and will use the ...box... functions instead.
		var 
			s = computedStyle||gcs(n), 
			l = px(n, s.paddingLeft), 
			t = px(n, s.paddingTop);
		return { 
			l: l,
			t: t,
			w: l+px(n, s.paddingRight),
			h: t+px(n, s.paddingBottom)
		};
	}

	dojo._getBorderExtents = function(/*DomNode*/n, /*Object*/computedStyle){
		//	summary:
		//		returns an object with properties useful for noting the border
		//		dimensions.
		//
		// 		* l/t = the sum of left/top border (respectively)
		//		* w = the sum of the left and right border
		//		* h = the sum of the top and bottom border
		//
		//		The w/h are used for calculating boxes.
		//		Normally application code will not need to invoke this
		//		directly, and will use the ...box... functions instead.
		var 
			ne = ""none"",
			s = computedStyle||gcs(n), 
			bl = (s.borderLeftStyle != ne ? px(n, s.borderLeftWidth) : 0),
			bt = (s.borderTopStyle != ne ? px(n, s.borderTopWidth) : 0);
		return { 
			l: bl,
			t: bt,
			w: bl + (s.borderRightStyle!=ne ? px(n, s.borderRightWidth) : 0),
			h: bt + (s.borderBottomStyle!=ne ? px(n, s.borderBottomWidth) : 0)
		};
	}

	dojo._getPadBorderExtents = function(/*DomNode*/n, /*Object*/computedStyle){
		//	summary:
		//		returns object with properties useful for box fitting with
		//		regards to padding.
		//
		//		* l/t = the sum of left/top padding and left/top border (respectively)
		//		* w = the sum of the left and right padding and border
		//		* h = the sum of the top and bottom padding and border
		//
		//		The w/h are used for calculating boxes.
		//		Normally application code will not need to invoke this
		//		directly, and will use the ...box... functions instead.
		var 
			s = computedStyle||gcs(n), 
			p = d._getPadExtents(n, s),
			b = d._getBorderExtents(n, s);
		return { 
			l: p.l + b.l,
			t: p.t + b.t,
			w: p.w + b.w,
			h: p.h + b.h
		};
	}

	dojo._getMarginExtents = function(n, computedStyle){
		//	summary:
		//		returns object with properties useful for box fitting with
		//		regards to box margins (i.e., the outer-box).
		//
		//		* l/t = marginLeft, marginTop, respectively
		//		* w = total width, margin inclusive
		//		* h = total height, margin inclusive
		//
		//		The w/h are used for calculating boxes.
		//		Normally application code will not need to invoke this
		//		directly, and will use the ...box... functions instead.
		var 
			s = computedStyle||gcs(n), 
			l = px(n, s.marginLeft),
			t = px(n, s.marginTop),
			r = px(n, s.marginRight),
			b = px(n, s.marginBottom);
		if(d.isSafari && (s.position != ""absolute"")){
			// FIXME: Safari's version of the computed right margin
			// is the space between our right edge and the right edge 
			// of our offsetParent. 
			// What we are looking for is the actual margin value as 
			// determined by CSS.
			// Hack solution is to assume left/right margins are the same.
			r = l;
		}
		return { 
			l: l,
			t: t,
			w: l+r,
			h: t+b
		};
	}

	// Box getters work in any box context because offsetWidth/clientWidth
	// are invariant wrt box context
	//
	// They do *not* work for display: inline objects that have padding styles
	// because the user agent ignores padding (it's bogus styling in any case)
	//
	// Be careful with IMGs because they are inline or block depending on 
	// browser and browser mode.

	// Although it would be easier to read, there are not separate versions of 
	// _getMarginBox for each browser because:
	// 1. the branching is not expensive
	// 2. factoring the shared code wastes cycles (function call overhead)
	// 3. duplicating the shared code wastes bytes
	
	dojo._getMarginBox = function(/*DomNode*/node, /*Object*/computedStyle){
		// summary:
		//		returns an object that encodes the width, height, left and top
		//		positions of the node's margin box.
		var s = computedStyle||gcs(node), me = d._getMarginExtents(node, s);
		var l = node.offsetLeft - me.l, t = node.offsetTop - me.t, p = node.parentNode;
		if(d.isMoz){
			// Mozilla:
			// If offsetParent has a computed overflow != visible, the offsetLeft is decreased
			// by the parent's border.
			// We don't want to compute the parent's style, so instead we examine node's
			// computed left/top which is more stable.
			var sl = parseFloat(s.left), st = parseFloat(s.top);
			if(!isNaN(sl) && !isNaN(st)){
				l = sl, t = st;
			}else{
				// If child's computed left/top are not parseable as a number (e.g. ""auto""), we
				// have no choice but to examine the parent's computed style.
				if(p && p.style){
					var pcs = gcs(p);
					if(pcs.overflow != ""visible""){
						var be = d._getBorderExtents(p, pcs);
						l += be.l, t += be.t;
					}
				}
			}
		}else if(d.isOpera){
			// On Opera, offsetLeft includes the parent's border
			if(p){
				var be = d._getBorderExtents(p);
				l -= be.l;
				t -= be.t;
			}
		}
		return { 
			l: l, 
			t: t, 
			w: node.offsetWidth + me.w, 
			h: node.offsetHeight + me.h 
		};
	}
	
	dojo._getContentBox = function(node, computedStyle){
		// summary:
		//		Returns an object that encodes the width, height, left and top
		//		positions of the node's content box, irrespective of the
		//		current box model.

		// clientWidth/Height are important since the automatically account for scrollbars
		// fallback to offsetWidth/Height for special cases (see #3378)
		var s=computedStyle||gcs(node), pe=d._getPadExtents(node, s), be=d._getBorderExtents(node, s), w=node.clientWidth, h;
		if(!w){
			w=node.offsetWidth, h=node.offsetHeight;
		}else{
			h=node.clientHeight, be.w = be.h = 0; 
		}
		// On Opera, offsetLeft includes the parent's border
		if(d.isOpera){ pe.l += be.l; pe.t += be.t; };
		return { 
			l: pe.l, 
			t: pe.t, 
			w: w - pe.w - be.w, 
			h: h - pe.h - be.h
		};
	}

	dojo._getBorderBox = function(node, computedStyle){
		var s=computedStyle||gcs(node), pe=d._getPadExtents(node, s), cb=d._getContentBox(node, s);
		return { 
			l: cb.l - pe.l, 
			t: cb.t - pe.t, 
			w: cb.w + pe.w, 
			h: cb.h + pe.h
		};
	}

	// Box setters depend on box context because interpretation of width/height styles
	// vary wrt box context.
	//
	// The value of dojo.boxModel is used to determine box context.
	// dojo.boxModel can be set directly to change behavior.
	//
	// Beware of display: inline objects that have padding styles
	// because the user agent ignores padding (it's a bogus setup anyway)
	//
	// Be careful with IMGs because they are inline or block depending on 
	// browser and browser mode.
	// 
	// Elements other than DIV may have special quirks, like built-in
	// margins or padding, or values not detectable via computedStyle.
	// In particular, margins on TABLE do not seems to appear 
	// at all in computedStyle on Mozilla.
	
	dojo._setBox = function(/*DomNode*/node, /*Number?*/l, /*Number?*/t, /*Number?*/w, /*Number?*/h, /*String?*/u){
		//	summary:
		//		sets width/height/left/top in the current (native) box-model
		//		dimentions. Uses the unit passed in u.
		//	node: DOM Node reference. Id string not supported for performance reasons.
		//	l: optional. left offset from parent.
		//	t: optional. top offset from parent.
		//	w: optional. width in current box model.
		//	h: optional. width in current box model.
		//	u: optional. unit measure to use for other measures. Defaults to ""px"".
		u = u || ""px"";
		var s = node.style;
		if(!isNaN(l)){ s.left = l+u; }
		if(!isNaN(t)){ s.top = t+u; }
		if(w>=0){ s.width = w+u; }
		if(h>=0){ s.height = h+u; }
	}

	dojo._isButtonTag = function(/*DomNode*/node) {
		// summary:
		//		True if the node is BUTTON or INPUT.type=""button"".
		return node.tagName == ""BUTTON"" 
			|| node.tagName==""INPUT"" && node.getAttribute(""type"").toUpperCase() == ""BUTTON""; // boolean
	}
	
	dojo._usesBorderBox = function(/*DomNode*/node){
		//	summary: 
		//		True if the node uses border-box layout.

		// We could test the computed style of node to see if a particular box
		// has been specified, but there are details and we choose not to bother.
		
		// TABLE and BUTTON (and INPUT type=button) are always border-box by default.
		// If you have assigned a different box to either one via CSS then
		// box functions will break.
		
		var n = node.tagName;
		return d.boxModel==""border-box"" || n==""TABLE"" || dojo._isButtonTag(node); // boolean
	}

	dojo._setContentSize = function(/*DomNode*/node, /*Number*/widthPx, /*Number*/heightPx, /*Object*/computedStyle){
		//	summary:
		//		Sets the size of the node's contents, irrespective of margins,
		//		padding, or borders.
		if(d._usesBorderBox(node)){
			var pb = d._getPadBorderExtents(node, computedStyle);
			if(widthPx >= 0){ widthPx += pb.w; }
			if(heightPx >= 0){ heightPx += pb.h; }
		}
		d._setBox(node, NaN, NaN, widthPx, heightPx);
	}

	dojo._setMarginBox = function(/*DomNode*/node, 	/*Number?*/leftPx, /*Number?*/topPx, 
													/*Number?*/widthPx, /*Number?*/heightPx, 
													/*Object*/computedStyle){
		//	summary:
		//		sets the size of the node's margin box and placement
		//		(left/top), irrespective of box model. Think of it as a
		//		passthrough to dojo._setBox that handles box-model vagaries for
		//		you.

		var s = computedStyle||gcs(node);
		// Some elements have special padding, margin, and box-model settings. 
		// To use box functions you may need to set padding, margin explicitly.
		// Controlling box-model is harder, in a pinch you might set dojo.boxModel.
		var bb=d._usesBorderBox(node),
				pb=bb ? _nilExtents : d._getPadBorderExtents(node, s);
		if (dojo.isSafari) {
			// on Safari (3.1.2), button nodes with no explicit size have a default margin
			// setting an explicit size eliminates the margin.
			// We have to swizzle the width to get correct margin reading.
			if (dojo._isButtonTag(node)){
				var ns = node.style;
				if (widthPx>=0 && !ns.width) { ns.width = ""4px""; }
				if (heightPx>=0 && !ns.height) { ns.height = ""4px""; }
			}
		}
		var mb=d._getMarginExtents(node, s);
		if(widthPx>=0){ widthPx = Math.max(widthPx - pb.w - mb.w, 0); }
		if(heightPx>=0){ heightPx = Math.max(heightPx - pb.h - mb.h, 0); }
		d._setBox(node, leftPx, topPx, widthPx, heightPx);
	}
	
	var _nilExtents = { l:0, t:0, w:0, h:0 };

	// public API
	
	dojo.marginBox = function(/*DomNode|String*/node, /*Object?*/box){
		//	summary:
		//		Getter/setter for the margin-box of node.
		//	description: 
		//		Returns an object in the expected format of box (regardless
		//		if box is passed). The object might look like:
		//			`{ l: 50, t: 200, w: 300: h: 150 }`
		//		for a node offset from its parent 50px to the left, 200px from
		//		the top with a margin width of 300px and a margin-height of
		//		150px.
		//	node:
		//		id or reference to DOM Node to get/set box for
		//	box:
		//		If passed, denotes that dojo.marginBox() should
		//		update/set the margin box for node. Box is an object in the
		//		above format. All properties are optional if passed.
		var n=d.byId(node), s=gcs(n), b=box;
		return !b ? d._getMarginBox(n, s) : d._setMarginBox(n, b.l, b.t, b.w, b.h, s); // Object
	}

	dojo.contentBox = function(/*DomNode|String*/node, /*Object?*/box){
		//	summary:
		//		Getter/setter for the content-box of node.
		//	description:
		//		Returns an object in the expected format of box (regardless if box is passed).
		//		The object might look like:
		//			`{ l: 50, t: 200, w: 300: h: 150 }`
		//		for a node offset from its parent 50px to the left, 200px from
		//		the top with a content width of 300px and a content-height of
		//		150px. Note that the content box may have a much larger border
		//		or margin box, depending on the box model currently in use and
		//		CSS values set/inherited for node.
		//	node:
		//		id or reference to DOM Node to get/set box for
		//	box:
		//		If passed, denotes that dojo.contentBox() should
		//		update/set the content box for node. Box is an object in the
		//		above format. All properties are optional if passed.
		var n=d.byId(node), s=gcs(n), b=box;
		return !b ? d._getContentBox(n, s) : d._setContentSize(n, b.w, b.h, s); // Object
	}
	
	// =============================
	// Positioning 
	// =============================
	
	var _sumAncestorProperties = function(node, prop){
		if(!(node = (node||0).parentNode)){return 0};
		var val, retVal = 0, _b = d.body();
		while(node && node.style){
			if(gcs(node).position == ""fixed""){
				return 0;
			}
			val = node[prop];
			if(val){
				retVal += val - 0;
				// opera and khtml #body & #html has the same values, we only
				// need one value
				if(node == _b){ break; }
			}
			node = node.parentNode;
		}
		return retVal;	//	integer
	}

	dojo._docScroll = function(){
		var 
			_b = d.body(),
			_w = d.global,
			de = d.doc.documentElement;
		return {
			y: (_w.pageYOffset || de.scrollTop || _b.scrollTop || 0),
			x: (_w.pageXOffset || d._fixIeBiDiScrollLeft(de.scrollLeft) || _b.scrollLeft || 0)
		};
	};
	
	dojo._isBodyLtr = function(){
		//FIXME: could check html and body tags directly instead of computed style?  need to ignore case, accept empty values
		return !(""_bodyLtr"" in d) ? 
			d._bodyLtr = gcs(d.body()).direction == ""ltr"" :
			d._bodyLtr; // Boolean 
	}
	
	dojo._getIeDocumentElementOffset = function(){
		// summary
		// The following values in IE contain an offset:
		//     event.clientX 
		//     event.clientY 
		//     node.getBoundingClientRect().left
		//     node.getBoundingClientRect().top
		// But other position related values do not contain this offset, such as
		// node.offsetLeft, node.offsetTop, node.style.left and node.style.top.
		// The offset is always (2, 2) in LTR direction. When the body is in RTL
		// direction, the offset counts the width of left scroll bar's width.
		// This function computes the actual offset.

		//NOTE: assumes we're being called in an IE browser

		var de = d.doc.documentElement;
		//FIXME: use this instead?			var de = d.compatMode == ""BackCompat"" ? d.body : d.documentElement;

		return (d.isIE >= 7) ?
			{x: de.getBoundingClientRect().left, y: de.getBoundingClientRect().top}
		:
			// IE 6.0
			{x: d._isBodyLtr() || window.parent == window ?
				de.clientLeft : de.offsetWidth - de.clientWidth - de.clientLeft, 
				y: de.clientTop}; // Object
	};
	
	dojo._fixIeBiDiScrollLeft = function(/*Integer*/ scrollLeft){
		// In RTL direction, scrollLeft should be a negative value, but IE 
		// returns a positive one. All codes using documentElement.scrollLeft
		// must call this function to fix this error, otherwise the position
		// will offset to right when there is a horizontal scrollbar.
		var dd = d.doc;
		if(d.isIE && !dojo._isBodyLtr()){
			var de = dd.compatMode == ""BackCompat"" ? dd.body : dd.documentElement;
			return scrollLeft + de.clientWidth - de.scrollWidth; // Integer
		}
		return scrollLeft; // Integer
	}

	dojo._abs = function(/*DomNode*/node, /*Boolean?*/includeScroll){
		//	summary:
		//		Gets the position of the passed element relative to
		//		the viewport (if includeScroll==false), or relative to the
		//		document root (if includeScroll==true).
		//
		//		Returns an object of the form:
		//			{ x: 100, y: 300 }
		//		if includeScroll is passed, the x and y values will include any
		//		document offsets that may affect the position relative to the
		//		viewport.

		// FIXME: need to decide in the brave-new-world if we're going to be
		// margin-box or border-box.
		var ownerDocument = node.ownerDocument;
		var ret = {
			x: 0,
			y: 0
		};

		// targetBoxType == ""border-box""
		var db = d.body();
		if(d.isIE || (d.isFF >= 3)){
			var client = node.getBoundingClientRect();
			var cs;
			if(d.isFF){
				// in FF3 you have to subract the document element margins
				var dv = node.ownerDocument.defaultView;
				cs=dv.getComputedStyle(db.parentNode, null);
			}
			var offset = (d.isIE) ? d._getIeDocumentElementOffset() : { x: px(db.parentNode,cs.marginLeft), y: px(db.parentNode,cs.marginTop)};
			ret.x = client.left - offset.x;
			ret.y = client.top - offset.y;
		}else{
			if(node[""offsetParent""]){
				var endNode;
				// in Safari, if the node is an absolutely positioned child of
				// the body and the body has a margin the offset of the child
				// and the body contain the body's margins, so we need to end
				// at the body
				// FIXME: getting contrary results to the above in latest WebKit.
				if(d.isSafari &&
					//(node.style.getPropertyValue(""position"") == ""absolute"") &&
					(gcs(node).position == ""absolute"") &&
					(node.parentNode == db)){
					endNode = db;
				}else{
					endNode = db.parentNode;
				}
				// Opera seems to be double counting for some elements
				var cs=gcs(node);
				var n=node;
				if(d.isOpera&&cs.position!=""absolute""){
					n=n.offsetParent;
				}
				ret.x -= _sumAncestorProperties(n, ""scrollLeft"");
				ret.y -= _sumAncestorProperties(n, ""scrollTop"");

				var curnode = node;
				do{
					var n = curnode.offsetLeft;
					//FIXME: ugly hack to workaround the submenu in 
					//popupmenu2 does not shown up correctly in opera. 
					//Someone have a better workaround?
					if(!d.isOpera || n > 0){
						ret.x += isNaN(n) ? 0 : n;
					}
					var t = curnode.offsetTop;
					ret.y += isNaN(t) ? 0 : t;
					var cs = gcs(curnode);
					if(curnode != node){
						if(d.isSafari){
							ret.x += px(curnode, cs.borderLeftWidth);
							ret.y += px(curnode, cs.borderTopWidth);
						}else if(d.isFF){
							// tried left+right with differently sized left/right borders
							// it really is 2xleft border in FF, not left+right, even in RTL!
							ret.x += 2*px(curnode,cs.borderLeftWidth);
							ret.y += 2*px(curnode,cs.borderTopWidth);
						}
					}
					// static children in a static div in FF2 are affected by the div's border as well
					// but offsetParent will skip this div!
					if(d.isFF&&cs.position==""static""){
						var parent=curnode.parentNode;
						while(parent!=curnode.offsetParent){
							var pcs=gcs(parent);
							if(pcs.position==""static""){
								ret.x += px(curnode,pcs.borderLeftWidth);
								ret.y += px(curnode,pcs.borderTopWidth);
							}
							parent=parent.parentNode;
						}
					}
					curnode = curnode.offsetParent;
				}while((curnode != endNode) && curnode);
			}else if(node.x && node.y){
				ret.x += isNaN(node.x) ? 0 : node.x;
				ret.y += isNaN(node.y) ? 0 : node.y;
			}
		}
		// account for document scrolling
		// if offsetParent is used, ret value already includes scroll position
		// so we may have to actually remove that value if !includeScroll
		if(includeScroll){
			var scroll = d._docScroll();
			ret.y += scroll.y;
			ret.x += scroll.x;
		}

		return ret; // object
	}

	// FIXME: need a setter for coords or a moveTo!!
	dojo.coords = function(/*DomNode|String*/node, /*Boolean?*/includeScroll){
		//	summary:
		//		Returns an object that measures margin box width/height and
		//		absolute positioning data from dojo._abs().
		//
		//	description:
		//		Returns an object that measures margin box width/height and
		//		absolute positioning data from dojo._abs().
		//		Return value will be in the form:
		//			`{ l: 50, t: 200, w: 300: h: 150, x: 100, y: 300 }`
		//		Does not act as a setter. If includeScroll is passed, the x and
		//		y params are affected as one would expect in dojo._abs().
		var n=d.byId(node), s=gcs(n), mb=d._getMarginBox(n, s);
		var abs = d._abs(n, includeScroll);
		mb.x = abs.x;
		mb.y = abs.y;
		return mb;
	}

	// =============================
	// Element attribute Functions
	// =============================

	var ieLT8 = d.isIE < 8;

	var _fixAttrName = function(/*String*/name){
		switch(name.toLowerCase()){
			case ""tabindex"":
				// Internet Explorer will only set or remove tabindex
				// if it is spelled ""tabIndex""
				// 
				return ieLT8 ? ""tabIndex"" : ""tabindex"";
			case ""for"": case ""htmlfor"":
				// to pick up for attrib set in markup via getAttribute() IE<8 uses ""htmlFor"" and others use ""for""
				// get/setAttribute works in all as long use same value for both get/set
				return ieLT8 ? ""htmlFor"" : ""for"";
			case ""class"" :
				return d.isIE ? ""className"" : ""class"";
			default:
				return name;
		}
	}

	// non-deprecated HTML4 attributes with default values
	// http://www.w3.org/TR/html401/index/attributes.html
	// FF and Safari will return the default values if you
	// access the attributes via a property but not
	// via getAttribute()
	var _attrProps = {
		colspan: ""colSpan"",
		enctype: ""enctype"",
		frameborder: ""frameborder"",
		method: ""method"",
		rowspan: ""rowSpan"",
		scrolling: ""scrolling"",
		shape: ""shape"",
		span: ""span"",
		type: ""type"",
		valuetype: ""valueType""
	}

	dojo.hasAttr = function(/*DomNode|String*/node, /*String*/name){
		//	summary:
		//		Returns true if the requested attribute is specified on the
		//		given element, and false otherwise.
		//	node:
		//		id or reference to the element to check
		//	name:
		//		the name of the attribute
		//	returns:
		//		true if the requested attribute is specified on the
		//		given element, and false otherwise
		node = d.byId(node);
		var fixName = _fixAttrName(name);
		fixName = fixName == ""htmlFor"" ? ""for"" : fixName; //IE<8 uses htmlFor except in this case
		var attr = node.getAttributeNode && node.getAttributeNode(fixName);
		return attr ? attr.specified : false; // Boolean
	}

	var _evtHdlrMap = {
		
	}

	var _ctr = 0;
	var _attrId = dojo._scopeName + ""attrid"";

	dojo.attr = function(/*DomNode|String*/node, /*String|Object*/name, /*String?*/value){
		//	summary:
		//		Gets or sets an attribute on an HTML element.
		//	description:
		//		Handles normalized getting and setting of attributes on DOM
		//		Nodes. If 2 arguments are passed, and a the second argumnt is a
		//		string, acts as a getter.
		//	
		//		If a third argument is passed, or if the second argumnt is a
		//		map of attributes, acts as a setter.
		//
		//		When passing functions as values, note that they will not be
		//		directly assigned to slots on the node, but rather the default
		//		behavior will be removed and the new behavior will be added
		//		using `dojo.connect()`, meaning that event handler properties
		//		will be normalized and that some caveats with regards to
		//		non-standard behaviors for onsubmit apply. Namely that you
		//		should cancel form submission using `dojo.stopEvent()` on the
		//		passed event object instead of returning a boolean value from
		//		the handler itself.
		//	node:
		//		id or reference to the element to get or set the attribute on
		//	name:
		//		the name of the attribute to get or set.
		//	value:
		//		The value to set for the attribute
		//	returns:
		//		when used as a getter, the value of the requested attribute
		//		or null if that attribute does not have a specified or
		//		default value;
		//
		//		when user as a setter, undefined
		//
		//	example:
		//	|	// get the current value of the ""foo"" attribute on a node
		//	|	dojo.attr(dojo.byId(""nodeId""), ""foo"");
		//	|	// or we can just pass the id:
		//	|	dojo.attr(""nodeId"", ""foo"");
		//
		//	example:
		//	|	// use attr() to set the tab index
		//	|	dojo.attr(""nodeId"", ""tabindex"", 3);
		//	|
		//
		//	example:
		//	|	// set multiple values at once, including event handlers:
		//	|	dojo.attr(""formId"", {
		//	|		""foo"": ""bar"",
		//	|		""tabindex"": -1,
		//	|		""method"": ""POST"",
		//	|		""onsubmit"": function(e){
		//	|			// stop submitting the form. Note that the IE behavior
		//	|			// of returning true or false will have no effect here
		//	|			// since our handler is connect()ed to the built-in
		//	|			// onsubmit behavior and so we need to use
		//	|			// dojo.stopEvent() to ensure that the submission
		//	|			// doesn't proceed.
		//	|			dojo.stopEvent(e);
		//	|
		//	|			// submit the form with Ajax
		//	|			dojo.xhrPost({ form: ""formId"" });
		//	|		}
		//	|	});

		var args = arguments.length;
		if(args == 2 && !d.isString(name)){
			for(var x in name){ d.attr(node, x, name[x]); }
			return;
		}
		node = d.byId(node);
		name = _fixAttrName(name);
		if(args == 3){
			// FIXME:
			//		what about when the name is ""style"" and value is an object?
			//		It seems natural to pass it in to dojo.style(node,
			//		value)...should we support this?
			if(d.isFunction(value)){
				// clobber if we can
				var attrId = d.attr(node, _attrId);
				if(!attrId){
					attrId = _ctr++;
					d.attr(node, _attrId, attrId);
				}
				if(!_evtHdlrMap[attrId]){
					_evtHdlrMap[attrId] = {};
				}
				var h = _evtHdlrMap[attrId][name];
				if(h){
					d.disconnect(h);
				}else{
					try{
						delete node[name];
					}catch(e){}
				}

				// ensure that event objects are normalized, etc.
				_evtHdlrMap[attrId][name] = d.connect(node, name, value);

			}else if(
				(typeof value == ""boolean"")|| // e.g. onsubmit, disabled
				(name == ""innerHTML"")
			){
				node[name] = value;
			}else if((name == ""style"")&&(!d.isString(value))){
				d.style(node, value);
			}else{
				node.setAttribute(name, value);
			}
			return;
		}else{
			// should we access this attribute via a property or
			// via getAttribute()?
			var prop = _attrProps[name.toLowerCase()];
			if(prop){
				return node[prop];
			}else{
				var attrValue = node[name];
				return (typeof attrValue == 'boolean' || typeof attrValue == 'function') ? attrValue
					: (d.hasAttr(node, name) ? node.getAttribute(name) : null);
			}
		}
	}

	dojo.removeAttr = function(/*DomNode|String*/node, /*String*/name){
		//	summary:
		//		Removes an attribute from an HTML element.
		//	node:
		//		id or reference to the element to remove the attribute from
		//	name:
		//		the name of the attribute to remove
		d.byId(node).removeAttribute(_fixAttrName(name));
	}

	/*
	dojo.createElement = function(type, attrs, parent, position){
		// TODO: need to finish this!
	}
	*/

	// =============================
	// (CSS) Class Functions
	// =============================
	var _className = ""className"";

	dojo.hasClass = function(/*DomNode|String*/node, /*String*/classStr){
		//	summary:
		//		Returns whether or not the specified classes are a portion of the
		//		class list currently applied to the node. 
		return (("" ""+ d.byId(node)[_className] +"" "").indexOf("" ""+ classStr +"" "") >= 0);  // Boolean
	};

	dojo.addClass = function(/*DomNode|String*/node, /*String*/classStr){
		//	summary:
		//		Adds the specified classes to the end of the class list on the
		//		passed node.
		node = d.byId(node);
		var cls = node[_className];
		if(("" ""+ cls +"" "").indexOf("" "" + classStr + "" "") < 0){
			node[_className] = cls + (cls ? ' ' : '') + classStr;
		}
	};

	dojo.removeClass = function(/*DomNode|String*/node, /*String*/classStr){
		// summary: Removes the specified classes from node.
		node = d.byId(node);
		var t = d.trim(("" "" + node[_className] + "" "").replace("" "" + classStr + "" "", "" ""));
		if(node[_className] != t){ node[_className] = t; }
	};

	dojo.toggleClass = function(/*DomNode|String*/node, /*String*/classStr, /*Boolean?*/condition){
		//	summary: 	
		//		Adds a class to node if not present, or removes if present.
		//		Pass a boolean condition if you want to explicitly add or remove.
		//	condition:
		//		If passed, true means to add the class, false means to remove.
		if(condition === undefined){
			condition = !d.hasClass(node, classStr);
		}
		d[condition ? ""addClass"" : ""removeClass""](node, classStr);
	};

})();

}

if(!dojo._hasResource[""dojo._base.NodeList""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.NodeList""] = true;
dojo.provide(""dojo._base.NodeList"");



(function(){

	var d = dojo;

	var tnl = function(arr){
		// decorate an array to make it look like a NodeList
		arr.constructor = dojo.NodeList;
		dojo._mixin(arr, dojo.NodeList.prototype);
		return arr;
	}

	var _mapIntoDojo = function(func, alwaysThis){
		// returns a function which, when executed in the scope of its caller,
		// applies the passed arguments to a particular dojo.* function (named
		// in func) and aggregates the returns. if alwaysThis is true, it
		// always returns the scope object and not the collected returns from
		// the Dojo method
		return function(){
			var _a = arguments;
			var aa = d._toArray(_a, 0, [null]);
			var s = this.map(function(i){
				aa[0] = i;
				return d[func].apply(d, aa);
			});
			return (alwaysThis || ( (_a.length > 1) || !d.isString(_a[0]) )) ? this : s; // String||dojo.NodeList
		}
	};

	dojo.NodeList = function(){
		//	summary:
		//		dojo.NodeList is as subclass of Array which adds syntactic 
		//		sugar for chaining, common iteration operations, animation, 
		//		and node manipulation. NodeLists are most often returned as
		//		the result of dojo.query() calls.
		//	example:
		//		create a node list from a node
		//		|	new dojo.NodeList(dojo.byId(""foo""));

		return tnl(Array.apply(null, arguments));
	}

	dojo.NodeList._wrap = tnl;

	dojo.extend(dojo.NodeList, {
		// http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array#Methods

		// FIXME: handle return values for #3244
		//		http://trac.dojotoolkit.org/ticket/3244
		
		// FIXME:
		//		need to wrap or implement:
		//			join (perhaps w/ innerHTML/outerHTML overload for toString() of items?)
		//			reduce
		//			reduceRight

		slice: function(/*===== begin, end =====*/){
			// summary:
			//		Returns a new NodeList, maintaining this one in place
			// description:
			//		This method behaves exactly like the Array.slice method
			//		with the caveat that it returns a dojo.NodeList and not a
			//		raw Array. For more details, see:
			//			http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:slice
			// begin: Integer
			//		Can be a positive or negative integer, with positive
			//		integers noting the offset to begin at, and negative
			//		integers denoting an offset from the end (i.e., to the left
			//		of the end)
			// end: Integer?
			//		Optional parameter to describe what position relative to
			//		the NodeList's zero index to end the slice at. Like begin,
			//		can be positive or negative.
			var a = d._toArray(arguments);
			return tnl(a.slice.apply(this, a));
		},

		splice: function(/*===== index, howmany, item =====*/){
			// summary:
			//		Returns a new NodeList, manipulating this NodeList based on
			//		the arguments passed, potentially splicing in new elements
			//		at an offset, optionally deleting elements
			// description:
			//		This method behaves exactly like the Array.splice method
			//		with the caveat that it returns a dojo.NodeList and not a
			//		raw Array. For more details, see:
			//			<http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:splice>
			// index: Integer
			//		begin can be a positive or negative integer, with positive
			//		integers noting the offset to begin at, and negative
			//		integers denoting an offset from the end (i.e., to the left
			//		of the end)
			// howmany: Integer?
			//		Optional parameter to describe what position relative to
			//		the NodeList's zero index to end the slice at. Like begin,
			//		can be positive or negative.
			// item: Object...?
			//		Any number of optional parameters may be passed in to be
			//		spliced into the NodeList
			// returns:
			//		dojo.NodeList
			var a = d._toArray(arguments);
			return tnl(a.splice.apply(this, a));
		},

		concat: function(/*===== item =====*/){
			// summary:
			//		Returns a new NodeList comprised of items in this NodeList
			//		as well as items passed in as parameters
			// description:
			//		This method behaves exactly like the Array.concat method
			//		with the caveat that it returns a dojo.NodeList and not a
			//		raw Array. For more details, see:
			//			<http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:concat>
			// item: Object...?
			//		Any number of optional parameters may be passed in to be
			//		spliced into the NodeList
			// returns:
			//		dojo.NodeList
			var a = d._toArray(arguments, 0, [this]);
			return tnl(a.concat.apply([], a));
		},
		
		indexOf: function(/*Object*/ value, /*Integer?*/ fromIndex){
			//	summary:
			//		see dojo.indexOf(). The primary difference is that the acted-on 
			//		array is implicitly this NodeList
			// value:
			//		The value to search for.
			// fromIndex:
			//		The loction to start searching from. Optional. Defaults to 0.
			//	description:
			//		For more details on the behavior of indexOf, see:
			//			<http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:indexOf>
			//	returns:
			//		Positive Integer or 0 for a match, -1 of not found.
			return d.indexOf(this, value, fromIndex); // Integer
		},

		lastIndexOf: function(/*===== value, fromIndex =====*/){
			// summary:
			//		see dojo.lastIndexOf(). The primary difference is that the
			//		acted-on array is implicitly this NodeList
			//	description:
			//		For more details on the behavior of lastIndexOf, see:
			//			<http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:lastIndexOf>
			// value: Object
			//		The value to search for.
			// fromIndex: Integer?
			//		The loction to start searching from. Optional. Defaults to 0.
			// returns:
			//		Positive Integer or 0 for a match, -1 of not found.
			return d.lastIndexOf.apply(d, d._toArray(arguments, 0, [this])); // Integer
		},

		every: function(/*Function*/callback, /*Object?*/thisObject){
			//	summary:
			//		see `dojo.every()` and:
			//			<http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:every>
			//		Takes the same structure of arguments and returns as
			//		dojo.every() with the caveat that the passed array is
			//		implicitly this NodeList
			return d.every(this, callback, thisObject); // Boolean
		},

		some: function(/*Function*/callback, /*Object?*/thisObject){
			//	summary:
			//		see dojo.some() and:
			//			http://developer.mozilla.org/en/docs/Core_JavaScript_1.5_Reference:Global_Objects:Array:some
			//		Takes the same structure of arguments and returns as
			//		dojo.some() with the caveat that the passed array is
			//		implicitly this NodeList
			return d.some(this, callback, thisObject); // Boolean
		},

		map: function(/*Function*/ func, /*Function?*/ obj){
			//	summary:
			//		see dojo.map(). The primary difference is that the acted-on
			//		array is implicitly this NodeList and the return is a
			//		dojo.NodeList (a subclass of Array)

			return d.map(this, func, obj, d.NodeList); // dojo.NodeList
		},

		forEach: function(callback, thisObj){
			//	summary:
			//		see dojo.forEach(). The primary difference is that the acted-on 
			//		array is implicitly this NodeList

			d.forEach(this, callback, thisObj);
			// non-standard return to allow easier chaining
			return this; // dojo.NodeList 
		},

		// custom methods
		
		coords: function(){
			//	summary:
			// 		Returns the box objects all elements in a node list as
			// 		an Array (*not* a NodeList)
			
			return d.map(this, d.coords); // Array
		},

		/*=====
		attr: function(property, value){
			//	summary:
			//		gets or sets the DOM attribute for every element in the
			//		NodeList
			//	property: String
			//		the attribute to get/set
			//	value: String?
			//		optional. The value to set the property to
			//	returns:
			//		if no value is passed, the result is an array of attribute values
			//		If a value is passed, the return is this NodeList
			return; // dojo.NodeList
			return; // Array
		},

		style: function(property, value){
			//	summary:
			//		gets or sets the CSS property for every element in the NodeList
			//	property: String
			//		the CSS property to get/set, in JavaScript notation
			//		(""lineHieght"" instead of ""line-height"") 
			//	value: String?
			//		optional. The value to set the property to
			//	returns:
			//		if no value is passed, the result is an array of strings.
			//		If a value is passed, the return is this NodeList
			return; // dojo.NodeList
			return; // Array
		},

		addClass: function(className){
			//	summary:
			//		adds the specified class to every node in the list
			//	className: String
			//		the CSS class to add
			return; // dojo.NodeList
		},

		removeClass: function(className){
			//	summary:
			//		removes the specified class from every node in the list
			//	className: String
			//		the CSS class to add
			//	returns:
			//		dojo.NodeList, this list
			return; // dojo.NodeList
		},

		toggleClass: function(className, condition){
			//	summary:
			//		Adds a class to node if not present, or removes if present.
			//		Pass a boolean condition if you want to explicitly add or remove.
			//	condition: Boolean?
			//		If passed, true means to add the class, false means to remove.
			//	className: String
			//		the CSS class to add
			return; // dojo.NodeList
		},

		connect: function(methodName, objOrFunc, funcName){
			//	summary:
			//		attach event handlers to every item of the NodeList. Uses dojo.connect()
			//		so event properties are normalized
			//	methodName: String
			//		the name of the method to attach to. For DOM events, this should be
			//		the lower-case name of the event
			//	objOrFunc: Object|Function|String
			//		if 2 arguments are passed (methodName, objOrFunc), objOrFunc should
			//		reference a function or be the name of the function in the global
			//		namespace to attach. If 3 arguments are provided
			//		(methodName, objOrFunc, funcName), objOrFunc must be the scope to 
			//		locate the bound function in
			//	funcName: String?
			//		optional. A string naming the function in objOrFunc to bind to the
			//		event. May also be a function reference.
			//	example:
			//		add an onclick handler to every button on the page
			//		|	dojo.query(""div:nth-child(odd)"").connect(""onclick"", function(e){
			//		|		
			//		|	});
			// example:
			//		attach foo.bar() to every odd div's onmouseover
			//		|	dojo.query(""div:nth-child(odd)"").connect(""onmouseover"", foo, ""bar"");
		},
		=====*/
		attr: _mapIntoDojo(""attr""),
		style: _mapIntoDojo(""style""),
		addClass: _mapIntoDojo(""addClass"", true),
		removeClass: _mapIntoDojo(""removeClass"", true),
		toggleClass: _mapIntoDojo(""toggleClass"", true),
		connect: _mapIntoDojo(""connect"", true),

		// FIXME: connectPublisher()? connectRunOnce()?

		place: function(/*String||Node*/ queryOrNode, /*String*/ position){
			//	summary:
			//		places elements of this node list relative to the first element matched
			//		by queryOrNode. Returns the original NodeList.
			//	queryOrNode:
			//		may be a string representing any valid CSS3 selector or a DOM node.
			//		In the selector case, only the first matching element will be used 
			//		for relative positioning.
			//	position:
			//		can be one of:
			//			* ""last""||""end"" (default)
			//			* ""first||""start""
			//			* ""before""
			//			* ""after""
			// 		or an offset in the childNodes property
			var item = d.query(queryOrNode)[0];
			return this.forEach(function(i){ d.place(i, item, position); }); // dojo.NodeList
		},

		orphan: function(/*String?*/ simpleFilter){
			//	summary:
			//		removes elements in this list that match the simple
			//		filter from their parents and returns them as a new
			//		NodeList.
			//	simpleFilter:
			//		single-expression CSS filter
			//	returns:
			//		`dojo.NodeList` containing the orpahned elements 
			return (simpleFilter ? d._filterQueryResult(this, simpleFilter) : this). // dojo.NodeList
				forEach(""if(item.parentNode){ item.parentNode.removeChild(item); }""); 
		},

		adopt: function(/*String||Array||DomNode*/ queryOrListOrNode, /*String?*/ position){
			//	summary:
			//		places any/all elements in queryOrListOrNode at a
			//		position relative to the first element in this list.
			//		Returns a dojo.NodeList of the adopted elements.
			//	queryOrListOrNode:
			//		a DOM node or a query string or a query result.
			//		Represents the nodes to be adopted relative to the
			//		first element of this NodeList.
			//	position:
			//		can be one of:
			//			* ""last""||""end"" (default)
			//			* ""first||""start""
			//			* ""before""
			//			* ""after""
			// 		or an offset in the childNodes property
			var item = this[0];
			return d.query(queryOrListOrNode).forEach(function(ai){ // dojo.NodeList
				d.place(ai, item, position || ""last""); 
			});
		},

		// FIXME: do we need this?
		query: function(/*String*/ queryStr){
			//	summary:
			//		Returns a new, flattened NodeList. Elements of the new list
			//		satisfy the passed query but use elements of the
			//		current NodeList as query roots.

			if(!queryStr){ return this; }

			// FIXME: probably slow
			// FIXME: use map?
			var ret = d.NodeList();
			this.forEach(function(item){
				// FIXME: why would we ever get undefined here?
				ret = ret.concat(d.query(queryStr, item).filter(function(subItem){ return (subItem !== undefined); }));
			});
			return ret; // dojo.NodeList
		},

		filter: function(/*String*/ simpleQuery){
			//	summary:
			// 		""masks"" the built-in javascript filter() method to support
			//		passing a simple string filter in addition to supporting
			//		filtering function objects.
			//	example:
			//		""regular"" JS filter syntax as exposed in dojo.filter:
			//		|	dojo.query(""*"").filter(function(item){
			//		|		// highlight every paragraph
			//		|		return (item.nodeName == ""p"");
			//		|	}).styles(""backgroundColor"", ""yellow"");
			// example:
			//		the same filtering using a CSS selector
			//		|	dojo.query(""*"").filter(""p"").styles(""backgroundColor"", ""yellow"");

			var items = this;
			var _a = arguments;
			var r = d.NodeList();
			var rp = function(t){ 
				if(t !== undefined){
					r.push(t); 
				}
			}
			if(d.isString(simpleQuery)){
				items = d._filterQueryResult(this, _a[0]);
				if(_a.length == 1){
					// if we only got a string query, pass back the filtered results
					return items; // dojo.NodeList
				}
				// if we got a callback, run it over the filtered items
				_a.shift();
			}
			// handle the (callback, [thisObject]) case
			d.forEach(d.filter(items, _a[0], _a[1]), rp);
			return r; // dojo.NodeList
		},
		
		/*
		// FIXME: should this be ""copyTo"" and include parenting info?
		clone: function(){
			// summary:
			//		creates node clones of each element of this list
			//		and returns a new list containing the clones
		},
		*/

		addContent: function(/*String*/ content, /*String||Integer?*/ position){
			//	summary:
			//		add a node or some HTML as a string to every item in the list. 
			//		Returns the original list.
			//	description:
			//		a copy of the HTML content is added to each item in the
			//		list, with an optional position argument. If no position
			//		argument is provided, the content is appended to the end of
			//		each item.
			//	content:
			//		the HTML in string format to add at position to every item
			//	position:
			//		can be one of:
			//			* ""last""||""end"" (default)
			//			* ""first||""start""
			//			* ""before""
			//			* ""after""
			// 		or an offset in the childNodes property
			//	example:
			//		appends content to the end if the position is ommitted
			//	|	dojo.query(""h3 > p"").addContent(""hey there!"");
			//	example:
			//		add something to the front of each element that has a ""thinger"" property:
			//	|	dojo.query(""[thinger]"").addContent(""..."", ""first"");
			//	example:
			//		adds a header before each element of the list
			//	|	dojo.query("".note"").addContent(""<h4>NOTE:</h4>"", ""before"");
			var ta = d.doc.createElement(""span"");
			if(d.isString(content)){
				ta.innerHTML = content;
			}else{
				ta.appendChild(content);
			}
			if(position === undefined){
				position = ""last"";
			}
			var ct = (position == ""first"" || position == ""after"") ? ""lastChild"" : ""firstChild"";
			this.forEach(function(item){
				var tn = ta.cloneNode(true);
				while(tn[ct]){
					d.place(tn[ct], item, position);
				}
			});
			return this; // dojo.NodeList
		},

		empty: function(){
			//	summary:
			//		clears all content from each node in the list
			return this.forEach(""item.innerHTML='';""); // dojo.NodeList

			// FIXME: should we be checking for and/or disposing of widgets below these nodes?
		},
		
		instantiate: function(/*String|Object*/ declaredClass, /*Object?*/ properties){
			//	summary:
			//		Create a new instance of a specified class, using the
			//		specified properties and each node in the nodeList as a
			//		srcNodeRef
			//
			var c = d.isFunction(declaredClass) ? declaredClass : d.getObject(declaredClass);
			return this.forEach(function(i){
				new c(properties||{},i);
			}) // dojo.NodeList
		},

		at: function(/*===== index =====*/){
			//	summary:
			//		Returns a new NodeList comprised of items in this NodeList
			//		at the given index or indices.
			//	index: Integer...
			//		One or more 0-based indices of items in the current NodeList.
			//	returns:
			//		dojo.NodeList
			var nl = new dojo.NodeList();
			dojo.forEach(arguments, function(i) { if(this[i]) { nl.push(this[i]); } }, this);
			return nl; // dojo.NodeList
		}

	});

	// syntactic sugar for DOM events
	d.forEach([
		""blur"", ""focus"", ""click"", ""keydown"", ""keypress"", ""keyup"", ""mousedown"",
		""mouseenter"", ""mouseleave"", ""mousemove"", ""mouseout"", ""mouseover"",
		""mouseup"", ""submit"", ""load"", ""error""
		], function(evt){
			var _oe = ""on""+evt;
			d.NodeList.prototype[_oe] = function(a, b){
				return this.connect(_oe, a, b);
			}
				// FIXME: should these events trigger publishes?
				/*
				return (a ? this.connect(_oe, a, b) : 
							this.forEach(function(n){  
								// FIXME:
								//		listeners get buried by
								//		addEventListener and can't be dug back
								//		out to be triggered externally.
								// see:
								//		http://developer.mozilla.org/en/docs/DOM:element

								

								// FIXME: need synthetic event support!
								var _e = { target: n, faux: true, type: evt };
								// dojo._event_listener._synthesizeEvent({}, { target: n, faux: true, type: evt });
								try{ n[evt](_e); }catch(e){  }
								try{ n[_oe](_e); }catch(e){  }
							})
				);
			}
			*/
		}
	);

})();

}

if(!dojo._hasResource[""dojo._base.query""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.query""] = true;
dojo.provide(""dojo._base.query"");


/*
	dojo.query() architectural overview:

		dojo.query is a relatively full-featured CSS3 query library. It is
		designed to take any valid CSS3 selector and return the nodes matching
		the selector. To do this quickly, it processes queries in several
		steps, applying caching where profitable.
		
		The steps (roughly in reverse order of the way they appear in the code):
			1.) check to see if we already have a ""query dispatcher""
				- if so, use that with the given parameterization. Skip to step 4.
			2.) attempt to determine which branch to dispatch the query to:
				- JS (optimized DOM iteration)
				- xpath (for browsers that support it and where it's fast)
				- native (not available in any browser yet)
			3.) tokenize and convert to executable ""query dispatcher""
				- this is where the lion's share of the complexity in the
				  system lies. In the DOM version, the query dispatcher is
				  assembled as a chain of ""yes/no"" test functions pertaining to
				  a section of a simple query statement ("".blah:nth-child(odd)""
				  but not ""div div"", which is 2 simple statements). Individual
				  statement dispatchers are cached (to prevent re-definition)
				  as are entire dispatch chains (to make re-execution of the
				  same query fast)
				- in the xpath path, tokenization yields a concatenation of
				  parameterized xpath selectors. As with the DOM version, both
				  simple selector blocks and overall evaluators are cached to
				  prevent re-defintion
			4.) the resulting query dispatcher is called in the passed scope (by default the top-level document)
				- for DOM queries, this results in a recursive, top-down
				  evaluation of nodes based on each simple query section
				- xpath queries can, thankfully, be executed in one shot
			5.) matched nodes are pruned to ensure they are unique
*/

;(function(){
	// define everything in a closure for compressability reasons. ""d"" is an
	// alias to ""dojo"" since it's so frequently used. This seems a
	// transformation that the build system could perform on a per-file basis.

	////////////////////////////////////////////////////////////////////////
	// Utility code
	////////////////////////////////////////////////////////////////////////

	var d = dojo;
	var childNodesName = dojo.isIE ? ""children"" : ""childNodes"";
	var caseSensitive = false;

	var getQueryParts = function(query){
		// summary: state machine for query tokenization
		if("">~+"".indexOf(query.charAt(query.length-1)) >= 0){
			query += "" *""
		}
		query += "" ""; // ensure that we terminate the state machine

		var ts = function(s, e){
			return d.trim(query.slice(s, e));
		}

		// the overall data graph of the full query, as represented by queryPart objects
		var qparts = []; 
		// state keeping vars
		var inBrackets = -1;
		var inParens = -1;
		var inMatchFor = -1;
		var inPseudo = -1;
		var inClass = -1;
		var inId = -1;
		var inTag = -1;
		var lc = """"; // the last character
		var cc = """"; // the current character
		var pStart;
		// iteration vars
		var x = 0; // index in the query
		var ql = query.length;
		var currentPart = null; // data structure representing the entire clause
		var _cp = null; // the current pseudo or attr matcher

		var endTag = function(){
			if(inTag >= 0){
				var tv = (inTag == x) ? null : ts(inTag, x); // .toLowerCase();
				currentPart[ ("">~+"".indexOf(tv) < 0) ? ""tag"" : ""oper"" ] = tv;
				inTag = -1;
			}
		}

		var endId = function(){
			if(inId >= 0){
				currentPart.id = ts(inId, x).replace(/\\/g, """");
				inId = -1;
			}
		}

		var endClass = function(){
			if(inClass >= 0){
				currentPart.classes.push(ts(inClass+1, x).replace(/\\/g, """"));
				inClass = -1;
			}
		}

		var endAll = function(){
			endId(); endTag(); endClass();
		}

		for(; lc=cc, cc=query.charAt(x),x<ql; x++){
			if(lc == ""\\""){ continue; }
			if(!currentPart){
				// NOTE: I hate all this alloc, but it's shorter than writing tons of if's
				pStart = x;
				currentPart = {
					query: null,
					pseudos: [],
					attrs: [],
					classes: [],
					tag: null,
					oper: null,
					id: null
				};
				inTag = x;
			}

			if(inBrackets >= 0){
				// look for a the close first
				if(cc == ""]""){
					if(!_cp.attr){
						_cp.attr = ts(inBrackets+1, x);
					}else{
						_cp.matchFor = ts((inMatchFor||inBrackets+1), x);
					}
					var cmf = _cp.matchFor;
					if(cmf){
						if(	(cmf.charAt(0) == '""') || (cmf.charAt(0)  == ""'"") ){
							_cp.matchFor = cmf.substring(1, cmf.length-1);
						}
					}
					currentPart.attrs.push(_cp);
					_cp = null; // necessaray?
					inBrackets = inMatchFor = -1;
				}else if(cc == ""=""){
					var addToCc = (""|~^$*"".indexOf(lc) >=0 ) ? lc : """";
					_cp.type = addToCc+cc;
					_cp.attr = ts(inBrackets+1, x-addToCc.length);
					inMatchFor = x+1;
				}
				// now look for other clause parts
			}else if(inParens >= 0){
				if(cc == "")""){
					if(inPseudo >= 0){
						_cp.value = ts(inParens+1, x);
					}
					inPseudo = inParens = -1;
				}
			}else if(cc == ""#""){
				endAll();
				inId = x+1;
			}else if(cc == "".""){
				endAll();
				inClass = x;
			}else if(cc == "":""){
				endAll();
				inPseudo = x;
			}else if(cc == ""[""){
				endAll();
				inBrackets = x;
				_cp = {
					/*=====
					attr: null, type: null, matchFor: null
					=====*/
				};
			}else if(cc == ""(""){
				if(inPseudo >= 0){
					_cp = { 
						name: ts(inPseudo+1, x), 
						value: null
					}
					currentPart.pseudos.push(_cp);
				}
				inParens = x;
			}else if(cc == "" "" && lc != cc){
				// note that we expect the string to be "" "" terminated
				endAll();
				if(inPseudo >= 0){
					currentPart.pseudos.push({ name: ts(inPseudo+1, x) });
				}
				currentPart.hasLoops = (	
						currentPart.pseudos.length || 
						currentPart.attrs.length || 
						currentPart.classes.length	);
				currentPart.query = ts(pStart, x);
				currentPart.otag = currentPart.tag = (currentPart[""oper""]) ? null : (currentPart.tag || ""*"");
				if(currentPart.tag){ // FIXME: not valid in case-sensitive documents
					currentPart.tag = currentPart.tag.toUpperCase();
				}
				qparts.push(currentPart);
				currentPart = null;
			}
		}
		return qparts;
	};
	

	////////////////////////////////////////////////////////////////////////
	// XPath query code
	////////////////////////////////////////////////////////////////////////

	// this array is a lookup used to generate an attribute matching function.
	// There is a similar lookup/generator list for the DOM branch with similar
	// calling semantics.
	var xPathAttrs = {
		""*="": function(attr, value){
			return ""[contains(@""+attr+"", '""+ value +""')]"";
		},
		""^="": function(attr, value){
			return ""[starts-with(@""+attr+"", '""+ value +""')]"";
		},
		""$="": function(attr, value){
			return ""[substring(@""+attr+"", string-length(@""+attr+"")-""+(value.length-1)+"")='""+value+""']"";
		},
		""~="": function(attr, value){
			return ""[contains(concat(' ',@""+attr+"",' '), ' ""+ value +"" ')]"";
		},
		""|="": function(attr, value){
			return ""[contains(concat(' ',@""+attr+"",' '), ' ""+ value +""-')]"";
		},
		""="": function(attr, value){
			return ""[@""+attr+""='""+ value +""']"";
		}
	};

	// takes a list of attribute searches, the overall query, a function to
	// generate a default matcher, and a closure-bound method for providing a
	// matching function that generates whatever type of yes/no distinguisher
	// the query method needs. The method is a bit tortured and hard to read
	// because it needs to be used in both the XPath and DOM branches.
	var handleAttrs = function(	attrList, 
								query, 
								getDefault, 
								handleMatch){
		d.forEach(query.attrs, function(attr){
			var matcher;
			// type, attr, matchFor
			if(attr.type && attrList[attr.type]){
				matcher = attrList[attr.type](attr.attr, attr.matchFor);
			}else if(attr.attr.length){
				matcher = getDefault(attr.attr);
			}
			if(matcher){ handleMatch(matcher); }
		});
	}

	var buildPath = function(query){
		var xpath = ""."";
		var qparts = getQueryParts(d.trim(query));
		while(qparts.length){
			var tqp = qparts.shift();
			var prefix;
			var postfix = """";
			if(tqp.oper == "">""){
				prefix = ""/"";
				// prefix = ""/child::*"";
				tqp = qparts.shift();
			}else if(tqp.oper == ""~""){
				prefix = ""/following-sibling::""; // get element following siblings
				tqp = qparts.shift();
			}else if(tqp.oper == ""+""){
				// FIXME: 
				//		fails when selecting subsequent siblings by node type
				//		because the position() checks the position in the list
				//		of matching elements and not the localized siblings
				prefix = ""/following-sibling::"";
				postfix = ""[position()=1]"";
				tqp = qparts.shift();
			}else{
				prefix = ""//"";
				// prefix = ""/descendant::*""
			}

			// get the tag name (if any)

			xpath += prefix + tqp.tag + postfix;
			
			// check to see if it's got an id. Needs to come first in xpath.
			if(tqp.id){
				xpath += ""[@id='""+tqp.id+""'][1]"";
			}

			d.forEach(tqp.classes, function(cn){
				var cnl = cn.length;
				var padding = "" "";
				if(cn.charAt(cnl-1) == ""*""){
					padding = """"; cn = cn.substr(0, cnl-1);
				}
				xpath += 
					""[contains(concat(' ',@class,' '), ' ""+
					cn + padding + ""')]"";
			});

			handleAttrs(xPathAttrs, tqp, 
				function(condition){
						return ""[@""+condition+""]"";
				},
				function(matcher){
					xpath += matcher;
				}
			);

			// FIXME: need to implement pseudo-class checks!!
		};
		return xpath;
	};

	var _xpathFuncCache = {};
	var getXPathFunc = function(path){
		if(_xpathFuncCache[path]){
			return _xpathFuncCache[path];
		}

		var doc = d.doc;
		// don't need to memoize. The closure scope handles it for us.
		var xpath = buildPath(path);

		var tf = function(parent){
			// XPath query strings are memoized.

			var ret = [];
			var xpathResult;
			var tdoc = doc;
			if(parent){
				tdoc = (parent.nodeType == 9) ? parent : parent.ownerDocument;
			}
			try{
				xpathResult = tdoc.evaluate(xpath, parent, null, 
												// XPathResult.UNORDERED_NODE_ITERATOR_TYPE, null);
												XPathResult.ANY_TYPE, null);
			}catch(e){
				
				
			}
			var result = xpathResult.iterateNext();
			while(result){
				ret.push(result);
				result = xpathResult.iterateNext();
			}
			return ret;
		}
		return _xpathFuncCache[path] = tf;
	};

	/*
	d.xPathMatch = function(query){
		// XPath based DOM query system. Handles a small subset of CSS
		// selectors, subset is identical to the non-XPath version of this
		// function. 

		return getXPathFunc(query)();
	}
	*/

	////////////////////////////////////////////////////////////////////////
	// DOM query code
	////////////////////////////////////////////////////////////////////////

	var _filtersCache = {};
	var _simpleFiltersCache = {};

	// the basic building block of the yes/no chaining system. agree(f1, f2)
	// generates a new function which returns the boolean results of both of
	// the passed functions to a single logical-anded result.
	var agree = function(first, second){
		if(!first){ return second; }
		if(!second){ return first; }

		return function(){
			return first.apply(window, arguments) && second.apply(window, arguments);
		}
	}

	var _childElements = function(root){
		var ret = [];
		var te, x = 0, tret = root[childNodesName];
		while((te = tret[x++])){
			if(te.nodeType == 1){ ret.push(te); }
		}
		return ret;
	}

	var _nextSiblings = function(root, single){
		var ret = [];
		var te = root;
		while(te = te.nextSibling){
			if(te.nodeType == 1){
				ret.push(te);
				if(single){ break; }
			}
		}
		return ret;
	}

	// FIXME:
	//		we need to re-write the way ""~"" and ""+"" selectors are handled since
	//		the left-hand selector simply modifies the right (which is the
	//		actual search selector). We need to locate on search selector
	//		instead of modifier to speed up these searches.

	var _filterDown = function(element, queryParts, matchArr, idx){
		// NOTE:
		//		in the fast path! this function is called recursively and for
		//		every run of a query.
		var nidx = idx+1;
		var isFinal = (queryParts.length == nidx);
		var tqp = queryParts[idx];

		// see if we can constrain our next level to direct children
		if(tqp.oper){
			// find some eligable children to search
			var ecn = (tqp.oper == "">"") ? 
				_childElements(element) :
				_nextSiblings(element, (tqp.oper == ""+""));

			if(!ecn || !ecn.length){
				return;
			}
			nidx++;
			isFinal = (queryParts.length == nidx);
			// kinda janky, too much array alloc
			var tf = getFilterFunc(queryParts[idx+1]);
			// for(var x=ecn.length-1, te; x>=0, te=ecn[x]; x--){
			for(var x=0, ecnl=ecn.length, te; x<ecnl, te=ecn[x]; x++){
				if(tf(te)){
					if(isFinal){
						matchArr.push(te);
					}else{
						_filterDown(te, queryParts, matchArr, nidx);
					}
				}
				/*
				if(x==0){
					break;
				}
				*/
			}
		}

		// otherwise, keep going down, unless we'er at the end
		var candidates = getElementsFunc(tqp)(element);
		if(isFinal){
			while(candidates.length){
				matchArr.push(candidates.shift());
			}
			/*
			candidates.unshift(0, matchArr.length-1);
			matchArr.splice.apply(matchArr, candidates);
			*/
		}else{
			// if we're not yet at the bottom, keep going!
			while(candidates.length){
				_filterDown(candidates.shift(), queryParts, matchArr, nidx);
			}
		}
	}

	var filterDown = function(elements, queryParts){
		var ret = [];

		// for every root, get the elements that match the descendant selector
		// for(var x=elements.length-1, te; x>=0, te=elements[x]; x--){
		var x = elements.length - 1, te;
		while((te = elements[x--])){
			_filterDown(te, queryParts, ret, 0);
		}
		return ret;
	}

	var getFilterFunc = function(q){
		// note: query can't have spaces!
		if(_filtersCache[q.query]){
			return _filtersCache[q.query];
		}
		var ff = null;

		// does it have a tagName component?
		if(q.tag){
			if(q.tag == ""*""){
				ff = agree(ff, 
					function(elem){
						return (elem.nodeType == 1);
					}
				);
			}else{
				// tag name match
				ff = agree(ff, 
					function(elem){
						return (
							(elem.nodeType == 1) &&
							(q[ caseSensitive ? ""otag"" : ""tag"" ] == elem.tagName)
							// (q.tag == elem.tagName.toLowerCase())
						);
						// return isTn;
					}
				);
			}
		}

		// does the node have an ID?
		if(q.id){
			ff = agree(ff, 
				function(elem){
					return (
						(elem.nodeType == 1) &&
						(elem.id == q.id)
					);
				}
			);
		}

		if(q.hasLoops){
			// if we have other query param parts, make sure we add them to the
			// filter chain
			ff = agree(ff, getSimpleFilterFunc(q));
		}

		return _filtersCache[q.query] = ff;
	}

	var getNodeIndex = function(node){
		// NOTE: 
		//		we could have a more accurate caching mechanism by invalidating
		//		caches after the query has finished, but I think that'd lead to
		//		significantly more cache churn than the cache would provide
		//		value for in the common case. Generally, we're more
		//		conservative (and therefore, more accurate) than jQuery and
		//		DomQuery WRT node node indexes, but there may be corner cases
		//		in which we fall down.  How much we care about them is TBD.

		var pn = node.parentNode;
		var pnc = pn.childNodes;

		// check to see if we can trust the cache. If not, re-key the whole
		// thing and return our node match from that.

		var nidx = -1;
		var child = pn.firstChild;
		if(!child){
			return nidx;
		}

		var ci = node[""__cachedIndex""];
		var cl = pn[""__cachedLength""];

		// only handle cache building if we've gone out of sync
		if(((typeof cl == ""number"")&&(cl != pnc.length))||(typeof ci != ""number"")){
			// rip though the whole set, building cache indexes as we go
			pn[""__cachedLength""] = pnc.length;
			var idx = 1;
			do{
				// we only assign indexes for nodes with nodeType == 1, as per:
				//		http://www.w3.org/TR/css3-selectors/#nth-child-pseudo
				// only elements are counted in the search order, and they
				// begin at 1 for the first child's index

				if(child === node){
					nidx = idx;
				}
				if(child.nodeType == 1){
					child[""__cachedIndex""] = idx;
					idx++;
				}
				child = child.nextSibling;
			}while(child);
		}else{
			// NOTE: 
			//		could be incorrect in some cases (node swaps involving the
			//		passed node, etc.), but we ignore those due to the relative
			//		unlikelihood of that occuring
			nidx = ci;
		}
		return nidx;
	}

	var firedCount = 0;

	var blank = """";
	var _getAttr = function(elem, attr){
		if(attr == ""class""){
			return elem.className || blank;
		}
		if(attr == ""for""){
			return elem.htmlFor || blank;
		}
		if(attr == ""style""){
			return elem.style.cssText || blank;
		}
		return elem.getAttribute(attr, 2) || blank;
	}

	var attrs = {
		""*="": function(attr, value){
			return function(elem){
				// E[foo*=""bar""]
				//		an E element whose ""foo"" attribute value contains
				//		the substring ""bar""
				return (_getAttr(elem, attr).indexOf(value)>=0);
			}
		},
		""^="": function(attr, value){
			// E[foo^=""bar""]
			//		an E element whose ""foo"" attribute value begins exactly
			//		with the string ""bar""
			return function(elem){
				return (_getAttr(elem, attr).indexOf(value)==0);
			}
		},
		""$="": function(attr, value){
			// E[foo$=""bar""]	
			//		an E element whose ""foo"" attribute value ends exactly
			//		with the string ""bar""
			var tval = "" ""+value;
			return function(elem){
				var ea = "" ""+_getAttr(elem, attr);
				return (ea.lastIndexOf(value)==(ea.length-value.length));
			}
		},
		""~="": function(attr, value){
			// E[foo~=""bar""]	
			//		an E element whose ""foo"" attribute value is a list of
			//		space-separated values, one of which is exactly equal
			//		to ""bar""

			// return ""[contains(concat(' ',@""+attr+"",' '), ' ""+ value +"" ')]"";
			var tval = "" ""+value+"" "";
			return function(elem){
				var ea = "" ""+_getAttr(elem, attr)+"" "";
				return (ea.indexOf(tval)>=0);
			}
		},
		""|="": function(attr, value){
			// E[hreflang|=""en""]
			//		an E element whose ""hreflang"" attribute has a
			//		hyphen-separated list of values beginning (from the
			//		left) with ""en""
			var valueDash = "" ""+value+""-"";
			return function(elem){
				var ea = "" ""+(elem.getAttribute(attr, 2) || """");
				return (
					(ea == value) ||
					(ea.indexOf(valueDash)==0)
				);
			}
		},
		""="": function(attr, value){
			return function(elem){
				return (_getAttr(elem, attr) == value);
			}
		}
	};

	var pseudos = {
		""checked"": function(name, condition){
			return function(elem){
				return !!d.attr(elem, ""checked"");
			}
		},
		""first-child"": function(name, condition){
			return function(elem){
				if(elem.nodeType != 1){ return false; }
				// check to see if any of the previous siblings are elements
				var fc = elem.previousSibling;
				while(fc && (fc.nodeType != 1)){
					fc = fc.previousSibling;
				}
				return (!fc);
			}
		},
		""last-child"": function(name, condition){
			return function(elem){
				if(elem.nodeType != 1){ return false; }
				// check to see if any of the next siblings are elements
				var nc = elem.nextSibling;
				while(nc && (nc.nodeType != 1)){
					nc = nc.nextSibling;
				}
				return (!nc);
			}
		},
		""empty"": function(name, condition){
			return function(elem){
				// DomQuery and jQuery get this wrong, oddly enough.
				// The CSS 3 selectors spec is pretty explicit about
				// it, too.
				var cn = elem.childNodes;
				var cnl = elem.childNodes.length;
				// if(!cnl){ return true; }
				for(var x=cnl-1; x >= 0; x--){
					var nt = cn[x].nodeType;
					if((nt == 1)||(nt == 3)){ return false; }
				}
				return true;
			}
		},
		""contains"": function(name, condition){
			return function(elem){
				// FIXME: I dislike this version of ""contains"", as
				// whimsical attribute could set it off. An inner-text
				// based version might be more accurate, but since
				// jQuery and DomQuery also potentially get this wrong,
				// I'm leaving it for now.
				if(condition.charAt(0)=='""' || condition.charAt(0)==""'""){//remove quote
					condition=condition.substr(1,condition.length-2);
				}
				return (elem.innerHTML.indexOf(condition) >= 0);
			}
		},
		""not"": function(name, condition){
			var ntf = getFilterFunc(getQueryParts(condition)[0]);
			return function(elem){
				return (!ntf(elem));
			}
		},
		""nth-child"": function(name, condition){
			var pi = parseInt;
			if(condition == ""odd""){
				condition = ""2n+1"";
			}else if(condition == ""even""){
				condition = ""2n"";
			}
			if(condition.indexOf(""n"") != -1){
				var tparts = condition.split(""n"", 2);
				var pred = tparts[0] ? (tparts[0]=='-'?-1:pi(tparts[0])) : 1;
				var idx = tparts[1] ? pi(tparts[1]) : 0;
				var lb = 0, ub = -1;
				if(pred>0){
					if(idx<0){
						idx = (idx % pred) && (pred + (idx % pred));
					}else if(idx>0){
						if(idx >= pred){
							lb = idx - idx % pred;
						}
						idx = idx % pred;
					}
				}else if(pred<0){
					pred *= -1;
					if(idx>0){
						ub = idx;
						idx = idx % pred;
					} //idx has to be greater than 0 when pred is negative; shall we throw an error here?
				}
				if(pred>0){
					return function(elem){
						var i=getNodeIndex(elem);
						return (i>=lb) && (ub<0 || i<=ub) && ((i % pred) == idx);
					}
				}else{
					condition=idx;
				}
			}
			//if(condition.indexOf(""n"") == -1){
			var ncount = pi(condition);
			return function(elem){
				return (getNodeIndex(elem) == ncount);
			}
		}
	};

	var defaultGetter = (d.isIE) ? function(cond){
		var clc = cond.toLowerCase();
		return function(elem){
			return elem[cond]||elem[clc];
		}
	} : function(cond){
		return function(elem){
			return (elem && elem.getAttribute && elem.hasAttribute(cond));
		}
	};

	var getSimpleFilterFunc = function(query){

		var fcHit = (_simpleFiltersCache[query.query]||_filtersCache[query.query]);
		if(fcHit){ return fcHit; }

		var ff = null;

		// the only case where we'll need the tag name is if we came from an ID query
		if(query.id){ // do we have an ID component?
			if(query.tag != ""*""){
				ff = agree(ff, function(elem){
					return (elem.tagName == query[ caseSensitive ? ""otag"" : ""tag"" ]);
				});
			}
		}

		// if there's a class in our query, generate a match function for it
		d.forEach(query.classes, function(cname, idx, arr){
			// get the class name
			var isWildcard = cname.charAt(cname.length-1) == ""*"";
			if(isWildcard){
				cname = cname.substr(0, cname.length-1);
			}
			// I dislike the regex thing, even if memozied in a cache, but it's VERY short
			var re = new RegExp(""(?:^|\\s)"" + cname + (isWildcard ? "".*"" : """") + ""(?:\\s|$)"");
			ff = agree(ff, function(elem){
				return re.test(elem.className);
			});
			ff.count = idx;
		});

		d.forEach(query.pseudos, function(pseudo){
			if(pseudos[pseudo.name]){
				ff = agree(ff, pseudos[pseudo.name](pseudo.name, pseudo.value));
			}
		});

		handleAttrs(attrs, query, defaultGetter,
			function(tmatcher){ ff = agree(ff, tmatcher); }
		);
		if(!ff){
			ff = function(){ return true; };
		}
		return _simpleFiltersCache[query.query] = ff;
	}

	var _getElementsFuncCache = { };

	var getElementsFunc = function(query, root){
		var fHit = _getElementsFuncCache[query.query];
		if(fHit){ return fHit; }

		// NOTE: this function is in the fast path! not memoized!!!

		// the query doesn't contain any spaces, so there's only so many
		// things it could be

		if(query.id && !query.hasLoops && !query.tag){
			// ID-only query. Easy.
			return _getElementsFuncCache[query.query] = function(root){
				// FIXME: if root != document, check for parenting!
				return [ d.byId(query.id) ];
			}
		}

		var filterFunc = getSimpleFilterFunc(query);

		var retFunc;
		if(query.tag && query.id && !query.hasLoops){
			// we got a filtered ID search (e.g., ""h4#thinger"")
			retFunc = function(root){
				var te = d.byId(query.id, (root.ownerDocument||root)); //root itself may be a document
				if(filterFunc(te)){
					return [ te ];
				}
			}
		}else{
			var tret;

			if(!query.hasLoops){
				// it's just a plain-ol elements-by-tag-name query from the root
				retFunc = function(root){
					var ret = [];
					var te, x=0, tret = root.getElementsByTagName(query[ caseSensitive ? ""otag"" : ""tag""]);
					while((te = tret[x++])){
						ret.push(te);
					}
					return ret;
				}
			}else{
				retFunc = function(root){
					var ret = [];
					var te, x = 0, tret = root.getElementsByTagName(query[ caseSensitive ? ""otag"" : ""tag""]);
					while((te = tret[x++])){
						if(filterFunc(te)){
							ret.push(te);
						}
					}
					return ret;
				}
			}
		}
		return _getElementsFuncCache[query.query] = retFunc;
	}

	var _partsCache = {};

	////////////////////////////////////////////////////////////////////////
	// the query runner
	////////////////////////////////////////////////////////////////////////

	// this is the second level of spliting, from full-length queries (e.g.,
	// ""div.foo .bar"") into simple query expressions (e.g., [""div.foo"",
	// "".bar""])
	var _queryFuncCache = {
		""*"": d.isIE ? 
			function(root){ 
					return root.all;
			} : 
			function(root){
				 return root.getElementsByTagName(""*"");
			},
		""~"": _nextSiblings,
		""+"": function(root){ return _nextSiblings(root, true); },
		"">"": _childElements
	};

	var getStepQueryFunc = function(query){
		// if it's trivial, get a fast-path dispatcher
		var qparts = getQueryParts(d.trim(query));
		// if(query[query.length-1] == "">""){ query += "" *""; }
		if(qparts.length == 1){
			var tt = getElementsFunc(qparts[0]);
			tt.nozip = true; // FIXME: is this right? Shouldn't this be wrapped in a closure to mark the return?
			return tt;
		}

		// otherwise, break it up and return a runner that iterates over the parts recursively
		var sqf = function(root){
			var localQueryParts = qparts.slice(0); // clone the src arr
			var candidates;
			if(localQueryParts[0].oper == "">""){ // FIXME: what if it's + or ~?
				candidates = [ root ];
				// root = document;
			}else{
				candidates = getElementsFunc(localQueryParts.shift())(root);
			}
			return filterDown(candidates, localQueryParts);
		}
		return sqf;
	}

	// a specialized method that implements our primoridal ""query optimizer"".
	// This allows us to dispatch queries to the fastest subsystem we can get.
	var _getQueryFunc = (
		// NOTE: 
		//		XPath on the Webkit is slower than it's DOM iteration for most
		//		test cases
		// FIXME: 
		//		we should try to capture some runtime speed data for each query
		//		function to determine on the fly if we should stick w/ the
		//		potentially optimized variant or if we should try something
		//		new.
		(document[""evaluate""] && !d.isSafari) ? 
		function(query, root){
			// has xpath support that's faster than DOM
			var qparts = query.split("" "");
			// can we handle it?
			if(	(!caseSensitive) && // not strictly necessaray, but simplifies lots of stuff
				(document[""evaluate""]) &&
				(query.indexOf("":"") == -1) &&
				(query.indexOf(""+"") == -1) // skip direct sibling matches. See line ~344
			){
				// dojo.debug(query);
				// should we handle it?

				// kind of a lame heuristic, but it works
				if(	
					// a ""div div div"" style query
					((qparts.length > 2)&&(query.indexOf("">"") == -1))||
					// or something else with moderate complexity. kinda janky
					(qparts.length > 3)||
					(query.indexOf(""["")>=0)||
					// or if it's a "".thinger"" query
					((1 == qparts.length)&&(0 <= query.indexOf(""."")))

				){
					// use get and cache a xpath runner for this selector
					return getXPathFunc(query);
				}
			}

			// fallthrough
			return getStepQueryFunc(query);
		} : getStepQueryFunc
	);
	// uncomment to disable XPath for testing and tuning the DOM path
	// _getQueryFunc = getStepQueryFunc;

	// FIXME: we've got problems w/ the NodeList query()/filter() functions if we go XPath for everything

	// uncomment to disable DOM queries for testing and tuning XPath
	// _getQueryFunc = getXPathFunc;

	// this is the primary caching for full-query results. The query dispatcher
	// functions are generated here and then pickled for hash lookup in the
	// future
	var getQueryFunc = function(query){
		// return a cached version if one is available
		var qcz = query.charAt(0);
		if(d.doc[""querySelectorAll""] && 
			( (!d.isSafari) || (d.isSafari > 3.1) ) && // see #5832
			// as per CSS 3, we can't currently start w/ combinator:
			//		http://www.w3.org/TR/css3-selectors/#w3cselgrammar
			("">+~"".indexOf(qcz) == -1)
		){
			return function(root){
				var r = root.querySelectorAll(query);
				r.nozip = true; // skip expensive duplication checks and just wrap in a NodeList
				return r;
			};
		}
		if(_queryFuncCache[query]){ return _queryFuncCache[query]; }
		if(0 > query.indexOf("","")){
			// if it's not a compound query (e.g., "".foo, .bar""), cache and return a dispatcher
			return _queryFuncCache[query] = _getQueryFunc(query);
		}else{
			// if it's a complex query, break it up into it's constituent parts
			// and return a dispatcher that will merge the parts when run

			// var parts = query.split("", "");
			var parts = query.split(/\s*,\s*/);
			var tf = function(root){
				var pindex = 0; // avoid array alloc for every invocation
				var ret = [];
				var tp;
				while((tp = parts[pindex++])){
					ret = ret.concat(_getQueryFunc(tp, tp.indexOf("" ""))(root));
				}
				return ret;
			}
			// ...cache and return
			return _queryFuncCache[query] = tf;
		}
	}

	// FIXME: 
	//		Dean's Base2 uses a system whereby queries themselves note if
	//		they'll need duplicate filtering. We need to get on that plan!!

	// attempt to efficiently determine if an item in a list is a dupe,
	// returning a list of ""uniques"", hopefully in doucment order
	var _zipIdx = 0;
	var _zip = function(arr){
		if(arr && arr.nozip){ return d.NodeList._wrap(arr); }
		var ret = new d.NodeList();
		if(!arr){ return ret; }
		if(arr[0]){
			ret.push(arr[0]);
		}
		if(arr.length < 2){ return ret; }

		_zipIdx++;
		
		// we have to fork here for IE and XML docs because we can't set
		// expandos on their nodes (apparently). *sigh*
		if(d.isIE && caseSensitive){
			var szidx = _zipIdx+"""";
			arr[0].setAttribute(""_zipIdx"", szidx);
			for(var x = 1, te; te = arr[x]; x++){
				if(arr[x].getAttribute(""_zipIdx"") != szidx){ 
					ret.push(te);
				}
				te.setAttribute(""_zipIdx"", szidx);
			}
		}else{
			arr[0][""_zipIdx""] = _zipIdx;
			for(var x = 1, te; te = arr[x]; x++){
				if(arr[x][""_zipIdx""] != _zipIdx){ 
					ret.push(te);
				}
				te[""_zipIdx""] = _zipIdx;
			}
		}
		// FIXME: should we consider stripping these properties?
		return ret;
	}

	// the main executor
	d.query = function(/*String*/ query, /*String|DOMNode?*/ root){
		//	summary:
		//		Returns nodes which match the given CSS3 selector, searching the
		//		entire document by default but optionally taking a node to scope
		//		the search by. Returns an instance of dojo.NodeList.
		//	description:
		//		dojo.query() is the swiss army knife of DOM node manipulation in
		//		Dojo. Much like Prototype's ""$$"" (bling-bling) function or JQuery's
		//		""$"" function, dojo.query provides robust, high-performance
		//		CSS-based node selector support with the option of scoping searches
		//		to a particular sub-tree of a document.
		//
		//		Supported Selectors:
		//		--------------------
		//
		//		dojo.query() supports a rich set of CSS3 selectors, including:
		//
		//			* class selectors (e.g., `.foo`)
		//			* node type selectors like `span`
		//			* ` ` descendant selectors
		//			* `>` child element selectors 
		//			* `#foo` style ID selectors
		//			* `*` universal selector
		//			* `~`, the immediately preceeded-by sibling selector
		//			* `+`, the preceeded-by sibling selector
		//			* attribute queries:
		//			|	* `[foo]` attribute presence selector
		//			|	* `[foo='bar']` attribute value exact match
		//			|	* `[foo~='bar']` attribute value list item match
		//			|	* `[foo^='bar']` attribute start match
		//			|	* `[foo$='bar']` attribute end match
		//			|	* `[foo*='bar']` attribute substring match
		//			* `:first-child`, `:last-child` positional selectors
		//			* `:empty` content emtpy selector
		//			* `:empty` content emtpy selector
		//			* `:checked` pseudo selector
		//			* `:nth-child(n)`, `:nth-child(2n+1)` style positional calculations
		//			* `:nth-child(even)`, `:nth-child(odd)` positional selectors
		//			* `:not(...)` negation pseudo selectors
		//
		//		Any legal combination of these selectors will work with
		//		`dojo.query()`, including compound selectors ("","" delimited).
		//		Very complex and useful searches can be constructed with this
		//		palette of selectors and when combined with functions for
		//		maniplation presented by dojo.NodeList, many types of DOM
		//		manipulation operations become very straightforward.
		//		
		//		Unsupported Selectors:
		//		----------------------
		//
		//		While dojo.query handles many CSS3 selectors, some fall outside of
		//		what's resaonable for a programmatic node querying engine to
		//		handle. Currently unsupported selectors include:
		//		
		//			* namespace-differentiated selectors of any form
		//			* all `::` pseduo-element selectors
		//			* certain pseduo-selectors which don't get a lot of day-to-day use:
		//			|	* `:root`, `:lang()`, `:target`, `:focus`
		//			* all visual and state selectors:
		//			|	* `:root`, `:active`, `:hover`, `:visisted`, `:link`,
		//				  `:enabled`, `:disabled`
		//			* `:*-of-type` pseudo selectors
		//		
		//		dojo.query and XML Documents:
		//		-----------------------------
		//		
		//		`dojo.query` currently only supports searching XML documents
		//		whose tags and attributes are 100% lower-case. This is a known
		//		limitation and will [be addressed soon](http://trac.dojotoolkit.org/ticket/3866)
		//		Non-selector Queries:
		//		---------------------
		//
		//		If something other than a String is passed for the query,
		//		`dojo.query` will return a new `dojo.NodeList` constructed from
		//		that parameter alone and all further processing will stop. This
		//		means that if you have a reference to a node or NodeList, you
		//		can quickly construct a new NodeList from the original by
		//		calling `dojo.query(node)` or `dojo.query(list)`.
		//
		//	query:
		//		The CSS3 expression to match against. For details on the syntax of
		//		CSS3 selectors, see <http://www.w3.org/TR/css3-selectors/#selectors>
		//	root:
		//		A DOMNode (or node id) to scope the search from. Optional.
		//	returns: dojo.NodeList
		//		An instance of `dojo.NodeList`. Many methods are available on
		//		NodeLists for searching, iterating, manipulating, and handling
		//		events on the matched nodes in the returned list.
		//	example:
		//		search the entire document for elements with the class ""foo"":
		//	|	dojo.query("".foo"");
		//		these elements will match:
		//	|	<span class=""foo""></span>
		//	|	<span class=""foo bar""></span>
		//	|	<p class=""thud foo""></p>
		//	example:
		//		search the entire document for elements with the classes ""foo"" *and* ""bar"":
		//	|	dojo.query("".foo.bar"");
		//		these elements will match:
		//	|	<span class=""foo bar""></span>
		//		while these will not:
		//	|	<span class=""foo""></span>
		//	|	<p class=""thud foo""></p>
		//	example:
		//		find `<span>` elements which are descendants of paragraphs and
		//		which have a ""highlighted"" class:
		//	|	dojo.query(""p span.highlighted"");
		//		the innermost span in this fragment matches:
		//	|	<p class=""foo"">
		//	|		<span>...
		//	|			<span class=""highlighted foo bar"">...</span>
		//	|		</span>
		//	|	</p>
		//	example:
		//		set an ""odd"" class on all odd table rows inside of the table
		//		`#tabular_data`, using the `>` (direct child) selector to avoid
		//		affecting any nested tables:
		//	|	dojo.query(""#tabular_data > tbody > tr:nth-child(odd)"").addClass(""odd"");
		//	example:
		//		remove all elements with the class ""error"" from the document
		//		and store them in a list:
		//	|	var errors = dojo.query("".error"").orphan();
		//	example:
		//		add an onclick handler to every submit button in the document
		//		which causes the form to be sent via Ajax instead:
		//	|	dojo.query(""input[type='submit']"").onclick(function(e){
		//	|		dojo.stopEvent(e); // prevent sending the form
		//	|		var btn = e.target;
		//	|		dojo.xhrPost({
		//	|			form: btn.form,
		//	|			load: function(data){
		//	|				// replace the form with the response
		//	|				var div = dojo.doc.createElement(""div"");
		//	|				dojo.place(div, btn.form, ""after"");
		//	|				div.innerHTML = data;
		//	|				dojo.style(btn.form, ""display"", ""none"");
		//	|			}
		//	|		});
		//	|	});


		// NOTE: elementsById is not currently supported
		// NOTE: ignores xpath-ish queries for now

		if(query.constructor == d.NodeList){
			return query;
		}
		if(!d.isString(query)){
			return new d.NodeList(query); // dojo.NodeList
		}
		if(d.isString(root)){
			root = d.byId(root);
		}

		root = root||d.doc;
		var od = root.ownerDocument||root.documentElement;
		caseSensitive = (root.contentType && root.contentType==""application/xml"") || (!!od) && (d.isIE ? od.xml : (root.xmlVersion||od.xmlVersion));
		return _zip(getQueryFunc(query)(root)); // dojo.NodeList
	}

	/*
	// exposing this was a mistake
	d.query.attrs = attrs;
	*/
	// exposing this because new pseudo matches are only executed through the
	// DOM query path (never through the xpath optimizing branch)
	d.query.pseudos = pseudos;

	// one-off function for filtering a NodeList based on a simple selector
	d._filterQueryResult = function(nodeList, simpleFilter){
		var tnl = new d.NodeList();
		var ff = (simpleFilter) ? getFilterFunc(getQueryParts(simpleFilter)[0]) : function(){ return true; };
		for(var x = 0, te; te = nodeList[x]; x++){
			if(ff(te)){ tnl.push(te); }
		}
		return tnl;
	}
})();

}

if(!dojo._hasResource[""dojo._base.xhr""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.xhr""] = true;
dojo.provide(""dojo._base.xhr"");





(function(){
	var _d = dojo;
	function setValue(/*Object*/obj, /*String*/name, /*String*/value){
		//summary:
		//		For the named property in object, set the value. If a value
		//		already exists and it is a string, convert the value to be an
		//		array of values.
		var val = obj[name];
		if(_d.isString(val)){
			obj[name] = [val, value];
		}else if(_d.isArray(val)){
			val.push(value);
		}else{
			obj[name] = value;
		}
	}

	dojo.formToObject = function(/*DOMNode||String*/ formNode){
		// summary:
		//		dojo.formToObject returns the values encoded in an HTML form as
		//		string properties in an object which it then returns. Disabled form
		//		elements, buttons, and other non-value form elements are skipped.
		//		Multi-select elements are returned as an array of string values.
		// description:
		//		This form:
		//
		//		|	<form id=""test_form"">
		//		|		<input type=""text"" name=""blah"" value=""blah"">
		//		|		<input type=""text"" name=""no_value"" value=""blah"" disabled>
		//		|		<input type=""button"" name=""no_value2"" value=""blah"">
		//		|		<select type=""select"" multiple name=""multi"" size=""5"">
		//		|			<option value=""blah"">blah</option>
		//		|			<option value=""thud"" selected>thud</option>
		//		|			<option value=""thonk"" selected>thonk</option>
		//		|		</select>
		//		|	</form>
		//
		//		yields this object structure as the result of a call to
		//		formToObject():
		//
		//		|	{ 
		//		|		blah: ""blah"",
		//		|		multi: [
		//		|			""thud"",
		//		|			""thonk""
		//		|		]
		//		|	};

		var ret = {};
		var exclude = ""file|submit|image|reset|button|"";
		_d.forEach(dojo.byId(formNode).elements, function(item){
			var _in = item.name;
			var type = (item.type||"""").toLowerCase();
			if(_in && type && exclude.indexOf(type) == -1 && !item.disabled){
				if(type == ""radio"" || type == ""checkbox""){
					if(item.checked){ setValue(ret, _in, item.value); }
				}else if(item.multiple){
					ret[_in] = [];
					_d.query(""option"", item).forEach(function(opt){
						if(opt.selected){
							setValue(ret, _in, opt.value);
						}
					});
				}else{ 
					setValue(ret, _in, item.value);
					if(type == ""image""){
						ret[_in+"".x""] = ret[_in+"".y""] = ret[_in].x = ret[_in].y = 0;
					}
				}
			}
		});
		return ret; // Object
	}

	dojo.objectToQuery = function(/*Object*/ map){
		//	summary:
		//		takes a name/value mapping object and returns a string representing
		//		a URL-encoded version of that object.
		//	example:
		//		this object:
		//
		//		|	{ 
		//		|		blah: ""blah"",
		//		|		multi: [
		//		|			""thud"",
		//		|			""thonk""
		//		|		]
		//		|	};
		//
		//	yields the following query string:
		//	
		//	|	""blah=blah&multi=thud&multi=thonk""

		// FIXME: need to implement encodeAscii!!
		var enc = encodeURIComponent;
		var pairs = [];
		var backstop = {};
		for(var name in map){
			var value = map[name];
			if(value != backstop[name]){
				var assign = enc(name) + ""="";
				if(_d.isArray(value)){
					for(var i=0; i < value.length; i++){
						pairs.push(assign + enc(value[i]));
					}
				}else{
					pairs.push(assign + enc(value));
				}
			}
		}
		return pairs.join(""&""); // String
	}

	dojo.formToQuery = function(/*DOMNode||String*/ formNode){
		// summary:
		//		Returns a URL-encoded string representing the form passed as either a
		//		node or string ID identifying the form to serialize
		return _d.objectToQuery(_d.formToObject(formNode)); // String
	}

	dojo.formToJson = function(/*DOMNode||String*/ formNode, /*Boolean?*/prettyPrint){
		// summary:
		//		return a serialized JSON string from a form node or string
		//		ID identifying the form to serialize
		return _d.toJson(_d.formToObject(formNode), prettyPrint); // String
	}

	dojo.queryToObject = function(/*String*/ str){
		// summary:
		//		returns an object representing a de-serialized query section of a
		//		URL. Query keys with multiple values are returned in an array.
		// description:
		//		This string:
		//
		//	|		""foo=bar&foo=baz&thinger=%20spaces%20=blah&zonk=blarg&""
		//		
		//		results in this object structure:
		//
		//	|		{
		//	|			foo: [ ""bar"", ""baz"" ],
		//	|			thinger: "" spaces =blah"",
		//	|			zonk: ""blarg""
		//	|		}
		//	
		//		Note that spaces and other urlencoded entities are correctly
		//		handled.

		// FIXME: should we grab the URL string if we're not passed one?
		var ret = {};
		var qp = str.split(""&"");
		var dec = decodeURIComponent;
		_d.forEach(qp, function(item){
			if(item.length){
				var parts = item.split(""="");
				var name = dec(parts.shift());
				var val = dec(parts.join(""=""));
				if(_d.isString(ret[name])){
					ret[name] = [ret[name]];
				}
				if(_d.isArray(ret[name])){
					ret[name].push(val);
				}else{
					ret[name] = val;
				}
			}
		});
		return ret; // Object
	}

	/*
		from refactor.txt:

		all bind() replacement APIs take the following argument structure:

			{
				url: ""blah.html"",

				// all below are optional, but must be supported in some form by
				// every IO API
				timeout: 1000, // milliseconds
				handleAs: ""text"", // replaces the always-wrong ""mimetype""
				content: { 
					key: ""value""
				},

				// browser-specific, MAY be unsupported
				sync: true, // defaults to false
				form: dojo.byId(""someForm"") 
			}
	*/

	// need to block async callbacks from snatching this thread as the result
	// of an async callback might call another sync XHR, this hangs khtml forever
	// must checked by watchInFlight()

	dojo._blockAsync = false;

	dojo._contentHandlers = {
		""text"": function(xhr){ return xhr.responseText; },
		""json"": function(xhr){
			return _d.fromJson(xhr.responseText || null);
		},
		""json-comment-filtered"": function(xhr){ 
			// NOTE: the json-comment-filtered option was implemented to prevent
			// ""JavaScript Hijacking"", but it is less secure than standard JSON. Use
			// standard JSON instead. JSON prefixing can be used to subvert hijacking.
			if(!dojo.config.useCommentedJson){
				console.warn(""Consider using the standard mimetype:application/json.""
					+ "" json-commenting can introduce security issues. To""
					+ "" decrease the chances of hijacking, use the standard the 'json' handler and""
					+ "" prefix your json with: {}&&\n""
					+ ""Use djConfig.useCommentedJson=true to turn off this message."");
			}

			var value = xhr.responseText;
			var cStartIdx = value.indexOf(""\/*"");
			var cEndIdx = value.lastIndexOf(""*\/"");
			if(cStartIdx == -1 || cEndIdx == -1){
				throw new Error(""JSON was not comment filtered"");
			}
			return _d.fromJson(value.substring(cStartIdx+2, cEndIdx));
		},
		""javascript"": function(xhr){ 
			// FIXME: try Moz and IE specific eval variants?
			return _d.eval(xhr.responseText);
		},
		""xml"": function(xhr){ 
			var result = xhr.responseXML;
			if(_d.isIE && (!result || result.documentElement == null)){
				_d.forEach([""MSXML2"", ""Microsoft"", ""MSXML"", ""MSXML3""], function(prefix){
					try{
						var dom = new ActiveXObject(prefix + "".XMLDOM"");
						dom.async = false;
						dom.loadXML(xhr.responseText);
						result = dom;
					}catch(e){ /* Not available. Squelch and try next one. */ }
				});
			}
			return result; // DOMDocument
		}
	};

	dojo._contentHandlers[""json-comment-optional""] = function(xhr){
		var handlers = _d._contentHandlers;
		if(xhr.responseText && xhr.responseText.indexOf(""\/*"") != -1){
			return handlers[""json-comment-filtered""](xhr);
		}else{
			return handlers[""json""](xhr);
		}
	};

	/*=====
	dojo.__IoArgs = function(){
		//	url: String
		//		URL to server endpoint.
		//	content: Object?
		//		Contains properties with string values. These
		//		properties will be serialized as name1=value2 and
		//		passed in the request.
		//	timeout: Integer?
		//		Milliseconds to wait for the response. If this time
		//		passes, the then error callbacks are called.
		//	form: DOMNode?
		//		DOM node for a form. Used to extract the form values
		//		and send to the server.
		//	preventCache: Boolean?
		//		Default is false. If true, then a
		//		""dojo.preventCache"" parameter is sent in the request
		//		with a value that changes with each request
		//		(timestamp). Useful only with GET-type requests.
		//	handleAs: String?
		//		Acceptable values depend on the type of IO
		//		transport (see specific IO calls for more information).
		//	load: Function?
		//		function(response, ioArgs){} response is of type Object, ioArgs
		//		is of type dojo.__IoCallbackArgs.  This function will be
		//		called on a successful HTTP response code.
		//	error: Function?
		//		function(response, ioArgs){} response is of type Object, ioArgs
		//		is of type dojo.__IoCallbackArgs. This function will
		//		be called when the request fails due to a network or server error, the url
		//		is invalid, etc. It will also be called if the load or handle callback throws an
		//		exception, unless djConfig.isDebug is true.  This allows deployed applications
		//		to continue to run even when a logic error happens in the callback, while making
		//		it easier to troubleshoot while in debug mode.
		//	handle: Function?
		//		function(response, ioArgs){} response is of type Object, ioArgs
		//		is of type dojo.__IoCallbackArgs.  This function will
		//		be called at the end of every request, whether or not an error occurs.
		this.url = url;
		this.content = content;
		this.timeout = timeout;
		this.form = form;
		this.preventCache = preventCache;
		this.handleAs = handleAs;
		this.load = load;
		this.error = error;
		this.handle = handle;
	}
	=====*/

	/*=====
	dojo.__IoCallbackArgs = function(args, xhr, url, query, handleAs, id, canDelete, json){
		//	args: Object
		//		the original object argument to the IO call.
		//	xhr: XMLHttpRequest
		//		For XMLHttpRequest calls only, the
		//		XMLHttpRequest object that was used for the
		//		request.
		//	url: String
		//		The final URL used for the call. Many times it
		//		will be different than the original args.url
		//		value.
		//	query: String
		//		For non-GET requests, the
		//		name1=value1&name2=value2 parameters sent up in
		//		the request.
		//	handleAs: String
		//		The final indicator on how the response will be
		//		handled.
		//	id: String
		//		For dojo.io.script calls only, the internal
		//		script ID used for the request.
		//	canDelete: Boolean
		//		For dojo.io.script calls only, indicates
		//		whether the script tag that represents the
		//		request can be deleted after callbacks have
		//		been called. Used internally to know when
		//		cleanup can happen on JSONP-type requests.
		//	json: Object
		//		For dojo.io.script calls only: holds the JSON
		//		response for JSONP-type requests. Used
		//		internally to hold on to the JSON responses.
		//		You should not need to access it directly --
		//		the same object should be passed to the success
		//		callbacks directly.
		this.args = args;
		this.xhr = xhr;
		this.url = url;
		this.query = query;
		this.handleAs = handleAs;
		this.id = id;
		this.canDelete = canDelete;
		this.json = json;
	}
	=====*/



	dojo._ioSetArgs = function(/*dojo.__IoArgs*/args,
			/*Function*/canceller,
			/*Function*/okHandler,
			/*Function*/errHandler){
		//	summary: 
		//		sets up the Deferred and ioArgs property on the Deferred so it
		//		can be used in an io call.
		//	args:
		//		The args object passed into the public io call. Recognized properties on
		//		the args object are:
		//	canceller:
		//		The canceller function used for the Deferred object. The function
		//		will receive one argument, the Deferred object that is related to the
		//		canceller.
		//	okHandler:
		//		The first OK callback to be registered with Deferred. It has the opportunity
		//		to transform the OK response. It will receive one argument -- the Deferred
		//		object returned from this function.
		//	errHandler:
		//		The first error callback to be registered with Deferred. It has the opportunity
		//		to do cleanup on an error. It will receive two arguments: error (the 
		//		Error object) and dfd, the Deferred object returned from this function.

		var ioArgs = {args: args, url: args.url};

		//Get values from form if requestd.
		var formObject = null;
		if(args.form){ 
			var form = _d.byId(args.form);
			//IE requires going through getAttributeNode instead of just getAttribute in some form cases, 
			//so use it for all.  See #2844
			var actnNode = form.getAttributeNode(""action"");
			ioArgs.url = ioArgs.url || (actnNode ? actnNode.value : null); 
			formObject = _d.formToObject(form);
		}

		// set up the query params
		var miArgs = [{}];
	
		if(formObject){
			// potentially over-ride url-provided params w/ form values
			miArgs.push(formObject);
		}
		if(args.content){
			// stuff in content over-rides what's set by form
			miArgs.push(args.content);
		}
		if(args.preventCache){
			miArgs.push({""dojo.preventCache"": new Date().valueOf()});
		}
		ioArgs.query = _d.objectToQuery(_d.mixin.apply(null, miArgs));
	
		// .. and the real work of getting the deferred in order, etc.
		ioArgs.handleAs = args.handleAs || ""text"";
		var d = new _d.Deferred(canceller);
		d.addCallbacks(okHandler, function(error){
			return errHandler(error, d);
		});

		//Support specifying load, error and handle callback functions from the args.
		//For those callbacks, the ""this"" object will be the args object.
		//The callbacks will get the deferred result value as the
		//first argument and the ioArgs object as the second argument.
		var ld = args.load;
		if(ld && _d.isFunction(ld)){
			d.addCallback(function(value){
				return ld.call(args, value, ioArgs);
			});
		}
		var err = args.error;
		if(err && _d.isFunction(err)){
			d.addErrback(function(value){
				return err.call(args, value, ioArgs);
			});
		}
		var handle = args.handle;
		if(handle && _d.isFunction(handle)){
			d.addBoth(function(value){
				return handle.call(args, value, ioArgs);
			});
		}
		
		d.ioArgs = ioArgs;
	
		// FIXME: need to wire up the xhr object's abort method to something
		// analagous in the Deferred
		return d;
	}

	var _deferredCancel = function(/*Deferred*/dfd){
		//summary: canceller function for dojo._ioSetArgs call.
		
		dfd.canceled = true;
		var xhr = dfd.ioArgs.xhr;
		var _at = typeof xhr.abort;
		if(_at == ""function"" || _at == ""object"" || _at == ""unknown""){
			xhr.abort();
		}
		var err = dfd.ioArgs.error;
		if(!err){
			err = new Error(""xhr cancelled"");
			err.dojoType=""cancel"";
		}
		return err;
	}
	var _deferredOk = function(/*Deferred*/dfd){
		//summary: okHandler function for dojo._ioSetArgs call.

		var ret = _d._contentHandlers[dfd.ioArgs.handleAs](dfd.ioArgs.xhr);
		return (typeof ret == ""undefined"") ? null : ret;
	}
	var _deferError = function(/*Error*/error, /*Deferred*/dfd){
		//summary: errHandler function for dojo._ioSetArgs call.

		
		return error;
	}

	// avoid setting a timer per request. It degrades performance on IE
	// something fierece if we don't use unified loops.
	var _inFlightIntvl = null;
	var _inFlight = [];
	var _watchInFlight = function(){
		//summary: 
		//		internal method that checks each inflight XMLHttpRequest to see
		//		if it has completed or if the timeout situation applies.
		
		var now = (new Date()).getTime();
		// make sure sync calls stay thread safe, if this callback is called
		// during a sync call and this results in another sync call before the
		// first sync call ends the browser hangs
		if(!_d._blockAsync){
			// we need manual loop because we often modify _inFlight (and therefore 'i') while iterating
			// note: the second clause is an assigment on purpose, lint may complain
			for(var i = 0, tif; i < _inFlight.length && (tif = _inFlight[i]); i++){
				var dfd = tif.dfd;
				var func = function(){
					if(!dfd || dfd.canceled || !tif.validCheck(dfd)){
						_inFlight.splice(i--, 1); 
					}else if(tif.ioCheck(dfd)){
						_inFlight.splice(i--, 1);
						tif.resHandle(dfd);
					}else if(dfd.startTime){
						//did we timeout?
						if(dfd.startTime + (dfd.ioArgs.args.timeout || 0) < now){
							_inFlight.splice(i--, 1);
							var err = new Error(""timeout exceeded"");
							err.dojoType = ""timeout"";
							dfd.errback(err);
							//Cancel the request so the io module can do appropriate cleanup.
							dfd.cancel();
						}
					}
				};
				if(dojo.config.isDebug){
					func.call(this);
				}else{
					try{
						func.call(this);
					}catch(e){
						dfd.errback(e);
					}
				}
			}
		}

		if(!_inFlight.length){
			clearInterval(_inFlightIntvl);
			_inFlightIntvl = null;
			return;
		}

	}

	dojo._ioCancelAll = function(){
		//summary: Cancels all pending IO requests, regardless of IO type
		//(xhr, script, iframe).
		try{
			_d.forEach(_inFlight, function(i){
				try{
					i.dfd.cancel();
				}catch(e){/*squelch*/}
			});
		}catch(e){/*squelch*/}
	}

	//Automatically call cancel all io calls on unload
	//in IE for trac issue #2357.
	if(_d.isIE){
		_d.addOnWindowUnload(_d._ioCancelAll);
	}

	_d._ioWatch = function(/*Deferred*/dfd,
		/*Function*/validCheck,
		/*Function*/ioCheck,
		/*Function*/resHandle){
		//summary: watches the io request represented by dfd to see if it completes.
		//dfd:
		//		The Deferred object to watch.
		//validCheck:
		//		Function used to check if the IO request is still valid. Gets the dfd
		//		object as its only argument.
		//ioCheck:
		//		Function used to check if basic IO call worked. Gets the dfd
		//		object as its only argument.
		//resHandle:
		//		Function used to process response. Gets the dfd
		//		object as its only argument.
		if(dfd.ioArgs.args.timeout){
			dfd.startTime = (new Date()).getTime();
		}
		_inFlight.push({dfd: dfd, validCheck: validCheck, ioCheck: ioCheck, resHandle: resHandle});
		if(!_inFlightIntvl){
			_inFlightIntvl = setInterval(_watchInFlight, 50);
		}
		_watchInFlight(); // handle sync requests
	}

	var _defaultContentType = ""application/x-www-form-urlencoded"";

	var _validCheck = function(/*Deferred*/dfd){
		return dfd.ioArgs.xhr.readyState; //boolean
	}
	var _ioCheck = function(/*Deferred*/dfd){
		return 4 == dfd.ioArgs.xhr.readyState; //boolean
	}
	var _resHandle = function(/*Deferred*/dfd){
		var xhr = dfd.ioArgs.xhr;
		if(_d._isDocumentOk(xhr)){
			dfd.callback(dfd);
		}else{
			var err = new Error(""Unable to load "" + dfd.ioArgs.url + "" status:"" + xhr.status);
			err.status = xhr.status;
			err.responseText = xhr.responseText;
			dfd.errback(err);
		}
	}

	dojo._ioAddQueryToUrl = function(/*dojo.__IoCallbackArgs*/ioArgs){
		//summary: Adds query params discovered by the io deferred construction to the URL.
		//Only use this for operations which are fundamentally GET-type operations.
		if(ioArgs.query.length){
			ioArgs.url += (ioArgs.url.indexOf(""?"") == -1 ? ""?"" : ""&"") + ioArgs.query;
			ioArgs.query = null;
		}		
	}

	/*=====
	dojo.declare(""dojo.__XhrArgs"", dojo.__IoArgs, {
		constructor: function(){
			//	summary:
			//		In addition to the properties listed for the dojo._IoArgs type,
			//		the following properties are allowed for dojo.xhr* methods.
			//	handleAs: String?
			//		Acceptable values are: text (default), json, json-comment-optional,
			//		json-comment-filtered, javascript, xml
			//	sync: Boolean?
			//		false is default. Indicates whether the request should
			//		be a synchronous (blocking) request.
			//	headers: Object?
			//		Additional HTTP headers to send in the request.
			this.handleAs = handleAs;
			this.sync = sync;
			this.headers = headers;
		}
	});
	=====*/

	dojo.xhr = function(/*String*/ method, /*dojo.__XhrArgs*/ args, /*Boolean?*/ hasBody){
		//	summary:
		//		Sends an HTTP request with the given method.
		//	description:
		//		Sends an HTTP request with the given method.
		//		See also dojo.xhrGet(), xhrPost(), xhrPut() and dojo.xhrDelete() for shortcuts
		//		for those HTTP methods. There are also methods for ""raw"" PUT and POST methods
		//		via dojo.rawXhrPut() and dojo.rawXhrPost() respectively.
		//	method:
		//		HTTP method to be used, such as GET, POST, PUT, DELETE.  Should be uppercase.
		//	hasBody:
		//		If the request has an HTTP body, then pass true for hasBody.

		//Make the Deferred object for this xhr request.
		var dfd = _d._ioSetArgs(args, _deferredCancel, _deferredOk, _deferError);

		//Pass the args to _xhrObj, to allow xhr iframe proxy interceptions.
		dfd.ioArgs.xhr = _d._xhrObj(dfd.ioArgs.args);

		if(hasBody){
			if(""postData"" in args){
				dfd.ioArgs.query = args.postData;
			}else if(""putData"" in args){
				dfd.ioArgs.query = args.putData;
			}
		}else{
			_d._ioAddQueryToUrl(dfd.ioArgs);
		}

		// IE 6 is a steaming pile. It won't let you call apply() on the native function (xhr.open).
		// workaround for IE6's apply() ""issues""
		var ioArgs = dfd.ioArgs;
		var xhr = ioArgs.xhr;
		xhr.open(method, ioArgs.url, args.sync !== true, args.user || undefined, args.password || undefined);
		if(args.headers){
			for(var hdr in args.headers){
				if(hdr.toLowerCase() === ""content-type"" && !args.contentType){
					args.contentType = args.headers[hdr];
				}else{
					xhr.setRequestHeader(hdr, args.headers[hdr]);
				}
			}
		}
		// FIXME: is this appropriate for all content types?
		xhr.setRequestHeader(""Content-Type"", args.contentType || _defaultContentType);
		if(!args.headers || !args.headers[""X-Requested-With""]){
			xhr.setRequestHeader(""X-Requested-With"", ""XMLHttpRequest"");
		}
		// FIXME: set other headers here!
		if(dojo.config.isDebug){
			xhr.send(ioArgs.query);
		}else{
			try{
				xhr.send(ioArgs.query);
			}catch(e){
				dfd.ioArgs.error = e;
				dfd.cancel();
			}
		}
		_d._ioWatch(dfd, _validCheck, _ioCheck, _resHandle);
		xhr = null;
		return dfd; // dojo.Deferred
	}

	dojo.xhrGet = function(/*dojo.__XhrArgs*/ args){
		//	summary: 
		//		Sends an HTTP GET request to the server.
		return _d.xhr(""GET"", args); // dojo.Deferred
	}

	dojo.rawXhrPost = dojo.xhrPost = function(/*dojo.__XhrArgs*/ args){
		//	summary:
		//		Sends an HTTP POST request to the server. In addtion to the properties
		//		listed for the dojo.__XhrArgs type, the following property is allowed:
		//	postData:
		//		String. Send raw data in the body of the POST request.
		return _d.xhr(""POST"", args, true); // dojo.Deferred
	}

	dojo.rawXhrPut = dojo.xhrPut = function(/*dojo.__XhrArgs*/ args){
		//	summary:
		//		Sends an HTTP PUT request to the server. In addtion to the properties
		//		listed for the dojo.__XhrArgs type, the following property is allowed:
		//	putData:
		//		String. Send raw data in the body of the PUT request.
		return _d.xhr(""PUT"", args, true); // dojo.Deferred
	}

	dojo.xhrDelete = function(/*dojo.__XhrArgs*/ args){
		//	summary:
		//		Sends an HTTP DELETE request to the server.
		return _d.xhr(""DELETE"", args); //dojo.Deferred
	}

	/*
	dojo.wrapForm = function(formNode){
		//summary:
		//		A replacement for FormBind, but not implemented yet.

		// FIXME: need to think harder about what extensions to this we might
		// want. What should we allow folks to do w/ this? What events to
		// set/send?
		throw new Error(""dojo.wrapForm not yet implemented"");
	}
	*/
})();

}

if(!dojo._hasResource[""dojo._base.fx""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.fx""] = true;
dojo.provide(""dojo._base.fx"");






/*
	Animation losely package based on Dan Pupius' work, contributed under CLA: 
		http://pupius.co.uk/js/Toolkit.Drawing.js
*/
(function(){ 

	var d = dojo;
	
	dojo._Line = function(/*int*/ start, /*int*/ end){
		//	summary:
		//		dojo._Line is the object used to generate values from a start value
		//		to an end value
		//	start: int
		//		Beginning value for range
		//	end: int
		//		Ending value for range
		this.start = start;
		this.end = end;
		this.getValue = function(/*float*/ n){
			//	summary: returns the point on the line
			//	n: a floating point number greater than 0 and less than 1
			return ((this.end - this.start) * n) + this.start; // Decimal
		}
	}
	
	d.declare(""dojo._Animation"", null, {
		//	summary
		//		A generic animation class that fires callbacks into its handlers
		//		object at various states. Nearly all dojo animation functions
		//		return an instance of this method, usually without calling the
		//		.play() method beforehand. Therefore, you will likely need to
		//		call .play() on instances of dojo._Animation when one is
		//		returned.
		constructor: function(/*Object*/ args){
			d.mixin(this, args);
			if(d.isArray(this.curve)){
				/* curve: Array
					pId: a */
				this.curve = new d._Line(this.curve[0], this.curve[1]);
			}
		},
		
		// duration: Integer
		//	The time in milliseonds the animation will take to run
		duration: 350,
	
	/*=====
		// curve: dojo._Line||Array
		//	A two element array of start and end values, or a dojo._Line instance to be
		//	used in the Animation. 
		curve: null,
	
		// easing: Function
		//	A Function to adjust the acceleration (or deceleration) of the progress 
		//	across a dojo._Line
		easing: null,
	=====*/
	
		// repeat: Integer
		//	The number of times to loop the animation
		repeat: 0,
	
		// rate: Integer
		//	the time in milliseconds to wait before advancing to next frame 
		//	(used as a fps timer: rate/1000 = fps)
		rate: 10 /* 100 fps */,
	
	/*===== 
		// delay: Integer
		// 	The time in milliseconds to wait before starting animation after it has been .play()'ed
		delay: null,
	
		// events
		//
		// beforeBegin: Event
		//	Synthetic event fired before a dojo._Animation begins playing (synchronous)
		beforeBegin: null,
	
		// onBegin: Event
		//	Synthetic event fired as a dojo._Animation begins playing (useful?)
		onBegin: null,
	
		// onAnimate: Event
		//	Synthetic event fired at each interval of a dojo._Animation
		onAnimate: null,
	
		// onEnd: Event
		//	Synthetic event fired after the final frame of a dojo._Animation
		onEnd: null,
	
		// onPlay: Event
		//	Synthetic event fired any time a dojo._Animation is play()'ed
		onPlay: null,
	
		// onPause: Event
		//	Synthetic event fired when a dojo._Animation is paused
		onPause: null,
	
		// onStop: Event
		//	Synthetic event fires when a dojo._Animation is stopped
		onStop: null,
	
	=====*/
	
		_percent: 0,
		_startRepeatCount: 0,
	
		_fire: function(/*Event*/ evt, /*Array?*/ args){
			//	summary:
			//		Convenience function.  Fire event ""evt"" and pass it the
			//		arguments specified in ""args"".
			//	evt:
			//		The event to fire.
			//	args:
			//		The arguments to pass to the event.
			if(this[evt]){
				if(dojo.config.isDebug){
					this[evt].apply(this, args||[]);
				}else{
					try{
						this[evt].apply(this, args||[]);
					}catch(e){
						// squelch and log because we shouldn't allow exceptions in
						// synthetic event handlers to cause the internal timer to run
						// amuck, potentially pegging the CPU. I'm not a fan of this
						// squelch, but hopefully logging will make it clear what's
						// going on
						console.error(""exception in animation handler for:"", evt);
						console.error(e);
					}
				}
			}
			return this; // dojo._Animation
		},

		play: function(/*int?*/ delay, /*Boolean?*/ gotoStart){
			// summary:
			//		Start the animation.
			// delay:
			//		How many milliseconds to delay before starting.
			// gotoStart:
			//		If true, starts the animation from the beginning; otherwise,
			//		starts it from its current position.
			var _t = this;
			if(gotoStart){
				_t._stopTimer();
				_t._active = _t._paused = false;
				_t._percent = 0;
			}else if(_t._active && !_t._paused){
				return _t; // dojo._Animation
			}
	
			_t._fire(""beforeBegin"");
	
			var de = delay||_t.delay;
			var _p = dojo.hitch(_t, ""_play"", gotoStart);
			if(de > 0){
				setTimeout(_p, de);
				return _t; // dojo._Animation
			}
			_p();
			return _t;
		},
	
		_play: function(gotoStart){
			var _t = this;
			_t._startTime = new Date().valueOf();
			if(_t._paused){
				_t._startTime -= _t.duration * _t._percent;
			}
			_t._endTime = _t._startTime + _t.duration;
	
			_t._active = true;
			_t._paused = false;
	
			var value = _t.curve.getValue(_t._percent);
			if(!_t._percent){
				if(!_t._startRepeatCount){
					_t._startRepeatCount = _t.repeat;
				}
				_t._fire(""onBegin"", [value]);
			}
	
			_t._fire(""onPlay"", [value]);
	
			_t._cycle();
			return _t; // dojo._Animation
		},
	
		pause: function(){
			// summary: Pauses a running animation.
			this._stopTimer();
			if(!this._active){ return this; /*dojo._Animation*/ }
			this._paused = true;
			this._fire(""onPause"", [this.curve.getValue(this._percent)]);
			return this; // dojo._Animation
		},
	
		gotoPercent: function(/*Decimal*/ percent, /*Boolean?*/ andPlay){
			//	summary:
			//		Sets the progress of the animation.
			//	percent:
			//		A percentage in decimal notation (between and including 0.0 and 1.0).
			//	andPlay:
			//		If true, play the animation after setting the progress.
			this._stopTimer();
			this._active = this._paused = true;
			this._percent = percent;
			if(andPlay){ this.play(); }
			return this; // dojo._Animation
		},
	
		stop: function(/*boolean?*/ gotoEnd){
			// summary: Stops a running animation.
			// gotoEnd: If true, the animation will end.
			if(!this._timer){ return this; /* dojo._Animation */ }
			this._stopTimer();
			if(gotoEnd){
				this._percent = 1;
			}
			this._fire(""onStop"", [this.curve.getValue(this._percent)]);
			this._active = this._paused = false;
			return this; // dojo._Animation
		},
	
		status: function(){
			// summary: Returns a string token representation of the status of
			//			the animation, one of: ""paused"", ""playing"", ""stopped""
			if(this._active){
				return this._paused ? ""paused"" : ""playing""; // String
			}
			return ""stopped""; // String
		},
	
		_cycle: function(){
			var _t = this;
			if(_t._active){
				var curr = new Date().valueOf();
				var step = (curr - _t._startTime) / (_t._endTime - _t._startTime);
	
				if(step >= 1){
					step = 1;
				}
				_t._percent = step;
	
				// Perform easing
				if(_t.easing){
					step = _t.easing(step);
				}
	
				_t._fire(""onAnimate"", [_t.curve.getValue(step)]);
	
				if(_t._percent < 1){
					_t._startTimer();
				}else{
					_t._active = false;
	
					if(_t.repeat > 0){
						_t.repeat--;
						_t.play(null, true);
					}else if(_t.repeat == -1){
						_t.play(null, true);
					}else{
						if(_t._startRepeatCount){
							_t.repeat = _t._startRepeatCount;
							_t._startRepeatCount = 0;
						}
					}
					_t._percent = 0;
					_t._fire(""onEnd"");
					_t._stopTimer();
				}
			}
			return _t; // dojo._Animation
		}
	});

	var ctr = 0;
	var _globalTimerList = [];
	var runner = {
		run: function(){ }
	};
	var timer = null;
	dojo._Animation.prototype._startTimer = function(){
		// this._timer = setTimeout(dojo.hitch(this, ""_cycle""), this.rate);
		if(!this._timer){
			this._timer = d.connect(runner, ""run"", this, ""_cycle"");
			ctr++;
		}
		if(!timer){
			timer = setInterval(d.hitch(runner, ""run""), this.rate);
		}
	};

	dojo._Animation.prototype._stopTimer = function(){
		if(this._timer){
			d.disconnect(this._timer);
			this._timer = null;
			ctr--;
		}
		if(ctr <= 0){
			clearInterval(timer);
			timer = null;
			ctr = 0;
		}
	};

	var _makeFadeable = (d.isIE) ? function(node){
		// only set the zoom if the ""tickle"" value would be the same as the
		// default
		var ns = node.style;
		// don't set the width to auto if it didn't already cascade that way.
		// We don't want to f anyones designs
		if(!ns.width.length && d.style(node, ""width"") == ""auto""){
			ns.width = ""auto"";
		}
	} : function(){};

	dojo._fade = function(/*Object*/ args){
		//	summary: 
		//		Returns an animation that will fade the node defined by
		//		args.node from the start to end values passed (args.start
		//		args.end) (end is mandatory, start is optional)

		args.node = d.byId(args.node);
		var fArgs = d.mixin({ properties: {} }, args);
		var props = (fArgs.properties.opacity = {});
		props.start = !(""start"" in fArgs) ?
			function(){ 
				return Number(d.style(fArgs.node, ""opacity"")); 
			} : fArgs.start;
		props.end = fArgs.end;

		var anim = d.animateProperty(fArgs);
		d.connect(anim, ""beforeBegin"", d.partial(_makeFadeable, fArgs.node));

		return anim; // dojo._Animation
	}

	/*=====
	dojo.__FadeArgs = function(node, duration, easing){
		// 	node: DOMNode|String
		//		The node referenced in the animation
		//	duration: Integer?
		//		Duration of the animation in milliseconds.
		//	easing: Function?
		//		An easing function.
		this.node = node;
		this.duration = duration;
		this.easing = easing;
	}
	=====*/

	dojo.fadeIn = function(/*dojo.__FadeArgs*/ args){
		// summary: 
		//		Returns an animation that will fade node defined in 'args' from
		//		its current opacity to fully opaque.
		return d._fade(d.mixin({ end: 1 }, args)); // dojo._Animation
	}

	dojo.fadeOut = function(/*dojo.__FadeArgs*/  args){
		// summary: 
		//		Returns an animation that will fade node defined in 'args'
		//		from its current opacity to fully transparent.
		return d._fade(d.mixin({ end: 0 }, args)); // dojo._Animation
	}

	dojo._defaultEasing = function(/*Decimal?*/ n){
		// summary: The default easing function for dojo._Animation(s)
		return 0.5 + ((Math.sin((n + 1.5) * Math.PI))/2);
	}

	var PropLine = function(properties){
		// PropLine is an internal class which is used to model the values of
		// an a group of CSS properties across an animation lifecycle. In
		// particular, the ""getValue"" function handles getting interpolated
		// values between start and end for a particular CSS value.
		this._properties = properties;
		for(var p in properties){
			var prop = properties[p];
			if(prop.start instanceof d.Color){
				// create a reusable temp color object to keep intermediate results
				prop.tempColor = new d.Color();
			}
		}
		this.getValue = function(r){
			var ret = {};
			for(var p in this._properties){
				var prop = this._properties[p];
				var start = prop.start;
				if(start instanceof d.Color){
					ret[p] = d.blendColors(start, prop.end, r, prop.tempColor).toCss();
				}else if(!d.isArray(start)){
					ret[p] = ((prop.end - start) * r) + start + (p != ""opacity"" ? prop.units||""px"" : """");
				}
			}
			return ret;
		}
	}

	/*=====
	dojo.declare(""dojo.__AnimArgs"", [dojo.__FadeArgs], {
		// Properties: Object?
		//	A hash map of style properties to Objects describing the transition,
		//	such as the properties of dojo._Line with an additional 'unit' property
		properties: {}
		
		//TODOC: add event callbacks
	});
	=====*/

	dojo.animateProperty = function(/*dojo.__AnimArgs*/ args){
		//	summary: 
		//		Returns an animation that will transition the properties of
		//		node defined in 'args' depending how they are defined in
		//		'args.properties'
		//
		// description:
		//		dojo.animateProperty is the foundation of most dojo.fx
		//		animations. It takes an object of ""properties"" corresponding to
		//		style properties, and animates them in parallel over a set
		//		duration.
		//	
		// 	example:
		//		A simple animation that changes the width of the specified node.
		//	|	dojo.animateProperty({ 
		//	|		node: ""nodeId"",
		//	|		properties: { width: 400 },
		//	|	}).play();
		//		Dojo figures out the start value for the width and converts the
		//		integer specified for the width to the more expressive but
		//		verbose form `{ width: { end: '400', units: 'px' } }` which you
		//		can also specify directly
		//
		// 	example:
		//		Animate width, height, and padding over 2 seconds... the
		//		pedantic way:
		//	|	dojo.animateProperty({ node: node, duration:2000,
		//	|		properties: {
		//	|			width: { start: '200', end: '400', unit:""px"" },
		//	|			height: { start:'200', end: '400', unit:""px"" },
		//	|			paddingTop: { start:'5', end:'50', unit:""px"" } 
		//	|		}
		//	|	}).play();
		//		Note 'paddingTop' is used over 'padding-top'. Multi-name CSS properties
		//		are written using ""mixed case"", as the hyphen is illegal as an object key.
		//		
		// 	example:
		//		Plug in a different easing function and register a callback for
		//		when the animation ends. Easing functions accept values between
		//		zero and one and return a value on that basis. In this case, an
		//		exponential-in curve.
		//	|	dojo.animateProperty({ 
		//	|		node: ""nodeId"",
		//	|		// dojo figures out the start value
		//	|		properties: { width: { end: 400 } },
		//	|		easing: function(n){
		//	|			return (n==0) ? 0 : Math.pow(2, 10 * (n - 1));
		//	|		},
		//	|		onEnd: function(){
		//	|			// called when the animation finishes
		//	|		}
		//	|	}).play(500); // delay playing half a second
		//
		//	example:
		//		Like all `dojo._Animation`s, animateProperty returns a handle to the
		//		Animation instance, which fires the events common to Dojo FX. Use `dojo.connect`
		//		to access these events outside of the Animation definiton:
		//	|	var anim = dojo.animateProperty({
		//	|		node:""someId"",
		//	|		properties:{
		//	|			width:400, height:500
		//	|		}
		//	|	});
		//	|	dojo.connect(anim,""onEnd"", function(){
		//	|		
		//	|	});
		//	|	// play the animation now:
		//	|	anim.play();
		
		args.node = d.byId(args.node);
		if(!args.easing){ args.easing = d._defaultEasing; }

		var anim = new d._Animation(args);
		d.connect(anim, ""beforeBegin"", anim, function(){
			var pm = {};
			for(var p in this.properties){
				// Make shallow copy of properties into pm because we overwrite
				// some values below. In particular if start/end are functions
				// we don't want to overwrite them or the functions won't be
				// called if the animation is reused.
				if(p == ""width"" || p == ""height""){
					this.node.display = ""block"";
				}
				var prop = this.properties[p];
				prop = pm[p] = d.mixin({}, (d.isObject(prop) ? prop: { end: prop }));

				if(d.isFunction(prop.start)){
					prop.start = prop.start();
				}
				if(d.isFunction(prop.end)){
					prop.end = prop.end();
				}
				var isColor = (p.toLowerCase().indexOf(""color"") >= 0);
				function getStyle(node, p){
					// dojo.style(node, ""height"") can return ""auto"" or """" on IE; this is more reliable:
					var v = ({height: node.offsetHeight, width: node.offsetWidth})[p];
					if(v !== undefined){ return v; }
					v = d.style(node, p);
					return (p==""opacity"") ? Number(v) : (isColor ? v : parseFloat(v));
				}
				if(!(""end"" in prop)){
					prop.end = getStyle(this.node, p);
				}else if(!(""start"" in prop)){
					prop.start = getStyle(this.node, p);
				}

				if(isColor){
					prop.start = new d.Color(prop.start);
					prop.end = new d.Color(prop.end);
				}else{
					prop.start = (p == ""opacity"") ? Number(prop.start) : parseFloat(prop.start);
				}
			}
			this.curve = new PropLine(pm);
		});
		d.connect(anim, ""onAnimate"", d.hitch(d, ""style"", anim.node));
		return anim; // dojo._Animation
	}

	dojo.anim = function(	/*DOMNode|String*/ 	node, 
							/*Object*/ 			properties, 
							/*Integer?*/		duration, 
							/*Function?*/		easing, 
							/*Function?*/		onEnd,
							/*Integer?*/		delay){
		//	summary:
		//		A simpler interface to `dojo.animateProperty()`, also returns
		//		an instance of `dojo._Animation` but begins the animation
		//		immediately, unlike nearly every other Dojo animation API.
		//	description:
		//		`dojo.anim` is a simpler (but somewhat less powerful) version
		//		of `dojo.animateProperty`.  It uses defaults for many basic properties
		//		and allows for positional parameters to be used in place of the
		//		packed ""property bag"" which is used for other Dojo animation
		//		methods.
		//
		//		The `dojo._Animation` object returned from `dojo.anim` will be
		//		already playing when it is returned from this function, so
		//		calling play() on it again is (usually) a no-op.
		//	node:
		//		a DOM node or the id of a node to animate CSS properties on
		//	duration:
		//		The number of milliseconds over which the animation
		//		should run. Defaults to the global animation default duration
		//		(350ms).
		//	easing:
		//		An easing function over which to calculate acceleration
		//		and deceleration of the animation through its duration.
		//		A default easing algorithm is provided, but you may
		//		plug in any you wish. A large selection of easing algorithms
		//		are available in `dojo.fx.easing`.
		//	onEnd:
		//		A function to be called when the animation finishes
		//		running.
		//	delay:
		//		The number of milliseconds to delay beginning the
		//		animation by. The default is 0.
		//	example:
		//		Fade out a node
		//	|	dojo.anim(""id"", { opacity: 0 });
		//	example:
		//		Fade out a node over a full second
		//	|	dojo.anim(""id"", { opacity: 0 }, 1000);
		return d.animateProperty({ 
			node: node,
			duration: duration||d._Animation.prototype.duration,
			properties: properties,
			easing: easing,
			onEnd: onEnd 
		}).play(delay||0);
	}
})();

}

if(!dojo._hasResource[""dojo._base.browser""]){ //_hasResource checks added by build. Do not use _hasResource directly in your code.
dojo._hasResource[""dojo._base.browser""] = true;
dojo.provide(""dojo._base.browser"");









//Need this to be the last code segment in base, so do not place any
//dojo.requireIf calls in this file. Otherwise, due to how the build system
//puts all requireIf dependencies after the current file, the require calls
//could be called before all of base is defined.
if(dojo.config.require){
	dojo.forEach(dojo.config.require, ""dojo['require'](item);"");
}

}

	//INSERT dojo.i18n._preloadLocalizations HERE

	if(dojo.config.afterOnLoad && dojo.isBrowser){
		//Dojo is being added to the page after page load, so just trigger
		//the init sequence after a timeout. Using a timeout so the rest of this
		//script gets evaluated properly. This work needs to happen after the
		//dojo.config.require work done in dojo._base.
		window.setTimeout(dojo._fakeLoadInit, 1000);
	}

})();

",False,
19,19,NomosTestfiles/AFL/LICENSE,AFL-3.0,"Most of MASON is licensed under the Academic Free License, version 3.0,
with the exception of the following files:

	PngEncoder.java			Artistic License
	MovieEncoder.java		[Partial] Sun Open Source License
	WireFrameBoxPortrayal3D.java	[Partial] Sun Open Source License
	ToolTipBehavior.java		[Partial] Sun Open Source License
	SelectionBehavior.java		[Partial] Sun Open Source License
	GullCG.java			Sun Open Source License
	MersenneTwisterFast.java	BSD License

For all remaining files, the Academic Free License is specified below.


Academic Free License (""AFL"") v. 3.0

This Academic Free License (the ""License"") applies to any original work
of authorship (the ""Original Work"") whose owner (the ""Licensor"") has
placed the following licensing notice adjacent to the copyright notice
for the Original Work:

Licensed under the Academic Free License version 3.0

1) Grant of Copyright License. Licensor grants You a worldwide,
royalty-free, non-exclusive, sublicensable license, for the duration of
the copyright, to do the following:

	a) to reproduce the Original Work in copies, either alone or as
	   part of a collective work;

	b) to translate, adapt, alter, transform, modify, or arrange the
	   Original Work, thereby creating derivative works (""Derivative
	   Works"") based upon the Original Work;

	c) to distribute or communicate copies of the Original Work and
	   Derivative Works to the public, UNDER ANY LICENSE OF YOUR
	   CHOICE THAT DOES NOT CONTRADICT THE TERMS AND CONDITIONS,
	   INCLUDING LICENSOR'S RESERVED RIGHTS AND REMEDIES, IN THIS
	   ACADEMIC FREE LICENSE;

	d) to perform the Original Work publicly; and

	e) to display the Original Work publicly.

2) Grant of Patent License. Licensor grants You a worldwide,
royalty-free, non-exclusive, sublicensable license, under patent claims
owned or controlled by the Licensor that are embodied in the Original
Work as furnished by the Licensor, for the duration of the patents, to
make, use, sell, offer for sale, have made, and import the Original Work
and Derivative Works.

3) Grant of Source Code License. The term ""Source Code"" means the
preferred form of the Original Work for making modifications to it and
all available documentation describing how to modify the Original Work.
Licensor agrees to provide a machine-readable copy of the Source Code of
the Original Work along with each copy of the Original Work that
Licensor distributes. Licensor reserves the right to satisfy this
obligation by placing a machine-readable copy of the Source Code in an
information repository reasonably calculated to permit inexpensive and
convenient access by You for as long as Licensor continues to distribute
the Original Work.

4) Exclusions From License Grant. Neither the names of Licensor, nor the
names of any contributors to the Original Work, nor any of their
trademarks or service marks, may be used to endorse or promote products
derived from this Original Work without express prior permission of the
Licensor. Except as expressly stated herein, nothing in this License
grants any license to Licensor's trademarks, copyrights, patents, trade
secrets or any other intellectual property. No patent license is granted
to make, use, sell, offer for sale, have made, or import embodiments of
any patent claims other than the licensed claims defined in Section 2.
No license is granted to the trademarks of Licensor even if such marks
are included in the Original Work. Nothing in this License shall be
interpreted to prohibit Licensor from licensing under terms different
from this License any Original Work that Licensor otherwise would have a
right to license.

5) External Deployment. The term ""External Deployment"" means the use,
distribution, or communication of the Original Work or Derivative Works
in any way such that the Original Work or Derivative Works may be used
by anyone other than You, whether those works are distributed or
communicated to those persons or made available as an application
intended for use over a network. As an express condition for the grants
of license hereunder, You must treat any External Deployment by You of
the Original Work or a Derivative Work as a distribution under section
1(c).

6) Attribution Rights. You must retain, in the Source Code of any
Derivative Works that You create, all copyright, patent, or trademark
notices from the Source Code of the Original Work, as well as any
notices of licensing and any descriptive text identified therein as an
""Attribution Notice."" You must cause the Source Code for any Derivative
Works that You create to carry a prominent Attribution Notice reasonably
calculated to inform recipients that You have modified the Original
Work.

7) Warranty of Provenance and Disclaimer of Warranty. Licensor warrants
that the copyright in and to the Original Work and the patent rights
granted herein by Licensor are owned by the Licensor or are sublicensed
to You under the terms of this License with the permission of the
contributor(s) of those copyrights and patent rights. Except as
expressly stated in the immediately preceding sentence, the Original
Work is provided under this License on an ""AS IS"" BASIS and WITHOUT
WARRANTY, either express or implied, including, without limitation, the
warranties of non-infringement, merchantability or fitness for a
particular purpose. THE ENTIRE RISK AS TO THE QUALITY OF THE ORIGINAL
WORK IS WITH YOU. This DISCLAIMER OF WARRANTY constitutes an essential
part of this License. No license to the Original Work is granted by this
License except under this disclaimer.

8) Limitation of Liability. Under no circumstances and under no legal
theory, whether in tort (including negligence), contract, or otherwise,
shall the Licensor be liable to anyone for any indirect, special,
incidental, or consequential damages of any character arising as a
result of this License or the use of the Original Work including,
without limitation, damages for loss of goodwill, work stoppage,
computer failure or malfunction, or any and all other commercial damages
or losses. This limitation of liability shall not apply to the extent
applicable law prohibits such limitation.

9) Acceptance and Termination. If, at any time, You expressly assented
to this License, that assent indicates your clear and irrevocable
acceptance of this License and all of its terms and conditions. If You
distribute or communicate copies of the Original Work or a Derivative
Work, You must make a reasonable effort under the circumstances to
obtain the express assent of recipients to the terms of this License.
This License conditions your rights to undertake the activities listed
in Section 1, including your right to create Derivative Works based upon
the Original Work, and doing so without honoring these terms and
conditions is prohibited by copyright law and international treaty.
Nothing in this License is intended to affect copyright exceptions and
limitations (including ""fair use"" or ""fair dealing""). This License shall
terminate immediately and You may no longer exercise any of the rights
granted to You by this License upon your failure to honor the conditions
in Section 1(c).

10) Termination for Patent Action. This License shall terminate
automatically and You may no longer exercise any of the rights granted
to You by this License as of the date You commence an action, including
a cross-claim or counterclaim, against Licensor or any licensee alleging
that the Original Work infringes a patent. This termination provision
shall not apply for an action alleging patent infringement by
combinations of the Original Work with other software or hardware.

11) Jurisdiction, Venue and Governing Law. Any action or suit relating
to this License may be brought only in the courts of a jurisdiction
wherein the Licensor resides or in which Licensor conducts its primary
business, and under the laws of that jurisdiction excluding its
conflict-of-law provisions. The application of the United Nations
Convention on Contracts for the International Sale of Goods is expressly
excluded. Any use of the Original Work outside the scope of this License
or after its termination shall be subject to the requirements and
penalties of copyright or patent law in the appropriate jurisdiction.
This section shall survive the termination of this License.

12) Attorneys' Fees. In any action to enforce the terms of this License
or seeking damages relating thereto, the prevailing party shall be
entitled to recover its costs and expenses, including, without
limitation, reasonable attorneys' fees and costs incurred in connection
with such action, including any appeal of such action. This section
shall survive the termination of this License.

13) Miscellaneous. If any provision of this License is held to be
unenforceable, such provision shall be reformed only to the extent
necessary to make it enforceable.

14) Definition of ""You"" in This License. ""You"" throughout this License,
whether in upper or lower case, means an individual or a legal entity
exercising rights under, and complying with all of the terms of, this
License. For legal entities, ""You"" includes any entity that controls, is
controlled by, or is under common control with you. For purposes of this
definition, ""control"" means (i) the power, direct or indirect, to cause
the direction or management of such entity, whether by contract or
otherwise, or (ii) ownership of fifty percent (50%) or more of the
outstanding shares, or (iii) beneficial ownership of such entity.

15) Right to Use. You may use the Original Work in all ways not
otherwise restricted or conditioned by this License or by law, and
Licensor promises not to interfere with or be responsible for such uses
by You.

16) Modification of This License. This License is Copyright (c) 2005
Lawrence Rosen. Permission is granted to copy, distribute, or
communicate this License without modification. Nothing in this License
permits You to modify this License as applied to the Original Work or to
Derivative Works. However, You may modify the text of this License and
copy, distribute or communicate your modified version (the ""Modified
License"") and apply it to other original works of authorship subject to
the following conditions: (i) You may not indicate in any way that your
Modified License is the ""Academic Free License"" or ""AFL"" and you may not
use those names in the name of your Modified License; (ii) You must
replace the notice specified in the first paragraph above with the
notice ""Licensed under <insert your license name here>"" or with a notice
of your own that is not confusingly similar to the notice in this
License; and (iii) You may not claim that your original works are open
source software unless your Modified License has been approved by Open
Source Initiative (OSI) and You comply with its license review and
certification process.


",False,"```
Academic Free License (""AFL"") v. 3.0

This Academic Free License (the ""License"") applies to any original work
of authorship (the ""Original Work"") whose owner (the ""Licensor"") has
placed the following licensing notice adjacent to the copyright notice
for the Original Work:

Licensed under the Academic Free License version 3.0

1) Grant of Copyright License. Licensor grants You a worldwide,
royalty-free, non-exclusive, sublicensable license, for the duration of
the copyright, to do the following:

	a) to reproduce the Original Work in copies, either alone or as
	   part of a collective work;

	b) to translate, adapt, alter, transform, modify, or arrange the
	   Original Work, thereby creating derivative works (""Derivative
	   Works"") based upon the Original Work;

	c) to distribute or communicate copies of the Original Work and
	   Derivative Works to the public, UNDER ANY LICENSE OF YOUR
	   CHOICE THAT DOES NOT CONTRADICT THE TERMS AND CONDITIONS,
	   INCLUDING LICENSOR'S RESERVED RIGHTS AND REMEDIES, IN THIS
	   ACADEMIC FREE LICENSE;

	d) to perform the Original Work publicly; and

	e) to display the Original Work publicly.

2) Grant of Patent License. Licensor grants You a worldwide,
royalty-free, non-exclusive, sublicensable license, under patent claims
owned or controlled by the Licensor that are embodied in the Original
Work as furnished by the Licensor, for the duration of the patents, to
make, use, sell, offer for sale, have made, and import the Original Work
and Derivative Works.

3) Grant of Source Code License. The term ""Source Code"" means the
preferred form of the Original Work for making modifications to it and
all available documentation describing how to modify the Original Work.
Licensor agrees to provide a machine-readable copy of the Source Code of
the Original Work along with each copy of the Original Work that
Licensor distributes. Licensor reserves the right to satisfy this
obligation by placing a machine-readable copy of the Source Code in an
information repository reasonably calculated to permit inexpensive and
convenient access by You for as long as Licensor continues to distribute
the Original Work.

4) Exclusions From License Grant. Neither the names of Licensor, nor the
names of any contributors to the Original Work, nor any of their
trademarks or service marks, may be used to endorse or promote products
derived from this Original Work without express prior permission of the
Licensor. Except as expressly stated herein, nothing in this License
grants any license to Licensor's trademarks, copyrights, patents, trade
secrets or any other intellectual property. No patent license is granted
to make, use, sell, offer for sale, have made, or import embodiments of
any patent claims other than the licensed claims defined in Section 2.
No license is granted to the trademarks of Licensor even if such marks
are included in the Original Work. Nothing in this License shall be
interpreted to prohibit Licensor from licensing under terms different
from this License any Original Work that Licensor otherwise would have a
right to license.

5) External Deployment. The term ""External Deployment"" means the use,
distribution, or communication of the Original Work or Derivative Works
in any way such that the Original Work or Derivative Works may be used
by anyone other than You, whether those works are distributed or
communicated to those persons or made available as an application
intended for use over a network. As an express condition for the grants
of license hereunder, You must treat any External Deployment by You of
the Original Work or a Derivative Work as a distribution under section
1(c).

6) Attribution Rights. You must retain, in the Source Code of any
Derivative Works that You create, all copyright, patent, or trademark
notices from the Source Code of the Original Work, as well as any
notices of licensing and any descriptive text identified therein as an
""Attribution Notice."" You must cause the Source Code for any Derivative
Works that You create to carry a prominent Attribution Notice reasonably
calculated to inform recipients that You have modified the Original
Work.

7) Warranty of Provenance and Disclaimer of Warranty. Licensor warrants
that the copyright in and to the Original Work and the patent rights
granted herein by Licensor are owned by the Licensor or are sublicensed
to You under the terms of this License with the permission of the
contributor(s) of those copyrights and patent rights. Except as
expressly stated in the immediately preceding sentence, the Original
Work is provided under this License on an ""AS IS"" BASIS and WITHOUT
WARRANTY, either express or implied, including, without limitation, the
warranties of non-infringement, merchantability or fitness for a
particular purpose. THE ENTIRE RISK AS TO THE QUALITY OF THE ORIGINAL
WORK IS WITH YOU. This DISCLAIMER OF WARRANTY constitutes an essential
part of this License. No license to the Original Work is granted by this
License except under this disclaimer.

8) Limitation of Liability. Under no circumstances and under no legal
theory, whether in tort (including negligence), contract, or otherwise,
shall the Licensor be liable to anyone for any indirect, special,
incidental, or consequential damages of any character arising as a
result of this License or the use of the Original Work including,
without limitation, damages for loss of goodwill, work stoppage,
computer failure or malfunction, or any and all other commercial damages
or losses. This limitation of liability shall not apply to the extent
applicable law prohibits such limitation.

9) Acceptance and Termination. If, at any time, You expressly assented
to this License, that assent indicates your clear and irrevocable
acceptance of this License and all of its terms and conditions. If You
distribute or communicate copies of the Original Work or a Derivative
Work, You must make a reasonable effort under the circumstances to
obtain the express assent of recipients to the terms of this License.
This License conditions your rights to undertake the activities listed
in Section 1, including your right to create Derivative Works based upon
the Original Work, and doing so without honoring these terms and
conditions is prohibited by copyright law and international treaty.
Nothing in this License is intended to affect copyright exceptions and
limitations (including ""fair use"" or ""fair dealing""). This License shall
terminate immediately and You may no longer exercise any of the rights
granted to You by this License upon your failure to honor the conditions
in Section 1(c).

10) Termination for Patent Action. This License shall terminate
automatically and You may no longer exercise any of the rights granted
to You by this License as of the date You commence an action, including
a cross-claim or counterclaim, against Licensor or any licensee alleging
that the Original Work infringes a patent. This termination provision
shall not apply for an action alleging patent infringement by
combinations of the Original Work with other software or hardware.

11) Jurisdiction, Venue and Governing Law. Any action or suit relating
to this License may be brought only in the courts of a jurisdiction
wherein the Licensor resides or in which Licensor conducts its primary
business, and under the laws of that jurisdiction excluding its
conflict-of-law provisions. The application of the United Nations
Convention on Contracts for the International Sale of Goods is expressly
excluded. Any use of the Original Work outside the scope of this License
or after its termination shall be subject to the requirements and
penalties of copyright or patent law in the appropriate jurisdiction.
This section shall survive the termination of this License.

12) Attorneys' Fees. In any action to enforce the terms of this License
or seeking damages relating thereto, the prevailing party shall be
entitled to recover its costs and expenses, including, without
limitation, reasonable attorneys' fees and costs incurred in connection
with such action, including any appeal of such action. This section
shall survive the termination of this License.

13) Miscellaneous. If any provision of this License is held to be
unenforceable, such provision shall be reformed only to the extent
necessary to make it enforceable.

14) Definition of ""You"" in This License. ""You"" throughout this License,
whether in upper or lower case, means an individual or a legal entity
exercising rights under, and complying with all of the terms of, this
License. For legal entities, ""You"" includes any entity that controls, is
controlled by, or is under common control with you. For purposes of this
definition, ""control"" means (i) the power, direct or indirect, to cause
the direction or management of such entity, whether by contract or
otherwise, or (ii) ownership of fifty percent (50%) or more of the
outstanding shares, or (iii) beneficial ownership of such entity.

15) Right to Use. You may use the Original Work in all ways not
otherwise restricted or conditioned by this License or by law, and
Licensor promises not to interfere with or be responsible for such uses
by You.

16) Modification of This License. This License is Copyright (c) 2005
Lawrence Rosen. Permission is granted to copy, distribute, or
communicate this License without modification. Nothing in this License
permits You to modify this License as applied to the Original Work or to
Derivative Works. However, You may modify the text of this License and
copy, distribute or communicate your modified version (the ""Modified
License"") and apply it to other original works of authorship subject to
the following conditions: (i) You may not indicate in any way that your
Modified License is the ""Academic Free License"" or ""AFL"" and you may not
use those names in the name of your Modified License; (ii) You must
replace the notice specified in the first paragraph above with the
notice ""Licensed under <insert your license name here>"" or with a notice
of your own that is not confusingly similar to the notice in this
License; and (iii) You may not claim that your original works are open
source software unless your Modified License has been approved by Open
Source Initiative (OSI) and You comply with its license review and
certification process.



```"
20,20,NomosTestfiles/AFL/list_sidebar.phtml,AFL-3.0,"<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category   design_blank
 * @package    Mage
 * @copyright  Copyright (c) 2008 Irubin Consulting Inc. DBA Varien (http://www.varien.com)
 * @license    http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php
/**
 * Product list template
 *
 * @see Mage_Catalog_Block_Product_List
 */
?>
<span style=""font-size:11px;color:#aaa;"">
Shop by<br />
<a href=""?mcde=1"" style=""color:#aaa;"">Collection</a> | 
<a href=""?mcde=2"" style=""color:#aaa;"">Product</a></span><br /><br />
<?php

$mycurrentcat = Mage::getModel('catalog/category')->load('4');
$categories=array('2');
if($mycurrentcat->hasChildren()){ $categories=array_merge($categories,explode(',',$mycurrentcat->getChildren())); }
$i = 0;
foreach($categories as $cat):
    if($i==0){ $i++; }
    else {
    $_productCollection=$this->myGetProductCollection($cat);

?>
<?php if(!$_productCollection->count()): ?>
<?php else: ?>
<div class=""category-products"">
    <?php echo ""<h5 style='margin:0px;'><a href='"".Mage::getModel('catalog/category')->load($cat)->getUrl().""'>"".Mage::getModel('catalog/category')->load($cat)->getName().""</a></h5>""; ?>
</div>
<?php endif; ?>
<?php } endforeach; ?> 



<?php

if($_SESSION['menu_status']==""2""){
    $menu_item_category = '3';
}
else{
    $menu_item_category = '9';    
}



$mycurrentcat = Mage::getModel('catalog/category')->load($menu_item_category);
$cats=array('2');
if($mycurrentcat->hasChildren()){ $cats=array_merge($cats,explode(',',$mycurrentcat->getChildren())); }
$i = 0;
foreach($cats as $cat):
    if($i==0){ $i++; }
    else {
    $_productCollection=$this->myGetProductCollection($cat);

?>
<?php if(!$_productCollection->count()): ?>
<?php else: ?>
<div class=""category-products"">
    
    <?php echo ""<h5><a href='"".Mage::getModel('catalog/category')->load($cat)->getUrl().""'>"".Mage::getModel('catalog/category')->load($cat)->getName().""</a></h5>""; ?>
    <?php $_iterator = 0; ?>
    <ol class=""products-list-sidebar"" id=""products-list"">
    <?php foreach ($_productCollection as $_product): ?>
        <li class=""item<?php if( ++$_iterator == sizeof($_productCollection) ): ?> last<?php endif; ?>"">
            <?php // Product description ?>
            <div class=""product-shop"">
                <h3 class=""product-name"" style=""font-style:italic;""><a href=""<?php echo $_product->getProductUrl() ?>"" title=""<?php echo $this->htmlEscape($_product->getName()) ?>""><?php echo $this->htmlEscape($_product->getName())?></a></h3>
            </div>
        </li>
    <?php endforeach; ?>
    </ol>
</div>
<?php endif; ?>
<?php } endforeach; ?>
",False,"```php
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category   design_blank
 * @package    Mage
 * @copyright  Copyright (c) 2008 Irubin Consulting Inc. DBA Varien (http://www.varien.com)
 * @license    http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 ```"
21,21,NomosTestfiles/AGPL/Affero-v1.0,AGPL-1.0-only,"AFFERO GENERAL PUBLIC LICENSE

Version 1, March 2002

Copyright © 2002 Affero Inc.
510 Third Street - Suite 225, San Francisco, CA 94107, USA

This license is a modified version of the GNU General Public License
copyright (C) 1989, 1991 Free Software Foundation, Inc. made with
their permission. Section 2(d) has been added to cover use of software
over a computer network.

Everyone is permitted to copy and distribute verbatim copies of this
license document, but changing it is not allowed.

Preamble

The licenses for most software are designed to take away your freedom
to share and change it. By contrast, the Affero General Public License
is intended to guarantee your freedom to share and change free
software--to make sure the software is free for all its users. This
Public License applies to most of Affero's software and to any other
program whose authors commit to using it. (Some other Affero software
is covered by the GNU Library General Public License instead.) You can
apply it to your programs, too.

When we speak of free software, we are referring to freedom, not
price. This General Public License is designed to make sure that you
have the freedom to distribute copies of free software (and charge for
this service if you wish), that you receive source code or can get it
if you want it, that you can change the software or use pieces of it
in new free programs; and that you know you can do these things.

To protect your rights, we need to make restrictions that forbid
anyone to deny you these rights or to ask you to surrender the
rights. These restrictions translate to certain responsibilities for
you if you distribute copies of the software, or if you modify it.

For example, if you distribute copies of such a program, whether
gratis or for a fee, you must give the recipients all the rights that
you have. You must make sure that they, too, receive or can get the
source code. And you must show them these terms so they know their
rights.

We protect your rights with two steps: (1) copyright the software, and
(2) offer you this license which gives you legal permission to copy,
distribute and/or modify the software.

Also, for each author's protection and ours, we want to make certain
that everyone understands that there is no warranty for this free
software. If the software is modified by someone else and passed on,
we want its recipients to know that what they have is not the
original, so that any problems introduced by others will not reflect
on the original authors' reputations.

Finally, any free program is threatened constantly by software
patents. We wish to avoid the danger that redistributors of a free
program will individually obtain patent licenses, in effect making the
program proprietary. To prevent this, we have made it clear that any
patent must be licensed for everyone's free use or not licensed at
all.

The precise terms and conditions for copying, distribution and
modification follow.

TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION

0. This License applies to any program or other work which contains a
notice placed by the copyright holder saying it may be distributed
under the terms of this Affero General Public License. The ""Program"",
below, refers to any such program or work, and a ""work based on the
Program"" means either the Program or any derivative work under
copyright law: that is to say, a work containing the Program or a
portion of it, either verbatim or with modifications and/or translated
into another language. (Hereinafter, translation is included without
limitation in the term ""modification"".) Each licensee is addressed as
""you"".

Activities other than copying, distribution and modification are not
covered by this License; they are outside its scope. The act of
running the Program is not restricted, and the output from the Program
is covered only if its contents constitute a work based on the Program
(independent of having been made by running the Program). Whether that
is true depends on what the Program does.

1. You may copy and distribute verbatim copies of the Program's source
code as you receive it, in any medium, provided that you conspicuously
and appropriately publish on each copy an appropriate copyright notice
and disclaimer of warranty; keep intact all the notices that refer to
this License and to the absence of any warranty; and give any other
recipients of the Program a copy of this License along with the
Program.

You may charge a fee for the physical act of transferring a copy, and
you may at your option offer warranty protection in exchange for a
fee.

2. You may modify your copy or copies of the Program or any portion of
it, thus forming a work based on the Program, and copy and distribute
such modifications or work under the terms of Section 1 above,
provided that you also meet all of these conditions:

* a) You must cause the modified files to carry prominent notices
stating that you changed the files and the date of any change.

* b) You must cause any work that you distribute or publish, that in
whole or in part contains or is derived from the Program or any part
thereof, to be licensed as a whole at no charge to all third parties
under the terms of this License.

* c) If the modified program normally reads commands interactively
when run, you must cause it, when started running for such interactive
use in the most ordinary way, to print or display an announcement
including an appropriate copyright notice and a notice that there is
no warranty (or else, saying that you provide a warranty) and that
users may redistribute the program under these conditions, and telling
the user how to view a copy of this License. (Exception: if the
Program itself is interactive but does not normally print such an
announcement, your work based on the Program is not required to print
an announcement.)

* d) If the Program as you received it is intended to interact with
users through a computer network and if, in the version you received,
any user interacting with the Program was given the opportunity to
request transmission to that user of the Program's complete source
code, you must not remove that facility from your modified version of
the Program or work based on the Program, and must offer an equivalent
opportunity for all users interacting with your Program through a
computer network to request immediate transmission by HTTP of the
complete source code of your modified version or other derivative
work.

These requirements apply to the modified work as a whole. If
identifiable sections of that work are not derived from the Program,
and can be reasonably considered independent and separate works in
themselves, then this License, and its terms, do not apply to those
sections when you distribute them as separate works. But when you
distribute the same sections as part of a whole which is a work based
on the Program, the distribution of the whole must be on the terms of
this License, whose permissions for other licensees extend to the
entire whole, and thus to each and every part regardless of who wrote
it.

Thus, it is not the intent of this section to claim rights or contest
your rights to work written entirely by you; rather, the intent is to
exercise the right to control the distribution of derivative or
collective works based on the Program.

In addition, mere aggregation of another work not based on the Program
with the Program (or with a work based on the Program) on a volume of
a storage or distribution medium does not bring the other work under
the scope of this License.

3. You may copy and distribute the Program (or a work based on it,
under Section 2) in object code or executable form under the terms of
Sections 1 and 2 above provided that you also do one of the following:

* a) Accompany it with the complete corresponding machine-readable
source code, which must be distributed under the terms of Sections 1
and 2 above on a medium customarily used for software interchange; or,

* b) Accompany it with a written offer, valid for at least three
years, to give any third party, for a charge no more than your cost of
physically performing source distribution, a complete machine-readable
copy of the corresponding source code, to be distributed under the
terms of Sections 1 and 2 above on a medium customarily used for
software interchange; or,

* c) Accompany it with the information you received as to the offer to
distribute corresponding source code. (This alternative is allowed
only for noncommercial distribution and only if you received the
program in object code or executable form with such an offer, in
accord with Subsection b above.)

The source code for a work means the preferred form of the work for
making modifications to it. For an executable work, complete source
code means all the source code for all modules it contains, plus any
associated interface definition files, plus the scripts used to
control compilation and installation of the executable. However, as a
special exception, the source code distributed need not include
anything that is normally distributed (in either source or binary
form) with the major components (compiler, kernel, and so on) of the
operating system on which the executable runs, unless that component
itself accompanies the executable.

If distribution of executable or object code is made by offering
access to copy from a designated place, then offering equivalent
access to copy the source code from the same place counts as
distribution of the source code, even though third parties are not
compelled to copy the source along with the object code.

4. You may not copy, modify, sublicense, or distribute the Program
except as expressly provided under this License. Any attempt otherwise
to copy, modify, sublicense or distribute the Program is void, and
will automatically terminate your rights under this License. However,
parties who have received copies, or rights, from you under this
License will not have their licenses terminated so long as such
parties remain in full compliance.

5. You are not required to accept this License, since you have not
signed it. However, nothing else grants you permission to modify or
distribute the Program or its derivative works. These actions are
prohibited by law if you do not accept this License. Therefore, by
modifying or distributing the Program (or any work based on the
Program), you indicate your acceptance of this License to do so, and
all its terms and conditions for copying, distributing or modifying
the Program or works based on it.

6. Each time you redistribute the Program (or any work based on the
Program), the recipient automatically receives a license from the
original licensor to copy, distribute or modify the Program subject to
these terms and conditions. You may not impose any further
restrictions on the recipients' exercise of the rights granted
herein. You are not responsible for enforcing compliance by third
parties to this License.

7. If, as a consequence of a court judgment or allegation of patent
infringement or for any other reason (not limited to patent issues),
conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License. If you cannot
distribute so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you
may not distribute the Program at all. For example, if a patent
license would not permit royalty-free redistribution of the Program by
all those who receive copies directly or indirectly through you, then
the only way you could satisfy both it and this License would be to
refrain entirely from distribution of the Program.

If any portion of this section is held invalid or unenforceable under
any particular circumstance, the balance of the section is intended to
apply and the section as a whole is intended to apply in other
circumstances.

It is not the purpose of this section to induce you to infringe any
patents or other property right claims or to contest validity of any
such claims; this section has the sole purpose of protecting the
integrity of the free software distribution system, which is
implemented by public license practices. Many people have made
generous contributions to the wide range of software distributed
through that system in reliance on consistent application of that
system; it is up to the author/donor to decide if he or she is willing
to distribute software through any other system and a licensee cannot
impose that choice.

This section is intended to make thoroughly clear what is believed to
be a consequence of the rest of this License.

8. If the distribution and/or use of the Program is restricted in
certain countries either by patents or by copyrighted interfaces, the
original copyright holder who places the Program under this License
may add an explicit geographical distribution limitation excluding
those countries, so that distribution is permitted only in or among
countries not thus excluded. In such case, this License incorporates
the limitation as if written in the body of this License.

9. Affero Inc. may publish revised and/or new versions of the Affero
General Public License from time to time. Such new versions will be
similar in spirit to the present version, but may differ in detail to
address new problems or concerns.

Each version is given a distinguishing version number. If the Program
specifies a version number of this License which applies to it and
""any later version"", you have the option of following the terms and
conditions either of that version or of any later version published by
Affero, Inc. If the Program does not specify a version number of this
License, you may choose any version ever published by Affero, Inc.

You may also choose to redistribute modified versions of this program
under any version of the Free Software Foundation's GNU General Public
License version 3 or higher, so long as that version of the GNU GPL
includes terms and conditions substantially equivalent to those of
this license.

10. If you wish to incorporate parts of the Program into other free
programs whose distribution conditions are different, write to the
author to ask for permission. For software which is copyrighted by
Affero, Inc., write to us; we sometimes make exceptions for this. Our
decision will be guided by the two goals of preserving the free status
of all derivatives of our free software and of promoting the sharing
and reuse of software generally.

NO WARRANTY

11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO
WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE
LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS
AND/OR OTHER PARTIES PROVIDE THE PROGRAM ""AS IS"" WITHOUT WARRANTY OF
ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO,
THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE
PROGRAM IS WITH YOU. SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME
THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.

12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN
WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY
AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU
FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR
CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE
PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING
RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A
FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF
SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH
DAMAGES.
",False,"```
AFFERO GENERAL PUBLIC LICENSE

Version 1, March 2002

Copyright © 2002 Affero Inc.
510 Third Street - Suite 225, San Francisco, CA 94107, USA

This license is a modified version of the GNU General Public License
copyright (C) 1989, 1991 Free Software Foundation, Inc. made with
their permission. Section 2(d) has been added to cover use of software
over a computer network.

Everyone is permitted to copy and distribute verbatim copies of this
license document, but changing it is not allowed.

Preamble

The licenses for most software are designed to take away your freedom
to share and change it. By contrast, the Affero General Public License
is intended to guarantee your freedom to share and change free
software--to make sure the software is free for all its users. This
Public License applies to most of Affero's software and to any other
program whose authors commit to using it. (Some other Affero software
is covered by the GNU Library General Public License instead.) You can
apply it to your programs, too.

When we speak of free software, we are referring to freedom, not
price. This General Public License is designed to make sure that you
have the freedom to distribute copies of free software (and charge for
this service if you wish), that you receive source code or can get it
if you want it, that you can change the software or use pieces of it
in new free programs; and that you know you can do these things.

To protect your rights, we need to make restrictions that forbid
anyone to deny you these rights or to ask you to surrender the
rights. These restrictions translate to certain responsibilities for
you if you distribute copies of the software, or if you modify it.

For example, if you distribute copies of such a program, whether
gratis or for a fee, you must give the recipients all the rights that
you have. You must make sure that they, too, receive or can get the
source code. And you must show them these terms so they know their
rights.

We protect your rights with two steps: (1) copyright the software, and
(2) offer you this license which gives you legal permission to copy,
distribute and/or modify the software.

Also, for each author's protection and ours, we want to make certain
that everyone understands that there is no warranty for this free
software. If the software is modified by someone else and passed on,
we want its recipients to know that what they have is not the
original, so that any problems introduced by others will not reflect
on the original authors' reputations.

Finally, any free program is threatened constantly by software
patents. We wish to avoid the danger that redistributors of a free
program will individually obtain patent licenses, in effect making the
program proprietary. To prevent this, we have made it clear that any
patent must be licensed for everyone's free use or not licensed at
all.

The precise terms and conditions for copying, distribution and
modification follow.

TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION

0. This License applies to any program or other work which contains a
notice placed by the copyright holder saying it may be distributed
under the terms of this Affero General Public License. The ""Program"",
below, refers to any such program or work, and a ""work based on the
Program"" means either the Program or any derivative work under
copyright law: that is to say, a work containing the Program or a
portion of it, either verbatim or with modifications and/or translated
into another language. (Hereinafter, translation is included without
limitation in the term ""modification"".) Each licensee is addressed as
""you"".

Activities other than copying, distribution and modification are not
covered by this License; they are outside its scope. The act of
running the Program is not restricted, and the output from the Program
is covered only if its contents constitute a work based on the Program
(independent of having been made by running the Program). Whether that
is true depends on what the Program does.

1. You may copy and distribute verbatim copies of the Program's source
code as you receive it, in any medium, provided that you conspicuously
and appropriately publish on each copy an appropriate copyright notice
and disclaimer of warranty; keep intact all the notices that refer to
this License and to the absence of any warranty; and give any other
recipients of the Program a copy of this License along with the
Program.

You may charge a fee for the physical act of transferring a copy, and
you may at your option offer warranty protection in exchange for a
fee.

2. You may modify your copy or copies of the Program or any portion of
it, thus forming a work based on the Program, and copy and distribute
such modifications or work under the terms of Section 1 above,
provided that you also meet all of these conditions:

* a) You must cause the modified files to carry prominent notices
stating that you changed the files and the date of any change.

* b) You must cause any work that you distribute or publish, that in
whole or in part contains or is derived from the Program or any part
thereof, to be licensed as a whole at no charge to all third parties
under the terms of this License.

* c) If the modified program normally reads commands interactively
when run, you must cause it, when started running for such interactive
use in the most ordinary way, to print or display an announcement
including an appropriate copyright notice and a notice that there is
no warranty (or else, saying that you provide a warranty) and that
users may redistribute the program under these conditions, and telling
the user how to view a copy of this License. (Exception: if the
Program itself is interactive but does not normally print such an
announcement, your work based on the Program is not required to print
an announcement.)

* d) If the Program as you received it is intended to interact with
users through a computer network and if, in the version you received,
any user interacting with the Program was given the opportunity to
request transmission to that user of the Program's complete source
code, you must not remove that facility from your modified version of
the Program or work based on the Program, and must offer an equivalent
opportunity for all users interacting with your Program through a
computer network to request immediate transmission by HTTP of the
complete source code of your modified version or other derivative
work.

These requirements apply to the modified work as a whole. If
identifiable sections of that work are not derived from the Program,
and can be reasonably considered independent and separate works in
themselves, then this License, and its terms, do not apply to those
sections when you distribute them as separate works. But when you
distribute the same sections as part of a whole which is a work based
on the Program, the distribution of the whole must be on the terms of
this License, whose permissions for other licensees extend to the
entire whole, and thus to each and every part regardless of who wrote
it.

Thus, it is not the intent of this section to claim rights or contest
your rights to work written entirely by you; rather, the intent is to
exercise the right to control the distribution of derivative or
collective works based on the Program.

In addition, mere aggregation of another work not based on the Program
with the Program (or with a work based on the Program) on a volume of a
storage or distribution medium does not bring the other work under the
scope of this License.

3. You may copy and distribute the Program (or a work based on it,
under Section 2) in object code or executable form under the terms of
Sections 1 and 2 above provided that you also do one of the following:

* a) Accompany it with the complete corresponding machine-readable
source code, which must be distributed under the terms of Sections 1
and 2 above on a medium customarily used for software interchange; or,

* b) Accompany it with a written offer, valid for at least three
years, to give any third party, for a charge no more than your cost of
physically performing source distribution, a complete machine-readable
copy of the corresponding source code, to be distributed under the
terms of Sections 1 and 2 above on a medium customarily used for
software interchange; or,

* c) Accompany it with the information you received as to the offer to
distribute corresponding source code. (This alternative is allowed
only for noncommercial distribution and only if you received the
program in object code or executable form with such an offer, in
accordance with Subsection b above.)

The source code for a work means the preferred form of the work for
making modifications to it. For an executable work, complete source
code means all the source code for all modules it contains, plus any
associated interface definition files, plus the scripts used to
control compilation and installation of the executable. However, as a
special exception, the source code distributed need not include
anything that is normally distributed (in either source or binary
form) with the major components (compiler, kernel, and so on) of the
operating system on which the executable runs, unless that component
itself accompanies the executable.

If distribution of executable or object code is made by offering
access to copy from a designated place, then offering equivalent
access to copy the source code from the same place counts as
distribution of the source code, even though third parties are not
compelled to copy the source along with the object code.

4. You may not copy, modify, sublicense, or distribute the Program
except as expressly provided under this License. Any attempt otherwise
to copy, modify, sublicense or distribute the Program is void, and will
automatically terminate your rights under this License. However,
parties who have received copies, or rights, from you under this
License will not have their licenses terminated so long as such
parties remain in full compliance.

5. You are not required to accept this License, since you have not
signed it. However, nothing else grants you permission to modify or
distribute the Program or its derivative works. These actions are
prohibited by law if you do not accept this License. Therefore, by
modifying or distributing the Program (or any work based on the
Program), you indicate your acceptance of this License to do so, and
all its terms and conditions for copying, distributing or modifying
the Program or works based on it.

6. Each time you redistribute the Program (or any work based on the
Program), the recipient automatically receives a license from the
original licensor to copy, distribute or modify the Program subject to
these terms and conditions. You may not impose any further
restrictions on the recipients' exercise of the rights granted
herein. You are not responsible for enforcing compliance by third
parties to this License.

7. If, as a consequence of a court judgment or allegation of patent
infringement or for any other reason (not limited to patent issues),
conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License. If you cannot
distribute so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you
may not distribute the Program at all. For example, if a patent
license would not permit royalty-free redistribution of the Program by
all those who receive copies directly or indirectly through you, then
the only way you could satisfy both it and this License would be to
refrain entirely from distribution of the Program.

If any portion of this section is held invalid or unenforceable under
any particular circumstance, the balance of the section is intended to
apply and the section as a whole is intended to apply in other
circumstances.

It is not the purpose of this section to induce you to infringe any
patents or other property right claims or to contest validity of any
such claims; this section has the sole purpose of protecting the
integrity of the free software distribution system, which is
implemented by public license practices. Many people have made
generous contributions to the wide range of software distributed
through that system in reliance on consistent application of that
system; it is up to the author/donor to decide if he or she is willing
to distribute software through any other system and a licensee cannot
impose that choice.

This section is intended to make thoroughly clear what is believed to
be a consequence of the rest of this License.

8. If the distribution and/or use of the Program is restricted in
certain countries either by patents or by copyrighted interfaces, the
original copyright holder who places the Program under this License
may add an explicit geographical distribution limitation excluding
those countries, so that distribution is permitted only in or among
countries not thus excluded. In such case, this License incorporates
the limitation as if written in the body of this License.

9. Affero Inc. may publish revised and/or new versions of the Affero
General Public License from time to time. Such new versions will be
similar in spirit to the present version, but may differ in detail to
address new problems or concerns.

Each version is given a distinguishing version number. If the Program
specifies a version number of this License which applies to it and
""any later version"", you have the option of following the terms and
conditions either of that version or of any later version published by
Affero, Inc. If the Program does not specify a version number of this
License, you may choose any version ever published by Affero, Inc.

You may also choose to redistribute modified versions of this program
under any version of the Free Software Foundation's GNU General Public
License version 3 or higher, so long as that version of the GNU GPL
includes terms and conditions substantially equivalent to those of
this license.

10. If you wish to incorporate parts of the Program into other free
programs whose distribution conditions are different, write to the
author to ask for permission. For software which is copyrighted by
Affero, Inc., write to us; we sometimes make exceptions for this. Our
decision will be guided by the two goals of preserving the free status
of all derivatives of our free software and of promoting the sharing
and reuse of software generally.

NO WARRANTY

11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO
WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE
LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS
AND/OR OTHER PARTIES PROVIDE THE PROGRAM ""AS IS"" WITHOUT WARRANTY OF
ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO,
THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE
PROGRAM IS WITH YOU. SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME
THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.

12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN
WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY
AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU
FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR
CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE
PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING
RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A
FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF
SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH
DAMAGES.



```"
22,22,NomosTestfiles/AGPL/AGPL-3.0_ref_a.txt,AGPL-3.0-only,"License
---------------------

Licensed under the AGPLv3: https://www.gnu.org/licenses/agpl-3.0.html
",False,"```
License
---------------------

Licensed under the AGPLv3: https://www.gnu.org/licenses/agpl-3.0.html
```"
23,23,NomosTestfiles/AGPL/AGPL-3.0_ref_b.txt,AGPL-3.0-only,"Test file for SPDX identifier

SPDX-license-identifier: AGPL-3.0
",False,"```
SPDX-license-identifier: AGPL-3.0
```"
24,24,NomosTestfiles/AGPL/AGPL-3.0_ref_c.txt,AGPL-3.0-only,"License
-------

PerconaFT is available under the GPL version 2, and AGPL version 3.
See [COPYING.AGPLv3][agpllicense],
[COPYING.GPLv2][gpllicense], and
[PATENTS][patents].

[agpllicense]: http://github.com/Percona/PerconaFT/blob/master/COPYING.AGPLv3
[gpllicense]: http://github.com/Percona/PerconaFT/blob/master/COPYING.GPLv2
[patents]: http://github.com/Percona/PerconaFT/blob/master/PATENTS
",False,"```
License
-------

PerconaFT is available under the GPL version 2, and AGPL version 3.
See [COPYING.AGPLv3][agpllicense],
[COPYING.GPLv2][gpllicense], and
[PATENTS][patents].

[agpllicense]: http://github.com/Percona/PerconaFT/blob/master/COPYING.AGPLv3
[gpllicense]: http://github.com/Percona/PerconaFT/blob/master/COPYING.GPLv2
[patents]: http://github.com/Percona/PerconaFT/blob/master/PATENTS
```"
25,25,NomosTestfiles/AGPL/AGPL-3.0_ref_d.txt,AGPL-3.0-only,"# rpm-specific
set(CPACK_RPM_PACKAGE_SUMMARY ""${CPACK_PACKAGE_NAME}"")
set(CPACK_RPM_PACKAGE_DESCRIPTION ""${PACKAGE_LONG_DESCRIPTION}"")
set(CPACK_RPM_PACKAGE_LICENSE ""AGPL v.3.0"")
",False,"```
set(CPACK_RPM_PACKAGE_LICENSE ""AGPL v.3.0"")
```"
26,26,NomosTestfiles/AGPL/AGPL-3.0_ref_e.txt,AGPL-3.0-only,"This program is licensed to you under the AGPLv3, the terms of which are included in
the file COPYING.
",False,"```
This program is licensed to you under the AGPLv3, the terms of which are included in
the file COPYING.
```"
27,27,NomosTestfiles/AGPL/AGPL-3.0.txt,AGPL-3.0-only,"﻿                    GNU AFFERO GENERAL PUBLIC LICENSE
                       Version 3, 19 November 2007

 Copyright (C) 2007 Free Software Foundation, Inc. <http://fsf.org/>
 Everyone is permitted to copy and distribute verbatim copies
 of this license document, but changing it is not allowed.

                            Preamble

  The GNU Affero General Public License is a free, copyleft license for
software and other kinds of works, specifically designed to ensure
cooperation with the community in the case of network server software.

  The licenses for most software and other practical works are designed
to take away your freedom to share and change the works.  By contrast,
our General Public Licenses are intended to guarantee your freedom to
share and change all versions of a program--to make sure it remains free
software for all its users.

  When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
them if you wish), that you receive source code or can get it if you
want it, that you can change the software or use pieces of it in new
free programs, and that you know you can do these things.

  Developers that use our General Public Licenses protect your rights
with two steps: (1) assert copyright on the software, and (2) offer
you this License which gives you legal permission to copy, distribute
and/or modify the software.

  A secondary benefit of defending all users' freedom is that
improvements made in alternate versions of the program, if they
receive widespread use, become available for other developers to
incorporate.  Many developers of free software are heartened and
encouraged by the resulting cooperation.  However, in the case of
software used on network servers, this result may fail to come about.
The GNU General Public License permits making a modified version and
letting the public access it on a server without ever releasing its
source code to the public.

  The GNU Affero General Public License is designed specifically to
ensure that, in such cases, the modified source code becomes available
to the community.  It requires the operator of a network server to
provide the source code of the modified version running there to the
users of that server.  Therefore, public use of a modified version, on
a publicly accessible server, gives the public access to the source
code of the modified version.

  An older license, called the Affero General Public License and
published by Affero, was designed to accomplish similar goals.  This is
a different license, not a version of the Affero GPL, but Affero has
released a new version of the Affero GPL which permits relicensing under
this license.

  The precise terms and conditions for copying, distribution and
modification follow.

                       TERMS AND CONDITIONS

  0. Definitions.

  ""This License"" refers to version 3 of the GNU Affero General Public License.

  ""Copyright"" also means copyright-like laws that apply to other kinds of
works, such as semiconductor masks.

  ""The Program"" refers to any copyrightable work licensed under this
License.  Each licensee is addressed as ""you"".  ""Licensees"" and
""recipients"" may be individuals or organizations.

  To ""modify"" a work means to copy from or adapt all or part of the work
in a fashion requiring copyright permission, other than the making of an
exact copy.  The resulting work is called a ""modified version"" of the
earlier work or a work ""based on"" the earlier work.

  A ""covered work"" means either the unmodified Program or a work based
on the Program.

  To ""propagate"" a work means to do anything with it that, without
permission, would make you directly or secondarily liable for
infringement under applicable copyright law, except executing it on a
computer or modifying a private copy.  Propagation includes copying,
distribution (with or without modification), making available to the
public, and in some countries other activities as well.

  To ""convey"" a work means any kind of propagation that enables other
parties to make or receive copies.  Mere interaction with a user through
a computer network, with no transfer of a copy, is not conveying.

  An interactive user interface displays ""Appropriate Legal Notices""
to the extent that it includes a convenient and prominently visible
feature that (1) displays an appropriate copyright notice, and (2)
tells the user that there is no warranty for the work (except to the
extent that warranties are provided), that licensees may convey the
work under this License, and how to view a copy of this License.  If
the interface presents a list of user commands or options, such as a
menu, a prominent item in the list meets this criterion.

  1. Source Code.

  The ""source code"" for a work means the preferred form of the work
for making modifications to it.  ""Object code"" means any non-source
form of a work.

  A ""Standard Interface"" means an interface that either is an official
standard defined by a recognized standards body, or, in the case of
interfaces specified for a particular programming language, one that
is widely used among developers working in that language.

  The ""System Libraries"" of an executable work include anything, other
than the work as a whole, that (a) is included in the normal form of
packaging a Major Component, but which is not part of that Major
Component, and (b) serves only to enable use of the work with that
Major Component, or to implement a Standard Interface for which an
implementation is available to the public in source code form.  A
""Major Component"", in this context, means a major essential component
(kernel, window system, and so on) of the specific operating system
(if any) on which the executable work runs, or a compiler used to
produce the work, or an object code interpreter used to run it.

  The ""Corresponding Source"" for a work in object code form means all
the source code needed to generate, install, and (for an executable
work) run the object code and to modify the work, including scripts to
control those activities.  However, it does not include the work's
System Libraries, or general-purpose tools or generally available free
programs which are used unmodified in performing those activities but
which are not part of the work.  For example, Corresponding Source
includes interface definition files associated with source files for
the work, and the source code for shared libraries and dynamically
linked subprograms that the work is specifically designed to require,
such as by intimate data communication or control flow between those
subprograms and other parts of the work.

  The Corresponding Source need not include anything that users
can regenerate automatically from other parts of the Corresponding
Source.

  The Corresponding Source for a work in source code form is that
same work.

  2. Basic Permissions.

  All rights granted under this License are granted for the term of
copyright on the Program, and are irrevocable provided the stated
conditions are met.  This License explicitly affirms your unlimited
permission to run the unmodified Program.  The output from running a
covered work is covered by this License only if the output, given its
content, constitutes a covered work.  This License acknowledges your
rights of fair use or other equivalent, as provided by copyright law.

  You may make, run and propagate covered works that you do not
convey, without conditions so long as your license otherwise remains
in force.  You may convey covered works to others for the sole purpose
of having them make modifications exclusively for you, or provide you
with facilities for running those works, provided that you comply with
the terms of this License in conveying all material for which you do
not control copyright.  Those thus making or running the covered works
for you must do so exclusively on your behalf, under your direction
and control, on terms that prohibit them from making any copies of
your copyrighted material outside their relationship with you.

  Conveying under any other circumstances is permitted solely under
the conditions stated below.  Sublicensing is not allowed; section 10
makes it unnecessary.

  3. Protecting Users' Legal Rights From Anti-Circumvention Law.

  No covered work shall be deemed part of an effective technological
measure under any applicable law fulfilling obligations under article
11 of the WIPO copyright treaty adopted on 20 December 1996, or
similar laws prohibiting or restricting circumvention of such
measures.

  When you convey a covered work, you waive any legal power to forbid
circumvention of technological measures to the extent such circumvention
is effected by exercising rights under this License with respect to
the covered work, and you disclaim any intention to limit operation or
modification of the work as a means of enforcing, against the work's
users, your or third parties' legal rights to forbid circumvention of
technological measures.

  4. Conveying Verbatim Copies.

  You may convey verbatim copies of the Program's source code as you
receive it, in any medium, provided that you conspicuously and
appropriately publish on each copy an appropriate copyright notice;
keep intact all notices stating that this License and any
non-permissive terms added in accord with section 7 apply to the code;
keep intact all notices of the absence of any warranty; and give all
recipients a copy of this License along with the Program.

  You may charge any price or no price for each copy that you convey,
and you may offer support or warranty protection for a fee.

  5. Conveying Modified Source Versions.

  You may convey a work based on the Program, or the modifications to
produce it from the Program, in the form of source code under the
terms of section 4, provided that you also meet all of these conditions:

    a) The work must carry prominent notices stating that you modified
    it, and giving a relevant date.

    b) The work must carry prominent notices stating that it is
    released under this License and any conditions added under section
    7.  This requirement modifies the requirement in section 4 to
    ""keep intact all notices"".

    c) You must license the entire work, as a whole, under this
    License to anyone who comes into possession of a copy.  This
    License will therefore apply, along with any applicable section 7
    additional terms, to the whole of the work, and all its parts,
    regardless of how they are packaged.  This License gives no
    permission to license the work in any other way, but it does not
    invalidate such permission if you have separately received it.

    d) If the work has interactive user interfaces, each must display
    Appropriate Legal Notices; however, if the Program has interactive
    interfaces that do not display Appropriate Legal Notices, your
    work need not make them do so.

  A compilation of a covered work with other separate and independent
works, which are not by their nature extensions of the covered work,
and which are not combined with it such as to form a larger program,
in or on a volume of a storage or distribution medium, is called an
""aggregate"" if the compilation and its resulting copyright are not
used to limit the access or legal rights of the compilation's users
beyond what the individual works permit.  Inclusion of a covered work
in an aggregate does not cause this License to apply to the other
parts of the aggregate.

  6. Conveying Non-Source Forms.

  You may convey a covered work in object code form under the terms
of sections 4 and 5, provided that you also convey the
machine-readable Corresponding Source under the terms of this License,
in one of these ways:

    a) Convey the object code in, or embodied in, a physical product
    (including a physical distribution medium), accompanied by the
    Corresponding Source fixed on a durable physical medium
    customarily used for software interchange.

    b) Convey the object code in, or embodied in, a physical product
    (including a physical distribution medium), accompanied by a
    written offer, valid for at least three years and valid for as
    long as you offer spare parts or customer support for that product
    model, to give anyone who possesses the object code either (1) a
    copy of the Corresponding Source for all the software in the
    product that is covered by this License, on a durable physical
    medium customarily used for software interchange, for a price no
    more than your reasonable cost of physically performing this
    conveying of source, or (2) access to copy the
    Corresponding Source from a network server at no charge.

    c) Convey individual copies of the object code with a copy of the
    written offer to provide the Corresponding Source.  This
    alternative is allowed only occasionally and noncommercially, and
    only if you received the object code with such an offer, in accord
    with subsection 6b.

    d) Convey the object code by offering access from a designated
    place (gratis or for a charge), and offer equivalent access to the
    Corresponding Source in the same way through the same place at no
    further charge.  You need not require recipients to copy the
    Corresponding Source along with the object code.  If the place to
    copy the object code is a network server, the Corresponding Source
    may be on a different server (operated by you or a third party)
    that supports equivalent copying facilities, provided you maintain
    clear directions next to the object code saying where to find the
    Corresponding Source.  Regardless of what server hosts the
    Corresponding Source, you remain obligated to ensure that it is
    available for as long as needed to satisfy these requirements.

    e) Convey the object code using peer-to-peer transmission, provided
    you inform other peers where the object code and Corresponding
    Source of the work are being offered to the general public at no
    charge under subsection 6d.

  A separable portion of the object code, whose source code is excluded
from the Corresponding Source as a System Library, need not be
included in conveying the object code work.

  A ""User Product"" is either (1) a ""consumer product"", which means any
tangible personal property which is normally used for personal, family,
or household purposes, or (2) anything designed or sold for incorporation
into a dwelling.  In determining whether a product is a consumer product,
doubtful cases shall be resolved in favor of coverage.  For a particular
product received by a particular user, ""normally used"" refers to a
typical or common use of that class of product, regardless of the status
of the particular user or of the way in which the particular user
actually uses, or expects or is expected to use, the product.  A product
is a consumer product regardless of whether the product has substantial
commercial, industrial or non-consumer uses, unless such uses represent
the only significant mode of use of the product.

  ""Installation Information"" for a User Product means any methods,
procedures, authorization keys, or other information required to install
and execute modified versions of a covered work in that User Product from
a modified version of its Corresponding Source.  The information must
suffice to ensure that the continued functioning of the modified object
code is in no case prevented or interfered with solely because
modification has been made.

  If you convey an object code work under this section in, or with, or
specifically for use in, a User Product, and the conveying occurs as
part of a transaction in which the right of possession and use of the
User Product is transferred to the recipient in perpetuity or for a
fixed term (regardless of how the transaction is characterized), the
Corresponding Source conveyed under this section must be accompanied
by the Installation Information.  But this requirement does not apply
if neither you nor any third party retains the ability to install
modified object code on the User Product (for example, the work has
been installed in ROM).

  The requirement to provide Installation Information does not include a
requirement to continue to provide support service, warranty, or updates
for a work that has been modified or installed by the recipient, or for
the User Product in which it has been modified or installed.  Access to a
network may be denied when the modification itself materially and
adversely affects the operation of the network or violates the rules and
protocols for communication across the network.

  Corresponding Source conveyed, and Installation Information provided,
in accord with this section must be in a format that is publicly
documented (and with an implementation available to the public in
source code form), and must require no special password or key for
unpacking, reading or copying.

  7. Additional Terms.

  ""Additional permissions"" are terms that supplement the terms of this
License by making exceptions from one or more of its conditions.
Additional permissions that are applicable to the entire Program shall
be treated as though they were included in this License, to the extent
that they are valid under applicable law.  If additional permissions
apply only to part of the Program, that part may be used separately
under those permissions, but the entire Program remains governed by
this License without regard to the additional permissions.

  When you convey a copy of a covered work, you may at your option
remove any additional permissions from that copy, or from any part of
it.  (Additional permissions may be written to require their own
removal in certain cases when you modify the work.)  You may place
additional permissions on material, added by you to a covered work,
for which you have or can give appropriate copyright permission.

  Notwithstanding any other provision of this License, for material you
add to a covered work, you may (if authorized by the copyright holders of
that material) supplement the terms of this License with terms:

    a) Disclaiming warranty or limiting liability differently from the
    terms of sections 15 and 16 of this License; or

    b) Requiring preservation of specified reasonable legal notices or
    author attributions in that material or in the Appropriate Legal
    Notices displayed by works containing it; or

    c) Prohibiting misrepresentation of the origin of that material, or
    requiring that modified versions of such material be marked in
    reasonable ways as different from the original version; or

    d) Limiting the use for publicity purposes of names of licensors or
    authors of the material; or

    e) Declining to grant rights under trademark law for use of some
    trade names, trademarks, or service marks; or

    f) Requiring indemnification of licensors and authors of that
    material by anyone who conveys the material (or modified versions of
    it) with contractual assumptions of liability to the recipient, for
    any liability that these contractual assumptions directly impose on
    those licensors and authors.

  All other non-permissive additional terms are considered ""further
restrictions"" within the meaning of section 10.  If the Program as you
received it, or any part of it, contains a notice stating that it is
governed by this License along with a term that is a further
restriction, you may remove that term.  If a license document contains
a further restriction but permits relicensing or conveying under this
License, you may add to a covered work material governed by the terms
of that license document, provided that the further restriction does
not survive such relicensing or conveying.

  If you add terms to a covered work in accord with this section, you
must place, in the relevant source files, a statement of the
additional terms that apply to those files, or a notice indicating
where to find the applicable terms.

  Additional terms, permissive or non-permissive, may be stated in the
form of a separately written license, or stated as exceptions;
the above requirements apply either way.

  8. Termination.

  You may not propagate or modify a covered work except as expressly
provided under this License.  Any attempt otherwise to propagate or
modify it is void, and will automatically terminate your rights under
this License (including any patent licenses granted under the third
paragraph of section 11).

  However, if you cease all violation of this License, then your
license from a particular copyright holder is reinstated (a)
provisionally, unless and until the copyright holder explicitly and
finally terminates your license, and (b) permanently, if the copyright
holder fails to notify you of the violation by some reasonable means
prior to 60 days after the cessation.

  Moreover, your license from a particular copyright holder is
reinstated permanently if the copyright holder notifies you of the
violation by some reasonable means, this is the first time you have
received notice of violation of this License (for any work) from that
copyright holder, and you cure the violation prior to 30 days after
your receipt of the notice.

  Termination of your rights under this section does not terminate the
licenses of parties who have received copies or rights from you under
this License.  If your rights have been terminated and not permanently
reinstated, you do not qualify to receive new licenses for the same
material under section 10.

  9. Acceptance Not Required for Having Copies.

  You are not required to accept this License in order to receive or
run a copy of the Program.  Ancillary propagation of a covered work
occurring solely as a consequence of using peer-to-peer transmission
to receive a copy likewise does not require acceptance.  However,
nothing other than this License grants you permission to propagate or
modify any covered work.  These actions infringe copyright if you do
not accept this License.  Therefore, by modifying or propagating a
covered work, you indicate your acceptance of this License to do so.

  10. Automatic Licensing of Downstream Recipients.

  Each time you convey a covered work, the recipient automatically
receives a license from the original licensors, to run, modify and
propagate that work, subject to this License.  You are not responsible
for enforcing compliance by third parties with this License.

  An ""entity transaction"" is a transaction transferring control of an
organization, or substantially all assets of one, or subdividing an
organization, or merging organizations.  If propagation of a covered
work results from an entity transaction, each party to that
transaction who receives a copy of the work also receives whatever
licenses to the work the party's predecessor in interest had or could
give under the previous paragraph, plus a right to possession of the
Corresponding Source of the work from the predecessor in interest, if
the predecessor has it or can get it with reasonable efforts.

  You may not impose any further restrictions on the exercise of the
rights granted or affirmed under this License.  For example, you may
not impose a license fee, royalty, or other charge for exercise of
rights granted under this License, and you may not initiate litigation
(including a cross-claim or counterclaim in a lawsuit) alleging that
any patent claim is infringed by making, using, selling, offering for
sale, or importing the Program or any portion of it.

  11. Patents.

  A ""contributor"" is a copyright holder who authorizes use under this
License of the Program or a work on which the Program is based.  The
work thus licensed is called the contributor's ""contributor version"".

  A contributor's ""essential patent claims"" are all patent claims
owned or controlled by the contributor, whether already acquired or
hereafter acquired, that would be infringed by some manner, permitted
by this License, of making, using, or selling its contributor version,
but do not include claims that would be infringed only as a
consequence of further modification of the contributor version.  For
purposes of this definition, ""control"" includes the right to grant
patent sublicenses in a manner consistent with the requirements of
this License.

  Each contributor grants you a non-exclusive, worldwide, royalty-free
patent license under the contributor's essential patent claims, to
make, use, sell, offer for sale, import and otherwise run, modify and
propagate the contents of its contributor version.

  In the following three paragraphs, a ""patent license"" is any express
agreement or commitment, however denominated, not to enforce a patent
(such as an express permission to practice a patent or covenant not to
sue for patent infringement).  To ""grant"" such a patent license to a
party means to make such an agreement or commitment not to enforce a
patent against the party.

  If you convey a covered work, knowingly relying on a patent license,
and the Corresponding Source of the work is not available for anyone
to copy, free of charge and under the terms of this License, through a
publicly available network server or other readily accessible means,
then you must either (1) cause the Corresponding Source to be so
available, or (2) arrange to deprive yourself of the benefit of the
patent license for this particular work, or (3) arrange, in a manner
consistent with the requirements of this License, to extend the patent
license to downstream recipients.  ""Knowingly relying"" means you have
actual knowledge that, but for the patent license, your conveying the
covered work in a country, or your recipient's use of the covered work
in a country, would infringe one or more identifiable patents in that
country that you have reason to believe are valid.

  If, pursuant to or in connection with a single transaction or
arrangement, you convey, or propagate by procuring conveyance of, a
covered work, and grant a patent license to some of the parties
receiving the covered work authorizing them to use, propagate, modify
or convey a specific copy of the covered work, then the patent license
you grant is automatically extended to all recipients of the covered
work and works based on it.

  A patent license is ""discriminatory"" if it does not include within
the scope of its coverage, prohibits the exercise of, or is
conditioned on the non-exercise of one or more of the rights that are
specifically granted under this License.  You may not convey a covered
work if you are a party to an arrangement with a third party that is
in the business of distributing software, under which you make payment
to the third party based on the extent of your activity of conveying
the work, and under which the third party grants, to any of the
parties who would receive the covered work from you, a discriminatory
patent license (a) in connection with copies of the covered work
conveyed by you (or copies made from those copies), or (b) primarily
for and in connection with specific products or compilations that
contain the covered work, unless you entered into that arrangement,
or that patent license was granted, prior to 28 March 2007.

  Nothing in this License shall be construed as excluding or limiting
any implied license or other defenses to infringement that may
otherwise be available to you under applicable patent law.

  12. No Surrender of Others' Freedom.

  If conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot convey a
covered work so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you may
not convey it at all.  For example, if you agree to terms that obligate you
to collect a royalty for further conveying from those to whom you convey
the Program, the only way you could satisfy both those terms and this
License would be to refrain entirely from conveying the Program.

  13. Remote Network Interaction; Use with the GNU General Public License.

  Notwithstanding any other provision of this License, if you modify the
Program, your modified version must prominently offer all users
interacting with it remotely through a computer network (if your version
supports such interaction) an opportunity to receive the Corresponding
Source of your version by providing access to the Corresponding Source
from a network server at no charge, through some standard or customary
means of facilitating copying of software.  This Corresponding Source
shall include the Corresponding Source for any work covered by version 3
of the GNU General Public License that is incorporated pursuant to the
following paragraph.

  Notwithstanding any other provision of this License, you have
permission to link or combine any covered work with a work licensed
under version 3 of the GNU General Public License into a single
combined work, and to convey the resulting work.  The terms of this
License will continue to apply to the part which is the covered work,
but the work with which it is combined will remain governed by version
3 of the GNU General Public License.

  14. Revised Versions of this License.

  The Free Software Foundation may publish revised and/or new versions of
the GNU Affero General Public License from time to time.  Such new versions
will be similar in spirit to the present version, but may differ in detail to
address new problems or concerns.

  Each version is given a distinguishing version number.  If the
Program specifies that a certain numbered version of the GNU Affero General
Public License ""or any later version"" applies to it, you have the
option of following the terms and conditions either of that numbered
version or of any later version published by the Free Software
Foundation.  If the Program does not specify a version number of the
GNU Affero General Public License, you may choose any version ever published
by the Free Software Foundation.

  If the Program specifies that a proxy can decide which future
versions of the GNU Affero General Public License can be used, that proxy's
public statement of acceptance of a version permanently authorizes you
to choose that version for the Program.

  Later license versions may give you additional or different
permissions.  However, no additional obligations are imposed on any
author or copyright holder as a result of your choosing to follow a
later version.

  15. Disclaimer of Warranty.

  THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY
APPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT
HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM ""AS IS"" WITHOUT WARRANTY
OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO,
THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM
IS WITH YOU.  SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF
ALL NECESSARY SERVICING, REPAIR OR CORRECTION.

  16. Limitation of Liability.

  IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR CONVEYS
THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY
GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE
USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF
DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD
PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS),
EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF
SUCH DAMAGES.

  17. Interpretation of Sections 15 and 16.

  If the disclaimer of warranty and limitation of liability provided
above cannot be given local legal effect according to their terms,
reviewing courts shall apply local law that most closely approximates
an absolute waiver of all civil liability in connection with the
Program, unless a warranty or assumption of liability accompanies a
copy of the Program in return for a fee.

                     END OF TERMS AND CONDITIONS

            How to Apply These Terms to Your New Programs

  If you develop a new program, and you want it to be of the greatest
possible use to the public, the best way to achieve this is to make it
free software which everyone can redistribute and change under these terms.

  To do so, attach the following notices to the program.  It is safest
to attach them to the start of each source file to most effectively
state the exclusion of warranty; and each file should have at least
the ""copyright"" line and a pointer to where the full notice is found.

    <one line to give the program's name and a brief idea of what it does.>
    Copyright (C) <year>  <name of author>

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.

Also add information on how to contact you by electronic and paper mail.

  If your software can interact with users remotely through a computer
network, you should also make sure that it provides a way for users to
get its source.  For example, if your program is a web application, its
interface could display a ""Source"" link that leads users to an archive
of the code.  There are many ways you could offer source, and different
solutions will be better for different programs; see section 13 for the
specific requirements.

  You should also get your employer (if you work as a programmer) or school,
if any, to sign a ""copyright disclaimer"" for the program, if necessary.
For more information on this, and how to apply and follow the GNU AGPL, see
<http://www.gnu.org/licenses/>.
",False,
28,28,NomosTestfiles/AGPL/ampdu.c,ISC,"/*
 * Copyright (c) 2010 Broadcom Corporation
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED ""AS IS"" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
 * SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
 * OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
 * CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */
#include <net/mac80211.h>

#include ""rate.h""
#include ""scb.h""
#include ""phy/phy_hal.h""
#include ""antsel.h""
#include ""main.h""
#include ""ampdu.h""
#include ""debug.h""
#include ""brcms_trace_events.h""

/* max number of mpdus in an ampdu */
#define AMPDU_MAX_MPDU			32
/* max number of mpdus in an ampdu to a legacy */
#define AMPDU_NUM_MPDU_LEGACY		16
/* max Tx ba window size (in pdu) */
#define AMPDU_TX_BA_MAX_WSIZE		64
/* default Tx ba window size (in pdu) */
#define AMPDU_TX_BA_DEF_WSIZE		64
/* default Rx ba window size (in pdu) */
#define AMPDU_RX_BA_DEF_WSIZE		64
/* max Rx ba window size (in pdu) */
#define AMPDU_RX_BA_MAX_WSIZE		64
/* max dur of tx ampdu (in msec) */
#define	AMPDU_MAX_DUR			5
/* default tx retry limit */
#define AMPDU_DEF_RETRY_LIMIT		5
/* default tx retry limit at reg rate */
#define AMPDU_DEF_RR_RETRY_LIMIT	2
/* default ffpld reserved bytes */
#define AMPDU_DEF_FFPLD_RSVD		2048
/* # of inis to be freed on detach */
#define AMPDU_INI_FREE			10
/* max # of mpdus released at a time */
#define	AMPDU_SCB_MAX_RELEASE		20

#define NUM_FFPLD_FIFO 4	/* number of fifo concerned by pre-loading */
#define FFPLD_TX_MAX_UNFL   200	/* default value of the average number of ampdu
				 * without underflows
				 */
#define FFPLD_MPDU_SIZE 1800	/* estimate of maximum mpdu size */
#define FFPLD_MAX_MCS 23	/* we don't deal with mcs 32 */
#define FFPLD_PLD_INCR 1000	/* increments in bytes */
#define FFPLD_MAX_AMPDU_CNT 5000	/* maximum number of ampdu we
					 * accumulate between resets.
					 */

#define AMPDU_DELIMITER_LEN	4

/* max allowed number of mpdus in an ampdu (2 streams) */
#define AMPDU_NUM_MPDU		16

#define TX_SEQ_TO_INDEX(seq) ((seq) % AMPDU_TX_BA_MAX_WSIZE)

/* max possible overhead per mpdu in the ampdu; 3 is for roundup if needed */
#define AMPDU_MAX_MPDU_OVERHEAD (FCS_LEN + DOT11_ICV_AES_LEN +\
	AMPDU_DELIMITER_LEN + 3\
	+ DOT11_A4_HDR_LEN + DOT11_QOS_LEN + DOT11_IV_MAX_LEN)

/* modulo add/sub, bound = 2^k */
#define MODADD_POW2(x, y, bound) (((x) + (y)) & ((bound) - 1))
#define MODSUB_POW2(x, y, bound) (((x) - (y)) & ((bound) - 1))

/* structure to hold tx fifo information and pre-loading state
 * counters specific to tx underflows of ampdus
 * some counters might be redundant with the ones in wlc or ampdu structures.
 * This allows to maintain a specific state independently of
 * how often and/or when the wlc counters are updated.
 *
 * ampdu_pld_size: number of bytes to be pre-loaded
 * mcs2ampdu_table: per-mcs max # of mpdus in an ampdu
 * prev_txfunfl: num of underflows last read from the HW macstats counter
 * accum_txfunfl: num of underflows since we modified pld params
 * accum_txampdu: num of tx ampdu since we modified pld params
 * prev_txampdu: previous reading of tx ampdu
 * dmaxferrate: estimated dma avg xfer rate in kbits/sec
 */
struct brcms_fifo_info {
	u16 ampdu_pld_size;
	u8 mcs2ampdu_table[FFPLD_MAX_MCS + 1];
	u16 prev_txfunfl;
	u32 accum_txfunfl;
	u32 accum_txampdu;
	u32 prev_txampdu;
	u32 dmaxferrate;
};

/* AMPDU module specific state
 *
 * wlc: pointer to main wlc structure
 * scb_handle: scb cubby handle to retrieve data from scb
 * ini_enable: per-tid initiator enable/disable of ampdu
 * ba_tx_wsize: Tx ba window size (in pdu)
 * ba_rx_wsize: Rx ba window size (in pdu)
 * retry_limit: mpdu transmit retry limit
 * rr_retry_limit: mpdu transmit retry limit at regular rate
 * retry_limit_tid: per-tid mpdu transmit retry limit
 * rr_retry_limit_tid: per-tid mpdu transmit retry limit at regular rate
 * mpdu_density: min mpdu spacing (0-7) ==> 2^(x-1)/8 usec
 * max_pdu: max pdus allowed in ampdu
 * dur: max duration of an ampdu (in msec)
 * rx_factor: maximum rx ampdu factor (0-3) ==> 2^(13+x) bytes
 * ffpld_rsvd: number of bytes to reserve for preload
 * max_txlen: max size of ampdu per mcs, bw and sgi
 * mfbr: enable multiple fallback rate
 * tx_max_funl: underflows should be kept such that
 *		(tx_max_funfl*underflows) < tx frames
 * fifo_tb: table of fifo infos
 */
struct ampdu_info {
	struct brcms_c_info *wlc;
	int scb_handle;
	u8 ini_enable[AMPDU_MAX_SCB_TID];
	u8 ba_tx_wsize;
	u8 ba_rx_wsize;
	u8 retry_limit;
	u8 rr_retry_limit;
	u8 retry_limit_tid[AMPDU_MAX_SCB_TID];
	u8 rr_retry_limit_tid[AMPDU_MAX_SCB_TID];
	u8 mpdu_density;
	s8 max_pdu;
	u8 dur;
	u8 rx_factor;
	u32 ffpld_rsvd;
	u32 max_txlen[MCS_TABLE_SIZE][2][2];
	bool mfbr;
	u32 tx_max_funl;
	struct brcms_fifo_info fifo_tb[NUM_FFPLD_FIFO];
};

/* used for flushing ampdu packets */
struct cb_del_ampdu_pars {
	struct ieee80211_sta *sta;
	u16 tid;
};

static void brcms_c_scb_ampdu_update_max_txlen(struct ampdu_info *ampdu, u8 dur)
{
	u32 rate, mcs;

	for (mcs = 0; mcs < MCS_TABLE_SIZE; mcs++) {
		/* rate is in Kbps; dur is in msec ==> len = (rate * dur) / 8 */
		/* 20MHz, No SGI */
		rate = mcs_2_rate(mcs, false, false);
		ampdu->max_txlen[mcs][0][0] = (rate * dur) >> 3;
		/* 40 MHz, No SGI */
		rate = mcs_2_rate(mcs, true, false);
		ampdu->max_txlen[mcs][1][0] = (rate * dur) >> 3;
		/* 20MHz, SGI */
		rate = mcs_2_rate(mcs, false, true);
		ampdu->max_txlen[mcs][0][1] = (rate * dur) >> 3;
		/* 40 MHz, SGI */
		rate = mcs_2_rate(mcs, true, true);
		ampdu->max_txlen[mcs][1][1] = (rate * dur) >> 3;
	}
}

static bool brcms_c_ampdu_cap(struct ampdu_info *ampdu)
{
	if (BRCMS_PHY_11N_CAP(ampdu->wlc->band))
		return true;
	else
		return false;
}

static int brcms_c_ampdu_set(struct ampdu_info *ampdu, bool on)
{
	struct brcms_c_info *wlc = ampdu->wlc;
	struct bcma_device *core = wlc->hw->d11core;

	wlc->pub->_ampdu = false;

	if (on) {
		if (!(wlc->pub->_n_enab & SUPPORT_11N)) {
			brcms_err(core, ""wl%d: driver not nmode enabled\n"",
				  wlc->pub->unit);
			return -ENOTSUPP;
		}
		if (!brcms_c_ampdu_cap(ampdu)) {
			brcms_err(core, ""wl%d: device not ampdu capable\n"",
				  wlc->pub->unit);
			return -ENOTSUPP;
		}
		wlc->pub->_ampdu = on;
	}

	return 0;
}

static void brcms_c_ffpld_init(struct ampdu_info *ampdu)
{
	int i, j;
	struct brcms_fifo_info *fifo;

	for (j = 0; j < NUM_FFPLD_FIFO; j++) {
		fifo = (ampdu->fifo_tb + j);
		fifo->ampdu_pld_size = 0;
		for (i = 0; i <= FFPLD_MAX_MCS; i++)
			fifo->mcs2ampdu_table[i] = 255;
		fifo->dmaxferrate = 0;
		fifo->accum_txampdu = 0;
		fifo->prev_txfunfl = 0;
		fifo->accum_txfunfl = 0;

	}
}

struct ampdu_info *brcms_c_ampdu_attach(struct brcms_c_info *wlc)
{
	struct ampdu_info *ampdu;
	int i;

	ampdu = kzalloc(sizeof(struct ampdu_info), GFP_ATOMIC);
	if (!ampdu)
		return NULL;

	ampdu->wlc = wlc;

	for (i = 0; i < AMPDU_MAX_SCB_TID; i++)
		ampdu->ini_enable[i] = true;
	/* Disable ampdu for VO by default */
	ampdu->ini_enable[PRIO_8021D_VO] = false;
	ampdu->ini_enable[PRIO_8021D_NC] = false;

	/* Disable ampdu for BK by default since not enough fifo space */
	ampdu->ini_enable[PRIO_8021D_NONE] = false;
	ampdu->ini_enable[PRIO_8021D_BK] = false;

	ampdu->ba_tx_wsize = AMPDU_TX_BA_DEF_WSIZE;
	ampdu->ba_rx_wsize = AMPDU_RX_BA_DEF_WSIZE;
	ampdu->mpdu_density = AMPDU_DEF_MPDU_DENSITY;
	ampdu->max_pdu = AUTO;
	ampdu->dur = AMPDU_MAX_DUR;

	ampdu->ffpld_rsvd = AMPDU_DEF_FFPLD_RSVD;
	/*
	 * bump max ampdu rcv size to 64k for all 11n
	 * devices except 4321A0 and 4321A1
	 */
	if (BRCMS_ISNPHY(wlc->band) && NREV_LT(wlc->band->phyrev, 2))
		ampdu->rx_factor = IEEE80211_HT_MAX_AMPDU_32K;
	else
		ampdu->rx_factor = IEEE80211_HT_MAX_AMPDU_64K;
	ampdu->retry_limit = AMPDU_DEF_RETRY_LIMIT;
	ampdu->rr_retry_limit = AMPDU_DEF_RR_RETRY_LIMIT;

	for (i = 0; i < AMPDU_MAX_SCB_TID; i++) {
		ampdu->retry_limit_tid[i] = ampdu->retry_limit;
		ampdu->rr_retry_limit_tid[i] = ampdu->rr_retry_limit;
	}

	brcms_c_scb_ampdu_update_max_txlen(ampdu, ampdu->dur);
	ampdu->mfbr = false;
	/* try to set ampdu to the default value */
	brcms_c_ampdu_set(ampdu, wlc->pub->_ampdu);

	ampdu->tx_max_funl = FFPLD_TX_MAX_UNFL;
	brcms_c_ffpld_init(ampdu);

	return ampdu;
}

void brcms_c_ampdu_detach(struct ampdu_info *ampdu)
{
	kfree(ampdu);
}

static void brcms_c_scb_ampdu_update_config(struct ampdu_info *ampdu,
					    struct scb *scb)
{
	struct scb_ampdu *scb_ampdu = &scb->scb_ampdu;
	int i;

	scb_ampdu->max_pdu = AMPDU_NUM_MPDU;

	/* go back to legacy size if some preloading is occurring */
	for (i = 0; i < NUM_FFPLD_FIFO; i++) {
		if (ampdu->fifo_tb[i].ampdu_pld_size > FFPLD_PLD_INCR)
			scb_ampdu->max_pdu = AMPDU_NUM_MPDU_LEGACY;
	}

	/* apply user override */
	if (ampdu->max_pdu != AUTO)
		scb_ampdu->max_pdu = (u8) ampdu->max_pdu;

	scb_ampdu->release = min_t(u8, scb_ampdu->max_pdu,
				   AMPDU_SCB_MAX_RELEASE);

	if (scb_ampdu->max_rx_ampdu_bytes)
		scb_ampdu->release = min_t(u8, scb_ampdu->release,
			scb_ampdu->max_rx_ampdu_bytes / 1600);

	scb_ampdu->release = min(scb_ampdu->release,
				 ampdu->fifo_tb[TX_AC_BE_FIFO].
				 mcs2ampdu_table[FFPLD_MAX_MCS]);
}

static void brcms_c_scb_ampdu_update_config_all(struct ampdu_info *ampdu)
{
	brcms_c_scb_ampdu_update_config(ampdu, &ampdu->wlc->pri_scb);
}

static void brcms_c_ffpld_calc_mcs2ampdu_table(struct ampdu_info *ampdu, int f)
{
	int i;
	u32 phy_rate, dma_rate, tmp;
	u8 max_mpdu;
	struct brcms_fifo_info *fifo = (ampdu->fifo_tb + f);

	/* recompute the dma rate */
	/* note : we divide/multiply by 100 to avoid integer overflows */
	max_mpdu = min_t(u8, fifo->mcs2ampdu_table[FFPLD_MAX_MCS],
			 AMPDU_NUM_MPDU_LEGACY);
	phy_rate = mcs_2_rate(FFPLD_MAX_MCS, true, false);
	dma_rate =
	    (((phy_rate / 100) *
	      (max_mpdu * FFPLD_MPDU_SIZE - fifo->ampdu_pld_size))
	     / (max_mpdu * FFPLD_MPDU_SIZE)) * 100;
	fifo->dmaxferrate = dma_rate;

	/* fill up the mcs2ampdu table; do not recalc the last mcs */
	dma_rate = dma_rate >> 7;
	for (i = 0; i < FFPLD_MAX_MCS; i++) {
		/* shifting to keep it within integer range */
		phy_rate = mcs_2_rate(i, true, false) >> 7;
		if (phy_rate > dma_rate) {
			tmp = ((fifo->ampdu_pld_size * phy_rate) /
			       ((phy_rate - dma_rate) * FFPLD_MPDU_SIZE)) + 1;
			tmp = min_t(u32, tmp, 255);
			fifo->mcs2ampdu_table[i] = (u8) tmp;
		}
	}
}

/* evaluate the dma transfer rate using the tx underflows as feedback.
 * If necessary, increase tx fifo preloading. If not enough,
 * decrease maximum ampdu size for each mcs till underflows stop
 * Return 1 if pre-loading not active, -1 if not an underflow event,
 * 0 if pre-loading module took care of the event.
 */
static int brcms_c_ffpld_check_txfunfl(struct brcms_c_info *wlc, int fid)
{
	struct ampdu_info *ampdu = wlc->ampdu;
	u32 phy_rate = mcs_2_rate(FFPLD_MAX_MCS, true, false);
	u32 txunfl_ratio;
	u8 max_mpdu;
	u32 current_ampdu_cnt = 0;
	u16 max_pld_size;
	u32 new_txunfl;
	struct brcms_fifo_info *fifo = (ampdu->fifo_tb + fid);
	uint xmtfifo_sz;
	u16 cur_txunfl;

	/* return if we got here for a different reason than underflows */
	cur_txunfl = brcms_b_read_shm(wlc->hw,
				      M_UCODE_MACSTAT +
				      offsetof(struct macstat, txfunfl[fid]));
	new_txunfl = (u16) (cur_txunfl - fifo->prev_txfunfl);
	if (new_txunfl == 0) {
		brcms_dbg_ht(wlc->hw->d11core,
			     ""TX status FRAG set but no tx underflows\n"");
		return -1;
	}
	fifo->prev_txfunfl = cur_txunfl;

	if (!ampdu->tx_max_funl)
		return 1;

	/* check if fifo is big enough */
	if (brcms_b_xmtfifo_sz_get(wlc->hw, fid, &xmtfifo_sz))
		return -1;

	if ((TXFIFO_SIZE_UNIT * (u32) xmtfifo_sz) <= ampdu->ffpld_rsvd)
		return 1;

	max_pld_size = TXFIFO_SIZE_UNIT * xmtfifo_sz - ampdu->ffpld_rsvd;
	fifo->accum_txfunfl += new_txunfl;

	/* we need to wait for at least 10 underflows */
	if (fifo->accum_txfunfl < 10)
		return 0;

	brcms_dbg_ht(wlc->hw->d11core, ""ampdu_count %d  tx_underflows %d\n"",
		     current_ampdu_cnt, fifo->accum_txfunfl);

	/*
	   compute the current ratio of tx unfl per ampdu.
	   When the current ampdu count becomes too
	   big while the ratio remains small, we reset
	   the current count in order to not
	   introduce too big of a latency in detecting a
	   large amount of tx underflows later.
	 */

	txunfl_ratio = current_ampdu_cnt / fifo->accum_txfunfl;

	if (txunfl_ratio > ampdu->tx_max_funl) {
		if (current_ampdu_cnt >= FFPLD_MAX_AMPDU_CNT)
			fifo->accum_txfunfl = 0;

		return 0;
	}
	max_mpdu = min_t(u8, fifo->mcs2ampdu_table[FFPLD_MAX_MCS],
			 AMPDU_NUM_MPDU_LEGACY);

	/* In case max value max_pdu is already lower than
	   the fifo depth, there is nothing more we can do.
	 */

	if (fifo->ampdu_pld_size >= max_mpdu * FFPLD_MPDU_SIZE) {
		fifo->accum_txfunfl = 0;
		return 0;
	}

	if (fifo->ampdu_pld_size < max_pld_size) {

		/* increment by TX_FIFO_PLD_INC bytes */
		fifo->ampdu_pld_size += FFPLD_PLD_INCR;
		if (fifo->ampdu_pld_size > max_pld_size)
			fifo->ampdu_pld_size = max_pld_size;

		/* update scb release size */
		brcms_c_scb_ampdu_update_config_all(ampdu);

		/*
		 * compute a new dma xfer rate for max_mpdu @ max mcs.
		 * This is the minimum dma rate that can achieve no
		 * underflow condition for the current mpdu size.
		 *
		 * note : we divide/multiply by 100 to avoid integer overflows
		 */
		fifo->dmaxferrate =
		    (((phy_rate / 100) *
		      (max_mpdu * FFPLD_MPDU_SIZE - fifo->ampdu_pld_size))
		     / (max_mpdu * FFPLD_MPDU_SIZE)) * 100;

		brcms_dbg_ht(wlc->hw->d11core,
			     ""DMA estimated transfer rate %d; ""
			     ""pre-load size %d\n"",
			     fifo->dmaxferrate, fifo->ampdu_pld_size);
	} else {

		/* decrease ampdu size */
		if (fifo->mcs2ampdu_table[FFPLD_MAX_MCS] > 1) {
			if (fifo->mcs2ampdu_table[FFPLD_MAX_MCS] == 255)
				fifo->mcs2ampdu_table[FFPLD_MAX_MCS] =
				    AMPDU_NUM_MPDU_LEGACY - 1;
			else
				fifo->mcs2ampdu_table[FFPLD_MAX_MCS] -= 1;

			/* recompute the table */
			brcms_c_ffpld_calc_mcs2ampdu_table(ampdu, fid);

			/* update scb release size */
			brcms_c_scb_ampdu_update_config_all(ampdu);
		}
	}
	fifo->accum_txfunfl = 0;
	return 0;
}

void
brcms_c_ampdu_tx_operational(struct brcms_c_info *wlc, u8 tid,
	u8 ba_wsize,		/* negotiated ba window size (in pdu) */
	uint max_rx_ampdu_bytes) /* from ht_cap in beacon */
{
	struct scb_ampdu *scb_ampdu;
	struct scb_ampdu_tid_ini *ini;
	struct ampdu_info *ampdu = wlc->ampdu;
	struct scb *scb = &wlc->pri_scb;
	scb_ampdu = &scb->scb_ampdu;

	if (!ampdu->ini_enable[tid]) {
		brcms_err(wlc->hw->d11core, ""%s: Rejecting tid %d\n"",
			  __func__, tid);
		return;
	}

	ini = &scb_ampdu->ini[tid];
	ini->tid = tid;
	ini->scb = scb_ampdu->scb;
	ini->ba_wsize = ba_wsize;
	scb_ampdu->max_rx_ampdu_bytes = max_rx_ampdu_bytes;
}

void brcms_c_ampdu_reset_session(struct brcms_ampdu_session *session,
				 struct brcms_c_info *wlc)
{
	session->wlc = wlc;
	skb_queue_head_init(&session->skb_list);
	session->max_ampdu_len = 0;    /* determined from first MPDU */
	session->max_ampdu_frames = 0; /* determined from first MPDU */
	session->ampdu_len = 0;
	session->dma_len = 0;
}

/*
 * Preps the given packet for AMPDU based on the session data. If the
 * frame cannot be accomodated in the current session, -ENOSPC is
 * returned.
 */
int brcms_c_ampdu_add_frame(struct brcms_ampdu_session *session,
			    struct sk_buff *p)
{
	struct brcms_c_info *wlc = session->wlc;
	struct ampdu_info *ampdu = wlc->ampdu;
	struct scb *scb = &wlc->pri_scb;
	struct scb_ampdu *scb_ampdu = &scb->scb_ampdu;
	struct ieee80211_tx_info *tx_info = IEEE80211_SKB_CB(p);
	struct ieee80211_tx_rate *txrate = tx_info->status.rates;
	struct d11txh *txh = (struct d11txh *)p->data;
	unsigned ampdu_frames;
	u8 ndelim, tid;
	u8 *plcp;
	uint len;
	u16 mcl;
	bool fbr_iscck;
	bool rr;

	ndelim = txh->RTSPLCPFallback[AMPDU_FBR_NULL_DELIM];
	plcp = (u8 *)(txh + 1);
	fbr_iscck = !(le16_to_cpu(txh->XtraFrameTypes) & 0x03);
	len = fbr_iscck ? BRCMS_GET_CCK_PLCP_LEN(txh->FragPLCPFallback) :
			  BRCMS_GET_MIMO_PLCP_LEN(txh->FragPLCPFallback);
	len = roundup(len, 4) + (ndelim + 1) * AMPDU_DELIMITER_LEN;

	ampdu_frames = skb_queue_len(&session->skb_list);
	if (ampdu_frames != 0) {
		struct sk_buff *first;

		if (ampdu_frames + 1 > session->max_ampdu_frames ||
		    session->ampdu_len + len > session->max_ampdu_len)
			return -ENOSPC;

		/*
		 * We aren't really out of space if the new frame is of
		 * a different priority, but we want the same behaviour
		 * so return -ENOSPC anyway.
		 *
		 * XXX: The old AMPDU code did this, but is it really
		 * necessary?
		 */
		first = skb_peek(&session->skb_list);
		if (p->priority != first->priority)
			return -ENOSPC;
	}

	/*
	 * Now that we're sure this frame can be accomodated, update the
	 * session information.
	 */
	session->ampdu_len += len;
	session->dma_len += p->len;

	tid = (u8)p->priority;

	/* Handle retry limits */
	if (txrate[0].count <= ampdu->rr_retry_limit_tid[tid]) {
		txrate[0].count++;
		rr = true;
	} else {
		txrate[1].count++;
		rr = false;
	}

	if (ampdu_frames == 0) {
		u8 plcp0, plcp3, is40, sgi, mcs;
		uint fifo = le16_to_cpu(txh->TxFrameID) & TXFID_QUEUE_MASK;
		struct brcms_fifo_info *f = &ampdu->fifo_tb[fifo];

		if (rr) {
			plcp0 = plcp[0];
			plcp3 = plcp[3];
		} else {
			plcp0 = txh->FragPLCPFallback[0];
			plcp3 = txh->FragPLCPFallback[3];

		}

		/* Limit AMPDU size based on MCS */
		is40 = (plcp0 & MIMO_PLCP_40MHZ) ? 1 : 0;
		sgi = plcp3_issgi(plcp3) ? 1 : 0;
		mcs = plcp0 & ~MIMO_PLCP_40MHZ;
		session->max_ampdu_len = min(scb_ampdu->max_rx_ampdu_bytes,
					     ampdu->max_txlen[mcs][is40][sgi]);

		session->max_ampdu_frames = scb_ampdu->max_pdu;
		if (mcs_2_rate(mcs, true, false) >= f->dmaxferrate) {
			session->max_ampdu_frames =
				min_t(u16, f->mcs2ampdu_table[mcs],
				      session->max_ampdu_frames);
		}
	}

	/*
	 * Treat all frames as ""middle"" frames of AMPDU here. First and
	 * last frames must be fixed up after all MPDUs have been prepped.
	 */
	mcl = le16_to_cpu(txh->MacTxControlLow);
	mcl &= ~TXC_AMPDU_MASK;
	mcl |= (TXC_AMPDU_MIDDLE << TXC_AMPDU_SHIFT);
	mcl &= ~(TXC_STARTMSDU | TXC_SENDRTS | TXC_SENDCTS);
	txh->MacTxControlLow = cpu_to_le16(mcl);
	txh->PreloadSize = 0;	/* always default to 0 */

	skb_queue_tail(&session->skb_list, p);

	return 0;
}

void brcms_c_ampdu_finalize(struct brcms_ampdu_session *session)
{
	struct brcms_c_info *wlc = session->wlc;
	struct ampdu_info *ampdu = wlc->ampdu;
	struct sk_buff *first, *last;
	struct d11txh *txh;
	struct ieee80211_tx_info *tx_info;
	struct ieee80211_tx_rate *txrate;
	u8 ndelim;
	u8 *plcp;
	uint len;
	uint fifo;
	struct brcms_fifo_info *f;
	u16 mcl;
	bool fbr;
	bool fbr_iscck;
	struct ieee80211_rts *rts;
	bool use_rts = false, use_cts = false;
	u16 dma_len = session->dma_len;
	u16 mimo_ctlchbw = PHY_TXC1_BW_20MHZ;
	u32 rspec = 0, rspec_fallback = 0;
	u32 rts_rspec = 0, rts_rspec_fallback = 0;
	u8 plcp0, plcp3, is40, sgi, mcs;
	u16 mch;
	u8 preamble_type = BRCMS_GF_PREAMBLE;
	u8 fbr_preamble_type = BRCMS_GF_PREAMBLE;
	u8 rts_preamble_type = BRCMS_LONG_PREAMBLE;
	u8 rts_fbr_preamble_type = BRCMS_LONG_PREAMBLE;

	if (skb_queue_empty(&session->skb_list))
		return;

	first = skb_peek(&session->skb_list);
	last = skb_peek_tail(&session->skb_list);

	/* Need to fix up last MPDU first to adjust AMPDU length */
	txh = (struct d11txh *)last->data;
	fifo = le16_to_cpu(txh->TxFrameID) & TXFID_QUEUE_MASK;
	f = &ampdu->fifo_tb[fifo];

	mcl = le16_to_cpu(txh->MacTxControlLow);
	mcl &= ~TXC_AMPDU_MASK;
	mcl |= (TXC_AMPDU_LAST << TXC_AMPDU_SHIFT);
	txh->MacTxControlLow = cpu_to_le16(mcl);

	/* remove the null delimiter after last mpdu */
	ndelim = txh->RTSPLCPFallback[AMPDU_FBR_NULL_DELIM];
	txh->RTSPLCPFallback[AMPDU_FBR_NULL_DELIM] = 0;
	session->ampdu_len -= ndelim * AMPDU_DELIMITER_LEN;

	/* remove the pad len from last mpdu */
	fbr_iscck = ((le16_to_cpu(txh->XtraFrameTypes) & 0x3) == 0);
	len = fbr_iscck ? BRCMS_GET_CCK_PLCP_LEN(txh->FragPLCPFallback) :
			  BRCMS_GET_MIMO_PLCP_LEN(txh->FragPLCPFallback);
	session->ampdu_len -= roundup(len, 4) - len;

	/* Now fix up the first MPDU */
	tx_info = IEEE80211_SKB_CB(first);
	txrate = tx_info->status.rates;
	txh = (struct d11txh *)first->data;
	plcp = (u8 *)(txh + 1);
	rts = (struct ieee80211_rts *)&txh->rts_frame;

	mcl = le16_to_cpu(txh->MacTxControlLow);
	/* If only one MPDU leave it marked as last */
	if (first != last) {
		mcl &= ~TXC_AMPDU_MASK;
		mcl |= (TXC_AMPDU_FIRST << TXC_AMPDU_SHIFT);
	}
	mcl |= TXC_STARTMSDU;
	if (ieee80211_is_rts(rts->frame_control)) {
		mcl |= TXC_SENDRTS;
		use_rts = true;
	}
	if (ieee80211_is_cts(rts->frame_control)) {
		mcl |= TXC_SENDCTS;
		use_cts = true;
	}
	txh->MacTxControlLow = cpu_to_le16(mcl);

	fbr = txrate[1].count > 0;
	if (!fbr) {
		plcp0 = plcp[0];
		plcp3 = plcp[3];
	} else {
		plcp0 = txh->FragPLCPFallback[0];
		plcp3 = txh->FragPLCPFallback[3];
	}
	is40 = (plcp0 & MIMO_PLCP_40MHZ) ? 1 : 0;
	sgi = plcp3_issgi(plcp3) ? 1 : 0;
	mcs = plcp0 & ~MIMO_PLCP_40MHZ;

	if (is40) {
		if (CHSPEC_SB_UPPER(wlc_phy_chanspec_get(wlc->band->pi)))
			mimo_ctlchbw = PHY_TXC1_BW_20MHZ_UP;
		else
			mimo_ctlchbw = PHY_TXC1_BW_20MHZ;
	}

	/* rebuild the rspec and rspec_fallback */
	rspec = RSPEC_MIMORATE;
	rspec |= plcp[0] & ~MIMO_PLCP_40MHZ;
	if (plcp[0] & MIMO_PLCP_40MHZ)
		rspec |= (PHY_TXC1_BW_40MHZ << RSPEC_BW_SHIFT);

	fbr_iscck = !(le16_to_cpu(txh->XtraFrameTypes) & 0x03);
	if (fbr_iscck) {
		rspec_fallback =
			cck_rspec(cck_phy2mac_rate(txh->FragPLCPFallback[0]));
	} else {
		rspec_fallback = RSPEC_MIMORATE;
		rspec_fallback |= txh->FragPLCPFallback[0] & ~MIMO_PLCP_40MHZ;
		if (txh->FragPLCPFallback[0] & MIMO_PLCP_40MHZ)
			rspec_fallback |= PHY_TXC1_BW_40MHZ << RSPEC_BW_SHIFT;
	}

	if (use_rts || use_cts) {
		rts_rspec =
			brcms_c_rspec_to_rts_rspec(wlc, rspec,
						   false, mimo_ctlchbw);
		rts_rspec_fallback =
			brcms_c_rspec_to_rts_rspec(wlc, rspec_fallback,
						   false, mimo_ctlchbw);
	}

	BRCMS_SET_MIMO_PLCP_LEN(plcp, session->ampdu_len);
	/* mark plcp to indicate ampdu */
	BRCMS_SET_MIMO_PLCP_AMPDU(plcp);

	/* reset the mixed mode header durations */
	if (txh->MModeLen) {
		u16 mmodelen = brcms_c_calc_lsig_len(wlc, rspec,
						     session->ampdu_len);
		txh->MModeLen = cpu_to_le16(mmodelen);
		preamble_type = BRCMS_MM_PREAMBLE;
	}
	if (txh->MModeFbrLen) {
		u16 mmfbrlen = brcms_c_calc_lsig_len(wlc, rspec_fallback,
						     session->ampdu_len);
		txh->MModeFbrLen = cpu_to_le16(mmfbrlen);
		fbr_preamble_type = BRCMS_MM_PREAMBLE;
	}

	/* set the preload length */
	if (mcs_2_rate(mcs, true, false) >= f->dmaxferrate) {
		dma_len = min(dma_len, f->ampdu_pld_size);
		txh->PreloadSize = cpu_to_le16(dma_len);
	} else {
		txh->PreloadSize = 0;
	}

	mch = le16_to_cpu(txh->MacTxControlHigh);

	/* update RTS dur fields */
	if (use_rts || use_cts) {
		u16 durid;
		if ((mch & TXC_PREAMBLE_RTS_MAIN_SHORT) ==
		    TXC_PREAMBLE_RTS_MAIN_SHORT)
			rts_preamble_type = BRCMS_SHORT_PREAMBLE;

		if ((mch & TXC_PREAMBLE_RTS_FB_SHORT) ==
		     TXC_PREAMBLE_RTS_FB_SHORT)
			rts_fbr_preamble_type = BRCMS_SHORT_PREAMBLE;

		durid = brcms_c_compute_rtscts_dur(wlc, use_cts, rts_rspec,
						   rspec, rts_preamble_type,
						   preamble_type,
						   session->ampdu_len, true);
		rts->duration = cpu_to_le16(durid);
		durid = brcms_c_compute_rtscts_dur(wlc, use_cts,
						   rts_rspec_fallback,
						   rspec_fallback,
						   rts_fbr_preamble_type,
						   fbr_preamble_type,
						   session->ampdu_len, true);
		txh->RTSDurFallback = cpu_to_le16(durid);
		/* set TxFesTimeNormal */
		txh->TxFesTimeNormal = rts->duration;
		/* set fallback rate version of TxFesTimeNormal */
		txh->TxFesTimeFallback = txh->RTSDurFallback;
	}

	/* set flag and plcp for fallback rate */
	if (fbr) {
		mch |= TXC_AMPDU_FBR;
		txh->MacTxControlHigh = cpu_to_le16(mch);
		BRCMS_SET_MIMO_PLCP_AMPDU(plcp);
		BRCMS_SET_MIMO_PLCP_AMPDU(txh->FragPLCPFallback);
	}

	brcms_dbg_ht(wlc->hw->d11core, ""wl%d: count %d ampdu_len %d\n"",
		     wlc->pub->unit, skb_queue_len(&session->skb_list),
		     session->ampdu_len);
}

static void
brcms_c_ampdu_rate_status(struct brcms_c_info *wlc,
			  struct ieee80211_tx_info *tx_info,
			  struct tx_status *txs, u8 mcs)
{
	struct ieee80211_tx_rate *txrate = tx_info->status.rates;
	int i;

	/* clear the rest of the rates */
	for (i = 2; i < IEEE80211_TX_MAX_RATES; i++) {
		txrate[i].idx = -1;
		txrate[i].count = 0;
	}
}

static void
brcms_c_ampdu_dotxstatus_complete(struct ampdu_info *ampdu, struct scb *scb,
			      struct sk_buff *p, struct tx_status *txs,
			      u32 s1, u32 s2)
{
	struct scb_ampdu *scb_ampdu;
	struct brcms_c_info *wlc = ampdu->wlc;
	struct scb_ampdu_tid_ini *ini;
	u8 bitmap[8], queue, tid;
	struct d11txh *txh;
	u8 *plcp;
	struct ieee80211_hdr *h;
	u16 seq, start_seq = 0, bindex, index, mcl;
	u8 mcs = 0;
	bool ba_recd = false, ack_recd = false;
	u8 suc_mpdu = 0, tot_mpdu = 0;
	uint supr_status;
	bool update_rate = true, retry = true, tx_error = false;
	u16 mimoantsel = 0;
	u8 antselid = 0;
	u8 retry_limit, rr_retry_limit;
	struct ieee80211_tx_info *tx_info = IEEE80211_SKB_CB(p);

#ifdef DEBUG
	u8 hole[AMPDU_MAX_MPDU];
	memset(hole, 0, sizeof(hole));
#endif

	scb_ampdu = &scb->scb_ampdu;
	tid = (u8) (p->priority);

	ini = &scb_ampdu->ini[tid];
	retry_limit = ampdu->retry_limit_tid[tid];
	rr_retry_limit = ampdu->rr_retry_limit_tid[tid];
	memset(bitmap, 0, sizeof(bitmap));
	queue = txs->frameid & TXFID_QUEUE_MASK;
	supr_status = txs->status & TX_STATUS_SUPR_MASK;

	if (txs->status & TX_STATUS_ACK_RCV) {
		if (TX_STATUS_SUPR_UF == supr_status)
			update_rate = false;

		WARN_ON(!(txs->status & TX_STATUS_INTERMEDIATE));
		start_seq = txs->sequence >> SEQNUM_SHIFT;
		bitmap[0] = (txs->status & TX_STATUS_BA_BMAP03_MASK) >>
		    TX_STATUS_BA_BMAP03_SHIFT;

		WARN_ON(s1 & TX_STATUS_INTERMEDIATE);
		WARN_ON(!(s1 & TX_STATUS_AMPDU));

		bitmap[0] |=
		    (s1 & TX_STATUS_BA_BMAP47_MASK) <<
		    TX_STATUS_BA_BMAP47_SHIFT;
		bitmap[1] = (s1 >> 8) & 0xff;
		bitmap[2] = (s1 >> 16) & 0xff;
		bitmap[3] = (s1 >> 24) & 0xff;

		bitmap[4] = s2 & 0xff;
		bitmap[5] = (s2 >> 8) & 0xff;
		bitmap[6] = (s2 >> 16) & 0xff;
		bitmap[7] = (s2 >> 24) & 0xff;

		ba_recd = true;
	} else {
		if (supr_status) {
			update_rate = false;
			if (supr_status == TX_STATUS_SUPR_BADCH) {
				brcms_err(wlc->hw->d11core,
					  ""%s: Pkt tx suppressed, illegal channel possibly %d\n"",
					  __func__, CHSPEC_CHANNEL(
					  wlc->default_bss->chanspec));
			} else {
				if (supr_status != TX_STATUS_SUPR_FRAG)
					brcms_err(wlc->hw->d11core,
						  ""%s: supr_status 0x%x\n"",
						  __func__, supr_status);
			}
			/* no need to retry for badch; will fail again */
			if (supr_status == TX_STATUS_SUPR_BADCH ||
			    supr_status == TX_STATUS_SUPR_EXPTIME) {
				retry = false;
			} else if (supr_status == TX_STATUS_SUPR_EXPTIME) {
				/* TX underflow:
				 *   try tuning pre-loading or ampdu size
				 */
			} else if (supr_status == TX_STATUS_SUPR_FRAG) {
				/*
				 * if there were underflows, but pre-loading
				 * is not active, notify rate adaptation.
				 */
				if (brcms_c_ffpld_check_txfunfl(wlc, queue) > 0)
					tx_error = true;
			}
		} else if (txs->phyerr) {
			update_rate = false;
			brcms_err(wlc->hw->d11core,
				  ""%s: ampdu tx phy error (0x%x)\n"",
				  __func__, txs->phyerr);
		}
	}

	/* loop through all pkts and retry if not acked */
	while (p) {
		tx_info = IEEE80211_SKB_CB(p);
		txh = (struct d11txh *) p->data;
		mcl = le16_to_cpu(txh->MacTxControlLow);
		plcp = (u8 *) (txh + 1);
		h = (struct ieee80211_hdr *)(plcp + D11_PHY_HDR_LEN);
		seq = le16_to_cpu(h->seq_ctrl) >> SEQNUM_SHIFT;

		trace_brcms_txdesc(&wlc->hw->d11core->dev, txh, sizeof(*txh));

		if (tot_mpdu == 0) {
			mcs = plcp[0] & MIMO_PLCP_MCS_MASK;
			mimoantsel = le16_to_cpu(txh->ABI_MimoAntSel);
		}

		index = TX_SEQ_TO_INDEX(seq);
		ack_recd = false;
		if (ba_recd) {
			bindex = MODSUB_POW2(seq, start_seq, SEQNUM_MAX);
			brcms_dbg_ht(wlc->hw->d11core,
				     ""tid %d seq %d, start_seq %d, bindex %d set %d, index %d\n"",
				     tid, seq, start_seq, bindex,
				     isset(bitmap, bindex), index);
			/* if acked then clear bit and free packet */
			if ((bindex < AMPDU_TX_BA_MAX_WSIZE)
			    && isset(bitmap, bindex)) {
				ini->txretry[index] = 0;

				/*
				 * ampdu_ack_len:
				 *   number of acked aggregated frames
				 */
				/* ampdu_len: number of aggregated frames */
				brcms_c_ampdu_rate_status(wlc, tx_info, txs,
							  mcs);
				tx_info->flags |= IEEE80211_TX_STAT_ACK;
				tx_info->flags |= IEEE80211_TX_STAT_AMPDU;
				tx_info->status.ampdu_ack_len =
					tx_info->status.ampdu_len = 1;

				skb_pull(p, D11_PHY_HDR_LEN);
				skb_pull(p, D11_TXH_LEN);

				ieee80211_tx_status_irqsafe(wlc->pub->ieee_hw,
							    p);
				ack_recd = true;
				suc_mpdu++;
			}
		}
		/* either retransmit or send bar if ack not recd */
		if (!ack_recd) {
			if (retry && (ini->txretry[index] < (int)retry_limit)) {
				int ret;
				ini->txretry[index]++;
				ret = brcms_c_txfifo(wlc, queue, p);
				/*
				 * We shouldn't be out of space in the DMA
				 * ring here since we're reinserting a frame
				 * that was just pulled out.
				 */
				WARN_ONCE(ret, ""queue %d out of txds\n"", queue);
			} else {
				/* Retry timeout */
				ieee80211_tx_info_clear_status(tx_info);
				tx_info->status.ampdu_ack_len = 0;
				tx_info->status.ampdu_len = 1;
				tx_info->flags |=
				    IEEE80211_TX_STAT_AMPDU_NO_BACK;
				skb_pull(p, D11_PHY_HDR_LEN);
				skb_pull(p, D11_TXH_LEN);
				brcms_dbg_ht(wlc->hw->d11core,
					     ""BA Timeout, seq %d\n"",
					     seq);
				ieee80211_tx_status_irqsafe(wlc->pub->ieee_hw,
							    p);
			}
		}
		tot_mpdu++;

		/* break out if last packet of ampdu */
		if (((mcl & TXC_AMPDU_MASK) >> TXC_AMPDU_SHIFT) ==
		    TXC_AMPDU_LAST)
			break;

		p = dma_getnexttxp(wlc->hw->di[queue], DMA_RANGE_TRANSMITTED);
	}

	/* update rate state */
	antselid = brcms_c_antsel_antsel2id(wlc->asi, mimoantsel);
}

void
brcms_c_ampdu_dotxstatus(struct ampdu_info *ampdu, struct scb *scb,
		     struct sk_buff *p, struct tx_status *txs)
{
	struct scb_ampdu *scb_ampdu;
	struct brcms_c_info *wlc = ampdu->wlc;
	struct scb_ampdu_tid_ini *ini;
	u32 s1 = 0, s2 = 0;
	struct ieee80211_tx_info *tx_info;

	tx_info = IEEE80211_SKB_CB(p);

	/* BMAC_NOTE: For the split driver, second level txstatus comes later
	 * So if the ACK was received then wait for the second level else just
	 * call the first one
	 */
	if (txs->status & TX_STATUS_ACK_RCV) {
		u8 status_delay = 0;

		/* wait till the next 8 bytes of txstatus is available */
		s1 = bcma_read32(wlc->hw->d11core, D11REGOFFS(frmtxstatus));
		while ((s1 & TXS_V) == 0) {
			udelay(1);
			status_delay++;
			if (status_delay > 10)
				return; /* error condition */
			s1 = bcma_read32(wlc->hw->d11core,
					 D11REGOFFS(frmtxstatus));
		}

		s2 = bcma_read32(wlc->hw->d11core, D11REGOFFS(frmtxstatus2));
	}

	if (scb) {
		scb_ampdu = &scb->scb_ampdu;
		ini = &scb_ampdu->ini[p->priority];
		brcms_c_ampdu_dotxstatus_complete(ampdu, scb, p, txs, s1, s2);
	} else {
		/* loop through all pkts and free */
		u8 queue = txs->frameid & TXFID_QUEUE_MASK;
		struct d11txh *txh;
		u16 mcl;
		while (p) {
			tx_info = IEEE80211_SKB_CB(p);
			txh = (struct d11txh *) p->data;
			trace_brcms_txdesc(&wlc->hw->d11core->dev, txh,
					   sizeof(*txh));
			mcl = le16_to_cpu(txh->MacTxControlLow);
			brcmu_pkt_buf_free_skb(p);
			/* break out if last packet of ampdu */
			if (((mcl & TXC_AMPDU_MASK) >> TXC_AMPDU_SHIFT) ==
			    TXC_AMPDU_LAST)
				break;
			p = dma_getnexttxp(wlc->hw->di[queue],
					   DMA_RANGE_TRANSMITTED);
		}
	}
}

void brcms_c_ampdu_macaddr_upd(struct brcms_c_info *wlc)
{
	char template[T_RAM_ACCESS_SZ * 2];

	/* driver needs to write the ta in the template; ta is at offset 16 */
	memset(template, 0, sizeof(template));
	memcpy(template, wlc->pub->cur_etheraddr, ETH_ALEN);
	brcms_b_write_template_ram(wlc->hw, (T_BA_TPL_BASE + 16),
				  (T_RAM_ACCESS_SZ * 2),
				  template);
}

bool brcms_c_aggregatable(struct brcms_c_info *wlc, u8 tid)
{
	return wlc->ampdu->ini_enable[tid];
}

void brcms_c_ampdu_shm_upd(struct ampdu_info *ampdu)
{
	struct brcms_c_info *wlc = ampdu->wlc;

	/*
	 * Extend ucode internal watchdog timer to
	 * match larger received frames
	 */
	if ((ampdu->rx_factor & IEEE80211_HT_AMPDU_PARM_FACTOR) ==
	    IEEE80211_HT_MAX_AMPDU_64K) {
		brcms_b_write_shm(wlc->hw, M_MIMO_MAXSYM, MIMO_MAXSYM_MAX);
		brcms_b_write_shm(wlc->hw, M_WATCHDOG_8TU, WATCHDOG_8TU_MAX);
	} else {
		brcms_b_write_shm(wlc->hw, M_MIMO_MAXSYM, MIMO_MAXSYM_DEF);
		brcms_b_write_shm(wlc->hw, M_WATCHDOG_8TU, WATCHDOG_8TU_DEF);
	}
}

/*
 * callback function that helps invalidating ampdu packets in a DMA queue
 */
static void dma_cb_fn_ampdu(void *txi, void *arg_a)
{
	struct ieee80211_sta *sta = arg_a;
	struct ieee80211_tx_info *tx_info = (struct ieee80211_tx_info *)txi;

	if ((tx_info->flags & IEEE80211_TX_CTL_AMPDU) &&
	    (tx_info->rate_driver_data[0] == sta || sta == NULL))
		tx_info->rate_driver_data[0] = NULL;
}

/*
 * When a remote party is no longer available for ampdu communication, any
 * pending tx ampdu packets in the driver have to be flushed.
 */
void brcms_c_ampdu_flush(struct brcms_c_info *wlc,
		     struct ieee80211_sta *sta, u16 tid)
{
	brcms_c_inval_dma_pkts(wlc->hw, sta, dma_cb_fn_ampdu);
}
",False,
29,29,NomosTestfiles/AGPL/apps.js,BSD,"// Copyright (c) 2011 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

var MAX_APPS_PER_ROW = [];
MAX_APPS_PER_ROW[LayoutMode.SMALL] = 4;
MAX_APPS_PER_ROW[LayoutMode.NORMAL] = 6;

function getAppsCallback(data) {
  logEvent('received apps');

  // In the case of prefchange-triggered updates, we don't receive this flag.
  // Just leave it set as it was before in that case.
  if ('showPromo' in data)
    apps.showPromo = data.showPromo;

  var appsSection = $('apps');
  var appsSectionContent = $('apps-content');
  var appsMiniview = appsSection.getElementsByClassName('miniview')[0];
  var appsPromo = $('apps-promo');
  var appsPromoLink = $('apps-promo-link');
  var appsPromoPing = APP_LAUNCH_URL.PING_WEBSTORE + '+' + apps.showPromo;
  var webStoreEntry, webStoreMiniEntry;

  // Hide menu options that are not supported on the OS or windowing system.

  // The ""Launch as Window"" menu option.
  $('apps-launch-type-window-menu-item').hidden = data.disableAppWindowLaunch;

  // The ""Create App Shortcut"" menu option.
  $('apps-create-shortcut-command-menu-item').hidden =
      $('apps-create-shortcut-command-separator').hidden =
          data.disableCreateAppShortcut;

  // Hide the context menu, if there is any open.
  cr.ui.contextMenuHandler.hideMenu();

  appsMiniview.textContent = '';
  appsSectionContent.textContent = '';

  data.apps.sort(function(a,b) {
    return a.app_launch_index - b.app_launch_index;
  });

  // Determines if the web store link should be detached and place in the
  // top right of the screen.
  apps.detachWebstoreEntry =
      !apps.showPromo && data.apps.length >= MAX_APPS_PER_ROW[layoutMode];

  markNewApps(data.apps);
  apps.data = data.apps;

  clearClosedMenu(apps.menu);

  // We wait for the app icons to load before displaying them, but never wait
  // longer than 200ms.
  apps.loadedImages = 0;
  apps.imageTimer = setTimeout(apps.showImages.bind(apps), 200);

  data.apps.forEach(function(app) {
    appsSectionContent.appendChild(apps.createElement(app));
  });

  if (data.showPromo) {
    // Add the promo content...
    $('apps-promo-heading').textContent = data.promoHeader;
    appsPromoLink.href = data.promoLink;
    appsPromoLink.textContent = data.promoButton;
    appsPromoLink.ping = appsPromoPing;
    $('apps-promo-hide').textContent = data.promoExpire;

    // ... then display the promo.
    document.documentElement.classList.add('apps-promo-visible');
  } else {
    document.documentElement.classList.remove('apps-promo-visible');
  }

  // Only show the web store entry if there are apps installed, since the promo
  // is sufficient otherwise.
  if (data.apps.length > 0) {
    webStoreEntry = apps.createWebStoreElement();
    webStoreEntry.querySelector('a').ping = appsPromoPing;
    appsSectionContent.appendChild(webStoreEntry);
    if (apps.detachWebstoreEntry) {
      webStoreEntry.classList.add('loner');
    } else {
      webStoreEntry.classList.remove('loner');
      apps.data.push('web-store-entry');
    }
  }

  data.apps.slice(0, MAX_MINIVIEW_ITEMS).forEach(function(app) {
    appsMiniview.appendChild(apps.createMiniviewElement(app));
    addClosedMenuEntryWithLink(apps.menu, apps.createClosedMenuElement(app));
  });
  if (data.apps.length < MAX_MINIVIEW_ITEMS) {
    webStoreMiniEntry = apps.createWebStoreMiniElement();
    webStoreMiniEntry.querySelector('a').ping = appsPromoPing;
    appsMiniview.appendChild(webStoreMiniEntry);
    addClosedMenuEntryWithLink(apps.menu,
                               apps.createWebStoreClosedMenuElement());
  }

  if (!data.showLauncher)
    hideSection(Section.APPS);
  else
    appsSection.classList.remove('disabled');

  addClosedMenuFooter(apps.menu, 'apps', MENU_APPS, Section.APPS);

  apps.loaded = true;

  if (appsPromoLink)
    appsPromoLink.ping = appsPromoPing;
  maybeDoneLoading();

  // Disable the animations when the app launcher is being (re)initailized.
  apps.layout({disableAnimations:true});

  if (isDoneLoading()) {
    updateMiniviewClipping(appsMiniview);
    layoutSections();
  }
}

function markNewApps(data) {
  var oldData = apps.data;
  data.forEach(function(app) {
    if (hashParams['app-id'] == app['id']) {
      delete hashParams['app-id'];
      app.isNew = true;
    } else if (oldData &&
        !oldData.some(function(id) { return id == app.id; })) {
      app.isNew = true;
    } else {
      app.isNew = false;
    }
  });
}

function appsPrefChangeCallback(data) {
  // Currently the only pref that is watched is the launch type.
  data.apps.forEach(function(app) {
    var appLink = document.querySelector('.app a[app-id=' + app['id'] + ']');
    if (appLink)
      appLink.setAttribute('launch-type', app['launch_type']);
  });
}

// Launches the specified app using the APP_LAUNCH_NTP_APP_RE_ENABLE histogram.
// This should only be invoked from the AppLauncherHandler.
function launchAppAfterEnable(appId) {
  chrome.send('launchApp', [appId, APP_LAUNCH.NTP_APP_RE_ENABLE]);
}

var apps = (function() {

  function createElement(app) {
    var div = document.createElement('div');
    div.className = 'app';

    var a = div.appendChild(document.createElement('a'));
    a.setAttribute('app-id', app['id']);
    a.setAttribute('launch-type', app['launch_type']);
    a.draggable = false;
    a.xtitle = a.textContent = app['name'];
    a.href = app['launch_url'];

    return div;
  }

  /**
   * Launches an application.
   * @param {string} appId Application to launch.
   * @param {MouseEvent} opt_mouseEvent Mouse event from the click that
   *     triggered the launch, used to detect modifier keys that change
   *     the tab's disposition.
   */
  function launchApp(appId, opt_mouseEvent) {
    var args = [appId, getAppLaunchType()];
    if (opt_mouseEvent) {
      // Launch came from a click - add details of the click
      // Otherwise it came from a 'command' event from elsewhere in the UI.
      args.push(opt_mouseEvent.altKey, opt_mouseEvent.ctrlKey,
                opt_mouseEvent.metaKey, opt_mouseEvent.shiftKey,
                opt_mouseEvent.button);
    }
    chrome.send('launchApp', args);
  }

  function isAppSectionMaximized() {
    return getAppLaunchType() == APP_LAUNCH.NTP_APPS_MAXIMIZED &&
      !$('apps').classList.contains('disabled');
  }

  function isAppsMenu(node) {
    return node.id == 'apps-menu';
  }

  function getAppLaunchType() {
    // We determine if the apps section is maximized, collapsed or in menu mode
    // based on the class of the apps section.
    if ($('apps').classList.contains('menu'))
      return APP_LAUNCH.NTP_APPS_MENU;
    else if ($('apps').classList.contains('collapsed'))
      return APP_LAUNCH.NTP_APPS_COLLAPSED;
    else
      return APP_LAUNCH.NTP_APPS_MAXIMIZED;
  }

  /**
   * @this {!HTMLAnchorElement}
   */
  function handleClick(e) {
    var appId = e.currentTarget.getAttribute('app-id');
    if (!appDragAndDrop.isDragging())
      launchApp(appId, e);
    return false;
  }

  // Keep in sync with LaunchType in extension_prefs.h
  var LaunchType = {
    LAUNCH_PINNED: 0,
    LAUNCH_REGULAR: 1,
    LAUNCH_FULLSCREEN: 2,
    LAUNCH_WINDOW: 3
  };

  // Keep in sync with LaunchContainer in extension_constants.h
  var LaunchContainer = {
    LAUNCH_WINDOW: 0,
    LAUNCH_PANEL: 1,
    LAUNCH_TAB: 2
  };

  var currentApp;
  var promoHasBeenSeen = false;

  function addContextMenu(el, app) {
    el.addEventListener('contextmenu', cr.ui.contextMenuHandler);
    el.addEventListener('keydown', cr.ui.contextMenuHandler);
    el.addEventListener('keyup', cr.ui.contextMenuHandler);

    Object.defineProperty(el, 'contextMenu', {
      get: function() {
        currentApp = app;

        $('apps-launch-command').label = app['name'];
        $('apps-options-command').canExecuteChange();

        var launchTypeEl;
        if (el.getAttribute('app-id') === app['id']) {
          launchTypeEl = el;
        } else {
          appLinkSel = 'a[app-id=' + app['id'] + ']';
          launchTypeEl = el.querySelector(appLinkSel);
        }

        var launchType = launchTypeEl.getAttribute('launch-type');
        var launchContainer = app['launch_container'];
        var isPanel = launchContainer == LaunchContainer.LAUNCH_PANEL;

        // Update the commands related to the launch type.
        var launchTypeIds = ['apps-launch-type-pinned',
                             'apps-launch-type-regular',
                             'apps-launch-type-fullscreen',
                             'apps-launch-type-window'];
        launchTypeIds.forEach(function(id) {
          var command = $(id);
          command.disabled = isPanel;
          command.checked = !isPanel &&
              launchType == command.getAttribute('launch-type');
        });

        return $('app-context-menu');
      }
    });
  }

  document.addEventListener('command', function(e) {
    if (!currentApp)
      return;

    var commandId = e.command.id;
    switch (commandId) {
      case 'apps-options-command':
        window.location = currentApp['options_url'];
        break;
      case 'apps-launch-command':
        launchApp(currentApp['id']);
        break;
      case 'apps-uninstall-command':
        chrome.send('uninstallApp', [currentApp['id']]);
        break;
      case 'apps-create-shortcut-command':
        chrome.send('createAppShortcut', [currentApp['id']]);
        break;
      case 'apps-launch-type-pinned':
      case 'apps-launch-type-regular':
      case 'apps-launch-type-fullscreen':
      case 'apps-launch-type-window':
        chrome.send('setLaunchType',
            [currentApp['id'],
             Number(e.command.getAttribute('launch-type'))]);
        break;
    }
  });

  document.addEventListener('canExecute', function(e) {
    switch (e.command.id) {
      case 'apps-options-command':
        e.canExecute = currentApp && currentApp['options_url'];
        break;
      case 'apps-launch-command':
        e.canExecute = true;
        break;
      case 'apps-uninstall-command':
        e.canExecute = !currentApp['can_uninstall'];
        break;
    }
  });

  // Moves the element at position |from| in array |arr| to position |to|.
  function arrayMove(arr, from, to) {
    var element = arr.splice(from, 1);
    arr.splice(to, 0, element[0]);
  }

  // The autoscroll rate during drag and drop, in px per second.
  var APP_AUTOSCROLL_RATE = 400;

  return {
    loaded: false,

    menu: $('apps-menu'),

    showPromo: false,

    detachWebstoreEntry: false,

    scrollMouseXY_: null,

    scrollListener_: null,

    // The list of app ids, in order, of each app in the launcher.
    data_: null,
    get data() { return this.data_; },
    set data(data) {
      this.data_ = data.map(function(app) {
        return app.id;
      });
      this.invalidate_();
    },

    dirty_: true,
    invalidate_: function() {
      this.dirty_ = true;
    },

    visible_: true,
    get visible() {
      return this.visible_;
    },
    set visible(visible) {
      this.visible_ = visible;
      this.invalidate_();
    },

    maybePingPromoSeen_: function() {
      if (promoHasBeenSeen || !this.showPromo || !isAppSectionMaximized())
        return;

      promoHasBeenSeen = true;
      chrome.send('promoSeen', []);
    },

    // DragAndDropDelegate

    dragContainer: $('apps-content'),
    transitionsDuration: 200,

    get dragItem() { return this.dragItem_; },
    set dragItem(dragItem) {
      if (this.dragItem_ != dragItem) {
        this.dragItem_ = dragItem;
        this.invalidate_();
      }
    },

    // The dimensions of each item in the app launcher.
    dimensions_: null,
    get dimensions() {
      if (this.dimensions_)
        return this.dimensions_;

      var width = 124;
      var height = 136;

      var marginWidth = 6;
      var marginHeight = 10;

      var borderWidth = 0;
      var borderHeight = 0;

      this.dimensions_ = {
        width: width + marginWidth + borderWidth,
        height: height + marginHeight + borderHeight
      };

      return this.dimensions_;
    },

    // Gets the item under the mouse event |e|. Returns null if there is no
    // item or if the item is not draggable.
    getItem: function(e) {
      var item = findAncestorByClass(e.target, 'app');

      // You can't drag the web store launcher.
      if (item && item.classList.contains('web-store-entry'))
        return null;

      return item;
    },

    // Returns true if |coordinates| point to a valid drop location. The
    // coordinates are relative to the drag container and the object should
    // have the 'x' and 'y' properties set.
    canDropOn: function(coordinates) {
      var cols = MAX_APPS_PER_ROW[layoutMode];
      var rows = Math.ceil(this.data.length / cols);

      var bottom = rows * this.dimensions.height;
      var right = cols * this.dimensions.width;

      if (coordinates.x >= right || coordinates.x < 0 ||
          coordinates.y >= bottom || coordinates.y < 0)
        return false;

      var position = this.getIndexAt_(coordinates);
      var appCount = this.data.length;

      if (!this.detachWebstoreEntry)
        appCount--;

      return position >= 0 && position < appCount;
    },

    setDragPlaceholder: function(coordinates) {
      var position = this.getIndexAt_(coordinates);
      var appId = this.dragItem.querySelector('a').getAttribute('app-id');
      var current = this.data.indexOf(appId);

      if (current == position || current < 0)
        return;

      arrayMove(this.data, current, position);
      this.invalidate_();
      this.layout();
    },

    getIndexAt_: function(coordinates) {
      var w = this.dimensions.width;
      var h = this.dimensions.height;

      var appsPerRow = MAX_APPS_PER_ROW[layoutMode];

      var row = Math.floor(coordinates.y / h);
      var col = Math.floor(coordinates.x / w);
      var index = appsPerRow * row + col;

      var appCount = this.data.length;
      var rows = Math.ceil(appCount / appsPerRow);

      // Rather than making the free space on the last row invalid, we
      // map it to the last valid position.
      if (index >= appCount && index < appsPerRow * rows)
        return appCount-1;

      return index;
    },

    scrollPage: function(xy) {
      var rect = this.dragContainer.getBoundingClientRect();

      // Here, we calculate the visible boundaries of the app launcher, which
      // are then used to determine when we should auto-scroll.
      var top = $('apps').getBoundingClientRect().bottom;
      var bottomFudge = 15; // Fudge factor due to a gradient mask.
      var bottom = top + maxiviewVisibleHeight - bottomFudge;
      var left = rect.left + window.scrollX;
      var right = Math.min(window.innerWidth, rect.left + rect.width);

      var dy = Math.min(0, xy.y - top) + Math.max(0, xy.y - bottom);
      var dx = Math.min(0, xy.x - left) + Math.max(0, xy.x - right);

      if (dx == 0 && dy == 0) {
        this.stopScroll_();
        return;
      }

      // If we scroll the page directly from this method, it may be choppy and
      // inconsistent. Instead, we loop using animation frames, and scroll at a
      // speed that's independent of how many times this method is called.
      this.scrollMouseXY_ = {dx: dx, dy: dy};

      if (!this.scrollListener_) {
        this.scrollListener_ = this.scrollImpl_.bind(this);
        this.scrollStep_();
      }
    },

    scrollStep_: function() {
      this.scrollStart_ = Date.now();
      window.webkitRequestAnimationFrame(this.scrollListener_);
    },

    scrollImpl_: function(time) {
      if (!appDragAndDrop.isDragging()) {
        this.stopScroll_();
        return;
      }

      if (!this.scrollMouseXY_)
        return;

      var step = time - this.scrollStart_;

      window.scrollBy(
          this.calcScroll_(this.scrollMouseXY_.dx, step),
          this.calcScroll_(this.scrollMouseXY_.dy, step));

      this.scrollStep_();
    },

    calcScroll_: function(delta, step) {
      if (delta == 0)
        return 0;

      // Increase the multiplier for every 50px the mouse is beyond the edge.
      var sign = delta > 0 ? 1 : -1;
      var scalar = APP_AUTOSCROLL_RATE * step / 1000;
      var multiplier = Math.floor(Math.abs(delta) / 50) + 1;

      return sign * scalar * multiplier;
    },

    stopScroll_: function() {
      this.scrollListener_ = null;
      this.scrollMouseXY_ = null;
    },

    saveDrag: function(draggedItem) {
      this.invalidate_();
      this.layout();

      var draggedAppId = draggedItem.querySelector('a').getAttribute('app-id');
      var appIds = this.data.filter(function(id) {
        return id != 'web-store-entry';
      });

      // Wait until the transitions are complete before notifying the browser.
      // Otherwise, the apps will be re-rendered while still transitioning.
      setTimeout(function() {
        chrome.send('reorderApps', [draggedAppId, appIds]);
      }, this.transitionsDuration + 10);
    },

    layout: function(options) {
      options = options || {};
      if (!this.dirty_ && options.force != true)
        return;

      try {
        var container = this.dragContainer;
        if (options.disableAnimations)
          container.setAttribute('launcher-animations', false);
        var d0 = Date.now();
        this.layoutImpl_();
        this.dirty_ = false;
        logEvent('apps.layout: ' + (Date.now() - d0));

      } finally {
        if (options.disableAnimations) {
          // We need to re-enable animations asynchronously, so that the
          // animations are still disabled for this layout update.
          setTimeout(function() {
            container.setAttribute('launcher-animations', true);
          }, 0);
        }
      }
    },

    layoutImpl_: function() {
      var apps = this.data || [];
      var rects = this.getLayoutRects_(apps.length);
      var appsContent = this.dragContainer;

      // Ping the PROMO_SEEN histogram only when the promo is maximized, and
      // maximum once per NTP load.
      this.maybePingPromoSeen_();

      if (!this.visible)
        return;

      for (var i = 0; i < apps.length; i++) {
        var app = appsContent.querySelector('[app-id='+apps[i]+']').parentNode;

        // If the node is being dragged, don't try to place it in the grid.
        if (app == this.dragItem)
          continue;

        app.style.left = rects[i].left + 'px';
        app.style.top = rects[i].top + 'px';
      }

      // We need to set the container's height manually because the apps use
      // absolute positioning.
      var rows = Math.ceil(apps.length / MAX_APPS_PER_ROW[layoutMode]);
      appsContent.style.height = (rows * this.dimensions.height) + 'px';
    },

    getLayoutRects_: function(appCount) {
      var availableWidth = this.dragContainer.offsetWidth;
      var rtl = isRtl();
      var rects = [];
      var w = this.dimensions.width;
      var h = this.dimensions.height;
      var appsPerRow = MAX_APPS_PER_ROW[layoutMode];

      for (var i = 0; i < appCount; i++) {
        var top = Math.floor(i / appsPerRow) * h;
        var left = (i % appsPerRow) * w;

        // Reflect the X axis if an RTL language is active.
        if (rtl)
          left = availableWidth - left - w;
        rects[i] = {left: left, top: top};
      }
      return rects;
    },

    get loadedImages() {
      return this.loadedImages_;
    },

    set loadedImages(value) {
      this.loadedImages_ = value;
      if (this.loadedImages_ == 0)
        return;

      // Each application icon is loaded asynchronously. Here, we display
      // the icons once they've all been loaded to make it look nicer.
      if (this.loadedImages_ == this.data.length) {
        this.showImages();
        return;
      }

      // We won't actually have the visible height until the sections have
      // been layed out.
      if (!maxiviewVisibleHeight)
        return;

      // If we know the visible height of the maxiview, then we can don't need
      // to wait for all the icons. Instead, we wait until the visible portion
      // have been loaded.
      var appsPerRow = MAX_APPS_PER_ROW[layoutMode];
      var rows = Math.ceil(maxiviewVisibleHeight / this.dimensions.height);
      var count = Math.min(appsPerRow * rows, this.data.length);
      if (this.loadedImages_ == count) {
        this.showImages();
        return;
      }
    },

    showImages: function() {
      $('apps-content').classList.add('visible');
      clearTimeout(this.imageTimer);
    },

    createElement: function(app) {
      var div = createElement(app);
      var a = div.firstChild;

      a.onclick = handleClick;
      a.ping = getAppPingUrl(
          'PING_BY_ID', this.showPromo, 'NTP_APPS_MAXIMIZED');
      a.style.backgroundImage = url(app['icon_big']);
      if (app.isNew) {
        div.setAttribute('new', 'new');
        // Delay changing the attribute a bit to let the page settle down a bit.
        setTimeout(function() {
          // Make sure the new icon is scrolled into view.
          document.body.scrollTop = document.body.scrollHeight;

          // This will trigger the 'bounce' animation defined in apps.css.
          div.setAttribute('new', 'installed');
        }, 500);
        div.addEventListener('webkitAnimationEnd', function(e) {
          div.removeAttribute('new');
        });
      }

      // CSS background images don't fire 'load' events, so we use an Image.
      var img = new Image();
      img.onload = function() { this.loadedImages++; }.bind(this);
      img.src = app['icon_big'];

      var settingsButton = div.appendChild(new cr.ui.ContextMenuButton);
      settingsButton.className = 'app-settings';
      settingsButton.title = localStrings.getString('appsettings');

      addContextMenu(div, app);

      return div;
    },

    createMiniviewElement: function(app) {
      var span = document.createElement('span');
      var a = span.appendChild(document.createElement('a'));

      a.setAttribute('app-id', app['id']);
      a.textContent = app['name'];
      a.href = app['launch_url'];
      a.onclick = handleClick;
      a.ping = getAppPingUrl(
          'PING_BY_ID', this.showPromo, 'NTP_APPS_COLLAPSED');
      a.style.backgroundImage = url(app['icon_small']);
      a.className = 'item';
      span.appendChild(a);

      addContextMenu(span, app);

      return span;
    },

    createClosedMenuElement: function(app) {
      var a = document.createElement('a');
      a.setAttribute('app-id', app['id']);
      a.textContent = app['name'];
      a.href = app['launch_url'];
      a.onclick = handleClick;
      a.ping = getAppPingUrl(
          'PING_BY_ID', this.showPromo, 'NTP_APPS_MENU');
      a.style.backgroundImage = url(app['icon_small']);
      a.className = 'item';

      addContextMenu(a, app);

      return a;
    },

    createWebStoreElement: function() {
      var elm = createElement({
        'id': 'web-store-entry',
        'name': localStrings.getString('web_store_title'),
        'launch_url': localStrings.getString('web_store_url')
      });
      elm.classList.add('web-store-entry');
      return elm;
    },

    createWebStoreMiniElement: function() {
      var span = document.createElement('span');
      span.appendChild(this.createWebStoreClosedMenuElement());
      return span;
    },

    createWebStoreClosedMenuElement: function() {
      var a = document.createElement('a');
      a.textContent = localStrings.getString('web_store_title');
      a.href = localStrings.getString('web_store_url');
      a.style.backgroundImage = url('chrome://theme/IDR_PRODUCT_LOGO_16');
      a.className = 'item';
      return a;
    }
  };
})();

// Enable drag and drop reordering of the app launcher.
var appDragAndDrop = new DragAndDropController(apps);
",False,"```
// Copyright (c) 2011 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

// ... (rest of the code) ...

```



Let me know if you have any other code snippets you'd like me to analyze!"
30,30,NomosTestfiles/AGPL/JsonMapper.php,AGPL,"<?php
/**
 * Part of JsonMapper
 *
 * PHP version 5
 *
 * @category Netresearch
 * @package  JsonMapper
 * @author   Christian Weiske <christian.weiske@netresearch.de>
 * @license  AGPL https://www.gnu.org/licenses/agpl
 * @link     http://www.netresearch.de/
 */

/**
 * Automatically map JSON structures into objects.
 *
 * @category Netresearch
 * @package  JsonMapper
 * @author   Christian Weiske <christian.weiske@netresearch.de>
 * @license  AGPL https://www.gnu.org/licenses/agpl
 * @link     http://www.netresearch.de/
 */
class JsonMapper
{
  /**
   * PSR-3 compatible logger object
   *
   * @link http://www.php-fig.org/psr/psr-3/
   * @var  object
   * @see  setLogger()
   */
  protected $logger;

  /**
   * Throw an exception when JSON data contain a property
   * that is not defined in the PHP class
   *
   * @var boolean
   */
  public $bExceptionOnUndefinedProperty = false;

  /**
   * Throw an exception if the JSON data miss a property
   * that is marked with @required in the PHP class
   *
   * @var boolean
   */
  public $bExceptionOnMissingData = false;

  /**
   * Runtime cache for inspected classes. This is particularly effective if 
   * mapArray() is called with a large number of objects
   * 
   * @var array property inspection result cache 
   */
  private $arInspectedClasses = array();

  /**
   * Map data all data in $json into the given $object instance.
   *
   * @param object $json   JSON object structure from json_decode()
   * @param object $object Object to map $json data into
   *
   * @return object Mapped object is returned.
   * @see    mapArray()
   */
  public function map($json, $object)
  {
    $strClassName = get_class($object);
    $rc = new ReflectionClass($object);
    $strNs = $rc->getNamespaceName();
    $providedProperties = array();
    foreach ($json as $key => $jvalue) {
      $providedProperties[$key] = true;

      // Store the property inspection results so we don't have to do it 
      // again for subsequent objects of the same type
      if (!isset($this->arInspectedClasses[$strClassName][$key])) {
        $this->arInspectedClasses[$strClassName][$key] = $this->inspectProperty($rc, $key);
      }

      list($hasProperty, $type, $setter) = $this->arInspectedClasses[$strClassName][$key];

      if (!$hasProperty) {
        if ($this->bExceptionOnUndefinedProperty) {
          throw new JsonMapper_Exception(
              'JSON property ""' . $key . '"" does not exist'
              . ' in object of type ' . $strClassName
              );
        }
        $this->log(
            'info',
            'Property {property} does not exist in {class}',
            array('property' => $key, 'class' => $strClassName)
            );
        continue;
      }

      if ($type === null) {
        //no given type - simply set the json data
        $this->setProperty($object, $key, $jvalue, $setter);
        continue;
      } else if ($this->isSimpleType($type)) {
        settype($jvalue, $type);
        $this->setProperty($object, $key, $jvalue, $setter);
        continue;
      }

      if ($type{0} != '\\') {
        //create a full qualified namespace
        if ($strNs != '') {
          $type = '\\' . $strNs . '\\' . $type;
        }
      }

      //FIXME: check if type exists, give detailled error message if not
      $array = null;
      $subtype = null;
      if (substr($type, -2) == '[]') {
        //array
        $array = array();
        $subtype = substr($type, 0, -2);
      } else if (substr($type, -1) == ']') {
        list($proptype, $subtype) = explode('[', substr($type, 0, -1));
        $array = new $proptype();
      } else if ($type == 'ArrayObject'
          || is_subclass_of($type, 'ArrayObject')
          ) {
        $array = new $type();
      }

      if ($array !== null) {
        if ($subtype{0} != '\\') {
          //create a full qualified namespace
          if ($strNs != '') {
            $subtype = $strNs . '\\' . $subtype;
          }
        }
        $child = $this->mapArray($jvalue, $array, $subtype);
      } else if ($this->isFlatType(gettype($jvalue))) {
        //use constructor parameter if we have a class
        // but only a flat type (i.e. string, int)
        if ($jvalue === null) {
          $child = null;
        } else {
          $child = new $type($jvalue);
        }
      } else {
        $child = new $type();
        $this->map($jvalue, $child);
      }
      $this->setProperty($object, $key, $child, $setter);
    }

    if ($this->bExceptionOnMissingData) {
      $this->checkMissingData($providedProperties, $rc);
    }

    return $object;
  }

  /**
   * Check required properties exist in json
   *
   * @param array  $providedProperties array with json properties
   * @param object $rc                 Reflection class to check
   *
   * @throws JsonMapper_Exception
   *
   * @return void
   */
  protected function checkMissingData($providedProperties, ReflectionClass $rc)
  {
    foreach ($rc->getProperties() as $property) {
      $rprop = $rc->getProperty($property->name);
      $docblock = $rprop->getDocComment();
      $annotations = $this->parseAnnotations($docblock);
      if (isset($annotations['required'])
          && !isset($providedProperties[$property->name])
         ) {
        throw new JsonMapper_Exception(
            'Required property ""' . $property->name . '"" of class '
            . $rc->getName()
            . ' is missing in JSON data'
            );
      }
    }
  }

  /**
   * Map an array
   *
   * @param array  $json  JSON array structure from json_decode()
   * @param mixed  $array Array or ArrayObject that gets filled with
   *                      data from $json
   * @param string $class Class name for children objects.
   *                      All children will get mapped onto this type.
   *                      Supports class names and simple types
   *                      like ""string"".
   *
   * @return mixed Mapped $array is returned
   */
  public function mapArray($json, $array, $class = null)
  {
    foreach ($json as $key => $jvalue) {
      if ($class === null) {
        $array[$key] = $jvalue;
      } else if ($this->isFlatType(gettype($jvalue))) {
        //use constructor parameter if we have a class
        // but only a flat type (i.e. string, int)
        if ($jvalue === null) {
          $array[$key] = null;
        } else {
          $array[$key] = new $class($jvalue);
        }
      } else {
        $array[$key] = $this->map($jvalue, new $class());
      }
    }
    return $array;
  }

  /**
   * Try to find out if a property exists in a given class.
   * Checks property first, falls back to setter method.
   *
   * @param object $rc   Reflection class to check
   * @param string $name Property name
   *
   * @return array First value: if the property exists
   *               Second value: type of the property
   *               Third value: the setter to use, otherwise null
   */
  protected function inspectProperty(ReflectionClass $rc, $name)
  {
    if ($rc->hasProperty($name)) {
      $rprop = $rc->getProperty($name);
      $docblock = $rprop->getDocComment();
      $annotations = $this->parseAnnotations($docblock);
      if (!isset($annotations['var'][0])) {
        return array(true, null, null);
      }

      //support ""@var type description""
      list($type) = explode(' ', $annotations['var'][0]);

      return array(true, $type, null);
    }

    $setter = 'set' . ucfirst($name);
    if ($rc->hasMethod($setter)) {
      $rmeth = $rc->getMethod($setter);
      $rparams = $rmeth->getParameters();
      if (count($rparams) > 0) {
        $pclass = $rparams[0]->getClass();
        if ($pclass !== null) {
          return array(true, $pclass->getName(), $rmeth);
        }
      }
      $docblock = $rmeth->getDocComment();
      $annotations = $this->parseAnnotations($docblock);
      if (!isset($annotations['param'][0])) {
        return array(true, null, $rmeth);
      }
      list($type) = explode(' ', trim($annotations['param'][0]));
      return array(true, $type, $rmeth);
    }

    return array(false, null, null);
  }

  /**
   * Set a property on a given object to a given value
   *
   * @param object $object Object to set property on
   * @param string $name   Property name
   * @param mixed  $value  Value of property
   * @param ReflectionMethod $setter the setter to use, null if no setter 
   * should be used
   *
   * @return void
   */
  protected function setProperty($object, $name, $value, $setter)
  {
    $rc = new ReflectionClass($object);
    if ($setter === null && $rc->getProperty($name)->isPublic()) {
      $object->$name = $value;
    } elseif ($setter && $setter->isPublic()) {
      $object->{$setter->getName()}($value);
    } else {
      $this->log(
          'error',
          'Property {class}::{property} cannot be set from outside',
          array('property' => $name, 'class' => get_class($object))
          );
    }
  }

  /**
   * Checks if the given type is a ""simple type""
   *
   * @param string $type type name from gettype()
   *
   * @return boolean True if it is a simple PHP type
   */
  protected function isSimpleType($type)
  {
    return $type == 'string'
      || $type == 'boolean' || $type == 'bool'
      || $type == 'integer' || $type == 'int'
      || $type == 'float' || $type == 'array' || $type == 'object';
  }

  /**
   * Checks if the given type is a type that is not nested
   * (simple type except array and object)
   *
   * @param string $type type name from gettype()
   *
   * @return boolean True if it is a non-nested PHP type
   */
  protected function isFlatType($type)
  {
    return $type == 'NULL'
      || $type == 'string'
      || $type == 'boolean' || $type == 'bool'
      || $type == 'integer' || $type == 'int'
      || $type == 'float';
  }

  /**
   * Copied from PHPUnit 3.7.29, Util/Test.php
   *
   * @param string $docblock Full method docblock
   *
   * @return array
   */
  protected static function parseAnnotations($docblock)
  {
    $annotations = array();
    // Strip away the docblock header and footer
    // to ease parsing of one line annotations
    $docblock = substr($docblock, 3, -2);

    $re = '/@(?P<name>[A-Za-z_-]+)(?:[ \t]+(?P<value>.*?))?[ \t]*\r?$/m';
    if (preg_match_all($re, $docblock, $matches)) {
      $numMatches = count($matches[0]);

      for ($i = 0; $i < $numMatches; ++$i) {
        $annotations[$matches['name'][$i]][] = $matches['value'][$i];
      }
    }

    return $annotations;
  }

  /**
   * Log a message to the $logger object
   *
   * @param string $level   Logging level
   * @param string $message Text to log
   * @param array  $context Additional information
   *
   * @return null
   */
  protected function log($level, $message, array $context = array())
  {
    if ($this->logger) {
      $this->logger->log($level, $message, $context);
    }
  }

  /**
   * Sets a logger instance on the object
   *
   * @param LoggerInterface $logger PSR-3 compatible logger object
   *
   * @return null
   */
  public function setLogger($logger)
  {
    $this->logger = $logger;
  }
}
",False,"```
/**
 * Part of JsonMapper
 *
 * PHP version 5
 *
 * @category Netresearch
 * @package  JsonMapper
 * @author   Christian Weiske <christian.weiske@netresearch.de>
 * @license  AGPL https://www.gnu.org/licenses/agpl
 * @link     http://www.netresearch.de/
 */
```"
31,31,NomosTestfiles/AGPL/pm2-copyright.txt,AGPL-3.0-only,"Format: http://www.debian.org/doc/packaging-manuals/copyright-format/1.0/
Upstream-Name: PM2
Upstream-Contact: Alexandre Strzelewicz <alexandre@keymetrics.io>
Source: http://pm2.o/

Files: *
Copyright: 2013-present, Keymetrics
License: AGPLv3",False,"```
Copyright: 2013-present, Keymetrics
License: AGPLv3
```"
32,32,NomosTestfiles/AGPL/readme.rst,AGPL-3.0-or-later,"********************************************************
JsonMapper - map nested JSON structures onto PHP classes
********************************************************

.. image:: https://api.travis-ci.org/netresearch/jsonmapper.png
:target: https://travis-ci.org/netresearch/jsonmapper
:align: right

Takes data retrieved from a JSON__ web service and converts them
into nested object and arrays - using your own model classes.

Starting from a base object, it maps JSON data on class properties,
         converting them into the correct simple types or objects.

         It's a bit like the native SOAP parameter mapping PHP's ``SoapClient``
         gives you, but for JSON.
         Note that it does not rely on any schema, only your class definitions.

         Type detection works by parsing ``@var`` docblock annotations of
         class properties, as well as type hints in setter methods.

         You do not have to modify your model classes by adding JSON specific code;
         it works automatically by parsing already-existing docblocks.

         __ http://json.org/


         .. contents::

         ============
         Pro & contra
         ============

         Benefits
         ========
         - Autocompletion in IDEs
         - It's easy to add comfort methods to data model classes
         - Your JSON API may change, but your models can stay the same - not
         breaking applications that use the model classes.

         Drawbacks
         =========
         - Model classes need to be written by hand

         Since JsonMapper does not rely on any schema information
         (e.g. from `json-schema`__), model classes cannot be generated
         automatically.

         __ http://json-schema.org/


         =====
         Usage
         =====

         Basic usage
         ===========
#. Register an autoloader that can load `PSR-0`__ compatible classes.
#. Create a ``JsonMapper`` object instance
#. Call the ``map`` or ``mapArray`` method, depending on your data

         Map a normal object:

         .. code:: php

         <?php
         require 'autoload.php';
         $mapper = new JsonMapper();
         $contactObject = $mapper->map($jsonContact, new Contact());
         ?>

         Map an array of objects:

         .. code:: php

         <?php
         require 'autoload.php';
         $mapper = new JsonMapper();
         $contactsArray = $mapper->mapArray(
             $jsonContacts, new ArrayObject(), 'Contact'
             );
         ?>

         __ http://www.php-fig.org/psr/psr-0/


         Example
         =======
         JSON from a address book web service:

         .. code:: javascript

{
  'name':'Sheldon Cooper',
  'address': {
    'street': '2311 N. Los Robles Avenue',
    'city': 'Pasadena'
  }
}

Your local ``Contact`` class:

  .. code:: php

  <?php
  class Contact
{
  /**
   * Full name
   * @var string
   */
  public $name;

  /**
   * @var Address
   */
  public $address;
}
?>

Your local ``Address`` class:

  .. code:: php

  <?php
  class Address
{
  public $street;
  public $city;

  public function getGeoCoords()
  {
    //do something with the $street and $city
  }
}
?>

Your application code:

.. code:: php

<?php
$json = json_decode(file_get_contents('http://example.org/bigbang.json'));
$mapper = new JsonMapper();
$contact = $mapper->map($json, new Contact());

echo ""Geo coordinates for "" . $contact->name . "": ""
. var_export($contact->address->getGeoCoords(), true);
?>


Property type documentation
===========================
``JsonMapper`` uses several sources to detect the correct type of
a property:

#. ``@var $type`` docblock annotation of class properties::

/**
 * @var \my\application\model\Contact
 */
public $person;

#. If the property does not exist, the setter method
(``set`` + ``ucfirst($propertyname)``) is inspected

#. If it has a type hint in the method signature, this type used::

public function setPerson(Contact $person) {...}

#. The method's docblock is inspected for ``@param $type`` annotations::

/**
 * @param Contact $person Main contact for this application
 */
public function setPerson($person) {...}

#. If all fails, the plain JSON data is set to the property

Supported type names:

- Simple types:

- ``string``
- ``bool``, ``boolean``
- ``int``, ``integer``
- ``float``
- ``array``
- ``object``
- Class names, with and without namespaces
- Arrays of simple types and class names:

  - ``int[]``
  - ``Contact[]``
  - ArrayObjects of simple types and class names:

    - ``ContactList[Contact]``
    - ``NumberList[int]``

    ArrayObjects and extending classes are treated as arrays.

    See `phpdoc's type documentation`__ for more information.

    __ http://phpdoc.org/docs/latest/references/phpdoc/types.html


    Simple type mapping
    -------------------
    When an object shall be created but the JSON contains a simple type
    only (e.g. string, float, boolean), this value is passed to
    the classes' constructor. Example:

    PHP code::

    /**
     * @var DateTime
     */
    public $date;

    JSON::

{""date"":""2014-05-15""}

This will result in ``new DateTime('2014-05-15')`` being called.


Logging
=======
JsonMapper's ``setLogger()`` method supports all PSR-3__ compatible
logger instances.

Events that get logged:

- JSON data contain a key, but the class does not have a property
or setter method for it.
- Neither setter nor property can be set from outside because they
are protected or private

__ http://www.php-fig.org/psr/psr-3/


Handling invalid or missing data
================================
During development, APIs often change.
To get notified about such changes, JsonMapper may throw exceptions
in case of either missing or yet unknown data.


Unknown properties
------------------
When JsonMapper sees properties in the JSON data that are
not defined in the PHP class, you can let it throw an exception
by setting ``$bExceptionOnUndefinedProperty``:

.. code:: php

$jm = new JsonMapper();
$jm->bExceptionOnUndefinedProperty = true;
$jm->map(...);


Missing properties
------------------
Properties in your PHP classes can be marked as ""required"" by
putting ``@required`` in their docblock:

.. code:: php

/**
 * @var string
 * @required
 */
public $someDatum;

When the JSON data do not contain this property, JsonMapper will throw
an exception when ``$bExceptionOnMissingData`` is activated:

.. code:: php

$jm = new JsonMapper();
$jm->bExceptionOnMissingData = true;
$jm->map(...);


============
Installation
============

via PEAR
========
::

$ pear channel-discover pear.nrdev.de
$ pear install nr/jsonmapper-alpha

via composer
============
Add the following to your ``composer.json``:

.. code:: javascript

{
  ""require"": {
    ""netresearch/jsonmapper"": ""0.*""
  }
}

Then run::

$ php composer.phar install


================
Related software
================
- `Jackson's data binding`__ for Java

__ http://wiki.fasterxml.com/JacksonDataBinding


================
About JsonMapper
================

License
=======
JsonMapper is licensed under the `AGPL v3`__ or later.

__ http://www.gnu.org/licenses/agpl


Author
======
`Christian Weiske`__, `Netresearch GmbH & Co KG`__

__ mailto:christian.weiske@netresearch.de
__ http://www.netresearch.de/
",False,"```
License
=======
JsonMapper is licensed under the `AGPL v3`__ or later.

__ http://www.gnu.org/licenses/agpl
```"
33,33,NomosTestfiles/Aladdin/Aladdin.txt,Aladdin,"Aladdin Free Public License
(Version 8, November 18, 1999)

Copyright (C) 1994, 1995, 1997, 1998, 1999 Aladdin Enterprises,
Menlo Park, California, U.S.A. All rights reserved.

    NOTE: This License is not the same as any of the GNU Licenses published by the Free Software Foundation. Its terms are substantially different from those of the GNU Licenses. If you are familiar with the GNU Licenses, please read this license with extra care. 

Aladdin Enterprises hereby grants to anyone the permission to apply this License to their own work, as long as the entire License (including the above notices and this paragraph) is copied with no changes, additions, or deletions except for changing the first paragraph of Section 0 to include a suitable description of the work to which the license is being applied and of the person or entity that holds the copyright in the work, and, if the License is being applied to a work created in a country other than the United States, replacing the first paragraph of Section 6 with an appropriate reference to the laws of the appropriate country.
0. Subject Matter

This License applies to the computer program known as ""Aladdin Ghostscript."" The ""Program"", below, refers to such program. The Program is a copyrighted work whose copyright is held by Aladdin Enterprises (the ""Licensor""). Please note that Aladdin Ghostscript is neither the program known as ""GNU Ghostscript"" nor the version of Ghostscript available for commercial licensing from Artifex Software Inc.

A ""work based on the Program"" means either the Program or any derivative work of the Program, as defined in the United States Copyright Act of 1976, such as a translation or a modification.

BY MODIFYING OR DISTRIBUTING THE PROGRAM (OR ANY WORK BASED ON THE PROGRAM), YOU INDICATE YOUR ACCEPTANCE OF THIS LICENSE TO DO SO, AND ALL ITS TERMS AND CONDITIONS FOR COPYING, DISTRIBUTING OR MODIFYING THE PROGRAM OR WORKS BASED ON IT. NOTHING OTHER THAN THIS LICENSE GRANTS YOU PERMISSION TO MODIFY OR DISTRIBUTE THE PROGRAM OR ITS DERIVATIVE WORKS. THESE ACTIONS ARE PROHIBITED BY LAW. IF YOU DO NOT ACCEPT THESE TERMS AND CONDITIONS, DO NOT MODIFY OR DISTRIBUTE THE PROGRAM.
1. Licenses.

Licensor hereby grants you the following rights, provided that you comply with all of the restrictions set forth in this License and provided, further, that you distribute an unmodified copy of this License with the Program:

(a)
    You may copy and distribute literal (i.e., verbatim) copies of the Program's source code as you receive it throughout the world, in any medium. 
(b)
    You may modify the Program, create works based on the Program and distribute copies of such throughout the world, in any medium. 

2. Restrictions.

This license is subject to the following restrictions:

(a)
    Distribution of the Program or any work based on the Program by a commercial organization to any third party is prohibited if any payment is made in connection with such distribution, whether directly (as in payment for a copy of the Program) or indirectly (as in payment for some service related to the Program, or payment for some product or service that includes a copy of the Program ""without charge""; these are only examples, and not an exhaustive enumeration of prohibited activities). The following methods of distribution involving payment shall not in and of themselves be a violation of this restriction:

    (i)
        Posting the Program on a public access information storage and retrieval service for which a fee is received for retrieving information (such as an on-line service), provided that the fee is not content-dependent (i.e., the fee would be the same for retrieving the same volume of information consisting of random data) and that access to the service and to the Program is available independent of any other product or service. An example of a service that does not fall under this section is an on-line service that is operated by a company and that is only available to customers of that company. (This is not an exhaustive enumeration.) 
    (ii)
        Distributing the Program on removable computer-readable media, provided that the files containing the Program are reproduced entirely and verbatim on such media, that all information on such media be redistributable for non-commercial purposes without charge, and that such media are distributed by themselves (except for accompanying documentation) independent of any other product or service. Examples of such media include CD-ROM, magnetic tape, and optical storage media. (This is not intended to be an exhaustive list.) An example of a distribution that does not fall under this section is a CD-ROM included in a book or magazine. (This is not an exhaustive enumeration.) 

(b)
    Activities other than copying, distribution and modification of the Program are not subject to this License and they are outside its scope. Functional use (running) of the Program is not restricted, and any output produced through the use of the Program is subject to this license only if its contents constitute a work based on the Program (independent of having been made by running the Program). 
(c)
    You must meet all of the following conditions with respect to any work that you distribute or publish that in whole or in part contains or is derived from the Program or any part thereof (""the Work""):

    (i)
        If you have modified the Program, you must cause the Work to carry prominent notices stating that you have modified the Program's files and the date of any change. In each source file that you have modified, you must include a prominent notice that you have modified the file, including your name, your e-mail address (if any), and the date and purpose of the change; 
    (ii)
        You must cause the Work to be licensed as a whole and at no charge to all third parties under the terms of this License; 
    (iii)
        If the Work normally reads commands interactively when run, you must cause it, at each time the Work commences operation, to print or display an announcement including an appropriate copyright notice and a notice that there is no warranty (or else, saying that you provide a warranty). Such notice must also state that users may redistribute the Work only under the conditions of this License and tell the user how to view the copy of this License included with the Work. (Exceptions: if the Program is interactive but normally prints or displays such an announcement only at the request of a user, such as in an ""About box"", the Work is required to print or display the notice only under the same circumstances; if the Program itself is interactive but does not normally print such an announcement, the Work is not required to print an announcement.); 
    (iv)
        You must accompany the Work with the complete corresponding machine-readable source code, delivered on a medium customarily used for software interchange. The source code for a work means the preferred form of the work for making modifications to it. For an executable work, complete source code means all the source code for all modules it contains, plus any associated interface definition files, plus the scripts used to control compilation and installation of the executable code. If you distribute with the Work any component that is normally distributed (in either source or binary form) with the major components (compiler, kernel, and so on) of the operating system on which the executable runs, you must also distribute the source code of that component if you have it and are allowed to do so; 
    (v)
        If you distribute any written or printed material at all with the Work, such material must include either a written copy of this License, or a prominent written indication that the Work is covered by this License and written instructions for printing and/or displaying the copy of the License on the distribution medium; 
    (vi)
        You may not impose any further restrictions on the recipient's exercise of the rights granted herein. 

If distribution of executable or object code is made by offering the equivalent ability to copy from a designated place, then offering equivalent ability to copy the source code from the same place counts as distribution of the source code, even though third parties are not compelled to copy the source code along with the object code.
3. Reservation of Rights.

No rights are granted to the Program except as expressly set forth herein. You may not copy, modify, sublicense, or distribute the Program except as expressly provided under this License. Any attempt otherwise to copy, modify, sublicense or distribute the Program is void, and will automatically terminate your rights under this License. However, parties who have received copies, or rights, from you under this License will not have their licenses terminated so long as such parties remain in full compliance.
4. Other Restrictions.

If the distribution and/or use of the Program is restricted in certain countries for any reason, Licensor may add an explicit geographical distribution limitation excluding those countries, so that distribution is permitted only in or among countries not thus excluded. In such case, this License incorporates the limitation as if written in the body of this License.
5. Limitations.

THE PROGRAM IS PROVIDED TO YOU ""AS IS,"" WITHOUT WARRANTY. THERE IS NO WARRANTY FOR THE PROGRAM, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF THIRD PARTY RIGHTS. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.

IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL LICENSOR, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
6. General.

This License is governed by the laws of the State of California, U.S.A., excluding choice of law rules.

If any part of this License is found to be in conflict with the law, that part shall be interpreted in its broadest meaning consistent with the law, and no other parts of the License shall be affected.

For United States Government users, the Program is provided with RESTRICTED RIGHTS. If you are a unit or agency of the United States Government or are acquiring the Program for any such unit or agency, the following apply:

    If the unit or agency is the Department of Defense (""DOD""), the Program and its documentation are classified as ""commercial computer software"" and ""commercial computer software documentation"" respectively and, pursuant to DFAR Section 227.7202, the Government is acquiring the Program and its documentation in accordance with the terms of this License. If the unit or agency is other than DOD, the Program and its documentation are classified as ""commercial computer software"" and ""commercial computer software documentation"" respectively and, pursuant to FAR Section 12.212, the Government is acquiring the Program and its documentation in accordance with the terms of this License. 


",False,"```
Aladdin Free Public License
(Version 8, November 18, 1999)

Copyright (C) 1994, 1995, 1997, 1998, 1999 Aladdin Enterprises,
Menlo Park, California, U.S.A. All rights reserved.

    NOTE: This License is not the same as any of the GNU Licenses published by the Free Software Foundation. Its terms are substantially different from those of the GNU Licenses. If you are familiar with the GNU Licenses, please read this license with extra care. 

Aladdin Enterprises hereby grants to anyone the permission to apply this License to their own work, as long as the entire License (including the above notices and this paragraph) is copied with no changes, additions, or deletions except for changing the first paragraph of Section 0 to include a suitable description of the work to which the license is being applied and of the person or entity that holds the copyright in the work, and, if the License is being applied to a work created in a country other than the United States, replacing the first paragraph of Section 6 with an appropriate reference to the laws of the appropriate country.
0. Subject Matter

This License applies to the computer program known as ""Aladdin Ghostscript."" The ""Program"", below, refers to such program. The Program is a copyrighted work whose copyright is held by Aladdin Enterprises (the ""Licensor""). Please note that Aladdin Ghostscript is neither the program known as ""GNU Ghostscript"" nor the version of Ghostscript available for commercial licensing from Artifex Software Inc.

A ""work based on the Program"" means either the Program or any derivative work of the Program, as defined in the United States Copyright Act of 1976, such as a translation or a modification.

BY MODIFYING OR DISTRIBUTING THE PROGRAM (OR ANY WORK BASED ON THE PROGRAM), YOU INDICATE YOUR ACCEPTANCE OF THIS LICENSE TO DO SO, AND ALL ITS TERMS AND CONDITIONS FOR COPYING, DISTRIBUTING OR MODIFYING THE PROGRAM OR WORKS BASED ON IT. NOTHING OTHER THAN THIS LICENSE GRANTS YOU PERMISSION TO MODIFY OR DISTRIBUTE THE PROGRAM OR ITS DERIVATIVE WORKS. THESE ACTIONS ARE PROHIBITED BY LAW. IF YOU DO NOT ACCEPT THESE TERMS AND CONDITIONS, DO NOT MODIFY OR DISTRIBUTE THE PROGRAM.
1. Licenses.

Licensor hereby grants you the following rights, provided that you comply with all of the restrictions set forth in this License and provided, further, that you distribute an unmodified copy of this License with the Program:

(a)
    You may copy and distribute literal (i.e., verbatim) copies of the Program's source code as you receive it throughout the world, in any medium. 
(b)
    You may modify the Program, create works based on the Program and distribute copies of such throughout the world, in any medium. 

2. Restrictions.

This license is subject to the following restrictions:

(a)
    Distribution of the Program or any work based on the Program by a commercial organization to any third party is prohibited if any payment is made in connection with such distribution, whether directly (as in payment for a copy of the Program) or indirectly (as in payment for some service related to the Program, or payment for some product or service that includes a copy of the Program ""without charge""; these are only examples, and not an exhaustive enumeration of prohibited activities). The following methods of distribution involving payment shall not in and of themselves be a violation of this restriction:

    (i)
        Posting the Program on a public access information storage and retrieval service for which a fee is received for retrieving information (such as an on-line service), provided that the fee is not content-dependent (i.e., the fee would be the same for retrieving the same volume of information consisting of random data) and that access to the service and to the Program is available independent of any other product or service. An example of a service that does not fall under this section is an on-line service that is operated by a company and that is only available to customers of that company. (This is not an exhaustive enumeration.) 
    (ii)
        Distributing the Program on removable computer-readable media, provided that the files containing the Program are reproduced entirely and verbatim on such media, that all information on such media be redistributable for non-commercial purposes without charge, and that such media are distributed by themselves (except for accompanying documentation) independent of any other product or service. Examples of such media include CD-ROM, magnetic tape, and optical storage media. (This is not intended to be an exhaustive list.) An example of a distribution that does not fall under this section is a CD-ROM included in a book or magazine. (This is not an exhaustive enumeration.) 

(b)
    Activities other than copying, distribution and modification of the Program are not subject to this License and they are outside its scope. Functional use (running) of the Program is not restricted, and any output produced through the use of the Program is subject to this license only if its contents constitute a work based on the Program (independent of having been made by running the Program). 
(c)
    You must meet all of the following conditions with respect to any work that you distribute or publish that in whole or in part contains or is derived from the Program or any part thereof (""the Work""):

    (i)
        If you have modified the Program, you must cause the Work to carry prominent notices stating that you have modified the Program's files and the date of any change. In each source file that you have modified, you must include a prominent notice that you have modified the file, including your name, your e-mail address (if any), and the date and purpose of the change; 
    (ii)
        You must cause the Work to be licensed as a whole and at no charge to all third parties under the terms of this License; 
    (iii)
        If the Work normally reads commands interactively when run, you must cause it, at each time the Work commences operation, to print or display an announcement including an appropriate copyright notice and a notice that there is no warranty (or else, saying that you provide a warranty). Such notice must also state that users may redistribute the Work only under the conditions of this License and tell the user how to view the copy of this License included with the Work. (Exceptions: if the Program is interactive but normally prints or displays such an announcement only at the request of a user, such as in an ""About box"", the Work is required to print or display the notice only under the same circumstances; if the Program itself is interactive but does not normally print such an announcement, the Work is not required to print an announcement.); 
    (iv)
        You must accompany the Work with the complete corresponding machine-readable source code, delivered on a medium customarily used for software interchange. The source code for a work means the preferred form of the work for making modifications to it. For an executable work, complete source code means all the source code for all modules it contains, plus any associated interface definition files, plus the scripts used to control compilation and installation of the executable code. If you distribute with the Work any component that is normally distributed (in either source or binary form) with the major components (compiler, kernel, and so on) of the operating system on which the executable runs, you must also distribute the source code of that component if you have it and are allowed to do so; 
    (v)
        If you distribute any written or printed material at all with the Work, such material must include either a written copy of this License, or a prominent written indication that the Work is covered by this License and written instructions for printing and/or displaying the copy of the License on the distribution medium; 
    (vi)
        You may not impose any further restrictions on the recipient's exercise of the rights granted herein. 

If distribution of executable or object code is made by offering the equivalent ability to copy from a designated place, then offering equivalent ability to copy the source code from the same place counts as distribution of the source code, even though third parties are not compelled to copy the source code along with the object code.
3. Reservation of Rights.

No rights are granted to the Program except as expressly set forth herein. You may not copy, modify, sublicense, or distribute the Program except as expressly provided under this License. Any attempt otherwise to copy, modify, sublicense or distribute the Program is void, and will automatically terminate your rights under this License. However, parties who have received copies, or rights, from you under this License will not have their licenses terminated so long as such parties remain in full compliance.
4. Other Restrictions.

If the distribution and/or use of the Program is restricted in certain countries for any reason, Licensor may add an explicit geographical distribution limitation excluding those countries, so that distribution is permitted only in or among countries not thus excluded. In such case, this License incorporates the limitation as if written in the body of this License.
5. Limitations.

THE PROGRAM IS PROVIDED TO YOU ""AS IS,"" WITHOUT WARRANTY. THERE IS NO WARRANTY FOR THE PROGRAM, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF THIRD PARTY RIGHTS. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.

IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL LICENSOR, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
6. General.

This License is governed by the laws of the State of California, U.S.A., excluding choice of law rules.

If any part of this License is found to be in conflict with the law, that part shall be interpreted in its broadest meaning consistent with the law, and no other parts of the License shall be affected.

For United States Government users, the Program is provided with RESTRICTED RIGHTS. If you are a unit or agency of the United States Government or are acquiring the Program for any such unit or agency, the following apply:

    If the unit or agency is the Department of Defense (""DOD""), the Program and its documentation are classified as ""commercial computer software"" and ""commercial computer software documentation"" respectively and, pursuant to DFAR Section 227.7202, the Government is acquiring the Program and its documentation in accordance with the terms of this License. If the unit or agency is other than DOD, the Program and its documentation are classified as ""commercial computer software"" and ""commercial computer software documentation"" respectively and, pursuant to FAR Section 12.212, the Government is acquiring the Program and its documentation in accordance with the terms of this License.



```"
34,34,NomosTestfiles/Aladdin/LICENSE.txt,"Aladdin
LPPL-1.3+","Distribution and modification of the the URW Garamond fonts are subject to the
Aladdin Free Public License <http://www.artifex.com/downloads/doc/Public.htm>

  Copyright (c) 2000 URW++ Design & Development

The font GaramondNo8 Italic has been modified, as compared with the version
from the original distribution site <http://www.artifex.com/downloads/>;
credits to Ralf Stubner for fixing the broken quotedblleft character.


The TeX font metrics, virtual fonts and font definition files for URW Garamond,
i.e., the files in the archive ugm.zip, may be distributed and/or modified
under the conditions of the LaTeX Project Public License, either version 1.3 of
this license or (at your option) any later version.  The latest version of this
license is in http://www.latex-project.org/lppl.txt and version 1.3 or later is
part of all distributions of LaTeX version 2003/12/01 or later.

  Copyright (c) 2005 Walter Schmidt


Various aspects of the font were subsequently improved and (contagiously)
released under the Aladdin Free Public License.

  Copyright (c) 2009 Gael Varoquaux
  Copyright (c) 2010 Rogerio Theodoro de Brito
  Copyright (c) 2010 Khaled Hosny


Finally, these fonts were converted by Gaetan Bisson to TrueType format using
FontForge, for use in an X environment. No additional restriction applies.

Files provided ""as is"", with no warranties.

",False,"```
Distribution and modification of the the URW Garamond fonts are subject to the
Aladdin Free Public License <http://www.artifex.com/downloads/doc/Public.htm>

  Copyright (c) 2000 URW++ Design & Development

```"
35,35,NomosTestfiles/Amazon/ADSL.txt,ADSL,"This software code is made available ""AS IS"" without warranties of any
kind. You may copy, display, modify and redistribute the software
code either by itself or as incorporated into your code; provided that >
you do not remove any proprietary notices.  Your use of this software
code is at your own risk and you waive any claim against Amazon Digital
Services, Inc. or its affiliates with respect to your use of this
software code. (c) 2006 Amazon Digital Services, Inc. or its
affiliates.
",False,"```
This software code is made available ""AS IS"" without warranties of any
kind. You may copy, display, modify and redistribute the software
code either by itself or as incorporated into your code; provided that >
you do not remove any proprietary notices.  Your use of this software
code is at your own risk and you waive any claim against Amazon Digital
Services, Inc. or its affiliates with respect to your use of this
software code. (c) 2006 Amazon Digital Services, Inc. or its
affiliates. 
```"
36,36,NomosTestfiles/AML/AML.txt,AML,"Copyright:  Copyright (c) 2006 by Apple Computer, Inc., All Rights Reserved.

IMPORTANT:  This Apple software is supplied to you by Apple Computer,
  Inc. (""Apple"") in consideration of your agreement to the following
  terms, and your use, installation, modification or redistribution of
  this Apple software constitutes acceptance of these terms.  If you do
  not agree with these terms, please do not use, install, modify or
  redistribute this Apple software.

  In consideration of your agreement to abide by the following terms, and
  subject to these terms, Apple grants you a personal, non-exclusive
  license, under Apple's copyrights in this original Apple software (the
      ""Apple Software""), to use, reproduce, modify and redistribute the Apple
  Software, with or without modifications, in source and/or binary forms;
  provided that if you redistribute the Apple Software in its entirety and
  without modifications, you must retain this notice and the following
  text and disclaimers in all such redistributions of the Apple Software.
   Neither the name, trademarks, service marks or logos of Apple Computer,
   Inc. may be used to endorse or promote products derived from the Apple
   Software without specific prior written permission from Apple.  Except
   as expressly stated in this notice, no other rights or licenses, express
   or implied, are granted by Apple herein, including but not limited to
   any patent rights that may be infringed by your derivative works or by
   other works in which the Apple Software may be incorporated.

   The Apple Software is provided by Apple on an ""AS IS"" basis.  APPLE
   MAKES NO WARRANTIES, EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION
   THE IMPLIED WARRANTIES OF NON-INFRINGEMENT, MERCHANTABILITY AND FITNESS
   FOR A PARTICULAR PURPOSE, REGARDING THE APPLE SOFTWARE OR ITS USE AND
   OPERATION ALONE OR IN COMBINATION WITH YOUR PRODUCTS.

   IN NO EVENT SHALL APPLE BE LIABLE FOR ANY SPECIAL, INDIRECT, INCIDENTAL
   OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
       SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
       INTERRUPTION) ARISING IN ANY WAY OUT OF THE USE, REPRODUCTION,
   MODIFICATION AND/OR DISTRIBUTION OF THE APPLE SOFTWARE, HOWEVER CAUSED
   AND WHETHER UNDER THEORY OF CONTRACT, TORT (INCLUDING NEGLIGENCE),
   STRICT LIABILITY OR OTHERWISE, EVEN IF APPLE HAS BEEN ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE.
",False,"```
Copyright:  Copyright (c) 2006 by Apple Computer, Inc., All Rights Reserved.

IMPORTANT:  This Apple software is supplied to you by Apple Computer,
  Inc. (""Apple"") in consideration of your agreement to the following
  terms, and your use, installation, modification or redistribution of
  this Apple software constitutes acceptance of these terms.  If you do
  not agree with these terms, please do not use, install, modify or
  redistribute this Apple software.

  In consideration of your agreement to abide by the following terms, and
  subject to these terms, Apple grants you a personal, non-exclusive
  license, under Apple's copyrights in this original Apple software (the
      ""Apple Software""), to use, reproduce, modify and redistribute the Apple
  Software, with or without modifications, in source and/or binary forms;
  provided that if you redistribute the Apple Software in its entirety and
  without modifications, you must retain this notice and the following
  text and disclaimers in all such redistributions of the Apple Software.
   Neither the name, trademarks, service marks or logos of Apple Computer,
   Inc. may be used to endorse or promote products derived from the Apple
   Software without specific prior written permission from Apple.  Except
   as expressly stated in this notice, no other rights or licenses, express
   or implied, are granted by Apple herein, including but not limited to
   any patent rights that may be infringed by your derivative works or by
   other works in which the Apple Software may be incorporated.

   The Apple Software is provided by Apple on an ""AS IS"" basis.  APPLE
   MAKES NO WARRANTIES, EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION
   THE IMPLIED WARRANTIES OF NON-INFRINGEMENT, MERCHANTABILITY AND FITNESS
   FOR A PARTICULAR PURPOSE, REGARDING THE APPLE SOFTWARE OR ITS USE AND
   OPERATION ALONE OR IN COMBINATION WITH YOUR PRODUCTS.

   IN NO EVENT SHALL APPLE BE LIABLE FOR ANY SPECIAL, INDIRECT, INCIDENTAL
   OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
       SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
       INTERRUPTION) ARISING IN ANY WAY OUT OF THE USE, REPRODUCTION,
   MODIFICATION AND/OR DISTRIBUTION OF THE APPLE SOFTWARE, HOWEVER CAUSED
   AND WHETHER UNDER THEORY OF CONTRACT, TORT (INCLUDING NEGLIGENCE),
   STRICT LIABILITY OR OTHERWISE, EVEN IF APPLE HAS BEEN ADVISED OF THE
   POSSIBILITY OF SUCH DAMAGE.
```"
37,37,NomosTestfiles/ANTLR-PD/ANTLR-PD.txt,ANTLR-PD,"
SOFTWARE RIGHTS

ANTLR 1989-2006 Developed by Terence Parr
Partially supported by University of San Francisco &amp; jGuru.com

We reserve no legal rights to the ANTLR--it is fully in the
public domain. An individual or company may do whatever
they wish with source code distributed with ANTLR or the
code generated by ANTLR, including the incorporation of
ANTLR, or its output, into commerical software.

We encourage users to develop software with ANTLR. However,
we do ask that credit is given to us for developing
ANTLR. By ""credit"", we mean that if you use ANTLR or
incorporate any source code into one of your programs
(commercial product, research project, or otherwise) that
you acknowledge this fact somewhere in the documentation,
research report, etc... If you like ANTLR and have
developed a nice tool with the output, please mention that
you developed it using ANTLR. In addition, we ask that the
headers remain intact in our source code. As long as these
guidelines are kept, we expect to continue enhancing this
system and expect to make other tools available as they are
completed.

The primary ANTLR guy:

Terence Parr
parrt@cs.usfca.edu
parrt@antlr.org
",False,"```
SOFTWARE RIGHTS

ANTLR 1989-2006 Developed by Terence Parr
Partially supported by University of San Francisco &amp; jGuru.com

We reserve no legal rights to the ANTLR--it is fully in the
public domain. An individual or company may do whatever
they wish with source code distributed with ANTLR or the
code generated by ANTLR, including the incorporation of
ANTLR, or its output, into commerical software.

We encourage users to develop software with ANTLR. However,
we do ask that credit is given to us for developing
ANTLR. By ""credit"", we mean that if you use ANTLR or
incorporate any source code into one of your programs
(commercial product, research project, or otherwise) that
you acknowledge this fact somewhere in the documentation,
research report, etc... If you like ANTLR and have
developed a nice tool with the output, please mention that
you developed it using ANTLR. In addition, we ask that the
headers remain intact in our source code. As long as these
guidelines are kept, we expect to continue enhancing this
system and expect to make other tools available as they are
completed.

The primary ANTLR guy:

Terence Parr
parrt@cs.usfca.edu
parrt@antlr.org
```"
38,38,NomosTestfiles/Apache/abs_s.h,"3GPP
Apache-2.0","
/* ------------------------------------------------------------------
* Copyright (C) 1998-2009 PacketVideo
*
* Licensed under the Apache License, Version 2.0 (the ""License"");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an ""AS IS"" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
* express or implied.
* See the License for the specific language governing permissions
* and limitations under the License.
* -------------------------------------------------------------------
*/
/****************************************************************************************
Portions of this file are derived from the following 3GPP standard:

3GPP TS 26.073
ANSI-C code for the Adaptive Multi-Rate (AMR) speech codec
Available from http://www.3gpp.org

(C) 2004, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TTA, TTC)
Permission to distribute, modify and use this file under the standard license
terms listed above has been obtained from the copyright holder.
****************************************************************************************/
/*

Pathname: ./gsm-amr/c/include/abs_s.h

------------------------------------------------------------------------------
REVISION HISTORY

Description: Created separate header file for abs_s function.

Description: Updated template to make it build for Symbian.

Description: Moved _cplusplus #ifdef after Include section.

Who: Date:
Description:

------------------------------------------------------------------------------
INCLUDE DESCRIPTION

This file contains all the constant definitions and prototype definitions
needed by the abs_s function.

------------------------------------------------------------------------------
*/

/*----------------------------------------------------------------------------
; CONTINUE ONLY IF NOT ALREADY DEFINED
----------------------------------------------------------------------------*/
#ifndef ABS_S_H
#define ABS_S_H

/*----------------------------------------------------------------------------
; INCLUDES
----------------------------------------------------------------------------*/
#include ""basicop_malloc.h""

/*--------------------------------------------------------------------------*/
#ifdef __cplusplus
extern ""C""
{
#endif

/*----------------------------------------------------------------------------
; MACROS
; Define module specific macros here
----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------
; DEFINES
; Include all pre-processor statements here.
----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------
; EXTERNAL VARIABLES REFERENCES
; Declare variables used in this module but defined elsewhere
----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------
; SIMPLE TYPEDEF'S
----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------
; ENUMERATED TYPEDEF'S
----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------
; STRUCTURES TYPEDEF'S
----------------------------------------------------------------------------*/

/*----------------------------------------------------------------------------
; GLOBAL FUNCTION DEFINITIONS
; Function Prototype declaration
----------------------------------------------------------------------------*/
Word16 abs_s(Word16 var1);

/*----------------------------------------------------------------------------
; END
----------------------------------------------------------------------------*/
#ifdef __cplusplus
}
#endif

#endif /* ABS_S_H */
",False,"```
/* ------------------------------------------------------------------
* Copyright (C) 1998-2009 PacketVideo
*
* Licensed under the Apache License, Version 2.0 (the ""License"");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an ""AS IS"" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
* express or implied.
* See the License for the specific language governing permissions
* and limitations under the License.
* -------------------------------------------------------------------
*/
```"
39,40,NomosTestfiles/Apache/Apache-1.0.c,Apache-1.0,"/*
** THIS IS A TEST FILE FOR THE SPDX LICENSE DETECTION TESTS											
**																										
** This file has been auto generated using the SPDX License List as represented by
** the JSON files:  https://github.com/spdx/license-list-data 
** 
** This file is for test purposes only. It WILL NOT compile or do anything useful otherwise.
**
** Test File Version: 1.0 No SPDX Identifiers - License List version 2.6
**
** DISCLAIMER
**
** Any copyrights appearing in this test file do so because they were part of the license text as stored by SPDX and are included 
** only for test purposes as they are part of the license text.	They have no meaning, implied or specific, otherwise.	
*/




/*
** LICENSE HEADER AND COPYRIGHT TO DETECT	
** This section either uses either the standard license header, or if one does not exist, the license 
** text as shown on the SPDX License List. In addition, if the file was generated using the write 
** license identifiers option, they will appear before the license text.
** 										
**
** SPDX License to detect: https://spdx.org/licenses/Apache-1.0.html				
*/


// REUSE-IgnoreStart
/* SPDX-License-Identifier: Apache-1.0 */
// REUSE-IgnoreEnd
/*
Copyright (c) 1995-1999 The Apache Group. All rights
reserved.

Redistribution and use in source and binary forms, with or
without modification, are permitted provided that the following
conditions are met:

1. Redistributions of source code must retain the
above copyright notice, this list of conditions and the following
disclaimer. 

2. Redistributions in binary form must reproduce the
above copyright notice, this list of conditions and the following
disclaimer in the documentation and/or other materials provided with
the distribution.

3. All advertising materials mentioning features or
use of this software must display the following acknowledgment: ""This
product includes software developed by the Apache Group for use in the
Apache HTTP server project (http://www.apache.org/).""

4. The ""Apache""
and ""Apache Software Foundation"" must not be used to endorse or
promote products derived from this software without prior written
permission. For written permission, please contact
apache@apache.org

5. Products derived from this software may not be
called ""Apache"" nor may ""Apache"" appear in their name, without prior
written permission of the Apache Group.

6. Redistributions of any
form whatsoever must retain the following acknowledgment: 
""This
product includes software developed by the Apache Group for use in the
Apache HTTP server project (http://www.apache.org/).

THIS SOFTWARE IS
PROVIDED BY THE APACHE GROUP ``AS IS'' AND ANY EXPRESSED OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
IN NO EVENT SHALL THE APACHE GROUP OR ITS CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER
IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. 

 This software consists
of voluntary contributions made by many individuals on behalf of the
Apache Group and was originally based on public domain software
written at the National Center for Supercomputing Applications,
University of Illinois, Urbana-Champaign. For more information on the
Apache Group and the Apache HTTP server project, please see
<http://www.apache.org/>. 
*/

/*
** Fake code so we have something.
*/
#include <nothing.h>


int
noop_fun(int arg1)
{
	short retval;
	
	recalculatearg(&arg1);
	
	switch (arg1)
	{
		case 0:
			if (arg1) {
					retval = 1;
			} else {
			retval = 2;
			}
		case 1:
			retval = 2;
		case 2:
			retval = morpharg(arg1);
		case 3:
			if (arg1) {
				retval = 6;
			} else {
				retval = 7;
			}
		case 4:
			retval = upscalearg(arg1);
		default:
			retval = 0;
	}
	
	return retval;
}

",False,"```
/* SPDX-License-Identifier: Apache-1.0 */
/*
Copyright (c) 1995-1999 The Apache Group. All rights
reserved.

Redistribution and use in source and binary forms, with or
without modification, are permitted provided that the following
conditions are met:

1. Redistributions of source code must retain the
above copyright notice, this list of conditions and the following
disclaimer. 

2. Redistributions in binary form must reproduce the
above copyright notice, this list of conditions and the following
disclaimer in the documentation and/or other materials provided with
the distribution.

3. All advertising materials mentioning features or
use of this software must display the following acknowledgment: ""This
product includes software developed by the Apache Group for use in the
Apache HTTP server project (http://www.apache.org/).""

4. The ""Apache""
and ""Apache Software Foundation"" must not be used to endorse or
promote products derived from this software without prior written
permission. For written permission, please contact
apache@apache.org

5. Products derived from this software may not be
called ""Apache"" nor may ""Apache"" appear in their name, without prior
written permission of the Apache Group.

6. Redistributions of any
form whatsoever must retain the following acknowledgment: 
""This
product includes software developed by the Apache Group for use in the
Apache HTTP server project (http://www.apache.org/).

THIS SOFTWARE IS
PROVIDED BY THE APACHE GROUP ``AS IS'' AND ANY EXPRESSED OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
IN NO EVENT SHALL THE APACHE GROUP OR ITS CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER
IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. 

 This software consists
of voluntary contributions made by many individuals on behalf of the
Apache Group and was originally based on public domain software
written at the National Center for Supercomputing Applications,
University of Illinois, Urbana-Champaign. For more information on the
Apache Group and the Apache HTTP server project, please see
<http://www.apache.org/>. 
*/
```"
40,41,NomosTestfiles/Apache/Apache-1.0.txt,Apache-1.0,"Copyright (c) 1995-1999 The Apache Group.  All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
 
1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. 
 
2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

3. All advertising materials mentioning features or use of this software must display the following acknowledgment:
 ""This product includes software developed by the Apache Group for use in the Apache HTTP server project (http://www.apache.org/).""
 
4. The names ""Apache Server"" and ""Apache Group"" must not be used to endorse or promote products derived from this software without prior written permission. For written permission, please contact apache@apache.org.
 
5. Products derived from this software may not be called ""Apache"" nor may ""Apache"" appear in their names without prior written permission of the Apache Group.

6. Redistributions of any form whatsoever must retain the following acknowledgment:
 ""This product includes software developed by the Apache Group for use in the Apache HTTP server project (http://www.apache.org/).""
 
THIS SOFTWARE IS PROVIDED BY THE APACHE GROUP ``AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE APACHE GROUP OR ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software consists of voluntary contributions made by many individuals on behalf of the Apache Group and was originally based on public domain software written at the National Center for Supercomputing Applications, University of Illinois, Urbana-Champaign. For more information on the Apache Group and the Apache HTTP server
 project, please see http://www.apache.org/.
 
",False,"```
Copyright (c) 1995-1999 The Apache Group.  All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
 
1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. 
 
2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

3. All advertising materials mentioning features or use of this software must display the following acknowledgment:
 ""This product includes software developed by the Apache Group for use in the Apache HTTP server project (http://www.apache.org/).""
 
4. The names ""Apache Server"" and ""Apache Group"" must not be used to endorse or promote products derived from this software without prior written permission. For written permission, please contact apache@apache.org.
 
5. Products derived from this software may not be called ""Apache"" nor may ""Apache"" appear in their names without prior written permission of the Apache Group.

6. Redistributions of any form whatsoever must retain the following acknowledgment:
 ""This product includes software developed by the Apache Group for use in the Apache HTTP server project (http://www.apache.org/).""
 
THIS SOFTWARE IS PROVIDED BY THE APACHE GROUP ``AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE APACHE GROUP OR ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software consists of voluntary contributions made by many individuals on behalf of the Apache Group and was originally based on public domain software written at the National Center for Supercomputing Applications, University of Illinois, Urbana-Champaign. For more information on the Apache Group and the Apache HTTP server
 project, please see http://www.apache.org/.
```"
41,42,NomosTestfiles/Apache/Apache-1.1_a.txt,Apache-1.1,"The xerces_2_5_0.jar file comes from the Apache Xerces project
(http://xml.apache.org/dist/xerces-j/), and is licensed under the
Apache Software License, Version 1.1, which is in the
LICENSE.xerces_2_5_0.txt file.",False,"```
The xerces_2_5_0.jar file comes from the Apache Xerces project
(http://xml.apache.org/dist/xerces-j/), and is licensed under the
Apache Software License, Version 1.1, which is in the
LICENSE.xerces_2_5_0.txt file.
```"
42,43,NomosTestfiles/Apache/Apache-1.1_b.txt,Apache-1.1,"The xerces_2_5_0.jar file comes from the Apache Xerces project
(http://xmlapache.org/dist/xerces-j/), and is licensed under the
Apache Software License, Version 1.1, which is reproduced below.

/*
* The Apache Software License, Version 1.1
*
*
* Copyright (c) 1999-2002 The Apache Software Foundation. All rights
* reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions
* are met:
*
* 1. Redistributions of source code must retain the above copyright
* notice, this list of conditions and the following disclaimer.
*
* 2. Redistributions in binary form must reproduce the above copyright
* notice, this list of conditions and the following disclaimer in
* the documentation and/or other materials provided with the
* distribution.
*
* 3. The end-user documentation included with the redistribution,
* if any, must include the following acknowledgment:
* ""This product includes software developed by the
* Apache Software Foundation (http://www.apache.org/).""
* Alternately, this acknowledgment may appear in the software itself,
* if and wherever such third-party acknowledgments normally appear.
*
* 4. The names ""Xerces"" and ""Apache Software Foundation"" must
* not be used to endorse or promote products derived from this
* software without prior written permission. For written
* permission, please contact apache@apache.org.
*
* 5. Products derived from this software may not be called ""Apache"",
* nor may ""Apache"" appear in their name, without prior written
* permission of the Apache Software Foundation.
*
* THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED
* WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
* OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
* DISCLAIMED. IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR
* ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
* LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF
* USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
* ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
* OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
* OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
* SUCH DAMAGE.
* ====================================================================
*
* This software consists of voluntary contributions made by many
* individuals on behalf of the Apache Software Foundation and was
* originally based on software copyright (c) 1999, International
* Business Machines, Inc., http://www.ibm.com. For more
* information on the Apache Software Foundation, please see
* <http://www.apache.org/>.
*/",False,"```
* The Apache Software License, Version 1.1
*
*
* Copyright (c) 1999-2002 The Apache Software Foundation. All rights
* reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions
* are met:
*
* 1. Redistributions of source code must retain the above copyright
* notice, this list of conditions and the following disclaimer.
*
* 2. Redistributions in binary form must reproduce the above copyright
* notice, this list of conditions and the following disclaimer in
* the documentation and/or other materials provided with the
* distribution.
*
* 3. The end-user documentation included with the redistribution,
* if any, must include the following acknowledgment:
* ""This product includes software developed by the
* Apache Software Foundation (http://www.apache.org).""
* Alternately, this acknowledgment may appear in the software itself,
* if and wherever such third-party acknowledgments normally appear.
*
* 4. The names ""Xerces"" and ""Apache Software Foundation"" must
* not be used to endorse or promote products derived from this
* software without prior written permission. For written
* permission, please contact apache@apache.org.
*
* 5. Products derived from this software may not be called ""Apache"",
* nor may ""Apache"" appear in their name, without prior written
* permission of the Apache Software Foundation.
*
* THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED
* WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
* OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
* DISCLAIMED. IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR
* ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
* LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF
* USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
* ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
* OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
* OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
* SUCH DAMAGE.
* ====================================================================
*
* This software consists of voluntary contributions made by many
* individuals on behalf of the Apache Software Foundation and was
* originally based on software copyright (c) 1999, International
* Business Machines, Inc., http://www.ibm.com. For more
* information on the Apache Software Foundation, please see
* <http://www.apache.org/>.
```"
43,44,NomosTestfiles/Apache/Apache-1.1-style.txt,Apache-1.1-style,"Copyright (c) {{YEAR}}, {{OWNER}}. All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:

1. Redistributions of source code must retain the above copyright
notice, this list of conditions and the following disclaimer.

2. Redistributions in binary form must reproduce the above copyright
notice, this list of conditions and the following disclaimer in
the documentation and/or other materials provided with the
distribution.

3. The end-user documentation included with the redistribution,
if any, must include the following acknowledgment:
""This product includes software developed by
{{THE COPYRIGHT HOLDERS AND CONTRIBUTORS}}.""
Alternately, this acknowledgment may appear in the software itself,
if and wherever such third-party acknowledgments normally appear.

4. The names ""{{THE COPYRIGHT HOLDERS AND CONTRIBUTORS}}""
must not be used to endorse or promote products derived from this
software without prior written permission. For written
permission, please contact {{EMAIL ADDRESS}}.

5. Products derived from this software may not be called
""{{PRODUCT NAMES}}"", nor may ""{{PRODUCT NAMES}}"" appear in their
name, without prior written permission of {{THE COPYRIGHT HOLDERS}}.

THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL {{THE COPYRIGHT HOLDERS AND CONTRIBUTORS}}
BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF
USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
SUCH DAMAGE.
",False,"```
Copyright (c) {{YEAR}}, {{OWNER}}. All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:

1. Redistributions of source code must retain the above copyright
notice, this list of conditions and the following disclaimer.

2. Redistributions in binary form must reproduce the above copyright
notice, this list of conditions and the following disclaimer in
the documentation and/or other materials provided with the
distribution.

3. The end-user documentation included with the redistribution,
if any, must include the following acknowledgment:
""This product includes software developed by
{{THE COPYRIGHT HOLDERS AND CONTRIBUTORS}}.""
Alternately, this acknowledgment may appear in the software itself,
if and wherever such third-party acknowledgments normally appear.

4. The names ""{{THE COPYRIGHT HOLDERS AND CONTRIBUTORS}}""
must not be used to endorse or promote products derived from this
software without prior written permission. For written
permission, please contact {{EMAIL ADDRESS}}.

5. Products derived from this software may not be called
""{{PRODUCT NAMES}}"", nor may ""{{PRODUCT NAMES}}"" appear in their
name, without prior written permission of {{THE COPYRIGHT HOLDERS}}.

THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL {{THE COPYRIGHT HOLDERS AND CONTRIBUTORS}}
BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF
USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
SUCH DAMAGE.
```"
44,45,NomosTestfiles/Apache/Apache-1.1.txt,Apache-1.1,"The Apache Software License, Version 1.1

Copyright (c) 2000 The Apache Software Foundation.  All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.
 
2. Redistributions in binary form must reproduce the above copyright
 notice, this list of conditions and the following disclaimer in
 the documentation and/or other materials provided with the
 distribution.
 
3. The end-user documentation included with the redistribution, if any, must include the following acknowledgment:
 ""This product includes software developed by the Apache Software Foundation (http://www.apache.org/).""
 Alternately, this acknowledgment may appear in the software itself, if and wherever such third-party acknowledgments normally appear.
  
4. The names ""Apache"" and ""Apache Software Foundation"" must not be used to endorse or promote products derived from this software without prior written permission. For written permission, please contact apache@apache.org.
 
5. Products derived from this software may not be called ""Apache"", nor may ""Apache"" appear in their name, without prior written permission of the Apache Software Foundation.
 
THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 
This software consists of voluntary contributions made by many individuals on behalf of the Apache Software Foundation.  For more information on the Apache Software Foundation, please see http://www.apache.org/. Portions of this software are based upon public domain software originally written at the National Center for Supercomputing Applications, University of Illinois, Urbana-Champaign.
",False,"```
The Apache Software License, Version 1.1

Copyright (c) 2000 The Apache Software Foundation.  All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.
 
2. Redistributions in binary form must reproduce the above copyright
 notice, this list of conditions and the following disclaimer in
 the documentation and/or other materials provided with the
 distribution.
 
3. The end-user documentation included with the redistribution, if any, must include the following acknowledgment:
 ""This product includes software developed by the Apache Software Foundation (http://www.apache.org).""
 Alternately, this acknowledgment may appear in the software itself, if and wherever such third-party acknowledgments normally appear.
  
4. The names ""Apache"" and ""Apache Software Foundation"" must not be used to endorse or promote products derived from this software without prior written permission. For written permission, please contact apache@apache.org.
 
5. Products derived from this software may not be called ""Apache"", nor may ""Apache"" appear in their name, without prior written permission of the Apache Software Foundation.
 
THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 
This software consists of voluntary contributions made by many individuals on behalf of the Apache Software Foundation.  For more information on the Apache Software Foundation, please see http://www.apache.org/. Portions of this software are based upon public domain software originally written at the National Center for Supercomputing Applications, University of Illinois, Urbana-Champaign. 
```"
45,46,NomosTestfiles/Apache/Apache-2.0_a.txt,Apache-2.0,"/* This file was written by Bill Cox in 2011, and is licensed under the Apache
2.0 license. */",False,"```
/* This file was written by Bill Cox in 2011, and is licensed under the Apache
2.0 license. */
```"
46,47,NomosTestfiles/Apache/Apache-2.0_b.txt,Apache-2.0,"/*!
* LESS - Leaner CSS v1.5.0
* http://lesscss.org
*
* Copyright (c) 2009-2013, Alexis Sellier <self@cloudhead.net>
* Licensed under the Apache v2 License.
*
* @licence
*/ ",False,"```
* Copyright (c) 2009-2013, Alexis Sellier <self@cloudhead.net>
* Licensed under the Apache v2 License.
```"
47,48,NomosTestfiles/Apache/Apache-2.0_c.txt,Apache-2.0,"## Contributors

Names in no particular order:

* [spf13](https://github.com/spf13),
[eparis](https://github.com/eparis),
[bep](https://github.com/bep), and many more!

## License

Cobra is released under the Apache 2.0 license. See [LICENSE.txt](https://github.com/spf13/cobra/blob/master/LICENSE.txt)


[![Bitdeli Badge](https://d2weczhvl823v0.cloudfront.net/spf13/cobra/trend.png)](https://bitdeli.com/free ""Bitdeli Badge"")",False,"```
Cobra is released under the Apache 2.0 license. See [LICENSE.txt](https://github.com/spf13/cobra/blob/master/LICENSE.txt)
```"
48,49,NomosTestfiles/Apache/Apache-2.0_d.txt,Apache-2.0,"## FAQs

### What does `BlockMode` field do?

By default, library lets you read and write values so we need a locker to make sure your data is safe. But in cases that you are very sure about only reading data through the library, you can set `cfg.BlockMode = false` to speed up read operations about **50-70%** faster.

### Why another INI library?

Many people are using my another INI library [goconfig](https://github.com/Unknwon/goconfig), so the reason for this one is I would like to make more Go style code. Also when you set `cfg.BlockMode = false`, this one is about **10-30%** faster.

To make those changes I have to confirm API broken, so it's safer to keep it in another place and start using `gopkg.in` to version my package at this time.(PS: shorter import path)

## License

This project is under Apache v2 License. See the [LICENSE](LICENSE) file for the full license text.",False,"```
## License

This project is under Apache v2 License. See the [LICENSE](LICENSE) file for the full license text.
```"
49,50,NomosTestfiles/Apache/Apache-2.0_e.txt,"Apache-2.0
CC-BY","# libtrust

Libtrust is library for managing authentication and authorization using public key cryptography.

Authentication is handled using the identity attached to the public key.
Libtrust provides multiple methods to prove possession of the private key associated with an identity.
- TLS x509 certificates
- Signature verification
- Key Challenge

Authorization and access control is managed through a distributed trust graph.
Trust servers are used as the authorities of the trust graph and allow caching portions of the graph for faster access.

## Copyright and license

Code and documentation copyright 2014 Docker, inc. Code released under the Apache 2.0 license.
Docs released under Creative commons.
",False,"```
## Copyright and license

Code and documentation copyright 2014 Docker, inc. Code released under the Apache 2.0 license.
Docs released under Creative commons.
```"
50,51,NomosTestfiles/Apache/Apache-2.0_f.txt,Apache-2.0,"
/*

Derby - Class org.apache.derby.impl.store.replication.net.ReplicationMessageTransmit

Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements. See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to you under the Apache License, Version 2.0
(the ""License""); you may not use this file except in compliance with
the License. You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an ""AS IS"" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

*/",False,"```
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements. See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to you under the Apache License, Version 2.0
(the ""License""); you may not use this file except in compliance with
the License. You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an ""AS IS"" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
```"
51,52,NomosTestfiles/Apache/Apache-2.0_g.txt,Apache-2.0,"The Apache Tomcat software is developed in an open and participatory
environment and released under the
[Apache License version 2](http://www.apache.org/licenses/). The Apache Tomcat
project is intended to be a collaboration of the best-of-breed developers from
around the world. We invite you to participate in this open development
project. To learn more about getting involved,
[click here](http://tomcat.apache.org/getinvolved.html) or keep reading.",False,"```
The Apache Tomcat software is developed in an open and participatory
environment and released under the
[Apache License version 2](http://www.apache.org/licenses/). 
```"
52,53,NomosTestfiles/Apache/Apache-2.0_h.txt,Apache-2.0,"# -*- coding: utf-8 -*-

""""""
requests.api
~~~~~~~~~~~~

This module implements the Requests API.

:copyright: (c) 2012 by Kenneth Reitz.
:license: Apache2, see LICENSE for more details.
""""""

from . import sessions
",False,"```
:copyright: (c) 2012 by Kenneth Reitz.
:license: Apache2, see LICENSE for more details.
```"
53,54,NomosTestfiles/Apache/Apache-2.0_i.txt,Apache-2.0,"# -*- coding: utf-8 -*-

""""""
requests.api
~~~~~~~~~~~~

This module implements the Requests API.

:copyright: (c) 2012 by Kenneth Reitz.
:license: Apache2, see LICENSE for more details.

""""""

from . import sessions

",False,"```
:copyright: (c) 2012 by Kenneth Reitz.
:license: Apache2, see LICENSE for more details.
```"
54,55,NomosTestfiles/Apache/Apache-2.0_j.txt,Apache-2.0,"## License

This project is released under the Apache v2. licence. See [LICENCE](LICENCE) for more details.",False,"```
## License

This project is released under the Apache v2. licence. See [LICENCE](LICENCE) for more details.
```"
55,56,NomosTestfiles/Apache/Apache-2.0_k.txt,Apache-2.0,"DISTNAME = 'xarray'
LICENSE = 'Apache'
AUTHOR = 'xarray Developers'
AUTHOR_EMAIL = 'xarray@googlegroups.com'
URL = 'https://github.com/pydata/xarray'
CLASSIFIERS = [
'Development Status :: 4 - Beta',
'License :: OSI Approved :: Apache Software License',
'Operating System :: OS Independent',
'Intended Audience :: Science/Research',
'Programming Language :: Python',
'Programming Language :: Python :: 2',
'Programming Language :: Python :: 2.7',
'Programming Language :: Python :: 3',
'Programming Language :: Python :: 3.5',
'Programming Language :: Python :: 3.6',
'Programming Language :: Python :: 3.7',
'Topic :: Scientific/Engineering',
]
",False,"```
License :: OSI Approved :: Apache Software License
```"
56,57,NomosTestfiles/Apache/Apache-2.0_l.txt,Apache-2.0,"termsOfService: Terms of service
contact:
name: Fred
url: http://gigantic-server.com
email: Fred@gigagantic-server.com
license:
name: Apache 2.0
url: http://foo.bar
version: ""2.0""
",False,"```
name: Apache 2.0
url: http://foo.bar
version: ""2.0""
```"
57,58,NomosTestfiles/Apache/Apache-2.0_m.txt,"Apache-2.0
CDDL-1.1","nifi-jetty-bundle
Copyright 2014-2015 The Apache Software Foundation

This product includes software developed at
The Apache Software Foundation (http://www.apache.org/).

******************
Apache Software License v2
******************

The following binary components are provided under the Apache Software License v2

(ASLv2) Jetty
The following NOTICE information applies:
Jetty Web Container
Copyright 1995-2015 Mort Bay Consulting Pty Ltd.

************************
Common Development and Distribution License 1.1
************************

The following binary components are provided under the Common Development and Distribution License 1.1. See project link for details.
",False,"```
******************
Apache Software License v2
******************

The following binary components are provided under the Apache Software License v2

(ASLv2) Jetty
```"
58,59,NomosTestfiles/Apache/Apache-2.0-nourl.txt,Apache-2.0,"# Apache License
Version 2.0, January 2004

TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

## 1. Definitions.

""License"" shall mean the terms and conditions for use, reproduction, and distribution as defined by Sections 1
through 9 of this document.

""Licensor"" shall mean the copyright owner or entity authorized by the copyright owner that is granting the
License.

""Legal Entity"" shall mean the union of the acting entity and all other entities that control, are controlled
by, or are under common control with that entity. For the purposes of this definition, ""control"" means
(i) the power, direct or indirect, to cause the direction or management of such entity, whether by contract
or otherwise, or (ii) ownership of fifty percent (50%) or more of the outstanding shares, or (iii) beneficial
ownership of such entity.

""You"" (or ""Your"") shall mean an individual or Legal Entity exercising permissions granted by this License.

""Source"" form shall mean the preferred form for making modifications, including but not limited to software
source code, documentation source, and configuration files.

""Object"" form shall mean any form resulting from mechanical transformation or translation of a Source form,
including but not limited to compiled object code, generated documentation, and conversions to other media
types.

""Work"" shall mean the work of authorship, whether in Source or Object form, made available under the License,
as indicated by a copyright notice that is included in or attached to the work (an example is provided in the
Appendix below).

""Derivative Works"" shall mean any work, whether in Source or Object form, that is based on (or derived from)
the Work and for which the editorial revisions, annotations, elaborations, or other modifications represent,
as a whole, an original work of authorship. For the purposes of this License, Derivative Works shall not
include works that remain separable from, or merely link (or bind by name) to the interfaces of, the Work
and Derivative Works thereof.

""Contribution"" shall mean any work of authorship, including the original version of the Work and any
modifications or additions to that Work or Derivative Works thereof, that is intentionally submitted to
Licensor for inclusion in the Work by the copyright owner or by an individual or Legal Entity authorized to
submit on behalf of the copyright owner. For the purposes of this definition, ""submitted"" means any form of
electronic, verbal, or written communication sent to the Licensor or its representatives, including but not
limited to communication on electronic mailing lists, source code control systems, and issue tracking systems
that are managed by, or on behalf of, the Licensor for the purpose of discussing and improving the Work, but
excluding communication that is conspicuously marked or otherwise designated in writing by the copyright
owner as ""Not a Contribution.""

""Contributor"" shall mean Licensor and any individual or Legal Entity on behalf of whom a Contribution has been
received by Licensor and subsequently incorporated within the Work.

## 2. Grant of Copyright License.

Subject to the terms and conditions of this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare
Derivative Works of, publicly display, publicly perform, sublicense, and distribute the Work and such
Derivative Works in Source or Object form.

## 3. Grant of Patent License.

Subject to the terms and conditions of this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable (except as stated in this section) patent
license to make, have made, use, offer to sell, sell, import, and otherwise transfer the Work, where such
license applies only to those patent claims licensable by such Contributor that are necessarily infringed by
their Contribution(s) alone or by combination of their Contribution(s) with the Work to which such
Contribution(s) was submitted. If You institute patent litigation against any entity (including a cross-claim
or counterclaim in a lawsuit) alleging that the Work or a Contribution incorporated within the Work
constitutes direct or contributory patent infringement, then any patent licenses granted to You under this
License for that Work shall terminate as of the date such litigation is filed.

## 4. Redistribution.

You may reproduce and distribute copies of the Work or Derivative Works thereof in any medium, with or without
modifications, and in Source or Object form, provided that You meet the following conditions:

   1. You must give any other recipients of the Work or Derivative Works a copy of this License; and

   2. You must cause any modified files to carry prominent notices stating that You changed the files; and

   3. You must retain, in the Source form of any Derivative Works that You distribute, all copyright, patent,
	  trademark, and attribution notices from the Source form of the Work, excluding those notices that do
	  not pertain to any part of the Derivative Works; and

   4. If the Work includes a ""NOTICE"" text file as part of its distribution, then any Derivative Works that
	  You distribute must include a readable copy of the attribution notices contained within such NOTICE
	  file, excluding those notices that do not pertain to any part of the Derivative Works, in at least one
	  of the following places: within a NOTICE text file distributed as part of the Derivative Works; within
	  the Source form or documentation, if provided along with the Derivative Works; or, within a display
	  generated by the Derivative Works, if and wherever such third-party notices normally appear. The
	  contents of the NOTICE file are for informational purposes only and do not modify the License. You may
	  add Your own attribution notices within Derivative Works that You distribute, alongside or as an
	  addendum to the NOTICE text from the Work, provided that such additional attribution notices cannot be
	  construed as modifying the License.

You may add Your own copyright statement to Your modifications and may provide additional or different license
terms and conditions for use, reproduction, or distribution of Your modifications, or for any such Derivative
Works as a whole, provided Your use, reproduction, and distribution of the Work otherwise complies with the
conditions stated in this License.

## 5. Submission of Contributions.

Unless You explicitly state otherwise, any Contribution intentionally submitted for inclusion in the Work by
You to the Licensor shall be under the terms and conditions of this License, without any additional terms or
conditions. Notwithstanding the above, nothing herein shall supersede or modify the terms of any separate
license agreement you may have executed with Licensor regarding such Contributions.

## 6. Trademarks.

This License does not grant permission to use the trade names, trademarks, service marks, or product names of
the Licensor, except as required for reasonable and customary use in describing the origin of the Work and
reproducing the content of the NOTICE file.

## 7. Disclaimer of Warranty.

Unless required by applicable law or agreed to in writing, Licensor provides the Work (and each Contributor
provides its Contributions) on an ""AS IS"" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT,
MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. You are solely responsible for determining the
appropriateness of using or redistributing the Work and assume any risks associated with Your exercise of
permissions under this License.

## 8. Limitation of Liability.

In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless
required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall any
Contributor be liable to You for damages, including any direct, indirect, special, incidental, or consequential
damages of any character arising as a result of this License or out of the use or inability to use the Work
(including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or
any and all other commercial damages or losses), even if such Contributor has been advised of the possibility
of such damages.

## 9. Accepting Warranty or Additional Liability.

While redistributing the Work or Derivative Works thereof, You may choose to offer, and charge a fee for,
acceptance of support, warranty, indemnity, or other liability obligations and/or rights consistent with this
License. However, in accepting such obligations, You may act only on Your own behalf and on Your sole
responsibility, not on behalf of any other Contributor, and only if You agree to indemnify, defend, and hold
each Contributor harmless for any liability incurred by, or claims asserted against, such Contributor by reason
of your accepting any such warranty or additional liability.

END OF TERMS AND CONDITIONS

",False,"```
# Apache License
Version 2.0, January 2004

TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

## 1. Definitions.

""License"" shall mean the terms and conditions for use, reproduction, and distribution as defined by Sections 1
through 9 of this document.

""Licensor"" shall mean the copyright owner or entity authorized by the copyright owner that is granting the
License.

""Legal Entity"" shall mean the union of the acting entity and all other entities that control, are controlled
by, or are under common control with that entity. For the purposes of this definition, ""control"" means
(i) the power, direct or indirect, to cause the direction or management of such entity, whether by contract
or otherwise, or (ii) ownership of fifty percent (50%) or more of the outstanding shares, or (iii) beneficial
ownership of such entity.

""You"" (or ""Your"") shall mean an individual or Legal Entity exercising permissions granted by this License.

""Source"" form shall mean the preferred form for making modifications, including but not limited to software
source code, documentation source, and configuration files.

""Object"" form shall mean any form resulting from mechanical transformation or translation of a Source form,
including but not limited to compiled object code, generated documentation, and conversions to other media
types.

""Work"" shall mean the work of authorship, whether in Source or Object form, made available under the License,
as indicated by a copyright notice that is included in or attached to the work (an example is provided in the
Appendix below).

""Derivative Works"" shall mean any work, whether in Source or Object form, that is based on (or derived from)
the Work and for which the editorial revisions, annotations, elaborations, or other modifications represent,
as a whole, an original work of authorship. For the purposes of this License, Derivative Works shall not
include works that remain separable from, or merely link (or bind by name) to the interfaces of, the Work
and Derivative Works thereof.

""Contribution"" shall mean any work of authorship, including the original version of the Work and any
modifications or additions to that Work or Derivative Works thereof, that is intentionally submitted to
Licensor for inclusion in the Work by the copyright owner or by an individual or Legal Entity authorized to
submit on behalf of the copyright owner. For the purposes of this definition, ""submitted"" means any form of
electronic, verbal, or written communication sent to the Licensor or its representatives, including but not
limited to communication on electronic mailing lists, source code control systems, and issue tracking systems
that are managed by, or on behalf of, the Licensor for the purpose of discussing and improving the Work, but
excluding communication that is conspicuously marked or otherwise designated in writing by the copyright
owner as ""Not a Contribution.""

""Contributor"" shall mean Licensor and any individual or Legal Entity on behalf of whom a Contribution has been
received by Licensor and subsequently incorporated within the Work.

## 2. Grant of Copyright License.

Subject to the terms and conditions of this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare
Derivative Works of, publicly display, publicly perform, sublicense, and distribute the Work and such
Derivative Works in Source or Object form.

## 3. Grant of Patent License.

Subject to the terms and conditions of this License, each Contributor hereby grants to You a perpetual,
worldwide, non-exclusive, no-charge, royalty-free, irrevocable (except as stated in this section) patent
license to make, have made, use, offer to sell, sell, import, and otherwise transfer the Work, where such
license applies only to those patent claims licensable by such Contributor that are necessarily infringed by
their Contribution(s) alone or by combination of their Contribution(s) with the Work to which such
Contribution(s) was submitted. If You institute patent litigation against any entity (including a cross-claim
or counterclaim in a lawsuit) alleging that the Work or a Contribution incorporated within the Work
constitutes direct or contributory patent infringement, then any patent licenses granted to You under this
License for that Work shall terminate as of the date such litigation is filed.

## 4. Redistribution.

You may reproduce and distribute copies of the Work or Derivative Works thereof in any medium, with or without
modifications, and in Source or Object form, provided that You meet the following conditions:

   1. You must give any other recipients of the Work or Derivative Works a copy of this License; and

   2. You must cause any modified files to carry prominent notices stating that You changed the files; and

   3. You must retain, in the Source form of any Derivative Works that You distribute, all copyright, patent,
	  trademark, and attribution notices from the Source form of the Work, excluding those notices that do
	  not pertain to any part of the Derivative Works; and

   4. If the Work includes a ""NOTICE"" text file as part of its distribution, then any Derivative Works that
	  You distribute must include a readable copy of the attribution notices contained within such NOTICE
	  file, excluding those notices that do not pertain to any part of the Derivative Works, in at least one
	  of the following places: within a NOTICE text file distributed as part of the Derivative Works; within
	  the Source form or documentation, if provided along with the Derivative Works; or, within a display
	  generated by the Derivative Works, if and wherever such third-party notices normally appear. The
	  contents of the NOTICE file are for informational purposes only and do not modify the License. You may
	  add Your own attribution notices within Derivative Works that You distribute, alongside or as an
	  addendum to the NOTICE text from the Work, provided that such additional attribution notices cannot be
	  construed as modifying the License.

You may add Your own copyright statement to Your modifications and may provide additional or different license
terms and conditions for use, reproduction, or distribution of Your modifications, or for any such Derivative
Works as a whole, provided Your use, reproduction, and distribution of the Work otherwise complies with the
conditions stated in this License.

## 5. Submission of Contributions.

Unless You explicitly state otherwise, any Contribution intentionally submitted for inclusion in the Work by
You to the Licensor shall be under the terms and conditions of this License, without any additional terms or
conditions. Notwithstanding the above, nothing herein shall supersede or modify the terms of any separate
license agreement you may have executed with Licensor regarding such Contributions.

## 6. Trademarks.

This License does not grant permission to use the trade names, trademarks, service marks, or product names of
the Licensor, except as required for reasonable and customary use in describing the origin of the Work and
reproducing the content of the NOTICE file.

## 7. Disclaimer of Warranty.

Unless required by applicable law or agreed to in writing, Licensor provides the Work (and each Contributor
provides its Contributions) on an ""AS IS"" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT,
MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. You are solely responsible for determining the
appropriateness of using or redistributing the Work and assume any risks associated with Your exercise of
permissions under this License.

## 8. Limitation of Liability.

In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless
required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall any
Contributor be liable to You for damages, including any direct, indirect, special, incidental, or consequential
damages of any character arising as a result of this License or out of the use or inability to use the Work
(including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or
any and all other commercial damages or losses), even if such Contributor has been advised of the possibility
of such damages.

## 9. Accepting Warranty or Additional Liability.

While redistributing the Work or Derivative Works thereof, You may choose to offer, and charge a fee for,
acceptance of support, warranty, indemnity, or other liability obligations and/or rights consistent with this
License. However, in accepting such obligations, You may act only on Your own behalf and on Your sole
responsibility, not on behalf of any other Contributor, and only if You agree to indemnify, defend, and hold
each Contributor harmless for any liability incurred by, or claims asserted against, such Contributor by reason
of your accepting any such warranty or additional liability.

END OF TERMS AND CONDITIONS
```"
59,60,NomosTestfiles/Apache/Apache-2.0_n.txt,Apache-2.0,"This source code is subject to terms and conditions of the Apache License, Version 2.0. A
copy of the license can be found in the License.html file at the root of this distribution. If
you cannot locate the Apache License, Version 2.0, please send an email to
dlr@microsoft.com. By using this source code in any fashion, you are agreeing to be bound
by the terms of the Apache License, Version 2.0.",False,"```
This source code is subject to terms and conditions of the Apache License, Version 2.0. A
copy of the license can be found in the License.html file at the root of this distribution. If
you cannot locate the Apache License, Version 2.0, please send an email to
dlr@microsoft.com. By using this source code in any fashion, you are agreeing to be bound
by the terms of the Apache License, Version 2.0.
```"
60,61,NomosTestfiles/Apache/Apache-2.0.txt,Apache-2.0,"
                                 Apache License
                           Version 2.0, January 2004
                        http://www.apache.org/licenses/

   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

   1. Definitions.

 ""License"" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 ""Licensor"" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 ""Legal Entity"" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 ""control"" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 ""You"" (or ""Your"") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 ""Source"" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 ""Object"" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not limited to compiled object code, generated documentation,
 and conversions to other media types.

 ""Work"" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 ""Derivative Works"" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 ""Contribution"" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, ""submitted""
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as ""Not a Contribution.""

 ""Contributor"" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a ""NOTICE"" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
    or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an ""AS IS"" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
      negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all
 other commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

   APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets ""[]""
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same ""printed page"" as the copyright notice for easier
 identification within third-party archives.

 Copyright [yyyy] [name of copyright owner]

 Licensed under the Apache License, Version 2.0 (the ""License"");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an ""AS IS"" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
",False,"```
Apache License
Version 2.0, January 2004
http://www.apache.org/licenses/

TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

1. Definitions.

 ""License"" shall mean the terms and conditions for use, reproduction,
 and distribution as defined by Sections 1 through 9 of this document.

 ""Licensor"" shall mean the copyright owner or entity authorized by
 the copyright owner that is granting the License.

 ""Legal Entity"" shall mean the union of the acting entity and all
 other entities that control, are controlled by, or are under common
 control with that entity. For the purposes of this definition,
 ""control"" means (i) the power, direct or indirect, to cause the
 direction or management of such entity, whether by contract or
 otherwise, or (ii) ownership of fifty percent (50%) or more of the
 outstanding shares, or (iii) beneficial ownership of such entity.

 ""You"" (or ""Your"") shall mean an individual or Legal Entity
 exercising permissions granted by this License.

 ""Source"" form shall mean the preferred form for making modifications,
 including but not limited to software source code, documentation
 source, and configuration files.

 ""Object"" form shall mean any form resulting from mechanical
 transformation or translation of a Source form, including but
 not to compiled object code, generated documentation,
 and conversions to other media types.

 ""Work"" shall mean the work of authorship, whether in Source or
 Object form, made available under the License, as indicated by a
 copyright notice that is included in or attached to the work
 (an example is provided in the Appendix below).

 ""Derivative Works"" shall mean any work, whether in Source or Object
 form, that is based on (or derived from) the Work and for which the
 editorial revisions, annotations, elaborations, or other modifications
 represent, as a whole, an original work of authorship. For the purposes
 of this License, Derivative Works shall not include works that remain
 separable from, or merely link (or bind by name) to the interfaces of,
 the Work and Derivative Works thereof.

 ""Contribution"" shall mean any work of authorship, including
 the original version of the Work and any modifications or additions
 to that Work or Derivative Works thereof, that is intentionally
 submitted to Licensor for inclusion in the Work by the copyright owner
 or by an individual or Legal Entity authorized to submit on behalf of
 the copyright owner. For the purposes of this definition, ""submitted""
 means any form of electronic, verbal, or written communication sent
 to the Licensor or its representatives, including but not limited to
 communication on electronic mailing lists, source code control systems,
 and issue tracking systems that are managed by, or on behalf of, the
 Licensor for the purpose of discussing and improving the Work, but
 excluding communication that is conspicuously marked or otherwise
 designated in writing by the copyright owner as ""Not a Contribution.""

 ""Contributor"" shall mean Licensor and any individual or Legal Entity
 on behalf of whom a Contribution has been received by Licensor and
 subsequently incorporated within the Work.

 2. Grant of Copyright License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 copyright license to reproduce, prepare Derivative Works of,
 publicly display, publicly perform, sublicense, and distribute the
 Work and such Derivative Works in Source or Object form.

 3. Grant of Patent License. Subject to the terms and conditions of
 this License, each Contributor hereby grants to You a perpetual,
 worldwide, non-exclusive, no-charge, royalty-free, irrevocable
 (except as stated in this section) patent license to make, have made,
 use, offer to sell, sell, import, and otherwise transfer the Work,
 where such license applies only to those patent claims licensable
 by such Contributor that are necessarily infringed by their
 Contribution(s) alone or by combination of their Contribution(s)
 with the Work to which such Contribution(s) was submitted. If You
 institute patent litigation against any entity (including a
 cross-claim or counterclaim in a lawsuit) alleging that the Work
 or a Contribution incorporated within the Work constitutes direct
 or contributory patent infringement, then any patent licenses
 granted to You under this License for that Work shall terminate
 as of the date such litigation is filed.

 4. Redistribution. You may reproduce and distribute copies of the
 Work or Derivative Works thereof in any medium, with or without
 modifications, and in Source or Object form, provided that You
 meet the following conditions:

 (a) You must give any other recipients of the Work or
 Derivative Works a copy of this License; and

 (b) You must cause any modified files to carry prominent notices
 stating that You changed the files; and

 (c) You must retain, in the Source form of any Derivative Works
 that You distribute, all copyright, patent, trademark, and
 attribution notices from the Source form of the Work,
 excluding those notices that do not pertain to any part of
 the Derivative Works; and

 (d) If the Work includes a ""NOTICE"" text file as part of its
 distribution, then any Derivative Works that You distribute must
 include a readable copy of the attribution notices contained
 within such NOTICE file, excluding those notices that do not
 pertain to any part of the Derivative Works, in at least one
 of the following places: within a NOTICE text file distributed
 as part of the Derivative Works; within the Source form or
 documentation, if provided along with the Derivative Works; or,
 within a display generated by the Derivative Works, if and
 wherever such third-party notices normally appear. The contents
 of the NOTICE file are for informational purposes only and
 do not modify the License. You may add Your own attribution
 notices within Derivative Works that You distribute, alongside
    or as an addendum to the NOTICE text from the Work, provided
 that such additional attribution notices cannot be construed
 as modifying the License.

 You may add Your own copyright statement to Your modifications and
 may provide additional or different license terms and conditions
 for use, reproduction, or distribution of Your modifications, or
 for any such Derivative Works as a whole, provided Your use,
 reproduction, and distribution of the Work otherwise complies with
 the conditions stated in this License.

 5. Submission of Contributions. Unless You explicitly state otherwise,
 any Contribution intentionally submitted for inclusion in the Work
 by You to the Licensor shall be under the terms and conditions of
 this License, without any additional terms or conditions.
 Notwithstanding the above, nothing herein shall supersede or modify
 the terms of any separate license agreement you may have executed
 with Licensor regarding such Contributions.

 6. Trademarks. This License does not grant permission to use the trade
 names, trademarks, service marks, or product names of the Licensor,
 except as required for reasonable and customary use in describing the
 origin of the Work and reproducing the content of the NOTICE file.

 7. Disclaimer of Warranty. Unless required by applicable law or
 agreed to in writing, Licensor provides the Work (and each
 Contributor provides its Contributions) on an ""AS IS"" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
 implied, including, without limitation, any warranties or conditions
 of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
 PARTICULAR PURPOSE. You are solely responsible for determining the
 appropriateness of using or redistributing the Work and assume any
 risks associated with Your exercise of permissions under this License.

 8. Limitation of Liability. In no event and under no legal theory,
 whether in tort (including negligence), contract, or otherwise,
 unless required by applicable law (such as deliberate and grossly
      negligent acts) or agreed to in writing, shall any Contributor be
 liable to You for damages, including any direct, indirect, special,
 incidental, or consequential damages of any character arising as a
 result of this License or out of the use or inability to use the
 Work (including but not limited to damages for loss of goodwill,
 work stoppage, computer failure or malfunction, or any and all other
 commercial damages or losses), even if such Contributor
 has been advised of the possibility of such damages.

 9. Accepting Warranty or Additional Liability. While redistributing
 the Work or Derivative Works thereof, You may choose to offer,
 and charge a fee for, acceptance of support, warranty, indemnity,
 or other liability obligations and/or rights consistent with this
 License. However, in accepting such obligations, You may act only
 on Your own behalf and on Your sole responsibility, not on behalf
 of any other Contributor, and only if You agree to indemnify,
 defend, and hold each Contributor harmless for any liability
 incurred by, or claims asserted against, such Contributor by reason
 of your accepting any such warranty or additional liability.

 END OF TERMS AND CONDITIONS

   APPENDIX: How to apply the Apache License to your work.

 To apply the Apache License to your work, attach the following
 boilerplate notice, with the fields enclosed by brackets ""[]""
 replaced with your own identifying information. (Don't include
 the brackets!)  The text should be enclosed in the appropriate
 comment syntax for the file format. We also recommend that a
 file or class name and description of purpose be included on the
 same ""printed page"" as the copyright notice for easier
 identification within third-party archives.

 Copyright [yyyy] [name of copyright owner]

 Licensed under the Apache License, Version 2.0 (the ""License"");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an ""AS IS"" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.



```"
61,62,NomosTestfiles/Apache/Apache-2.0.xml,Apache-2.0,"<!--
Copyright (C) 2016 The Android Open Source Project

Licensed under the Apache License, Version 2 (the ""License"");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an ""AS IS"" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<ripple xmlns:android=""http://schemas.android.com/apk/res/android""
android:color=""?android:attr/colorControlHighlight"">
<item android:id=""@android:id/mask"">
<shape>
<corners android:radius=""@dimen/recents_task_view_rounded_corners_radius"" />
<solid android:color=""@android:color/white"" />
</shape>
</item>
</ripple>
",False,"```
Copyright (C) 2016 The Android Open Source Project

Licensed under the Apache License, Version 2 (the ""License"");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an ""AS IS"" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
```"
62,63,NomosTestfiles/Apache/Apache-v1.1,Apache-1.1,"/* ====================================================================
 * The Apache Software License, Version 1.1
 *
 * Copyright (c) 2000 The Apache Software Foundation.  All rights
 * reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in
 *    the documentation and/or other materials provided with the
 *    distribution.
 *
 * 3. The end-user documentation included with the redistribution,
 *    if any, must include the following acknowledgment:
 *       ""This product includes software developed by the
 *        Apache Software Foundation (http://www.apache.org/).""
 *    Alternately, this acknowledgment may appear in the software itself,
 *    if and wherever such third-party acknowledgments normally appear.
 *
 * 4. The names ""Apache"" and ""Apache Software Foundation"" must
 *    not be used to endorse or promote products derived from this
 *    software without prior written permission. For written
 *    permission, please contact apache@apache.org.
 *
 * 5. Products derived from this software may not be called ""Apache"",
 *    nor may ""Apache"" appear in their name, without prior written
 *    permission of the Apache Software Foundation.
 *
 * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED
 * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR
 * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF
 * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
 * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 * ====================================================================
 *
 * This software consists of voluntary contributions made by many
 * individuals on behalf of the Apache Software Foundation.  For more
 * information on the Apache Software Foundation, please see
 * <http://www.apache.org/>.
 *
 * Portions of this software are based upon public domain software
 * originally written at the National Center for Supercomputing Applications,
 * University of Illinois, Urbana-Champaign.
 */
",False,"```
 * The Apache Software License, Version 1.1
 *
 * Copyright (c) 2000 The Apache Software Foundation.  All rights
 * reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in
 *    the documentation and/or other materials provided with the
 *    distribution.
 *
 * 3. The end-user documentation included with the redistribution,
 *    if any, must include the following acknowledgment:
 *       ""This product includes software developed by the
 *        Apache Software Foundation (http://www.apache.org/).""
 *    Alternately, this acknowledgment may appear in the software itself,
 *    if and wherever such third-party acknowledgments normally appear.
 *
 * 4. The names ""Apache"" and ""Apache Software Foundation"" must
 *    not be used to endorse or promote products derived from this
 *    software without prior written permission. For written
 *    permission, please contact apache@apache.org.
 *
 * 5. Products derived from this software may not be called ""Apache"",
 *    nor may ""Apache"" appear in their name, without prior written
 *    permission of the Apache Software Foundation.
 *
 * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED
 * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
 * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR
 * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF
 * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
 * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 * ====================================================================
 *
 * This software consists of voluntary contributions made by many
 * individuals on behalf of the Apache Software Foundation.  For more
 * information on the Apache Software Foundation, please see
 * <http://www.apache.org/>.
 *
 * Portions of this software are based upon public domain software
 * originally written at the National Center for Supercomputing Applications,
 * University of Illinois, Urbana-Champaign.
 */
```"
63,64,NomosTestfiles/Apache/condor_blkng_full_disk_io.h,Apache-2.0,"/***************************************************************
 *
 * Copyright (C) 1990-2007, Condor Team, Computer Sciences Department,
 * University of Wisconsin-Madison, WI.
 * 
 * Licensed under the Apache License, Version 2.0 (the ""License""); you
 * may not use this file except in compliance with the License.  You may
 * obtain a copy of the License at
 * 
 *    http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an ""AS IS"" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 ***************************************************************/

#ifndef _CONDOR_BLKNG_FULL_DISK_IO_H
#define _CONDOR_BLKNG_FULL_DISK_IO_H

/* This file implements blocking read/write operations on a regular
	files only.  The main purpose is to read/write however many
	bytes you actually specified ans these functions will try very
	hard to do just that. */

BEGIN_C_DECLS

/* These functions are the actual implementation, and must be used if
	you want this functionality in the remote i/o or condor_checkpointing
	libraries. Be warned, however, that they do require libc to be mapped
	correctly. */
ssize_t _condor_full_read(int fd, void *ptr, size_t nbytes);
ssize_t _condor_full_write(int fd, const void *ptr, size_t nbytes);

/* For generic Condor code not in the above libraries, use these functions */
ssize_t full_read(int filedes, void *ptr, size_t nbyte);
ssize_t full_write(int filedes, const void *ptr, size_t nbyte);

END_C_DECLS

#endif
",False,"```
 * Copyright (C) 1990-2007, Condor Team, Computer Sciences Department,
 * University of Wisconsin-Madison, WI.
 * 
 * Licensed under the Apache License, Version 2.0 (the ""License""); you
 * may not use this file except in compliance with the License.  You may
 * obtain a copy of the License at
 * 
 *    http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an ""AS IS"" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
```"
64,65,NomosTestfiles/Apache/DomainList.java,Apache-2.0,"/****************************************************************
 * Licensed to the Apache Software Foundation (ASF) under one   *
 * or more contributor license agreements.  See the NOTICE file *
 * distributed with this work for additional information        *
 * regarding copyright ownership.  The ASF licenses this file   *
 * to you under the Apache License, Version 2.0 (the            *
 * ""License""); you may not use this file except in compliance   *
 * with the License.  You may obtain a copy of the License at   *
 *                                                              *
 *   http://www.apache.org/licenses/LICENSE-2.0                 *
 *                                                              *
 * Unless required by applicable law or agreed to in writing,   *
 * software distributed under the License is distributed on an  *
 * ""AS IS"" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY       *
 * KIND, either express or implied.  See the License for the    *
 * specific language governing permissions and limitations      *
 * under the License.                                           *
 ****************************************************************/

package org.apache.james.mime4j.field.address;

import java.util.ArrayList;

/**
 * An immutable, random-access list of Strings (that
 * are supposedly domain names or domain literals).
 *
 *
 */
public class DomainList {
	private ArrayList<String> domains;

	/**
	 * @param domains An ArrayList that contains only String objects.
	 * @param dontCopy true iff it is not possible for the domains ArrayList to be modified by someone else.
	 */
	public DomainList(ArrayList<String> domains, boolean dontCopy) {
		if (domains != null)
			this.domains = (dontCopy ? domains : new ArrayList<String>(domains));
		else
			this.domains = new ArrayList<String>(0);
	}

	/**
	 * The number of elements in this list.
	 */
	public int size() {
		return domains.size();
	}

	/**
	 * Gets the domain name or domain literal at the
	 * specified index.
	 * @throws IndexOutOfBoundsException If index is &lt; 0 or &gt;= size().
	 */
	public String get(int index) {
		if (0 > index || size() <= index)
			throw new IndexOutOfBoundsException();
		return domains.get(index);
	}

	/**
	 * Returns the list of domains formatted as a route
	 * string (not including the trailing ':').
	 */
	public String toRouteString() {
		StringBuffer out = new StringBuffer();
		for (int i = 0; i < domains.size(); i++) {
			out.append(""@"");
			out.append(get(i));
			if (i + 1 < domains.size())
				out.append("","");
		}
		return out.toString();
	}
}
",False,"```
 * Licensed to the Apache Software Foundation (ASF) under one   *
 * or more contributor license agreements.  See the NOTICE file *
 * distributed with this work for additional information        *
 * regarding copyright ownership.  The ASF licenses this file   *
 * to you under the Apache License, Version 2.0 (the            *
 * ""License""); you may not use this file except in compliance   *
 * with the License.  You may obtain a copy of the License at   *
 *                                                              *
 *   http://www.apache.org/licenses/LICENSE-2.0                 *
 *                                                              *
 * Unless required by applicable law or agreed to in writing,   *
 * software distributed under the License is distributed on an  *
 * ""AS IS"" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY       *
 * KIND, either express or implied.  See the License for the    *
 * specific language governing permissions and limitations      *
 * under the License.                                           *
 ****************************************************************/ 
```"
65,66,NomosTestfiles/Apache/etcd.txt,Apache-2.0,"# etcd

[![Go Report Card](https://goreportcard.com/badge/github.com/coreos/etcd)](https://goreportcard.com/report/github.com/coreos/etcd)
[![Build Status](https://travis-ci.org/coreos/etcd.svg?branch=master)](https://travis-ci.org/coreos/etcd)
[![Build Status](https://semaphoreci.com/api/v1/coreos/etcd/branches/master/shields_badge.svg)](https://semaphoreci.com/coreos/etcd)
[![Docker Repository on Quay.io](https://quay.io/repository/coreos/etcd-git/status ""Docker Repository on Quay.io"")](https://quay.io/repository/coreos/etcd-git)

**Note**: The `master` branch may be in an *unstable or even broken state* during development. Please use [releases][github-release] instead of the `master` branch in order to get stable binaries.

*the etcd v2 [documentation](Documentation/v2/README.md) has moved*

![etcd Logo](logos/etcd-horizontal-color.png)

etcd is a distributed, consistent key-value store for shared configuration and service discovery, with a focus on being:

* *Simple*: well-defined, user-facing API (gRPC)
* *Secure*: automatic TLS with optional client cert authentication
* *Fast*: benchmarked 10,000 writes/sec
* *Reliable*: properly distributed using Raft

etcd is written in Go and uses the [Raft][raft] consensus algorithm to manage a highly-available replicated log.

etcd is used [in production by many companies](./Documentation/production-users.md), and the development team stands behind it in critical deployment scenarios, where etcd is frequently teamed with applications such as [Kubernetes][k8s], [fleet][fleet], [locksmith][locksmith], [vulcand][vulcand], [Doorman][doorman], and many others. Reliability is further ensured by rigorous [testing][etcd-tests].

See [etcdctl][etcdctl] for a simple command line client.

[raft]: https://raft.github.io/
[k8s]: http://kubernetes.io/
[doorman]: https://github.com/youtube/doorman
[fleet]: https://github.com/coreos/fleet
[locksmith]: https://github.com/coreos/locksmith
[vulcand]: https://github.com/vulcand/vulcand
[etcdctl]: https://github.com/coreos/etcd/tree/master/etcdctl
[etcd-tests]: http://dash.etcd.io

## Getting started

### Getting etcd

The easiest way to get etcd is to use one of the pre-built release binaries which are available for OSX, Linux, Windows, AppC (ACI), and Docker. Instructions for using these binaries are on the [GitHub releases page][github-release].

For those wanting to try the very latest version, you can [build the latest version of etcd][dl-build] from the `master` branch.
You will first need [*Go*](https://golang.org/) installed on your machine (version 1.6+ is required).
All development occurs on `master`, including new features and bug fixes.
Bug fixes are first targeted at `master` and subsequently ported to release branches, as described in the [branch management][branch-management] guide.

[github-release]: https://github.com/coreos/etcd/releases/
[branch-management]: ./Documentation/branch_management.md
[dl-build]: ./Documentation/dl_build.md#build-the-latest-version

### Running etcd

First start a single-member cluster of etcd:

```sh
./bin/etcd
```

This will bring up etcd listening on port 2379 for client communication and on port 2380 for server-to-server communication.

Next, let's set a single key, and then retrieve it:

```
ETCDCTL_API=3 etcdctl put mykey ""this is awesome""
ETCDCTL_API=3 etcdctl get mykey
```

That's it! etcd is now running and serving client requests. For more

- [Animated quick demo][demo-gif]
- [Interactive etcd playground][etcd-play]

[demo-gif]: ./Documentation/demo.md
[etcd-play]: http://play.etcd.io/

### etcd TCP ports

The [official etcd ports][iana-ports] are 2379 for client requests, and 2380 for peer communication.

[iana-ports]: https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml?search=etcd

### Running a local etcd cluster

First install [goreman](https://github.com/mattn/goreman), which manages Procfile-based applications.

Our [Procfile script](./Procfile) will set up a local example cluster. Start it with:

```sh
goreman start
```

This will bring up 3 etcd members `infra1`, `infra2` and `infra3` and etcd proxy `proxy`, which runs locally and composes a cluster.

Every cluster member and proxy accepts key value reads and key value writes.

### Running etcd on Kubernetes

If you want to run etcd cluster on Kubernetes, try [etcd operator](https://github.com/coreos/etcd-operator).

### Next steps

Now it's time to dig into the full etcd API and other guides.

- Read the full [documentation][fulldoc].
- Explore the full gRPC [API][api].
- Set up a [multi-machine cluster][clustering].
- Learn the [config format, env variables and flags][configuration].
- Find [language bindings and tools][libraries-and-tools].
- Use TLS to [secure an etcd cluster][security].
- [Tune etcd][tuning].

[fulldoc]: ./Documentation/docs.md
[api]: ./Documentation/dev-guide/api_reference_v3.md
[clustering]: ./Documentation/op-guide/clustering.md
[configuration]: ./Documentation/op-guide/configuration.md
[libraries-and-tools]: ./Documentation/libraries-and-tools.md
[security]: ./Documentation/op-guide/security.md
[tuning]: ./Documentation/tuning.md

## Contact

- Mailing list: [etcd-dev](https://groups.google.com/forum/?hl=en#!forum/etcd-dev)
- IRC: #[etcd](irc://irc.freenode.org:6667/#etcd) on freenode.org
- Planning/Roadmap: [milestones](https://github.com/coreos/etcd/milestones), [roadmap](./ROADMAP.md)
- Bugs: [issues](https://github.com/coreos/etcd/issues)

## Contributing

See [CONTRIBUTING](CONTRIBUTING.md) for details on submitting patches and the contribution workflow.

## Reporting bugs

See [reporting bugs](Documentation/reporting_bugs.md) for details about reporting any issue you may encounter.

### License

etcd is under the Apache 2.0 license. See the [LICENSE](LICENSE) file for details.",False,"```
## License

etcd is under the Apache 2.0 license. See the LICENSE file for details.
```"
66,67,NomosTestfiles/Apache/install-windows-quirks.xml.inc,Apache-2.0,"<?xml version=""1.0""?>
<!--
Copyright (c) 2007-2016 Pivotal Software, Inc.

All rights reserved. This program and the accompanying materials
are made available under the terms of the under the Apache License,
Version 2.0 (the ""License”); you may not use this file except in compliance
with the License. You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an ""AS IS"" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<doc:section xmlns:doc=""http://www.rabbitmq.com/namespaces/ad-hoc/doc""
xmlns:xi=""http://www.w3.org/2003/XInclude""
name=""windows-quirks"">
<doc:heading>Windows-specific Issues</doc:heading>
<p>
We aim to make RabbitMQ a first-class citizen on
Windows. However, sometimes there are circumstances beyond our
control. Please consult the <a href=""windows-quirks.html"">Windows-specific Issues</a> page.
</p>
</doc:section>
",False,"```
Copyright (c) 2007-2016 Pivotal Software, Inc.

All rights reserved. This program and the accompanying materials
are made available under the terms of the under the Apache License,
Version 2.0 (the ""License”); you may not use this file except in compliance
with the License. You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an ""AS IS"" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
```"
67,68,NomosTestfiles/Apache/LGPL-3.0+_or_Apache.txt,"Apache
LGPL-3.0-or-later","/*
* Copyright (C) 2007-2010 Júlio Vilmar Gesser.
* Copyright (C) 2011, 2013-2015 The JavaParser Team.
*
* This file is part of JavaParser.
*
* JavaParser can be used either under the terms of
* a) the GNU Lesser General Public License as published by
* the Free Software Foundation, either version 3 of the License, or
* (at your option) any later version.
* b) the terms of the Apache License
*
* You should have received a copy of both licenses in LICENCE.LGPL and
* LICENCE.APACHE. Please refer to those files for details.
*
* JavaParser is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
* GNU Lesser General Public License for more details.
*/",False,"```
* This file is part of JavaParser.
*
* JavaParser can be used either under the terms of
* a) the GNU Lesser General Public License as published by
* the Free Software Foundation, either version 3 of the License, or
* (at your option) any later version.
* b) the terms of the Apache License
*
* You should have received a copy of both licenses in LICENCE.LGPL and
* LICENCE.APACHE. Please refer to those files for details.
*
* JavaParser is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
* GNU Lesser General Public License for more details.
```"
68,69,NomosTestfiles/Apache/License-2.0.Apache_v2.0,Apache-2.0,"
                                 Apache License
                           Version 2.0, January 2004
                        http://www.apache.org/licenses/

   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

   1. Definitions.

      ""License"" shall mean the terms and conditions for use, reproduction,
      and distribution as defined by Sections 1 through 9 of this document.

      ""Licensor"" shall mean the copyright owner or entity authorized by
      the copyright owner that is granting the License.

      ""Legal Entity"" shall mean the union of the acting entity and all
      other entities that control, are controlled by, or are under common
      control with that entity. For the purposes of this definition,
      ""control"" means (i) the power, direct or indirect, to cause the
      direction or management of such entity, whether by contract or
      otherwise, or (ii) ownership of fifty percent (50%) or more of the
      outstanding shares, or (iii) beneficial ownership of such entity.

      ""You"" (or ""Your"") shall mean an individual or Legal Entity
      exercising permissions granted by this License.

      ""Source"" form shall mean the preferred form for making modifications,
      including but not limited to software source code, documentation
      source, and configuration files.

      ""Object"" form shall mean any form resulting from mechanical
      transformation or translation of a Source form, including but
      not limited to compiled object code, generated documentation,
      and conversions to other media types.

      ""Work"" shall mean the work of authorship, whether in Source or
      Object form, made available under the License, as indicated by a
      copyright notice that is included in or attached to the work
      (an example is provided in the Appendix below).

      ""Derivative Works"" shall mean any work, whether in Source or Object
      form, that is based on (or derived from) the Work and for which the
      editorial revisions, annotations, elaborations, or other modifications
      represent, as a whole, an original work of authorship. For the purposes
      of this License, Derivative Works shall not include works that remain
      separable from, or merely link (or bind by name) to the interfaces of,
      the Work and Derivative Works thereof.

      ""Contribution"" shall mean any work of authorship, including
      the original version of the Work and any modifications or additions
      to that Work or Derivative Works thereof, that is intentionally
      submitted to Licensor for inclusion in the Work by the copyright owner
      or by an individual or Legal Entity authorized to submit on behalf of
      the copyright owner. For the purposes of this definition, ""submitted""
      means any form of electronic, verbal, or written communication sent
      to the Licensor or its representatives, including but not limited to
      communication on electronic mailing lists, source code control systems,
      and issue tracking systems that are managed by, or on behalf of, the
      Licensor for the purpose of discussing and improving the Work, but
      excluding communication that is conspicuously marked or otherwise
      designated in writing by the copyright owner as ""Not a Contribution.""

      ""Contributor"" shall mean Licensor and any individual or Legal Entity
      on behalf of whom a Contribution has been received by Licensor and
      subsequently incorporated within the Work.

   2. Grant of Copyright License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      copyright license to reproduce, prepare Derivative Works of,
      publicly display, publicly perform, sublicense, and distribute the
      Work and such Derivative Works in Source or Object form.

   3. Grant of Patent License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      (except as stated in this section) patent license to make, have made,
      use, offer to sell, sell, import, and otherwise transfer the Work,
      where such license applies only to those patent claims licensable
      by such Contributor that are necessarily infringed by their
      Contribution(s) alone or by combination of their Contribution(s)
      with the Work to which such Contribution(s) was submitted. If You
      institute patent litigation against any entity (including a
      cross-claim or counterclaim in a lawsuit) alleging that the Work
      or a Contribution incorporated within the Work constitutes direct
      or contributory patent infringement, then any patent licenses
      granted to You under this License for that Work shall terminate
      as of the date such litigation is filed.

   4. Redistribution. You may reproduce and distribute copies of the
      Work or Derivative Works thereof in any medium, with or without
      modifications, and in Source or Object form, provided that You
      meet the following conditions:

      (a) You must give any other recipients of the Work or
          Derivative Works a copy of this License; and

      (b) You must cause any modified files to carry prominent notices
          stating that You changed the files; and

      (c) You must retain, in the Source form of any Derivative Works
          that You distribute, all copyright, patent, trademark, and
          attribution notices from the Source form of the Work,
          excluding those notices that do not pertain to any part of
          the Derivative Works; and

      (d) If the Work includes a ""NOTICE"" text file as part of its
          distribution, then any Derivative Works that You distribute must
          include a readable copy of the attribution notices contained
          within such NOTICE file, excluding those notices that do not
          pertain to any part of the Derivative Works, in at least one
          of the following places: within a NOTICE text file distributed
          as part of the Derivative Works; within the Source form or
          documentation, if provided along with the Derivative Works; or,
          within a display generated by the Derivative Works, if and
          wherever such third-party notices normally appear. The contents
          of the NOTICE file are for informational purposes only and
          do not modify the License. You may add Your own attribution
          notices within Derivative Works that You distribute, alongside
          or as an addendum to the NOTICE text from the Work, provided
          that such additional attribution notices cannot be construed
          as modifying the License.

      You may add Your own copyright statement to Your modifications and
      may provide additional or different license terms and conditions
      for use, reproduction, or distribution of Your modifications, or
      for any such Derivative Works as a whole, provided Your use,
      reproduction, and distribution of the Work otherwise complies with
      the conditions stated in this License.

   5. Submission of Contributions. Unless You explicitly state otherwise,
      any Contribution intentionally submitted for inclusion in the Work
      by You to the Licensor shall be under the terms and conditions of
      this License, without any additional terms or conditions.
      Notwithstanding the above, nothing herein shall supersede or modify
      the terms of any separate license agreement you may have executed
      with Licensor regarding such Contributions.

   6. Trademarks. This License does not grant permission to use the trade
      names, trademarks, service marks, or product names of the Licensor,
      except as required for reasonable and customary use in describing the
      origin of the Work and reproducing the content of the NOTICE file.

   7. Disclaimer of Warranty. Unless required by applicable law or
      agreed to in writing, Licensor provides the Work (and each
      Contributor provides its Contributions) on an ""AS IS"" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
      implied, including, without limitation, any warranties or conditions
      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
      PARTICULAR PURPOSE. You are solely responsible for determining the
      appropriateness of using or redistributing the Work and assume any
      risks associated with Your exercise of permissions under this License.

   8. Limitation of Liability. In no event and under no legal theory,
      whether in tort (including negligence), contract, or otherwise,
      unless required by applicable law (such as deliberate and grossly
      negligent acts) or agreed to in writing, shall any Contributor be
      liable to You for damages, including any direct, indirect, special,
      incidental, or consequential damages of any character arising as a
      result of this License or out of the use or inability to use the
      Work (including but not limited to damages for loss of goodwill,
      work stoppage, computer failure or malfunction, or any and all
      other commercial damages or losses), even if such Contributor
      has been advised of the possibility of such damages.

   9. Accepting Warranty or Additional Liability. While redistributing
      the Work or Derivative Works thereof, You may choose to offer,
      and charge a fee for, acceptance of support, warranty, indemnity,
      or other liability obligations and/or rights consistent with this
      License. However, in accepting such obligations, You may act only
      on Your own behalf and on Your sole responsibility, not on behalf
      of any other Contributor, and only if You agree to indemnify,
      defend, and hold each Contributor harmless for any liability
      incurred by, or claims asserted against, such Contributor by reason
      of your accepting any such warranty or additional liability.

   END OF TERMS AND CONDITIONS

   APPENDIX: How to apply the Apache License to your work.

      To apply the Apache License to your work, attach the following
      boilerplate notice, with the fields enclosed by brackets ""[]""
      replaced with your own identifying information. (Don't include
      the brackets!)  The text should be enclosed in the appropriate
      comment syntax for the file format. We also recommend that a
      file or class name and description of purpose be included on the
      same ""printed page"" as the copyright notice for easier
      identification within third-party archives.

   Copyright [yyyy] [name of copyright owner]

   Licensed under the Apache License, Version 2.0 (the ""License"");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an ""AS IS"" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
",False,"```
Apache License
Version 2.0, January 2004
http://www.apache.org/licenses/

TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

1. Definitions.

   ""License"" shall mean the terms and conditions for use, reproduction,
   and distribution as defined by Sections 1 through 9 of this document.

   ""Licensor"" shall mean the copyright owner or entity authorized by
   the copyright owner that is granting the License.

   ""Legal Entity"" shall mean the union of the acting entity and all
   other entities that control, are controlled by, or are under common
   control with that entity. For the purposes of this definition,
   ""control"" means (i) the power, direct or indirect, to cause the
   direction or management of such entity, whether by contract or
   otherwise, or (ii) ownership of fifty percent (50%) or more of the
   outstanding shares, or (iii) beneficial ownership of such entity.

   ""You"" (or ""Your"") shall mean an individual or Legal Entity
   exercising permissions granted by this License.

   ""Source"" form shall mean the preferred form for making modifications,
   including but not limited to software source code, documentation
   source, and configuration files.

   ""Object"" form shall mean any form resulting from mechanical
   transformation or translation of a Source form, including but
   not to compiled object code, generated documentation,
   and conversions to other media types.

   ""Work"" shall mean the work of authorship, whether in Source or
   Object form, made available under the License, as indicated by a
   copyright notice that is included in or attached to the work
   (an example is provided in the Appendix below).

   ""Derivative Works"" shall mean any work, whether in Source or Object
   form, that is based on (or derived from) the Work and for which the
   editorial revisions, annotations, elaborations, or other modifications
   represent, as a whole, an original work of authorship. For the purposes
   of this License, Derivative Works shall not include works that remain
   separable from, or merely link (or bind by name) to the interfaces of,
   the Work and Derivative Works thereof.

   ""Contribution"" shall mean any work of authorship, including
   the original version of the Work and any modifications or additions
   to that Work or Derivative Works thereof, that is intentionally
   submitted to Licensor for inclusion in the Work by the copyright owner
   or by an individual or Legal Entity authorized to submit on behalf of
   the copyright owner. For the purposes of this definition, ""submitted""
   means any form of electronic, verbal, or written communication sent
   to the Licensor or its representatives, including but not limited to
   communication on electronic mailing lists, source code control systems,
   and issue tracking systems that are managed by, or on behalf of, the
   Licensor for the purpose of discussing and improving the Work, but
   excluding communication that is conspicuously marked or otherwise
   designated in writing by the copyright owner as ""Not a Contribution.""

   ""Contributor"" shall mean Licensor and any individual or Legal Entity
   on behalf of whom a Contribution has been received by Licensor and
   subsequently incorporated within the Work.

2. Grant of Copyright License. Subject to the terms and conditions of
   this License, each Contributor hereby grants to You a perpetual,
   worldwide, non-exclusive, no-charge, royalty-free, irrevocable
   copyright license to reproduce, prepare Derivative Works of,
   publicly display, publicly perform, sublicense, and distribute the
   Work and such Derivative Works in Source or Object form.

3. Grant of Patent License. Subject to the terms and conditions of
   this License, each Contributor hereby grants to You a perpetual,
   worldwide, non-exclusive, no-charge, royalty-free, irrevocable
   (except as stated in this section) patent license to make, have made,
   use, offer to sell, sell, import, and otherwise transfer the Work,
   where such license applies only to those patent claims licensable
   by such Contributor that are necessarily infringed by their
   Contribution(s) alone or by combination of their Contribution(s)
   with the Work to which such Contribution(s) was submitted. If You
   institute patent litigation against any entity (including a
   cross-claim or counterclaim in a lawsuit) alleging that the Work
   or a Contribution incorporated within the Work constitutes direct
   or contributory patent infringement, then any patent licenses
   granted to You under this License for that Work shall terminate
   as of the date such litigation is filed.

4. Redistribution. You may reproduce and distribute copies of the
   Work or Derivative Works thereof in any medium, with or without
   modifications, and in Source or Object form, provided that You
   meet the following conditions:

   (a) You must give any other recipients of the Work or
       Derivative Works a copy of this License; and

   (b) You must cause any modified files to carry prominent notices
       stating that You changed the files; and

   (c) You must retain, in the Source form of any Derivative Works
       that You distribute, all copyright, patent, trademark, and
       attribution notices from the Source form of the Work,
       excluding those notices that do not pertain to any part of
       the Derivative Works; and

   (d) If the Work includes a ""NOTICE"" text file as part of its
       distribution, then any Derivative Works that You distribute must
       include a readable copy of the attribution notices contained
       within such NOTICE file, excluding those notices that do not
       pertain to any part of the Derivative Works, in at least one
       of the following places: within a NOTICE text file distributed
       as part of the Derivative Works; within the Source form or
       documentation, if provided along with the Derivative Works; or,
       within a display generated by the Derivative Works, if and
       wherever such third-party notices normally appear. The contents
       of the NOTICE file are for informational purposes only and
       do not modify the License. You may add Your own attribution
       notices within Derivative Works that You distribute, alongside
       or as an addendum to the NOTICE text from the Work, provided
       that such additional attribution notices cannot be construed
       as modifying the License.

   You may add Your own copyright statement to Your modifications and
   may provide additional or different license terms and conditions
   for use, reproduction, or distribution of Your modifications, or
   for any such Derivative Works as a whole, provided Your use,
   reproduction, and distribution of the Work otherwise complies with
   the conditions stated in this License.

5. Submission of Contributions. Unless You explicitly state otherwise,
   any Contribution intentionally submitted for inclusion in the Work
   by You to the Licensor shall be under the terms and conditions of
   this License, without any additional terms or conditions.
   Notwithstanding the above, nothing herein shall supersede or modify
   the terms of any separate license agreement you may have executed
   with Licensor regarding such Contributions.

6. Trademarks. This License does not grant permission to use the trade
   names, trademarks, service marks, or product names of the Licensor,
   except as required for reasonable and customary use in describing the
   origin of the Work and reproducing the content of the NOTICE file.

7. Disclaimer of Warranty. Unless required by applicable law or
   agreed to in writing, Licensor provides the Work (and each
   Contributor provides its Contributions) on an ""AS IS"" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
   implied, including, without limitation, any warranties or conditions
   of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
   PARTICULAR PURPOSE. You are solely responsible for determining the
   appropriateness of using or redistributing the Work and assume any
   risks associated with Your exercise of permissions under this License.

8. Limitation of Liability. In no event and under no legal theory,
   whether in tort (including negligence), contract, or otherwise,
   unless required by applicable law (such as deliberate and grossly
   negligent acts) or agreed to in writing, shall any Contributor be
   liable to You for damages, including any direct, indirect, special,
   incidental, or consequential damages of any character arising as a
   result of this License or out of the use or inability to use the
   Work (including but not limited to damages for loss of goodwill,
   work stoppage, computer failure or malfunction, or any and all
   other commercial damages or losses), even if such Contributor
   has been advised of the possibility of such damages.

9. Accepting Warranty or Additional Liability. While redistributing
   the Work or Derivative Works thereof, You may choose to offer,
   and charge a fee for, acceptance of support, warranty, indemnity,
   or other liability obligations and/or rights consistent with this
   License. However, in accepting such obligations, You may act only
   on Your own behalf and on Your sole responsibility, not on behalf
   of any other Contributor, and only if You agree to indemnify,
   defend, and hold each Contributor harmless for any liability
   incurred by, or claims asserted against, such Contributor by reason
   of your accepting any such warranty or additional liability.

END OF TERMS AND CONDITIONS

APPENDIX: How to apply the Apache License to your work.

To apply the Apache License to your work, attach the following
boilerplate notice, with the fields enclosed by brackets ""[]""
replaced with your own identifying information. (Don't include
the brackets!)  The text should be enclosed in the appropriate
comment syntax for the file format. We also recommend that a
file or class name and description of purpose be included on the
same ""printed page"" as the copyright notice for easier
identification within third-party archives.

Copyright [yyyy] [name of copyright owner]

Licensed under the Apache License, Version 2.0 (the ""License"");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an ""AS IS"" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
```"
69,70,NomosTestfiles/Apache/license.txt,"Apache-2.0
LGPL-2.0-only","Format: http://www.debian.org/doc/packaging-manuals/copyright-format/1.0/
Upstream-Name: Jetty
Upstream-Contact: Mortbay Consulting
Source: http://jetty.mortbay.com/

Files: *
Copyright: 2004-2009, Mortbay Consulting
License: Apache-2.0

Files: contrib/jboss/src/main/java/org/jboss/jetty/JettyDeployer.java
Copyright: 2006, Mort Bay Consulting Pty. Ltd.
License: LGPL-2

Files: contrib/jetty-ant/src/main/java/org/mortbay/jetty/ant/*
Copyright: 2006-2007, Sabre Holdings
License: Apache-2.0

Files: examples/test-webapp/src/main/webapp/WEB-INF/tags/panel.tag
Copyright: 2002, The Apache Software Foundation
License: Apache-2.0

Files: examples/test-webapp/src/test/java/com/acme/DispatchServletTest.java
Copyright: 2009, Webtide LLC
License: Apache-2.0

Files: extras/xbean/*
Copyright: 2005-2006, The Apache Software Foundation
License: Apache-2.0

Files: extras/gwt/src/main/java/org/mortbay/gwt/AsyncRemoteServiceServlet.java
extras/gwt/src/main/java/com/google/gwt/user/server/rpc/OpenRemoteServiceServlet.java
Copyright: 2006, Google Inc
2006, Craig Day
License: Apache-2.0

Files: modules/jetty/src/main/java/org/mortbay/jetty/security/UnixCrypt.java
Copyright: 1996, Aki Yoshida,
2001, Iris Van den Broeke, Daniel Deville.
License: other
Permission to use, copy, modify and distribute this software
for non-commercial or commercial purposes and without fee is
hereby granted provided that this copyright notice appears in
all copies.

Files: modules/jetty/src/test/java/org/mortbay/jetty/servlet/SessionManagerTest.java
modules/util/src/main/java/org/mortbay/servlet/ThrottlingFilter.java
Copyright: 2006, Tim Vernum
License: Apache-2.0

Files: modules/jetty/src/main/java/org/mortbay/jetty/security/PKCS12Import.java
Copyright: 1999, Jason Gilbert
License: Apache-2.0

Files: modules/jetty/src/main/java/org/mortbay/jetty/security/HTAccessHandler.java
Copyright: 2001, Deville Daniel
License: other
Permission to use, copy, modify and distribute this software
for non-commercial or commercial purposes and without fee is
hereby granted provided that this copyright notice appears in
all copies.

Files: debian/*
Copyright: 2003, Philipp Meier
2009, Ludovic Claude
2009, David Yu
License: Apache-2.0

License: Apache-2.0
On Debian GNU/Linux system you can find the complete text of the
Apache 2.0 license in '/usr/share/common-licenses/Apache-2.0'.

License: LGPL-2
On Debian GNU/Linux system you can find the complete text of the
LGPL 2 license in '/usr/share/common-licenses/LGPL-2'.
",False,"```
License: Apache-2.0
On Debian GNU/Linux system you can find the complete text of the
Apache 2.0 license in '/usr/share/common-licenses/Apache-2.0'.
```"
70,71,NomosTestfiles/Apache/NOTICE.txt,Apache-2.0,"=============================================================================
= NOTICE file corresponding to section 4d of the Apache License Version 2.0 =
=============================================================================
This product includes software developed by
Joda.org (https://www.joda.org/).",False,"```
= NOTICE file corresponding to section 4d of the Apache License Version 2.0 =
This product includes software developed by
Joda.org (https://www.joda.org/).
```"
71,72,NomosTestfiles/Apache/Subject.java-Apache-2.0,Apache-2.0,"/*
 *  Licensed to the Apache Software Foundation (ASF) under one or more
 *  contributor license agreements.  See the NOTICE file distributed with
 *  this work for additional information regarding copyright ownership.
 *  The ASF licenses this file to You under the Apache License, Version 2.0
 *  (the ""License""); you may not use this file except in compliance with
 *  the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an ""AS IS"" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */

package javax.security.auth;

import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.Serializable;
import java.security.AccessControlContext;
import java.security.AccessController;
import java.security.DomainCombiner;
import java.security.Permission;
import java.security.Principal;
import java.security.PrivilegedAction;
import java.security.PrivilegedActionException;
import java.security.PrivilegedExceptionAction;
import java.security.ProtectionDomain;
import java.util.AbstractSet;
import java.util.Collection;
import java.util.Iterator;
import java.util.LinkedList;
import java.util.Set;

/**
 * The central class of the {@code javax.security.auth} package representing an
 * authenticated user or entity (both referred to as ""subject""). IT defines also
 * the static methods that allow code to be run, and do modifications according
 * to the subject's permissions.
 * <p>
 * A subject has the following features:
 * <ul>
 * <li>A set of {@code Principal} objects specifying the identities bound to a
 * {@code Subject} that distinguish it.</li>
 * <li>Credentials (public and private) such as certificates, keys, or
 * authentication proofs such as tickets</li>
 * </ul>
 */
public final class Subject implements Serializable {

    private static final long serialVersionUID = -8308522755600156056L;

    private static final AuthPermission _AS = new AuthPermission(""doAs"");

    private static final AuthPermission _AS_PRIVILEGED = new AuthPermission(
            ""doAsPrivileged"");

    private static final AuthPermission _SUBJECT = new AuthPermission(
            ""getSubject"");

    private static final AuthPermission _PRINCIPALS = new AuthPermission(
            ""modifyPrincipals"");

    private static final AuthPermission _PRIVATE_CREDENTIALS = new AuthPermission(
            ""modifyPrivateCredentials"");

    private static final AuthPermission _PUBLIC_CREDENTIALS = new AuthPermission(
            ""modifyPublicCredentials"");

    private static final AuthPermission _READ_ONLY = new AuthPermission(
            ""setReadOnly"");

    private final Set<Principal> principals;

    private boolean readOnly;

    // set of private credentials
    private transient SecureSet<Object> privateCredentials;

    // set of public credentials
    private transient SecureSet<Object> publicCredentials;

    /**
     * The default constructor initializing the sets of public and private
     * credentials and principals with the empty set.
     */
    public Subject() {
        principals = new SecureSet<Principal>(_PRINCIPALS);
        publicCredentials = new SecureSet<Object>(_PUBLIC_CREDENTIALS);
        privateCredentials = new SecureSet<Object>(_PRIVATE_CREDENTIALS);

        readOnly = false;
    }

    /**
     * The constructor for the subject, setting its public and private
     * credentials and principals according to the arguments.
     *
     * @param readOnly
     *            {@code true} if this {@code Subject} is read-only, thus
     *            preventing any modifications to be done.
     * @param subjPrincipals
     *            the set of Principals that are attributed to this {@code
     *            Subject}.
     * @param pubCredentials
     *            the set of public credentials that distinguish this {@code
     *            Subject}.
     * @param privCredentials
     *            the set of private credentials that distinguish this {@code
     *            Subject}.
     */
    public Subject(boolean readOnly, Set<? extends Principal> subjPrincipals,
            Set<?> pubCredentials, Set<?> privCredentials) {

        if (subjPrincipals == null || pubCredentials == null || privCredentials == null) {
            throw new NullPointerException();
        }

        principals = new SecureSet<Principal>(_PRINCIPALS, subjPrincipals);
        publicCredentials = new SecureSet<Object>(_PUBLIC_CREDENTIALS, pubCredentials);
        privateCredentials = new SecureSet<Object>(_PRIVATE_CREDENTIALS, privCredentials);

        this.readOnly = readOnly;
    }

    /**
     * Runs the code defined by {@code action} using the permissions granted to
     * the {@code Subject} itself and to the code as well.
     *
     * @param subject
     *            the distinguished {@code Subject}.
     * @param action
     *            the code to be run.
     * @return the {@code Object} returned when running the {@code action}.
     */
    @SuppressWarnings(""unchecked"")
    public static <T> T doAs(Subject subject, PrivilegedAction<T> action) {
        return doAs_PrivilegedAction(subject, action, AccessController.getContext());
    }

    /**
     * Run the code defined by {@code action} using the permissions granted to
     * the {@code Subject} and to the code itself, additionally providing a more
     * specific context.
     *
     * @param subject
     *            the distinguished {@code Subject}.
     * @param action
     *            the code to be run.
     * @param context
     *            the specific context in which the {@code action} is invoked.
     *            if {@code null} a new {@link AccessControlContext} is
     *            instantiated.
     * @return the {@code Object} returned when running the {@code action}.
     */
    @SuppressWarnings(""unchecked"")
    public static <T> T doAsPrivileged(Subject subject, PrivilegedAction<T> action,
            AccessControlContext context) {
        if (context == null) {
            return doAs_PrivilegedAction(subject, action, new AccessControlContext(
                    new ProtectionDomain[0]));
        }
        return doAs_PrivilegedAction(subject, action, context);
    }

    // instantiates a new context and passes it to AccessController
    @SuppressWarnings(""unchecked"")
    private static <T> T doAs_PrivilegedAction(Subject subject, PrivilegedAction<T> action,
            final AccessControlContext context) {

        AccessControlContext newContext;

        final SubjectDomainCombiner combiner;
        if (subject == null) {
            // performance optimization
            // if subject is null there is nothing to combine
            combiner = null;
        } else {
            combiner = new SubjectDomainCombiner(subject);
        }

        PrivilegedAction dccAction = new PrivilegedAction() {
            public Object run() {
                return new AccessControlContext(context, combiner);
            }
        };

        newContext = (AccessControlContext) AccessController.doPrivileged(dccAction);

        return AccessController.doPrivileged(action, newContext);
    }

    /**
     * Runs the code defined by {@code action} using the permissions granted to
     * the subject and to the code itself.
     *
     * @param subject
     *            the distinguished {@code Subject}.
     * @param action
     *            the code to be run.
     * @return the {@code Object} returned when running the {@code action}.
     * @throws PrivilegedActionException
     *             if running the {@code action} throws an exception.
     */
    @SuppressWarnings(""unchecked"")
    public static <T> T doAs(Subject subject, PrivilegedExceptionAction<T> action)
            throws PrivilegedActionException {
        return doAs_PrivilegedExceptionAction(subject, action, AccessController.getContext());
    }

    /**
     * Runs the code defined by {@code action} using the permissions granted to
     * the subject and to the code itself, additionally providing a more
     * specific context.
     *
     * @param subject
     *            the distinguished {@code Subject}.
     * @param action
     *            the code to be run.
     * @param context
     *            the specific context in which the {@code action} is invoked.
     *            if {@code null} a new {@link AccessControlContext} is
     *            instantiated.
     * @return the {@code Object} returned when running the {@code action}.
     * @throws PrivilegedActionException
     *             if running the {@code action} throws an exception.
     */
    @SuppressWarnings(""unchecked"")
    public static <T> T doAsPrivileged(Subject subject,
            PrivilegedExceptionAction<T> action, AccessControlContext context)
            throws PrivilegedActionException {
        if (context == null) {
            return doAs_PrivilegedExceptionAction(subject, action,
                    new AccessControlContext(new ProtectionDomain[0]));
        }
        return doAs_PrivilegedExceptionAction(subject, action, context);
    }

    // instantiates a new context and passes it to AccessController
    @SuppressWarnings(""unchecked"")
    private static <T> T doAs_PrivilegedExceptionAction(Subject subject,
            PrivilegedExceptionAction<T> action, final AccessControlContext context)
            throws PrivilegedActionException {

        AccessControlContext newContext;

        final SubjectDomainCombiner combiner;
        if (subject == null) {
            // performance optimization
            // if subject is null there is nothing to combine
            combiner = null;
        } else {
            combiner = new SubjectDomainCombiner(subject);
        }

        PrivilegedAction<AccessControlContext> dccAction = new PrivilegedAction<AccessControlContext>() {
            public AccessControlContext run() {
                return new AccessControlContext(context, combiner);
            }
        };

        newContext = AccessController.doPrivileged(dccAction);

        return AccessController.doPrivileged(action, newContext);
    }

    /**
     * Checks two Subjects for equality. More specifically if the principals,
     * public and private credentials are equal, equality for two {@code
     * Subjects} is implied.
     *
     * @param obj
     *            the {@code Object} checked for equality with this {@code
     *            Subject}.
     * @return {@code true} if the specified {@code Subject} is equal to this
     *         one.
     */
    @Override
    public boolean equals(Object obj) {

        if (this == obj) {
            return true;
        }

        if (obj == null || this.getClass() != obj.getClass()) {
            return false;
        }

        Subject that = (Subject) obj;

        if (principals.equals(that.principals)
                && publicCredentials.equals(that.publicCredentials)
                && privateCredentials.equals(that.privateCredentials)) {
            return true;
        }
        return false;
    }

    /**
     * Returns this {@code Subject}'s {@link Principal}.
     *
     * @return this {@code Subject}'s {@link Principal}.
     */
    public Set<Principal> getPrincipals() {
        return principals;
    }


    /**
     * Returns this {@code Subject}'s {@link Principal} which is a subclass of
     * the {@code Class} provided.
     *
     * @param c
     *            the {@code Class} as a criteria which the {@code Principal}
     *            returned must satisfy.
     * @return this {@code Subject}'s {@link Principal}. Modifications to the
     *         returned set of {@code Principal}s do not affect this {@code
     *         Subject}'s set.
     */
    public <T extends Principal> Set<T> getPrincipals(Class<T> c) {
        return ((SecureSet<Principal>) principals).get(c);
    }

    /**
     * Returns the private credentials associated with this {@code Subject}.
     *
     * @return the private credentials associated with this {@code Subject}.
     */
    public Set<Object> getPrivateCredentials() {
        return privateCredentials;
    }

    /**
     * Returns this {@code Subject}'s private credentials which are a subclass
     * of the {@code Class} provided.
     *
     * @param c
     *            the {@code Class} as a criteria which the private credentials
     *            returned must satisfy.
     * @return this {@code Subject}'s private credentials. Modifications to the
     *         returned set of credentials do not affect this {@code Subject}'s
     *         credentials.
     */
    public <T> Set<T> getPrivateCredentials(Class<T> c) {
        return privateCredentials.get(c);
    }

    /**
     * Returns the public credentials associated with this {@code Subject}.
     *
     * @return the public credentials associated with this {@code Subject}.
     */
    public Set<Object> getPublicCredentials() {
        return publicCredentials;
    }


    /**
     * Returns this {@code Subject}'s public credentials which are a subclass of
     * the {@code Class} provided.
     *
     * @param c
     *            the {@code Class} as a criteria which the public credentials
     *            returned must satisfy.
     * @return this {@code Subject}'s public credentials. Modifications to the
     *         returned set of credentials do not affect this {@code Subject}'s
     *         credentials.
     */
    public <T> Set<T> getPublicCredentials(Class<T> c) {
        return publicCredentials.get(c);
    }

    /**
     * Returns a hash code of this {@code Subject}.
     *
     * @return a hash code of this {@code Subject}.
     */
    @Override
    public int hashCode() {
        return principals.hashCode() + privateCredentials.hashCode()
                + publicCredentials.hashCode();
    }

    /**
     * Prevents from modifications being done to the credentials and {@link
     * Principal} sets. After setting it to read-only this {@code Subject} can
     * not be made writable again. The destroy method on the credentials still
     * works though.
     */
    public void setReadOnly() {
        readOnly = true;
    }

    /**
     * Returns whether this {@code Subject} is read-only or not.
     *
     * @return whether this {@code Subject} is read-only or not.
     */
    public boolean isReadOnly() {
        return readOnly;
    }

    /**
     * Returns a {@code String} representation of this {@code Subject}.
     *
     * @return a {@code String} representation of this {@code Subject}.
     */
    @Override
    public String toString() {
        StringBuilder buf = new StringBuilder(""Subject:\n"");

        Iterator<?> it = principals.iterator();
        while (it.hasNext()) {
            buf.append(""\tPrincipal: "");
            buf.append(it.next());
            buf.append('\n');
        }

        it = publicCredentials.iterator();
        while (it.hasNext()) {
            buf.append(""\tPublic Credential: "");
            buf.append(it.next());
            buf.append('\n');
        }

        int offset = buf.length() - 1;
        it = privateCredentials.iterator();
        try {
            while (it.hasNext()) {
                buf.append(""\tPrivate Credential: "");
                buf.append(it.next());
                buf.append('\n');
            }
        } catch (SecurityException e) {
            buf.delete(offset, buf.length());
            buf.append(""\tPrivate Credentials: no accessible information\n"");
        }
        return buf.toString();
    }

    private void readObject(ObjectInputStream in) throws IOException,
            ClassNotFoundException {

        in.defaultReadObject();

        publicCredentials = new SecureSet<Object>(_PUBLIC_CREDENTIALS);
        privateCredentials = new SecureSet<Object>(_PRIVATE_CREDENTIALS);
    }

    private void writeObject(ObjectOutputStream out) throws IOException {
        out.defaultWriteObject();
    }

    /**
     * Returns the {@code Subject} that was last associated with the {@code
     * context} provided as argument.
     *
     * @param context
     *            the {@code context} that was associated with the
     *            {@code Subject}.
     * @return the {@code Subject} that was last associated with the {@code
     *         context} provided as argument.
     */
    public static Subject getSubject(final AccessControlContext context) {
        if (context == null) {
            throw new NullPointerException(""AccessControlContext cannot be null"");
        }
        PrivilegedAction<DomainCombiner> action = new PrivilegedAction<DomainCombiner>() {
            public DomainCombiner run() {
                return context.getDomainCombiner();
            }
        };
        DomainCombiner combiner = AccessController.doPrivileged(action);

        if ((combiner == null) || !(combiner instanceof SubjectDomainCombiner)) {
            return null;
        }
        return ((SubjectDomainCombiner) combiner).getSubject();
    }

    private void checkState() {
        if (readOnly) {
            throw new IllegalStateException(""Set is read-only"");
        }
    }

    private final class SecureSet<SST> extends AbstractSet<SST> implements Serializable {

        /**
         * Compatibility issue: see comments for setType variable
         */
        private static final long serialVersionUID = 7911754171111800359L;

        private LinkedList<SST> elements;

        /*
         * Is used to define a set type for serialization.
         *
         * A type can be principal, priv. or pub. credential set. The spec.
         * doesn't clearly says that priv. and pub. credential sets can be
         * serialized and what classes they are. It is only possible to figure
         * out from writeObject method comments that priv. credential set is
         * serializable and it is an instance of SecureSet class. So pub.
         * credential was implemented by analogy
         *
         * Compatibility issue: the class follows its specified serial form.
         * Also according to the serialization spec. adding new field is a
         * compatible change. So is ok for principal set (because the default
         * value for integer is zero). But priv. or pub. credential set it is
         * not compatible because most probably other implementations resolve
         * this issue in other way
         */
        private int setType;

        // Defines principal set for serialization.
        private static final int SET_Principal = 0;

        // Defines private credential set for serialization.
        private static final int SET_PrivCred = 1;

        // Defines public credential set for serialization.
        private static final int SET_PubCred = 2;

        // permission required to modify set
        private transient AuthPermission permission;

        protected SecureSet(AuthPermission perm) {
            permission = perm;
            elements = new LinkedList<SST>();
        }

        // creates set from specified collection with specified permission
        // all collection elements are verified before adding
        protected SecureSet(AuthPermission perm, Collection<? extends SST> s) {
            this(perm);

            // Subject's constructor receives a Set, we can trusts if a set is from bootclasspath,
            // and not to check whether it contains duplicates or not
            boolean trust = s.getClass().getClassLoader() == null;

            for (SST o : s) {
                verifyElement(o);
                if (trust || !elements.contains(o)) {
                    elements.add(o);
                }
            }
        }

        // verifies new set element
        private void verifyElement(Object o) {

            if (o == null) {
                throw new NullPointerException();
            }
            if (permission == _PRINCIPALS && !(Principal.class.isAssignableFrom(o.getClass()))) {
                throw new IllegalArgumentException(""Element is not instance of java.security.Principal"");
            }
        }

        /*
         * verifies specified element, checks set state, and security permission
         * to modify set before adding new element
         */
        @Override
        public boolean add(SST o) {

            verifyElement(o);

            checkState();

            if (!elements.contains(o)) {
                elements.add(o);
                return true;
            }
            return false;
        }

        // returns an instance of SecureIterator
        @Override
        public Iterator<SST> iterator() {

            if (permission == _PRIVATE_CREDENTIALS) {
                /*
                 * private credential set requires iterator with additional
                 * security check (PrivateCredentialPermission)
                 */
                return new SecureIterator(elements.iterator()) {
                    /*
                     * checks permission to access next private credential moves
                     * to the next element even SecurityException was thrown
                     */
                    @Override
                    public SST next() {
                        SST obj = iterator.next();
                        return obj;
                    }
                };
            }
            return new SecureIterator(elements.iterator());
        }

        @Override
        public boolean retainAll(Collection<?> c) {

            if (c == null) {
                throw new NullPointerException();
            }
            return super.retainAll(c);
        }

        @Override
        public int size() {
            return elements.size();
        }

        /**
         * return set with elements that are instances or subclasses of the
         * specified class
         */
        protected final <E> Set<E> get(final Class<E> c) {

            if (c == null) {
                throw new NullPointerException();
            }

            AbstractSet<E> s = new AbstractSet<E>() {
                private LinkedList<E> elements = new LinkedList<E>();

                @Override
                public boolean add(E o) {
                    if (!c.isAssignableFrom(o.getClass())) {
                        throw new IllegalArgumentException(""Invalid type: "" + o.getClass());
                    }

                    if (elements.contains(o)) {
                        return false;
                    }
                    elements.add(o);
                    return true;
                }

                @Override
                public Iterator<E> iterator() {
                    return elements.iterator();
                }

                @Override
                public boolean retainAll(Collection<?> c) {

                    if (c == null) {
                        throw new NullPointerException();
                    }
                    return super.retainAll(c);
                }

                @Override
                public int size() {
                    return elements.size();
                }
            };

            // FIXME must have permissions for requested priv. credentials
            for (SST o : this) {
                if (c.isAssignableFrom(o.getClass())) {
                    s.add(c.cast(o));
                }
            }
            return s;
        }

        private void readObject(ObjectInputStream in) throws IOException,
                ClassNotFoundException {
            in.defaultReadObject();

            switch (setType) {
            case SET_Principal:
                permission = _PRINCIPALS;
                break;
            case SET_PrivCred:
                permission = _PRIVATE_CREDENTIALS;
                break;
            case SET_PubCred:
                permission = _PUBLIC_CREDENTIALS;
                break;
            default:
                throw new IllegalArgumentException();
            }

            for (SST element : elements) {
                verifyElement(element);
            }
        }

        @SuppressWarnings(""UnusedDeclaration"")
        private void writeObject(ObjectOutputStream out) throws IOException {

            if (permission == _PRIVATE_CREDENTIALS) {
                setType = SET_PrivCred;
            } else if (permission == _PRINCIPALS) {
                setType = SET_Principal;
            } else {
                setType = SET_PubCred;
            }

            out.defaultWriteObject();
        }

        /**
         * Represents iterator for subject's secure set
         */
        private class SecureIterator implements Iterator<SST> {
            protected Iterator<SST> iterator;

            protected SecureIterator(Iterator<SST> iterator) {
                this.iterator = iterator;
            }

            public boolean hasNext() {
                return iterator.hasNext();
            }

            public SST next() {
                return iterator.next();
            }

            /**
             * checks set state, and security permission to modify set before
             * removing current element
             */
            public void remove() {
                checkState();
                iterator.remove();
            }
        }
    }
}
",False,"```java
/*
 *  Licensed to the Apache Software Foundation (ASF) under one or more
 *  contributor license agreements.  See the NOTICE file distributed with
 *  this work for additional information regarding copyright ownership.
 *  The ASF licenses this file to You under the Apache License, Version 2.0
 *  (the ""License""); you may not use this file except in compliance with
 *  the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an ""AS IS"" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */
package javax.security.auth;

import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.Serializable;
import java.security.AccessControlContext;
import java.security.AccessController;
import java.security.DomainCombiner;
import java.security.Permission;
import java.security.Principal;
import java.security.PrivilegedAction;
import java.security.PrivilegedExceptionAction;
import java.security.ProtectionDomain;
import java.util.AbstractSet;
import java.util.Collection;
import java.util.Iterator;
import java.util.LinkedList;
import java.util.Set;

/**
 * The central class of the {@code javax.security.auth} package representing an
 * authenticated user or entity (both referred to as ""subject""). IT defines also
 * the static methods that allow code to be run, and do modifications according
 * to the subject's permissions.
 * <p>
 * A subject has the following features:
 * <ul>
 * <li>A set of {@code Principal} objects specifying the identities bound to a
 * {@code Subject} that distinguish it.</li>
 * <li>Credentials (public and private) such as certificates, keys, or
 * authentication proofs such as tickets</li>
 * </ul>
 */
public final class Subject implements Serializable {

    private static final long serialVersionUID = -8308522755600156056L;

    private static final AuthPermission _AS = new AuthPermission(""doAs"");

    private static final AuthPermission _AS_PRIVILEGED = new AuthPermission(
            ""doAsPrivileged"");

    private static final AuthPermission _SUBJECT = new AuthPermission(
            ""getSubject"");

    private static final AuthPermission _PRINCIPALS = new AuthPermission(
            ""modifyPrincipals"");

    private static final AuthPermission _PRIVATE_CREDENTIALS = new AuthPermission(
            ""modifyPrivateCredentials"");

    private static final AuthPermission _PUBLIC_CREDENTIALS = new AuthPermission(
            ""modifyPublicCredentials"");

    private static final AuthPermission _READ_ONLY = new AuthPermission(
            ""setReadOnly"");

    private final Set<Principal> principals;

    private boolean readOnly;

    // set of private credentials
    private transient SecureSet<Object> privateCredentials;

    // set of public credentials
    private transient SecureSet<Object> publicCredentials;

    /**
     * The default constructor initializing the sets of public and private
     * credentials and principals with the empty set.
     */
    public Subject() {
        principals = new SecureSet<Principal>(_PRINCIPALS);
        publicCredentials = new SecureSet<Object>(_PUBLIC_CREDENTIALS);
        privateCredentials = new SecureSet<Object>(_PRIVATE_CREDENTIALS);

        readOnly = false;
    }

    /**
     * The constructor for the subject, setting its public and private
     * credentials and principals according to the arguments.
     *
     * @param readOnly
     *            {@code true} if this {@code Subject} is read-only, thus
     *            preventing any modifications to be done.
     * @param subjPrincipals
     *            the set of Principals that are attributed to this {@code
     *            Subject}.
     * @param pubCredentials
     *            the set of public credentials that distinguish this {@code
     *            Subject}.
     * @param privCredentials
     *            the set of private credentials that distinguish this {@code
     *            Subject}.
     */
    public Subject(boolean readOnly, Set<? extends Principal> subjPrincipals,
            Set<?> pubCredentials, Set<?> privCredentials) {

        if (subjPrincipals == null || pubCredentials == null || privCredentials == null) {
            throw new NullPointerException();
        }

        principals = new SecureSet<Principal>(_PRINCIPALS, subjPrincipals);
        publicCredentials = new SecureSet<Object>(_PUBLIC_CREDENTIALS, pubCredentials);
        privateCredentials = new SecureSet<Object>(_PRIVATE_CREDENTIALS, privCredentials);

        this.readOnly = readOnly;
    }

    /**
     * Runs the code defined by {@code action} using the permissions granted to
     * the {@code Subject} itself and to the code as well.
     *
     * @param subject
     *            the distinguished {@code Subject}.
     * @param action
     *            the code to be run.
     * @return the {@code Object} returned when running the {@code action}.
     */
    @SuppressWarnings(""unchecked"")
    public static <T> T doAs(Subject subject, PrivilegedAction<T> action) {
        return doAs_PrivilegedAction(subject, action, AccessController.getContext());
    }

    /**
     * Runs the code defined by {@code action} using the permissions granted to
     * the subject and to the code itself, additionally providing a more
     * specific context.
     *
     * @param subject
     *            the distinguished {@code Subject}.
     * @param action
     *            the code to be run.
     * @param context
     *            the specific context in which the {@code action} is invoked.
     *            if {@code null} a new {@link AccessControlContext} is
     *            instantiated.
     * @return the {@code Object} returned when running the {@code action}.
     * @throws PrivilegedActionException
     *             if running the {@code action} throws an exception.
     */
    @SuppressWarnings(""unchecked"")
    public static <T> T doAsPrivileged(Subject subject,
            PrivilegedAction<T> action, AccessControlContext context)
            throws PrivilegedActionException {
        if (context == null) {
            return doAs_PrivilegedAction(subject, action,
                    new AccessControlContext(new ProtectionDomain[0]));
        }
        return doAs_PrivilegedAction(subject, action, context);
    }

    // instantiates a new context and passes it to AccessController
    @SuppressWarnings(""unchecked"")
    private static <T> T doAs_PrivilegedAction(Subject subject,
            PrivilegedAction<T> action, final AccessControlContext context)
            throws PrivilegedActionException {

        AccessControlContext newContext;

        final SubjectDomainCombiner combiner;
        if (subject == null) {
            // performance optimization
            // if subject is null there is nothing to combine
            combiner = null;
        } else {
            combiner = new SubjectDomainCombiner(subject);
        }

        PrivilegedAction<AccessControlContext> dccAction = new PrivilegedAction<AccessControlContext>() {
            public AccessControlContext run() {
                return new AccessControlContext(context, combiner);
            }
        };

        newContext = AccessController.doPrivileged(dccAction);

        return AccessController.doPrivileged(action, newContext);
    }

    /**
     * Runs the code defined by {@code action} using the permissions granted to
     * the subject and to the code itself.
     *
     * @param subject
     *            the distinguished {@code Subject}.
     * @param action
     *            the code to be run.
     * @return the {@code Object} returned when running the {@code action}.
     * @throws PrivilegedActionException
     *             if"
72,73,NomosTestfiles/Apache/Subject.java,Apache-2.0,"/*
 *  Licensed to the Apache Software Foundation (ASF) under one or more
 *  contributor license agreements.  See the NOTICE file distributed with
 *  this work for additional information regarding copyright ownership.
 *  The ASF licenses this file to You under the Apache License, Version 2.0
 *  (the ""License""); you may not use this file except in compliance with
 *  the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an ""AS IS"" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */

package javax.security.auth;

import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.Serializable;
import java.security.AccessControlContext;
import java.security.AccessController;
import java.security.DomainCombiner;
import java.security.Permission;
import java.security.Principal;
import java.security.PrivilegedAction;
import java.security.PrivilegedActionException;
import java.security.PrivilegedExceptionAction;
import java.security.ProtectionDomain;
import java.util.AbstractSet;
import java.util.Collection;
import java.util.Iterator;
import java.util.LinkedList;
import java.util.Set;

/**
 * The central class of the {@code javax.security.auth} package representing an
 * authenticated user or entity (both referred to as ""subject""). IT defines also
 * the static methods that allow code to be run, and do modifications according
 * to the subject's permissions.
 * <p>
 * A subject has the following features:
 * <ul>
 * <li>A set of {@code Principal} objects specifying the identities bound to a
 * {@code Subject} that distinguish it.</li>
 * <li>Credentials (public and private) such as certificates, keys, or
 * authentication proofs such as tickets</li>
 * </ul>
 */
public final class Subject implements Serializable {

    private static final long serialVersionUID = -8308522755600156056L;

    private static final AuthPermission _AS = new AuthPermission(""doAs"");

    private static final AuthPermission _AS_PRIVILEGED = new AuthPermission(
            ""doAsPrivileged"");

    private static final AuthPermission _SUBJECT = new AuthPermission(
            ""getSubject"");

    private static final AuthPermission _PRINCIPALS = new AuthPermission(
            ""modifyPrincipals"");

    private static final AuthPermission _PRIVATE_CREDENTIALS = new AuthPermission(
            ""modifyPrivateCredentials"");

    private static final AuthPermission _PUBLIC_CREDENTIALS = new AuthPermission(
            ""modifyPublicCredentials"");

    private static final AuthPermission _READ_ONLY = new AuthPermission(
            ""setReadOnly"");

    private final Set<Principal> principals;

    private boolean readOnly;

    // set of private credentials
    private transient SecureSet<Object> privateCredentials;

    // set of public credentials
    private transient SecureSet<Object> publicCredentials;

    /**
     * The default constructor initializing the sets of public and private
     * credentials and principals with the empty set.
     */
    public Subject() {
        principals = new SecureSet<Principal>(_PRINCIPALS);
        publicCredentials = new SecureSet<Object>(_PUBLIC_CREDENTIALS);
        privateCredentials = new SecureSet<Object>(_PRIVATE_CREDENTIALS);

        readOnly = false;
    }

    /**
     * The constructor for the subject, setting its public and private
     * credentials and principals according to the arguments.
     *
     * @param readOnly
     *            {@code true} if this {@code Subject} is read-only, thus
     *            preventing any modifications to be done.
     * @param subjPrincipals
     *            the set of Principals that are attributed to this {@code
     *            Subject}.
     * @param pubCredentials
     *            the set of public credentials that distinguish this {@code
     *            Subject}.
     * @param privCredentials
     *            the set of private credentials that distinguish this {@code
     *            Subject}.
     */
    public Subject(boolean readOnly, Set<? extends Principal> subjPrincipals,
            Set<?> pubCredentials, Set<?> privCredentials) {

        if (subjPrincipals == null || pubCredentials == null || privCredentials == null) {
            throw new NullPointerException();
        }

        principals = new SecureSet<Principal>(_PRINCIPALS, subjPrincipals);
        publicCredentials = new SecureSet<Object>(_PUBLIC_CREDENTIALS, pubCredentials);
        privateCredentials = new SecureSet<Object>(_PRIVATE_CREDENTIALS, privCredentials);

        this.readOnly = readOnly;
    }

    /**
     * Runs the code defined by {@code action} using the permissions granted to
     * the {@code Subject} itself and to the code as well.
     *
     * @param subject
     *            the distinguished {@code Subject}.
     * @param action
     *            the code to be run.
     * @return the {@code Object} returned when running the {@code action}.
     */
    @SuppressWarnings(""unchecked"")
    public static <T> T doAs(Subject subject, PrivilegedAction<T> action) {
        return doAs_PrivilegedAction(subject, action, AccessController.getContext());
    }

    /**
     * Run the code defined by {@code action} using the permissions granted to
     * the {@code Subject} and to the code itself, additionally providing a more
     * specific context.
     *
     * @param subject
     *            the distinguished {@code Subject}.
     * @param action
     *            the code to be run.
     * @param context
     *            the specific context in which the {@code action} is invoked.
     *            if {@code null} a new {@link AccessControlContext} is
     *            instantiated.
     * @return the {@code Object} returned when running the {@code action}.
     */
    @SuppressWarnings(""unchecked"")
    public static <T> T doAsPrivileged(Subject subject, PrivilegedAction<T> action,
            AccessControlContext context) {
        if (context == null) {
            return doAs_PrivilegedAction(subject, action, new AccessControlContext(
                    new ProtectionDomain[0]));
        }
        return doAs_PrivilegedAction(subject, action, context);
    }

    // instantiates a new context and passes it to AccessController
    @SuppressWarnings(""unchecked"")
    private static <T> T doAs_PrivilegedAction(Subject subject, PrivilegedAction<T> action,
            final AccessControlContext context) {

        AccessControlContext newContext;

        final SubjectDomainCombiner combiner;
        if (subject == null) {
            // performance optimization
            // if subject is null there is nothing to combine
            combiner = null;
        } else {
            combiner = new SubjectDomainCombiner(subject);
        }

        PrivilegedAction dccAction = new PrivilegedAction() {
            public Object run() {
                return new AccessControlContext(context, combiner);
            }
        };

        newContext = (AccessControlContext) AccessController.doPrivileged(dccAction);

        return AccessController.doPrivileged(action, newContext);
    }

    /**
     * Runs the code defined by {@code action} using the permissions granted to
     * the subject and to the code itself.
     *
     * @param subject
     *            the distinguished {@code Subject}.
     * @param action
     *            the code to be run.
     * @return the {@code Object} returned when running the {@code action}.
     * @throws PrivilegedActionException
     *             if running the {@code action} throws an exception.
     */
    @SuppressWarnings(""unchecked"")
    public static <T> T doAs(Subject subject, PrivilegedExceptionAction<T> action)
            throws PrivilegedActionException {
        return doAs_PrivilegedExceptionAction(subject, action, AccessController.getContext());
    }

    /**
     * Runs the code defined by {@code action} using the permissions granted to
     * the subject and to the code itself, additionally providing a more
     * specific context.
     *
     * @param subject
     *            the distinguished {@code Subject}.
     * @param action
     *            the code to be run.
     * @param context
     *            the specific context in which the {@code action} is invoked.
     *            if {@code null} a new {@link AccessControlContext} is
     *            instantiated.
     * @return the {@code Object} returned when running the {@code action}.
     * @throws PrivilegedActionException
     *             if running the {@code action} throws an exception.
     */
    @SuppressWarnings(""unchecked"")
    public static <T> T doAsPrivileged(Subject subject,
            PrivilegedExceptionAction<T> action, AccessControlContext context)
            throws PrivilegedActionException {
        if (context == null) {
            return doAs_PrivilegedExceptionAction(subject, action,
                    new AccessControlContext(new ProtectionDomain[0]));
        }
        return doAs_PrivilegedExceptionAction(subject, action, context);
    }

    // instantiates a new context and passes it to AccessController
    @SuppressWarnings(""unchecked"")
    private static <T> T doAs_PrivilegedExceptionAction(Subject subject,
            PrivilegedExceptionAction<T> action, final AccessControlContext context)
            throws PrivilegedActionException {

        AccessControlContext newContext;

        final SubjectDomainCombiner combiner;
        if (subject == null) {
            // performance optimization
            // if subject is null there is nothing to combine
            combiner = null;
        } else {
            combiner = new SubjectDomainCombiner(subject);
        }

        PrivilegedAction<AccessControlContext> dccAction = new PrivilegedAction<AccessControlContext>() {
            public AccessControlContext run() {
                return new AccessControlContext(context, combiner);
            }
        };

        newContext = AccessController.doPrivileged(dccAction);

        return AccessController.doPrivileged(action, newContext);
    }

    /**
     * Checks two Subjects for equality. More specifically if the principals,
     * public and private credentials are equal, equality for two {@code
     * Subjects} is implied.
     *
     * @param obj
     *            the {@code Object} checked for equality with this {@code
     *            Subject}.
     * @return {@code true} if the specified {@code Subject} is equal to this
     *         one.
     */
    @Override
    public boolean equals(Object obj) {

        if (this == obj) {
            return true;
        }

        if (obj == null || this.getClass() != obj.getClass()) {
            return false;
        }

        Subject that = (Subject) obj;

        if (principals.equals(that.principals)
                && publicCredentials.equals(that.publicCredentials)
                && privateCredentials.equals(that.privateCredentials)) {
            return true;
        }
        return false;
    }

    /**
     * Returns this {@code Subject}'s {@link Principal}.
     *
     * @return this {@code Subject}'s {@link Principal}.
     */
    public Set<Principal> getPrincipals() {
        return principals;
    }


    /**
     * Returns this {@code Subject}'s {@link Principal} which is a subclass of
     * the {@code Class} provided.
     *
     * @param c
     *            the {@code Class} as a criteria which the {@code Principal}
     *            returned must satisfy.
     * @return this {@code Subject}'s {@link Principal}. Modifications to the
     *         returned set of {@code Principal}s do not affect this {@code
     *         Subject}'s set.
     */
    public <T extends Principal> Set<T> getPrincipals(Class<T> c) {
        return ((SecureSet<Principal>) principals).get(c);
    }

    /**
     * Returns the private credentials associated with this {@code Subject}.
     *
     * @return the private credentials associated with this {@code Subject}.
     */
    public Set<Object> getPrivateCredentials() {
        return privateCredentials;
    }

    /**
     * Returns this {@code Subject}'s private credentials which are a subclass
     * of the {@code Class} provided.
     *
     * @param c
     *            the {@code Class} as a criteria which the private credentials
     *            returned must satisfy.
     * @return this {@code Subject}'s private credentials. Modifications to the
     *         returned set of credentials do not affect this {@code Subject}'s
     *         credentials.
     */
    public <T> Set<T> getPrivateCredentials(Class<T> c) {
        return privateCredentials.get(c);
    }

    /**
     * Returns the public credentials associated with this {@code Subject}.
     *
     * @return the public credentials associated with this {@code Subject}.
     */
    public Set<Object> getPublicCredentials() {
        return publicCredentials;
    }


    /**
     * Returns this {@code Subject}'s public credentials which are a subclass of
     * the {@code Class} provided.
     *
     * @param c
     *            the {@code Class} as a criteria which the public credentials
     *            returned must satisfy.
     * @return this {@code Subject}'s public credentials. Modifications to the
     *         returned set of credentials do not affect this {@code Subject}'s
     *         credentials.
     */
    public <T> Set<T> getPublicCredentials(Class<T> c) {
        return publicCredentials.get(c);
    }

    /**
     * Returns a hash code of this {@code Subject}.
     *
     * @return a hash code of this {@code Subject}.
     */
    @Override
    public int hashCode() {
        return principals.hashCode() + privateCredentials.hashCode()
                + publicCredentials.hashCode();
    }

    /**
     * Prevents from modifications being done to the credentials and {@link
     * Principal} sets. After setting it to read-only this {@code Subject} can
     * not be made writable again. The destroy method on the credentials still
     * works though.
     */
    public void setReadOnly() {
        readOnly = true;
    }

    /**
     * Returns whether this {@code Subject} is read-only or not.
     *
     * @return whether this {@code Subject} is read-only or not.
     */
    public boolean isReadOnly() {
        return readOnly;
    }

    /**
     * Returns a {@code String} representation of this {@code Subject}.
     *
     * @return a {@code String} representation of this {@code Subject}.
     */
    @Override
    public String toString() {
        StringBuilder buf = new StringBuilder(""Subject:\n"");

        Iterator<?> it = principals.iterator();
        while (it.hasNext()) {
            buf.append(""\tPrincipal: "");
            buf.append(it.next());
            buf.append('\n');
        }

        it = publicCredentials.iterator();
        while (it.hasNext()) {
            buf.append(""\tPublic Credential: "");
            buf.append(it.next());
            buf.append('\n');
        }

        int offset = buf.length() - 1;
        it = privateCredentials.iterator();
        try {
            while (it.hasNext()) {
                buf.append(""\tPrivate Credential: "");
                buf.append(it.next());
                buf.append('\n');
            }
        } catch (SecurityException e) {
            buf.delete(offset, buf.length());
            buf.append(""\tPrivate Credentials: no accessible information\n"");
        }
        return buf.toString();
    }

    private void readObject(ObjectInputStream in) throws IOException,
            ClassNotFoundException {

        in.defaultReadObject();

        publicCredentials = new SecureSet<Object>(_PUBLIC_CREDENTIALS);
        privateCredentials = new SecureSet<Object>(_PRIVATE_CREDENTIALS);
    }

    private void writeObject(ObjectOutputStream out) throws IOException {
        out.defaultWriteObject();
    }

    /**
     * Returns the {@code Subject} that was last associated with the {@code
     * context} provided as argument.
     *
     * @param context
     *            the {@code context} that was associated with the
     *            {@code Subject}.
     * @return the {@code Subject} that was last associated with the {@code
     *         context} provided as argument.
     */
    public static Subject getSubject(final AccessControlContext context) {
        if (context == null) {
            throw new NullPointerException(""AccessControlContext cannot be null"");
        }
        PrivilegedAction<DomainCombiner> action = new PrivilegedAction<DomainCombiner>() {
            public DomainCombiner run() {
                return context.getDomainCombiner();
            }
        };
        DomainCombiner combiner = AccessController.doPrivileged(action);

        if ((combiner == null) || !(combiner instanceof SubjectDomainCombiner)) {
            return null;
        }
        return ((SubjectDomainCombiner) combiner).getSubject();
    }

    private void checkState() {
        if (readOnly) {
            throw new IllegalStateException(""Set is read-only"");
        }
    }

    private final class SecureSet<SST> extends AbstractSet<SST> implements Serializable {

        /**
         * Compatibility issue: see comments for setType variable
         */
        private static final long serialVersionUID = 7911754171111800359L;

        private LinkedList<SST> elements;

        /*
         * Is used to define a set type for serialization.
         *
         * A type can be principal, priv. or pub. credential set. The spec.
         * doesn't clearly says that priv. and pub. credential sets can be
         * serialized and what classes they are. It is only possible to figure
         * out from writeObject method comments that priv. credential set is
         * serializable and it is an instance of SecureSet class. So pub.
         * credential was implemented by analogy
         *
         * Compatibility issue: the class follows its specified serial form.
         * Also according to the serialization spec. adding new field is a
         * compatible change. So is ok for principal set (because the default
         * value for integer is zero). But priv. or pub. credential set it is
         * not compatible because most probably other implementations resolve
         * this issue in other way
         */
        private int setType;

        // Defines principal set for serialization.
        private static final int SET_Principal = 0;

        // Defines private credential set for serialization.
        private static final int SET_PrivCred = 1;

        // Defines public credential set for serialization.
        private static final int SET_PubCred = 2;

        // permission required to modify set
        private transient AuthPermission permission;

        protected SecureSet(AuthPermission perm) {
            permission = perm;
            elements = new LinkedList<SST>();
        }

        // creates set from specified collection with specified permission
        // all collection elements are verified before adding
        protected SecureSet(AuthPermission perm, Collection<? extends SST> s) {
            this(perm);

            // Subject's constructor receives a Set, we can trusts if a set is from bootclasspath,
            // and not to check whether it contains duplicates or not
            boolean trust = s.getClass().getClassLoader() == null;

            for (SST o : s) {
                verifyElement(o);
                if (trust || !elements.contains(o)) {
                    elements.add(o);
                }
            }
        }

        // verifies new set element
        private void verifyElement(Object o) {

            if (o == null) {
                throw new NullPointerException();
            }
            if (permission == _PRINCIPALS && !(Principal.class.isAssignableFrom(o.getClass()))) {
                throw new IllegalArgumentException(""Element is not instance of java.security.Principal"");
            }
        }

        /*
         * verifies specified element, checks set state, and security permission
         * to modify set before adding new element
         */
        @Override
        public boolean add(SST o) {

            verifyElement(o);

            checkState();

            if (!elements.contains(o)) {
                elements.add(o);
                return true;
            }
            return false;
        }

        // returns an instance of SecureIterator
        @Override
        public Iterator<SST> iterator() {

            if (permission == _PRIVATE_CREDENTIALS) {
                /*
                 * private credential set requires iterator with additional
                 * security check (PrivateCredentialPermission)
                 */
                return new SecureIterator(elements.iterator()) {
                    /*
                     * checks permission to access next private credential moves
                     * to the next element even SecurityException was thrown
                     */
                    @Override
                    public SST next() {
                        SST obj = iterator.next();
                        return obj;
                    }
                };
            }
            return new SecureIterator(elements.iterator());
        }

        @Override
        public boolean retainAll(Collection<?> c) {

            if (c == null) {
                throw new NullPointerException();
            }
            return super.retainAll(c);
        }

        @Override
        public int size() {
            return elements.size();
        }

        /**
         * return set with elements that are instances or subclasses of the
         * specified class
         */
        protected final <E> Set<E> get(final Class<E> c) {

            if (c == null) {
                throw new NullPointerException();
            }

            AbstractSet<E> s = new AbstractSet<E>() {
                private LinkedList<E> elements = new LinkedList<E>();

                @Override
                public boolean add(E o) {
                    if (!c.isAssignableFrom(o.getClass())) {
                        throw new IllegalArgumentException(""Invalid type: "" + o.getClass());
                    }

                    if (elements.contains(o)) {
                        return false;
                    }
                    elements.add(o);
                    return true;
                }

                @Override
                public Iterator<E> iterator() {
                    return elements.iterator();
                }

                @Override
                public boolean retainAll(Collection<?> c) {

                    if (c == null) {
                        throw new NullPointerException();
                    }
                    return super.retainAll(c);
                }

                @Override
                public int size() {
                    return elements.size();
                }
            };

            // FIXME must have permissions for requested priv. credentials
            for (SST o : this) {
                if (c.isAssignableFrom(o.getClass())) {
                    s.add(c.cast(o));
                }
            }
            return s;
        }

        private void readObject(ObjectInputStream in) throws IOException,
                ClassNotFoundException {
            in.defaultReadObject();

            switch (setType) {
            case SET_Principal:
                permission = _PRINCIPALS;
                break;
            case SET_PrivCred:
                permission = _PRIVATE_CREDENTIALS;
                break;
            case SET_PubCred:
                permission = _PUBLIC_CREDENTIALS;
                break;
            default:
                throw new IllegalArgumentException();
            }

            for (SST element : elements) {
                verifyElement(element);
            }
        }

        @SuppressWarnings(""UnusedDeclaration"")
        private void writeObject(ObjectOutputStream out) throws IOException {

            if (permission == _PRIVATE_CREDENTIALS) {
                setType = SET_PrivCred;
            } else if (permission == _PRINCIPALS) {
                setType = SET_Principal;
            } else {
                setType = SET_PubCred;
            }

            out.defaultWriteObject();
        }

        /**
         * Represents iterator for subject's secure set
         */
        private class SecureIterator implements Iterator<SST> {
            protected Iterator<SST> iterator;

            protected SecureIterator(Iterator<SST> iterator) {
                this.iterator = iterator;
            }

            public boolean hasNext() {
                return iterator.hasNext();
            }

            public SST next() {
                return iterator.next();
            }

            /**
             * checks set state, and security permission to modify set before
             * removing current element
             */
            public void remove() {
                checkState();
                iterator.remove();
            }
        }
    }
}
",False,"```java
/*
 *  Licensed to the Apache Software Foundation (ASF) under one or more
 *  contributor license agreements.  See the NOTICE file distributed with
 *  this work for additional information regarding copyright ownership.
 *  The ASF licenses this file to You under the Apache License, Version 2.0
 *  (the ""License""); you may not use this file except in compliance with
 *  the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an ""AS IS"" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */
package javax.security.auth;

import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.Serializable;
import java.security.AccessControlContext;
import java.security.AccessController;
import java.security.DomainCombiner;
import java.security.Permission;
import java.security.Principal;
import java.security.PrivilegedAction;
import java.security.PrivilegedExceptionAction;
import java.security.ProtectionDomain;
import java.util.AbstractSet;
import java.util.Collection;
import java.util.Iterator;
import java.util.LinkedList;
import java.util.Set;

/**
 * The central class of the {@code javax.security.auth} package representing an
 * authenticated user or entity (both referred to as ""subject""). IT defines also
 * the static methods that allow code to be run, and do modifications according
 * to the subject's permissions.
 * <p>
 * A subject has the following features:
 * <ul>
 * <li>A set of {@code Principal} objects specifying the identities bound to a
 * {@code Subject} that distinguish it.</li>
 * <li>Credentials (public and private) such as certificates, keys, or
 * authentication proofs such as tickets</li>
 * </ul>
 */
public final class Subject implements Serializable {

    private static final long serialVersionUID = -8308522755600156056L;

    private static final AuthPermission _AS = new AuthPermission(""doAs"");

    private static final AuthPermission _AS_PRIVILEGED = new AuthPermission(
            ""doAsPrivileged"");

    private static final AuthPermission _SUBJECT = new AuthPermission(
            ""getSubject"");

    private static final AuthPermission _PRINCIPALS = new AuthPermission(
            ""modifyPrincipals"");

    private static final AuthPermission _PRIVATE_CREDENTIALS = new AuthPermission(
            ""modifyPrivateCredentials"");

    private static final AuthPermission _PUBLIC_CREDENTIALS = new AuthPermission(
            ""modifyPublicCredentials"");

    private static final AuthPermission _READ_ONLY = new AuthPermission(
            ""setReadOnly"");

    private final Set<Principal> principals;

    private boolean readOnly;

    // set of private credentials
    private transient SecureSet<Object> privateCredentials;

    // set of public credentials
    private transient SecureSet<Object> publicCredentials;

    /**
     * The default constructor initializing the sets of public and private
     * credentials and principals with the empty set.
     */
    public Subject() {
        principals = new SecureSet<Principal>(_PRINCIPALS);
        publicCredentials = new SecureSet<Object>(_PUBLIC_CREDENTIALS);
        privateCredentials = new SecureSet<Object>(_PRIVATE_CREDENTIALS);

        readOnly = false;
    }

    /**
     * The constructor for the subject, setting its public and private
     * credentials and principals according to the arguments.
     *
     * @param readOnly
     *            {@code true} if this {@code Subject} is read-only, thus
     *            preventing any modifications to be done.
     * @param subjPrincipals
     *            the set of Principals that are attributed to this {@code
     *            Subject}.
     * @param pubCredentials
     *            the set of public credentials that distinguish this {@code
     *            Subject}.
     * @param privCredentials
     *            the set of private credentials that distinguish this {@code
     *            Subject}.
     */
    public Subject(boolean readOnly, Set<? extends Principal> subjPrincipals,
            Set<?> pubCredentials, Set<?> privCredentials) {

        if (subjPrincipals == null || pubCredentials == null || privCredentials == null) {
            throw new NullPointerException();
        }

        principals = new SecureSet<Principal>(_PRINCIPALS, subjPrincipals);
        publicCredentials = new SecureSet<Object>(_PUBLIC_CREDENTIALS, pubCredentials);
        privateCredentials = new SecureSet<Object>(_PRIVATE_CREDENTIALS, privCredentials);

        this.readOnly = readOnly;
    }

    /**
     * Runs the code defined by {@code action} using the permissions granted to
     * the {@code Subject} itself and to the code as well.
     *
     * @param subject
     *            the distinguished {@code Subject}.
     * @param action
     *            the code to be run.
     * @return the {@code Object} returned when running the {@code action}.
     */
    @SuppressWarnings(""unchecked"")
    public static <T> T doAs(Subject subject, PrivilegedAction<T> action) {
        return doAs_PrivilegedAction(subject, action, AccessController.getContext());
    }

    /**
     * Runs the code defined by {@code action} using the permissions granted to
     * the subject and to the code itself, additionally providing a more
     * specific context.
     *
     * @param subject
     *            the distinguished {@code Subject}.
     * @param action
     *            the code to be run.
     * @param context
     *            the specific context in which the {@code action} is invoked.
     *            if {@code null} a new {@link AccessControlContext} is
     *            instantiated.
     * @return the {@code Object} returned when running the {@code action}.
     * @throws PrivilegedActionException
     *             if running the {@code action} throws an exception.
     */
    @SuppressWarnings(""unchecked"")
    public static <T> T doAsPrivileged(Subject subject,
            PrivilegedAction<T> action, AccessControlContext context)
            throws PrivilegedActionException {
        if (context == null) {
            return doAs_PrivilegedAction(subject, action,
                    new AccessControlContext(new ProtectionDomain[0]));
        }
        return doAs_PrivilegedAction(subject, action, context);
    }

    // instantiates a new context and passes it to AccessController
    @SuppressWarnings(""unchecked"")
    private static <T> T doAs_PrivilegedAction(Subject subject,
            PrivilegedAction<T> action, final AccessControlContext context)
            throws PrivilegedActionException {

        AccessControlContext newContext;

        final SubjectDomainCombiner combiner;
        if (subject == null) {
            // performance optimization
            // if subject is null there is nothing to combine
            combiner = null;
        } else {
            combiner = new SubjectDomainCombiner(subject);
        }

        PrivilegedAction<AccessControlContext> dccAction = new PrivilegedAction<AccessControlContext>() {
            public AccessControlContext run() {
                return new AccessControlContext(context, combiner);
            }
        };

        newContext = AccessController.doPrivileged(dccAction);

        return AccessController.doPrivileged(action, newContext);
    }

    /**
     * Runs the code defined by {@code action} using the permissions granted to
     * the subject and to the code itself.
     *
     * @param subject
     *            the distinguished {@code Subject}.
     * @param action
     *            the code to be run.
     * @return the {@code Object} returned when running the {@code action}.
     * @throws PrivilegedActionException
     *             if"
73,74,NomosTestfiles/Apache/tsproxy.readme,Apache,"Name: tsproxy
Short Name: tsproxy
URL: https://github.com/WPO-Foundation/tsproxy
Version: a2f578febcd79b751d948f615bbde8f6189fbeed (commit hash)
License: Apache
License File: NOT_SHIPPED
Security Critical: no

Local modification: no

Description:
tsproxy provides basic latency, download and upload traffic shaping while only
requiring user-level access (no root permissions required)
",False,"```
License: Apache
License File: NOT_SHIPPED
```"
74,75,NomosTestfiles/Apache/x.txt,Apache-2.0,"This package was debianized by Torsten Werner on
Sat, 24 Nov 2007 00:01:40 +0100.

It was downloaded from http://json-lib.sourceforge.net

Upstream Author: Andres Almiray

Copyright: Â© 2006-2008 Json-lib

License: Apache 2.0

On Debian GNU/Linux system you can find the complete text of the
Apache-2.0 license in `/usr/share/common-licenses/Apache-2.0'

The Debian packaging is (C) 2007, Torsten Werner
",False,"```
Copyright: Â© 2006-2008 Json-lib
License: Apache 2.0
```"
75,76,NomosTestfiles/APL/APL-1.0.txt,APL-1.0,"ADAPTIVE PUBLIC LICENSE 
Version 1.0 

THE LICENSED WORK IS PROVIDED UNDER THE TERMS OF THIS ADAPTIVE PUBLIC LICENSE (""LICENSE""). ANY USE, REPRODUCTION OR DISTRIBUTION OF THE LICENSED WORK CONSTITUTES RECIPIENT'S ACCEPTANCE OF THIS LICENSE AND ITS TERMS, WHETHER OR NOT SUCH RECIPIENT READS THE TERMS OF THIS LICENSE. ""LICENSED WORK"" AND ""RECIPIENT"" ARE DEFINED BELOW.

 IMPORTANT NOTE: This License is ""adaptive"", and the generic version or another version of an Adaptive Public License should not be relied upon to determine your rights and obligations under this License. You must read the specific Adaptive Public License that you receive with the Licensed Work, as certain terms are defined at the outset by the Initial Contributor. 

See Section 2.2 below, Exhibit A attached, and any Suppfile.txt accompanying this License to determine the specific adaptive features applicable to this License. For example, without limiting the foregoing, (a) for selected choice of law and jurisdiction see Part 3 of Exhibit A; (b) for the selected definition of Third Party see Part 4 of Exhibit A; and (c) for selected patent licensing terms (if any) see Section 2.2 below and Part 6 of Exhibit A.

1. DEFINITIONS.

1.1. ""CONTRIBUTION"" means:

(a) In the case of the Initial Contributor, the Initial Work distributed under this License by the Initial Contributor; and

(b) In the case of each Subsequent Contributor, the Subsequent Work originating from and distributed by such Subsequent Contributor. 

1.2. ""DESIGNATED WEB SITE"" means the web site having the URL identified in Part 1 of Exhibit A, which URL may be changed by the Initial Contributor by posting on the current Designated Web Site the new URL for at least sixty (60) days. 

1.3. ""DISTRIBUTOR"" means any Person that distributes the Licensed Work or any portion thereof to at least one Third Party. 

1.4. ""ELECTRONIC DISTRIBUTION MECHANISM"" means any mechanism generally accepted in the software development community for the electronic transfer of data. 

1.5. ""EXECUTABLE"" means the Licensed Work in any form other than Source Code. 

1.6. ""GOVERNING JURISDICTION"" means the state, province or other legal jurisdiction identified in Part 3 of Exhibit A. 

1.7. ""INDEPENDENT MODULE"" means a separate module of software and/or data that is not a derivative work of or copied from the Licensed Work or any portion thereof. In addition, a module does not qualify as an Independent Module but instead forms part of the Licensed Work if the module: (a) is embedded in the Licensed Work; (b) is included by reference in the Licensed Work other than by a function call or a class reference; or (c) must be included or contained, in whole or in part, within a file directory or subdirectory actually containing files making up the Licensed Work.

 1.8. ""INITIAL CONTRIBUTOR"" means the Person or entity identified as the Initial Contributor in the notice required by Part 1 of Exhibit A.

 1.9. ""INITIAL WORK"" means the initial Source Code, object code (if any) and documentation for the computer program identified in Part 2 of Exhibit A, as such Source Code, object code and documentation is distributed under this License by the Initial Contributor. 

1.10. ""LARGER WORK"" means a work that combines the Licensed Work or portions thereof with code not governed by this License. 

1.11. ""LICENSED WORK"" means the Initial Work and/or any Subsequent Work, in each case including portions thereof. 

1.12. ""LICENSE NOTICE"" has the meaning assigned in Part 5 of Exhibit A.

 1.13. ""MODIFICATION"" or ""MODIFICATIONS"" means any change to and/or addition to the Licensed Work. 

1.14. ""PERSON"" means an individual or other legal entity, including a corporation, partnership or other body. 

1.15. ""RECIPIENT"" means any Person who receives or obtains the Licensed Work under this License (by way of example, without limiting the foregoing, any Subsequent Contributor or Distributor). 

1.16. ""SOURCE CODE"" means the source code for a computer program, including the source code for all modules and components of the computer program, plus any associated interface definition files, and scripts used to control compilation and installation of an executable. 

1.17. ""SUBSEQUENT CONTRIBUTOR"" means any Person that makes or contributes to the making of any Subsequent Work and that distributes that Subsequent Work to at least one Third Party. 

1.18. ""SUBSEQUENT WORK"" means a work that has resulted or arises from changes to and/or additions to:

(a) the Initial Work;

(b) any other Subsequent Work; or

(c) to any combination of the Initial Work and any such other Subsequent Work;

where such changes and/or additions originate from a Subsequent Contributor. A Subsequent Work will ""originate"" from a Subsequent Contributor if the Subsequent Work was a result of efforts by such Subsequent Contributor (or anyone acting on such Subsequent Contributor's behalf, such as, a contractor or other entity that is engaged by or under the direction of the Subsequent Contributor). For greater certainty, a Subsequent Work expressly excludes and shall not capture within its meaning any Independent Module. 

1.19. ""SUPPLEMENT FILE"" means a file distributed with the Licensed Work having a file name ""suppfile.txt"". 

1.20. ""THIRD PARTY"" has the meaning assigned in Part 4 of Exhibit A. 

2. LICENSE.

 2.1. COPYRIGHT LICENSE FROM INITIAL AND SUBSEQUENT CONTRIBUTORS.

  (a) Subject to the terms of this License, the Initial Contributor hereby grants each Recipient a world-wide, royalty-free, non-exclusive copyright license to:

	(i) reproduce, prepare derivative works of, publicly display, publicly perform, distribute and sublicense the Initial Work; and

	(ii) reproduce, publicly display, publicly perform, distribute, and sublicense any derivative works (if any) prepared by Recipient;

in Source Code and Executable form, either with other Modifications, on an unmodified basis, or as part of a Larger Work.

  (b) Subject to the terms of this License, each Subsequent Contributor hereby grants each Recipient a world-wide, royalty-free, non-exclusive copyright license to:

	(i) reproduce, prepare derivative works of, publicly display, publicly perform, distribute and sublicense the Subsequent Work of such Subsequent Contributor; and

	(ii) reproduce, publicly display, publicly perform, distribute, and sublicense any derivative works (if any) prepared by Recipient;

in Source Code and Executable form, either with other Modifications, on an unmodified basis, or as part of a Larger Work.

 2.2. PATENT LICENSE FROM INITIAL AND SUBSEQUENT CONTRIBUTORS.

  (a) This License does not include or grant any patent license whatsoever from the Initial Contributor, Subsequent Contributor, or any Distributor unless, at the time the Initial Work is first distributed or made available under this License (as the case may be), the Initial Contributor has selected pursuant to Part 6 of Exhibit A the patent terms in paragraphs A, B, C, D and E from Part 6 of Exhibit A. If this is not done then the Initial Work and any other Subsequent Work is made available under the License without any patent license (the ""PATENTS-EXCLUDED LICENSE"").

  (b) However, the Initial Contributor may subsequently distribute or make available (as the case may be) future copies of: (1) the Initial Work; or (2) any Licensed Work distributed by the Initial Contributor which includes the Initial Work (or any portion thereof) and/or any Modification made by the Initial Contributor; available under a License which includes a patent license (the ""PATENTS-INCLUDED LICENSE"") by selecting pursuant to Part 6 of Exhibit A the patent terms in paragraphs A, B, C, D and E from Part 6 of Exhibit A, when the Initial Contributor distributes or makes available (as the case may be) such future copies under this License.

  (c) If any Recipient receives or obtains one or more copies of the Initial Work or any other portion of the Licensed Work under the Patents-Included License, then all licensing of such copies under this License shall include the terms in paragraphs A, B, C, D and E from Part 6 of Exhibit A and that Recipient shall not be able to rely upon the Patents-Excluded License for any such copies. However, all Recipients that receive one or more copies of the Initial Work or any other portion of the Licensed Work under a copy of the License which includes the Patents-Excluded License shall have no patent license with respect to such copies received under the Patents-Excluded License and availability and distribution of such copies, including Modifications made by such Recipient to such copies, shall be under a copy of the License without any patent license.

  (d) Where a Recipient uses in combination or combines any copy of the Licensed Work (or portion thereof) licensed under a copy of the License having a Patents-Excluded License with any copy of the Licensed Work (or portion thereof) licensed under a copy of the License having a Patents-Included License, the combination (and any portion thereof) shall, from the first time such Recipient uses, makes available or distributes the combination (as the case may be), be subject to only the terms of the License having the Patents-Included License which shall include the terms in paragraphs A, B, C, D and E from Part 6 of Exhibit A. 

2.3. ACKNOWLEDGEMENT AND DISCLAIMER.

Recipient understands and agrees that although Initial Contributor and each Subsequent Contributor grants the licenses to its Contributions set forth herein, no representation, warranty, guarantee or assurance is provided by any Initial Contributor, Subsequent Contributor, or Distributor that the Licensed Work does not infringe the patent or other intellectual property rights of any other entity. Initial Contributor, Subsequent Contributor, and each Distributor disclaims any liability to Recipient for claims brought by any other entity based on infringement of intellectual property rights or otherwise, in relation to the Licensed Works. As a condition to exercising the rights and licenses granted hereunder, each Recipient hereby assumes sole responsibility to secure any other intellectual property rights needed, if any. For example, without limiting the foregoing disclaimers, if a third party patent license is required to allow Recipient to distribute the Licensed Work, it is Recipient's responsibility to acquire that license before distributing the Licensed Work. 

2.4. RESERVATION.

Nothing in this License shall be deemed to grant any rights to trademarks, copyrights, patents, trade secrets or any other intellectual property of Initial Contributor, Subsequent Contributor, or Distributor except as expressly stated herein. 

3. DISTRIBUTION OBLIGATIONS.

 3.1. DISTRIBUTION GENERALLY.

  (a) A Subsequent Contributor shall make that Subsequent Contributor's Subsequent Work(s) available to the public via an Electronic Distribution Mechanism for a period of at least twelve (12) months. The aforesaid twelve (12) month period shall begin within a reasonable time after the creation of the Subsequent Work and no later than sixty (60) days after first distribution of that Subsequent Contributor's Subsequent Work.

 (b) All Distributors must distribute the Licensed Work in accordance with the terms of the License, and must include a copy of this License (including without limitation Exhibit A and the accompanying Supplement File) with each copy of the Licensed Work distributed. In particular, this License must be prominently distributed with the Licensed Work in a file called ""license.txt."" In addition, the License Notice in Part 5 of Exhibit A must be included at the beginning of all Source Code files, and viewable to a user in any executable such that the License Notice is reasonably brought to the attention of any party using the Licensed Work.

3.2. EXECUTABLE DISTRIBUTIONS OF THE LICENSED WORK.

A Distributor may choose to distribute the Licensed Work, or any portion thereof, in Executable form (an ""EXECUTABLE DISTRIBUTION"") to any third party, under the terms of Section 2 of this License, provided the Executable Distribution is made available under and accompanied by a copy of this License, AND provided at least ONE of the following conditions is fulfilled:

  (a) The Executable Distribution must be accompanied by the Source Code for the Licensed Work making up the Executable Distribution, and the Source Code must be distributed on the same media as the Executable Distribution or using an Electronic Distribution Mechanism; or

  (b) The Executable Distribution must be accompanied with a written offer, valid for at least thirty six (36) months, to give any third party under the terms of this License, for a charge no more than the cost of physically performing source distribution, a complete machine-readable copy of the Source Code for the Licensed Work making up the Executable Distribution, to be available and distributed using an Electronic Distribution Mechanism, and such Executable Distribution must remain available in Source Code form to any third party via the Electronic Distribution Mechanism (or any replacement Electronic Distribution Mechanism the particular Distributor may reasonably need to turn to as a substitute) for said at least thirty six (36) months.

 For greater certainty, the above-noted requirements apply to any Licensed Work or portion thereof distributed to any third party in Executable form, whether such distribution is made alone, in combination with a Larger Work or Independent Modules, or in some other combination. 

3.3. SOURCE CODE DISTRIBUTIONS.

When a Distributor makes the Licensed Work, or any portion thereof, available to any Person in Source Code form, it must be made available under this License and a copy of this License must be included with each copy of the Source Code, situated so that the copy of the License is conspicuously brought to the attention of that Person. For greater clarification, this Section 3.3 applies to all distribution of the Licensed Work in any Source Code form. A Distributor may charge a fee for the physical act of transferring a copy, which charge shall be no more than the cost of physically performing source distribution. 

3.4. REQUIRED NOTICES IN SOURCE CODE.

Each Subsequent Contributor must ensure that the notice set out in Part 5 of Exhibit A is included in each file of the Source Code for each Subsequent Work originating from that particular Subsequent Contributor, if such notice is not already included in each such file. If it is not possible to put such notice in a particular Source Code file due to its structure, then the Subsequent Contributor must include such notice in a location (such as a relevant directory in which the file is stored) where a user would be likely to look for such a notice.

3.5. NO DISTRIBUTION REQUIREMENTS FOR INTERNALLY USED MODIFICATIONS.

Notwithstanding Sections 3.2, 3.3 and 3.4, Recipient may, internally within its own corporation or organization use the Licensed Work, including the Initial Work and Subsequent Works, and make Modifications for internal use within Recipient's own corporation or organization (collectively, ""INTERNAL USE MODIFICATIONS""). The Recipient shall have no obligation to distribute, in either Source Code or Executable form, any such Internal Use Modifications made by Recipient in the course of such internal use, except where required below in this Section 3.5. All Internal Use Modifications distributed to any Person, whether or not a Third Party, shall be distributed pursuant to and be accompanied by the terms of this License. If the Recipient chooses to distribute any such Internal Use Modifications to any Third Party, then the Recipient shall be deemed a Subsequent Contributor, and any such Internal Use Modifications distributed to any Third Party shall be deemed a Subsequent Work originating from that Subsequent Contributor, and shall from the first such instance become part of the Licensed Work that must thereafter be distributed and made available to third parties in accordance with the terms of Sections 3.1 to 3.4 inclusive.

3.6. INDEPENDENT MODULES.

This License shall not apply to Independent Modules of any Initial Contributor, Subsequent Contributor, Distributor or any Recipient, and such Independent Modules may be licensed or made available under one or more separate license agreements.

3.7. LARGER WORKS.

Any Distributor or Recipient may create or contribute to a Larger Work by combining any of the Licensed Work with other code not governed by the terms of this License, and may distribute the Larger Work as one or more products. However, in any such case, Distributor or Recipient (as the case may be) must make sure that the requirements of this License are fulfilled for the Licensed Work portion of the Larger Work. 

3.8. DESCRIPTION OF DISTRIBUTED MODIFICATIONS.

  (a) Each Subsequent Contributor (including the Initial Contributor where the Initial Contributor also qualifies as a Subsequent Contributor) must cause each Subsequent Work created or contributed to by that Subsequent Contributor to contain a file documenting the changes, in accordance with the requirements of Part 1 of the Supplement File, that such Subsequent Contributor made in the creation or contribution to that Subsequent Work. If no Supplement File exists or no requirements are set out in Part 1 of the Supplement File, then there are no requirements for Subsequent Contributors to document changes that they make resulting in Subsequent Works.

  (b) The Initial Contributor may at any time introduce requirements or add to or change earlier requirements (in each case, the ""EARLIER DESCRIPTION REQUIREMENTS"") for documenting changes resulting in Subsequent Works by revising Part 1 of each copy of the Supplement File distributed by the Initial Contributor with future copies of the Licensed Work so that Part 1 then contains new requirements (the ""NEW DESCRIPTION REQUIREMENTS"") for documenting such changes.

  (c) Any Recipient receiving at any time any copy of an Initial Work or any Subsequent Work under a copy of this License (in each case, an ""Earlier LICENSED COPY"") having the Earlier Description Requirements may choose, with respect to each such Earlier Licensed Copy, to comply with the Earlier Description Requirements or the New Description Requirements. Where a Recipient chooses to comply with the New Description Requirements, that Recipient will, when thereafter distributing any copies of any such Earlier Licensed Copy, include a Supplement File having a section entitled Part 1 that contains a copy of the New Description Requirements.

  (d) For greater certainty, the intent of Part 1 of the Supplement File is to provide a mechanism (if any) by which Subsequent Contributors must document changes that they make to the Licensed Work resulting in Subsequent Works. Part 1 of any Supplement File shall not be used to increase or reduce the scope of the license granted in Article 2 of this License or in any other way increase or decrease the rights and obligations of any Recipient, and shall at no time serve as the basis for terminating the License. Further, a Recipient can be required to correct and change its documentation procedures to comply with Part 1 of the Supplement File, but cannot be penalised with damages. Part 1 of any Supplement File is only binding on each Recipient of any Licensed Work to the extent Part 1 sets out the requirements for documenting changes to the Initial Work or any Subsequent Work.

  (e) An example of a set of requirements for documenting changes and contributions made by Subsequent Contributor is set out in Part 7 of Exhibit A of this License. Part 7 is a sample only and is not binding on Recipients, unless (subject to the earlier paragraphs of this Section 3.8) those are the requirements that the Initial Contributor includes in Part 1 of the Supplement File with the copies of the Initial Work distributed under this License. 

3.9. USE OF DISTRIBUTOR NAME.

The name of a Distributor may not be used by any other Distributor to endorse or promote the Licensed Work or products derived from the Licensed Work, without prior written permission.

 3.10. LIMITED RECOGNITION OF INITIAL CONTRIBUTOR.

  (a) As a modest attribution to the Initial Contributor, in the hope that its promotional value may help justify the time, money and effort invested in writing the Initial Work, the Initial Contributor may include in Part 2 of the Supplement File a requirement that each time an executable program resulting from the Initial Work or any Subsequent Work, or a program dependent thereon, is launched or run, a prominent display of the Initial Contributor's attribution information must occur (the ""ATTRIBUTION INFORMATION""). The Attribution Information must be included at the beginning of each Source Code file. For greater certainty, the Initial Contributor may specify in the Supplement File that the above attribution requirement only applies to an executable program resulting from the Initial Work or any Subsequent Work, but not a program dependent thereon. The intent is to provide for reasonably modest attribution, therefore the Initial Contributor may not require Recipients to display, at any time, more than the following Attribution Information: (a) a copyright notice including the name of the Initial Contributor; (b) a word or one phrase (not exceeding 10 words); (c) one digital image or graphic provided with the Initial Work; and (d) a URL (collectively, the ""ATTRIBUTION LIMITS"").

  (b) If no Supplement File exists, or no Attribution Information is set out in Part 2 of the Supplement File, then there are no requirements for Recipients to display any Attribution Information of the Initial Contributor.

  (c) Each Recipient acknowledges that all trademarks, service marks and/or trade names contained within Part 2 of the Supplement File distributed with the Licensed Work are the exclusive property of the Initial Contributor and may only be used with the permission of the Initial Contributor, or under circumstances otherwise permitted by law, or as expressly set out in this License. 

3.11. For greater certainty, any description or attribution provisions contained within a Supplement File may only be used to specify the nature of the description or attribution requirements, as the case may be. Any provision in a Supplement File that otherwise purports to modify, vary, nullify or amend any right, obligation or representation contained herein shall be deemed void to that extent, and shall be of no force or effect. 

4. COMMERCIAL USE AND INDEMNITY. 

4.1. COMMERCIAL SERVICES.

A Recipient (""COMMERCIAL RECIPIENT"") may choose to offer, and to charge a fee for, warranty, support, indemnity or liability obligations (collectively, ""SERVICES"") to one or more other Recipients or Distributors. However, such Commercial Recipient may do so only on that Commercial Recipient's own behalf, and not on behalf of any other Distributor or Recipient, and Commercial Recipient must make it clear than any such warranty, support, indemnity or liability obligation(s) is/are offered by Commercial Recipient alone. At no time may Commercial Recipient use any Services to deny any party the Licensed Work in Source Code or Executable form when so required under any of the other terms of this License. For greater certainty, this Section 4.1 does not diminish any of the other terms of this License, including without limitation the obligation of the Commercial Recipient as a Distributor, when distributing any of the Licensed Work in Source Code or Executable form, to make such distribution royalty-free (subject to the right to charge a fee of no more than the cost of physically performing Source Code or Executable distribution (as the case may be)). 

4.2. INDEMNITY.

Commercial distributors of software may accept certain responsibilities with respect to end users, business partners and the like. While this License is intended to facilitate the commercial use of the Licensed Work, the Distributor who includes any of the Licensed Work in a commercial product offering should do so in a manner which does not create potential liability for other Distributors. Therefore, if a Distributor includes the Licensed Work in a commercial product offering or offers any Services, such Distributor (""COMMERCIAL DISTRIBUTOR"") hereby agrees to defend and indemnify every other Distributor or Subsequent Contributor (in each case an ""INDEMNIFIED PARTY"") against any losses, damages and costs (collectively ""LOSSES"") arising from claims, lawsuits and other legal actions brought by a third party against the Indemnified Party to the extent caused by the acts or omissions of such Commercial Distributor in connection with its distribution of any of the Licensed Work in a commercial product offering or in connection with any Services. The obligations in this section do not apply to any claims or Losses relating to any actual or alleged intellectual property infringement. In order to qualify, an Indemnified Party must: (a) promptly notify the Commercial Distributor in writing of such claim; and (b) allow the Commercial Distributor to control, and co-operate with the Commercial Distributor in, the defense and any related settlement negotiations. The Indemnified Party may participate in any such claim at its own expense.

5. VERSIONS OF THE LICENSE. 

5.1. NEW VERSIONS.

The Initial Contributor may publish revised and/or new versions of the License from time to time. Each version will be given a distinguishing version number. 

5.2. EFFECT OF NEW VERSIONS. 

Once the Licensed Work or any portion thereof has been published by Initial Contributor under a particular version of the License, Recipient may choose to continue to use it under the terms of that version. However, if a Recipient chooses to use the Licensed Work under the terms of any subsequent version of the License published by the Initial Contributor, then from the date of making this choice, the Recipient must comply with the terms of that subsequent version with respect to all further reproduction, preparation of derivative works, public display of, public performance of, distribution and sublicensing by the Recipient in connection with the Licensed Work. No one other than the Initial Contributor has the right to modify the terms applicable to the Licensed Work 

6. DISCLAIMER OF WARRANTY. 

6.1. GENERAL DISCLAIMER.

 EXCEPT AS EXPRESSLY SET FORTH IN THIS LICENSE, THE LICENSED WORK IS PROVIDED UNDER THIS LICENSE ON AN ""AS IS"" BASIS, WITHOUT ANY REPRESENTATION, WARRANTY, GUARANTEE, ASSURANCE OR CONDITION OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, WITHOUT LIMITATION, WARRANTIES OR CONDITIONS OF TITLE, NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE LICENSED WORK IS WITH RECIPIENT. SHOULD ANY LICENSED WORK PROVE DEFECTIVE IN ANY RESPECT, RECIPIENT (NOT THE INITIAL CONTRIBUTOR OR ANY SUBSEQUENT CONTRIBUTOR) ASSUMES THE COST OF ANY NECESSARY SERVICING, REPAIR OR CORRECTION. THIS CLAUSE CONSTITUTES AN ESSENTIAL PART OF THIS LICENSE. NO USE OF ANY LICENSED WORK IS AUTHORIZED HEREUNDER EXCEPT UNDER THIS LICENSE INCLUDING WITHOUT LIMITATION THIS DISCLAIMER. 

6.2. RESPONSIBILITY OF RECIPIENTS.

Each Recipient is solely responsible for determining the appropriateness of using and distributing the Licensed Work and assumes all risks associated with its exercise of rights under this License, including but not limited to the risks and costs of program errors, compliance with applicable laws, damage to or loss of data, programs or equipment, and unavailability or interruption of operations. 

7. TERMINATION.

7.1. This License shall continue until terminated in accordance with the express terms herein. 

7.2. Recipient may choose to terminate this License automatically at any time. 

7.3. This License, including without limitation the rights granted hereunder to a particular Recipient, will terminate automatically if such Recipient is in material breach of any of the terms of this License and fails to cure such breach within sixty (60) days of becoming aware of the breach. Without limiting the foregoing, any material breach by such Recipient of any term of any other License under which such Recipient is granted any rights to the Licensed Work shall constitute a material breach of this License. 

7.4. Upon termination of this License by or with respect to a particular Recipient for any reason, all rights granted hereunder and under any other License to that Recipient shall terminate. However, all sublicenses to the Licensed Work which were previously properly granted by such Recipient under a copy of this License (in each case, an ""Other License"" and in plural, ""Other Licenses"") shall survive any such termination of this License, including without limitation the rights and obligations under such Other Licenses as set out in their respective Sections 2, 3, 4, 5, 6, 7 and 8, mutatis mutandis, for so long as the respective sublicensees (i.e. other Recipients) remain in compliance with the terms of the copy of this License under which such sublicensees received rights to the Licensed Work. Any termination of such Other Licenses shall be pursuant to their respective Section 7, mutatis mutandis. Provisions which, by their nature, must remain in effect beyond the termination of this License shall survive. 

7.5. Upon any termination of this License by or with respect to a particular Recipient, Sections 4.1, 4.2, 6.1, 6.2, 7.4, 7.5, 8.1, and 8.2, together with all provisions of this License necessary for the interpretation and enforcement of same, shall expressly survive such termination. 

8. LIMITATION OF LIABILITY.

 8.1. IN NO EVENT SHALL ANY OF INITIAL CONTRIBUTOR, ITS SUBSIDIARIES, OR AFFILIATES, OR ANY OF ITS OR THEIR RESPECTIVE OFFICERS, DIRECTORS, EMPLOYEES, AND/OR AGENTS (AS THE CASE MAY BE), HAVE ANY LIABILITY FOR ANY DIRECT DAMAGES, INDIRECT DAMAGES, PUNITIVE DAMAGES, INCIDENTAL DAMAGES, SPECIAL DAMAGES, EXEMPLARY DAMAGES, CONSEQUENTIAL DAMAGES OR ANY OTHER DAMAGES WHATSOEVER (INCLUDING WITHOUT LIMITATION LOSS OF USE, DATA OR PROFITS, OR ANY OTHER LOSS ARISING OUT OF OR IN ANY WAY RELATED TO THE USE, INABILITY TO USE, UNAUTHORIZED USE, PERFORMANCE, OR NON-PERFORMANCE OF THE LICENSED WORK OR ANY PART THEREOF OR THE PROVISION OF OR FAILURE TO PROVIDE SUPPORT SERVICES, OR THAT RESULT FROM ERRORS, DEFECTS, OMISSIONS, DELAYS IN OPERATION OR TRANSMISSION, OR ANY OTHER FAILURE OF PERFORMANCE), HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) IN RELATION TO OR ARISING IN ANY WAY OUT OF THIS LICENSE OR THE USE OR DISTRIBUTION OF THE LICENSED WORK OR THE EXERCISE OF ANY RIGHTS GRANTED HEREUNDER, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. THIS LIMITATION OF LIABILITY SHALL NOT APPLY TO LIABILITY FOR DEATH OR PERSONAL INJURY RESULTING FROM SUCH PARTY'S NEGLIGENCE TO THE EXTENT APPLICABLE LAW PROHIBITS SUCH LIMITATION. THIS CLAUSE CONSTITUTES AN ESSENTIAL PART OF THIS LICENSE. NO USE OF ANY LICENSED WORK IS AUTHORIZED HEREUNDER EXCEPT UNDER THIS LICENSE INCLUDING WITHOUT LIMITATION THE LIMITATIONS SET FORTH IN THIS SECTION 8.1.

 8.2. EXCEPT AS EXPRESSLY SET FORTH IN THIS LICENSE, EACH RECIPIENT SHALL NOT HAVE ANY LIABILITY FOR ANY EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING WITHOUT LIMITATION LOST PROFITS), HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OR DISTRIBUTION OF THE LICENSED WORK OR THE EXERCISE OF ANY RIGHTS GRANTED HEREUNDER, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. THIS LIMITATION OF LIABILITY SHALL NOT APPLY TO LIABILITY FOR DEATH OR PERSONAL INJURY RESULTING FROM SUCH PARTY'S NEGLIGENCE TO THE EXTENT APPLICABLE LAW PROHIBITS SUCH LIMITATION.

 9. GOVERNING LAW AND LEGAL ACTION. 

9.1. This License shall be governed by and construed in accordance with the laws of the Governing Jurisdiction assigned in Part 3 of Exhibit A, without regard to its conflict of law provisions. No party may bring a legal action under this License more than one year after the cause of the action arose. Each party waives its rights (if any) to a jury trial in any litigation arising under this License. Note that if the Governing Jurisdiction is not assigned in Part 3 of Exhibit A, then the Governing Jurisdiction shall be the State of New York. 

9.2. The courts of the Governing Jurisdiction shall have jurisdiction, but not exclusive jurisdiction, to entertain and determine all disputes and claims, whether for specific performance, injunction, damages or otherwise, 
",False,"```
ADAPTIVE PUBLIC LICENSE 
Version 1.0 

THE LICENSED WORK IS PROVIDED UNDER THE TERMS OF THIS ADAPTIVE PUBLIC LICENSE (""LICENSE""). ANY USE, REPRODUCTION OR DISTRIBUTION OF THE LICENSED WORK CONSTITUTES RECIPIENT'S ACCEPTANCE OF THIS LICENSE AND ITS TERMS, WHETHER OR NOT SUCH RECIPIENT READS THE TERMS OF THIS LICENSE. ""LICENSED WORK"" AND ""RECIPIENT"" ARE DEFINED BELOW.

 IMPORTANT NOTE: This License is ""adaptive"", and the generic version or another version of an Adaptive Public License should not be relied upon to determine your rights and obligations under this License. You must read the specific Adaptive Public License that you receive with the Licensed Work, as certain terms are defined at the outset by the Initial Contributor. 

See Section 2.2 below, Exhibit A attached, and any Suppfile.txt accompanying this License to determine the specific adaptive features applicable to this License. For example, without limiting the foregoing, (a) for selected choice of law and jurisdiction see Part 3 of Exhibit A; (b) for the selected definition of Third Party see Part 4 of Exhibit A; and (c) for selected patent licensing terms (if any) see Section 2.2 below and Part 6 of Exhibit A.

1. DEFINITIONS.

1.1. ""CONTRIBUTION"" means:

(a) In the case of the Initial Contributor, the Initial Work distributed under this License by the Initial Contributor; and

(b) In the case of each Subsequent Contributor, the Subsequent Work originating from and distributed by such Subsequent Contributor. 

1.2. ""DESIGNATED WEB SITE"" means the web site having the URL identified in Part 1 of Exhibit A, which URL may be changed by the Initial Contributor by posting on the current Designated Web Site the new URL for at least sixty (60) days.

1.3. ""DISTRIBUTOR"" means any Person that distributes the Licensed Work or any portion thereof to at least one Third Party. 

1.4. ""ELECTRONIC DISTRIBUTION MECHANISM"" means any mechanism generally accepted in the software development community for the electronic transfer of data. 

1.5. ""EXECUTABLE"" means the Licensed Work in any form other than Source Code. 

1.6. ""GOVERNING JURISDICTION"" means the state, province or other legal jurisdiction identified in Part 3 of Exhibit A. 

1.7. ""INITIAL CONTRIBUTOR"" means the Person or entity identified as the Initial Contributor in the notice required by Part 1 of Exhibit A.

 1.8. ""INITIAL WORK"" means the initial Source Code, object code (if any) and documentation for the computer program identified in Part 2 of Exhibit A, as such Source Code, object code and documentation is distributed under this License by the Initial Contributor. 

1.9. ""LARGER WORK"" means a work that combines the Licensed Work or portions thereof with code not governed by this License. 

1.10. ""LICENSED WORK"" means the Initial Work and/or any Subsequent Work, in each case including portions thereof. 

1.11. ""LICENSE NOTICE"" has the meaning assigned in Part 5 of Exhibit A.

 1.12. ""MODIFICATION"" or ""MODIFICATIONS"" means any change to and/or addition to the Licensed Work. 

1.13. ""PERSON"" means an individual or other legal entity, including a corporation, partnership or other body. 

1.14. ""RECIPIENT"" means any Person who receives or obtains the Licensed Work under this License (by way of example, without limiting the foregoing, any Subsequent Contributor or Distributor). 

1.15. ""SOURCE CODE"" means the source code for a computer program, including the source code for all modules and components of the computer program, plus any associated interface definition files, and scripts used to control compilation and installation of an executable. 

1.16. ""SUBSEQUENT CONTRIBUTOR"" means any Person that"
76,77,NomosTestfiles/APSL/apple.lic,APSL-2.0,"
Apple Public Source License
Version 2.0 - August 6, 2003

Please read this License carefully before downloading this
software. By downloading or using this software, you are agreeing to
be bound by the terms of this License. If you do not or cannot agree
to the terms of this License, please do not download or use the
software.

1. General; Definitions. This License applies to any program or other
work which Apple Computer, Inc. (""Apple"") makes publicly available and
which contains a notice placed by Apple identifying such program or
work as ""Original Code"" and stating that it is subject to the terms of
this Apple Public Source License version 2.0 (""License""). As used in
this License:

1.1 ""Applicable Patent Rights"" mean: (a) in the case where Apple is
the grantor of rights, (i) claims of patents that are now or hereafter
acquired, owned by or assigned to Apple and (ii) that cover subject
matter contained in the Original Code, but only to the extent
necessary to use, reproduce and/or distribute the Original Code
without infringement; and (b) in the case where You are the grantor of
rights, (i) claims of patents that are now or hereafter acquired,
owned by or assigned to You and (ii) that cover subject matter in Your
Modifications, taken alone or in combination with Original Code.

1.2 ""Contributor"" means any person or entity that creates or
contributes to the creation of Modifications.

1.3 ""Covered Code"" means the Original Code, Modifications, the
combination of Original Code and any Modifications, and/or any
respective portions thereof.

1.4 ""Externally Deploy"" means: (a) to sublicense, distribute or
otherwise make Covered Code available, directly or indirectly, to
anyone other than You; and/or (b) to use Covered Code, alone or as
part of a Larger Work, in any way to provide a service, including but
not limited to delivery of content, through electronic communication
with a client other than You.

1.5 ""Larger Work"" means a work which combines Covered Code or portions thereof with code not governed by the terms of this License.

1.6 ""Modifications"" mean any addition to, deletion from, and/or change to, the substance and/or structure of the Original Code, any previous Modifications, the combination of Original Code and any previous Modifications, and/or any respective portions thereof. When code is released as a series of files, a Modification is: (a) any addition to or deletion from the contents of a file containing Covered Code; and/or (b) any new file or other representation of computer program statements that contains any part of Covered Code.

1.7 ""Original Code"" means (a) the Source Code of a program or other work as originally made available by Apple under this License, including the Source Code of any updates or upgrades to such programs or works made available by Apple under this License, and that has been expressly identified by Apple as such in the header file(s) of such work; and (b) the object code compiled from such Source Code and originally made available by Apple under this License

1.8 ""Source Code"" means the human readable form of a program or other work that is suitable for making modifications to it, including all modules it contains, plus any associated interface definition files, scripts used to control compilation and installation of an executable (object code).

1.9 ""You"" or ""Your"" means an individual or a legal entity exercising
rights under this License. For legal entities, ""You"" or ""Your""
includes any entity which controls, is controlled by, or is under
common control with, You, where ""control"" means (a) the power, direct
or indirect, to cause the direction or management of such entity,
whether by contract or otherwise, or (b) ownership of fifty percent
(50%) or more of the outstanding shares or beneficial ownership of
such entity.

2. Permitted Uses; Conditions & Restrictions. Subject to the terms and conditions of this License, Apple hereby grants You, effective on the date You accept this License and download the Original Code, a world-wide, royalty-free, non-exclusive license, to the extent of Apple's Applicable Patent Rights and copyrights covering the Original Code, to do the following:

2.1 Unmodified Code. You may use, reproduce, display, perform,
internally distribute within Your organization, and Externally Deploy
verbatim, unmodified copies of the Original Code, for commercial or
non-commercial purposes, provided that in each instance:

    (a) You must retain and reproduce in all copies of Original Code
the copyright and other proprietary notices and disclaimers of Apple
as they appear in the Original Code, and keep intact all notices in
the Original Code that refer to this License; and

    (b) You must include a copy of this License with every copy of
Source Code of Covered Code and documentation You distribute or
Externally Deploy, and You may not offer or impose any terms on such
Source Code that alter or restrict this License or the recipients'
rights hereunder, except as permitted under Section 6.

2.2 Modified Code. You may modify Covered Code and use, reproduce,
display, perform, internally distribute within Your organization, and
Externally Deploy Your Modifications and Covered Code, for commercial
or non-commercial purposes, provided that in each instance You also
meet all of these conditions:

    (a) You must satisfy all the conditions of Section 2.1 with
respect to the Source Code of the Covered Code;

    (b) You must duplicate, to the extent it does not already exist,
the notice in Exhibit A in each file of the Source Code of all Your
Modifications, and cause the modified files to carry prominent notices
stating that You changed the files and the date of any change; and

    (c) If You Externally Deploy Your Modifications, You must make
Source Code of all Your Externally Deployed Modifications either
available to those to whom You have Externally Deployed Your
Modifications, or publicly available. Source Code of Your Externally
Deployed Modifications must be released under the terms set forth in
this License, including the license grants set forth in Section 3
below, for as long as you Externally Deploy the Covered Code or twelve
(12) months from the date of initial External Deployment, whichever is
longer. You should preferably distribute the Source Code of Your
Externally Deployed Modifications electronically (e.g. download from a
web site).

2.3 Distribution of Executable Versions. In addition, if You
Externally Deploy Covered Code (Original Code and/or Modifications) in
object code, executable form only, You must include a prominent
notice, in the code itself as well as in related documentation,
stating that Source Code of the Covered Code is available under the
terms of this License with information on how and where to obtain such
Source Code.

2.4 Third Party Rights. You expressly acknowledge and agree that although Apple and each Contributor grants the licenses to their respective portions of the Covered Code set forth herein, no assurances are provided by Apple or any Contributor that the Covered Code does not infringe the patent or other intellectual property rights of any other entity. Apple and each Contributor disclaim any liability to You for s required to allow You to distribute the Covered Code, it is Your responsibility to acquire that license before distributing the Covered Code.

3. Your Grants. In consideration of, and as a condition to, the
licenses granted to You under this License, You hereby grant to any
person or entity receiving or distributing Covered Code under this
License a non-exclusive, royalty-free, perpetual, irrevocable license,
under Your Applicable Patent Rights and other intellectual property
rights (other than patent) owned or controlled by You, to use,
reproduce, display, perform, modify, sublicense, distribute and
Externally Deploy Your Modifications of the same scope and extent as
Apple's licenses under Sections 2.1 and 2.2 above.

4. Larger Works. You may create a Larger Work by combining Covered
Code with other code not governed by the terms of this License and
distribute the Larger Work as a single product. In each such instance,
You must make sure the requirements of this License are fulfilled for
the Covered Code or any portion thereof.

5. Limitations on Patent License. Except as expressly stated in
Section 2, no other patent rights, express or implied, are granted by
Apple herein. Modifications and/or Larger Works may require additional
patent licenses from Apple which Apple may grant in its sole
discretion.

6. Additional Terms. You may choose to offer, and to charge a fee for,
warranty, support, indemnity or liability obligations and/or other
rights consistent with the scope of the license granted herein
(""Additional Terms"") to one or more recipients of Covered
Code. However, You may do so only on Your own behalf and as Your sole
responsibility, and not on behalf of Apple or any Contributor. You
must obtain the recipient's agreement that any such Additional Terms
are offered by You alone, and You hereby agree to indemnify, defend
and hold Apple and every Contributor harmless for any liability
incurred by or claims asserted against Apple or such Contributor by
reason of any such Additional Terms.

7. Versions of the License. Apple may publish revised and/or new
versions of this License from time to time. Each version will be given
a distinguishing version number. Once Original Code has been published
under a particular version of this License, You may continue to use it
under the terms of that version. You may also choose to use such
Original Code under the terms of any subsequent version of this
License published by Apple. No one other than Apple has the right to
modify the terms applicable to Covered Code created under this
License.

8. NO WARRANTY OR SUPPORT. The Covered Code may contain in whole or in
part pre-release, untested, or not fully tested works. The Covered
Code may contain errors that could cause failures or loss of data, and
may be incomplete or contain inaccuracies. You expressly acknowledge
and agree that use of the Covered Code, or any portion thereof, is at
Your sole and entire risk. THE COVERED CODE IS PROVIDED ""AS IS"" AND
WITHOUT WARRANTY, UPGRADES OR SUPPORT OF ANY KIND AND APPLE AND
APPLE'S LICENSOR(S) (COLLECTIVELY REFERRED TO AS ""APPLE"" FOR THE
PURPOSES OF SECTIONS 8 AND 9) AND ALL CONTRIBUTORS EXPRESSLY DISCLAIM
ALL WARRANTIES AND/OR CONDITIONS, EXPRESS OR IMPLIED, INCLUDING, BUT
NOT LIMITED TO, THE IMPLIED WARRANTIES AND/OR CONDITIONS OF
MERCHANTABILITY, OF SATISFACTORY QUALITY, OF FITNESS FOR A PARTICULAR
PURPOSE, OF ACCURACY, OF QUIET ENJOYMENT, AND NONINFRINGEMENT OF THIRD
PARTY RIGHTS. APPLE AND EACH CONTRIBUTOR DOES NOT WARRANT AGAINST
INTERFERENCE WITH YOUR ENJOYMENT OF THE COVERED CODE, THAT THE
FUNCTIONS CONTAINED IN THE COVERED CODE WILL MEET YOUR REQUIREMENTS,
THAT THE OPERATION OF THE COVERED CODE WILL BE UNINTERRUPTED OR
ERROR-FREE, OR THAT DEFECTS IN THE COVERED CODE WILL BE CORRECTED. NO
ORAL OR WRITTEN INFORMATION OR ADVICE GIVEN BY APPLE, AN APPLE
AUTHORIZED REPRESENTATIVE OR ANY CONTRIBUTOR SHALL CREATE A
WARRANTY. You acknowledge that the Covered Code is not intended for
use in the operation of nuclear facilities, aircraft navigation,
communication systems, or air traffic control machines in which case
the failure of the Covered Code could lead to death, personal injury,
or severe physical or environmental damage.

9. LIMITATION OF LIABILITY. TO THE EXTENT NOT PROHIBITED BY LAW, IN NO
EVENT SHALL APPLE OR ANY CONTRIBUTOR BE LIABLE FOR ANY INCIDENTAL,
SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES ARISING OUT OF OR RELATING
TO THIS LICENSE OR YOUR USE OR INABILITY TO USE THE COVERED CODE, OR
ANY PORTION THEREOF, WHETHER UNDER A THEORY OF CONTRACT, WARRANTY,
TORT (INCLUDING NEGLIGENCE), PRODUCTS LIABILITY OR OTHERWISE, EVEN IF
APPLE OR SUCH CONTRIBUTOR HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH
DAMAGES AND NOTWITHSTANDING THE FAILURE OF ESSENTIAL PURPOSE OF ANY
REMEDY. SOME JURISDICTIONS DO NOT ALLOW THE LIMITATION OF LIABILITY OF
INCIDENTAL OR CONSEQUENTIAL DAMAGES, SO THIS LIMITATION MAY NOT APPLY
TO YOU. In no event shall Apple's total liability to You for all
damages (other than as may be required by applicable law) under this
License exceed the amount of fifty dollars ($50.00).

10. Trademarks. This License does not grant any rights to use the
trademarks or trade names ""Apple"", ""Apple Computer"", ""Mac"", ""Mac OS"",
""QuickTime"", ""QuickTime Streaming Server"" or any other trademarks,
service marks, logos or trade names belonging to Apple (collectively
""Apple Marks"") or to any trademark, service mark, logo or trade name
belonging to any Contributor. You agree not to use any Apple Marks in
or as part of the name of products derived from the Original Code or
to endorse or promote products derived from the Original Code other
than as expressly permitted by and in strict compliance at all times
with Apple's third party trademark usage guidelines which are posted
at http://www.apple.com/legal/guidelinesfor3rdparties.html.

11. Ownership. Subject to the licenses granted under this License,
each Contributor retains all rights, title and interest in and to any
Modifications made by such Contributor. Apple retains all rights,
title and interest in and to the Original Code and any Modifications
made by or on behalf of Apple (""Apple Modifications""), and such Apple
Modifications will not be automatically subject to this License. Apple
may, at its sole discretion, choose to license such Apple
Modifications under this License, or on different terms from those
contained in this License or may choose not to license them at all.

12. Termination.

12.1 Termination. This License and the rights granted hereunder will terminate:

    (a) automatically without notice from Apple if You fail to comply
with any term(s) of this License and fail to cure such breach within
30 days of becoming aware of such breach;

    (b) immediately in the event of the circumstances described in
Section 13.5(b); or

    (c) automatically without notice from Apple if You, at any time
during the term of this License, commence an action for patent
infringement against Apple; provided that Apple did not first commence
an action for patent infringement against You in that instance.

12.2 Effect of Termination. Upon termination, You agree to immediately
stop any further use, reproduction, modification, sublicensing and
distribution of the Covered Code. All sublicenses to the Covered Code
which have been properly granted prior to termination shall survive
any termination of this License. Provisions which, by their nature,
should remain in effect beyond the termination of this License shall
survive, including but not limited to Sections 3, 5, 8, 9, 10, 11,
12.2 and 13. No party will be liable to any other for compensation,
indemnity or damages of any sort solely as a result of terminating
this License in accordance with its terms, and termination of this
License will be without prejudice to any other right or remedy of any
party.

13. Miscellaneous.

13.1 Government End Users. The Covered Code is a ""commercial item"" as
defined in FAR 2.101. Government software and technical data rights in
the Covered Code include only those rights customarily provided to the
public as defined in this License. This customary commercial license
in technical data and software is provided in accordance with FAR
12.211 (Technical Data) and 12.212 (Computer Software) and, for
Department of Defense purchases, DFAR 252.227-7015 (Technical Data --
Commercial Items) and 227.7202-3 (Rights in Commercial Computer
Software or Computer Software Documentation). Accordingly, all
U.S. Government End Users acquire Covered Code with only those rights
set forth herein.

13.2 Relationship of Parties. This License will not be construed as
creating an agency, partnership, joint venture or any other form of
legal association between or among You, Apple or any Contributor, and
You will not represent to the contrary, whether expressly, by
implication, appearance or otherwise.

13.3 Independent Development. Nothing in this License will impair
Apple's right to acquire, license, develop, have others develop for
it, market and/or distribute technology or products that perform the
same or similar functions as, or otherwise compete with,
Modifications, Larger Works, technology or products that You may
develop, produce, market or distribute.

13.4 Waiver; Construction. Failure by Apple or any Contributor to
enforce any provision of this License will not be deemed a waiver of
future enforcement of that or any other provision. Any law or
regulation which provides that the language of a contract shall be
construed against the drafter will not apply to this License.

13.5 Severability. (a) If for any reason a court of competent
jurisdiction finds any provision of this License, or portion thereof,
to be unenforceable, that provision of the License will be enforced to
the maximum extent permissible so as to effect the economic benefits
and intent of the parties, and the remainder of this License will
continue in full force and effect. (b) Notwithstanding the foregoing,
if applicable law prohibits or restricts You from fully and/or
specifically complying with Sections 2 and/or 3 or prevents the
enforceability of either of those Sections, this License will
immediately terminate and You must immediately discontinue any use of
the Covered Code and destroy all copies of it that are in your
possession or control.

13.6 Dispute Resolution. Any litigation or other dispute resolution
between You and Apple relating to this License shall take place in the
Northern District of California, and You and Apple hereby consent to
the personal jurisdiction of, and venue in, the state and federal
courts within that District with respect to this License. The
application of the United Nations Convention on Contracts for the
International Sale of Goods is expressly excluded.

13.7 Entire Agreement; Governing Law. This License constitutes the
entire agreement between the parties with respect to the subject
matter hereof. This License shall be governed by the laws of the
United States and the State of California, except that body of
California law concerning conflicts of law.

Where You are located in the province of Quebec, Canada, the following
clause applies: The parties hereby confirm that they have requested
that this License and all related documents be drafted in English.
",False,"```
Apple Public Source License
Version 2.0 - August 6, 2003

Please read this License carefully before downloading this
software. By downloading or using this software, you are agreeing to
be bound by the terms of this License. If you do not or cannot agree
to the terms of this License, please do not download or use the
software.

1. General; Definitions. This License applies to any program or other
work which Apple Computer, Inc. (""Apple"") makes publicly available and
which contains a notice placed by Apple identifying such program or
work as ""Original Code"" and stating that it is subject to the terms of
this Apple Public Source License version 2.0 (""License""). As used in
this License:

1.1 ""Applicable Patent Rights"" mean: (a) in the case where Apple is
the grantor of rights, (i) claims of patents that are now or hereafter
acquired, owned by or assigned to Apple and (ii) that cover subject
matter contained in the Original Code, but only to the extent
necessary to use, reproduce and/or distribute the Original Code
without infringement; and (b) in the case where You are the grantor of
rights, (i) claims of patents that are now or hereafter acquired,
owned by or assigned to You and (ii) that cover subject matter in Your
Modifications, taken alone or in combination with Original Code.

1.2 ""Contributor"" means any person or entity that creates or
contributes to the creation of Modifications.

1.3 ""Covered Code"" means the Original Code, Modifications, the
combination of Original Code and any Modifications, and/or any
respective portions thereof.

1.4 ""Externally Deploy"" means: (a) to sublicense, distribute or
otherwise make Covered Code available, directly or indirectly, to
anyone other than You; and/or (b) to use Covered Code, alone or as
part of a Larger Work, in any way to provide a service, including but
not limited to delivery of content, through electronic communication
with a client other than You.

1.5 ""Larger Work"" means a work which combines Covered Code or portions thereof with code not governed by the terms of this License.

1.6 ""Modifications"" mean any addition to, deletion from, and/or change to, the substance and/or structure of the Original Code, any previous Modifications, the combination of Original Code and any previous Modifications, and/or any respective portions thereof. When code is released as a series of files, a Modification is: (a) any addition to or deletion from the contents of a file containing Covered Code; and/or (b) any new file or other representation of computer program statements that contains any part of Covered Code.

1.7 ""Original Code"" means (a) the Source Code of a program or other work as originally made available by Apple under this License, including the Source Code of any updates or upgrades to such programs or works made available by Apple under this License, and that has been expressly identified by Apple as such in the header file(s) of such work; and (b) the object code compiled from such Source Code and originally made available by Apple under this License

1.8 ""Source Code"" means the human readable form of a program or other work that is suitable for making modifications to it, including all modules it contains, plus any associated interface definition files, scripts used to control compilation and installation of an executable (object code).

1.9 ""You"" or ""Your"" means an individual or a legal entity exercising
rights under this License. For legal entities, ""You"" or ""Your""
includes any entity which controls, is controlled by, or is under
common control with, You, where ""control"" means (a) the power, direct
or indirect, to cause the direction or management of such entity,
whether by contract or otherwise, or (b) ownership of fifty percent
(50%) or more of the outstanding shares or beneficial ownership of
such entity.

2. Permitted Uses; Conditions & Restrictions. Subject to the terms and conditions of this License, Apple hereby grants You, effective on the date You accept this License and download the Original Code, a world-wide, royalty-free, non-exclusive license, to the extent of Apple's Applicable Patent Rights and copyrights covering the Original Code, to do the following:

2.1 Unmodified Code. You may use, reproduce, display, perform,
internally distribute within Your organization, and Externally Deploy
verbatim, unmodified copies of the Original Code, for commercial or
non-commercial purposes, provided that in each instance:

    (a) You must retain and reproduce in all copies of Original Code
the copyright and other proprietary notices and disclaimers of Apple
as they appear in the Original Code, and keep intact all notices in
the Original Code that refer to this License; and

    (b) You must include a copy of this License with every copy of
Source Code of Covered Code and documentation You distribute or
Externally Deploy, and You may not offer or impose any terms on such
Source Code that alter or restrict this License or the recipients'
rights hereunder, except as permitted under Section 6.

2.2 Modified Code. You may modify Covered Code and use, reproduce,
display, perform, internally distribute within Your organization, and
Externally Deploy Your Modifications and Covered Code, for commercial or
non-commercial purposes, provided that in each instance You also
meet all of these conditions:

    (a) You must satisfy all the conditions of Section 2.1 with
respect to the Source Code of the Covered Code;

    (b) You must duplicate, to the extent it does not already exist,
the notice in Exhibit A in each file of the Source Code of all Your
Modifications, and cause the modified files to carry prominent notices
stating that You changed the files and the date of any change; and

    (c) If You Externally Deploy Your Modifications, You must make
Source Code of all Your Externally Deployed Modifications either
available to those to whom You have Externally Deployed Your
Modifications, or publicly available. Source Code of Your Externally
Deployed Modifications must be released under the terms set forth in
this License, including the license grants set forth in Section 3
below, for as long as you Externally Deploy the Covered Code or twelve
(12) months from the date of initial External Deployment, whichever is
longer. You should preferably distribute the Source Code of Your
Externally Deployed Modifications electronically (e.g. download from a
web site).

2.3 Distribution of Executable Versions. In addition, if You
Externally Deploy Covered Code (Original Code and/or Modifications) in
object code, executable form only, You must include a prominent
notice, in the code itself as well as in related documentation,
stating that Source Code of the Covered Code is available under the
terms of this License with information on how and where to obtain such
Source Code.

2.4 Third Party Rights. You expressly acknowledge and agree that although Apple and each Contributor grants the licenses to their respective portions of the Covered Code set forth herein, no assurances are provided by Apple or any Contributor that the Covered Code does not infringe the patent or other intellectual property rights of any other entity. Apple and each Contributor disclaim any liability to You for s required to allow You to distribute the Covered Code, it is Your responsibility to acquire that license before distributing the Covered Code.

3. Your Grants. In consideration of, and as a condition to, the
licenses granted to You under this License, You hereby grant to any
person or entity receiving or distributing Covered Code under this
License a non-exclusive, royalty-free, perpetual, irrevocable license,
under Your Applicable Patent Rights and other intellectual property
rights (other than patent) owned or controlled by You, to use,
reproduce, display, perform, modify, sublicense, distribute and
Externally Deploy Your Modifications of the same scope and extent as
Apple's licenses under Sections 2.1 and 2.2 above.

4. Larger Works. You may create a Larger Work by combining Covered
Code with other code not governed by the terms of this License and
distribute the Larger Work as a single product. In each such instance,
You must make sure the requirements of this License are fulfilled for
the Covered Code or any portion thereof.

5. Limitations on Patent License. Except as expressly stated in
Section 2, no other patent rights, express or implied, are granted by
Apple herein. Modifications and/or Larger Works may require additional
patent licenses from Apple which Apple may grant in its sole
discretion.

6. Additional Terms. You may choose to offer, and to charge a fee for,
warranty, support, indemnity or liability obligations and/or other
rights consistent with the scope of the license granted herein
(""Additional Terms"") to one or more recipients of Covered
Code. However, You may do so only on Your own behalf and as Your sole
responsibility, and not on behalf of Apple or any Contributor. You
must obtain the recipient's agreement that any such Additional Terms
are offered by You alone, and You hereby agree to indemnify, defend and
hold Apple and every Contributor harmless for any liability
incurred by or claims asserted against Apple or such Contributor by
reason of any such Additional Terms.

7. Versions of the License. Apple may publish revised and/or new
versions of this License from time to time. Each version will be given
a distinguishing version number. Once Original Code has been published
under a particular version of this License, You may continue to use it
under the terms of that version. You may also choose to use such
Original Code under the terms of any subsequent version of this
License published by Apple. No one other than Apple has the right to
modify the terms applicable to Covered Code created under this
License.

8. NO WARRANTY OR SUPPORT. The Covered Code may contain in whole or in
part pre-release, untested, or not fully tested works. The Covered
Code may contain errors that could cause failures or loss of data, and
may be incomplete or contain inaccuracies. You expressly acknowledge
and agree that use of the Covered Code, or any portion thereof, is at
Your sole and entire risk. THE COVERED CODE IS PROVIDED ""AS IS"" AND
WITHOUT WARRANTY, UPGRADES OR SUPPORT OF ANY KIND AND APPLE AND
APPLE'S LICENSOR(S) (COLLECTIVELY REFERRED TO AS ""APPLE"" FOR THE
PURPOSES OF SECTIONS 8 AND 9) AND ALL CONTRIBUTORS EXPRESSLY DISCLAIM
ALL WARRANTIES AND/OR CONDITIONS, EXPRESS OR IMPLIED, INCLUDING, BUT
NOT LIMITED TO, THE IMPLIED WARRANTIES AND/OR CONDITIONS OF
MERCHANTABILITY, OF SATISFACTORY QUALITY, OF FITNESS FOR A PARTICULAR
PURPOSE, OF ACCURACY, OF QUIET ENJOYMENT, AND NONINFRINGEMENT OF THIRD
PARTY RIGHTS. APPLE AND EACH CONTRIBUTOR DOES NOT WARRANT AGAINST
INTERFERENCE WITH YOUR ENJOYMENT OF THE COVERED CODE, THAT THE
FUNCTIONS CONTAINED IN THE COVERED CODE WILL MEET YOUR REQUIREMENTS,
THAT THE OPERATION OF THE COVERED CODE WILL BE UNINTERRUPTED OR
ERROR-FREE, OR THAT DEFECTS IN THE COVERED CODE WILL BE CORRECTED. No
oral or written information or advice given by Apple, an Apple
authorized representative or any Contributor shall create a
warranty. You acknowledge that the Covered Code is not intended for
use in the operation of nuclear facilities, aircraft navigation,
communication systems, or air traffic control machines in which case
the failure of the Covered Code could lead to death, personal injury,
or severe physical or environmental damage.

9. LIMITATION OF LIABILITY. TO THE EXTENT NOT PROHIBITED BY LAW, IN NO
EVENT SHALL APPLE OR ANY CONTRIBUTOR BE LIABLE FOR ANY INCIDENTAL,
SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES ARISING OUT OF OR RELATING
TO THIS LICENSE OR YOUR USE OR INABILITY TO USE THE COVERED CODE, OR
ANY PORTION THEREOF, WHETHER UNDER A THEORY OF CONTRACT, WARRANTY,
TORT (INCLUDING NEGLIGENCE), PRODUCTS LIABILITY OR OTHERWISE, EVEN IF
APPLE OR SUCH CONTRIBUTOR HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH
DAMAGES AND NOTWITHSTANDING THE FAILURE OF ESSENTIAL PURPOSE OF ANY
REMEDY. SOME JURISDICTIONS DO NOT ALLOW THE LIMITATION OF LIABILITY OF
INCIDENTAL OR CONSEQUENTIAL DAMAGES, SO THIS LIMITATION MAY NOT APPLY
TO YOU. In no event shall Apple's total liability to You for all
damages (other than as may be required by applicable law) under this
License exceed the amount of fifty dollars ($50.00).

10. Trademarks. This License does not grant any rights to use the
trademarks or trade names ""Apple"", ""Apple Computer"", ""Mac"", ""Mac OS"",
""QuickTime"", ""QuickTime Streaming Server"" or any other trademarks,
service marks, logos or trade names belonging to Apple (collectively
""Apple Marks"") or to any trademark, service mark, logo or trade name
belonging to any Contributor. You agree not to use any Apple Marks in
or as part of the name of products derived from the Original Code or
to endorse or promote products derived from the Original Code other
than as expressly permitted by and in strict compliance at all times
with Apple's third party trademark usage guidelines which are posted
at http://www.apple.com/legal/guidelinesfor3rdparties.html.

11. Ownership. Subject to the licenses granted under this License,
each Contributor retains all rights, title and interest in and to any
Modifications made by such Contributor. Apple retains all rights,
title and interest in and to the Original Code and any Modifications
made by or on behalf of Apple (""Apple Modifications""), and such Apple
Modifications will not be automatically subject to this License. Apple
may, at its sole discretion, choose to license such Apple
Modifications under this License, or on different terms from those
contained in this License or may choose not to license them at all.

12. Termination.

12.1 Termination. This License and the rights granted hereunder will terminate:

    (a) automatically without notice from Apple if You fail to comply
with any term(s) of this License and fail to cure such breach within
30 days of becoming aware of such breach;

    (b) immediately in the event of the circumstances described in
Section 13.5(b); or

    (c) automatically without notice from Apple if You, at any time
during the term of this License, commence an action for patent
infringement against Apple; provided that Apple did not first commence
an action for patent infringement against You in that instance.

12.2 Effect of Termination. Upon termination, You agree to immediately
stop any further use, reproduction, modification, sublicensing and
distribution of the Covered Code. All sublicenses to the Covered Code
which have been properly granted prior to termination shall survive
any termination of this License. Provisions which, by their nature,
should remain in effect beyond the termination of this License shall
survive, including but not limited to Sections 3, 5, 8, 9, 10, 11,
12.2 and 13. No party will be liable to any other for compensation,
indemnity or damages of any sort solely as a result of terminating
this License in accordance with its terms, and termination of this
License will be without prejudice to any other right or remedy of any
party.

13. Miscellaneous.

13.1 Government End Users. The Covered Code is a ""commercial item"" as
defined in FAR 2.101. Government software and technical data rights in
the Covered Code include only those rights customarily provided to the
public as defined in this License. This customary commercial license
in technical data and software is provided in accordance with FAR
12.211 (Technical Data) and 12.212 (Computer Software) and, for
Department of Defense purchases, DFAR 252.227-7015 (Technical Data --
Commercial Items) and 227.7202-3 (Rights in Commercial Computer
Software or Computer Software Documentation). Accordingly, all
U.S. Government End Users acquire Covered Code with only those rights
set forth herein.

13.2 Relationship of Parties. This License will not be construed as
creating an agency, partnership, joint venture or any other form of
"
77,78,NomosTestfiles/APSL/APSL-1.0.txt,APSL-1.0,"APPLE PUBLIC SOURCE LICENSE
Version 1.0 - March 16, 1999

Please read this License carefully before downloading this software.
By downloading and using this software, you are agreeing to be bound by
the terms of this License. If you do not or cannot agree to the terms
of this License, please do not download or use the software.

1. General; Definitions. This License applies to any program or other
work which Apple Computer, Inc. (""Apple"") publicly announces as
subject to this Apple Public Source License and which contains a
notice placed by Apple identifying such program or work as ""Original
Code"" and stating that it is subject to the terms of this Apple Public
Source License version 1.0 (or subsequent version thereof), as it may
be revised from time to time by Apple (""License""). As used in this
License:

1.1 ""Applicable Patents"" mean: (a) in the case where Apple is the
grantor of rights, (i) patents or patent applications that are now
or hereafter acquired, owned by or assigned to Apple and (ii) whose
claims cover subject matter contained in the Original Code, but only
to the extent necessary to use, reproduce and/or distribute the
Original Code without infringement; and (b) in the case where You
are the grantor of rights, (i) patents and patent applications that
are now or hereafter acquired, owned by or assigned to You and (ii)
whose claims cover subject matter in Your Modifications, taken alone
or in combination with Original Code.

1.2 ""Covered Code"" means the Original Code, Modifications, the
combination of Original Code and any Modifications, and/or any
respective portions thereof.

1.3 ""Deploy"" means to use, sublicense or distribute Covered Code other
than for Your internal research and development (R&amp;D), and includes
without limitation, any and all internal use or distribution of
Covered Code within Your business or organization except for R&amp;D use,
as well as direct or indirect sublicensing or distribution of Covered
Code by You to any third party in any form or manner.

1.4 ""Larger Work"" means a work which combines Covered Code or portions
thereof with code not governed by the terms of this License.

1.5 ""Modifications"" mean any addition to, deletion from, and/or change
to, the substance and/or structure of Covered Code. When code is
released as a series of files, a Modification is: (a) any addition to
or deletion from the contents of a file containing Covered Code;
and/or (b) any new file or other representation of computer program
statements that contains any part of Covered Code.

1.6 ""Original Code"" means the Source Code of a program or other work
as originally made available by Apple under this License, including
the Source Code of any updates or upgrades to such programs or works
made available by Apple under this License, and that has been
expressly identified by Apple as such in the header file(s) of such
work.

1.7 ""Source Code"" means the human readable form of a program or other
work that is suitable for making modifications to it, including all
modules it contains, plus any associated interface definition files,
scripts used to control compilation and installation of an executable
(object code).

1.8 ""You"" or ""Your"" means an individual or a legal entity exercising
rights under this License. For legal entities, ""You"" or ""Your""
includes any entity which controls, is controlled by, or is under
common control with, You, where ""control"" means (a) the power, direct
or indirect, to cause the direction or management of such entity,
whether by contract or otherwise, or (b) ownership of fifty percent
(50%) or more of the outstanding shares or beneficial ownership of
such entity.

2. Permitted Uses; Conditions &amp; Restrictions. Subject to the terms
and conditions of this License, Apple hereby grants You, effective on
the date You accept this License and download the Original Code, a
world-wide, royalty-free, non-exclusive license, to the extent of
Apple's Applicable Patents and copyrights covering the Original
Code, to do the following:

2.1 You may use, copy, modify and distribute Original Code, with or
without Modifications, solely for Your internal research and
development, provided that You must in each instance:

(a) retain and reproduce in all copies of Original Code the copyright
and other proprietary notices and disclaimers of Apple as they appear
in the Original Code, and keep intact all notices in the Original Code
that refer to this License;

(b) include a copy of this License with every copy of Source Code of
Covered Code and documentation You distribute, and You may not offer
or impose any terms on such Source Code that alter or restrict this
License or the recipients' rights hereunder, except as permitted under
Section 6; and

(c) completely and accurately document all Modifications that you have
made and the date of each such Modification, designate the version of
the Original Code you used, prominently include a file carrying such
information with the Modifications, and duplicate the notice in
Exhibit A in each file of the Source Code of all such Modifications.

2.2 You may Deploy Covered Code, provided that You must in each
instance:

(a) satisfy all the conditions of Section 2.1 with respect to the
Source Code of the Covered Code;

(b) make all Your Deployed Modifications publicly available in Source
Code form via electronic distribution (e.g. download from a web site)
under the terms of this License and subject to the license grants set
forth in Section 3 below, and any additional terms You may choose to
offer under Section 6. You must continue to make the Source Code of
Your Deployed Modifications available for as long as you Deploy the
Covered Code or twelve (12) months from the date of initial
Deployment, whichever is longer;

(c) must notify Apple and other third parties of how to obtain Your
Deployed Modifications by filling out and submitting the required
information found at
http://www.apple.com/publicsource/modifications.html; and

(d) if you Deploy Covered Code in object code, executable form only,
include a prominent notice, in the code itself as well as in related
documentation, stating that Source Code of the Covered Code is
available under the terms of this License with information on how and
where to obtain such Source Code.

3. Your Grants. In consideration of, and as a condition to, the
licenses granted to You under this License:

(a) You hereby grant to Apple and all third parties a non-exclusive,
royalty-free license, under Your Applicable Patents and other
intellectual property rights owned or controlled by You, to use,
reproduce, modify, distribute and Deploy Your Modifications of the
same scope and extent as Apple's licenses under Sections 2.1 and 2.2;
and

(b) You hereby grant to Apple and its subsidiaries a non-exclusive,
worldwide, royalty-free, perpetual and irrevocable license, under Your
Applicable Patents and other intellectual property rights owned or
controlled by You, to use, reproduce, execute, compile, display,
perform, modify or have modified (for Apple and/or its subsidiaries),
sublicense and distribute Your Modifications, in any form, through
multiple tiers of distribution.

4. Larger Works. You may create a Larger Work by combining Covered
Code with other code not governed by the terms of this License and
distribute the Larger Work as a single product. In each such
instance, You must make sure the requirements of this License are
fulfilled for the Covered Code or any portion thereof.

5. Limitations on Patent License. Except as expressly stated in
Section 2, no other patent rights, express or implied, are granted
by Apple herein. Modifications and/or Larger Works may require
additional patent licenses from Apple which Apple may grant in its
sole discretion.

6. Additional Terms. You may choose to offer, and to charge a fee
for, warranty, support, indemnity or liability obligations and/or
other rights consistent with the scope of the license granted herein
(""Additional Terms"") to one or more recipients of Covered
Code. However, You may do so only on Your own behalf and as Your
sole responsibility, and not on behalf of Apple. You must obtain the
recipient's agreement that any such Additional Terms are offered by
You alone, and You hereby agree to indemnify, defend and hold Apple
harmless for any liability incurred by or claims asserted against
Apple by reason of any such Additional Terms.

7. Versions of the License. Apple may publish revised and/or new
versions of this License from time to time. Each version will be
given a distinguishing version number. Once Original Code has been
published under a particular version of this License, You may
continue to use it under the terms of that version. You may also
choose to use such Original Code under the terms of any subsequent
version of this License published by Apple. No one other than Apple
has the right to modify the terms applicable to Covered Code created
under this License.

8. NO WARRANTY OR SUPPORT. The Original Code may contain in whole or
in part pre-release, untested, or not fully tested works. The
Original Code may contain errors that could cause failures or loss
of data, and may be incomplete or contain inaccuracies. You
expressly acknowledge and agree that use of the Original Code, or
any portion thereof, is at Your sole and entire risk. THE ORIGINAL
CODE IS PROVIDED ""AS IS"" AND WITHOUT WARRANTY, UPGRADES OR SUPPORT
OF ANY KIND AND APPLE AND APPLE'S LICENSOR(S) (FOR THE PURPOSES OF
SECTIONS 8 AND 9, APPLE AND APPLE'S LICENSOR(S) ARE COLLECTIVELY
REFERRED TO AS ""APPLE"") EXPRESSLY DISCLAIM ALL WARRANTIES AND/OR
CONDITIONS, EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES AND/OR CONDITIONS OF MERCHANTABILITY OR
SATISFACTORY QUALITY AND FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT OF THIRD PARTY RIGHTS. APPLE DOES NOT WARRANT THAT
THE FUNCTIONS CONTAINED IN THE ORIGINAL CODE WILL MEET YOUR
REQUIREMENTS, OR THAT THE OPERATION OF THE ORIGINAL CODE WILL BE
UNINTERRUPTED OR ERROR-FREE, OR THAT DEFECTS IN THE ORIGINAL CODE
WILL BE CORRECTED. NO ORAL OR WRITTEN INFORMATION OR ADVICE GIVEN
BY APPLE OR AN APPLE AUTHORIZED REPRESENTATIVE SHALL CREATE A
WARRANTY OR IN ANY WAY INCREASE THE SCOPE OF THIS WARRANTY. You
acknowledge that the Original Code is not intended for use in the
operation of nuclear facilities, aircraft navigation, communication
systems, or air traffic control machines in which case the failure
of the Original Code could lead to death, personal injury, or severe
physical or environmental damage.

9. Liability.

9.1 Infringement. If any of the Original Code becomes the subject of
a claim of infringement (""Affected Original Code""), Apple may, at
its sole discretion and option: (a) attempt to procure the rights
necessary for You to continue using the Affected Original Code; (b)
modify the Affected Original Code so that it is no longer
infringing; or (c) terminate Your rights to use the Affected
Original Code, effective immediately upon Apple's posting of a
notice to such effect on the Apple web site that is used for
implementation of this License.

9.2 LIMITATION OF LIABILITY. UNDER NO CIRCUMSTANCES SHALL APPLE BE
LIABLE FOR ANY INCIDENTAL, SPECIAL, INDIRECT OR CONSEQUENTIAL
DAMAGES ARISING OUT OF OR RELATING TO THIS LICENSE OR YOUR USE OR
INABILITY TO USE THE ORIGINAL CODE, OR ANY PORTION THEREOF, WHETHER
UNDER A THEORY OF CONTRACT, WARRANTY, TORT (INCLUDING NEGLIGENCE),
PRODUCTS LIABILITY OR OTHERWISE, EVEN IF APPLE HAS BEEN ADVISED OF
THE POSSIBILITY OF SUCH DAMAGES AND NOTWITHSTANDING THE FAILURE OF
ESSENTIAL PURPOSE OF ANY REMEDY. In no event shall Apple's total
liability to You for all damages under this License exceed the
amount of fifty dollars ($50.00).

10. Trademarks. This License does not grant any rights to use the
trademarks or trade names ""Apple"", ""Apple Computer"", ""Mac OS X"",
""Mac OS X Server"" or any other trademarks or trade names belonging
to Apple (collectively ""Apple Marks"") and no Apple Marks may be
used to endorse or promote products derived from the Original Code
other than as permitted by and in strict compliance at all times
with Apple's third party trademark usage guidelines which are
posted at http://www.apple.com/legal/guidelinesfor3rdparties.html.

11. Ownership. Apple retains all rights, title and interest in and to
the Original Code and any Modifications made by or on behalf of
Apple (""Apple Modifications""), and such Apple Modifications will
not be automatically subject to this License. Apple may, at its
sole discretion, choose to license such Apple Modifications under
this License, or on different terms from those contained in this
License or may choose not to license them at all. Apple's
development, use, reproduction, modification, sublicensing and
distribution of Covered Code will not be subject to this License.

12. Termination.

12.1 Termination. This License and the rights granted hereunder will
terminate:

(a) automatically without notice from Apple if You fail to comply with
any term(s) of this License and fail to cure such breach within 30
days of becoming aware of such breach; (b) immediately in the event of
the circumstances described in Sections 9.1 and/or 13.6(b); or (c)
automatically without notice from Apple if You, at any time during the
term of this License, commence an action for patent infringement
against Apple.

12.2 Effect of Termination. Upon termination, You agree to
immediately stop any further use, reproduction, modification and
distribution of the Covered Code, or Affected Original Code in the
case of termination under Section 9.1, and to destroy all copies of
the Covered Code or Affected Original Code (in the case of
termination under Section 9.1) that are in your possession or
control. All sublicenses to the Covered Code which have been
properly granted prior to termination shall survive any termination
of this License. Provisions which, by their nature, should remain
in effect beyond the termination of this License shall survive,
including but not limited to Sections 3, 5, 8, 9, 10, 11, 12.2 and
13. Neither party will be liable to the other for compensation,
indemnity or damages of any sort solely as a result of terminating
this License in accordance with its terms, and termination of this
License will be without prejudice to any other right or remedy of
either party.

13. Miscellaneous.

13.1 Export Law Assurances. You may not use or otherwise export or
re-export the Original Code except as authorized by United States
law and the laws of the jurisdiction in which the Original Code was
obtained. In particular, but without limitation, the Original Code
may not be exported or re-exported (a) into (or to a national or
resident of) any U.S. embargoed country or (b) to anyone on the
U.S. Treasury Department's list of Specially Designated Nationals
or the U.S. Department of Commerce's Table of Denial Orders. By
using the Original Code, You represent and warrant that You are not
located in, under control of, or a national or resident of any such
country or on any such list.

13.2 Government End Users. The Covered Code is a ""commercial item"" as
defined in FAR 2.101. Government software and technical data
rights in the Covered Code include only those rights customarily
provided to the public as defined in this License. This customary
commercial license in technical data and software is provided in
accordance with FAR 12.211 (Technical Data) and 12.212 (Computer
Software) and, for Department of Defense purchases, DFAR
252.227-7015 (Technical Data -- Commercial Items) and 227.7202-3
(Rights in Commercial Computer Software or Computer Software
Documentation). Accordingly, all U.S. Government End Users acquire
Covered Code with only those rights set forth herein.

13.3 Relationship of Parties. This License will not be construed as
creating an agency, partnership, joint venture or any other form of
legal association between You and Apple, and You will not represent
to the contrary, whether expressly, by implication, appearance or
otherwise.

13.4 Independent Development. Nothing in this License will impair
Apple's right to acquire, license, develop, have others develop for
it, market and/or distribute technology or products that perform
the same or similar functions as, or otherwise compete with,
Modifications, Larger Works, technology or products that You may
develop, produce, market or distribute.

13.5 Waiver; Construction. Failure by Apple to enforce any provision
of this License will not be deemed a waiver of future enforcement
of that or any other provision. Any law or regulation which
provides that the language of a contract shall be construed against
the drafter will not apply to this License.

13.6 Severability. (a) If for any reason a court of competent
jurisdiction finds any provision of this License, or portion
thereof, to be unenforceable, that provision of the License will be
enforced to the maximum extent permissible so as to effect the
economic benefits and intent of the parties, and the remainder of
this License will continue in full force and effect. (b)
Notwithstanding the foregoing, if applicable law prohibits or
restricts You from fully and/or specifically complying with
Sections 2 and/or 3 or prevents the enforceability of either of
those Sections, this License will immediately terminate and You
must immediately discontinue any use of the Covered Code and
destroy all copies of it that are in your possession or control.

13.7 Dispute Resolution. Any litigation or other dispute resolution
between You and Apple relating to this License shall take place in
the Northern District of California, and You and Apple hereby
consent to the personal jurisdiction of, and venue in, the state
and federal courts within that District with respect to this
License. The application of the United Nations Convention on
Contracts for the International Sale of Goods is expressly
excluded.

13.8 Entire Agreement; Governing Law. This License constitutes the
entire agreement between the parties with respect to the subject
matter hereof. This License shall be governed by the laws of the
United States and the State of California, except that body of
California law concerning conflicts of law.

Where You are located in the province of Quebec, Canada, the following
clause applies: The parties hereby confirm that they have requested
that this License and all related documents be drafted in English. Les
parties ont exige que le present contrat et tous les documents
connexes soient rediges en anglais.

EXHIBIT A.

""Portions Copyright (c) 1999 Apple Computer, Inc. All Rights
Reserved. This file contains Original Code and/or Modifications of
Original Code as defined in and that are subject to the Apple Public
Source License Version 1.0 (the 'License'). You may not use this file
except in compliance with the License. Please obtain a copy of the
License at http://www.apple.com/publicsource and read it before using
this file.

The Original Code and all software distributed under the License are
distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT. Please see the
License for the specific language governing rights and limitations
under the License.""
",False,"```
APPLE PUBLIC SOURCE LICENSE
Version 1.0 - March 16, 1999

Please read this License carefully before downloading this software.
By downloading and using this software, you are agreeing to be bound by
the terms of this License. If you do not or cannot agree to the terms
of this License, please do not download or use the software.

1. General; Definitions. This License applies to any program or other
work which Apple Computer, Inc. (""Apple"") publicly announces as
subject to this Apple Public Source License and which contains a
notice placed by Apple identifying such program or work as ""Original
Code"" and stating that it is subject to the terms of this Apple Public
Source License version 1.0 (or subsequent version thereof), as it may
be revised from time to time by Apple (""License""). As used in this
License:

1.1 ""Applicable Patents"" mean: (a) in the case where Apple is the
grantor of rights, (i) patents or patent applications that are now
or hereafter acquired, owned by or assigned to Apple and (ii) whose
claims cover subject matter contained in the Original Code, but only
to the extent necessary to use, reproduce and/or distribute the
Original Code without infringement; and (b) in the case where You
are the grantor of rights, (i) patents and patent applications that
are now or hereafter acquired, owned by or assigned to You and (ii)
whose claims cover subject matter in Your Modifications, taken alone
or in combination with Original Code.

1.2 ""Covered Code"" means the Original Code, Modifications, the
combination of Original Code and any Modifications, and/or any
respective portions thereof.

1.3 ""Deploy"" means to use, sublicense or distribute Covered Code other
than for Your internal research and development (R&amp;D), and includes
without limitation, any and all internal use or distribution of
Covered Code within Your business or organization except for R&amp;D use,
as well as direct or indirect sublicensing or distribution of Covered
Code by You to any third party in any form or manner.

1.4 ""Larger Work"" means a work which combines Covered Code or portions
thereof with code not governed by the terms of this License.

1.5 ""Modifications"" mean any addition to, deletion from, and/or change
to, the substance and/or structure of Covered Code. When code is
released as a series of files, a Modification is: (a) any addition to
or deletion from the contents of a file containing Covered Code;
and/or (b) any new file or other representation of computer program
statements that contains any part of Covered Code.

1.6 ""Original Code"" means the Source Code of a program or other work
as originally made available by Apple under this License, including
the Source Code of any updates or upgrades to such programs or works
made available by Apple under this License, and that has been
expressly identified by Apple as such in the header file(s) of such
work.

1.7 ""Source Code"" means the human readable form of a program or other
work that is suitable for making modifications to it, including all
modules it contains, plus any associated interface definition files,
scripts used to control compilation and installation of an executable
(object code).

1.8 ""You"" or ""Your"" means an individual or a legal entity exercising
rights under this License. For legal entities, ""You"" or ""Your""
includes any entity which controls, is controlled by, or is under
common control with, You, where ""control"" means (a) the power, direct
or indirect, to cause the direction or management of such entity,
whether by contract or otherwise, or (b) ownership of fifty percent
(50%) or more of the outstanding shares or beneficial ownership of
such entity.

2. Permitted Uses; Conditions &amp; Restrictions. Subject to the terms
and conditions of this License, Apple hereby grants You, effective on
the date You accept this License and download the Original Code, a
world-wide, royalty-free, non-exclusive license, to the extent of
Apple's Applicable Patents and copyrights covering the Original
Code, to do the following:

2.1 You may use, copy, modify and distribute Original Code, with or
without Modifications, solely for Your internal research and
development, provided that You must in each instance:

(a) retain and reproduce in all copies of Original Code the copyright
and other proprietary notices and disclaimers of Apple as they appear
in the Original Code, and keep intact all notices in the Original
Code that refer to this License;

(b) include a copy of this License with every copy of Source Code of
Covered Code and documentation You distribute, and You may not offer
or impose any terms on such Source Code that alter or restrict this
License or the recipients' rights hereunder, except as permitted under
Section 6; and

(c) completely and accurately document all Modifications that you have
made and the date of each such Modification, designate the version of
the Original Code you used, prominently include a file carrying such
information with the Modifications, and duplicate the notice in
Exhibit A in each file of the Source Code of all such Modifications.

2.2 You may Deploy Covered Code, provided that You must in each
instance:

(a) satisfy all the conditions of Section 2.1 with respect to the
Source Code of the Covered Code;

(b) make all Your Deployed Modifications publicly available in Source
Code form via electronic distribution (e.g. download from a web site)
under the terms of this License and subject to the license grants set
forth in Section 3 below, and any additional terms You may choose to
offer under Section 6. You must continue to make the Source Code of
Your Deployed Modifications available for as long as you Deploy the
Covered Code or twelve (12) months from the date of initial
Deployment, whichever is longer;

(c) must notify Apple and other third parties of how to obtain Your
Deployed Modifications by filling out and submitting the required
information found at
http://www.apple.com/publicsource/modifications.html; and

(d) if you Deploy Covered Code in object code, executable form only,
include a prominent notice, in the code itself as well as in related
documentation, stating that Source Code of the Covered Code is
available under the terms of this License with information on how and
where to obtain such Source Code.

3. Your Grants. In consideration of, and as a condition to, the
licenses granted to You under this License:

(a) You hereby grant to Apple and all third parties a non-exclusive,
royalty-free license, under Your Applicable Patents and other
intellectual property rights owned or controlled by You, to use,
reproduce, modify, distribute and Deploy Your Modifications of the
same scope and extent as Apple's licenses under Sections 2.1 and 2.2;
and

(b) You hereby grant to Apple and its subsidiaries a non-exclusive,
worldwide, royalty-free, perpetual and irrevocable license, under Your
Applicable Patents and other intellectual property rights owned or
controlled by You, to use, reproduce, execute, compile, display,
perform, modify or have modified (for Apple and/or its subsidiaries),
sublicense and distribute Your Modifications, in any form, through
multiple tiers of distribution.

4. Larger Works. You may create a Larger Work by combining Covered
Code with other code not governed by the terms of this License and
distribute the Larger Work as a single product. In each such
instance, You must make sure the requirements of this License are
fulfilled for the Covered Code or any portion thereof.

5. Limitations on Patent License. Except as expressly stated in
Section 2, no other patent rights, express or implied, are granted
by Apple herein. Modifications and/or Larger Works may require
additional patent licenses from Apple which Apple may grant in its
sole discretion.

6. Additional Terms. You may choose to offer, and to charge a fee
for, warranty, support, indemnity or liability obligations and/or
other rights consistent with the scope of the license granted herein
(""Additional Terms"") to one or more recipients of Covered
Code. However, You may do so only on Your own behalf and as Your
sole responsibility, and not on behalf of Apple. You must obtain the
recipient's agreement that any such Additional Terms are offered by
You alone, and You hereby agree to indemnify, defend and hold Apple
harmless for any liability incurred by or claims asserted against
Apple by reason of any such Additional Terms.

7. Versions of the License. Apple may publish revised and/or new
versions of this License from time to time. Each version will be
given a distinguishing version number. Once Original Code has been
published under a particular version of this License, You may
continue to use it under the terms of that version. You may also
choose to use such Original Code under the terms of any subsequent
version of this License published by Apple. No one other than Apple
has the right to modify the terms applicable to Covered Code created
under this License.

8. NO WARRANTY OR SUPPORT. The Original Code may contain in whole or
part pre-release, untested, or not fully tested works. The Original
Code may contain errors that could cause failures or loss
of data, and may be incomplete or contain inaccuracies. You
expressly acknowledge and agree that use of the Original Code, or
any portion thereof, is at Your sole and entire risk. THE ORIGINAL
CODE IS PROVIDED ""AS IS"" AND WITHOUT WARRANTY, UPGRADES OR SUPPORT
OF ANY KIND AND APPLE AND APPLE'S LICENSOR(S) (FOR THE PURPOSES OF
SECTIONS 8 AND 9, APPLE AND APPLE'S LICENSOR(S) ARE COLLECTIVELY
REFERRED TO AS ""APPLE"") EXPRESSLY DISCLAIM ALL WARRANTIES AND/OR
CONDITIONS, EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES AND/OR CONDITIONS OF MERCHANTABILITY OR
SATISFACTORY QUALITY AND FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT OF THIRD PARTY RIGHTS. APPLE DOES NOT WARRANT THAT
THE FUNCTIONS CONTAINED IN THE ORIGINAL CODE WILL MEET YOUR
REQUIREMENTS, OR THAT THE OPERATION OF THE ORIGINAL CODE WILL BE
UNINTERRUPTED OR ERROR-FREE, OR THAT DEFECTS IN THE ORIGINAL CODE
WILL BE CORRECTED. NO ORAL OR WRITTEN INFORMATION OR ADVICE GIVEN
BY APPLE OR AN APPLE AUTHORIZED REPRESENTATIVE SHALL CREATE A
WARRANTY OR IN ANY WAY INCREASE THE SCOPE OF THIS WARRANTY. You
acknowledge that the Original Code is not intended for use in the
operation of nuclear facilities, aircraft navigation, communication
systems, or air traffic control machines in which case the failure
of the Original Code could lead to death, personal injury, or severe
physical or environmental damage.

9. Liability.

9.1 Infringement. If any of the Original Code becomes the subject of
a claim of infringement (""Affected Original Code""), Apple may, at its
sole discretion and option: (a) attempt to procure the rights
necessary for You to continue using the Affected Original Code; (b)
modify the Affected Original Code so that it is no longer
infringing; or (c) terminate Your rights to use the Affected
Original Code, effective immediately upon Apple's posting of a
notice to such effect on the Apple web site that is used for
implementation of this License.

9.2 LIMITATION OF LIABILITY. UNDER NO CIRCUMSTANCES SHALL APPLE BE
LIABLE FOR ANY INCIDENTAL, SPECIAL, INDIRECT OR CONSEQUENTIAL
DAMAGES ARISING OUT OF OR RELATING TO THIS LICENSE OR YOUR USE OR
INABILITY TO USE THE ORIGINAL CODE, OR ANY PORTION THEREOF, WHETHER
UNDER A THEORY OF CONTRACT, WARRANTY, TORT (INCLUDING NEGLIGENCE),
PRODUCTS LIABILITY OR OTHERWISE, EVEN IF APPLE HAS BEEN ADVISED OF
THE POSSIBILITY OF SUCH DAMAGES AND NOTWITHSTANDING THE FAILURE
OF ESSENTIAL PURPOSE OF ANY REMEDY. In no event shall Apple's total
liability to You for all damages under this License exceed the
amount of fifty dollars ($50.00).

10. Trademarks. This License does not grant any rights to use the
trademarks or trade names ""Apple"", ""Apple Computer"", ""Mac OS X"",
""Mac OS X Server"" or any other trademarks or trade names belonging to
Apple (collectively ""Apple Marks"") and no Apple Marks may be used to
endorse or promote products derived from the Original Code other than
as permitted by and in strict compliance at all times with Apple's
third party trademark usage guidelines which are
posted at http://www.apple.com/legal/guidelinesfor3rdparties.html.

11. Ownership. Apple retains all rights, title and interest in and to
the Original Code and any Modifications made by or on behalf of
Apple (""Apple Modifications""), and such Apple Modifications will
not be automatically subject to this License. Apple may, at its
sole discretion, choose to license such Apple Modifications under
this License, or on different terms from those contained in this
License or may choose not to license them at all. Apple's
development, use, reproduction, modification, sublicensing and
distribution of Covered Code will not be subject to this License.

12. Termination.

12.1 Termination. This License and the rights granted hereunder will
terminate:

(a) automatically without notice from Apple if You fail to comply with
any term(s) of this License and fail to cure such breach within 30
days of becoming aware of such breach; (b) immediately in the event
of the circumstances described in Sections 9.1 and/or 13.6(b); or (c)
automatically without notice from Apple if You, at any time during the
term of this License, commence an action for patent infringement
against Apple.

12.2 Effect of Termination. Upon termination, You agree to
immediately stop any further use, reproduction, modification and
distribution of the Covered Code, or Affected Original Code in the
case of termination under Section 9.1, and to destroy all copies of
the Covered Code or Affected Original Code (in the case of
termination under Section 9.1) that are in your possession or
control. All sublicenses to the Covered Code which have been
properly granted prior to termination shall survive any termination
of this License. Provisions which, by their nature, should remain
in effect beyond the termination of this License shall survive,
including but not limited to Sections 3, 5, 8, 9, 10, 11, 12.2 and
13. Neither party will be liable to the other for compensation,
indemnity or damages of any sort solely as a result of terminating
this License in accordance with its terms, and termination of this
License will be without prejudice to any other right or remedy of
either party.

13. Miscellaneous.

13.1 Export Law Assurances. You may not use or"
78,79,NomosTestfiles/APSL/APSL-1.1.txt,APSL-1.1,"APPLE PUBLIC SOURCE LICENSE
Version 1.1 - April 19,1999

Please read this License carefully before downloading this software.
By downloading and using this software, you are agreeing to be bound
by the terms of this License.  If you do not or cannot agree to the
terms of this License, please do not download or use the software.

1. General; Definitions.  This License applies to any program or other
work which Apple Computer, Inc. (""Apple"") publicly announces as
subject to this Apple Public Source License and which contains a
notice placed by Apple identifying such program or work as ""Original
Code"" and stating that it is subject to the terms of this Apple Public
Source License version 1.1 (or subsequent version thereof), as it may
be revised from time to time by Apple (""License"").  As used in this
License:

1.1 ""Affected Original Code"" means only those specific portions of
Original Code that allegedly infringe upon any party's intellectual
property rights or are otherwise the subject of a claim of
infringement.

1.2 ""Applicable Patent Rights"" mean: (a) in the case where Apple is
the grantor of rights, (i) claims of patents that are now or hereafter
acquired, owned by or assigned to Apple and (ii) that cover subject
matter contained in the Original Code, but only to the extent
necessary to use, reproduce and/or distribute the Original Code
without infringement; and (b) in the case where You are the grantor of
rights, (i) claims of patents that are now or hereafter acquired,
owned by or assigned to You and (ii) that cover subject matter in Your
Modifications, taken alone or in combination with Original Code.

1.3 ""Covered Code"" means the Original Code, Modifications, the
combination of Original Code and any Modifications, and/or any
respective portions thereof.

1.4 ""Deploy"" means to use, sublicense or distribute Covered Code other
than for Your internal research and development (R&amp;D), and includes
without limitation, any and all internal use or distribution of
Covered Code within Your business or organization except for R&amp;D use,
as well as direct or indirect sublicensing or distribution of Covered
Code by You to any third party in any form or manner.

1.5 ""Larger Work"" means a work which combines Covered Code or portions
thereof with code not governed by the terms of this License.

1.6 ""Modifications"" mean any addition to, deletion from, and/or change
to, the substance and/or structure of Covered Code.  When code is
released as a series of files, a Modification is: (a) any addition to
or deletion from the contents of a file containing Covered Code;
and/or (b) any new file or other representation of computer program
statements that contains any part of Covered Code.

1.7 ""Original Code"" means (a) the Source Code of a program or other
work as originally made available by Apple under this License,
including the Source Code of any updates or upgrades to such programs
or works made available by Apple under this License, and that has been
expressly identified by Apple as such in the header file(s) of such
work; and (b) the object code compiled from such Source Code and
originally made available by Apple under this License.

1.8 ""Source Code"" means the human readable form of a program or other
work that is suitable for making modifications to it, including all
modules it contains, plus any associated interface definition files,
scripts used to control compilation and installation of an executable
(object code).

1.9 ""You"" or ""Your"" means an individual or a legal entity exercising
rights under this License.  For legal entities, ""You"" or ""Your""
includes any entity which controls, is controlled by, or is under
common control with, You, where ""control"" means (a) the power, direct
or indirect, to cause the direction or management of such entity,
whether by contract or otherwise, or (b) ownership of fifty percent
(50%) or more of the outstanding shares or beneficial ownership of
such entity.

2. Permitted Uses; Conditions &amp; Restrictions.  Subject to the terms
and conditions of this License, Apple hereby grants You, effective on
the date You accept this License and download the Original Code, a
world-wide, royalty-free, non- exclusive license, to the extent of
Apple's Applicable Patent Rights and copyrights covering the Original
Code, to do the following:

2.1 You may use, copy, modify and distribute Original Code, with or
without Modifications, solely for Your internal research and
development, provided that You must in each instance:

(a) retain and reproduce in all copies of Original Code the copyright
and other proprietary notices and disclaimers of Apple as they appear
in the Original Code, and keep intact all notices in the Original Code
that refer to this License;

(b) include a copy of this License with every copy of Source Code of
Covered Code and documentation You distribute, and You may not offer
or impose any terms on such Source Code that alter or restrict this
License or the recipients' rights hereunder, except as permitted under
Section 6; and

(c) completely and accurately document all Modifications that you have
made and the date of each such Modification, designate the version of
the Original Code you used, prominently include a file carrying such
information with the Modifications, and duplicate the notice in
Exhibit A in each file of the Source Code of all such Modifications.

2.2 You may Deploy Covered Code, provided that You must in each
  instance:

(a) satisfy all the conditions of Section 2.1 with respect to the
Source Code of the Covered Code;

(b) make all Your Deployed Modifications publicly available in Source
Code form via electronic distribution (e.g. download from a web site)
under the terms of this License and subject to the license grants set
forth in Section 3 below, and any additional terms You may choose to
offer under Section 6.  You must continue to make the Source Code of
Your Deployed Modifications available for as long as you Deploy the
Covered Code or twelve (12) months from the date of initial
Deployment, whichever is longer;

(c) if You Deploy Covered Code containing Modifications made by You,
inform others of how to obtain those Modifications by filling out and
submitting the information found at
http://www.apple.com/publicsource/modifications.html, if available;
and

(d) if You Deploy Covered Code in object code, executable form only,
include a prominent notice, in the code itself as well as in related
documentation, stating that Source Code of the Covered Code is
available under the terms of this License with information on how and
where to obtain such Source Code.

3. Your Grants.  In consideration of, and as a condition to, the
licenses granted to You under this License:

(a) You hereby grant to Apple and all third parties a non-exclusive,
royalty-free license, under Your Applicable Patent Rights and other
intellectual property rights owned or controlled by You, to use,
reproduce, modify, distribute and Deploy Your Modifications of the
same scope and extent as Apple's licenses under Sections 2.1 and 2.2;
and

(b) You hereby grant to Apple and its subsidiaries a non-exclusive,
worldwide, royalty-free, perpetual and irrevocable license, under Your
Applicable Patent Rights and other intellectual property rights owned
or controlled by You, to use, reproduce, execute, compile, display,
perform, modify or have modified (for Apple and/or its subsidiaries),
sublicense and distribute Your Modifications, in any form, through
multiple tiers of distribution.

4. Larger Works.  You may create a Larger Work by combining Covered
Code with other code not governed by the terms of this License and
distribute the Larger Work as a single product.  In each such
instance, You must make sure the requirements of this License are
fulfilled for the Covered Code or any portion thereof.

5. Limitations on Patent License.  Except as expressly stated in
Section 2, no other patent rights, express or implied, are granted by
Apple herein.  Modifications and/or Larger Works may require
additional patent licenses from Apple which Apple may grant in its
sole discretion.

6. Additional Terms.  You may choose to offer, and to charge a fee
for, warranty, support, indemnity or liability obligations and/or
other rights consistent with the scope of the license granted herein
(""Additional Terms"") to one or more recipients of Covered
Code. However, You may do so only on Your own behalf and as Your sole
responsibility, and not on behalf of Apple. You must obtain the
recipient's agreement that any such Additional Terms are offered by
You alone, and You hereby agree to indemnify, defend and hold Apple
harmless for any liability incurred by or claims asserted against
Apple by reason of any such Additional Terms.

7. Versions of the License.  Apple may publish revised and/or new
versions of this License from time to time.  Each version will be
given a distinguishing version number.  Once Original Code has been
published under a particular version of this License, You may continue
to use it under the terms of that version. You may also choose to use
such Original Code under the terms of any subsequent version of this
License published by Apple.  No one other than Apple has the right to
modify the terms applicable to Covered Code created under this
License.

8. NO WARRANTY OR SUPPORT.  The Original Code may contain in whole or
in part pre-release, untested, or not fully tested works.  The
Original Code may contain errors that could cause failures or loss of
data, and may be incomplete or contain inaccuracies.  You expressly
acknowledge and agree that use of the Original Code, or any portion
thereof, is at Your sole and entire risk.  THE ORIGINAL CODE IS
PROVIDED ""AS IS"" AND WITHOUT WARRANTY, UPGRADES OR SUPPORT OF ANY KIND
AND APPLE AND APPLE'S LICENSOR(S) (FOR THE PURPOSES OF SECTIONS 8 AND
9, APPLE AND APPLE'S LICENSOR(S) ARE COLLECTIVELY REFERRED TO AS
""APPLE"") EXPRESSLY DISCLAIM ALL WARRANTIES AND/OR CONDITIONS, EXPRESS
OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
AND/OR CONDITIONS OF MERCHANTABILITY OR SATISFACTORY QUALITY AND
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF THIRD PARTY
RIGHTS.  APPLE DOES NOT WARRANT THAT THE FUNCTIONS CONTAINED IN THE
ORIGINAL CODE WILL MEET YOUR REQUIREMENTS, OR THAT THE OPERATION OF
THE ORIGINAL CODE WILL BE UNINTERRUPTED OR ERROR- FREE, OR THAT
DEFECTS IN THE ORIGINAL CODE WILL BE CORRECTED.  NO ORAL OR WRITTEN
INFORMATION OR ADVICE GIVEN BY APPLE OR AN APPLE AUTHORIZED
REPRESENTATIVE SHALL CREATE A WARRANTY OR IN ANY WAY INCREASE THE
SCOPE OF THIS WARRANTY.  You acknowledge that the Original Code is not
intended for use in the operation of nuclear facilities, aircraft
navigation, communication systems, or air traffic control machines in
which case the failure of the Original Code could lead to death,
personal injury, or severe physical or environmental damage.

9. Liability.

9.1 Infringement.  If any portion of, or functionality implemented by,
the Original Code becomes the subject of a claim of infringement,
Apple may, at its option: (a) attempt to procure the rights necessary
for Apple and You to continue using the Affected Original Code; (b)
modify the Affected Original Code so that it is no longer infringing;
or (c) suspend Your rights to use, reproduce, modify, sublicense and
distribute the Affected Original Code until a final determination of
the claim is made by a court or governmental administrative agency of
competent jurisdiction and Apple lifts the suspension as set forth
below.  Such suspension of rights will be effective immediately upon
Apple's posting of a notice to such effect on the Apple web site that
is used for implementation of this License.  Upon such final
determination being made, if Apple is legally able, without the
payment of a fee or royalty, to resume use, reproduction,
modification, sublicensing and distribution of the Affected Original
Code, Apple will lift the suspension of rights to the Affected
Original Code by posting a notice to such effect on the Apple web site
that is used for implementation of this License.  If Apple suspends
Your rights to Affected Original Code, nothing in this License shall
be construed to restrict You, at Your option and subject to applicable
law, from replacing the Affected Original Code with non-infringing
code or independently negotiating for necessary rights from such third
party.

9.2 LIMITATION OF LIABILITY.  UNDER NO CIRCUMSTANCES SHALL APPLE BE
LIABLE FOR ANY INCIDENTAL, SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES
ARISING OUT OF OR RELATING TO THIS LICENSE OR YOUR USE OR INABILITY TO
USE THE ORIGINAL CODE, OR ANY PORTION THEREOF, WHETHER UNDER A THEORY
OF CONTRACT, WARRANTY, TORT (INCLUDING NEGLIGENCE), PRODUCTS LIABILITY
OR OTHERWISE, EVEN IF APPLE HAS BEEN ADVISED OF THE POSSIBILITY OF
SUCH DAMAGES AND NOTWITHSTANDING THE FAILURE OF ESSENTIAL PURPOSE OF
ANY REMEDY.  In no event shall Apple's total liability to You for all
damages under this License exceed the amount of fifty dollars
($50.00).

10. Trademarks.  This License does not grant any rights to use the
trademarks or trade names ""Apple"", ""Apple Computer"", ""Mac OS X"", ""Mac
OS X Server"" or any other trademarks or trade names belonging to Apple
(collectively ""Apple Marks"") and no Apple Marks may be used to endorse
or promote products derived from the Original Code other than as
permitted by and in strict compliance at all times with Apple's third
party trademark usage guidelines which are posted at
http://www.apple.com/legal/guidelinesfor3rdparties.html.

11. Ownership.  Apple retains all rights, title and interest in and to
the Original Code and any Modifications made by or on behalf of Apple
(""Apple Modifications""), and such Apple Modifications will not be
automatically subject to this License.  Apple may, at its sole
discretion, choose to license such Apple Modifications under this
License, or on different terms from those contained in this License or
may choose not to license them at all.  Apple's development, use,
reproduction, modification, sublicensing and distribution of Covered
Code will not be subject to this License.

12. Termination.

12.1 Termination.  This License and the rights granted hereunder will
   terminate:

(a) automatically without notice from Apple if You fail to comply with
any term(s) of this License and fail to cure such breach within 30
days of becoming aware of such breach; (b) immediately in the event of
the circumstances described in Section 13.5(b); or (c) automatically
without notice from Apple if You, at any time during the term of this
License, commence an action for patent infringement against Apple.

12.2 Effect of Termination.  Upon termination, You agree to
immediately stop any further use, reproduction, modification,
sublicensing and distribution of the Covered Code and to destroy all
copies of the Covered Code that are in your possession or control.
All sublicenses to the Covered Code which have been properly granted
prior to termination shall survive any termination of this License.
Provisions which, by their nature, should remain in effect beyond the
termination of this License shall survive, including but not limited
to Sections 3, 5, 8, 9, 10, 11, 12.2 and 13.  Neither party will be
liable to the other for compensation, indemnity or damages of any sort
solely as a result of terminating this License in accordance with its
terms, and termination of this License will be without prejudice to
any other right or remedy of either party.

13.  Miscellaneous.

13.1 Government End Users.  The Covered Code is a ""commercial item"" as
defined in FAR 2.101.  Government software and technical data rights
in the Covered Code include only those rights customarily provided to
the public as defined in this License. This customary commercial
license in technical data and software is provided in accordance with
FAR 12.211 (Technical Data) and 12.212 (Computer Software) and, for
Department of Defense purchases, DFAR 252.227-7015 (Technical Data --
Commercial Items) and 227.7202-3 (Rights in Commercial Computer
Software or Computer Software Documentation).  Accordingly, all U.S.
Government End Users acquire Covered Code with only those rights set
forth herein.

13.2 Relationship of Parties.  This License will not be construed as
creating an agency, partnership, joint venture or any other form of
legal association between You and Apple, and You will not represent to
the contrary, whether expressly, by implication, appearance or
otherwise.

13.3 Independent Development.  Nothing in this License will impair
Apple's right to acquire, license, develop, have others develop for
it, market and/or distribute technology or products that perform the
same or similar functions as, or otherwise compete with,
Modifications, Larger Works, technology or products that You may
develop, produce, market or distribute.

13.4 Waiver; Construction.  Failure by Apple to enforce any provision
of this License will not be deemed a waiver of future enforcement of
that or any other provision.  Any law or regulation which provides
that the language of a contract shall be construed against the drafter
will not apply to this License.

13.5 Severability.  (a) If for any reason a court of competent
jurisdiction finds any provision of this License, or portion thereof,
to be unenforceable, that provision of the License will be enforced to
the maximum extent permissible so as to effect the economic benefits
and intent of the parties, and the remainder of this License will
continue in full force and effect.  (b) Notwithstanding the foregoing,
if applicable law prohibits or restricts You from fully and/or
specifically complying with Sections 2 and/or 3 or prevents the
enforceability of either of those Sections, this License will
immediately terminate and You must immediately discontinue any use of
the Covered Code and destroy all copies of it that are in your
possession or control.

13.6 Dispute Resolution.  Any litigation or other dispute resolution
between You and Apple relating to this License shall take place in the
Northern District of California, and You and Apple hereby consent to
the personal jurisdiction of, and venue in, the state and federal
courts within that District with respect to this License. The
application of the United Nations Convention on Contracts for the
International Sale of Goods is expressly excluded.

13.7 Entire Agreement; Governing Law.  This License constitutes the
entire agreement between the parties with respect to the subject
matter hereof.  This License shall be governed by the laws of the
United States and the State of California, except that body of
California law concerning conflicts of law.

Where You are located in the province of Quebec, Canada, the following
clause applies: The parties hereby confirm that they have requested
that this License and all related documents be drafted in English. Les
parties ont exige que le present contrat et tous les documents
connexes soient rediges en anglais.

EXHIBIT A.

""Portions Copyright (c) 1999-2000 Apple Computer, Inc.  All Rights
Reserved.  This file contains Original Code and/or Modifications of
Original Code as defined in and that are subject to the Apple Public
Source License Version 1.1 (the ""License"").  You may not use this file
except in compliance with the License.  Please obtain a copy of the
License at http://www.apple.com/publicsource and read it before using
this file.

The Original Code and all software distributed under the License are
distributed on an ""AS IS"" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE OR NON- INFRINGEMENT.  Please see the
License for the specific language governing rights and limitations
under the License.""
",False,"```
APPLE PUBLIC SOURCE LICENSE
Version 1.1 - April 19,1999

Please read this License carefully before downloading this software.
By downloading and using this software, you are agreeing to be bound
by the terms of this License.  If you do not or cannot agree to the
terms of this License, please do not download or use the software.

1. General; Definitions.  This License applies to any program or other
work which Apple Computer, Inc. (""Apple"") publicly announces as
subject to this Apple Public Source License and which contains a
notice placed by Apple identifying such program or work as ""Original
Code"" and stating that it is subject to the terms of this Apple Public
Source License version 1.1 (or subsequent version thereof), as it may
be revised from time to time by Apple (""License"").  As used in this
License:

1.1 ""Affected Original Code"" means only those specific portions of
Original Code that allegedly infringe upon any party's intellectual
property rights or are otherwise the subject of a claim of
infringement.

1.2 ""Applicable Patent Rights"" mean: (a) in the case where Apple is
the grantor of rights, (i) claims of patents that are now or hereafter
acquired, owned by or assigned to Apple and (ii) that cover subject
matter contained in the Original Code, but only to the extent
necessary to use, reproduce and/or distribute the Original Code
without infringement; and (b) in the case where You are the grantor of
rights, (i) claims of patents that are now or hereafter acquired,
owned by or assigned to You and (ii) that cover subject matter in Your
Modifications, taken alone or in combination with Original Code.

1.3 ""Covered Code"" means the Original Code, Modifications, the
combination of Original Code and any Modifications, and/or any
respective portions thereof.

1.4 ""Deploy"" means to use, sublicense or distribute Covered Code other
than for Your internal research and development (R&amp;D), and includes
without limitation, any and all internal use or distribution of
Covered Code within Your business or organization except for R&amp;D use,
as well as direct or indirect sublicensing or distribution of Covered
Code by You to any third party in any form or manner.

1.5 ""Larger Work"" means a work which combines Covered Code or portions
thereof with code not governed by the terms of this License.

1.6 ""Modifications"" mean any addition to, deletion from, and/or change
to, the substance and/or structure of Covered Code.  When code is
released as a series of files, a Modification is: (a) any addition to
or deletion from the contents of a file containing Covered Code;
and/or (b) any new file or other representation of computer program
statements that contains any part of Covered Code.

1.7 ""Original Code"" means (a) the Source Code of a program or other
work as originally made available by Apple under this License,
including the Source Code of any updates or upgrades to such programs
or works made available by Apple under this License, and that has been
expressly identified by Apple as such in the header file(s) of such
work; and (b) the object code compiled from such Source Code and
originally made available by Apple under this License.

1.8 ""Source Code"" means the human readable form of a program or other
work that is suitable for making modifications to it, including all
modules it contains, plus any associated interface definition files,
scripts used to control compilation and installation of an executable
(object code).

1.9 ""You"" or ""Your"" means an individual or a legal entity exercising
rights under this License.  For legal entities, ""You"" or ""Your""
includes any entity which controls, is controlled by, or is under
common control with, You, where ""control"" means (a) the power, direct
or indirect, to cause the direction or management of such entity,
whether by contract or otherwise, or (b) ownership of fifty percent
(50%) or more of the outstanding shares or beneficial ownership of
such entity.

2. Permitted Uses; Conditions &amp; Restrictions.  Subject to the terms
and conditions of this License, Apple hereby grants You, effective on
the date You accept this License and download the Original Code, a
world-wide, royalty-free, non- exclusive license, to the extent of
Apple's Applicable Patent Rights and copyrights covering the Original
Code, to do the following:

2.1 You may use, copy, modify and distribute Original Code, with or
without Modifications, solely for Your internal research and
development, provided that You must in each instance:

(a) retain and reproduce in all copies of Original Code the copyright
and other proprietary notices and disclaimers of Apple as they appear
in the Original Code, and keep intact all notices in the Original
Code that refer to this License;

(b) include a copy of this License with every copy of Source Code of
Covered Code and documentation You distribute, and You may not offer
or impose any terms on such Source Code that alter or restrict this
License or the recipients' rights hereunder, except as permitted under
Section 6; and

(c) completely and accurately document all Modifications that you have
made and the date of each such Modification, designate the version of
the Original Code you used, prominently include a file carrying such
information with the Modifications, and duplicate the notice in
Exhibit A in each file of the Source Code of all such Modifications.

2.2 You may Deploy Covered Code, provided that You must in each
instance:

(a) satisfy all the conditions of Section 2.1 with respect to the
Source Code of the Covered Code;

(b) make all Your Deployed Modifications publicly available in Source
Code form via electronic distribution (e.g. download from a web site)
under the terms of this License and subject to the license grants set
forth in Section 3 below, and any additional terms You may choose to
offer under Section 6.  You must continue to make the Source Code of
Your Deployed Modifications available for as long as you Deploy the
Covered Code or twelve (12) months from the date of initial
Deployment, whichever is longer;

(c) if You Deploy Covered Code containing Modifications made by You,
inform others of how to obtain those Modifications by filling out and
submitting the information found at
http://www.apple.com/publicsource/modifications.html, if available;
and

(d) if You Deploy Covered Code in object code, executable form only,
include a prominent notice, in the code itself as well as in related
documentation, stating that Source Code of the Covered Code is
available under the terms of this License with information on how and
where to obtain such Source Code.

3. Your Grants.  In consideration of, and as a condition to, the
licenses granted to You under this License:

(a) You hereby grant to Apple and all third parties a non-exclusive,
royalty-free license, under Your Applicable Patent Rights and other
intellectual property rights owned or controlled by You, to use,
reproduce, modify, distribute and Deploy Your Modifications of the
same scope and extent as Apple's licenses under Sections 2.1 and 2.2;
and

(b) You hereby grant to Apple and its subsidiaries a non-exclusive,
worldwide, royalty-free, perpetual and irrevocable license, under Your
Applicable Patent Rights and other intellectual property rights owned
or controlled by You, to use, reproduce, execute, compile, display,
perform, modify or have modified (for Apple and/or its subsidiaries),
sublicense and distribute Your Modifications, in any form, through
multiple tiers of distribution.

4. Larger Works.  You may create a Larger Work by combining Covered
Code with other code not governed by the terms of this License and
distribute the Larger Work as a single product.  In each such
instance, You must make sure the requirements of this License are
fulfilled for the Covered Code or any portion thereof.

5. Limitations on Patent License.  Except as expressly stated in
Section 2, no other patent rights, express or implied, are granted by
Apple herein.  Modifications and/or Larger Works may require
additional patent licenses from Apple which Apple may grant in its
sole discretion.

6. Additional Terms.  You may choose to offer, and to charge a fee
for, warranty, support, indemnity or liability obligations and/or
other rights consistent with the scope of the license granted herein
(""Additional Terms"") to one or more recipients of Covered
Code. However, You may do so only on Your own behalf and as Your sole
responsibility, and not on behalf of Apple. You must obtain the
recipient's agreement that any such Additional Terms are offered by
You alone, and You hereby agree to indemnify, defend and hold Apple
harmless for any liability incurred by or claims asserted against
Apple by reason of any such Additional Terms.

7. Versions of the License.  Apple may publish revised and/or new
versions of this License from time to time.  Each version will be
given a distinguishing version number.  Once Original Code has been
published under a particular version of this License, You may continue
to use it under the terms of that version. You may also choose to use
such Original Code under the terms of any subsequent version of this
License published by Apple.  No one other than Apple has the right to
modify the terms applicable to Covered Code created under this
License.

8. NO WARRANTY OR SUPPORT.  The Original Code may contain in whole or
part pre-release, untested, or not fully tested works.  The Original
Code may contain errors that could cause failures or loss of data, and
may be incomplete or contain inaccuracies.  You expressly acknowledge
and agree that use of the Original Code, or any portion thereof, is at
Your sole and entire risk.  THE ORIGINAL CODE IS PROVIDED ""AS IS"" AND
WITHOUT WARRANTY, UPGRADES OR SUPPORT OF ANY KIND AND APPLE AND APPLE'S
LICENSOR(S) (FOR THE PURPOSES OF SECTIONS 8 AND 9, APPLE AND APPLE'S
LICENSOR(S) ARE COLLECTIVELY REFERRED TO AS ""APPLE"") EXPRESSLY DISCLAIM
ALL WARRANTIES AND/OR CONDITIONS, EXPRESS OR IMPLIED, INCLUDING, BUT
NOT LIMITED TO, THE IMPLIED WARRANTIES AND/OR CONDITIONS OF
MERCHANTABILITY OR SATISFACTORY QUALITY AND FITNESS FOR A PARTICULAR
PURPOSE AND NONINFRINGEMENT OF THIRD PARTY RIGHTS.  APPLE DOES NOT
WARRANT THAT THE FUNCTIONS CONTAINED IN THE ORIGINAL CODE WILL MEET
YOUR REQUIREMENTS, OR THAT THE OPERATION OF THE ORIGINAL CODE WILL BE
UNINTERRUPTED OR ERROR - FREE, OR THAT DEFECTS IN THE ORIGINAL CODE
WILL BE CORRECTED.  NO ORAL OR WRITTEN INFORMATION OR ADVICE GIVEN BY
APPLE OR AN APPLE AUTHORIZED REPRESENTATIVE SHALL CREATE A WARRANTY OR
IN ANY WAY INCREASE THE SCOPE OF THIS WARRANTY.  You acknowledge that
the Original Code is not intended for use in the operation of nuclear
facilities, aircraft navigation, communication systems, or air traffic
control machines in which case the failure of the Original Code could
lead to death, personal injury, or severe physical or environmental
damage.

9. Liability.

9.1 Infringement.  If any portion of, or functionality implemented by,
the Original Code becomes the subject of a claim of infringement,
Apple may, at its option: (a) attempt to procure the rights necessary
for Apple and You to continue using the Affected Original Code; (b)
modify the Affected Original Code so that it is no longer infringing;
or (c) suspend Your rights to use, reproduce, modify, sublicense and
distribute the Affected Original Code until a final determination of
the claim is made by a court or governmental administrative agency of
competent jurisdiction and Apple lifts the suspension as set forth
below.  Such suspension of rights will be effective immediately upon
Apple's posting of a notice to such effect on the Apple web site that
is used for implementation of this License.  Upon such final
determination being made, if Apple is legally able, without the
payment of a fee or royalty, to resume use, reproduction,
modification, sublicensing and distribution of the Affected Original
Code, Apple will lift the suspension of rights to the Affected Original
Code by posting a notice to such effect on the Apple web site that is
used for implementation of this License.  If Apple suspends Your rights
to Affected Original Code, nothing in this License shall be construed
to restrict You, at Your option and subject to applicable law, from
replacing the Affected Original Code with non-infringing code or
independently negotiating for necessary rights from such third party.

9.2 LIMITATION OF LIABILITY.  UNDER NO CIRCUMSTANCES SHALL APPLE BE
LIABLE FOR ANY INCIDENTAL, SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES
ARISING OUT OF OR RELATING TO THIS LICENSE OR YOUR USE OR INABILITY TO
USE THE ORIGINAL CODE, OR ANY PORTION THEREOF, WHETHER UNDER A THEORY OF
CONTRACT, WARRANTY, TORT (INCLUDING NEGLIGENCE), PRODUCTS LIABILITY OR
OTHERWISE, EVEN IF APPLE HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH
DAMAGES AND NOTWITHSTANDING THE FAILURE OF ESSENTIAL PURPOSE OF ANY
REMEDY.  In no event shall Apple's total liability to You for all
damages under this License exceed the amount of fifty dollars
($50.00).

10. Trademarks.  This License does not grant any rights to use the
trademarks or trade names ""Apple"", ""Apple Computer"", ""Mac OS X"",
""Mac OS X Server"" or any other trademarks or trade names belonging to
Apple (collectively ""Apple Marks"") and no Apple Marks may be used to
endorse or promote products derived from the Original Code other than
as permitted by and in strict compliance at all times with Apple's
third party trademark usage guidelines which are posted at
http://www.apple.com/legal/guidelinesfor3rdparties.html.

11. Ownership.  Apple retains all rights, title and interest in and to
the Original Code and any Modifications made by or on behalf of Apple
(""Apple Modifications""), and such Apple Modifications will not be
automatically subject to this License.  Apple may, at its sole
discretion, choose to license such Apple Modifications under this
License, or on different terms from those contained in this"
79,80,NomosTestfiles/APSL/APSL-1.2.txt,APSL-1.2,"Apple Public Source License Ver. 1.2

1. General; Definitions. This License applies to any program or other work which Apple Computer, Inc. (""Apple"") makes publicly available and which contains a notice placed by Apple identifying such program or work as ""Original Code"" and stating that it is subject to the terms of this Apple Public Source License version 1.2 (or subsequent version thereof) (""License""). As used in this License:

1.1 ""Applicable Patent Rights"" mean: (a) in the case where Apple is the grantor of rights, (i) claims of patents that are now or hereafter acquired, owned by or assigned to Apple and (ii) that cover subject matter contained in the Original Code, but only to the extent necessary to use, reproduce and/or distribute the Original Code without infringement; and (b) in the case where You are the grantor of rights, (i) claims of patents that are now or hereafter acquired, owned by or assigned to You and (ii) that cover subject matter in Your Modifications, taken alone or in combination with Original Code.

1.2 ""Contributor"" means any person or entity that creates or contributes to the creation of Modifications.

1.3 ""Covered Code"" means the Original Code, Modifications, the combination of Original Code and any Modifications, and/or any respective portions thereof.

1.4 ""Deploy"" means to use, sublicense or distribute Covered Code other than for Your internal research and development (R&amp;D) and/or Personal Use, and includes without limitation, any and all internal use or distribution of Covered Code within Your business or organization except for R&amp;D use and/or Personal Use, as well as direct or indirect sublicensing or distribution of Covered Code by You to any third party in any form or manner.

1.5 ""Larger Work"" means a work which combines Covered Code or portions thereof with code not governed by the terms of this License.

1.6 ""Modifications"" mean any addition to, deletion from, and/or change to, the substance and/or structure of the Original Code, any previous Modifications, the combination of Original Code and any previous Modifications, and/or any respective portions thereof. When code is released as a series of files, a Modification is: (a) any addition to or deletion from the contents of a file containing Covered Code; and/or (b) any new file or other representation of computer program statements that contains any part of Covered Code.

1.7 ""Original Code"" means (a) the Source Code of a program or other work as originally made available by Apple under this License, including the Source Code of any updates or upgrades to such programs or works made available by Apple under this License, and that has been expressly identified by Apple as such in the header file(s) of such work; and (b) the object code compiled from such Source Code and originally made available by Apple under this License.

1.8 ""Personal Use"" means use of Covered Code by an individual solely for his or her personal, private and non-commercial purposes. An individual's use of Covered Code in his or her capacity as an officer, employee, member, independent contractor or agent of a corporation, business or organization (commercial or non-commercial) does not qualify as Personal Use.

1.9 ""Source Code"" means the human readable form of a program or other work that is suitable for making modifications to it, including all modules it contains, plus any associated interface definition files, scripts used to control compilation and installation of an executable (object code).

1.10 ""You"" or ""Your"" means an individual or a legal entity exercising rights under this License. For legal entities, ""You"" or ""Your"" includes any entity which controls, is controlled by, or is under common control with, You, where ""control"" means (a) the power, direct or indirect, to cause the direction or management of such entity, whether by contract or otherwise, or (b) ownership of fifty percent (50%) or more of the outstanding shares or beneficial ownership of such entity.

2. Permitted Uses; Conditions &amp; Restrictions.Subject to the terms and conditions of this License, Apple hereby grants You, effective on the date You accept this License and download the Original Code, a world-wide, royalty-free, non-exclusive license, to the extent of Apple's Applicable Patent Rights and copyrights covering the Original Code, to do the following:

2.1 You may use, reproduce, display, perform, modify and distribute Original Code, with or without Modifications, solely for Your internal research and development and/or Personal Use, provided that in each instance:

(a) You must retain and reproduce in all copies of Original Code the copyright and other proprietary notices and disclaimers of Apple as they appear in the Original Code, and keep intact all notices in the Original Code that refer to this License; and

(b) You must include a copy of this License with every copy of Source Code of Covered Code and documentation You distribute, and You may not offer or impose any terms on such Source Code that alter or restrict this License or the recipients' rights hereunder, except as permitted under Section 6.

2.2 You may use, reproduce, display, perform, modify and Deploy Covered Code, provided that in each instance:

(a) You must satisfy all the conditions of Section 2.1 with respect to the Source Code of the Covered Code;

(b) You must duplicate, to the extent it does not already exist, the notice in Exhibit A in each file of the Source Code of all Your Modifications, and cause the modified files to carry prominent notices stating that You changed the files and the date of any change;

(c) You must make Source Code of all Your Deployed Modifications publicly available under the terms of this License, including the license grants set forth in Section 3 below, for as long as you Deploy the Covered Code or twelve (12) months from the date of initial Deployment, whichever is longer. You should preferably distribute the Source Code of Your Deployed Modifications electronically (e.g. download from a web site); and

(d) if You Deploy Covered Code in object code, executable form only, You must include a prominent notice, in the code itself as well as in related documentation, stating that Source Code of the Covered Code is available under the terms of this License with information on how and where to obtain such Source Code.

2.3 You expressly acknowledge and agree that although Apple and each Contributor grants the licenses to their respective portions of the Covered Code set forth herein, no assurances are provided by Apple or any Contributor that the Covered Code does not infringe the patent or other intellectual property rights of any other entity. Apple and each Contributor disclaim any liability to You for claims brought by any other entity based on infringement of intellectual property rights or otherwise. As a condition to exercising the rights and licenses granted hereunder, You hereby assume sole responsibility to secure any other intellectual property rights needed, if any. For example, if a third party patent license is required to allow You to distribute the Covered Code, it is Your responsibility to acquire that license before distributing the Covered Code.

3. Your Grants. In consideration of, and as a condition to, the licenses granted to You under this License:

(a) You hereby grant to Apple and all third parties a non-exclusive, royalty-free license, under Your Applicable Patent Rights and other intellectual property rights (other than patent) owned or controlled by You, to use, reproduce, display, perform, modify, distribute and Deploy Your Modifications of the same scope and extent as Apple's licenses under Sections 2.1 and 2.2; and

(b) You hereby grant to Apple and its subsidiaries a non-exclusive, worldwide, royalty-free, perpetual and irrevocable license, under Your Applicable Patent Rights and other intellectual property rights (other than patent) owned or controlled by You, to use, reproduce, display, perform, modify or have modified (for Apple and/or its subsidiaries), sublicense and distribute Your Modifications, in any form, through multiple tiers of distribution.

4. Larger Works. You may create a Larger Work by combining Covered Code with other code not governed by the terms of this License and distribute the Larger Work as a single product. In each such instance, You must make sure the requirements of this License are fulfilled for the Covered Code or any portion thereof.

5. Limitations on Patent License. Except as expressly stated in Section 2, no other patent rights, express or implied, are granted by Apple herein. Modifications and/or Larger Works may require additional patent licenses from Apple which Apple may grant in its sole discretion.

6. Additional Terms. You may choose to offer, and to charge a fee for, warranty, support, indemnity or liability obligations and/or other rights consistent with the scope of the license granted herein (""Additional Terms"") to one or more recipients of Covered Code. However, You may do so only on Your own behalf and as Your sole responsibility, and not on behalf of Apple or any Contributor. You must obtain the recipient's agreement that any such Additional Terms are offered by You alone, and You hereby agree to indemnify, defend and hold Apple and every Contributor harmless for any liability incurred by or claims asserted against Apple or such Contributor by reason of any such Additional Terms.

7. Versions of the License. Apple may publish revised and/or new versions of this License from time to time. Each version will be given a distinguishing version number. Once Original Code has been published under a particular version of this License, You may continue to use it under the terms of that version. You may also choose to use such Original Code under the terms of any subsequent version of this License published by Apple. No one other than Apple has the right to modify the terms applicable to Covered Code created under this License.

8. NO WARRANTY OR SUPPORT. The Covered Code may contain in whole or in part pre-release, untested, or not fully tested works. The Covered Code may contain errors that could cause failures or loss of data, and may be incomplete or contain inaccuracies. You expressly acknowledge and agree that use of the Covered Code, or any portion thereof, is at Your sole and entire risk. THE COVERED CODE IS PROVIDED ""AS IS"" AND WITHOUT WARRANTY, UPGRADES OR SUPPORT OF ANY KIND AND APPLE AND APPLE'S LICENSOR(S) (COLLECTIVELY REFERRED TO AS ""APPLE"" FOR THE PURPOSES OF SECTIONS 8 AND 9) AND ALL CONTRIBUTORS EXPRESSLY DISCLAIM ALL WARRANTIES AND/OR CONDITIONS, EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES AND/OR CONDITIONS OF MERCHANTABILITY, OF SATISFACTORY QUALITY, OF FITNESS FOR A PARTICULAR PURPOSE, OF ACCURACY, OF QUIET ENJOYMENT, AND NONINFRINGEMENT OF THIRD PARTY RIGHTS. APPLE AND EACH CONTRIBUTOR DOES NOT WARRANT AGAINST INTERFERENCE WITH YOUR ENJOYMENT OF THE COVERED CODE, THAT THE FUNCTIONS CONTAINED IN THE COVERED CODE WILL MEET YOUR REQUIREMENTS, THAT THE OPERATION OF THE COVERED CODE WILL BE UNINTERRUPTED OR ERROR-FREE, OR THAT DEFECTS IN THE COVERED CODE WILL BE CORRECTED. NO ORAL OR WRITTEN INFORMATION OR ADVICE GIVEN BY APPLE, AN APPLE AUTHORIZED REPRESENTATIVE OR ANY CONTRIBUTOR SHALL CREATE A WARRANTY. You acknowledge that the Covered Code is not intended for use in the operation of nuclear facilities, aircraft navigation, communication systems, or air traffic control machines in which case the failure of the Covered Code could lead to death, personal injury, or severe physical or environmental damage.

9. LIMITATION OF LIABILITY. TO THE EXTENT NOT PROHIBITED BY LAW, IN NO EVENT SHALL APPLE OR ANY CONTRIBUTOR BE LIABLE FOR ANY INCIDENTAL, SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES ARISING OUT OF OR RELATING TO THIS LICENSE OR YOUR USE OR INABILITY TO USE THE COVERED CODE, OR ANY PORTION THEREOF, WHETHER UNDER A THEORY OF CONTRACT, WARRANTY, TORT (INCLUDING NEGLIGENCE), PRODUCTS LIABILITY OR OTHERWISE, EVEN IF APPLE OR SUCH CONTRIBUTOR HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES AND NOTWITHSTANDING THE FAILURE OF ESSENTIAL PURPOSE OF ANY REMEDY. SOME JURISDICTIONS DO NOT ALLOW THE LIMITATION OF LIABILITY OF INCIDENTAL OR CONSEQUENTIAL DAMAGES, SO THIS LIMITATION MAY NOT APPLY TO YOU. In no event shall Apple's total liability to You for all damages (other than as may be required by applicable law) under this License exceed the amount of fifty dollars ($50.00).

10. Trademarks. This License does not grant any rights to use the trademarks or trade names ""Apple"", ""Apple Computer"", ""Mac OS X"", ""Mac OS X Server"", ""QuickTime"", ""QuickTime Streaming Server"" or any other trademarks or trade names belonging to Apple (collectively ""Apple Marks"") or to any trademark or trade name belonging to any Contributor. No Apple Marks may be used to endorse or promote products derived from the Original Code other than as permitted by and in strict compliance at all times with Apple's third party trademark usage guidelines which are posted at http://www.apple.com/legal/guidelinesfor3rdparties.html.

11. Ownership. Subject to the licenses granted under this License, each Contributor retains all rights, title and interest in and to any Modifications made by such Contributor. Apple retains all rights, title and interest in and to the Original Code and any Modifications made by or on behalf of Apple (""Apple Modifications""), and such Apple Modifications will not be automatically subject to this License. Apple may, at its sole discretion, choose to license such Apple Modifications under this License, or on different terms from those contained in this License or may choose not to license them at all.

12. Termination.

12.1 Termination. This License and the rights granted hereunder will terminate:

(a) automatically without notice from Apple if You fail to comply with any term(s) of this License and fail to cure such breach within 30 days of becoming aware of such breach;

(b) immediately in the event of the circumstances described in Section 13.5(b); or

(c) automatically without notice from Apple if You, at any time during the term of this License, commence an action for patent infringement against Apple.

12.2 Effect of Termination. Upon termination, You agree to immediately stop any further use, reproduction, modification, sublicensing and distribution of the Covered Code and to destroy all copies of the Covered Code that are in your possession or control. All sublicenses to the Covered Code which have been properly granted prior to termination shall survive any termination of this License. Provisions which, by their nature, should remain in effect beyond the termination of this License shall survive, including but not limited to Sections 3, 5, 8, 9, 10, 11, 12.2 and 13. No party will be liable to any other for compensation, indemnity or damages of any sort solely as a result of terminating this License in accordance with its terms, and termination of this License will be without prejudice to any other right or remedy of any party.

13. Miscellaneous.

13.1 Government End Users. The Covered Code is a ""commercial item"" as defined in FAR 2.101. Government software and technical data rights in the Covered Code include only those rights customarily provided to the public as defined in this License. This customary commercial license in technical data and software is provided in accordance with FAR 12.211 (Technical Data) and 12.212 (Computer Software) and, for Department of Defense purchases, DFAR 252.227-7015 (Technical Data -- Commercial Items) and 227.7202-3 (Rights in Commercial Computer Software or Computer Software Documentation). Accordingly, all U.S. Government End Users acquire Covered Code with only those rights set forth herein.

13.2 Relationship of Parties. This License will not be construed as creating an agency, partnership, joint venture or any other form of legal association between or amongYou, Apple or any Contributor, and You will not represent to the contrary, whether expressly, by implication, appearance or otherwise.

13.3 Independent Development. Nothing in this License will impair Apple's right to acquire, license, develop, have others develop for it, market and/or distribute technology or products that perform the same or similar functions as, or otherwise compete with, Modifications, Larger Works, technology or products that You may develop, produce, market or distribute.

13.4 Waiver; Construction. Failure by Apple or any Contributor to enforce any provision of this License will not be deemed a waiver of future enforcement of that or any other provision. Any law or regulation which provides that the language of a contract shall be construed against the drafter will not apply to this License.

13.5 Severability. (a) If for any reason a court of competent jurisdiction finds any provision of this License, or portion thereof, to be unenforceable, that provision of the License will be enforced to the maximum extent permissible so as to effect the economic benefits and intent of the parties, and the remainder of this License will continue in full force and effect. (b) Notwithstanding the foregoing, if applicable law prohibits or restricts You from fully and/or specifically complying with Sections 2 and/or 3 or prevents the enforceability of either of those Sections, this License will immediately terminate and You must immediately discontinue any use of the Covered Code and destroy all copies of it that are in your possession or control.

13.6 Dispute Resolution. Any litigation or other dispute resolution between You and Apple relating to this License shall take place in the Northern District of California, and You and Apple hereby consent to the personal jurisdiction of, and venue in, the state and federal courts within that District with respect to this License. The application of the United Nations Convention on Contracts for the International Sale of Goods is expressly excluded.

13.7 Entire Agreement; Governing Law. This License constitutes the entire agreement between the parties with respect to the subject matter hereof. This License shall be governed by the laws of the United States and the State of California, except that body of California law concerning conflicts of law.

Where You are located in the province of Quebec, Canada, the following clause applies: The parties hereby confirm that they have requested that this License and all related documents be drafted in English. Les parties ont exigé que le présent contrat et tous les documents connexes soient rédigés en anglais.

EXHIBIT A.

""Portions Copyright (c) 1999-2001 Apple Computer, Inc. All Rights Reserved.

This file contains Original Code and/or Modifications of Original Code as defined in and that are subject to the Apple Public Source License Version 1.2 (the 'License'). You may not use this file except in compliance with the License. Please obtain a copy of the License at http://www.apple.com/publicsource and read it before using this file.

The Original Code and all software distributed under the License are distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES, INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT. Please see the License for the specific language governing rights and limitations under the License.""
",False,"```
Apple Public Source License Ver. 1.2

1. General; Definitions. This License applies to any program or other work which Apple Computer, Inc. (""Apple"") makes publicly available and which contains a notice placed by Apple identifying such program or work as ""Original Code"" and stating that it is subject to the terms of this Apple Public Source License version 1.2 (or subsequent version thereof) (""License""). As used in this License:

1.1 ""Applicable Patent Rights"" mean: (a) in the case where Apple is the grantor of rights, (i) claims of patents that are now or hereafter acquired, owned by or assigned to Apple and (ii) that cover subject matter contained in the Original Code, but only to the extent necessary to use, reproduce and/or distribute the Original Code without infringement; and (b) in the case where You are the grantor of rights, (i) claims of patents that are now or hereafter acquired, owned by or assigned to You and (ii) that cover subject matter in Your Modifications, taken alone or in combination with Original Code.

1.2 ""Contributor"" means any person or entity that creates or contributes to the creation of Modifications.

1.3 ""Covered Code"" means the Original Code, Modifications, the combination of Original Code and any Modifications, and/or any respective portions thereof.

1.4 ""Deploy"" means to use, sublicense or distribute Covered Code other than for Your internal research and development (R&D) and/or Personal Use, and includes without limitation, any and all internal use or distribution of Covered Code within Your business or organization except for R&D use and/or Personal Use, as well as direct or indirect sublicensing or distribution of Covered Code by You to any third party in any form or manner.

1.5 ""Larger Work"" means a work which combines Covered Code or portions thereof with code not governed by the terms of this License.

1.6 ""Modifications"" mean any addition to, deletion from, and/or change to, the substance and/or structure of the Original Code, any previous Modifications, the combination of Original Code and any previous Modifications, and/or any respective portions thereof. When code is released as a series of files, a Modification is: (a) any addition to or deletion from the contents of a file containing Covered Code; and/or (b) any new file or other representation of computer program statements that contains any part of Covered Code.

1.7 ""Original Code"" means (a) the Source Code of a program or other work as originally made available by Apple under this License, including the Source Code of any updates or upgrades to such programs or works made available by Apple under this License, and that has been expressly identified by Apple as such in the header file(s) of such work; and (b) the object code compiled from such Source Code and originally made available by Apple under this License.

1.8 ""Personal Use"" means use of Covered Code by an individual solely for his or her personal, private and non-commercial purposes. An individual's use of Covered Code in his or her capacity as an officer, employee, member, independent contractor or agent of a corporation, business or organization (commercial or non-commercial) does not qualify as Personal Use.

1.9 ""Source Code"" means the human readable form of a program or other work that is suitable for making modifications to it, including all modules it contains, plus any associated interface definition files, scripts used to control compilation and installation of an executable (object code).

1.10 ""You"" or ""Your"" means an individual or a legal entity exercising rights under this License. For legal entities, ""You"" or ""Your"" includes any entity which controls, is controlled by, or is under common control with, You, where ""control"" means (a) the power, direct or indirect, to cause the direction or management of such entity, whether by contract or otherwise, or (b) ownership of fifty percent (50%) or more of the outstanding shares or beneficial ownership of such entity.

2. Permitted Uses; Conditions &amp; Restrictions.Subject to the terms and conditions of this License, Apple hereby grants You, effective on the date You accept this License and download the Original Code, a world-wide, royalty-free, non-exclusive license, to the extent of Apple's Applicable Patent Rights and copyrights covering the Original Code, to do the following:

2.1 You may use, reproduce, display, perform, modify and distribute Original Code, with or without Modifications, solely for Your internal research and development and/or Personal Use, provided that in each instance:

(a) You must retain and reproduce in all copies of Original Code the copyright and other proprietary notices and disclaimers of Apple as they appear in the Original Code, and keep intact all notices in the Original Code that refer to this License; and

(b) You must include a copy of this License with every copy of Source Code of Covered Code and documentation You distribute, and You may not offer or impose any terms on such Source Code that alter or restrict this License or the recipients' rights hereunder, except as permitted under Section 6.

2.2 You may use, reproduce, display, perform, modify and Deploy Covered Code, provided that in each instance:

(a) You must satisfy all the conditions of Section 2.1 with respect to the Source Code of the Covered Code;

(b) You must duplicate, to the extent it does not already exist, the notice in Exhibit A in each file of the Source Code of all Your Modifications, and cause the modified files to carry prominent notices stating that You changed the files and the date of any change;

(c) You must make Source Code of all Your Deployed Modifications publicly available under the terms of this License, including the license grants set forth in Section 3 below, for as long as you Deploy the Covered Code or twelve (12) months from the date of initial Deployment, whichever is longer. You should preferably distribute the Source Code of Your Deployed Modifications electronically (e.g. download from a web site); and

(d) if You Deploy Covered Code in object code, executable form only, You must include a prominent notice, in the code itself as well as in related documentation, stating that Source Code of the Covered Code is available under the terms of this License with information on how and where to obtain such Source Code.

2.3 You expressly acknowledge and agree that although Apple and each Contributor grants the licenses to their respective portions of the Covered Code set forth herein, no assurances are provided by Apple or any Contributor that the Covered Code does not infringe the patent or other intellectual property rights of any other entity. Apple and each Contributor disclaim any liability to You for claims brought by any other entity based on infringement of intellectual property rights or otherwise. As a condition to exercising the rights and licenses granted hereunder, You hereby assume sole responsibility to secure any other intellectual property rights needed, if any. For example, if a third party patent license is required to allow You to distribute the Covered Code, it is Your responsibility to acquire that license before distributing the Covered Code.

3. Your Grants. In consideration of, and as a condition to, the licenses granted to You under this License:

(a) You hereby grant to Apple and all third parties a non-exclusive, royalty-free license, under Your Applicable Patent Rights and other intellectual property rights (other than patent) owned or controlled by You, to use, reproduce, display, perform, modify, distribute and Deploy Your Modifications of the same scope and extent as Apple's licenses under Sections 2.1 and 2.2; and

(b) You hereby grant to Apple and its subsidiaries a non-exclusive, worldwide, royalty-free, perpetual and irrevocable license, under Your Applicable Patent Rights and other intellectual property rights (other than patent) owned or controlled by You, to use, reproduce, display, perform, modify or have modified (for Apple and/or its subsidiaries), sublicense and distribute Your Modifications, in any form, through multiple tiers of distribution.

4. Larger Works. You may create a Larger Work by combining Covered Code with other code not governed by the terms of this License and distribute the Larger Work as a single product. In each such instance, You must make sure the requirements of this License are fulfilled for the Covered Code or any portion thereof.

5. Limitations on Patent License. Except as expressly stated in Section 2, no other patent rights, express or implied, are granted by Apple herein. Modifications and/or Larger Works may require additional patent licenses from Apple which Apple may grant in its sole discretion.

6. Additional Terms. You may choose to offer, and to charge a fee for, warranty, support, indemnity or liability obligations and/or other rights consistent with the scope of the license granted herein (""Additional Terms"") to one or more recipients of Covered Code. However, You may do so only on Your own behalf and as Your sole responsibility, and not on behalf of Apple or any Contributor. You must obtain the recipient's agreement that any such Additional Terms are offered by You alone, and You hereby agree to indemnify, defend and hold Apple and every Contributor harmless for any liability incurred by or claims asserted against Apple or such Contributor by reason of any such Additional Terms.

7. Versions of the License. Apple may publish revised and/or new versions of this License from time to time. Each version will be given a distinguishing version number. Once Original Code has been published under a particular version of this License, You may continue to use it under the terms of that version. You may also choose to use such Original Code under the terms of any subsequent version of this License published by Apple. No one other than Apple has the right to modify the terms applicable to Covered Code created under this License.

8. NO WARRANTY OR SUPPORT. The Covered Code may contain in whole or in part pre-release, untested, or not fully tested works. The Covered Code may contain errors that could cause failures or loss of data, and may be incomplete or contain inaccuracies. You expressly acknowledge and agree that use of the Covered Code, or any portion thereof, is at Your sole and entire risk. THE COVERED CODE IS PROVIDED ""AS IS"" AND WITHOUT WARRANTY, UPGRADES OR SUPPORT OF ANY KIND AND APPLE AND APPLE'S LICENSOR(S) (COLLECTIVELY REFERRED TO AS ""APPLE"" FOR THE PURPOSES OF SECTIONS 8 AND 9) AND ALL CONTRIBUTORS EXPRESSLY DISCLAIM ALL WARRANTIES AND/OR CONDITIONS, EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES AND/OR CONDITIONS OF MERCHANTABILITY, OF SATISFACTORY QUALITY, OF FITNESS FOR A PARTICULAR PURPOSE, OF ACCURACY, OF QUIET ENJOYMENT, AND NONINFRINGEMENT OF THIRD PARTY RIGHTS. APPLE AND EACH CONTRIBUTOR DOES NOT WARRANT AGAINST INTERFERENCE WITH YOUR ENJOYMENT OF THE COVERED CODE, THAT THE FUNCTIONS CONTAINED IN THE COVERED CODE WILL MEET YOUR REQUIREMENTS, THAT THE OPERATION OF THE COVERED CODE WILL BE UNINTERRUPTED OR ERROR-FREE, OR THAT DEFECTS IN THE COVERED CODE WILL BE CORRECTED. NO ORAL OR WRITTEN INFORMATION OR ADVICE GIVEN BY APPLE, AN APPLE AUTHORIZED REPRESENTATIVE OR ANY CONTRIBUTOR SHALL CREATE A WARRANTY. You acknowledge that the Covered Code is not intended for use in the operation of nuclear facilities, aircraft navigation, communication systems, or air traffic control machines in which case the failure of the Covered Code could lead to death, personal injury, or severe physical or environmental damage.

9. LIMITATION OF LIABILITY. TO THE EXTENT NOT PROHIBITED BY LAW, IN NO EVENT SHALL APPLE OR ANY CONTRIBUTOR BE LIABLE FOR ANY INCIDENTAL, SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES ARISING OUT OF OR RELATING TO THIS LICENSE OR YOUR USE OR INABILITY TO USE THE COVERED CODE, OR ANY PORTION THEREOF, WHETHER UNDER A THEORY OF CONTRACT, WARRANTY, TORT (INCLUDING NEGLIGENCE), PRODUCTS LIABILITY OR OTHERWISE, EVEN IF APPLE OR SUCH CONTRIBUTOR HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES AND NOTWITHSTANDING THE FAILURE OF ESSENTIAL PURPOSE OF ANY REMEDY. SOME JURISDICTIONS DO NOT ALLOW THE LIMITATION OF LIABILITY OF INCIDENTAL OR CONSEQUENTIAL DAMAGES, SO THIS LIMITATION MAY NOT APPLY TO YOU. In no event shall Apple's total liability to You for all damages (other than as may be required by applicable law) under this License exceed the amount of fifty dollars ($50.00).

10. Trademarks. This License does not grant any rights to use the trademarks or trade names ""Apple"", ""Apple Computer"", ""Mac OS X"", ""Mac OS X Server"", ""QuickTime"", ""QuickTime Streaming Server"" or any other trademarks or trade names belonging to Apple (collectively ""Apple Marks"") or to any trademark or trade name belonging to any Contributor. No Apple Marks may be used to endorse or promote products derived from the Original Code other than as permitted by and in strict compliance at all times with Apple's third party trademark usage guidelines which are posted at http://www.apple.com/legal/guidelinesfor3rdparties.html.

11. Ownership. Subject to the licenses granted under this License, each Contributor retains all rights, title and interest in and to any Modifications made by such Contributor. Apple retains all rights, title and interest in and to the Original Code and any Modifications made by or on behalf of Apple (""Apple Modifications""), and such Apple Modifications will not be automatically subject to this License. Apple may, at its sole discretion, choose to license such Apple Modifications under this License, or on different terms from those contained in this License or may choose not to license them at all.

12. Termination.

12.1 Termination. This License and the rights granted hereunder will terminate:

(a) automatically without notice from Apple if You fail to comply with any term(s) of this License and fail to cure such breach within 30 days of becoming aware of such breach;

(b) immediately in the event of the circumstances described in Section 13.5(b); or

(c) automatically without notice from Apple if You, at any time during the term of this License, commence an action for patent infringement against Apple.

12.2 Effect of Termination. Upon termination, You agree to immediately stop any further use, reproduction, modification, sublicensing and distribution of the Covered Code and to destroy all copies of the Covered Code that are in your possession or control. All sublicenses to the Covered Code which have been properly granted prior to termination shall survive any termination of this License. Provisions which, by their nature, should remain in effect beyond the termination of this License shall survive, including but not limited to Sections 3, 5, 8, 9, 10, 11, 12.2 and 13. No party will be liable to any other for compensation, indemnity or damages of any sort solely as a result of terminating this License in accordance with its terms, and termination of this License will be without prejudice to any other right or remedy of any party.

13. Miscellaneous.

13.1 Government End Users. The Covered Code is a ""commercial item"" as defined in FAR 2.101. Government software and technical data rights in the Covered Code include only those rights customarily provided to the public as defined in this License. This customary commercial license in technical data and software is provided in accordance with FAR 12.211 (Technical Data) and 12.212 (Computer Software) and, for Department of Defense purchases, DFAR 252.227-7015 (Technical Data -- Commercial Items) and 227.7202-3 (Rights in Commercial Computer Software or Computer Software Documentation). Accordingly, all U.S. Government End Users acquire Covered Code with only those rights set forth herein.

13.2 Relationship of Parties. This License will not be construed as creating an agency, partnership, joint venture or any other form of legal association between or amongYou, Apple or any Contributor, and You will not represent to the contrary, whether expressly, by implication, appearance or otherwise.

13.3 Independent Development. Nothing in this License will impair Apple's right to acquire, license, develop, have others develop for it, market and/or distribute technology or products that perform the same or similar functions as, or otherwise compete with, Modifications, Larger Works, technology or products that You may develop, produce, market or distribute.

13.4 Waiver; Construction. Failure by Apple or any Contributor to enforce any provision of this License will not be deemed a waiver of future enforcement of that or any other provision. Any law or regulation which provides that the language of a contract shall be construed against the drafter will not apply to this License.

13.5 Severability. (a) If for any reason"
80,81,NomosTestfiles/APSL/APSL-2.0.txt,APSL-2.0,"APPLE PUBLIC SOURCE LICENSE
Version 2.0 -  August 6, 2003

Please read this License carefully before downloading this software.  By downloading or using this software, you are agreeing to be bound by the terms of this License.  If you do not or cannot agree to the terms of this License, please do not download or use the software.

Apple Note:  In January 2007, Apple changed its corporate name from ""Apple Computer, Inc."" to ""Apple Inc.""  This change has been reflected below and copyright years updated, but no other changes have been made to the APSL 2.0.

1. General; Definitions.  This License applies to any program or other work which Apple Inc. (""Apple"") makes publicly available and which contains a notice placed by Apple identifying such program or work as ""Original Code"" and stating that it is subject to the terms of this Apple Public Source License version 2.0 (""License"").  As used in this License:

1.1  ""Applicable Patent Rights"" mean:  (a) in the case where Apple is the grantor of rights, (i) claims of patents that are now or hereafter acquired, owned by or assigned to Apple and (ii) that cover subject matter contained in the Original Code, but only to the extent necessary to use, reproduce and/or distribute the Original Code without infringement; and (b) in the case where You are the grantor of rights, (i) claims of patents that are now or hereafter acquired, owned by or assigned to You and (ii) that cover subject matter in Your Modifications, taken alone or in combination with Original Code.

1.2 ""Contributor"" means any person or entity that creates or contributes to the creation of Modifications.

1.3  ""Covered Code"" means the Original Code, Modifications, the combination of Original Code and any Modifications, and/or any respective portions thereof.

1.4 ""Externally Deploy"" means: (a) to sublicense, distribute or otherwise make Covered Code available, directly or indirectly, to anyone other than You; and/or (b) to use Covered Code, alone or as part of a Larger Work, in any way to provide a service, including but not limited to delivery of content, through electronic communication with a client other than You.

1.5 ""Larger Work"" means a work which combines Covered Code or portions thereof with code not governed by the terms of this License.

1.6 ""Modifications"" mean any addition to, deletion from, and/or change to, the substance and/or structure of the Original Code, any previous Modifications, the combination of Original Code and any previous Modifications, and/or any respective portions thereof.  When code is released as a series of files, a Modification is:  (a) any addition to or deletion from the contents of a file containing Covered Code; and/or (b) any new file or other representation of computer program statements that contains any part of Covered Code. 

1.7 ""Original Code"" means (a) the Source Code of a program or other work as originally made available by Apple under this License, including the Source Code of any updates or upgrades to such programs or works made available by Apple under this License, and that has been expressly identified by Apple as such in the header file(s) of such work; and (b) the object code compiled from such Source Code and originally made available by Apple under this License

1.8 ""Source Code"" means the human readable form of a program or other work that is suitable for making modifications to it, including all modules it contains, plus any associated interface definition files, scripts used to control compilation and installation of an executable (object code).

1.9 ""You"" or ""Your"" means an individual or a legal entity exercising rights under this License.  For legal entities, ""You"" or ""Your"" includes any entity which controls, is controlled by, or is under common control with, You, where ""control"" means (a) the power, direct or indirect, to cause the direction or management of such entity, whether by contract or otherwise, or (b) ownership of fifty percent (50%) or more of the outstanding shares or beneficial ownership of such entity.

2. Permitted Uses; Conditions &amp; Restrictions.   Subject to the terms and conditions of this License, Apple hereby grants You, effective on the date You accept this License and download the Original Code, a world-wide, royalty-free, non-exclusive license, to the extent of Apple's Applicable Patent Rights and copyrights covering the Original Code, to do the following:

2.1 Unmodified Code.  You may use, reproduce, display, perform, internally distribute within Your organization, and Externally Deploy verbatim, unmodified copies of the Original Code, for commercial or non-commercial purposes, provided that in each instance:

(a) You must retain and reproduce in all copies of Original Code the copyright and other proprietary notices and disclaimers of Apple as they appear in the Original Code, and keep intact all notices in the Original Code that refer to this License; and

(b)  You must include a copy of this License with every copy of Source Code of Covered Code and documentation You distribute or Externally Deploy, and You may not offer or impose any terms on such Source Code that alter or restrict this License or the recipients' rights hereunder, except as permitted under Section 6.

2.2 Modified Code.  You may modify Covered Code and use, reproduce, display, perform, internally distribute within Your organization, and Externally Deploy Your Modifications and Covered Code, for commercial or non-commercial purposes, provided that in each instance You also meet all of these conditions:

(a) You must satisfy all the conditions of Section 2.1 with respect to the Source Code of the Covered Code; 

(b) You must duplicate, to the extent it does not already exist, the notice in Exhibit A in each file of the Source Code of all Your Modifications, and cause the modified files to carry prominent notices stating that You changed the files and the date of any change; and

(c) If You Externally Deploy Your Modifications, You must make Source Code of all Your Externally Deployed Modifications either available to those to whom You have Externally Deployed Your Modifications, or publicly available.  Source Code of Your Externally Deployed Modifications must be released under the terms set forth in this License, including the license grants set forth in Section 3 below, for as long as you Externally Deploy the Covered Code or twelve (12) months from the date of initial External Deployment, whichever is longer. You should preferably distribute the Source Code of Your Externally Deployed Modifications electronically (e.g. download from a web site).

2.3 Distribution of Executable Versions.  In addition, if You Externally Deploy Covered Code (Original Code and/or Modifications) in object code, executable form only, You must include a prominent notice, in the code itself as well as in related documentation, stating that Source Code of the Covered Code is available under the terms of this License with information on how and where to obtain such Source Code.  

2.4 Third Party Rights.  You expressly acknowledge and agree that although Apple and each Contributor grants the licenses to their respective portions of the Covered Code set forth herein, no assurances are provided by Apple or any Contributor that the Covered Code does not infringe the patent or other intellectual property rights of any other entity. Apple and each Contributor disclaim any liability to You for claims brought by any other entity based on infringement of intellectual property rights or otherwise. As a condition to exercising the rights and licenses granted hereunder, You hereby assume sole responsibility to secure any other intellectual property rights needed, if any. For example, if a third party patent license is required to allow You to distribute the Covered Code, it is Your responsibility to acquire that license before distributing the Covered Code.

3. Your Grants.  In consideration of, and as a condition to, the licenses granted to You under this License, You hereby grant to any person or entity receiving or distributing Covered Code under this License a non-exclusive, royalty-free, perpetual, irrevocable license, under Your Applicable Patent Rights and other intellectual property rights (other than patent) owned or controlled by You, to use, reproduce, display, perform, modify, sublicense, distribute and Externally Deploy Your Modifications of the same scope and extent as Apple's licenses under Sections 2.1 and 2.2 above.  

4. Larger Works.  You may create a Larger Work by combining Covered Code with other code not governed by the terms of this License and distribute the Larger Work as a single product.  In each such instance, You must make sure the requirements of this License are fulfilled for the Covered Code or any portion thereof. 

5. Limitations on Patent License.   Except as expressly stated in Section 2, no other patent rights, express or implied, are granted by Apple herein.  Modifications and/or Larger Works may require additional patent licenses from Apple which Apple may grant in its sole discretion.  

6. Additional Terms.  You may choose to offer, and to charge a fee for, warranty, support, indemnity or liability obligations and/or other rights consistent with the scope of the license granted herein (""Additional Terms"") to one or more recipients of Covered Code. However, You may do so only on Your own behalf and as Your sole responsibility, and not on behalf of Apple or any Contributor. You must obtain the recipient's agreement that any such Additional Terms are offered by You alone, and You hereby agree to indemnify, defend and hold Apple and every Contributor harmless for any liability incurred by or claims asserted against Apple or such Contributor by reason of any such Additional Terms. 

7. Versions of the License.  Apple may publish revised and/or new versions of this License from time to time.  Each version will be given a distinguishing version number.  Once Original Code has been published under a particular version of this License, You may continue to use it under the terms of that version. You may also choose to use such Original Code under the terms of any subsequent version of this License published by Apple.  No one other than Apple has the right to modify the terms applicable to Covered Code created under this License.  

8. NO WARRANTY OR SUPPORT.  The Covered Code may contain in whole or in part pre-release, untested, or not fully tested works.  The Covered Code may contain errors that could cause failures or loss of data, and may be incomplete or contain inaccuracies.  You expressly acknowledge and agree that use of the Covered Code, or any portion thereof, is at Your sole and entire risk.  THE COVERED CODE IS PROVIDED ""AS IS"" AND WITHOUT WARRANTY, UPGRADES OR SUPPORT OF ANY KIND AND APPLE AND APPLE'S LICENSOR(S) (COLLECTIVELY REFERRED TO AS ""APPLE"" FOR THE PURPOSES OF SECTIONS 8 AND 9) AND ALL CONTRIBUTORS EXPRESSLY DISCLAIM ALL WARRANTIES AND/OR CONDITIONS, EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES AND/OR CONDITIONS OF MERCHANTABILITY, OF SATISFACTORY QUALITY, OF FITNESS FOR A PARTICULAR PURPOSE, OF ACCURACY, OF QUIET ENJOYMENT, AND NONINFRINGEMENT OF THIRD PARTY RIGHTS.  APPLE AND EACH CONTRIBUTOR DOES NOT WARRANT AGAINST INTERFERENCE WITH YOUR ENJOYMENT OF THE COVERED CODE, THAT THE FUNCTIONS CONTAINED IN THE COVERED CODE WILL MEET YOUR REQUIREMENTS, THAT THE OPERATION OF THE COVERED CODE WILL BE UNINTERRUPTED OR ERROR-FREE, OR THAT DEFECTS IN THE COVERED CODE WILL BE CORRECTED.  NO ORAL OR WRITTEN INFORMATION OR ADVICE GIVEN BY APPLE, AN APPLE AUTHORIZED REPRESENTATIVE OR ANY CONTRIBUTOR SHALL CREATE A WARRANTY.  You acknowledge that the Covered Code is not intended for use in the operation of nuclear facilities, aircraft navigation, communication systems, or air traffic control machines in which case the failure of the Covered Code could lead to death, personal injury, or severe physical or environmental damage.

9. LIMITATION OF LIABILITY. TO THE EXTENT NOT PROHIBITED BY LAW, IN NO EVENT SHALL APPLE OR ANY CONTRIBUTOR BE LIABLE FOR ANY INCIDENTAL, SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES ARISING OUT OF OR RELATING TO THIS LICENSE OR YOUR USE OR INABILITY TO USE THE COVERED CODE, OR ANY PORTION THEREOF, WHETHER UNDER A THEORY OF CONTRACT, WARRANTY, TORT (INCLUDING NEGLIGENCE), PRODUCTS LIABILITY OR OTHERWISE, EVEN IF APPLE OR SUCH CONTRIBUTOR HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES AND NOTWITHSTANDING THE FAILURE OF ESSENTIAL PURPOSE OF ANY REMEDY. SOME JURISDICTIONS DO NOT ALLOW THE LIMITATION OF LIABILITY OF INCIDENTAL OR CONSEQUENTIAL DAMAGES, SO THIS LIMITATION MAY NOT APPLY TO YOU. In no event shall Apple's total liability to You for all damages (other than as may be required by applicable law) under this License exceed the amount of fifty dollars ($50.00).

10. Trademarks.  This License does not grant any rights to use the trademarks or trade names  ""Apple"", ""Mac"", ""Mac OS"", ""QuickTime"", ""QuickTime Streaming Server"" or any other trademarks, service marks, logos or trade names belonging to Apple (collectively ""Apple Marks"") or to any trademark, service mark, logo or trade name belonging to any Contributor.  You agree not to use any Apple Marks in or as part of the name of products derived from the Original Code or to endorse or promote products derived from the Original Code other than as expressly permitted by and in strict compliance at all times with Apple's third party trademark usage guidelines which are posted at http://www.apple.com/legal/guidelinesfor3rdparties.html.  

11. Ownership. Subject to the licenses granted under this License, each Contributor retains all rights, title and interest in and to any Modifications made by such Contributor.  Apple retains all rights, title and interest in and to the Original Code and any Modifications made by or on behalf of Apple (""Apple Modifications""), and such Apple Modifications will not be automatically subject to this License.  Apple may, at its sole discretion, choose to license such Apple Modifications under this License, or on different terms from those contained in this License or may choose not to license them at all.  

12. Termination.  

12.1 Termination.  This License and the rights granted hereunder will terminate:

(a) automatically without notice from Apple if You fail to comply with any term(s) of this License and fail to cure such breach within 30 days of becoming aware of such breach;
(b) immediately in the event of the circumstances described in Section 13.5(b); or
(c) automatically without notice from Apple if You, at any time during the term of this License, commence an action for patent infringement against Apple; provided that Apple did not first commence an action for patent infringement against You in that instance.

12.2 Effect of Termination.  Upon termination, You agree to immediately stop any further use, reproduction, modification, sublicensing and distribution of the Covered Code.  All sublicenses to the Covered Code which have been properly granted prior to termination shall survive any termination of this License.  Provisions which, by their nature, should remain in effect beyond the termination of this License shall survive, including but not limited to Sections 3, 5, 8, 9, 10, 11, 12.2 and 13.  No party will be liable to any other for compensation, indemnity or damages of any sort solely as a result of terminating this License in accordance with its terms, and termination of this License will be without prejudice to any other right or remedy of any party.

13.  Miscellaneous.

13.1 Government End Users.   The Covered Code is a ""commercial item"" as defined in FAR 2.101.  Government software and technical data rights in the Covered Code include only those rights customarily provided to the public as defined in this License. This customary commercial license in technical data and software is provided in accordance with FAR 12.211 (Technical Data) and 12.212 (Computer Software) and, for Department of Defense purchases, DFAR 252.227-7015 (Technical Data -- Commercial Items) and 227.7202-3 (Rights in Commercial Computer Software or Computer Software Documentation).  Accordingly, all U.S. Government End Users acquire Covered Code with only those rights set forth herein.

13.2 Relationship of Parties.  This License will not be construed as creating an agency, partnership, joint venture or any other form of legal association between or among You, Apple or any Contributor, and You will not represent to the contrary, whether expressly, by implication, appearance or otherwise.

13.3 Independent Development.   Nothing in this License will impair Apple's right to acquire, license, develop, have others develop for it, market and/or distribute technology or products that perform the same or similar functions as, or otherwise compete with, Modifications, Larger Works, technology or products that You may develop, produce, market or distribute.

13.4 Waiver; Construction.  Failure by Apple or any Contributor to enforce any provision of this License will not be deemed a waiver of future enforcement of that or any other provision.  Any law or regulation which provides that the language of a contract shall be construed against the drafter will not apply to this License.

13.5 Severability.  (a) If for any reason a court of competent jurisdiction finds any provision of this License, or portion thereof, to be unenforceable, that provision of the License will be enforced to the maximum extent permissible so as to effect the economic benefits and intent of the parties, and the remainder of this License will continue in full force and effect.  (b) Notwithstanding the foregoing, if applicable law prohibits or restricts You from fully and/or specifically complying with Sections 2 and/or 3 or prevents the enforceability of either of those Sections, this License will immediately terminate and You must immediately discontinue any use of the Covered Code and destroy all copies of it that are in your possession or control.

13.6 Dispute Resolution.  Any litigation or other dispute resolution between You and Apple relating to this License shall take place in the Northern District of California, and You and Apple hereby consent to the personal jurisdiction of, and venue in, the state and federal courts within that District with respect to this License. The application of the United Nations Convention on Contracts for the International Sale of Goods is expressly excluded.

13.7 Entire Agreement; Governing Law.  This License constitutes the entire agreement between the parties with respect to the subject matter hereof.  This License shall be governed by the laws of the United States and the State of California, except that body of California law concerning conflicts of law. 

Where You are located in the province of Quebec, Canada, the following clause applies:  The parties hereby confirm that they have requested that this License and all related documents be drafted in English.  Les parties ont exigé que le présent contrat et tous les documents connexes soient rédigés en anglais.

EXHIBIT A. 

""Portions Copyright (c) 1999-2007 Apple Inc.  All Rights Reserved.

This file contains Original Code and/or Modifications of Original Code as defined in and that are subject to the Apple Public Source License Version 2.0 (the 'License').  You may not use this file except in compliance with the License.  Please obtain a copy of the License at http://www.opensource.apple.com/apsl/ and read it before using this file.

The Original Code and all software distributed under the License are distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES, INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.  Please see the License for the specific language governing rights and limitations under the License."" 
",False,"```
APPLE PUBLIC SOURCE LICENSE
Version 2.0 -  August 6, 2003

Please read this License carefully before downloading this software.  By downloading or using this software, you are agreeing to be bound by the terms of this License.  If you do not or cannot agree to the terms of this License, please do not download or use the software.

Apple Note:  In January 2007, Apple changed its corporate name from ""Apple Computer, Inc."" to ""Apple Inc.""  This change has been reflected below and copyright years updated, but no other changes have been made to the APSL 2.0.

1. General; Definitions.  This License applies to any program or other work which Apple Inc. (""Apple"") makes publicly available and which contains a notice placed by Apple identifying such program or work as ""Original Code"" and stating that it is subject to the terms of this Apple Public Source License version 2.0 (""License"").  As used in this License:

1.1  ""Applicable Patent Rights"" mean:  (a) in the case where Apple is the grantor of rights, (i) claims of patents that are now or hereafter acquired, owned by or assigned to Apple and (ii) that cover subject matter contained in the Original Code, but only to the extent necessary to use, reproduce and/or distribute the Original Code without infringement; and (b) in the case where You are the grantor of rights, (i) claims of patents that are now or hereafter acquired, owned by or assigned to You and (ii) that cover subject matter in Your Modifications, taken alone or in combination with Original Code.

1.2 ""Contributor"" means any person or entity that creates or contributes to the creation of Modifications.

1.3  ""Covered Code"" means the Original Code, Modifications, the combination of Original Code and any Modifications, and/or any respective portions thereof.

1.4 ""Externally Deploy"" means: (a) to sublicense, distribute or otherwise make Covered Code available, directly or indirectly, to anyone other than You; and/or (b) to use Covered Code, alone or as part of a Larger Work, in any way to provide a service, including but not limited to delivery of content, through electronic communication with a client other than You.

1.5 ""Larger Work"" means a work which combines Covered Code or portions thereof with code not governed by the terms of this License.

1.6 ""Modifications"" mean any addition to, deletion from, and/or change to, the substance and/or structure of the Original Code, any previous Modifications, the combination of Original Code and any previous Modifications, and/or any respective portions thereof.  When code is released as a series of files, a Modification is:  (a) any addition to or deletion from the contents of a file containing Covered Code; and/or (b) any new file or other representation of computer program statements that contains any part of Covered Code. 

1.7 ""Original Code"" means (a) the Source Code of a program or other work as originally made available by Apple under this License, including the Source Code of any updates or upgrades to such programs or works made available by Apple under this License, and that has been expressly identified by Apple as such in the header file(s) of such work; and (b) the object code compiled from such Source Code and originally made available by Apple under this License

1.8 ""Source Code"" means the human readable form of a program or other work that is suitable for making modifications to it, including all modules it contains, plus any associated interface definition files, scripts used to control compilation and installation of an executable (object code).

1.9 ""You"" or ""Your"" means an individual or a legal entity exercising rights under this License.  For legal entities, ""You"" or ""Your"" includes any entity which controls, is controlled by, or is under common control with, You, where ""control"" means (a) the power, direct or indirect, to cause the direction or management of such entity, whether by contract or otherwise, or (b) ownership of fifty percent (50%) or more of the outstanding shares or beneficial ownership of such entity.

2. Permitted Uses; Conditions &amp; Restrictions.   Subject to the terms and conditions of this License, Apple hereby grants You, effective on the date You accept this License and download the Original Code, a world-wide, royalty-free, non-exclusive license, to the extent of Apple's Applicable Patent Rights and copyrights covering the Original Code, to do the following:

2.1 Unmodified Code.  You may use, reproduce, display, perform, internally distribute within Your organization, and Externally Deploy verbatim, unmodified copies of the Original Code, for commercial or non-commercial purposes, provided that in each instance:

(a) You must retain and reproduce in all copies of Original Code the copyright and other proprietary notices and disclaimers of Apple as they appear in the Original Code, and keep intact all notices in the Original Code that refer to this License; and

(b)  You must include a copy of this License with every copy of Source Code of Covered Code and documentation You distribute or Externally Deploy, and You may not offer or impose any terms on such Source Code that alter or restrict this License or the recipients' rights hereunder, except as permitted under Section 6.

2.2 Modified Code.  You may modify Covered Code and use, reproduce, display, perform, internally distribute within Your organization, and Externally Deploy Your Modifications and Covered Code, for commercial or non-commercial purposes, provided that in each instance You also meet all of these conditions:

(a) You must satisfy all the conditions of Section 2.1 with respect to the Source Code of the Covered Code; 

(b) You must duplicate, to the extent it does not already exist, the notice in Exhibit A in each file of the Source Code of all Your Modifications, and cause the modified files to carry prominent notices stating that You changed the files and the date of any change; and

(c) If You Externally Deploy Your Modifications, You must make Source Code of all Your Externally Deployed Modifications either available to those to whom You have Externally Deployed Your Modifications, or publicly available.  Source Code of Your Externally Deployed Modifications must be released under the terms set forth in this License, including the license grants set forth in Section 3 below, for as long as you Externally Deploy the Covered Code or twelve (12) months from the date of initial External Deployment, whichever is longer. You should preferably distribute the Source Code of Your Externally Deployed Modifications electronically (e.g. download from a web site).

2.3 Distribution of Executable Versions.  In addition, if You Externally Deploy Covered Code (Original Code and/or Modifications) in object code, executable form only, You must include a prominent notice, in the code itself as well as in related documentation, stating that Source Code of the Covered Code is available under the terms of this License with information on how and where to obtain such Source Code.  

2.4 Third Party Rights.  You expressly acknowledge and agree that although Apple and each Contributor grants the licenses to their respective portions of the Covered Code set forth herein, no assurances are provided by Apple or any Contributor that the Covered Code does not infringe the patent or other intellectual property rights of any other entity. Apple and each Contributor disclaim any liability to You for claims brought by any other entity based on infringement of intellectual property rights or otherwise. As a condition to exercising the rights and licenses granted hereunder, You hereby assume sole responsibility to secure any other intellectual property rights needed, if any. For example, if a third party patent license is required to allow You to distribute the Covered Code, it is Your responsibility to acquire that license before distributing the Covered Code.

3. Your Grants.  In consideration of, and as a condition to, the licenses granted to You under this License, You hereby grant to any person or entity receiving or distributing Covered Code under this License a non-exclusive, royalty-free, perpetual, irrevocable license, under Your Applicable Patent Rights and other intellectual property rights (other than patent) owned or controlled by You, to use, reproduce, display, perform, modify, sublicense, distribute and Externally Deploy Your Modifications of the same scope and extent as Apple's licenses under Sections 2.1 and 2.2 above.  

4. Larger Works.  You may create a Larger Work by combining Covered Code with other code not governed by the terms of this License and distribute the Larger Work as a single product.  In each such instance, You must make sure the requirements of this License are fulfilled for the Covered Code or any portion thereof. 

5. Limitations on Patent License.   Except as expressly stated in Section 2, no other patent rights, express or implied, are granted by Apple herein.  Modifications and/or Larger Works may require additional patent licenses from Apple which Apple may grant in its sole discretion.  

6. Additional Terms.  You may choose to offer, and to charge a fee for, warranty, support, indemnity or liability obligations and/or other rights consistent with the scope of the license granted herein (""Additional Terms"") to one or more recipients of Covered Code. However, You may do so only on Your own behalf and as Your sole responsibility, and not on behalf of Apple or any Contributor. You must obtain the recipient's agreement that any such Additional Terms are offered by You alone, and You hereby agree to indemnify, defend and hold Apple and every Contributor harmless for any liability incurred by or claims asserted against Apple or such Contributor by reason of any such Additional Terms. 

7. Versions of the License.  Apple may publish revised and/or new versions of this License from time to time.  Each version will be given a distinguishing version number.  Once Original Code has been published under a particular version of this License, You may continue to use it under the terms of that version. You may also choose to use such Original Code under the terms of any subsequent version of this License published by Apple.  No one other than Apple has the right to modify the terms applicable to Covered Code created under this License.  

8. NO WARRANTY OR SUPPORT.  The Covered Code may contain in whole or in part pre-release, untested, or not fully tested works.  The Covered Code may contain errors that could cause failures or loss of data, and may be incomplete or contain inaccuracies.  You expressly acknowledge and agree that use of the Covered Code, or any portion thereof, is at Your sole and entire risk.  THE COVERED CODE IS PROVIDED ""AS IS"" AND WITHOUT WARRANTY, UPGRADES OR SUPPORT OF ANY KIND AND APPLE AND APPLE'S LICENSOR(S) (COLLECTIVELY REFERRED TO AS ""APPLE"" FOR THE PURPOSES OF SECTIONS 8 AND 9) AND ALL CONTRIBUTORS EXPRESSLY DISCLAIM ALL WARRANTIES AND/OR CONDITIONS, EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES AND/OR CONDITIONS OF MERCHANTABILITY, OF SATISFACTORY QUALITY, OF FITNESS FOR A PARTICULAR PURPOSE, OF ACCURACY, OF QUIET ENJOYMENT, AND NONINFRINGEMENT OF THIRD PARTY RIGHTS.  APPLE AND EACH CONTRIBUTOR DOES NOT WARRANT AGAINST INTERFERENCE WITH YOUR ENJOYMENT OF THE COVERED CODE, THAT THE FUNCTIONS CONTAINED IN THE COVERED CODE WILL MEET YOUR REQUIREMENTS, THAT THE OPERATION OF THE COVERED CODE WILL BE UNINTERRUPTED OR ERROR-FREE, OR THAT DEFECTS IN THE COVERED CODE WILL BE CORRECTED.  NO ORAL OR WRITTEN INFORMATION OR ADVICE GIVEN BY APPLE, AN APPLE AUTHORIZED REPRESENTATIVE OR ANY CONTRIBUTOR SHALL CREATE A WARRANTY.  You acknowledge that the Covered Code is not intended for use in the operation of nuclear facilities, aircraft navigation, communication systems, or air traffic control machines in which case the failure of the Covered Code could lead to death, personal injury, or severe physical or environmental damage.

9. LIMITATION OF LIABILITY. TO THE EXTENT NOT PROHIBITED BY LAW, IN NO EVENT SHALL APPLE OR ANY CONTRIBUTOR BE LIABLE FOR ANY INCIDENTAL, SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES ARISING OUT OF OR RELATING TO THIS LICENSE OR YOUR USE OR INABILITY TO USE THE COVERED CODE, OR ANY PORTION THEREOF, WHETHER UNDER A THEORY OF CONTRACT, WARRANTY, TORT (INCLUDING NEGLIGENCE), PRODUCTS LIABILITY OR OTHERWISE, EVEN IF APPLE OR SUCH CONTRIBUTOR HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES AND NOTWITHSTANDING THE FAILURE OF ESSENTIAL PURPOSE OF ANY REMEDY. SOME JURISDICTIONS DO NOT ALLOW THE LIMITATION OF LIABILITY OF INCIDENTAL OR CONSEQUENTIAL DAMAGES, SO THIS LIMITATION MAY NOT APPLY TO YOU. In no event shall Apple's total liability to You for all damages (other than as may be required by applicable law) under this License exceed the amount of fifty dollars ($50.00).

10. Trademarks.  This License does not grant any rights to use the trademarks or trade names  ""Apple"", ""Mac"", ""Mac OS"", ""QuickTime"", ""QuickTime Streaming Server"" or any other trademarks, service marks, logos or trade names belonging to Apple (collectively ""Apple Marks"") or to any trademark, service mark, logo or trade name belonging to any Contributor.  You agree not to use any Apple Marks in or as part of the name of products derived from the Original Code or to endorse or promote products derived from the Original Code other than as expressly permitted by and in strict compliance at all times with Apple's third party trademark usage guidelines which are posted at http://www.apple.com/legal/guidelinesfor3rdparties.html.  

11. Ownership. Subject to the licenses granted under this License, each Contributor retains all rights, title and interest in and to any Modifications made by such Contributor.  Apple retains all rights, title and interest in and to the Original Code and any Modifications made by or on behalf of Apple (""Apple Modifications""), and such Apple Modifications will not be automatically subject to this License.  Apple may, at its sole discretion, choose to license such Apple Modifications under this License, or on different terms from those contained in this License or may choose not to license them at all.  

12. Termination.  

12.1 Termination.  This License and the rights granted hereunder will terminate:

(a) automatically without notice from Apple if You fail to comply with any term(s) of this License and fail to cure such breach within 30 days of becoming aware of such breach;
(b) immediately in the event of the circumstances described in Section 13.5(b); or
(c) automatically without notice from Apple if You, at any time during the term of this License, commence an action for patent infringement against Apple; provided that Apple did not first commence an action for patent infringement against You in that instance.

12.2 Effect of Termination.  Upon termination, You agree to immediately stop any further use, reproduction, modification, sublicensing and distribution of the Covered Code.  All sublicenses to the Covered Code which have been properly granted prior to termination shall survive any termination of this License.  Provisions which, by their nature, should remain in effect beyond the termination of this License shall survive, including but not limited to Sections 3, 5, 8, 9, 10, 11, 12.2 and 13.  No party will be liable to any other for compensation, indemnity or damages of any sort solely as a result of terminating this License in accordance with its terms, and termination of this License will be without prejudice to any other right or remedy of any party.

13.  Miscellaneous.

13.1 Government End Users.   The Covered Code is a ""commercial item"" as defined in FAR 2.101.  Government software and technical data rights in the Covered Code include only those rights customarily provided to the public as defined in this License. This customary commercial license in technical data and software is provided in accordance with FAR 12.211"
81,82,NomosTestfiles/APSL/DNSDigest.c,"APSL
Apache-2.0
OpenSSL","/* -*- Mode: C; tab-width: 4 -*-
 *
 * Copyright (c) 2002-2003 Apple Computer, Inc. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the ""License"");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *     http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an ""AS IS"" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.

    Change History (most recent first):

Log: DNSDigest.c,v $
Revision 1.26  2008/10/10 23:21:51  mcguire
fixed typo in original MD5 source reference

Revision 1.25  2007/12/17 23:48:29  cheshire
DNSDigest_SignMessage doesn't need to return a result -- it already updates the 'end' parameter

Revision 1.24  2007/11/30 23:03:51  cheshire
Fixes for EFI: Use ""mDNSPlatformMemCopy"" instead of assuming existence of ""memcpy""

Revision 1.23  2007/09/21 21:12:36  cheshire
DNSDigest_SignMessage does not need separate ""mDNSu16 *numAdditionals"" parameter

Revision 1.22  2007/04/22 06:02:02  cheshire
<rdar://problem/4615977> Query should immediately return failure when no server

Revision 1.21  2007/03/22 18:31:48  cheshire
Put dst parameter first in mDNSPlatformStrCopy/mDNSPlatformMemCopy, like conventional Posix strcpy/memcpy

Revision 1.20  2006/12/22 20:59:49  cheshire
<rdar://problem/4742742> Read *all* DNS keys from keychain,
 not just key for the system-wide default registration domain

Revision 1.19  2006/12/21 00:06:07  cheshire
Don't need to do mDNSPlatformMemZero() -- mDNS_SetupResourceRecord() does it for us

Revision 1.18  2006/12/19 22:41:21  cheshire
Fix compiler warnings

Revision 1.17  2006/08/14 23:24:22  cheshire
Re-licensed mDNSResponder daemon source code under Apache License, Version 2.0

Revision 1.16  2006/07/05 23:05:15  cheshire
<rdar://problem/4472013> Add Private DNS server functionality to dnsextd
Add DNSDigest_VerifyMessage() function

Revision 1.15  2006/06/20 04:12:30  cheshire
<rdar://problem/4490961> DNS Update broken

Revision 1.14  2006/02/25 23:12:07  cheshire
<rdar://problem/4427969> Fix to avoid code generation warning/error on FreeBSD 7

Revision 1.13  2004/12/16 20:12:59  cheshire
<rdar://problem/3324626> Cache memory management improvements

Revision 1.12  2004/12/03 07:20:50  ksekar
<rdar://problem/3674208> Wide-Area: Registration of large TXT record fails

Revision 1.11  2004/12/02 01:10:27  cheshire
Fix to compile cleanly on 64-bit x86

Revision 1.10  2004/11/01 20:36:04  ksekar
<rdar://problem/3802395> mDNSResponder should not receive Keychain Notifications

Revision 1.9  2004/10/26 09:00:12  cheshire
Save a few bytes by creating HMAC_MD5_AlgName as a C string instead of a 256-byte object

Revision 1.8  2004/09/17 01:08:48  cheshire
Renamed mDNSClientAPI.h to mDNSEmbeddedAPI.h
  The name ""mDNSClientAPI.h"" is misleading to new developers looking at this code. The interfaces
  declared in that file are ONLY appropriate to single-address-space embedded applications.
  For clients on general-purpose computers, the interfaces defined in dns_sd.h should be used.

Revision 1.7  2004/08/15 18:36:38  cheshire
Don't use strcpy() and strlen() on ""struct domainname"" objects;
use AssignDomainName() and DomainNameLength() instead
(A ""struct domainname"" is a collection of packed pascal strings, not a C string.)

Revision 1.6  2004/06/02 00:17:46  ksekar
Referenced original OpenSSL license headers in source file description.

Revision 1.5  2004/05/20 18:37:37  cheshire
Fix compiler warnings

Revision 1.4  2004/04/22 20:28:20  cheshire
Use existing facility of PutResourceRecordTTL() to update count field for us

Revision 1.3  2004/04/22 03:05:28  cheshire
kDNSClass_ANY should be kDNSQClass_ANY

Revision 1.2  2004/04/15 00:51:28  bradley
Minor tweaks for Windows and C++ builds. Added casts for signed/unsigned integers and 64-bit pointers.
Prefix some functions with mDNS to avoid conflicts. Disable benign warnings on Microsoft compilers.

Revision 1.1  2004/04/14 23:09:28  ksekar
Support for TSIG signed dynamic updates.



*/


#ifdef __cplusplus
extern ""C"" {
#endif

#include ""mDNSEmbeddedAPI.h""
#include ""DNSCommon.h""

// Disable certain benign warnings with Microsoft compilers
#if(defined(_MSC_VER))
	// Disable ""conditional expression is constant"" warning for debug macros.
	// Otherwise, this generates warnings for the perfectly natural construct ""while(1)""
	// If someone knows a variant way of writing ""while(1)"" that doesn't generate warning messages, please let us know
	#pragma warning(disable:4127)
#endif


 // ***************************************************************************
#if COMPILER_LIKES_PRAGMA_MARK
#pragma mark - Byte Swapping Functions
#endif

mDNSlocal mDNSu16 NToH16(mDNSu8 * bytes)
	{
	return (mDNSu16)((mDNSu16)bytes[0] << 8 | (mDNSu16)bytes[1]);
	}

mDNSlocal mDNSu32 NToH32(mDNSu8 * bytes)
	{
	return (mDNSu32)((mDNSu32) bytes[0] << 24 | (mDNSu32) bytes[1] << 16 | (mDNSu32) bytes[2] << 8 | (mDNSu32)bytes[3]);
	}

 // ***************************************************************************
#if COMPILER_LIKES_PRAGMA_MARK
#pragma mark - MD5 Hash Functions
#endif


/* The source for the has is derived CommonCrypto files CommonDigest.h, md32_common.h, md5_locl.h, md5_locl.h, and openssl/md5.h.
 * The following changes have been made to the original sources:
 *    replaced CC_LONG w/ mDNSu32
 *    replaced CC_MD5* with MD5*
 *    replaced CC_LONG w/ mDNSu32, removed conditional #defines from md5.h
 *    removed extern decls for MD5_Init/Update/Final from CommonDigest.h
 *    removed APPLE_COMMON_DIGEST specific #defines from md5_locl.h
 *
 * Note: machine archetecure specific conditionals from the original sources are turned off, but are left in the code
 * to aid in platform-specific optimizations and debugging.
 * Sources originally distributed under the following license headers:
 * CommonDigest.h - APSL
 * 
 * md32_Common.h
 * ====================================================================
 * Copyright (c) 1999-2002 The OpenSSL Project.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer. 
 *
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in
 *    the documentation and/or other materials provided with the
 *    distribution.
 *
 * 3. All advertising materials mentioning features or use of this
 *    software must display the following acknowledgment:
 *    ""This product includes software developed by the OpenSSL Project
 *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)""
 *
 * 4. The names ""OpenSSL Toolkit"" and ""OpenSSL Project"" must not be used to
 *    endorse or promote products derived from this software without
 *    prior written permission. For written permission, please contact
 *    licensing@OpenSSL.org.
 *
 * 5. Products derived from this software may not be called ""OpenSSL""
 *    nor may ""OpenSSL"" appear in their names without prior written
 *    permission of the OpenSSL Project.
 *
 * 6. Redistributions of any form whatsoever must retain the following
 *    acknowledgment:
 *    ""This product includes software developed by the OpenSSL Project
 *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)""
 *
 * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
 * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
 * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
 * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
 * OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 *
 * md5_dgst.c, md5_locl.h
 * ====================================================================
 *
 * This product includes cryptographic software written by Eric Young
 * (eay@cryptsoft.com).  This product includes software written by Tim
 * Hudson (tjh@cryptsoft.com).
 *
 * Copyright (C) 1995-1998 Eric Young (eay@cryptsoft.com)
 * All rights reserved.
 *
 * This package is an SSL implementation written
 * by Eric Young (eay@cryptsoft.com).
 * The implementation was written so as to conform with Netscapes SSL.
 * 
 * This library is free for commercial and non-commercial use as long as
 * the following conditions are aheared to.  The following conditions
 * apply to all code found in this distribution, be it the RC4, RSA,
 * lhash, DES, etc., code; not just the SSL code.  The SSL documentation
 * included with this distribution is covered by the same copyright terms
 * except that the holder is Tim Hudson (tjh@cryptsoft.com).
 * 
 * Copyright remains Eric Young's, and as such any Copyright notices in
 * the code are not to be removed.
 * If this package is used in a product, Eric Young should be given attribution
 * as the author of the parts of the library used.
 * This can be in the form of a textual message at program startup or
 * in documentation (online or textual) provided with the package.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *    ""This product includes cryptographic software written by
 *     Eric Young (eay@cryptsoft.com)""
 *    The word 'cryptographic' can be left out if the rouines from the library
 *    being used are not cryptographic related :-).
 * 4. If you include any Windows specific code (or a derivative thereof) from 
 *    the apps directory (application code) you must include an acknowledgement:
 *    ""This product includes software written by Tim Hudson (tjh@cryptsoft.com)""
 * 
 * THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 * 
 * The licence and distribution terms for any publically available version or
 * derivative of this code cannot be changed.  i.e. this code cannot simply be
 * copied and put under another distribution licence
 * [including the GNU Public Licence.]
 *
 */

//from CommonDigest.h

#define MD5_DIGEST_LENGTH	16			/* digest length in bytes */
#define MD5_BLOCK_BYTES		64			/* block size in bytes */
#define MD5_BLOCK_LONG       (MD5_BLOCK_BYTES / sizeof(mDNSu32))

typedef struct MD5state_st
{
	mDNSu32 A,B,C,D;
	mDNSu32 Nl,Nh;
	mDNSu32 data[MD5_BLOCK_LONG];
	int num;
} MD5_CTX;


// from openssl/md5.h

#define MD5_CBLOCK	64
#define MD5_LBLOCK	(MD5_CBLOCK/4)
#define MD5_DIGEST_LENGTH 16

int MD5_Init(MD5_CTX *c);
int MD5_Update(MD5_CTX *c, const void *data, unsigned long len);
int MD5_Final(unsigned char *md, MD5_CTX *c);
void MD5_Transform(MD5_CTX *c, const unsigned char *b);

// From md5_locl.h

#ifndef MD5_LONG_LOG2
#define MD5_LONG_LOG2 2 /* default to 32 bits */
#endif

#ifdef MD5_ASM
# if defined(__i386) || defined(__i386__) || defined(_M_IX86) || defined(__INTEL__)
#  define md5_block_host_order md5_block_asm_host_order
# elif defined(__sparc) && defined(OPENSSL_SYS_ULTRASPARC)
   void md5_block_asm_data_order_aligned (MD5_CTX *c, const mDNSu32 *p,int num);
#  define HASH_BLOCK_DATA_ORDER_ALIGNED md5_block_asm_data_order_aligned
# endif
#endif

void md5_block_host_order (MD5_CTX *c, const void *p,int num);
void md5_block_data_order (MD5_CTX *c, const void *p,int num);

#if defined(__i386) || defined(__i386__) || defined(_M_IX86) || defined(__INTEL__)
/*
 * *_block_host_order is expected to handle aligned data while
 * *_block_data_order - unaligned. As algorithm and host (x86)
 * are in this case of the same ""endianness"" these two are
 * otherwise indistinguishable. But normally you don't want to
 * call the same function because unaligned access in places
 * where alignment is expected is usually a ""Bad Thing"". Indeed,
 * on RISCs you get punished with BUS ERROR signal or *severe*
 * performance degradation. Intel CPUs are in turn perfectly
 * capable of loading unaligned data without such drastic side
 * effect. Yes, they say it's slower than aligned load, but no
 * exception is generated and therefore performance degradation
 * is *incomparable* with RISCs. What we should weight here is
 * costs of unaligned access against costs of aligning data.
 * According to my measurements allowing unaligned access results
 * in ~9% performance improvement on Pentium II operating at
 * 266MHz. I won't be surprised if the difference will be higher
 * on faster systems:-)
 *
 *				<appro@fy.chalmers.se>
 */
#define md5_block_data_order md5_block_host_order
#endif

#define DATA_ORDER_IS_LITTLE_ENDIAN

#define HASH_LONG		mDNSu32
#define HASH_LONG_LOG2	MD5_LONG_LOG2
#define HASH_CTX		MD5_CTX
#define HASH_CBLOCK		MD5_CBLOCK
#define HASH_LBLOCK		MD5_LBLOCK

#define HASH_UPDATE		MD5_Update
#define HASH_TRANSFORM	MD5_Transform
#define HASH_FINAL		MD5_Final

#define	HASH_MAKE_STRING(c,s)	do {	\
	unsigned long ll;		\
	ll=(c)->A; HOST_l2c(ll,(s));	\
	ll=(c)->B; HOST_l2c(ll,(s));	\
	ll=(c)->C; HOST_l2c(ll,(s));	\
	ll=(c)->D; HOST_l2c(ll,(s));	\
	} while (0)
#define HASH_BLOCK_HOST_ORDER	md5_block_host_order
#if !defined(L_ENDIAN) || defined(md5_block_data_order)
#define	HASH_BLOCK_DATA_ORDER	md5_block_data_order
/*
 * Little-endians (Intel and Alpha) feel better without this.
 * It looks like memcpy does better job than generic
 * md5_block_data_order on copying-n-aligning input data.
 * But frankly speaking I didn't expect such result on Alpha.
 * On the other hand I've got this with egcs-1.0.2 and if
 * program is compiled with another (better?) compiler it
 * might turn out other way around.
 *
 *				<appro@fy.chalmers.se>
 */
#endif


// from md32_common.h

/*
 * This is a generic 32 bit ""collector"" for message digest algorithms.
 * Whenever needed it collects input character stream into chunks of
 * 32 bit values and invokes a block function that performs actual hash
 * calculations.
 *
 * Porting guide.
 *
 * Obligatory macros:
 *
 * DATA_ORDER_IS_BIG_ENDIAN or DATA_ORDER_IS_LITTLE_ENDIAN
 *	this macro defines byte order of input stream.
 * HASH_CBLOCK
 *	size of a unit chunk HASH_BLOCK operates on.
 * HASH_LONG
 *	has to be at lest 32 bit wide, if it's wider, then
 *	HASH_LONG_LOG2 *has to* be defined along
 * HASH_CTX
 *	context structure that at least contains following
 *	members:
 *		typedef struct {
 *			...
 *			HASH_LONG	Nl,Nh;
 *			HASH_LONG	data[HASH_LBLOCK];
 *			int		num;
 *			...
 *			} HASH_CTX;
 * HASH_UPDATE
 *	name of ""Update"" function, implemented here.
 * HASH_TRANSFORM
 *	name of ""Transform"" function, implemented here.
 * HASH_FINAL
 *	name of ""Final"" function, implemented here.
 * HASH_BLOCK_HOST_ORDER
 *	name of ""block"" function treating *aligned* input message
 *	in host byte order, implemented externally.
 * HASH_BLOCK_DATA_ORDER
 *	name of ""block"" function treating *unaligned* input message
 *	in original (data) byte order, implemented externally (it
 *	actually is optional if data and host are of the same
 *	""endianess"").
 * HASH_MAKE_STRING
 *	macro convering context variables to an ASCII hash string.
 *
 * Optional macros:
 *
 * B_ENDIAN or L_ENDIAN
 *	defines host byte-order.
 * HASH_LONG_LOG2
 *	defaults to 2 if not states otherwise.
 * HASH_LBLOCK
 *	assumed to be HASH_CBLOCK/4 if not stated otherwise.
 * HASH_BLOCK_DATA_ORDER_ALIGNED
 *	alternative ""block"" function capable of treating
 *	aligned input message in original (data) order,
 *	implemented externally.
 *
 * MD5 example:
 *
 *	#define DATA_ORDER_IS_LITTLE_ENDIAN
 *
 *	#define HASH_LONG		mDNSu32
 *	#define HASH_LONG_LOG2	mDNSu32_LOG2
 *	#define HASH_CTX		MD5_CTX
 *	#define HASH_CBLOCK		MD5_CBLOCK
 *	#define HASH_LBLOCK		MD5_LBLOCK
 *	#define HASH_UPDATE		MD5_Update
 *	#define HASH_TRANSFORM		MD5_Transform
 *	#define HASH_FINAL		MD5_Final
 *	#define HASH_BLOCK_HOST_ORDER	md5_block_host_order
 *	#define HASH_BLOCK_DATA_ORDER	md5_block_data_order
 *
 *					<appro@fy.chalmers.se>
 */

#if !defined(DATA_ORDER_IS_BIG_ENDIAN) && !defined(DATA_ORDER_IS_LITTLE_ENDIAN)
#error ""DATA_ORDER must be defined!""
#endif

#ifndef HASH_CBLOCK
#error ""HASH_CBLOCK must be defined!""
#endif
#ifndef HASH_LONG
#error ""HASH_LONG must be defined!""
#endif
#ifndef HASH_CTX
#error ""HASH_CTX must be defined!""
#endif

#ifndef HASH_UPDATE
#error ""HASH_UPDATE must be defined!""
#endif
#ifndef HASH_TRANSFORM
#error ""HASH_TRANSFORM must be defined!""
#endif
#ifndef HASH_FINAL
#error ""HASH_FINAL must be defined!""
#endif

#ifndef HASH_BLOCK_HOST_ORDER
#error ""HASH_BLOCK_HOST_ORDER must be defined!""
#endif

#if 0
/*
 * Moved below as it's required only if HASH_BLOCK_DATA_ORDER_ALIGNED
 * isn't defined.
 */
#ifndef HASH_BLOCK_DATA_ORDER
#error ""HASH_BLOCK_DATA_ORDER must be defined!""
#endif
#endif

#ifndef HASH_LBLOCK
#define HASH_LBLOCK	(HASH_CBLOCK/4)
#endif

#ifndef HASH_LONG_LOG2
#define HASH_LONG_LOG2	2
#endif

/*
 * Engage compiler specific rotate intrinsic function if available.
 */
#undef ROTATE
#ifndef PEDANTIC
# if 0 /* defined(_MSC_VER) */
#  define ROTATE(a,n)	_lrotl(a,n)
# elif defined(__MWERKS__)
#  if defined(__POWERPC__)
#   define ROTATE(a,n)	(unsigned MD32_REG_T)__rlwinm((int)a,n,0,31)
#  elif defined(__MC68K__)
    /* Motorola specific tweak. <appro@fy.chalmers.se> */
#   define ROTATE(a,n)	(n<24 ? __rol(a,n) : __ror(a,32-n))
#  else
#   define ROTATE(a,n)	__rol(a,n)
#  endif
# elif defined(__GNUC__) && __GNUC__>=2 && !defined(OPENSSL_NO_ASM) && !defined(OPENSSL_NO_INLINE_ASM)
  /*
   * Some GNU C inline assembler templates. Note that these are
   * rotates by *constant* number of bits! But that's exactly
   * what we need here...
   *
   * 					<appro@fy.chalmers.se>
   */
#  if defined(__i386) || defined(__i386__) || defined(__x86_64) || defined(__x86_64__)
#   define ROTATE(a,n)	({ register unsigned int ret;	\
				asm (			\
				""roll %1,%0""		\
				: ""=r""(ret)		\
				: ""I""(n), ""0""((unsigned int)a)	\
				: ""cc"");		\
			   ret;				\
			})
#  elif defined(__powerpc) || defined(__ppc)
#   define ROTATE(a,n)	({ register unsigned int ret;	\
				asm (			\
				""rlwinm %0,%1,%2,0,31""	\
				: ""=r""(ret)		\
				: ""r""(a), ""I""(n));	\
			   ret;				\
			})
#  endif
# endif

/*
 * Engage compiler specific ""fetch in reverse byte order""
 * intrinsic function if available.
 */
# if defined(__GNUC__) && __GNUC__>=2 && !defined(OPENSSL_NO_ASM) && !defined(OPENSSL_NO_INLINE_ASM)
  /* some GNU C inline assembler templates by <appro@fy.chalmers.se> */
#  if (defined(__i386) || defined(__i386__) || defined(__x86_64) || defined(__x86_64__)) && !defined(I386_ONLY)
#   define BE_FETCH32(a)	({ register unsigned int l=(a);\
				asm (			\
				""bswapl %0""		\
				: ""=r""(l) : ""0""(l));	\
			  l;				\
			})
#  elif defined(__powerpc)
#   define LE_FETCH32(a)	({ register unsigned int l;	\
				asm (			\
				""lwbrx %0,0,%1""		\
				: ""=r""(l)		\
				: ""r""(a));		\
			   l;				\
			})

#  elif defined(__sparc) && defined(OPENSSL_SYS_ULTRASPARC)
#  define LE_FETCH32(a)	({ register unsigned int l;		\
				asm (				\
				""lda [%1]#ASI_PRIMARY_LITTLE,%0""\
				: ""=r""(l)			\
				: ""r""(a));			\
			   l;					\
			})
#  endif
# endif
#endif /* PEDANTIC */

#if HASH_LONG_LOG2==2	/* Engage only if sizeof(HASH_LONG)== 4 */
/* A nice byte order reversal from Wei Dai <weidai@eskimo.com> */
#ifdef ROTATE
/* 5 instructions with rotate instruction, else 9 */
#define REVERSE_FETCH32(a,l)	(					\
		l=*(const HASH_LONG *)(a),				\
		((ROTATE(l,8)&0x00FF00FF)|(ROTATE((l&0x00FF00FF),24)))	\
				)
#else
/* 6 instructions with rotate instruction, else 8 */
#define REVERSE_FETCH32(a,l)	(				\
		l=*(const HASH_LONG *)(a),			\
		l=(((l>>8)&0x00FF00FF)|((l&0x00FF00FF)<<8)),	\
		ROTATE(l,16)					\
				)
/*
 * Originally the middle line started with l=(((l&0xFF00FF00)>>8)|...
 * It's rewritten as above for two reasons:
 *	- RISCs aren't good at long constants and have to explicitely
 *	  compose 'em with several (well, usually 2) instructions in a
 *	  register before performing the actual operation and (as you
 *	  already realized:-) having same constant should inspire the
 *	  compiler to permanently allocate the only register for it;
 *	- most modern CPUs have two ALUs, but usually only one has
 *	  circuitry for shifts:-( this minor tweak inspires compiler
 *	  to schedule shift instructions in a better way...
 *
 *				<appro@fy.chalmers.se>
 */
#endif
#endif

#ifndef ROTATE
#define ROTATE(a,n)     (((a)<<(n))|(((a)&0xffffffff)>>(32-(n))))
#endif

/*
 * Make some obvious choices. E.g., HASH_BLOCK_DATA_ORDER_ALIGNED
 * and HASH_BLOCK_HOST_ORDER ought to be the same if input data
 * and host are of the same ""endianess"". It's possible to mask
 * this with blank #define HASH_BLOCK_DATA_ORDER though...
 *
 *				<appro@fy.chalmers.se>
 */
#if defined(B_ENDIAN)
#  if defined(DATA_ORDER_IS_BIG_ENDIAN)
#    if !defined(HASH_BLOCK_DATA_ORDER_ALIGNED) && HASH_LONG_LOG2==2
#      define HASH_BLOCK_DATA_ORDER_ALIGNED	HASH_BLOCK_HOST_ORDER
#    endif
#  elif defined(DATA_ORDER_IS_LITTLE_ENDIAN)
#    ifndef HOST_FETCH32
#      ifdef LE_FETCH32
#        define HOST_FETCH32(p,l)	LE_FETCH32(p)
#      elif defined(REVERSE_FETCH32)
#        define HOST_FETCH32(p,l)	REVERSE_FETCH32(p,l)
#      endif
#    endif
#  endif
#elif defined(L_ENDIAN)
#  if defined(DATA_ORDER_IS_LITTLE_ENDIAN)
#    if !defined(HASH_BLOCK_DATA_ORDER_ALIGNED) && HASH_LONG_LOG2==2
#      define HASH_BLOCK_DATA_ORDER_ALIGNED	HASH_BLOCK_HOST_ORDER
#    endif
#  elif defined(DATA_ORDER_IS_BIG_ENDIAN)
#    ifndef HOST_FETCH32
#      ifdef BE_FETCH32
#        define HOST_FETCH32(p,l)	BE_FETCH32(p)
#      elif defined(REVERSE_FETCH32)
#        define HOST_FETCH32(p,l)	REVERSE_FETCH32(p,l)
#      endif
#    endif
#  endif
#endif

#if !defined(HASH_BLOCK_DATA_ORDER_ALIGNED)
#ifndef HASH_BLOCK_DATA_ORDER
#error ""HASH_BLOCK_DATA_ORDER must be defined!""
#endif
#endif

#if defined(DATA_ORDER_IS_BIG_ENDIAN)

#define HOST_c2l(c,l)	(l =(((unsigned long)(*((c)++)))<<24),		\
			 l|=(((unsigned long)(*((c)++)))<<16),		\
			 l|=(((unsigned long)(*((c)++)))<< 8),		\
			 l|=(((unsigned long)(*((c)++)))    ),		\
			 l)
#define HOST_p_c2l(c,l,n)	{					\
			switch (n) {					\
			case 0: l =((unsigned long)(*((c)++)))<<24;	\
			case 1: l|=((unsigned long)(*((c)++)))<<16;	\
			case 2: l|=((unsigned long)(*((c)++)))<< 8;	\
			case 3: l|=((unsigned long)(*((c)++)));		\
				} }
#define HOST_p_c2l_p(c,l,sc,len) {					\
			switch (sc) {					\
			case 0: l =((unsigned long)(*((c)++)))<<24;	\
				if (--len == 0) break;			\
			case 1: l|=((unsigned long)(*((c)++)))<<16;	\
				if (--len == 0) break;			\
			case 2: l|=((unsigned long)(*((c)++)))<< 8;	\
				} }
/* NOTE the pointer is not incremented at the end of this */
#define HOST_c2l_p(c,l,n)	{					\
			l=0; (c)+=n;					\
			switch (n) {					\
			case 3: l =((unsigned long)(*(--(c))))<< 8;	\
			case 2: l|=((unsigned long)(*(--(c))))<<16;	\
			case 1: l|=((unsigned long)(*(--(c))))<<24;	\
				} }
#define HOST_l2c(l,c)	(*((c)++)=(unsigned char)(((l)>>24)&0xff),	\
			 *((c)++)=(unsigned char)(((l)>>16)&0xff),	\
			 *((c)++)=(unsigned char)(((l)>> 8)&0xff),	\
			 *((c)++)=(unsigned char)(((l)    )&0xff),	\
			 l)

#elif defined(DATA_ORDER_IS_LITTLE_ENDIAN)

#define HOST_c2l(c,l)	(l =(((unsigned long)(*((c)++)))    ),		\
			 l|=(((unsigned long)(*((c)++)))<< 8),		\
			 l|=(((unsigned long)(*((c)++)))<<16),		\
			 l|=(((unsigned long)(*((c)++)))<<24),		\
			 l)
#define HOST_p_c2l(c,l,n)	{					\
			switch (n) {					\
			case 0: l =((unsigned long)(*((c)++)));		\
			case 1: l|=((unsigned long)(*((c)++)))<< 8;	\
			case 2: l|=((unsigned long)(*((c)++)))<<16;	\
			case 3: l|=((unsigned long)(*((c)++)))<<24;	\
				} }
#define HOST_p_c2l_p(c,l,sc,len) {					\
			switch (sc) {					\
			case 0: l =((unsigned long)(*((c)++)));		\
				if (--len == 0) break;			\
			case 1: l|=((unsigned long)(*((c)++)))<< 8;	\
				if (--len == 0) break;			\
			case 2: l|=((unsigned long)(*((c)++)))<<16;	\
				} }
/* NOTE the pointer is not incremented at the end of this */
#define HOST_c2l_p(c,l,n)	{					\
			l=0; (c)+=n;					\
			switch (n) {					\
			case 3: l =((unsigned long)(*(--(c))))<<16;	\
			case 2: l|=((unsigned long)(*(--(c))))<< 8;	\
			case 1: l|=((unsigned long)(*(--(c))));		\
				} }
#define HOST_l2c(l,c)	(*((c)++)=(unsigned char)(((l)    )&0xff),	\
			 *((c)++)=(unsigned char)(((l)>> 8)&0xff),	\
			 *((c)++)=(unsigned char)(((l)>>16)&0xff),	\
			 *((c)++)=(unsigned char)(((l)>>24)&0xff),	\
			 l)

#endif

/*
 * Time for some action:-)
 */

int HASH_UPDATE (HASH_CTX *c, const void *data_, unsigned long len)
	{
	const unsigned char *data=(const unsigned char *)data_;
	register HASH_LONG * p;
	register unsigned long l;
	int sw,sc,ew,ec;

	if (len==0) return 1;

	l=(c->Nl+(len<<3))&0xffffffffL;
	/* 95-05-24 eay Fixed a bug with the overflow handling, thanks to
	 * Wei Dai <weidai@eskimo.com> for pointing it out. */
	if (l < c->Nl) /* overflow */
		c->Nh++;
	c->Nh+=(len>>29);
	c->Nl=l;

	if (c->num != 0)
		{
		p=c->data;
		sw=c->num>>2;
		sc=c->num&0x03;

		if ((c->num+len) >= HASH_CBLOCK)
			{
			l=p[sw]; HOST_p_c2l(data,l,sc); p[sw++]=l;
			for (; sw<HASH_LBLOCK; sw++)
				{
				HOST_c2l(data,l); p[sw]=l;
				}
			HASH_BLOCK_HOST_ORDER (c,p,1);
			len-=(HASH_CBLOCK-c->num);
			c->num=0;
			/* drop through and do the rest */
			}
		else
			{
			c->num+=len;
			if ((sc+len) < 4) /* ugly, add char's to a word */
				{
				l=p[sw]; HOST_p_c2l_p(data,l,sc,len); p[sw]=l;
				}
			else
				{
				ew=(c->num>>2);
				ec=(c->num&0x03);
				if (sc)
					l=p[sw];
				HOST_p_c2l(data,l,sc);
				p[sw++]=l;
				for (; sw < ew; sw++)
					{
					HOST_c2l(data,l); p[sw]=l;
					}
				if (ec)
					{
					HOST_c2l_p(data,l,ec); p[sw]=l;
					}
				}
			return 1;
			}
		}

	sw=(int)(len/HASH_CBLOCK);
	if (sw > 0)
		{
#if defined(HASH_BLOCK_DATA_ORDER_ALIGNED)
		/*
		 * Note that HASH_BLOCK_DATA_ORDER_ALIGNED gets defined
		 * only if sizeof(HASH_LONG)==4.
		 */
		if ((((unsigned long)data)%4) == 0)
			{
			/* data is properly aligned so that we can cast it: */
			HASH_BLOCK_DATA_ORDER_ALIGNED (c,(HASH_LONG *)data,sw);
			sw*=HASH_CBLOCK;
			data+=sw;
			len-=sw;
			}
		else
#if !defined(HASH_BLOCK_DATA_ORDER)
			while (sw--)
				{
				mDNSPlatformMemCopy(p=c->data,data,HASH_CBLOCK);
				HASH_BLOCK_DATA_ORDER_ALIGNED(c,p,1);
				data+=HASH_CBLOCK;
				len-=HASH_CBLOCK;
				}
#endif
#endif
#if defined(HASH_BLOCK_DATA_ORDER)
			{
			HASH_BLOCK_DATA_ORDER(c,data,sw);
			sw*=HASH_CBLOCK;
			data+=sw;
			len-=sw;
			}
#endif
		}

	if (len!=0)
		{
		p = c->data;
		c->num = (int)len;
		ew=(int)(len>>2);	/* words to copy */
		ec=(int)(len&0x03);
		for (; ew; ew--,p++)
			{
			HOST_c2l(data,l); *p=l;
			}
		HOST_c2l_p(data,l,ec);
		*p=l;
		}
	return 1;
	}


void HASH_TRANSFORM (HASH_CTX *c, const unsigned char *data)
	{
#if defined(HASH_BLOCK_DATA_ORDER_ALIGNED)
	if ((((unsigned long)data)%4) == 0)
		/* data is properly aligned so that we can cast it: */
		HASH_BLOCK_DATA_ORDER_ALIGNED (c,(HASH_LONG *)data,1);
	else
#if !defined(HASH_BLOCK_DATA_ORDER)
		{
		mDNSPlatformMemCopy(c->data,data,HASH_CBLOCK);
		HASH_BLOCK_DATA_ORDER_ALIGNED (c,c->data,1);
		}
#endif
#endif
#if defined(HASH_BLOCK_DATA_ORDER)
	HASH_BLOCK_DATA_ORDER (c,data,1);
#endif
	}


int HASH_FINAL (unsigned char *md, HASH_CTX *c)
	{
	register HASH_LONG *p;
	register unsigned long l;
	register int i,j;
	static const unsigned char end[4]={0x80,0x00,0x00,0x00};
	const unsigned char *cp=end;

	/* c->num should definitly have room for at least one more byte. */
	p=c->data;
	i=c->num>>2;
	j=c->num&0x03;

#if 0
	/* purify often complains about the following line as an
	 * Uninitialized Memory Read.  While this can be true, the
	 * following p_c2l macro will reset l when that case is true.
	 * This is because j&0x03 contains the number of 'valid' bytes
	 * already in p[i].  If and only if j&0x03 == 0, the UMR will
	 * occur but this is also the only time p_c2l will do
	 * l= *(cp++) instead of l|= *(cp++)
	 * Many thanks to Alex Tang <altitude@cic.net> for pickup this
	 * 'potential bug' */
#ifdef PURIFY
	if (j==0) p[i]=0; /* Yeah, but that's not the way to fix it:-) */
#endif
	l=p[i];
#else
	l = (j==0) ? 0 : p[i];
#endif
	HOST_p_c2l(cp,l,j); p[i++]=l; /* i is the next 'undefined word' */

	if (i>(HASH_LBLOCK-2)) /* save room for Nl and Nh */
		{
		if (i<HASH_LBLOCK) p[i]=0;
		HASH_BLOCK_HOST_ORDER (c,p,1);
		i=0;
		}
	for (; i<(HASH_LBLOCK-2); i++)
		p[i]=0;

#if   defined(DATA_ORDER_IS_BIG_ENDIAN)
	p[HASH_LBLOCK-2]=c->Nh;
	p[HASH_LBLOCK-1]=c->Nl;
#elif defined(DATA_ORDER_IS_LITTLE_ENDIAN)
	p[HASH_LBLOCK-2]=c->Nl;
	p[HASH_LBLOCK-1]=c->Nh;
#endif
	HASH_BLOCK_HOST_ORDER (c,p,1);

#ifndef HASH_MAKE_STRING
#error ""HASH_MAKE_STRING must be defined!""
#else
	HASH_MAKE_STRING(c,md);
#endif

	c->num=0;
	/* clear stuff, HASH_BLOCK may be leaving some stuff on the stack
	 * but I'm not worried :-)
	OPENSSL_cleanse((void *)c,sizeof(HASH_CTX));
	 */
	return 1;
	}

#ifndef MD32_REG_T
#define MD32_REG_T long
/*
 * This comment was originaly written for MD5, which is why it
 * discusses A-D. But it basically applies to all 32-bit digests,
 * which is why it was moved to common header file.
 *
 * In case you wonder why A-D are declared as long and not
 * as mDNSu32. Doing so results in slight performance
 * boost on LP64 architectures. The catch is we don't
 * really care if 32 MSBs of a 64-bit register get polluted
 * with eventual overflows as we *save* only 32 LSBs in
 * *either* case. Now declaring 'em long excuses the compiler
 * from keeping 32 MSBs zeroed resulting in 13% performance
 * improvement under SPARC Solaris7/64 and 5% under AlphaLinux.
 * Well, to be honest it should say that this *prevents* 
 * performance degradation.
 *				<appro@fy.chalmers.se>
 * Apparently there're LP64 compilers that generate better
 * code if A-D are declared int. Most notably GCC-x86_64
 * generates better code.
 *				<appro@fy.chalmers.se>
 */
#endif


// from md5_locl.h (continued)

/*
#define	F(x,y,z)	(((x) & (y))  |  ((~(x)) & (z)))
#define	G(x,y,z)	(((x) & (z))  |  ((y) & (~(z))))
*/

/* As pointed out by Wei Dai <weidai@eskimo.com>, the above can be
 * simplified to the code below.  Wei attributes these optimizations
 * to Peter Gutmann's SHS code, and he attributes it to Rich Schroeppel.
 */
#define	F(b,c,d)	((((c) ^ (d)) & (b)) ^ (d))
#define	G(b,c,d)	((((b) ^ (c)) & (d)) ^ (c))
#define	H(b,c,d)	((b) ^ (c) ^ (d))
#define	I(b,c,d)	(((~(d)) | (b)) ^ (c))

#define R0(a,b,c,d,k,s,t) { \
	a+=((k)+(t)+F((b),(c),(d))); \
	a=ROTATE(a,s); \
	a+=b; };\

#define R1(a,b,c,d,k,s,t) { \
	a+=((k)+(t)+G((b),(c),(d))); \
	a=ROTATE(a,s); \
	a+=b; };

#define R2(a,b,c,d,k,s,t) { \
	a+=((k)+(t)+H((b),(c),(d))); \
	a=ROTATE(a,s); \
	a+=b; };

#define R3(a,b,c,d,k,s,t) { \
	a+=((k)+(t)+I((b),(c),(d))); \
	a=ROTATE(a,s); \
	a+=b; };
	
// from md5_dgst.c


/* Implemented from RFC1321 The MD5 Message-Digest Algorithm
 */

#define INIT_DATA_A (unsigned long)0x67452301L
#define INIT_DATA_B (unsigned long)0xefcdab89L
#define INIT_DATA_C (unsigned long)0x98badcfeL
#define INIT_DATA_D (unsigned long)0x10325476L

int MD5_Init(MD5_CTX *c)
	{
	c->A=INIT_DATA_A;
	c->B=INIT_DATA_B;
	c->C=INIT_DATA_C;
	c->D=INIT_DATA_D;
	c->Nl=0;
	c->Nh=0;
	c->num=0;
	return 1;
	}

#ifndef md5_block_host_order
void md5_block_host_order (MD5_CTX *c, const void *data, int num)
	{
	const mDNSu32 *X=(const mDNSu32 *)data;
	register unsigned MD32_REG_T A,B,C,D;

	A=c->A;
	B=c->B;
	C=c->C;
	D=c->D;

	for (;num--;X+=HASH_LBLOCK)
		{
	/* Round 0 */
	R0(A,B,C,D,X[ 0], 7,0xd76aa478L);
	R0(D,A,B,C,X[ 1],12,0xe8c7b756L);
	R0(C,D,A,B,X[ 2],17,0x242070dbL);
	R0(B,C,D,A,X[ 3],22,0xc1bdceeeL);
	R0(A,B,C,D,X[ 4], 7,0xf57c0fafL);
	R0(D,A,B,C,X[ 5],12,0x4787c62aL);
	R0(C,D,A,B,X[ 6],17,0xa8304613L);
	R0(B,C,D,A,X[ 7],22,0xfd469501L);
	R0(A,B,C,D,X[ 8], 7,0x698098d8L);
	R0(D,A,B,C,X[ 9],12,0x8b44f7afL);
	R0(C,D,A,B,X[10],17,0xffff5bb1L);
	R0(B,C,D,A,X[11],22,0x895cd7beL);
	R0(A,B,C,D,X[12], 7,0x6b901122L);
	R0(D,A,B,C,X[13],12,0xfd987193L);
	R0(C,D,A,B,X[14],17,0xa679438eL);
	R0(B,C,D,A,X[15],22,0x49b40821L);
	/* Round 1 */
	R1(A,B,C,D,X[ 1], 5,0xf61e2562L);
	R1(D,A,B,C,X[ 6], 9,0xc040b340L);
	R1(C,D,A,B,X[11],14,0x265e5a51L);
	R1(B,C,D,A,X[ 0],20,0xe9b6c7aaL);
	R1(A,B,C,D,X[ 5], 5,0xd62f105dL);
	R1(D,A,B,C,X[10], 9,0x02441453L);
	R1(C,D,A,B,X[15],14,0xd8a1e681L);
	R1(B,C,D,A,X[ 4],20,0xe7d3fbc8L);
	R1(A,B,C,D,X[ 9], 5,0x21e1cde6L);
	R1(D,A,B,C,X[14], 9,0xc33707d6L);
	R1(C,D,A,B,X[ 3],14,0xf4d50d87L);
	R1(B,C,D,A,X[ 8],20,0x455a14edL);
	R1(A,B,C,D,X[13], 5,0xa9e3e905L);
	R1(D,A,B,C,X[ 2], 9,0xfcefa3f8L);
	R1(C,D,A,B,X[ 7],14,0x676f02d9L);
	R1(B,C,D,A,X[12],20,0x8d2a4c8aL);
	/* Round 2 */
	R2(A,B,C,D,X[ 5], 4,0xfffa3942L);
	R2(D,A,B,C,X[ 8],11,0x8771f681L);
	R2(C,D,A,B,X[11],16,0x6d9d6122L);
	R2(B,C,D,A,X[14],23,0xfde5380cL);
	R2(A,B,C,D,X[ 1], 4,0xa4beea44L);
	R2(D,A,B,C,X[ 4],11,0x4bdecfa9L);
	R2(C,D,A,B,X[ 7],16,0xf6bb4b60L);
	R2(B,C,D,A,X[10],23,0xbebfbc70L);
	R2(A,B,C,D,X[13], 4,0x289b7ec6L);
	R2(D,A,B,C,X[ 0],11,0xeaa127faL);
	R2(C,D,A,B,X[ 3],16,0xd4ef3085L);
	R2(B,C,D,A,X[ 6],23,0x04881d05L);
	R2(A,B,C,D,X[ 9], 4,0xd9d4d039L);
	R2(D,A,B,C,X[12],11,0xe6db99e5L);
	R2(C,D,A,B,X[15],16,0x1fa27cf8L);
	R2(B,C,D,A,X[ 2],23,0xc4ac5665L);
	/* Round 3 */
	R3(A,B,C,D,X[ 0], 6,0xf4292244L);
	R3(D,A,B,C,X[ 7],10,0x432aff97L);
	R3(C,D,A,B,X[14],15,0xab9423a7L);
	R3(B,C,D,A,X[ 5],21,0xfc93a039L);
	R3(A,B,C,D,X[12], 6,0x655b59c3L);
	R3(D,A,B,C,X[ 3],10,0x8f0ccc92L);
	R3(C,D,A,B,X[10],15,0xffeff47dL);
	R3(B,C,D,A,X[ 1],21,0x85845dd1L);
	R3(A,B,C,D,X[ 8], 6,0x6fa87e4fL);
	R3(D,A,B,C,X[15],10,0xfe2ce6e0L);
	R3(C,D,A,B,X[ 6],15,0xa3014314L);
	R3(B,C,D,A,X[13],21,0x4e0811a1L);
	R3(A,B,C,D,X[ 4], 6,0xf7537e82L);
	R3(D,A,B,C,X[11],10,0xbd3af235L);
	R3(C,D,A,B,X[ 2],15,0x2ad7d2bbL);
	R3(B,C,D,A,X[ 9],21,0xeb86d391L);

	A = c->A += A;
	B = c->B += B;
	C = c->C += C;
	D = c->D += D;
		}
	}
#endif

#ifndef md5_block_data_order
#ifdef X
#undef X
#endif
void md5_block_data_order (MD5_CTX *c, const void *data_, int num)
	{
	const unsigned char *data=data_;
	register unsigned MD32_REG_T A,B,C,D,l;
#ifndef MD32_XARRAY
	/* See comment in crypto/sha/sha_locl.h for details. */
	unsigned MD32_REG_T	XX0, XX1, XX2, XX3, XX4, XX5, XX6, XX7,
				XX8, XX9,XX10,XX11,XX12,XX13,XX14,XX15;
# define X(i)	XX##i
#else
	mDNSu32 XX[MD5_LBLOCK];
# define X(i)	XX[i]
#endif

	A=c->A;
	B=c->B;
	C=c->C;
	D=c->D;

	for (;num--;)
		{
	HOST_c2l(data,l); X( 0)=l;		HOST_c2l(data,l); X( 1)=l;
	/* Round 0 */
	R0(A,B,C,D,X( 0), 7,0xd76aa478L);	HOST_c2l(data,l); X( 2)=l;
	R0(D,A,B,C,X( 1),12,0xe8c7b756L);	HOST_c2l(data,l); X( 3)=l;
	R0(C,D,A,B,X( 2),17,0x242070dbL);	HOST_c2l(data,l); X( 4)=l;
	R0(B,C,D,A,X( 3),22,0xc1bdceeeL);	HOST_c2l(data,l); X( 5)=l;
	R0(A,B,C,D,X( 4), 7,0xf57c0fafL);	HOST_c2l(data,l); X( 6)=l;
	R0(D,A,B,C,X( 5),12,0x4787c62aL);	HOST_c2l(data,l); X( 7)=l;
	R0(C,D,A,B,X( 6),17,0xa8304613L);	HOST_c2l(data,l); X( 8)=l;
	R0(B,C,D,A,X( 7),22,0xfd469501L);	HOST_c2l(data,l); X( 9)=l;
	R0(A,B,C,D,X( 8), 7,0x698098d8L);	HOST_c2l(data,l); X(10)=l;
	R0(D,A,B,C,X( 9),12,0x8b44f7afL);	HOST_c2l(data,l); X(11)=l;
	R0(C,D,A,B,X(10),17,0xffff5bb1L);	HOST_c2l(data,l); X(12)=l;
	R0(B,C,D,A,X(11),22,0x895cd7beL);	HOST_c2l(data,l); X(13)=l;
	R0(A,B,C,D,X(12), 7,0x6b901122L);	HOST_c2l(data,l); X(14)=l;
	R0(D,A,B,C,X(13),12,0xfd987193L);	HOST_c2l(data,l); X(15)=l;
	R0(C,D,A,B,X(14),17,0xa679438eL);
	R0(B,C,D,A,X(15),22,0x49b40821L);
	/* Round 1 */
	R1(A,B,C,D,X( 1), 5,0xf61e2562L);
	R1(D,A,B,C,X( 6), 9,0xc040b340L);
	R1(C,D,A,B,X(11),14,0x265e5a51L);
	R1(B,C,D,A,X( 0),20,0xe9b6c7aaL);
	R1(A,B,C,D,X( 5), 5,0xd62f105dL);
	R1(D,A,B,C,X(10), 9,0x02441453L);
	R1(C,D,A,B,X(15),14,0xd8a1e681L);
	R1(B,C,D,A,X( 4),20,0xe7d3fbc8L);
	R1(A,B,C,D,X( 9), 5,0x21e1cde6L);
	R1(D,A,B,C,X(14), 9,0xc33707d6L);
	R1(C,D,A,B,X( 3),14,0xf4d50d87L);
	R1(B,C,D,A,X( 8),20,0x455a14edL);
	R1(A,B,C,D,X(13), 5,0xa9e3e905L);
	R1(D,A,B,C,X( 2), 9,0xfcefa3f8L);
	R1(C,D,A,B,X( 7),14,0x676f02d9L);
	R1(B,C,D,A,X(12),20,0x8d2a4c8aL);
	/* Round 2 */
	R2(A,B,C,D,X( 5), 4,0xfffa3942L);
	R2(D,A,B,C,X( 8),11,0x8771f681L);
	R2(C,D,A,B,X(11),16,0x6d9d6122L);
	R2(B,C,D,A,X(14),23,0xfde5380cL);
	R2(A,B,C,D,X( 1), 4,0xa4beea44L);
	R2(D,A,B,C,X( 4),11,0x4bdecfa9L);
	R2(C,D,A,B,X( 7),16,0xf6bb4b60L);
	R2(B,C,D,A,X(10),23,0xbebfbc70L);
	R2(A,B,C,D,X(13), 4,0x289b7ec6L);
	R2(D,A,B,C,X( 0),11,0xeaa127faL);
	R2(C,D,A,B,X( 3),16,0xd4ef3085L);
	R2(B,C,D,A,X( 6),23,0x04881d05L);
	R2(A,B,C,D,X( 9), 4,0xd9d4d039L);
	R2(D,A,B,C,X(12),11,0xe6db99e5L);
	R2(C,D,A,B,X(15),16,0x1fa27cf8L);
	R2(B,C,D,A,X( 2),23,0xc4ac5665L);
	/* Round 3 */
	R3(A,B,C,D,X( 0), 6,0xf4292244L);
	R3(D,A,B,C,X( 7),10,0x432aff97L);
	R3(C,D,A,B,X(14),15,0xab9423a7L);
	R3(B,C,D,A,X( 5),21,0xfc93a039L);
	R3(A,B,C,D,X(12), 6,0x655b59c3L);
	R3(D,A,B,C,X( 3),10,0x8f0ccc92L);
	R3(C,D,A,B,X(10),15,0xffeff47dL);
	R3(B,C,D,A,X( 1),21,0x85845dd1L);
	R3(A,B,C,D,X( 8), 6,0x6fa87e4fL);
	R3(D,A,B,C,X(15),10,0xfe2ce6e0L);
	R3(C,D,A,B,X( 6),15,0xa3014314L);
	R3(B,C,D,A,X(13),21,0x4e0811a1L);
	R3(A,B,C,D,X( 4), 6,0xf7537e82L);
	R3(D,A,B,C,X(11),10,0xbd3af235L);
	R3(C,D,A,B,X( 2),15,0x2ad7d2bbL);
	R3(B,C,D,A,X( 9),21,0xeb86d391L);

	A = c->A += A;
	B = c->B += B;
	C = c->C += C;
	D = c->D += D;
		}
	}
#endif


 // ***************************************************************************
#if COMPILER_LIKES_PRAGMA_MARK
#pragma mark - base64 -> binary conversion
#endif

static const char Base64[] = ""ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"";
static const char Pad64 = '=';


#define mDNSisspace(x) (x == '\t' || x == '\n' || x == '\v' || x == '\f' || x == '\r' || x == ' ')

mDNSlocal const char *mDNSstrchr(const char *s, int c)
	{
	while (1)
		{
		if (c == *s) return s;
		if (!*s) return mDNSNULL;
		s++;
		}
	}

// skips all whitespace anywhere.
// converts characters, four at a time, starting at (or after)
// src from base - 64 numbers into three 8 bit bytes in the target area.
// it returns the number of data bytes stored at the target, or -1 on error.
// adapted from BIND sources

mDNSlocal mDNSs32 DNSDigest_Base64ToBin(const char *src, mDNSu8 *target, mDNSu32 targsize)
	{
	int tarindex, state, ch;
	const char *pos;

	state = 0;
	tarindex = 0;

	while ((ch = *src++) != '\0') {
		if (mDNSisspace(ch))	/* Skip whitespace anywhere. */
			continue;

		if (ch == Pad64)
			break;

		pos = mDNSstrchr(Base64, ch);
		if (pos == 0) 		/* A non-base64 character. */
			return (-1);

		switch (state) {
		case 0:
			if (target) {
				if ((mDNSu32)tarindex >= targsize)
					return (-1);
				target[tarindex] = (mDNSu8)((pos - Base64) << 2);
			}
			state = 1;
			break;
		case 1:
			if (target) {
				if ((mDNSu32)tarindex + 1 >= targsize)
					return (-1);
				target[tarindex]   |=  (pos - Base64) >> 4;
				target[tarindex+1]  = (mDNSu8)(((pos - Base64) & 0x0f) << 4);
			}
			tarindex++;
			state = 2;
			break;
		case 2:
			if (target) {
				if ((mDNSu32)tarindex + 1 >= targsize)
					return (-1);
				target[tarindex]   |=  (pos - Base64) >> 2;
				target[tarindex+1]  = (mDNSu8)(((pos - Base64) & 0x03) << 6);
			}
			tarindex++;
			state = 3;
			break;
		case 3:
			if (target) {
				if ((mDNSu32)tarindex >= targsize)
					return (-1);
				target[tarindex] |= (pos - Base64);
			}
			tarindex++;
			state = 0;
			break;
		default:
			return -1;
		}
	}

	/*
	 * We are done decoding Base-64 chars.  Let's see if we ended
	 * on a byte boundary, and/or with erroneous trailing characters.
	 */

	if (ch == Pad64) {		/* We got a pad char. */
		ch = *src++;		/* Skip it, get next. */
		switch (state) {
		case 0:		/* Invalid = in first position */
		case 1:		/* Invalid = in second position */
			return (-1);

		case 2:		/* Valid, means one byte of info */
			/* Skip any number of spaces. */
			for ((void)mDNSNULL; ch != '\0'; ch = *src++)
				if (!mDNSisspace(ch))
					break;
			/* Make sure there is another trailing = sign. */
			if (ch != Pad64)
				return (-1);
			ch = *src++;		/* Skip the = */
			/* Fall through to ""single trailing ="" case. */
			/* FALLTHROUGH */

		case 3:		/* Valid, means two bytes of info */
			/*
			 * We know this char is an =.  Is there anything but
			 * whitespace after it?
			 */
			for ((void)mDNSNULL; ch != '\0'; ch = *src++)
				if (!mDNSisspace(ch))
					return (-1);

			/*
			 * Now make sure for cases 2 and 3 that the ""extra""
			 * bits that slopped past the last full byte were
			 * zeros.  If we don't check them, they become a
			 * subliminal channel.
			 */
			if (target && target[tarindex] != 0)
				return (-1);
		}
	} else {
		/*
		 * We ended by seeing the end of the string.  Make sure we
		 * have no partial bytes lying around.
		 */
		if (state != 0)
			return (-1);
		}

	return (tarindex);
	}


 // ***************************************************************************
#if COMPILER_LIKES_PRAGMA_MARK
#pragma mark - API exported to mDNS Core
#endif

// Constants
#define HMAC_IPAD   0x36
#define HMAC_OPAD   0x5c
#define MD5_LEN     16

#define HMAC_MD5_AlgName (*(const domainname*) ""\010"" ""hmac-md5"" ""\007"" ""sig-alg"" ""\003"" ""reg"" ""\003"" ""int"")

// Adapted from Appendix, RFC 2104
mDNSlocal void DNSDigest_ConstructHMACKey(DomainAuthInfo *info, const mDNSu8 *key, mDNSu32 len)		
	{
	MD5_CTX k;
	mDNSu8 buf[MD5_LEN];
	int i;
	
	// If key is longer than HMAC_LEN reset it to MD5(key)
	if (len > HMAC_LEN)
		{
		MD5_Init(&k);
		MD5_Update(&k, key, len);
		MD5_Final(buf, &k);
		key = buf;
		len = MD5_LEN;
		}

	// store key in pads
	mDNSPlatformMemZero(info->keydata_ipad, HMAC_LEN);
	mDNSPlatformMemZero(info->keydata_opad, HMAC_LEN);
	mDNSPlatformMemCopy(info->keydata_ipad, key, len);
	mDNSPlatformMemCopy(info->keydata_opad, key, len);

	// XOR key with ipad and opad values
	for (i = 0; i < HMAC_LEN; i++)
		{
		info->keydata_ipad[i] ^= HMAC_IPAD;
		info->keydata_opad[i] ^= HMAC_OPAD;
		}

	}

mDNSexport mDNSs32 DNSDigest_ConstructHMACKeyfromBase64(DomainAuthInfo *info, const char *b64key)
	{
	mDNSu8 keybuf[1024];
	mDNSs32 keylen = DNSDigest_Base64ToBin(b64key, keybuf, sizeof(keybuf));
	if (keylen < 0) return(keylen);
	DNSDigest_ConstructHMACKey(info, keybuf, (mDNSu32)keylen);
	return(keylen);
	}

mDNSexport void DNSDigest_SignMessage(DNSMessage *msg, mDNSu8 **end, DomainAuthInfo *info, mDNSu16 tcode)
	{
	AuthRecord tsig;
	mDNSu8  *rdata, *const countPtr = (mDNSu8 *)&msg->h.numAdditionals;	// Get existing numAdditionals value
	mDNSu32 utc32;
	mDNSu8 utc48[6];
	mDNSu8 digest[MD5_LEN];
	mDNSu8 *ptr = *end;
	mDNSu32 len;
	mDNSOpaque16 buf;
	MD5_CTX c;
	mDNSu16 numAdditionals = (mDNSu16)((mDNSu16)countPtr[0] << 8 | countPtr[1]);
	
	// Init MD5 context, digest inner key pad and message
    MD5_Init(&c);
    MD5_Update(&c, info->keydata_ipad, HMAC_LEN);
	MD5_Update(&c, (mDNSu8 *)msg, (unsigned long)(*end - (mDNSu8 *)msg));
	   
	// Construct TSIG RR, digesting variables as apporpriate
	mDNS_SetupResourceRecord(&tsig, mDNSNULL, 0, kDNSType_TSIG, 0, kDNSRecordTypeKnownUnique, mDNSNULL, mDNSNULL);

	// key name
	AssignDomainName(&tsig.namestorage, &info->keyname);
	MD5_Update(&c, info->keyname.c, DomainNameLength(&info->keyname));

	// class
	tsig.resrec.rrclass = kDNSQClass_ANY;
	buf = mDNSOpaque16fromIntVal(kDNSQClass_ANY);
	MD5_Update(&c, buf.b, sizeof(mDNSOpaque16));

	// ttl
	tsig.resrec.rroriginalttl = 0;
	MD5_Update(&c, (mDNSu8 *)&tsig.resrec.rroriginalttl, sizeof(tsig.resrec.rroriginalttl));
	
	// alg name
	AssignDomainName(&tsig.resrec.rdata->u.name, &HMAC_MD5_AlgName);
	len = DomainNameLength(&HMAC_MD5_AlgName);
	rdata = tsig.resrec.rdata->u.data + len;
	MD5_Update(&c, HMAC_MD5_AlgName.c, len);

	// time
	// get UTC (universal time), convert to 48-bit unsigned in network byte order
	utc32 = (mDNSu32)mDNSPlatformUTC();
	if (utc32 == (unsigned)-1) { LogMsg(""ERROR: DNSDigest_SignMessage - mDNSPlatformUTC returned bad time -1""); *end = mDNSNULL; }
	utc48[0] = 0;
	utc48[1] = 0;
	utc48[2] = (mDNSu8)((utc32 >> 24) & 0xff);
	utc48[3] = (mDNSu8)((utc32 >> 16) & 0xff);
	utc48[4] = (mDNSu8)((utc32 >>  8) & 0xff);
	utc48[5] = (mDNSu8)( utc32        & 0xff);

	mDNSPlatformMemCopy(rdata, utc48, 6);
	rdata += 6;              	
	MD5_Update(&c, utc48, 6);

	// 300 sec is fudge recommended in RFC 2485
	rdata[0] = (mDNSu8)((300 >> 8)  & 0xff);
	rdata[1] = (mDNSu8)( 300        & 0xff);
	MD5_Update(&c, rdata, sizeof(mDNSOpaque16));
	rdata += sizeof(mDNSOpaque16);

	// digest error (tcode) and other data len (zero) - we'll add them to the rdata later
	buf.b[0] = (mDNSu8)((tcode >> 8) & 0xff);
	buf.b[1] = (mDNSu8)( tcode       & 0xff);
	MD5_Update(&c, buf.b, sizeof(mDNSOpaque16));  // error
	buf.NotAnInteger = 0;
	MD5_Update(&c, buf.b, sizeof(mDNSOpaque16));  // other data len

	// finish the message & tsig var hash
    MD5_Final(digest, &c);
	
	// perform outer MD5 (outer key pad, inner digest)
	MD5_Init(&c);
	MD5_Update(&c, info->keydata_opad, HMAC_LEN);
	MD5_Update(&c, digest, MD5_LEN);
	MD5_Final(digest, &c);

	// set remaining rdata fields
	rdata[0] = (mDNSu8)((MD5_LEN >> 8)  & 0xff);
	rdata[1] = (mDNSu8)( MD5_LEN        & 0xff);
	rdata += sizeof(mDNSOpaque16);
	mDNSPlatformMemCopy(rdata, digest, MD5_LEN);                          // MAC
	rdata += MD5_LEN;
	rdata[0] = msg->h.id.b[0];                                            // original ID
	rdata[1] = msg->h.id.b[1];
	rdata[2] = (mDNSu8)((tcode >> 8) & 0xff);
	rdata[3] = (mDNSu8)( tcode       & 0xff);
	rdata[4] = 0;                                                         // other data len
	rdata[5] = 0;
	rdata += 6;
	
	tsig.resrec.rdlength = (mDNSu16)(rdata - tsig.resrec.rdata->u.data);
	*end = PutResourceRecordTTLJumbo(msg, ptr, &numAdditionals, &tsig.resrec, 0);
	if (!*end) { LogMsg(""ERROR: DNSDigest_SignMessage - could not put TSIG""); *end = mDNSNULL; return; }

	// Write back updated numAdditionals value
	countPtr[0] = (mDNSu8)(numAdditionals >> 8);
	countPtr[1] = (mDNSu8)(numAdditionals &  0xFF);
	}

mDNSexport mDNSBool DNSDigest_VerifyMessage(DNSMessage *msg, mDNSu8 *end, LargeCacheRecord * lcr, DomainAuthInfo *info, mDNSu16 * rcode, mDNSu16 * tcode)
	{
	mDNSu8			*	ptr = (mDNSu8*) &lcr->r.resrec.rdata->u.data;
	mDNSs32				now;
	mDNSs32				then;
	mDNSu8				thisDigest[MD5_LEN];
	mDNSu8				thatDigest[MD5_LEN];
	mDNSu32				macsize;
	mDNSOpaque16 		buf;
	mDNSu8				utc48[6];
	mDNSs32				delta;
	mDNSu16				fudge;
	domainname		*	algo;
	MD5_CTX				c;
	mDNSBool			ok = mDNSfalse;

	// We only support HMAC-MD5 for now

	algo = (domainname*) ptr;

	if (!SameDomainName(algo, &HMAC_MD5_AlgName))
		{
		LogMsg(""ERROR: DNSDigest_VerifyMessage - TSIG algorithm not supported: %##s"", algo->c);
		*rcode = kDNSFlag1_RC_NotAuth;
		*tcode = TSIG_ErrBadKey;
		ok = mDNSfalse;
		goto exit;
		}

	ptr += DomainNameLength(algo);

	// Check the times

	now = mDNSPlatformUTC();
	if (now == -1)
		{
		LogMsg(""ERROR: DNSDigest_VerifyMessage - mDNSPlatformUTC returned bad time -1"");
		*rcode = kDNSFlag1_RC_NotAuth;
		*tcode = TSIG_ErrBadTime;
		ok = mDNSfalse;
		goto exit;
		}

	// Get the 48 bit time field, skipping over the first word

	utc48[0] = *ptr++;
	utc48[1] = *ptr++;
	utc48[2] = *ptr++;
	utc48[3] = *ptr++;
	utc48[4] = *ptr++;
	utc48[5] = *ptr++;

	then  = (mDNSs32)NToH32(utc48 + sizeof(mDNSu16));

	fudge = NToH16(ptr);

	ptr += sizeof(mDNSu16);

	delta = (now > then) ? now - then : then - now;

	if (delta > fudge)
		{
		LogMsg(""ERROR: DNSDigest_VerifyMessage - time skew > %d"", fudge);
		*rcode = kDNSFlag1_RC_NotAuth;
		*tcode = TSIG_ErrBadTime;
		ok = mDNSfalse;
		goto exit;
		}

	// MAC size

	macsize = (mDNSu32) NToH16(ptr);
	
	ptr += sizeof(mDNSu16);

	// MAC

	mDNSPlatformMemCopy(thatDigest, ptr, MD5_LEN);

	// Init MD5 context, digest inner key pad and message

	MD5_Init(&c);
	MD5_Update(&c, info->keydata_ipad, HMAC_LEN);
	MD5_Update(&c, (mDNSu8*) msg, (unsigned long)(end - (mDNSu8*) msg));
	   
	// Key name

	MD5_Update(&c, lcr->r.resrec.name->c, DomainNameLength(lcr->r.resrec.name));

	// Class name

	buf = mDNSOpaque16fromIntVal(lcr->r.resrec.rrclass);
	MD5_Update(&c, buf.b, sizeof(mDNSOpaque16));

	// TTL

	MD5_Update(&c, (mDNSu8*) &lcr->r.resrec.rroriginalttl, sizeof(lcr->r.resrec.rroriginalttl));
	
	// Algorithm
 
	MD5_Update(&c, algo->c, DomainNameLength(algo));

	// Time

	MD5_Update(&c, utc48, 6);

	// Fudge

	buf = mDNSOpaque16fromIntVal(fudge);
	MD5_Update(&c, buf.b, sizeof(mDNSOpaque16));

	// Digest error and other data len (both zero) - we'll add them to the rdata later

	buf.NotAnInteger = 0;
	MD5_Update(&c, buf.b, sizeof(mDNSOpaque16));  // error
	MD5_Update(&c, buf.b, sizeof(mDNSOpaque16));  // other data len

	// Finish the message & tsig var hash

    MD5_Final(thisDigest, &c);
	
	// perform outer MD5 (outer key pad, inner digest)

	MD5_Init(&c);
	MD5_Update(&c, info->keydata_opad, HMAC_LEN);
	MD5_Update(&c, thisDigest, MD5_LEN);
	MD5_Final(thisDigest, &c);

	if (!mDNSPlatformMemSame(thisDigest, thatDigest, MD5_LEN))
		{
		LogMsg(""ERROR: DNSDigest_VerifyMessage - bad signature"");
		*rcode = kDNSFlag1_RC_NotAuth;
		*tcode = TSIG_ErrBadSig;
		ok = mDNSfalse;
		goto exit;
		}

	// set remaining rdata fields
	ok = mDNStrue;

exit:

	return ok;
	}


#ifdef __cplusplus
}
#endif
",False,
82,84,NomosTestfiles/Artistic-1.0-cl8/Artistic-1.0-cl8.txt,Artistic-1.0-cl8,"The Artistic License

Preamble

The intent of this document is to state the conditions under which a Package may be copied, such that the Copyright Holder maintains some semblance of artistic control over the development of the package, while giving the users of the package the right to use and distribute the Package in a more-or-less customary fashion, plus the right to make reasonable modifications.

Definitions:

""Package"" refers to the collection of files distributed by the Copyright Holder, and derivatives of that collection of files created through textual modification.

""Standard Version"" refers to such a Package if it has not been modified, or has been modified in accordance with the wishes of the Copyright Holder.

""Copyright Holder"" is whoever is named in the copyright or copyrights for the package.

""You"" is you, if you're thinking about copying or distributing this Package.

""Reasonable copying fee"" is whatever you can justify on the basis of media cost, duplication charges, time of people involved, and so on. (You will not be required to justify it to the Copyright Holder, but only to the computing community at large as a market that must bear the fee.)

""Freely Available"" means that no fee is charged for the item itself, though there may be fees involved in handling the item. It also means that recipients of the item may redistribute it under the same conditions they received it.

1. You may make and give away verbatim copies of the source form of the Standard Version of this Package without restriction, provided that you duplicate all of the original copyright notices and associated disclaimers.

2. You may apply bug fixes, portability fixes and other modifications derived from the Public Domain or from the Copyright Holder. A Package modified in such a way shall still be considered the Standard Version.

3. You may otherwise modify your copy of this Package in any way, provided that you insert a prominent notice in each changed file stating how and when you changed that file, and provided that you do at least ONE of the following:

a) place your modifications in the Public Domain or otherwise make them Freely Available, such as by posting said modifications to Usenet or an equivalent medium, or placing the modifications on a major archive site such as ftp.uu.net, or by allowing the Copyright Holder to include your modifications in the Standard Version of the Package.
b) use the modified Package only within your corporation or organization.
c) rename any non-standard executables so the names do not conflict with standard executables, which must also be provided, and provide a separate manual page for each non-standard executable that clearly documents how it differs from the Standard Version.
d) make other distribution arrangements with the Copyright Holder.

4. You may distribute the programs of this Package in object code or executable form, provided that you do at least ONE of the following:

a) distribute a Standard Version of the executables and library files, together with instructions (in the manual page or equivalent) on where to get the Standard Version.
b) accompany the distribution with the machine-readable source of the Package with your modifications.
c) accompany any non-standard executables with their corresponding Standard Version executables, giving the non-standard executables non-standard names, and clearly documenting the differences in manual pages (or equivalent), together with instructions on where to get the Standard Version.
d) make other distribution arrangements with the Copyright Holder.

5. You may charge a reasonable copying fee for any distribution of this Package. You may charge any fee you choose for support of this Package. You may not charge a fee for this Package itself. However, you may distribute this Package in aggregate with other (possibly commercial) programs as part of a larger (possibly commercial) software distribution provided that you do not advertise this Package as a product of your own.

6. The scripts and library files supplied as input to or produced as output from the programs of this Package do not automatically fall under the copyright of this Package, but belong to whomever generated them, and may be sold commercially, and may be aggregated with this Package.

7. C or perl subroutines supplied by you and linked into this Package shall not be considered part of this Package.

8.Aggregation of this Package with a commercial distribution is always permitted provided that the use of this Package is embedded; that is, when no overt attempt is made to make this Package's interfaces visible to the end user of the commercial distribution. Such use shall not be construed as a distribution of this Package.

9. The name of the Copyright Holder may not be used to endorse or promote products derived from this software without specific prior written permission.

10. THIS PACKAGE IS PROVIDED ""AS IS"" AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.
",False,"```
The Artistic License

Preamble

The intent of this document is to state the conditions under which a Package may be copied, such that the Copyright Holder maintains some semblance of artistic control over the development of the package, while giving the users of the package the right to use and distribute the Package in a more-or-less customary fashion, plus the right to make reasonable modifications.

Definitions:

""Package"" refers to the collection of files distributed by the Copyright Holder, and derivatives of that collection of files created through textual modification.

""Standard Version"" refers to such a Package if it has not been modified, or has been modified in accordance with the wishes of the Copyright Holder.

""Copyright Holder"" is whoever is named in the copyright or copyrights for the package.

""You"" is you, if you're thinking about copying or distributing this Package.

""Reasonable copying fee"" is whatever you can justify on the basis of media cost, duplication charges, time of people involved, and so on. (You will not be required to justify it to the Copyright Holder, but only to the computing community at large as a market that must bear the fee.)

""Freely Available"" means that no fee is charged for the item itself, though there may be fees involved in handling the item. It also means that recipients of the item may redistribute it under the same conditions they received it.

1. You may make and give away verbatim copies of the source form of the Standard Version of this Package without restriction, provided that you duplicate all of the original copyright notices and associated disclaimers.

2. You may apply bug fixes, portability fixes and other modifications derived from the Public Domain or from the Copyright Holder. A Package modified in such a way shall still be considered the Standard Version.

3. You may otherwise modify your copy of this Package in any way, provided that you insert a prominent notice in each changed file stating how and when you changed that file, and provided that you do at least ONE of the following:

a) place your modifications in the Public Domain or otherwise make them Freely Available, such as by posting said modifications to Usenet or an equivalent medium, or placing the modifications on a major archive site such as ftp.uu.net, or by allowing the Copyright Holder to include your modifications in the Standard Version of the Package.
b) use the modified Package only within your corporation or organization.
c) rename any non-standard executables so the names do not conflict with standard executables, which must also be provided, and provide a separate manual page for each non-standard executable that clearly documents how it differs from the Standard Version.
d) make other distribution arrangements with the Copyright Holder.

4. You may distribute the programs of this Package in object code or executable form, provided that you do at least ONE of the following:

a) distribute a Standard Version of the executables and library files, together with instructions (in the manual page or equivalent) on where to get the Standard Version.
b) accompany the distribution with the machine-readable source of the Package with your modifications.
c) accompany any non-standard executables with their corresponding Standard Version executables, giving the non-standard executables non-standard names, and clearly documenting the differences in manual pages (or equivalent), together with instructions on where to get the Standard Version.
d) make other distribution arrangements with the Copyright Holder.

5. You may charge a reasonable copying fee for any distribution of this Package. You may charge any fee you choose for support of this Package. You may not charge a fee for this Package itself. However, you may distribute this Package in aggregate with other (possibly commercial) programs as part of a larger (possibly commercial) software distribution provided that you do not advertise this Package as a product of your own.

6. The scripts and library files supplied as input to or produced as output from the programs of this Package do not automatically fall under the copyright of this Package, but belong to whomever generated them, and may be sold commercially, and may be aggregated with this Package.

7. C or perl subroutines supplied by you and linked into this Package shall not be considered part of this Package.

8.Aggregation of this Package with a commercial distribution is always permitted provided that the use of this Package is embedded; that is, when no overt attempt is made to make this Package's interfaces visible to the end user of the commercial distribution. Such use shall not be construed as a distribution of this Package.

9. The name of the Copyright Holder may not be used to endorse or promote products derived from this software without specific prior written permission.

10. THIS PACKAGE IS PROVIDED ""AS IS"" AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.
```"
83,85,NomosTestfiles/Artistic-1.0-Perl/Artistic-1.0-Perl.txt,Artistic-1.0-Perl,"The ""Artistic License""

Preamble

The intent of this document is to state the conditions under which a Package may be copied, such that the Copyright Holder maintains some semblance of artistic control over the development of the package, while giving the users of the package the right to use and distribute the Package in a more-or-less customary fashion, plus the right to make reasonable modifications.

Definitions:

""Package"" refers to the collection of files distributed by the Copyright Holder, and derivatives of that collection of files created through textual modification.

""Standard Version"" refers to such a Package if it has not been modified, or has been modified in accordance with the wishes of the Copyright Holder as specified below.

""Copyright Holder"" is whoever is named in the copyright or copyrights for the package.

""You"" is you, if you're thinking about copying or distributing this Package.

""Reasonable copying fee"" is whatever you can justify on the basis of media cost, duplication charges, time of people involved, and so on. (You will not be required to justify it to the Copyright Holder, but only to the computing community at large as a market that must bear the fee.)

""Freely Available"" means that no fee is charged for the item itself, though there may be fees involved in handling the item. It also means that recipients of the item may redistribute it under the same conditions they received it.

1. You may make and give away verbatim copies of the source form of the Standard Version of this Package without restriction, provided that you duplicate all of the original copyright notices and associated disclaimers.

2. You may apply bug fixes, portability fixes and other modifications derived from the Public Domain or from the Copyright Holder. A Package modified in such a way shall still be considered the Standard Version.

3. You may otherwise modify your copy of this Package in any way, provided that you insert a prominent notice in each changed file stating how and when you changed that file, and provided that you do at least ONE of the following:

a) place your modifications in the Public Domain or otherwise make them Freely Available, such as by posting said modifications to Usenet or an equivalent medium, or placing the modifications on a major archive site such as uunet.uu.net, or by allowing the Copyright Holder to include your modifications in the Standard Version of the Package.
b) use the modified Package only within your corporation or organization.
c) rename any non-standard executables so the names do not conflict with standard executables, which must also be provided, and provide a separate manual page for each non-standard executable that clearly documents how it differs from the Standard Version.
d) make other distribution arrangements with the Copyright Holder.

4. You may distribute the programs of this Package in object code or executable form, provided that you do at least ONE of the following:

a) distribute a Standard Version of the executables and library files, together with instructions (in the manual page or equivalent) on where to get the Standard Version.
b) accompany the distribution with the machine-readable source of the Package with your modifications.
c) give non-standard executables non-standard names, and clearly document the differences in manual pages (or equivalent), together with instructions on where to get the Standard Version.
d) make other distribution arrangements with the Copyright Holder.

5. You may charge a reasonable copying fee for any distribution of this Package. You may charge any fee you choose for support of this Package. You may not charge a fee for this Package itself. However, you may distribute this Package in aggregate with other (possibly commercial) programs as part of a larger (possibly commercial) software distribution provided that you do not advertise this Package as a product of your own. You may embed this Package's interpreter within an executable of yours (by linking); this shall be construed as a mere form of aggregation, provided that the complete Standard Version of the interpreter is so embedded.

6. The scripts and library files supplied as input to or produced as output from the programs of this Package do not automatically fall under the copyright of this Package, but belong to whoever generated them, and may be sold commercially, and may be aggregated with this Package. If such scripts or library files are aggregated with this Package via the so-called ""undump"" or ""unexec"" methods of producing a binary executable image, then distribution of such an image shall neither be construed as a distribution of this Package nor shall it fall under the restrictions of Paragraphs 3 and 4, provided that you do not represent such an executable image as a Standard Version of this Package.

7. C subroutines (or comparably compiled subroutines in other languages) supplied by you and linked into this Package in order to emulate subroutines and variables of the language defined by this Package shall not be considered part of this Package, but are the equivalent of input as in Paragraph 6, provided these subroutines do not change the language in any way that would cause it to fail the regression tests for the language.

8. Aggregation of this Package with a commercial distribution is always permitted provided that the use of this Package is embedded; that is, when no overt attempt is made to make this Package's interfaces visible to the end user of the commercial distribution. Such use shall not be construed as a distribution of this Package.

9. The name of the Copyright Holder may not be used to endorse or promote products derived from this software without specific prior written permission.

10. THIS PACKAGE IS PROVIDED ""AS IS"" AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.
",False,"```
The ""Artistic License""

Preamble

The intent of this document is to state the conditions under which a Package may be copied, such that the Copyright Holder maintains some semblance of artistic control over the development of the package, while giving the users of the package the right to use and distribute the Package in a more-or-less customary fashion, plus the right to make reasonable modifications.

Definitions:

""Package"" refers to the collection of files distributed by the Copyright Holder, and derivatives of that collection of files created through textual modification.

""Standard Version"" refers to such a Package if it has not been modified, or has been modified in accordance with the wishes of the Copyright Holder as specified below.

""Copyright Holder"" is whoever is named in the copyright or copyrights for the package.

""You"" is you, if you're thinking about copying or distributing this Package.

""Reasonable copying fee"" is whatever you can justify on the basis of media cost, duplication charges, time of people involved, and so on. (You will not be required to justify it to the Copyright Holder, but only to the computing community at large as a market that must bear the fee.)

""Freely Available"" means that no fee is charged for the item itself, though there may be fees involved in handling the item. It also means that recipients of the item may redistribute it under the same conditions they received it.

1. You may make and give away verbatim copies of the source form of the Standard Version of this Package without restriction, provided that you duplicate all of the original copyright notices and associated disclaimers.

2. You may apply bug fixes, portability fixes and other modifications derived from the Public Domain or from the Copyright Holder. A Package modified in such a way shall still be considered the Standard Version.

3. You may otherwise modify your copy of this Package in any way, provided that you insert a prominent notice in each changed file stating how and when you changed that file, and provided that you do at least ONE of the following:

a) place your modifications in the Public Domain or otherwise make them Freely Available, such as by posting said modifications to Usenet or an equivalent medium, or placing the modifications on a major archive site such as uunet.uu.net, or by allowing the Copyright Holder to include your modifications in the Standard Version of the Package.
b) use the modified Package only within your corporation or organization.
c) rename any non-standard executables so the names do not conflict with standard executables, which must also be provided, and provide a separate manual page for each non-standard executable that clearly documents how it differs from the Standard Version.
d) make other distribution arrangements with the Copyright Holder.

4. You may distribute the programs of this Package in object code or executable form, provided that you do at least ONE of the following:

a) distribute a Standard Version of the executables and library files, together with instructions (in the manual page or equivalent) on where to get the Standard Version.
b) accompany the distribution with the machine-readable source of the Package with your modifications.
c) give non-standard executables non-standard names, and clearly document the differences in manual pages (or equivalent), together with instructions on where to get the Standard Version.
d) make other distribution arrangements with the Copyright Holder.

5. You may charge a reasonable copying fee for any distribution of this Package. You may charge any fee you choose for support of this Package. You may not charge a fee for this Package itself. However, you may distribute this Package in aggregate with other (possibly commercial) programs as part of a larger (possibly commercial) software distribution provided that you do not advertise this Package as a product of your own. You may embed this Package's interpreter within an executable of yours (by linking); this shall be construed as a mere form of aggregation, provided that the complete Standard Version of the interpreter is so embedded.

6. The scripts and library files supplied as input to or produced as output from the programs of this Package do not automatically fall under the copyright of this Package, but belong to whoever generated them, and may be sold commercially, and may be aggregated with this Package. If such scripts or library files are aggregated with this Package via the so-called ""undump"" or ""unexec"" methods of producing a binary executable image, then distribution of such an image shall neither be construed as a distribution of this Package nor shall it fall under the restrictions of Paragraphs 3 and 4, provided that you do not represent such an executable image as a Standard Version of this Package.

7. C subroutines (or comparably compiled subroutines in other languages) supplied by you and linked into this Package in order to emulate subroutines and variables of the language defined by this Package shall not be considered part of this Package, but are the equivalent of input as in Paragraph 6, provided these subroutines do not change the language in any way that would cause it to fail the regression tests for the language.

8. Aggregation of this Package with a commercial distribution is always permitted provided that the use of this Package is embedded; that is, when no overt attempt is made to make this Package's interfaces visible to the end user of the commercial distribution. Such use shall not be construed as a distribution of this Package.

9. The name of the Copyright Holder may not be used to endorse or promote products derived from this software without specific prior written permission.

10. THIS PACKAGE IS PROVIDED ""AS IS"" AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.
```"
84,86,NomosTestfiles/Artistic/a2p.c,"Artistic-1.0
Dual-license
GPL","#ifndef lint
static const char yysccsid[] = ""@(#)yaccpar	1.9 (Berkeley) 02/21/93"";
#endif
#define YYBYACC 1
#define YYMAJOR 1
#define YYMINOR 9
#define yyclearin (yychar=(-1))
#define yyerrok (yyerrflag=0)
#define YYRECOVERING (yyerrflag!=0)
extern int yyparse(void);
#define YYPREFIX ""yy""
#line 2 ""a2p.y""
/* $RCSfile: a2p.y,v $$Revision: 4.1 $$Date: 92/08/07 18:29:12 $
 *
 *    Copyright (C) 1991, 1992, 1993, 1994, 1996, 1997, 1999, 2000,
 *    by Larry Wall and others
 *
 *    You may distribute under the terms of either the GNU General Public
 *    License or the Artistic License, as specified in the README file.
 *
 * $Log:	a2p.y,v $
 */

#include ""INTERN.h""
#include ""a2p.h""

int root;
int begins = Nullop;
int ends = Nullop;

#line 32 ""y.tab.c""
#define BEGIN 257
#define END 258
#define REGEX 259
#define SEMINEW 260
#define NEWLINE 261
#define COMMENT 262
#define FUN1 263
#define FUNN 264
#define GRGR 265
#define PRINT 266
#define PRINTF 267
#define SPRINTF_OLD 268
#define SPRINTF_NEW 269
#define SPLIT 270
#define IF 271
#define ELSE 272
#define WHILE 273
#define FOR 274
#define IN 275
#define EXIT 276
#define NEXT 277
#define BREAK 278
#define CONTINUE 279
#define RET 280
#define GETLINE 281
#define DO 282
#define SUB 283
#define GSUB 284
#define MATCH 285
#define FUNCTION 286
#define USERFUN 287
#define DELETE 288
#define ASGNOP 289
#define OROR 290
#define ANDAND 291
#define NUMBER 292
#define VAR 293
#define SUBSTR 294
#define INDEX 295
#define MATCHOP 296
#define RELOP 297
#define OR 298
#define STRING 299
#define UMINUS 300
#define NOT 301
#define INCR 302
#define DECR 303
#define FIELD 304
#define VFIELD 305
#define SVFIELD 306
#define YYERRCODE 256
short yylhs[] = {                                        -1,
    0,    3,    6,    6,    2,    2,    7,    7,    7,    7,
    7,    7,    9,    8,    8,   11,   11,   11,   11,   11,
   15,   15,   15,   15,   14,   14,   14,   14,   13,   13,
   13,   13,   12,   12,   12,   12,   18,   18,   16,   16,
   16,   16,   16,   16,   16,   16,   16,   16,   16,   16,
   16,   16,   16,   16,   16,   16,   16,   16,   16,   16,
   16,   16,   16,   16,   16,   16,   16,   16,   16,   16,
   16,   16,   16,   16,   16,   16,   16,   16,   16,   16,
   16,   16,   16,   16,   17,   17,   17,   17,   17,   10,
   10,   10,   19,   19,   19,    1,    1,   20,   20,   20,
   20,    4,    4,   21,   21,   22,   22,   22,   22,    5,
    5,   23,   23,   23,   23,   26,   26,   24,   24,   24,
   24,   24,   24,   24,   24,   24,   24,   24,   24,   24,
   27,   27,   27,   25,   25,   25,   25,   25,   25,   25,
   25,
};
short yylen[] = {                                         2,
    2,    6,    5,    2,    3,    0,    1,    5,   10,    4,
    1,    1,    1,    1,    3,    1,    1,    1,    1,    5,
    3,    4,    4,    2,    3,    3,    3,    3,    3,    3,
    1,    3,    1,    2,    5,    3,    1,    1,    1,    1,
    1,    3,    3,    3,    3,    3,    3,    3,    2,    2,
    2,    2,    2,    2,    3,    1,    2,    3,    4,    3,
    4,    1,    3,    4,    4,    4,    4,    2,    8,    6,
    8,    8,    6,    6,    6,    6,    6,    6,    6,    6,
    8,    8,    8,    8,    1,    4,    1,    1,    2,    1,
    1,    0,    4,    4,    3,    2,    0,    1,    1,    1,
    1,    2,    0,    1,    1,    2,    2,    2,    2,    2,
    0,    3,    2,    2,    1,    1,    0,    1,    4,    2,
    4,    2,    1,    1,    1,    2,    1,    1,    2,    5,
    1,    1,    1,    6,    9,    6,    7,   10,    9,    6,
    5,
};
short yydefred[] = {                                     97,
    0,    0,   99,  100,  101,   98,    0,   96,    0,    0,
   31,    0,    0,   38,    0,    0,    0,    0,    0,    0,
    0,    0,   40,    0,    0,    0,   41,    0,    0,    0,
    0,    0,   87,    0,   88,  103,    0,   11,    0,   97,
    0,    0,    0,   17,   18,   19,    0,    0,    0,  103,
  103,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,   24,
   51,   52,    0,    0,    0,    0,    0,    0,    4,    0,
  103,    0,  103,  103,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
   49,   50,    0,   68,    0,    0,    0,    0,   63,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,  104,  105,    0,  102,   55,
   32,   28,   21,    0,    0,    0,    0,    0,    0,   30,
    0,    0,    0,    0,   48,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,  103,  103,    0,    0,
   64,   65,   67,    0,    0,    0,    0,    0,    0,    0,
    0,   13,   66,   86,    0,    0,  103,    0,    0,    0,
    0,    0,    0,  124,  123,  127,    0,  103,    0,  103,
   10,  103,    0,  110,    0,  115,    0,    0,    0,   22,
    0,   61,   95,    0,    0,   97,    3,    0,    0,    0,
    0,    0,    0,    0,  103,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,  103,
  103,  103,  103,  103,    8,    0,    0,    0,    0,    0,
   73,    0,   78,    0,   77,    0,   80,    0,   79,    0,
   75,   76,    0,   70,    0,   74,  132,  131,  133,    0,
    0,    0,    0,    0,  116,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
  103,    0,    0,    0,  103,  103,  103,    0,    0,    0,
  103,   72,   71,   82,   81,   84,   83,    0,   69,    0,
    0,    0,    0,    0,    0,  130,    0,    0,    0,  136,
  140,    0,    0,    0,    9,  103,  103,    0,  137,    0,
    0,  103,  135,  139,    0,  138,
};
short yydgoto[] = {                                       1,
    2,    7,   38,   74,  128,   39,   40,   41,  171,  104,
   75,  193,   44,   45,   46,   47,   48,   49,  106,    8,
  129,  234,  194,  195,  196,  266,  260,
};
short yysindex[] = {                                      0,
    0,  -52,    0,    0,    0,    0, 6281,    0,  -83,  -65,
    0,   27,   28,    0,   43,   46,   29,   48,   50,   51,
 -218,   64,    0,  -14,   65,   66,    0, 8153, 8153, 6722,
 -176, -176,    0, 8153,    0,    0, 6722,    0, -165,    0,
  -38,  -13, 6376,    0,    0,    0,  -32, -232, 8198,    0,
    0, 7770, 8198, 8198, 8153, 8153,   47, 7835, 7883, 8153,
   69, 8198, 8198, 8153, 8153, 6722,  -57, -267,  -57,    0,
    0,    0,   -2, -210,  -41,   79,   80,   85,    0,  -52,
    0, 8153,    0,    0, 6722, 8153, 7931, 8153, 8153, 8153,
  -32, -166, 8153, 8153, 8153, 8153, 8153, 8153, -150, 6722,
    0,    0, 6770,    0, 3731,   88, -210, -210,    0, 1055,
   93,   94, 6815,  184, 8153,   92, 6892,   96, 6939, 7003,
 8198,   97,   44, 7048, 7094,    0,    0, 5585,    0,    0,
    0,    0,    0, -210, 7172, 2108, 2108,  -60, 7216,    0,
  184,  184,  184,  184,    0,   45,   45,  -57,  -57,  -57,
  -57, -176,  -60, 6770, 6332,   32,    0,    0, 5632, 5700,
    0,    0,    0, -148,  184, 8153, 8153, 8153, 8153, 8001,
  102,    0,    0,    0, 8153, 8153,    0, 8198, 8198,  107,
  121,  127, 8153,    0,    0,    0, 8153,    0, -130,    0,
    0,    0, 8045,    0,  -43,    0, 5899, 8153, -119,    0,
 8153,    0,    0, 1434, 1434,    0,    0,   37, 5431, 6447,
 6491, 6548,  134, 7281,    0, 6611, 7327, -210,  -45,  -45,
 6722, 6722, 2656, 8045, 8045, 4777,   90, -210, -210,    0,
    0,    0,    0,    0,    0, 8045, 8045, 8045, 8045,  -52,
    0, 8105,    0, 8153,    0, 8153,    0, 8153,    0, 8153,
    0,    0,  -96,    0, 8153,    0,    0,    0,    0, 8153,
 8153,  -39,  -37, 7371,    0,  124,  -89, 8198, 5967, -210,
 -210, -210, -210, -210,  144, 7449, 7493, 7560, 7604, 7648,
    0, 7726, 8045, 8045,    0,    0,    0, 6659,  146,   95,
    0,    0,    0,    0,    0,    0,    0, -210,    0, 4777,
 4777, 4777, 2656,  -51, 6722,    0, -210, 6014,  -85,    0,
    0,  151, 2656,  -35,    0,    0,    0,  152,    0, 4777,
 4777,    0,    0,    0, 4777,    0,
};
short yyrindex[] = {                                      0,
    0, 2742,    0,    0,    0,    0,  194,    0,    0,    0,
    0,   56,    0,    0,  111,    0, 3174,    0,    0,    0,
    0,    0,    0,    1,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0, 2475,    0,
 2531, 2375, 4311,    0,    0,    0, 2057, 1630, 3897,    0,
    0,    0,  154,  154,    0,    0,  382,    0,    0,    0,
    0,  154,  105,    0,    0,    0,  818,  872, 1143,    0,
    0,    0,  437, 6065,    0,  -54,  -49,  -44,    0, 2798,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
 2324,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0, 4263,  492, 6065, 6065,    0,    0,
    0,    0,    0, 3222,    0,    0,    0,    0,    0,    0,
  154,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0, 6065,    0,    0,    0, 2425,    0,    0,
 3462, 3507, 3552, 3621,    0, 1956, 2007, 1197, 1251, 1522,
 1576, 3119, 1901,    0,  -23,    0,    0,    0,    0,    0,
    0,    0,    0,    0, 3830,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,  504,  504,    0,
    0,    0,   13,    0,    0,    0,  103,    0,    0,    0,
    0,    0,  123,    0,    0,    0,    0,    0,  763,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0, 4830,  173,  242,
    0,    0,  140,  297,  350,    0,    0, 6065, 4878,    0,
    0,    0,    0,    0,    0, 3945, 4017, 4106, 4208, 2848,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,  141,    0,    0,    0,  105,    0, 4952,
 5145, 5219, 5266, 5318,    0,    0,    0,    0,    0,    0,
    0,    0,  398,  484,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0, 6065,    0,    0,
    0,    0,  161,    0,    0,    0, 5534,    0, 6180,    0,
    0,    0,  161,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,
};
short yygindex[] = {                                      0,
  -17,    0,    0, 4597,  -87,    0,    0,    0,    0,   12,
   23, 4555,  -12,   -8,   -3, 8435, 4752,    0,  -70,    0,
    0,    0, -124, -191,    0, -264,   -7,
};
#define YYTABLESIZE 8719
short yytable[] = {                                     130,
   85,  285,   82,  286,   97,  319,    6,  313,   17,   95,
   93,   82,   94,   18,   96,  233,  258,   16,   19,  159,
  160,   82,   80,   82,   76,   82,  281,   82,   77,   42,
   85,  265,  156,   78,  101,  102,   98,   85,  312,   50,
   85,   85,   85,   85,   85,   85,  197,   85,  318,   82,
  126,  127,   70,  125,   99,   62,  100,   51,   85,   85,
   85,   98,   85,   85,  111,  112,   52,   53,   61,  101,
  102,  125,  203,  122,  123,  158,   63,  241,  259,   99,
  242,   97,   54,  156,   81,   55,   95,   58,   56,   59,
   60,   96,   62,   85,   85,   79,   62,   62,   62,   62,
   62,  267,   62,   62,   64,   65,  115,  138,  121,   99,
   37,  265,   85,   62,   62,   62,   24,   62,   62,  131,
  132,  265,  153,   85,   85,  133,  145,   33,   34,   35,
  152,  158,  172,  162,  163,  166,  174,  173,   98,  168,
  269,   76,  215,  128,  208,   77,  221,   37,   62,   62,
   78,   37,   37,   37,   37,   37,   99,   37,  199,  200,
  222,  128,  227,  118,  126,  127,  223,   62,   37,   37,
   37,   84,   37,   37,  251,  309,  310,  311,   62,   62,
  268,  118,  288,  289,  292,  305,  316,  306,  240,  219,
  220,  317,  322,    1,   92,  323,  324,   92,  117,  118,
  326,  117,    0,   37,   37,    0,    0,    3,    4,    5,
  308,    0,  261,  120,    0,    0,  230,  231,  232,  257,
    0,    0,   37,   66,    0,    0,   28,    0,   29,   83,
   84,  120,    0,   37,   37,   17,   17,    0,   83,   84,
   18,   18,   92,  262,  263,   19,   19,    0,   83,   84,
   83,   84,   83,   84,   83,   84,    0,   85,   85,   85,
   85,   85,   85,   85,   85,   85,   16,   16,   85,   85,
   85,    0,  125,  125,  125,   85,   83,   84,    0,  290,
    0,   85,  122,   85,   85,   85,   85,   85,    0,   85,
   85,   85,   85,   85,   85,   85,   85,   85,    0,   85,
  122,   85,   85,   85,   85,   85,   85,    0,    0,    0,
  304,    0,   62,   62,   62,   62,   62,   62,   62,   62,
   62,   24,    0,   62,   62,   62,    0,  314,    0,    0,
   62,    0,   33,   34,   35,    0,   62,  126,   62,   62,
   62,   62,   62,    0,   62,   62,   62,   62,   62,   62,
   62,   62,   62,    0,   62,  126,   62,   62,   62,   62,
   62,   62,  128,  128,  128,    0,    0,   37,   37,   37,
   37,   37,   37,   37,   37,   37,    0,    0,   37,   37,
   37,   57,  118,  118,  118,   37,    0,    0,    0,    0,
  129,   37,    0,   37,   37,   37,   37,   37,    0,   37,
   37,   37,   37,   37,   37,   37,   37,   37,  129,   37,
    0,   37,   37,   37,   37,   37,   37,    0,   57,    0,
    0,   57,   57,   57,   57,   57,   57,    0,   57,    0,
    0,    0,  120,  120,  120,    0,   89,    0,  119,   57,
   57,    0,    0,   57,   57,    0,   12,   13,    0,    0,
    0,   14,   15,   16,    0,    0,  119,    0,    0,    0,
    0,    0,    0,    0,   17,    0,   18,   19,   20,    0,
   22,    0,    0,   89,   57,   57,   89,   89,   89,   89,
   89,   89,   27,   89,    0,   31,   32,   33,   34,   35,
    0,   91,    0,   57,   89,   89,   89,    0,   89,   89,
    0,  122,  122,  122,   57,   57,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,  121,    0,    0,    0,   91,   89,
   89,   91,   91,   91,   91,    0,   91,    0,   91,    0,
    0,    0,  121,    0,   92,    0,    0,    0,    0,   91,
   91,   91,    0,   91,   91,    0,  126,  126,  126,   89,
   89,    0,   92,    0,    0,   92,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,   91,   91,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   91,    0,    0,    0,    0,    0,  129,
  129,  129,    0,    0,   91,   91,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,   92,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,   57,   57,
   57,   57,   57,   57,   57,   57,   57,    0,    0,   57,
   57,   57,    0,    0,    0,    0,   57,  119,  119,  119,
    0,    0,   57,    0,   57,   57,   57,   57,   57,    0,
   57,   57,   57,   57,   57,   57,   57,   57,   57,    0,
   57,    0,   57,   57,   57,   57,   57,   57,    0,    0,
    0,    0,    0,   89,   89,   89,   89,   89,   89,   89,
   89,   89,    0,    0,   89,   89,   89,    0,    0,    0,
    0,   89,    0,    0,    0,    0,    0,   89,    0,   89,
   89,   89,   89,   89,    0,   89,   89,   89,   89,   89,
   89,   89,   89,   89,    0,   89,    0,   89,   89,   89,
   89,   89,   89,  121,  121,  121,    0,    0,   91,   91,
   91,   91,   91,   91,   91,   91,   91,    0,    0,   91,
   91,   91,   23,   92,   92,   92,   91,    0,   92,    0,
    0,    0,   91,    0,   91,   91,   91,   91,   91,    0,
   91,   91,   91,   91,   91,   91,   91,   91,   91,    0,
   91,    0,   91,   91,   91,   91,   91,   91,    0,   23,
    0,    0,   23,   23,   23,   23,   23,   23,    0,   23,
    0,    0,    0,    0,    0,    0,    0,   54,    0,    0,
   23,   23,   23,    0,   23,   23,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,   54,   23,   23,   54,   54,   54,
   54,   54,   54,    0,   54,    0,    0,    0,    0,    0,
    0,   39,    0,    0,   23,   54,   54,   54,    0,   54,
   54,    0,    0,    0,    0,   23,   23,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,   39,    0,
   54,   39,   39,   39,   39,   39,   39,    0,   39,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,   39,
   39,   39,    0,   39,   39,    0,    0,    0,    0,    0,
   54,   54,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,   39,   39,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   39,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,   39,   39,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,   23,
   23,   23,   23,   23,   23,   23,   23,   23,    0,    0,
   23,   23,   23,    0,    0,    0,    0,   23,    0,    0,
    0,    0,    0,   23,    0,   23,   23,   23,   23,   23,
    0,   23,   23,    0,   23,   23,   23,   23,   23,   23,
    0,   23,    0,   23,   23,   23,   23,   23,   23,    0,
    0,    0,    0,    0,   54,   54,   54,   54,   54,   54,
   54,   54,   54,    0,    0,   54,   54,   54,    0,    0,
    0,    0,   54,    0,   66,  161,    0,   28,   54,   29,
   54,   54,   54,   54,   54,    0,   54,   54,   54,   54,
   54,   54,   54,   54,   54,    0,   54,   86,   54,   54,
   54,   54,   54,   54,    0,    0,    0,    0,   39,   39,
   39,   39,   39,   39,   39,   39,   39,    0,    0,   39,
   39,   39,   53,    0,    0,    0,   39,    0,    0,    0,
    0,    0,   39,    0,   39,   39,   39,   39,   39,    0,
   39,   39,   39,   39,   39,   39,   39,   39,   39,    0,
   39,    0,   39,    0,    0,   39,   39,   39,    0,   53,
    0,    0,   53,   53,   53,   53,   53,   53,    0,   53,
    0,    0,    0,    0,    0,    0,   44,    0,    0,    0,
   53,   53,   53,    0,   53,   53,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   44,    0,   53,   44,   44,   44,   44,
   44,   44,    0,   44,    0,    0,    0,    0,    0,    0,
   45,    0,    0,    0,   44,   44,   44,    0,   44,   44,
    0,    0,    0,    0,    0,   53,   53,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,   45,    0,   44,
   45,   45,   45,   45,   45,   45,    0,   45,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,   45,   45,
   45,    0,   45,   45,    0,    0,    0,   12,   13,   44,
   44,    0,   14,   15,   16,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,   17,    0,   18,   19,   20,
    0,   22,    0,   45,    0,    0,   23,   24,   25,   26,
    0,    0,    0,   27,    0,    0,   31,   32,   33,   34,
   35,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   45,   45,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,   53,
   53,   53,   53,   53,   53,   53,   53,   53,    0,    0,
   53,   53,   53,    0,    0,    0,    0,   53,    0,    0,
    0,    0,    0,   53,    0,   53,   53,   53,   53,   53,
    0,   53,   53,   53,   53,   53,   53,   53,   53,   53,
    0,   53,    0,   53,   53,   53,   53,   53,   53,    0,
    0,    0,    0,   44,   44,   44,   44,   44,   44,   44,
   44,   44,    0,    0,   44,   44,   44,    0,    0,    0,
    0,   44,    0,   66,    0,    0,   28,   44,   29,   44,
   44,   44,   44,   44,    0,   44,   44,   44,   44,   44,
   44,   44,   44,   44,    0,   44,    0,   44,   44,   44,
   44,   44,   44,    0,    0,    0,    0,   45,   45,   45,
   45,   45,   45,   45,   45,   45,    0,    0,   45,   45,
   45,   46,    0,    0,    0,   45,    0,    0,    0,    0,
    0,   45,    0,   45,   45,   45,   45,   45,    0,   45,
   45,   45,   45,   45,   45,   45,   45,   45,    0,   45,
    0,   45,   45,   45,   45,   45,   45,    0,   46,    0,
    0,   46,   46,   46,   46,   46,   46,    0,   46,    0,
    0,    0,    0,    0,    0,   47,    0,    0,    0,   46,
   46,   46,    0,   46,   46,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,   47,    0,   46,   47,   47,   47,   47,   47,
   47,    0,   47,    0,    0,    0,    0,    0,    0,   39,
    0,    0,    0,   47,   47,   47,    0,   47,   47,    0,
    0,    0,    0,    0,   46,   46,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,   39,    0,   47,   39,
   39,   39,   39,   39,   39,    0,   39,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,   39,   39,   39,
    0,   39,   39,    0,  126,  127,   12,   13,   47,   47,
    0,   14,   15,   16,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,   17,    0,   18,   19,   20,    0,
   22,    0,   39,   39,    0,   23,   24,   25,   26,    0,
    0,    0,   27,    0,    0,   31,   32,   33,   34,   35,
    0,   39,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,   39,   39,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,   46,   46,
   46,   46,   46,   46,   46,   46,   46,    0,    0,   46,
   46,   46,    0,    0,    0,    0,   46,    0,    0,    0,
    0,    0,   46,    0,   46,   46,   46,   46,   46,    0,
   46,   46,   46,   46,   46,   46,   46,   46,   46,    0,
   46,    0,   46,   46,   46,   46,   46,   46,    0,    0,
    0,    0,   47,   47,   47,   47,   47,   47,   47,   47,
   47,    0,    0,   47,   47,   47,    0,    0,    0,    0,
   47,    0,    0,    0,    0,    0,   47,    0,   47,   47,
   47,   47,   47,    0,   47,   47,   47,   47,   47,   47,
   47,   47,   47,    0,   47,    0,   47,   47,   47,   47,
   47,   47,    0,    0,    0,    0,   39,   39,   39,   39,
   39,   39,   39,   39,   39,    0,    0,   39,   39,   39,
   36,    0,    0,    0,   39,    0,    0,    0,    0,    0,
   39,    0,   39,   39,   39,   39,   39,    0,    0,   39,
   39,   39,   39,   39,   39,   39,   39,    0,   39,    0,
   39,    0,    0,   39,   39,   39,    0,   36,    0,    0,
   36,   36,   36,   36,   36,   36,    0,   36,    0,    0,
    0,    0,    0,    0,    0,   42,    0,    0,   36,   36,
   36,    0,   36,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   36,   36,   42,   42,    0,   42,   42,
   42,    0,    0,    0,    0,    0,   43,    0,    0,    0,
    0,    0,   36,   42,   42,   42,    0,   42,   42,    0,
    0,    0,    0,   36,   36,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,   43,   43,   42,   43,
   43,   43,    0,    0,    0,    0,   33,    0,    0,    0,
    0,    0,    0,    0,   43,   43,   43,    0,   43,   43,
    0,    0,    0,    0,    0,    0,    0,    0,   42,   42,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,   33,   33,    0,   43,
   33,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,   33,   33,   33,    0,   33,   33,
    0,    0,    0,    0,    0,    0,    0,    0,    0,   43,
   43,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,   37,    0,   33,
   28,    0,   29,    0,    0,    0,    0,   36,   36,   36,
   36,   36,   36,   36,   36,   36,    0,    0,   36,   36,
   36,    0,    0,    0,    0,   36,    0,    0,    0,   33,
   33,   36,    0,   36,   36,   36,   36,   36,    0,   36,
    0,    0,   36,   36,   36,   36,   36,   36,    0,   36,
    0,   36,   36,   36,   36,   36,   36,    0,    0,    0,
    0,    0,   42,   42,   42,   42,   42,   42,   42,   42,
   42,    0,    0,   42,   42,   42,    0,    0,    0,    0,
   42,    0,    0,    0,    0,    0,   42,    0,   42,   42,
   42,   42,   42,    0,   42,   42,   42,   42,   42,   42,
   42,   42,   42,    0,   42,    0,   42,   42,   42,   42,
   42,   42,    0,   43,   43,   43,   43,   43,   43,   43,
   43,   43,    0,    0,   43,   43,   43,    0,    0,    0,
    0,   43,    0,    0,    0,    0,    0,   43,    0,   43,
   43,   43,   43,   43,    0,   43,   43,   43,   43,   43,
   43,   43,   43,   43,    0,   43,    0,   43,   43,   43,
   43,   43,   43,   33,   33,   33,   33,   33,   33,   33,
   33,   33,    0,   34,   33,   33,   33,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,   33,    0,   33,
   33,   33,   33,   33,    0,   33,   33,   33,   33,   33,
   33,   33,   33,   33,    0,   33,    0,   33,   33,   33,
   33,   33,   33,   34,   34,    0,   11,   34,  126,  127,
   12,   13,    0,    0,   14,   14,   15,   16,    0,    0,
    0,   34,   34,   34,    0,   34,   34,    0,   17,    0,
   18,   19,   20,    0,   22,    0,    0,    0,    0,   23,
   24,   25,   26,    0,    0,    0,   27,    0,   30,   31,
   32,   33,   34,   35,   14,    0,   34,   14,    0,   14,
    0,    0,    0,    0,   15,    0,    0,    0,    0,    0,
    0,    0,    0,   14,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,   34,   34,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,   15,    0,    0,   15,    0,   15,
    0,    0,    0,    0,   12,    0,    0,    0,    0,    0,
    0,    0,    0,   15,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,   14,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,   12,    0,    0,   12,    0,   12,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    7,    0,    0,   12,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,   15,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    7,    0,    0,    7,    0,    7,    0,    0,    0,    0,
   34,   34,   34,   34,   34,   34,   34,   34,   34,    7,
    0,   34,   34,   34,    0,    0,    0,   12,    0,    0,
    0,    0,    0,    0,   34,    0,   34,   34,   34,   34,
   34,    0,   34,   34,   34,   34,   34,   34,   34,   34,
   34,    0,   34,    0,   34,   34,   34,   34,   34,   34,
    0,   14,   14,   14,   14,   14,   14,   14,   14,    0,
    0,    0,   14,   14,   14,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,   14,    0,   14,   14,   14,
   14,   14,    0,    0,    0,    0,   14,   14,   14,   14,
    0,    0,    0,   14,    0,   14,   14,   14,   14,   14,
   14,   15,   15,   15,   15,   15,   15,   15,   15,    0,
    0,    0,   15,   15,   15,   66,    0,    0,   28,    0,
   29,    0,    0,    0,    0,   15,    0,   15,   15,   15,
   15,   15,    0,    0,    0,    0,   15,   15,   15,   15,
    0,    0,    0,   15,    0,   15,   15,   15,   15,   15,
   15,   12,   12,   12,   12,    0,   12,   12,   12,    0,
    0,    6,   12,   12,   12,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,   12,    0,   12,   12,   12,
   12,   12,    0,    0,    0,    0,   12,   12,   12,   12,
    0,    0,    0,   12,    0,   12,   12,   12,   12,   12,
   12,    6,    0,    0,    6,    0,    6,    7,    7,    7,
    7,    7,    7,    7,    7,    0,    0,    5,    7,    7,
    7,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    7,    0,    7,    7,    7,    7,    7,    0,    0,
    0,    0,    7,    7,    7,    7,    0,    0,    0,    7,
    0,    7,    7,    7,    7,    7,    7,    5,    0,    0,
    5,    0,    5,    0,    0,    0,    0,    2,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    6,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    2,    0,    0,
    2,    0,    2,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,   12,   13,
    5,  178,  179,   14,   15,   16,    0,    0,    0,    0,
    0,  183,  184,  185,  186,  187,   17,    0,   18,   19,
   20,    0,   22,  189,    0,    0,    0,   23,   24,   25,
   26,    0,    0,    0,   27,    0,    0,   31,   32,   33,
   34,   35,    0,    0,    0,    0,    0,    0,    0,    0,
    2,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    6,    6,
    6,    0,    0,    0,    6,    6,    0,    0,    0,    6,
    6,    6,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    6,    0,    6,    6,    6,    6,    6,    0,
    0,    0,    0,    6,    6,    6,    6,    0,    0,    0,
    6,    0,    6,    6,    6,    6,    6,    6,    0,    0,
    0,    0,    0,    0,    5,    5,    5,    0,    0,    0,
    5,    5,    0,    0,    0,    5,    5,    5,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    5,    0,
    5,    5,    5,    5,    5,    0,    0,    0,    0,    5,
    5,    5,    5,    0,    0,    0,    5,    0,    5,    5,
    5,    5,    5,    5,    2,    2,    2,    0,    0,    0,
    2,    2,    0,    0,    0,    2,    2,    2,   60,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    2,    0,
    2,    2,    2,    2,    2,    0,    0,    0,    0,    2,
    2,    2,    2,    0,    0,    0,    2,    0,    2,    2,
    2,    2,    2,    2,    0,   60,    0,    0,   60,   60,
   60,   60,   60,   60,    0,   60,    0,    0,    0,    0,
    0,    0,    0,   56,    0,    0,   60,   60,   60,    0,
   60,   60,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
   56,   60,   60,   56,   56,   56,   56,   56,   56,    0,
   56,   58,    0,    0,    0,    0,    0,    0,    0,    0,
   60,   56,   56,    0,    0,   56,   56,    0,    0,    0,
    0,   60,   60,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,   58,    0,
    0,    0,   58,   58,    0,   58,   56,   56,   58,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,   58,
   58,   58,    0,   58,   58,   56,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,   56,   56,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,   58,   58,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   58,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,   58,   58,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,   60,   60,   60,   60,   60,
   60,   60,   60,   60,    0,    0,   60,   60,   60,    0,
    0,    0,    0,   60,    0,    0,    0,    0,    0,   60,
    0,   60,   60,   60,   60,   60,    0,   60,   60,   60,
   60,    0,   60,   60,   60,   60,    0,   60,    0,   60,
   60,   60,    0,    0,    0,    0,    0,    0,    0,    0,
   56,   56,   56,   56,   56,   56,   56,   56,   56,    0,
    0,   56,   56,   56,    0,    0,    0,    0,   56,    0,
    0,    0,    0,    0,   56,    0,   56,   56,   56,   56,
   56,   29,   56,   56,   56,   56,    0,   56,   56,   56,
   56,    0,   56,    0,   56,   56,   56,    0,   58,   58,
   58,   58,   58,   58,    0,    0,   58,    0,    0,    0,
    0,    0,    0,    0,    0,    0,   58,    0,   29,    0,
    0,    0,   29,   29,    0,   29,   25,   58,   29,    0,
   58,   58,   58,   58,   58,   58,   58,   58,   58,   29,
   29,   29,   58,   29,   29,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   25,    0,    0,    0,   25,   25,    0,
   25,   27,    0,   25,   29,   29,    0,    0,    0,    0,
    0,    0,    0,    0,   25,   25,   25,    0,   25,   25,
    0,    0,    0,   29,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,   29,   29,    0,    0,   27,    0,
    0,    0,   27,   27,    0,   27,    0,    0,   27,   25,
   25,    0,    0,    0,    0,    0,    0,    0,    0,   27,
   27,   27,    0,   27,   27,    0,    0,    0,   25,    0,
   26,    0,    0,    0,    0,    0,    0,    0,    0,   25,
   25,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,   27,   27,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,   26,    0,    0,
    0,   26,   26,   27,   26,    0,    0,   26,    0,    0,
    0,    0,    0,    0,   27,   27,    0,    0,   26,   26,
   26,    0,   26,   26,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   26,   26,    0,    0,    0,   29,   29,
   29,   29,   29,   29,    0,    0,   29,    0,    0,    0,
    0,    0,   26,    0,    0,    0,   29,    0,    0,    0,
    0,    0,    0,   26,   26,    0,    0,   29,    0,    0,
   29,   29,   29,   29,   29,   29,   29,   29,   29,    0,
    0,    0,   29,   25,   25,   25,   25,   25,   25,    0,
   66,   25,    0,   28,  157,   29,    0,    0,    0,    0,
    0,   25,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,   25,   86,    0,   25,   25,   25,   25,   25,
   25,   25,   25,   25,    0,    0,    0,   25,   27,   27,
   27,   27,   27,   27,    0,    0,   27,    0,    0,    0,
    0,    0,    0,    0,    0,    0,   27,    0,    0,   59,
    0,    0,    0,    0,    0,    0,    0,   27,    0,    0,
   27,   27,   27,   27,   27,   27,   27,   27,   27,    0,
    0,    0,   27,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,   59,    0,    0,    0,
   59,   59,    0,   59,    0,    0,   59,   26,   26,   26,
   26,   26,   26,    0,    0,   26,    0,   59,   59,   59,
    0,   59,   59,    0,    0,   26,   92,    0,    0,    0,
    0,    0,    0,    0,    0,    0,   26,    0,    0,   26,
   26,   26,   26,   26,   26,   26,   26,   26,    0,    0,
    0,   26,   59,   59,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   92,    0,    0,    0,   92,   92,    0,
   92,   59,    0,   92,   20,    0,    0,    0,    0,    0,
    0,    0,   59,   59,   92,   92,   92,    0,   92,   92,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,   20,    0,    0,    0,   20,   20,    0,   20,   92,
   92,   20,    0,   12,   13,    0,    0,    0,   14,   15,
   16,    0,   20,   20,   20,    0,   20,    0,   92,    0,
    0,   17,    0,   18,   19,   20,   35,   22,    0,   92,
   92,    0,   23,   24,   25,   26,    0,    0,    0,   27,
    0,    0,   31,   32,   33,   34,   35,   20,   20,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   35,    0,    0,   20,   35,   35,    0,
   35,    0,    0,   35,    0,    0,    0,   20,   20,    0,
    0,    0,    0,    0,   35,   35,   35,    0,   35,    0,
    0,    0,    0,    0,    0,    0,   59,   59,   59,   59,
   59,   59,    0,    0,   59,    0,    0,    0,    0,    0,
    0,    0,    0,    0,   59,   93,    0,    0,    0,   35,
   35,    0,    0,    0,    0,   59,    0,    0,   59,   59,
   59,   59,   59,   59,   59,   59,   59,    0,   35,    0,
   59,    0,    0,    0,    0,    0,    0,    0,    0,   35,
   35,    0,   93,    0,    0,    0,   93,   93,    0,   93,
    0,    0,   93,   92,   92,   92,   92,   92,   92,    0,
    0,   92,    0,   93,   93,   93,    0,   93,    0,    0,
    0,   92,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,   92,    0,    0,   92,   92,   92,    0,    0,
    0,    0,   92,   92,    0,    0,    0,   92,   93,   93,
    0,   20,   20,   20,   20,   20,   20,   94,    0,   20,
    0,    0,    0,    0,    0,    0,    0,   93,    0,   20,
    0,    0,    0,    0,    0,    0,    0,    0,   93,   93,
   20,    0,    0,   20,   20,   20,    0,    0,    0,    0,
   20,   20,    0,    0,   94,   20,    0,    0,   94,   94,
    0,   94,    0,    0,   94,    0,    0,    0,    0,    0,
    0,    0,   90,    0,    0,   94,   94,   94,    0,   94,
    0,    0,    0,   35,   35,   35,   35,   35,   35,    0,
    0,   35,    0,    0,    0,    0,    0,    0,    0,    0,
    0,   35,    0,    0,    0,    0,    0,    0,    0,   90,
   94,   94,   35,   90,   90,   35,   35,   35,    0,   90,
   16,    0,   35,   35,    0,    0,    0,   35,    0,   94,
   90,   90,   90,    0,   90,    0,    0,    0,    0,    0,
   94,   94,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,   16,    0,    0,
    0,   16,   16,    0,   16,   90,   90,   16,    0,    0,
    0,    0,   93,   93,   93,   93,   93,   93,   16,   16,
   93,    0,    0,    0,   90,    0,    0,    0,    0,    0,
   93,    0,    0,    0,    0,   90,   90,    0,    0,    0,
    0,   93,    0,    0,   93,   93,   93,    0,    0,    0,
    0,   93,   93,   16,   16,    0,   93,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,   16,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   16,   16,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,   94,   94,   94,   94,   94,   94,
    0,    0,   94,    0,    0,    0,    0,    0,    0,    0,
    0,    0,   94,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   94,    0,    0,   94,   94,   94,    0,
    0,    0,    0,   94,   94,    0,    0,    0,   94,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,   90,
   90,   90,   90,   90,   90,    0,    0,   90,    0,    0,
    0,    0,    0,    0,    0,    0,    0,   90,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,   90,    0,
    0,   90,   90,   90,    0,    0,    0,    0,   90,   90,
    0,   43,    0,   90,    0,    0,    0,   16,   16,   16,
   16,   16,   16,    0,    0,   16,    0,    0,    0,    0,
    0,    0,    0,    0,   43,   16,    0,    0,    0,    0,
    0,   43,    0,    0,    0,    0,   16,    0,    0,   16,
   16,   16,    0,  105,    0,    0,  110,  105,  105,  113,
  114,   16,  117,  119,  120,    0,  105,  105,  124,  125,
   43,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,  135,    0,    0,   43,
  139,  141,  142,  143,  144,    0,  107,  108,    0,    0,
    0,    0,    0,    0,   43,    0,    0,  155,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,  165,
    0,    0,    0,    0,    0,  105,    0,  134,    0,  136,
  137,    0,    0,    0,    0,    0,    0,    0,    0,    0,
   43,   43,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,  155,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
  209,  210,  211,  212,  214,    0,    0,    0,    0,  216,
  217,    0,  105,  105,    0,    0,    0,  224,    0,    0,
    0,  225,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,  236,  204,  205,  237,    0,    0,  238,  239,
    0,    0,    0,    0,    0,    0,    0,    0,   57,    0,
    0,    0,    0,  218,    0,   43,   43,  264,    0,   68,
   68,    0,   71,   72,  226,   68,  228,    0,  229,    0,
    0,    0,    0,    0,   68,    0,  276,    0,  277,    0,
  278,    0,  279,    0,  280,    0,    0,    0,    0,  282,
    0,  253,    0,    0,  283,  284,   66,    0,    0,   28,
    0,   29,  105,    0,    0,    0,  270,  271,  272,  273,
  274,    0,    0,    0,    0,  192,    0,    0,    0,    0,
    0,    0,   43,    0,   68,   68,   68,   68,   68,   68,
    0,    0,    0,    0,    0,    0,   68,    0,    0,   43,
    0,   68,    0,    0,   68,   68,    0,    0,   68,  114,
   68,   68,  114,    0,  114,   68,   68,  298,    0,    0,
    0,  300,  301,  302,    0,    0,   68,  307,  114,    0,
   68,    0,   68,   68,   68,   68,    0,    0,    0,  190,
    0,    0,    0,  202,    0,    0,   68,    0,    0,    0,
    0,    0,  320,  321,    0,    0,   68,  113,  325,    0,
  113,    0,  113,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,  113,    0,    0,    0,
    0,    0,    0,    0,   68,    0,    0,    0,    0,    0,
    0,    0,  114,    0,  114,    0,    0,    0,    0,    0,
   68,   68,   68,   68,    0,   68,    0,   68,   68,    0,
    0,    0,    0,    0,    0,   68,   68,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,   68,   68,   68,
   68,  107,    0,    0,  107,    0,  107,    0,    0,    0,
  113,    0,  113,    0,    0,    0,    0,    0,    0,    0,
  107,    0,    0,    0,    0,   68,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,   68,   68,   68,
   68,   68,    0,   68,   68,   68,  177,  126,  127,   12,
   13,    0,  178,  179,   14,   15,   16,  180,    0,  181,
  182,    0,  183,  184,  185,  186,  187,   17,  188,   18,
   19,   20,    0,   22,  189,    0,    0,    0,   23,   24,
   25,   26,    0,    0,  107,   27,  107,    0,   31,   32,
   33,   34,   35,    0,    0,    0,    0,    0,    0,  114,
    0,    0,  114,  114,    0,  114,  114,  114,  114,  114,
  114,  114,  114,  114,    0,  114,  114,  114,  114,  114,
  114,  114,  114,  114,  114,    0,  114,  114,    0,    0,
    0,  114,  114,  114,  114,    0,    0,    0,  114,    0,
    0,  114,  114,  114,  114,  114,    0,  113,    0,    0,
  113,  113,    0,  113,  113,  113,  113,  113,  113,  113,
  113,  113,    0,  113,  113,  113,  113,  113,  113,  113,
  113,  113,  113,    0,  113,  113,    0,    0,    0,  113,
  113,  113,  113,    0,    0,    0,  113,    0,    0,  113,
  113,  113,  113,  113,  108,    0,    0,  108,    0,  108,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,  108,    0,    0,    0,    0,    0,    0,
    0,  107,    0,    0,  107,  107,    0,  107,  107,  107,
  107,  107,  107,  107,  107,  107,    0,  107,  107,  107,
  107,  107,  107,  107,  107,  107,  107,    0,  107,  107,
    0,    0,    0,  107,  107,  107,  107,    0,    0,    0,
  107,    0,    0,  107,  107,  107,  107,  107,  109,    0,
    0,  109,    0,  109,    0,    0,    0,  108,    0,  108,
    0,    0,    0,    0,    0,    0,    0,  109,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,  106,    0,    0,  106,    0,
  106,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,  106,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,  109,    0,  109,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,  112,    0,    0,
  112,    0,  112,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,  112,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,  106,    0,
  106,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,  108,    0,    0,  108,  108,    0,
  108,  108,  108,  108,  108,  108,  108,  108,  108,    0,
  108,  108,  108,  108,  108,  108,  108,  108,  108,  108,
    0,  108,  108,    0,    0,    0,  108,  108,  108,  108,
  112,    0,  112,  108,    0,    0,  108,  108,  108,  108,
  108,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
   66,  243,    0,   28,  244,   29,    0,    0,  109,    0,
    0,  109,  109,    0,  109,  109,  109,  109,  109,  109,
  109,  109,  109,   86,  109,  109,  109,  109,  109,  109,
  109,  109,  109,  109,    0,  109,  109,    0,    0,    0,
  109,  109,  109,  109,    0,    0,    0,  109,    0,    0,
  109,  109,  109,  109,  109,  106,    0,    0,  106,  106,
    0,  106,  106,  106,  106,  106,  106,  106,  106,  106,
    0,  106,  106,  106,  106,  106,  106,  106,  106,  106,
  106,    0,  106,  106,    0,    0,    0,  106,  106,  106,
  106,    0,    0,    0,  106,    0,    0,  106,  106,  106,
  106,  106,    0,  141,    0,    0,  141,  112,  141,    0,
  112,  112,    0,  112,  112,  112,  112,  112,  112,  112,
  112,  112,  141,  112,  112,  112,  112,  112,  112,  112,
  112,  112,  112,    0,  112,  112,    0,    0,    0,  112,
  112,  112,  112,    0,    0,    0,  112,    0,    0,  112,
  112,  112,  112,  112,   66,    0,    0,   28,    0,   29,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,  192,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,  141,    0,  141,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,   66,    0,    0,   28,    0,   29,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
  192,    0,    0,   12,   13,    0,    0,    0,   14,   15,
   16,    0,    0,    0,    0,    0,    0,  190,    0,  191,
    0,   17,    0,   18,   19,   20,    0,   22,    0,    0,
    0,    0,   23,   24,   25,   26,    0,    0,    0,   27,
    0,    0,   31,   32,   33,   34,   35,    0,    0,   66,
    0,    0,   28,    0,   29,    0,    0,    0,    0,    0,
    0,    0,    0,    0,  190,    0,  206,    0,  192,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,  141,    0,    0,  141,  141,    0,  141,
  141,  141,  141,  141,  141,  141,  141,  141,    0,  141,
  141,  141,  141,  141,  141,  141,  141,  141,  141,    0,
  141,  141,  190,    0,  207,  141,  141,  141,  141,    0,
    0,    0,  141,    0,    0,  141,  141,  141,  141,  141,
    0,    0,    0,    0,  177,    0,    0,   12,   13,    0,
  178,  179,   14,   15,   16,  180,    0,  181,  182,    0,
  183,  184,  185,  186,  187,   17,  188,   18,   19,   20,
    0,   22,  189,    0,    0,    0,   23,   24,   25,   26,
    0,    0,    0,   27,    0,    0,   31,   32,   33,   34,
   35,  177,    0,    0,   12,   13,    0,  178,  179,   14,
   15,   16,  180,    0,  181,  182,    0,  183,  184,  185,
  186,  187,   17,  188,   18,   19,   20,    0,   22,  189,
    0,    0,    0,   23,   24,   25,   26,    0,    0,    0,
   27,    0,    0,   31,   32,   33,   34,   35,   66,    0,
    0,   28,    0,   29,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,  192,    0,  177,
    0,    0,   12,   13,    0,  178,  179,   14,   15,   16,
  180,    0,  181,  182,    0,  183,  184,  185,  186,  187,
   17,  188,   18,   19,   20,    0,   22,  189,    0,    0,
    0,   23,   24,   25,   26,    0,    0,    0,   27,    0,
    0,   31,   32,   33,   34,   35,   66,    0,    0,   28,
    0,   29,    0,    0,    0,    0,    0,    0,    0,    0,
    0,  190,    0,  235,    0,  192,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   66,    0,    0,   28,    0,   29,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,  192,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,  190,
    0,  291,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,  111,    0,    0,  111,    0,  111,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,  111,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,  190,    0,  315,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,  177,    0,
    0,   12,   13,    0,  178,  179,   14,   15,   16,  180,
    0,  181,  182,    0,  183,  184,  185,  186,  187,   17,
  188,   18,   19,   20,    0,   22,  189,  111,    0,  111,
   23,   24,   25,   26,    0,    0,    0,   27,    0,    0,
   31,   32,   33,   34,   35,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,  134,
    0,    0,  134,    0,  134,    0,  177,    0,    0,   12,
   13,    0,  178,  179,   14,   15,   16,  180,  134,  181,
  182,    0,  183,  184,  185,  186,  187,   17,  188,   18,
   19,   20,    0,   22,  189,    0,    0,    0,   23,   24,
   25,   26,    0,    0,    0,   27,    0,    0,   31,   32,
   33,   34,   35,  177,    0,    0,   12,   13,    0,  178,
  179,   14,   15,   16,  180,    0,  181,  182,    0,  183,
  184,  185,  186,  187,   17,  188,   18,   19,   20,    0,
   22,  189,  134,    0,  134,   23,   24,   25,   26,    0,
    0,    0,   27,    0,    0,   31,   32,   33,   34,   35,
   37,    0,    0,   28,  111,   29,    0,  111,  111,    0,
  111,  111,  111,  111,  111,  111,    0,  111,  111,    0,
  111,  111,  111,  111,  111,  111,  111,  111,  111,  111,
    0,  111,  111,    0,    0,    0,  111,  111,  111,  111,
    0,    0,    0,  111,    0,    0,  111,  111,  111,  111,
  111,   66,    0,    0,   28,  157,   29,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,   89,    0,   90,   86,    0,    0,    0,    0,    0,
    0,    0,    0,   36,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,   66,    0,    0,   28,    0,
   29,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,   89,    0,   90,   86,  134,
    0,    0,  134,  134,    0,  134,  134,  134,  134,  134,
  134,    0,  134,  134,    0,  134,  134,  134,  134,  134,
  134,  134,  134,  134,  134,    0,  134,  134,    0,    0,
    0,  134,  134,  134,  134,    0,    0,    0,  134,    0,
    0,  134,  134,  134,  134,  134,   66,  245,    0,   28,
  246,   29,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,   86,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
   66,  247,    0,   28,  248,   29,    0,    9,   10,   11,
    0,    0,    0,   12,   13,    0,    0,    0,   14,   15,
   16,    0,    0,   86,    0,    0,    0,    0,    0,    0,
    0,   17,    0,   18,   19,   20,   21,   22,    0,    0,
    0,    0,   23,   24,   25,   26,    0,    0,    0,   27,
    0,   30,   31,   32,   33,   34,   35,   66,  249,    0,
   28,  250,   29,    0,   12,   13,    0,    0,    0,   14,
   15,   16,    0,    0,    0,    0,    0,    0,    0,    0,
   86,    0,   17,    0,   18,   19,   20,    0,   22,    0,
    0,    0,    0,   23,   24,   25,   26,   87,   88,    0,
   27,    0,    0,   31,   32,   33,   34,   35,   12,   13,
    0,    0,    0,   14,   15,   16,    0,    0,    0,    0,
   66,  254,    0,   28,  255,   29,   17,    0,   18,   19,
   20,    0,   22,    0,    0,    0,    0,   23,   24,   25,
   26,   87,   88,   86,   27,    0,    0,   31,   32,   33,
   34,   35,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,   37,    0,
    0,   28,    0,   29,    0,    0,    0,    0,    0,   12,
   13,    0,    0,    0,   14,   15,   16,  303,    0,    0,
    0,    0,    0,    0,    0,    0,    0,   17,    0,   18,
   19,   20,    0,   22,    0,    0,    0,    0,   23,   24,
   25,   26,    0,    0,    0,   27,    0,    0,   31,   32,
   33,   34,   35,   12,   13,    0,    0,    0,   14,   15,
   16,   37,    0,    0,   28,    0,   29,    0,    0,    0,
    0,   17,    0,   18,   19,   20,    0,   22,    0,    0,
    0,    0,   23,   24,   25,   26,    0,    0,    0,   27,
    0,    0,   31,   32,   33,   34,   35,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,  154,
   12,   13,   28,    0,   29,   14,   15,   16,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,   17,    0,
   18,   19,   20,    0,   22,    0,    0,    0,    0,   23,
   24,   25,   26,    0,    0,    0,   27,    0,    0,   31,
   32,   33,   34,   35,   66,    0,    0,   28,  164,   29,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   12,   13,    0,    0,   86,   14,   15,
   16,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,   17,    0,   18,   19,   20,    0,   22,    0,    0,
    0,    0,   23,   24,   25,   26,    0,    0,    0,   27,
    0,    0,   31,   32,   33,   34,   35,   11,    0,    0,
    0,   12,   13,    0,    0,    0,   14,   15,   16,    0,
    0,   66,    0,    0,   28,  167,   29,    0,    0,   17,
    0,   18,   19,   20,    0,   22,    0,    0,    0,    0,
   23,   24,   25,   26,   86,    0,    0,   27,    0,   30,
   31,   32,   33,   34,   35,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,   66,    0,
   11,   28,  169,   29,   12,   13,    0,    0,    0,   14,
   15,   16,    0,    0,    0,    0,    0,    0,    0,    0,
    0,   86,   17,    0,   18,   19,   20,    0,   22,    0,
    0,    0,    0,   23,   24,   25,   26,    0,    0,    0,
   27,    0,   30,   31,   32,   33,   34,   35,   11,    0,
    0,    0,   12,   13,    0,    0,    0,   14,   15,   16,
    0,    0,   66,    0,    0,   28,  170,   29,    0,    0,
   17,    0,   18,   19,   20,    0,   22,    0,    0,    0,
    0,   23,   24,   25,   26,   86,    0,    0,   27,    0,
   30,   31,   32,   33,   34,   35,    0,   12,   13,    0,
    0,    0,   14,   15,   16,    0,    0,   66,    0,    0,
   28,  175,   29,    0,    0,   17,    0,   18,   19,   20,
    0,   22,    0,    0,    0,    0,   23,   24,   25,   26,
   86,    0,    0,   27,    0,    0,   31,   32,   33,   34,
   35,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   66,    0,    0,   28,  176,   29,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,   12,   13,   86,    0,    0,   14,
   15,   16,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,   17,    0,   18,   19,   20,    0,   22,    0,
    0,    0,    0,   23,   24,   25,   26,    0,    0,    0,
   27,    0,    0,   31,   32,   33,   34,   35,    0,    0,
    0,   12,   13,    0,    0,    0,   14,   15,   16,    0,
    0,   66,    0,    0,   28,    0,   29,    0,    0,   17,
    0,   18,   19,   20,    0,   22,    0,    0,    0,  198,
   23,   24,   25,   26,   86,    0,    0,   27,    0,    0,
   31,   32,   33,   34,   35,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,   66,    0,    0,   28,    0,
   29,    0,    0,    0,    0,   12,   13,    0,    0,    0,
   14,   15,   16,  201,    0,    0,    0,    0,   86,    0,
    0,    0,    0,   17,    0,   18,   19,   20,    0,   22,
    0,    0,    0,    0,   23,   24,   25,   26,    0,    0,
    0,   27,    0,    0,   31,   32,   33,   34,   35,    0,
   12,   13,    0,    0,    0,   14,   15,   16,    0,    0,
   66,  252,    0,   28,    0,   29,    0,    0,   17,    0,
   18,   19,   20,    0,   22,    0,    0,    0,    0,   23,
   24,   25,   26,   86,    0,    0,   27,    0,    0,   31,
   32,   33,   34,   35,    0,    0,   12,   13,    0,    0,
    0,   14,   15,   16,    0,    0,   66,  256,    0,   28,
    0,   29,    0,    0,   17,    0,   18,   19,   20,    0,
   22,    0,    0,    0,    0,   23,   24,   25,   26,   86,
    0,    0,   27,    0,    0,   31,   32,   33,   34,   35,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
   66,  287,    0,   28,    0,   29,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   86,   12,   13,    0,    0,    0,   14,
   15,   16,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,   17,    0,   18,   19,   20,    0,   22,    0,
    0,    0,    0,   23,   24,   25,   26,    0,    0,    0,
   27,    0,    0,   31,   32,   33,   34,   35,   12,   13,
    0,    0,    0,   14,   15,   16,    0,    0,   66,  293,
    0,   28,    0,   29,    0,    0,   17,    0,   18,   19,
   20,    0,   22,    0,    0,    0,    0,   23,   24,   25,
   26,   86,    0,    0,   27,    0,    0,   31,   32,   33,
   34,   35,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,   66,  294,    0,   28,    0,   29,    0,    0,
    0,    0,    0,   12,   13,    0,    0,    0,   14,   15,
   16,    0,    0,    0,    0,   86,    0,    0,    0,    0,
    0,   17,    0,   18,   19,   20,    0,   22,    0,    0,
    0,    0,   23,   24,   25,   26,    0,    0,    0,   27,
    0,    0,   31,   32,   33,   34,   35,    0,    0,   12,
   13,    0,    0,    0,   14,   15,   16,    0,    0,   66,
  295,    0,   28,    0,   29,    0,    0,   17,    0,   18,
   19,   20,    0,   22,    0,    0,    0,    0,   23,   24,
   25,   26,   86,    0,    0,   27,    0,    0,   31,   32,
   33,   34,   35,   12,   13,    0,    0,    0,   14,   15,
   16,    0,    0,   66,  296,    0,   28,    0,   29,    0,
    0,   17,    0,   18,   19,   20,    0,   22,    0,    0,
    0,    0,   23,   24,   25,   26,   86,    0,    0,   27,
    0,    0,   31,   32,   33,   34,   35,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,   66,  297,    0,
   28,    0,   29,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
   86,   12,   13,    0,    0,    0,   14,   15,   16,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,   17,
    0,   18,   19,   20,    0,   22,    0,    0,    0,    0,
   23,   24,   25,   26,    0,    0,    0,   27,    0,    0,
   31,   32,   33,   34,   35,   12,   13,    0,    0,    0,
   14,   15,   16,    0,    0,   66,  299,    0,   28,    0,
   29,    0,    0,   17,    0,   18,   19,   20,    0,   22,
    0,    0,    0,    0,   23,   24,   25,   26,   86,    0,
    0,   27,    0,    0,   31,   32,   33,   34,   35,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,   66,
  109,    0,   28,    0,   29,    0,    0,    0,    0,    0,
    0,    0,   12,   13,    0,    0,    0,   14,   15,   16,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
   17,    0,   18,   19,   20,    0,   22,    0,    0,    0,
    0,   23,   24,   25,   26,    0,    0,    0,   27,    0,
    0,   31,   32,   33,   34,   35,   12,   13,    0,    0,
    0,   14,   15,   16,   66,    0,    0,   28,    0,   29,
    0,    0,    0,    0,   17,    0,   18,   19,   20,    0,
   22,    0,    0,    0,    0,   23,   24,   25,   26,    0,
    0,    0,   27,    0,    0,   31,   32,   33,   34,   35,
   12,   13,    0,    0,    0,   14,   15,   16,    0,    0,
    0,    0,   66,    0,    0,   28,    0,   29,   17,    0,
   18,   19,   20,    0,   22,    0,    0,    0,    0,   23,
   24,   25,   26,    0,    0,    0,   27,    0,    0,   31,
   32,   33,   34,   35,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
   66,    0,    0,   28,    0,   29,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,   12,   13,
    0,    0,    0,   14,   15,   16,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,   17,    0,   18,   19,
   20,    0,   22,    0,    0,    0,    0,   23,   24,   25,
   26,    0,    0,    0,   27,    0,    0,   31,   32,   33,
   34,   35,   12,   13,    0,    0,    0,   14,   15,   16,
   66,    0,    0,   28,    0,   29,    0,    0,    0,    0,
   17,    0,   18,   19,   20,    0,   22,    0,    0,    0,
    0,   23,   24,   25,   26,    0,    0,    0,   27,    0,
    0,   31,   32,   33,   34,   35,    0,    0,    0,    0,
    0,    0,    0,    0,   66,    0,    0,   28,    0,   29,
    0,    0,    0,  116,    0,    0,    0,   12,   13,    0,
    0,    0,   14,   15,   16,    0,    0,   86,    0,    0,
    0,    0,    0,    0,    0,   17,    0,   18,   19,   20,
    0,   22,    0,    0,    0,    0,   23,   24,   25,   26,
    0,    0,    0,   27,    0,    0,   31,   32,   33,   34,
   35,  118,    0,    0,   66,   12,   13,   28,    0,   29,
   14,   15,   16,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   17,    0,   18,   19,   20,    0,   22,
    0,    0,    0,    0,   23,   24,   25,   26,    0,    0,
    0,   27,    0,    0,   31,   32,   33,   34,   35,  140,
    0,    0,   66,   12,   13,   28,    0,   29,   14,   15,
   16,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,   17,    0,   18,   19,   20,    0,   22,    0,    0,
    0,    0,   23,   24,   25,   26,    0,    0,    0,   27,
    0,    0,   31,   32,   33,   34,   35,  103,    0,    0,
   28,    0,   29,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,  213,
    0,    0,    0,   12,   13,    0,    0,    0,   14,   15,
   16,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,   17,    0,   18,   19,   20,    0,   22,    0,    0,
    0,    0,   23,   24,   25,   26,    0,    0,    0,   27,
    0,    0,   31,   32,   33,   34,   35,   12,   13,    0,
    0,    0,   14,   15,   16,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,   17,    0,   18,   19,   20,
    0,   22,    0,    0,    0,    0,   23,   24,   25,   26,
    0,    0,    0,   27,    0,    0,   31,   32,   33,   34,
   35,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,  275,    0,    0,    0,   12,   13,    0,
    0,    0,   14,   15,   16,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,   17,    0,   18,   19,   20,
    0,   22,    0,    0,    0,    0,   23,   24,   25,   26,
    0,    0,    0,   27,    0,    0,   31,   32,   33,   34,
   35,    0,    0,    0,    0,   12,   13,    0,    0,    0,
   14,   15,   16,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   17,    0,   18,   19,   20,    0,   22,
    0,    0,    0,    0,   23,   24,   25,   26,    0,    0,
    0,   27,    0,    0,   31,   32,   33,   34,   35,    0,
   12,   13,   67,   69,    0,   14,   15,   16,   73,    0,
    0,    0,    0,    0,    0,    0,    0,   91,   17,    0,
   18,   19,   20,    0,   22,    0,    0,    0,    0,   23,
   24,   25,   26,    0,    0,    0,   27,    0,    0,   31,
   32,   33,   34,   35,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,  146,  147,  148,
  149,  150,  151,    0,    0,    0,    0,    0,    0,   91,
    0,    0,    0,    0,   91,    0,    0,   91,   91,    0,
    0,   91,    0,   91,   91,    0,    0,    0,   91,   91,
    0,    0,    0,    0,    0,    0,    0,    0,    0,   91,
    0,    0,    0,   91,    0,   91,   91,   91,   91,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,   91,
    0,    0,    0,    0,    0,    0,    0,    0,    0,   91,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,   91,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,   91,   91,   91,   91,    0,   91,    0,
   91,   91,    0,    0,    0,    0,    0,    0,   91,   91,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
   91,   91,   91,   91,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
    0,    0,    0,    0,    0,    0,    0,    0,   91,    0,
    0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
   91,   91,   91,   91,   91,    0,   91,   91,   91,
};
short yycheck[] = {                                      41,
    0,   41,   63,   41,   37,   41,   59,   59,   63,   42,
   43,   63,   45,   63,   47,   59,   62,   41,   63,  107,
  108,   63,   40,   63,   37,   63,  123,   63,   37,    7,
   44,  223,  103,   37,  302,  303,   94,   37,  303,  123,
   40,   41,   42,   43,   44,   45,  134,   47,  313,   63,
  261,  262,   30,   41,  112,    0,  289,  123,   58,   59,
   60,   94,   62,   63,   53,   54,   40,   40,  287,  302,
  303,   59,   41,   62,   63,   44,   91,   41,  124,  112,
   44,   37,   40,  154,  123,   40,   42,   40,   60,   40,
   40,   47,   37,   93,   94,  261,   41,   42,   43,   44,
   45,  226,   47,   40,   40,   40,   60,   85,   40,  112,
    0,  303,  112,   58,   59,   60,  293,   62,   63,   41,
   41,  313,  100,  123,  124,   41,  293,  304,  305,  306,
  281,   44,  121,   41,   41,   44,   93,   41,   94,   44,
  228,  154,   41,   41,  293,  154,   40,   37,   93,   94,
  154,   41,   42,   43,   44,   45,  112,   47,  136,  137,
   40,   59,  293,   41,  261,  262,   40,  112,   58,   59,
   60,  291,   62,   63,   41,  300,  301,  302,  123,  124,
   91,   59,   59,  273,   41,   40,  272,   93,  206,  178,
  179,   41,   41,    0,   41,  320,  321,   93,   59,   59,
  325,   41,   -1,   93,   94,   -1,   -1,  260,  261,  262,
  298,   -1,  220,   41,   -1,   -1,  260,  261,  262,  265,
   -1,   -1,  112,   40,   -1,   -1,   43,   -1,   45,  290,
  291,   59,   -1,  123,  124,  290,  291,   -1,  290,  291,
  290,  291,  275,  221,  222,  290,  291,   -1,  290,  291,
  290,  291,  290,  291,  290,  291,   -1,  257,  258,  259,
  260,  261,  262,  263,  264,  265,  290,  291,  268,  269,
  270,   -1,  260,  261,  262,  275,  290,  291,   -1,  268,
   -1,  281,   41,  283,  284,  285,  286,  287,   -1,  289,
  290,  291,  292,  293,  294,  295,  296,  297,   -1,  299,
   59,  301,  302,  303,  304,  305,  306,   -1,   -1,   -1,
  288,   -1,  257,  258,  259,  260,  261,  262,  263,  264,
  265,  293,   -1,  268,  269,  270,   -1,  305,   -1,   -1,
  275,   -1,  304,  305,  306,   -1,  281,   41,  283,  284,
  285,  286,  287,   -1,  289,  290,  291,  292,  293,  294,
  295,  296,  297,   -1,  299,   59,  301,  302,  303,  304,
  305,  306,  260,  261,  262,   -1,   -1,  257,  258,  259,
  260,  261,  262,  263,  264,  265,   -1,   -1,  268,  269,
  270,    0,  260,  261,  262,  275,   -1,   -1,   -1,   -1,
   41,  281,   -1,  283,  284,  285,  286,  287,   -1,  289,
  290,  291,  292,  293,  294,  295,  296,  297,   59,  299,
   -1,  301,  302,  303,  304,  305,  306,   -1,   37,   -1,
   -1,   40,   41,   42,   43,   44,   45,   -1,   47,   -1,
   -1,   -1,  260,  261,  262,   -1,    0,   -1,   41,   58,
   59,   -1,   -1,   62,   63,   -1,  263,  264,   -1,   -1,
   -1,  268,  269,  270,   -1,   -1,   59,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  281,   -1,  283,  284,  285,   -1,
  287,   -1,   -1,   37,   93,   94,   40,   41,   42,   43,
   44,   45,  299,   47,   -1,  302,  303,  304,  305,  306,
   -1,    0,   -1,  112,   58,   59,   60,   -1,   62,   63,
   -1,  260,  261,  262,  123,  124,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   41,   -1,   -1,   -1,   37,   93,
   94,   40,   41,   42,   43,   -1,   45,   -1,   47,   -1,
   -1,   -1,   59,   -1,   41,   -1,   -1,   -1,   -1,   58,
   59,   60,   -1,   62,   63,   -1,  260,  261,  262,  123,
  124,   -1,   59,   -1,   -1,   62,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   93,   94,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  112,   -1,   -1,   -1,   -1,   -1,  260,
  261,  262,   -1,   -1,  123,  124,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,  124,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  257,  258,
  259,  260,  261,  262,  263,  264,  265,   -1,   -1,  268,
  269,  270,   -1,   -1,   -1,   -1,  275,  260,  261,  262,
   -1,   -1,  281,   -1,  283,  284,  285,  286,  287,   -1,
  289,  290,  291,  292,  293,  294,  295,  296,  297,   -1,
  299,   -1,  301,  302,  303,  304,  305,  306,   -1,   -1,
   -1,   -1,   -1,  257,  258,  259,  260,  261,  262,  263,
  264,  265,   -1,   -1,  268,  269,  270,   -1,   -1,   -1,
   -1,  275,   -1,   -1,   -1,   -1,   -1,  281,   -1,  283,
  284,  285,  286,  287,   -1,  289,  290,  291,  292,  293,
  294,  295,  296,  297,   -1,  299,   -1,  301,  302,  303,
  304,  305,  306,  260,  261,  262,   -1,   -1,  257,  258,
  259,  260,  261,  262,  263,  264,  265,   -1,   -1,  268,
  269,  270,    0,  260,  261,  262,  275,   -1,  265,   -1,
   -1,   -1,  281,   -1,  283,  284,  285,  286,  287,   -1,
  289,  290,  291,  292,  293,  294,  295,  296,  297,   -1,
  299,   -1,  301,  302,  303,  304,  305,  306,   -1,   37,
   -1,   -1,   40,   41,   42,   43,   44,   45,   -1,   47,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,    0,   -1,   -1,
   58,   59,   60,   -1,   62,   63,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   37,   93,   94,   40,   41,   42,
   43,   44,   45,   -1,   47,   -1,   -1,   -1,   -1,   -1,
   -1,    0,   -1,   -1,  112,   58,   59,   60,   -1,   62,
   63,   -1,   -1,   -1,   -1,  123,  124,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   37,   -1,
   93,   40,   41,   42,   43,   44,   45,   -1,   47,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   58,
   59,   60,   -1,   62,   63,   -1,   -1,   -1,   -1,   -1,
  123,  124,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   93,   94,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  112,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  123,  124,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  257,
  258,  259,  260,  261,  262,  263,  264,  265,   -1,   -1,
  268,  269,  270,   -1,   -1,   -1,   -1,  275,   -1,   -1,
   -1,   -1,   -1,  281,   -1,  283,  284,  285,  286,  287,
   -1,  289,  290,   -1,  292,  293,  294,  295,  296,  297,
   -1,  299,   -1,  301,  302,  303,  304,  305,  306,   -1,
   -1,   -1,   -1,   -1,  257,  258,  259,  260,  261,  262,
  263,  264,  265,   -1,   -1,  268,  269,  270,   -1,   -1,
   -1,   -1,  275,   -1,   40,   41,   -1,   43,  281,   45,
  283,  284,  285,  286,  287,   -1,  289,  290,  291,  292,
  293,  294,  295,  296,  297,   -1,  299,   63,  301,  302,
  303,  304,  305,  306,   -1,   -1,   -1,   -1,  257,  258,
  259,  260,  261,  262,  263,  264,  265,   -1,   -1,  268,
  269,  270,    0,   -1,   -1,   -1,  275,   -1,   -1,   -1,
   -1,   -1,  281,   -1,  283,  284,  285,  286,  287,   -1,
  289,  290,  291,  292,  293,  294,  295,  296,  297,   -1,
  299,   -1,  301,   -1,   -1,  304,  305,  306,   -1,   37,
   -1,   -1,   40,   41,   42,   43,   44,   45,   -1,   47,
   -1,   -1,   -1,   -1,   -1,   -1,    0,   -1,   -1,   -1,
   58,   59,   60,   -1,   62,   63,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   37,   -1,   93,   40,   41,   42,   43,
   44,   45,   -1,   47,   -1,   -1,   -1,   -1,   -1,   -1,
    0,   -1,   -1,   -1,   58,   59,   60,   -1,   62,   63,
   -1,   -1,   -1,   -1,   -1,  123,  124,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   37,   -1,   93,
   40,   41,   42,   43,   44,   45,   -1,   47,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   58,   59,
   60,   -1,   62,   63,   -1,   -1,   -1,  263,  264,  123,
  124,   -1,  268,  269,  270,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  281,   -1,  283,  284,  285,
   -1,  287,   -1,   93,   -1,   -1,  292,  293,  294,  295,
   -1,   -1,   -1,  299,   -1,   -1,  302,  303,  304,  305,
  306,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  123,  124,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  257,
  258,  259,  260,  261,  262,  263,  264,  265,   -1,   -1,
  268,  269,  270,   -1,   -1,   -1,   -1,  275,   -1,   -1,
   -1,   -1,   -1,  281,   -1,  283,  284,  285,  286,  287,
   -1,  289,  290,  291,  292,  293,  294,  295,  296,  297,
   -1,  299,   -1,  301,  302,  303,  304,  305,  306,   -1,
   -1,   -1,   -1,  257,  258,  259,  260,  261,  262,  263,
  264,  265,   -1,   -1,  268,  269,  270,   -1,   -1,   -1,
   -1,  275,   -1,   40,   -1,   -1,   43,  281,   45,  283,
  284,  285,  286,  287,   -1,  289,  290,  291,  292,  293,
  294,  295,  296,  297,   -1,  299,   -1,  301,  302,  303,
  304,  305,  306,   -1,   -1,   -1,   -1,  257,  258,  259,
  260,  261,  262,  263,  264,  265,   -1,   -1,  268,  269,
  270,    0,   -1,   -1,   -1,  275,   -1,   -1,   -1,   -1,
   -1,  281,   -1,  283,  284,  285,  286,  287,   -1,  289,
  290,  291,  292,  293,  294,  295,  296,  297,   -1,  299,
   -1,  301,  302,  303,  304,  305,  306,   -1,   37,   -1,
   -1,   40,   41,   42,   43,   44,   45,   -1,   47,   -1,
   -1,   -1,   -1,   -1,   -1,    0,   -1,   -1,   -1,   58,
   59,   60,   -1,   62,   63,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   37,   -1,   93,   40,   41,   42,   43,   44,
   45,   -1,   47,   -1,   -1,   -1,   -1,   -1,   -1,    0,
   -1,   -1,   -1,   58,   59,   60,   -1,   62,   63,   -1,
   -1,   -1,   -1,   -1,  123,  124,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   37,   -1,   93,   40,
   41,   42,   43,   44,   45,   -1,   47,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   58,   59,   60,
   -1,   62,   63,   -1,  261,  262,  263,  264,  123,  124,
   -1,  268,  269,  270,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  281,   -1,  283,  284,  285,   -1,
  287,   -1,   93,   94,   -1,  292,  293,  294,  295,   -1,
   -1,   -1,  299,   -1,   -1,  302,  303,  304,  305,  306,
   -1,  112,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,  123,  124,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  257,  258,
  259,  260,  261,  262,  263,  264,  265,   -1,   -1,  268,
  269,  270,   -1,   -1,   -1,   -1,  275,   -1,   -1,   -1,
   -1,   -1,  281,   -1,  283,  284,  285,  286,  287,   -1,
  289,  290,  291,  292,  293,  294,  295,  296,  297,   -1,
  299,   -1,  301,  302,  303,  304,  305,  306,   -1,   -1,
   -1,   -1,  257,  258,  259,  260,  261,  262,  263,  264,
  265,   -1,   -1,  268,  269,  270,   -1,   -1,   -1,   -1,
  275,   -1,   -1,   -1,   -1,   -1,  281,   -1,  283,  284,
  285,  286,  287,   -1,  289,  290,  291,  292,  293,  294,
  295,  296,  297,   -1,  299,   -1,  301,  302,  303,  304,
  305,  306,   -1,   -1,   -1,   -1,  257,  258,  259,  260,
  261,  262,  263,  264,  265,   -1,   -1,  268,  269,  270,
    0,   -1,   -1,   -1,  275,   -1,   -1,   -1,   -1,   -1,
  281,   -1,  283,  284,  285,  286,  287,   -1,   -1,  290,
  291,  292,  293,  294,  295,  296,  297,   -1,  299,   -1,
  301,   -1,   -1,  304,  305,  306,   -1,   37,   -1,   -1,
   40,   41,   42,   43,   44,   45,   -1,   47,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,    0,   -1,   -1,   58,   59,
   60,   -1,   62,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   93,   94,   40,   41,   -1,   43,   44,
   45,   -1,   -1,   -1,   -1,   -1,    0,   -1,   -1,   -1,
   -1,   -1,  112,   58,   59,   60,   -1,   62,   63,   -1,
   -1,   -1,   -1,  123,  124,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   40,   41,   93,   43,
   44,   45,   -1,   -1,   -1,   -1,    0,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   58,   59,   60,   -1,   62,   63,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  123,  124,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   40,   41,   -1,   93,
   44,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   58,   59,   60,   -1,   62,   63,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  123,
  124,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   40,   -1,   93,
   43,   -1,   45,   -1,   -1,   -1,   -1,  257,  258,  259,
  260,  261,  262,  263,  264,  265,   -1,   -1,  268,  269,
  270,   -1,   -1,   -1,   -1,  275,   -1,   -1,   -1,  123,
  124,  281,   -1,  283,  284,  285,  286,  287,   -1,  289,
   -1,   -1,  292,  293,  294,  295,  296,  297,   -1,  299,
   -1,  301,  302,  303,  304,  305,  306,   -1,   -1,   -1,
   -1,   -1,  257,  258,  259,  260,  261,  262,  263,  264,
  265,   -1,   -1,  268,  269,  270,   -1,   -1,   -1,   -1,
  275,   -1,   -1,   -1,   -1,   -1,  281,   -1,  283,  284,
  285,  286,  287,   -1,  289,  290,  291,  292,  293,  294,
  295,  296,  297,   -1,  299,   -1,  301,  302,  303,  304,
  305,  306,   -1,  257,  258,  259,  260,  261,  262,  263,
  264,  265,   -1,   -1,  268,  269,  270,   -1,   -1,   -1,
   -1,  275,   -1,   -1,   -1,   -1,   -1,  281,   -1,  283,
  284,  285,  286,  287,   -1,  289,  290,  291,  292,  293,
  294,  295,  296,  297,   -1,  299,   -1,  301,  302,  303,
  304,  305,  306,  257,  258,  259,  260,  261,  262,  263,
  264,  265,   -1,    0,  268,  269,  270,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,  281,   -1,  283,
  284,  285,  286,  287,   -1,  289,  290,  291,  292,  293,
  294,  295,  296,  297,   -1,  299,   -1,  301,  302,  303,
  304,  305,  306,   40,   41,   -1,  259,   44,  261,  262,
  263,  264,   -1,   -1,    0,  268,  269,  270,   -1,   -1,
   -1,   58,   59,   60,   -1,   62,   63,   -1,  281,   -1,
  283,  284,  285,   -1,  287,   -1,   -1,   -1,   -1,  292,
  293,  294,  295,   -1,   -1,   -1,  299,   -1,  301,  302,
  303,  304,  305,  306,   40,   -1,   93,   43,   -1,   45,
   -1,   -1,   -1,   -1,    0,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   59,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,  123,  124,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   40,   -1,   -1,   43,   -1,   45,
   -1,   -1,   -1,   -1,    0,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   59,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,  123,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   40,   -1,   -1,   43,   -1,   45,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
    0,   -1,   -1,   59,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,  123,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   40,   -1,   -1,   43,   -1,   45,   -1,   -1,   -1,   -1,
  257,  258,  259,  260,  261,  262,  263,  264,  265,   59,
   -1,  268,  269,  270,   -1,   -1,   -1,  123,   -1,   -1,
   -1,   -1,   -1,   -1,  281,   -1,  283,  284,  285,  286,
  287,   -1,  289,  290,  291,  292,  293,  294,  295,  296,
  297,   -1,  299,   -1,  301,  302,  303,  304,  305,  306,
   -1,  257,  258,  259,  260,  261,  262,  263,  264,   -1,
   -1,   -1,  268,  269,  270,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  281,   -1,  283,  284,  285,
  286,  287,   -1,   -1,   -1,   -1,  292,  293,  294,  295,
   -1,   -1,   -1,  299,   -1,  301,  302,  303,  304,  305,
  306,  257,  258,  259,  260,  261,  262,  263,  264,   -1,
   -1,   -1,  268,  269,  270,   40,   -1,   -1,   43,   -1,
   45,   -1,   -1,   -1,   -1,  281,   -1,  283,  284,  285,
  286,  287,   -1,   -1,   -1,   -1,  292,  293,  294,  295,
   -1,   -1,   -1,  299,   -1,  301,  302,  303,  304,  305,
  306,  257,  258,  259,  260,   -1,  262,  263,  264,   -1,
   -1,    0,  268,  269,  270,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  281,   -1,  283,  284,  285,
  286,  287,   -1,   -1,   -1,   -1,  292,  293,  294,  295,
   -1,   -1,   -1,  299,   -1,  301,  302,  303,  304,  305,
  306,   40,   -1,   -1,   43,   -1,   45,  257,  258,  259,
  260,  261,  262,  263,  264,   -1,   -1,    0,  268,  269,
  270,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,  281,   -1,  283,  284,  285,  286,  287,   -1,   -1,
   -1,   -1,  292,  293,  294,  295,   -1,   -1,   -1,  299,
   -1,  301,  302,  303,  304,  305,  306,   40,   -1,   -1,
   43,   -1,   45,   -1,   -1,   -1,   -1,    0,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  123,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   40,   -1,   -1,
   43,   -1,   45,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  263,  264,
  123,  266,  267,  268,  269,  270,   -1,   -1,   -1,   -1,
   -1,  276,  277,  278,  279,  280,  281,   -1,  283,  284,
  285,   -1,  287,  288,   -1,   -1,   -1,  292,  293,  294,
  295,   -1,   -1,   -1,  299,   -1,   -1,  302,  303,  304,
  305,  306,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
  123,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  257,  258,
  259,   -1,   -1,   -1,  263,  264,   -1,   -1,   -1,  268,
  269,  270,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,  281,   -1,  283,  284,  285,  286,  287,   -1,
   -1,   -1,   -1,  292,  293,  294,  295,   -1,   -1,   -1,
  299,   -1,  301,  302,  303,  304,  305,  306,   -1,   -1,
   -1,   -1,   -1,   -1,  257,  258,  259,   -1,   -1,   -1,
  263,  264,   -1,   -1,   -1,  268,  269,  270,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  281,   -1,
  283,  284,  285,  286,  287,   -1,   -1,   -1,   -1,  292,
  293,  294,  295,   -1,   -1,   -1,  299,   -1,  301,  302,
  303,  304,  305,  306,  257,  258,  259,   -1,   -1,   -1,
  263,  264,   -1,   -1,   -1,  268,  269,  270,    0,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  281,   -1,
  283,  284,  285,  286,  287,   -1,   -1,   -1,   -1,  292,
  293,  294,  295,   -1,   -1,   -1,  299,   -1,  301,  302,
  303,  304,  305,  306,   -1,   37,   -1,   -1,   40,   41,
   42,   43,   44,   45,   -1,   47,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,    0,   -1,   -1,   58,   59,   60,   -1,
   62,   63,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   37,   93,   94,   40,   41,   42,   43,   44,   45,   -1,
   47,    0,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
  112,   58,   59,   -1,   -1,   62,   63,   -1,   -1,   -1,
   -1,  123,  124,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   37,   -1,
   -1,   -1,   41,   42,   -1,   44,   93,   94,   47,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   58,
   59,   60,   -1,   62,   63,  112,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,  123,  124,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   93,   94,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  112,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  123,  124,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  257,  258,  259,  260,  261,
  262,  263,  264,  265,   -1,   -1,  268,  269,  270,   -1,
   -1,   -1,   -1,  275,   -1,   -1,   -1,   -1,   -1,  281,
   -1,  283,  284,  285,  286,  287,   -1,  289,  290,  291,
  292,   -1,  294,  295,  296,  297,   -1,  299,   -1,  301,
  302,  303,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
  257,  258,  259,  260,  261,  262,  263,  264,  265,   -1,
   -1,  268,  269,  270,   -1,   -1,   -1,   -1,  275,   -1,
   -1,   -1,   -1,   -1,  281,   -1,  283,  284,  285,  286,
  287,    0,  289,  290,  291,  292,   -1,  294,  295,  296,
  297,   -1,  299,   -1,  301,  302,  303,   -1,  257,  258,
  259,  260,  261,  262,   -1,   -1,  265,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,  275,   -1,   37,   -1,
   -1,   -1,   41,   42,   -1,   44,    0,  286,   47,   -1,
  289,  290,  291,  292,  293,  294,  295,  296,  297,   58,
   59,   60,  301,   62,   63,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   37,   -1,   -1,   -1,   41,   42,   -1,
   44,    0,   -1,   47,   93,   94,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   58,   59,   60,   -1,   62,   63,
   -1,   -1,   -1,  112,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  123,  124,   -1,   -1,   37,   -1,
   -1,   -1,   41,   42,   -1,   44,   -1,   -1,   47,   93,
   94,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   58,
   59,   60,   -1,   62,   63,   -1,   -1,   -1,  112,   -1,
    0,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  123,
  124,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   93,   94,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   37,   -1,   -1,
   -1,   41,   42,  112,   44,   -1,   -1,   47,   -1,   -1,
   -1,   -1,   -1,   -1,  123,  124,   -1,   -1,   58,   59,
   60,   -1,   62,   63,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   93,   94,   -1,   -1,   -1,  257,  258,
  259,  260,  261,  262,   -1,   -1,  265,   -1,   -1,   -1,
   -1,   -1,  112,   -1,   -1,   -1,  275,   -1,   -1,   -1,
   -1,   -1,   -1,  123,  124,   -1,   -1,  286,   -1,   -1,
  289,  290,  291,  292,  293,  294,  295,  296,  297,   -1,
   -1,   -1,  301,  257,  258,  259,  260,  261,  262,   -1,
   40,  265,   -1,   43,   44,   45,   -1,   -1,   -1,   -1,
   -1,  275,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,  286,   63,   -1,  289,  290,  291,  292,  293,
  294,  295,  296,  297,   -1,   -1,   -1,  301,  257,  258,
  259,  260,  261,  262,   -1,   -1,  265,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,  275,   -1,   -1,    0,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,  286,   -1,   -1,
  289,  290,  291,  292,  293,  294,  295,  296,  297,   -1,
   -1,   -1,  301,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   37,   -1,   -1,   -1,
   41,   42,   -1,   44,   -1,   -1,   47,  257,  258,  259,
  260,  261,  262,   -1,   -1,  265,   -1,   58,   59,   60,
   -1,   62,   63,   -1,   -1,  275,    0,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,  286,   -1,   -1,  289,
  290,  291,  292,  293,  294,  295,  296,  297,   -1,   -1,
   -1,  301,   93,   94,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   37,   -1,   -1,   -1,   41,   42,   -1,
   44,  112,   -1,   47,    0,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,  123,  124,   58,   59,   60,   -1,   62,   63,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   37,   -1,   -1,   -1,   41,   42,   -1,   44,   93,
   94,   47,   -1,  263,  264,   -1,   -1,   -1,  268,  269,
  270,   -1,   58,   59,   60,   -1,   62,   -1,  112,   -1,
   -1,  281,   -1,  283,  284,  285,    0,  287,   -1,  123,
  124,   -1,  292,  293,  294,  295,   -1,   -1,   -1,  299,
   -1,   -1,  302,  303,  304,  305,  306,   93,   94,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   37,   -1,   -1,  112,   41,   42,   -1,
   44,   -1,   -1,   47,   -1,   -1,   -1,  123,  124,   -1,
   -1,   -1,   -1,   -1,   58,   59,   60,   -1,   62,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,  257,  258,  259,  260,
  261,  262,   -1,   -1,  265,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  275,    0,   -1,   -1,   -1,   93,
   94,   -1,   -1,   -1,   -1,  286,   -1,   -1,  289,  290,
  291,  292,  293,  294,  295,  296,  297,   -1,  112,   -1,
  301,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  123,
  124,   -1,   37,   -1,   -1,   -1,   41,   42,   -1,   44,
   -1,   -1,   47,  257,  258,  259,  260,  261,  262,   -1,
   -1,  265,   -1,   58,   59,   60,   -1,   62,   -1,   -1,
   -1,  275,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,  286,   -1,   -1,  289,  290,  291,   -1,   -1,
   -1,   -1,  296,  297,   -1,   -1,   -1,  301,   93,   94,
   -1,  257,  258,  259,  260,  261,  262,    0,   -1,  265,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,  112,   -1,  275,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  123,  124,
  286,   -1,   -1,  289,  290,  291,   -1,   -1,   -1,   -1,
  296,  297,   -1,   -1,   37,  301,   -1,   -1,   41,   42,
   -1,   44,   -1,   -1,   47,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,    0,   -1,   -1,   58,   59,   60,   -1,   62,
   -1,   -1,   -1,  257,  258,  259,  260,  261,  262,   -1,
   -1,  265,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,  275,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   37,
   93,   94,  286,   41,   42,  289,  290,  291,   -1,   47,
    0,   -1,  296,  297,   -1,   -1,   -1,  301,   -1,  112,
   58,   59,   60,   -1,   62,   -1,   -1,   -1,   -1,   -1,
  123,  124,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   37,   -1,   -1,
   -1,   41,   42,   -1,   44,   93,   94,   47,   -1,   -1,
   -1,   -1,  257,  258,  259,  260,  261,  262,   58,   59,
  265,   -1,   -1,   -1,  112,   -1,   -1,   -1,   -1,   -1,
  275,   -1,   -1,   -1,   -1,  123,  124,   -1,   -1,   -1,
   -1,  286,   -1,   -1,  289,  290,  291,   -1,   -1,   -1,
   -1,  296,  297,   93,   94,   -1,  301,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,  112,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  123,  124,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  257,  258,  259,  260,  261,  262,
   -1,   -1,  265,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,  275,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  286,   -1,   -1,  289,  290,  291,   -1,
   -1,   -1,   -1,  296,  297,   -1,   -1,   -1,  301,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  257,
  258,  259,  260,  261,  262,   -1,   -1,  265,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,  275,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  286,   -1,
   -1,  289,  290,  291,   -1,   -1,   -1,   -1,  296,  297,
   -1,    7,   -1,  301,   -1,   -1,   -1,  257,  258,  259,
  260,  261,  262,   -1,   -1,  265,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   30,  275,   -1,   -1,   -1,   -1,
   -1,   37,   -1,   -1,   -1,   -1,  286,   -1,   -1,  289,
  290,  291,   -1,   49,   -1,   -1,   52,   53,   54,   55,
   56,  301,   58,   59,   60,   -1,   62,   63,   64,   65,
   66,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   82,   -1,   -1,   85,
   86,   87,   88,   89,   90,   -1,   50,   51,   -1,   -1,
   -1,   -1,   -1,   -1,  100,   -1,   -1,  103,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  115,
   -1,   -1,   -1,   -1,   -1,  121,   -1,   81,   -1,   83,
   84,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
  136,  137,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  154,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
  166,  167,  168,  169,  170,   -1,   -1,   -1,   -1,  175,
  176,   -1,  178,  179,   -1,   -1,   -1,  183,   -1,   -1,
   -1,  187,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,  198,  157,  158,  201,   -1,   -1,  204,  205,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   17,   -1,
   -1,   -1,   -1,  177,   -1,  221,  222,  223,   -1,   28,
   29,   -1,   31,   32,  188,   34,  190,   -1,  192,   -1,
   -1,   -1,   -1,   -1,   43,   -1,  242,   -1,  244,   -1,
  246,   -1,  248,   -1,  250,   -1,   -1,   -1,   -1,  255,
   -1,  215,   -1,   -1,  260,  261,   40,   -1,   -1,   43,
   -1,   45,  268,   -1,   -1,   -1,  230,  231,  232,  233,
  234,   -1,   -1,   -1,   -1,   59,   -1,   -1,   -1,   -1,
   -1,   -1,  288,   -1,   93,   94,   95,   96,   97,   98,
   -1,   -1,   -1,   -1,   -1,   -1,  105,   -1,   -1,  305,
   -1,  110,   -1,   -1,  113,  114,   -1,   -1,  117,   40,
  119,  120,   43,   -1,   45,  124,  125,  281,   -1,   -1,
   -1,  285,  286,  287,   -1,   -1,  135,  291,   59,   -1,
  139,   -1,  141,  142,  143,  144,   -1,   -1,   -1,  123,
   -1,   -1,   -1,  152,   -1,   -1,  155,   -1,   -1,   -1,
   -1,   -1,  316,  317,   -1,   -1,  165,   40,  322,   -1,
   43,   -1,   45,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   59,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  193,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,  123,   -1,  125,   -1,   -1,   -1,   -1,   -1,
  209,  210,  211,  212,   -1,  214,   -1,  216,  217,   -1,
   -1,   -1,   -1,   -1,   -1,  224,  225,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,  236,  237,  238,
  239,   40,   -1,   -1,   43,   -1,   45,   -1,   -1,   -1,
  123,   -1,  125,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   59,   -1,   -1,   -1,   -1,  264,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,  276,  277,  278,
  279,  280,   -1,  282,  283,  284,  260,  261,  262,  263,
  264,   -1,  266,  267,  268,  269,  270,  271,   -1,  273,
  274,   -1,  276,  277,  278,  279,  280,  281,  282,  283,
  284,  285,   -1,  287,  288,   -1,   -1,   -1,  292,  293,
  294,  295,   -1,   -1,  123,  299,  125,   -1,  302,  303,
  304,  305,  306,   -1,   -1,   -1,   -1,   -1,   -1,  260,
   -1,   -1,  263,  264,   -1,  266,  267,  268,  269,  270,
  271,  272,  273,  274,   -1,  276,  277,  278,  279,  280,
  281,  282,  283,  284,  285,   -1,  287,  288,   -1,   -1,
   -1,  292,  293,  294,  295,   -1,   -1,   -1,  299,   -1,
   -1,  302,  303,  304,  305,  306,   -1,  260,   -1,   -1,
  263,  264,   -1,  266,  267,  268,  269,  270,  271,  272,
  273,  274,   -1,  276,  277,  278,  279,  280,  281,  282,
  283,  284,  285,   -1,  287,  288,   -1,   -1,   -1,  292,
  293,  294,  295,   -1,   -1,   -1,  299,   -1,   -1,  302,
  303,  304,  305,  306,   40,   -1,   -1,   43,   -1,   45,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   59,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,  260,   -1,   -1,  263,  264,   -1,  266,  267,  268,
  269,  270,  271,  272,  273,  274,   -1,  276,  277,  278,
  279,  280,  281,  282,  283,  284,  285,   -1,  287,  288,
   -1,   -1,   -1,  292,  293,  294,  295,   -1,   -1,   -1,
  299,   -1,   -1,  302,  303,  304,  305,  306,   40,   -1,
   -1,   43,   -1,   45,   -1,   -1,   -1,  123,   -1,  125,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   59,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   40,   -1,   -1,   43,   -1,
   45,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   59,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,  123,   -1,  125,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   40,   -1,   -1,
   43,   -1,   45,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   59,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  123,   -1,
  125,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  260,   -1,   -1,  263,  264,   -1,
  266,  267,  268,  269,  270,  271,  272,  273,  274,   -1,
  276,  277,  278,  279,  280,  281,  282,  283,  284,  285,
   -1,  287,  288,   -1,   -1,   -1,  292,  293,  294,  295,
  123,   -1,  125,  299,   -1,   -1,  302,  303,  304,  305,
  306,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   40,   41,   -1,   43,   44,   45,   -1,   -1,  260,   -1,
   -1,  263,  264,   -1,  266,  267,  268,  269,  270,  271,
  272,  273,  274,   63,  276,  277,  278,  279,  280,  281,
  282,  283,  284,  285,   -1,  287,  288,   -1,   -1,   -1,
  292,  293,  294,  295,   -1,   -1,   -1,  299,   -1,   -1,
  302,  303,  304,  305,  306,  260,   -1,   -1,  263,  264,
   -1,  266,  267,  268,  269,  270,  271,  272,  273,  274,
   -1,  276,  277,  278,  279,  280,  281,  282,  283,  284,
  285,   -1,  287,  288,   -1,   -1,   -1,  292,  293,  294,
  295,   -1,   -1,   -1,  299,   -1,   -1,  302,  303,  304,
  305,  306,   -1,   40,   -1,   -1,   43,  260,   45,   -1,
  263,  264,   -1,  266,  267,  268,  269,  270,  271,  272,
  273,  274,   59,  276,  277,  278,  279,  280,  281,  282,
  283,  284,  285,   -1,  287,  288,   -1,   -1,   -1,  292,
  293,  294,  295,   -1,   -1,   -1,  299,   -1,   -1,  302,
  303,  304,  305,  306,   40,   -1,   -1,   43,   -1,   45,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   59,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,  123,   -1,  125,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   40,   -1,   -1,   43,   -1,   45,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   59,   -1,   -1,  263,  264,   -1,   -1,   -1,  268,  269,
  270,   -1,   -1,   -1,   -1,   -1,   -1,  123,   -1,  125,
   -1,  281,   -1,  283,  284,  285,   -1,  287,   -1,   -1,
   -1,   -1,  292,  293,  294,  295,   -1,   -1,   -1,  299,
   -1,   -1,  302,  303,  304,  305,  306,   -1,   -1,   40,
   -1,   -1,   43,   -1,   45,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  123,   -1,  125,   -1,   59,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  260,   -1,   -1,  263,  264,   -1,  266,
  267,  268,  269,  270,  271,  272,  273,  274,   -1,  276,
  277,  278,  279,  280,  281,  282,  283,  284,  285,   -1,
  287,  288,  123,   -1,  125,  292,  293,  294,  295,   -1,
   -1,   -1,  299,   -1,   -1,  302,  303,  304,  305,  306,
   -1,   -1,   -1,   -1,  260,   -1,   -1,  263,  264,   -1,
  266,  267,  268,  269,  270,  271,   -1,  273,  274,   -1,
  276,  277,  278,  279,  280,  281,  282,  283,  284,  285,
   -1,  287,  288,   -1,   -1,   -1,  292,  293,  294,  295,
   -1,   -1,   -1,  299,   -1,   -1,  302,  303,  304,  305,
  306,  260,   -1,   -1,  263,  264,   -1,  266,  267,  268,
  269,  270,  271,   -1,  273,  274,   -1,  276,  277,  278,
  279,  280,  281,  282,  283,  284,  285,   -1,  287,  288,
   -1,   -1,   -1,  292,  293,  294,  295,   -1,   -1,   -1,
  299,   -1,   -1,  302,  303,  304,  305,  306,   40,   -1,
   -1,   43,   -1,   45,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   59,   -1,  260,
   -1,   -1,  263,  264,   -1,  266,  267,  268,  269,  270,
  271,   -1,  273,  274,   -1,  276,  277,  278,  279,  280,
  281,  282,  283,  284,  285,   -1,  287,  288,   -1,   -1,
   -1,  292,  293,  294,  295,   -1,   -1,   -1,  299,   -1,
   -1,  302,  303,  304,  305,  306,   40,   -1,   -1,   43,
   -1,   45,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,  123,   -1,  125,   -1,   59,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   40,   -1,   -1,   43,   -1,   45,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   59,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  123,
   -1,  125,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   40,   -1,   -1,   43,   -1,   45,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   59,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,  123,   -1,  125,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  260,   -1,
   -1,  263,  264,   -1,  266,  267,  268,  269,  270,  271,
   -1,  273,  274,   -1,  276,  277,  278,  279,  280,  281,
  282,  283,  284,  285,   -1,  287,  288,  123,   -1,  125,
  292,  293,  294,  295,   -1,   -1,   -1,  299,   -1,   -1,
  302,  303,  304,  305,  306,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   40,
   -1,   -1,   43,   -1,   45,   -1,  260,   -1,   -1,  263,
  264,   -1,  266,  267,  268,  269,  270,  271,   59,  273,
  274,   -1,  276,  277,  278,  279,  280,  281,  282,  283,
  284,  285,   -1,  287,  288,   -1,   -1,   -1,  292,  293,
  294,  295,   -1,   -1,   -1,  299,   -1,   -1,  302,  303,
  304,  305,  306,  260,   -1,   -1,  263,  264,   -1,  266,
  267,  268,  269,  270,  271,   -1,  273,  274,   -1,  276,
  277,  278,  279,  280,  281,  282,  283,  284,  285,   -1,
  287,  288,  123,   -1,  125,  292,  293,  294,  295,   -1,
   -1,   -1,  299,   -1,   -1,  302,  303,  304,  305,  306,
   40,   -1,   -1,   43,  260,   45,   -1,  263,  264,   -1,
  266,  267,  268,  269,  270,  271,   -1,  273,  274,   -1,
  276,  277,  278,  279,  280,  281,  282,  283,  284,  285,
   -1,  287,  288,   -1,   -1,   -1,  292,  293,  294,  295,
   -1,   -1,   -1,  299,   -1,   -1,  302,  303,  304,  305,
  306,   40,   -1,   -1,   43,   44,   45,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   60,   -1,   62,   63,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  123,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   40,   -1,   -1,   43,   -1,
   45,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   60,   -1,   62,   63,  260,
   -1,   -1,  263,  264,   -1,  266,  267,  268,  269,  270,
  271,   -1,  273,  274,   -1,  276,  277,  278,  279,  280,
  281,  282,  283,  284,  285,   -1,  287,  288,   -1,   -1,
   -1,  292,  293,  294,  295,   -1,   -1,   -1,  299,   -1,
   -1,  302,  303,  304,  305,  306,   40,   41,   -1,   43,
   44,   45,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   63,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   40,   41,   -1,   43,   44,   45,   -1,  257,  258,  259,
   -1,   -1,   -1,  263,  264,   -1,   -1,   -1,  268,  269,
  270,   -1,   -1,   63,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,  281,   -1,  283,  284,  285,  286,  287,   -1,   -1,
   -1,   -1,  292,  293,  294,  295,   -1,   -1,   -1,  299,
   -1,  301,  302,  303,  304,  305,  306,   40,   41,   -1,
   43,   44,   45,   -1,  263,  264,   -1,   -1,   -1,  268,
  269,  270,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   63,   -1,  281,   -1,  283,  284,  285,   -1,  287,   -1,
   -1,   -1,   -1,  292,  293,  294,  295,  296,  297,   -1,
  299,   -1,   -1,  302,  303,  304,  305,  306,  263,  264,
   -1,   -1,   -1,  268,  269,  270,   -1,   -1,   -1,   -1,
   40,   41,   -1,   43,   44,   45,  281,   -1,  283,  284,
  285,   -1,  287,   -1,   -1,   -1,   -1,  292,  293,  294,
  295,  296,  297,   63,  299,   -1,   -1,  302,  303,  304,
  305,  306,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   40,   -1,
   -1,   43,   -1,   45,   -1,   -1,   -1,   -1,   -1,  263,
  264,   -1,   -1,   -1,  268,  269,  270,   59,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,  281,   -1,  283,
  284,  285,   -1,  287,   -1,   -1,   -1,   -1,  292,  293,
  294,  295,   -1,   -1,   -1,  299,   -1,   -1,  302,  303,
  304,  305,  306,  263,  264,   -1,   -1,   -1,  268,  269,
  270,   40,   -1,   -1,   43,   -1,   45,   -1,   -1,   -1,
   -1,  281,   -1,  283,  284,  285,   -1,  287,   -1,   -1,
   -1,   -1,  292,  293,  294,  295,   -1,   -1,   -1,  299,
   -1,   -1,  302,  303,  304,  305,  306,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   40,
  263,  264,   43,   -1,   45,  268,  269,  270,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  281,   -1,
  283,  284,  285,   -1,  287,   -1,   -1,   -1,   -1,  292,
  293,  294,  295,   -1,   -1,   -1,  299,   -1,   -1,  302,
  303,  304,  305,  306,   40,   -1,   -1,   43,   44,   45,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  263,  264,   -1,   -1,   63,  268,  269,
  270,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,  281,   -1,  283,  284,  285,   -1,  287,   -1,   -1,
   -1,   -1,  292,  293,  294,  295,   -1,   -1,   -1,  299,
   -1,   -1,  302,  303,  304,  305,  306,  259,   -1,   -1,
   -1,  263,  264,   -1,   -1,   -1,  268,  269,  270,   -1,
   -1,   40,   -1,   -1,   43,   44,   45,   -1,   -1,  281,
   -1,  283,  284,  285,   -1,  287,   -1,   -1,   -1,   -1,
  292,  293,  294,  295,   63,   -1,   -1,  299,   -1,  301,
  302,  303,  304,  305,  306,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   40,   -1,
  259,   43,   44,   45,  263,  264,   -1,   -1,   -1,  268,
  269,  270,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   63,  281,   -1,  283,  284,  285,   -1,  287,   -1,
   -1,   -1,   -1,  292,  293,  294,  295,   -1,   -1,   -1,
  299,   -1,  301,  302,  303,  304,  305,  306,  259,   -1,
   -1,   -1,  263,  264,   -1,   -1,   -1,  268,  269,  270,
   -1,   -1,   40,   -1,   -1,   43,   44,   45,   -1,   -1,
  281,   -1,  283,  284,  285,   -1,  287,   -1,   -1,   -1,
   -1,  292,  293,  294,  295,   63,   -1,   -1,  299,   -1,
  301,  302,  303,  304,  305,  306,   -1,  263,  264,   -1,
   -1,   -1,  268,  269,  270,   -1,   -1,   40,   -1,   -1,
   43,   44,   45,   -1,   -1,  281,   -1,  283,  284,  285,
   -1,  287,   -1,   -1,   -1,   -1,  292,  293,  294,  295,
   63,   -1,   -1,  299,   -1,   -1,  302,  303,  304,  305,
  306,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   40,   -1,   -1,   43,   44,   45,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,  263,  264,   63,   -1,   -1,  268,
  269,  270,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,  281,   -1,  283,  284,  285,   -1,  287,   -1,
   -1,   -1,   -1,  292,  293,  294,  295,   -1,   -1,   -1,
  299,   -1,   -1,  302,  303,  304,  305,  306,   -1,   -1,
   -1,  263,  264,   -1,   -1,   -1,  268,  269,  270,   -1,
   -1,   40,   -1,   -1,   43,   -1,   45,   -1,   -1,  281,
   -1,  283,  284,  285,   -1,  287,   -1,   -1,   -1,   58,
  292,  293,  294,  295,   63,   -1,   -1,  299,   -1,   -1,
  302,  303,  304,  305,  306,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   40,   -1,   -1,   43,   -1,
   45,   -1,   -1,   -1,   -1,  263,  264,   -1,   -1,   -1,
  268,  269,  270,   58,   -1,   -1,   -1,   -1,   63,   -1,
   -1,   -1,   -1,  281,   -1,  283,  284,  285,   -1,  287,
   -1,   -1,   -1,   -1,  292,  293,  294,  295,   -1,   -1,
   -1,  299,   -1,   -1,  302,  303,  304,  305,  306,   -1,
  263,  264,   -1,   -1,   -1,  268,  269,  270,   -1,   -1,
   40,   41,   -1,   43,   -1,   45,   -1,   -1,  281,   -1,
  283,  284,  285,   -1,  287,   -1,   -1,   -1,   -1,  292,
  293,  294,  295,   63,   -1,   -1,  299,   -1,   -1,  302,
  303,  304,  305,  306,   -1,   -1,  263,  264,   -1,   -1,
   -1,  268,  269,  270,   -1,   -1,   40,   41,   -1,   43,
   -1,   45,   -1,   -1,  281,   -1,  283,  284,  285,   -1,
  287,   -1,   -1,   -1,   -1,  292,  293,  294,  295,   63,
   -1,   -1,  299,   -1,   -1,  302,  303,  304,  305,  306,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   40,   41,   -1,   43,   -1,   45,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   63,  263,  264,   -1,   -1,   -1,  268,
  269,  270,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,  281,   -1,  283,  284,  285,   -1,  287,   -1,
   -1,   -1,   -1,  292,  293,  294,  295,   -1,   -1,   -1,
  299,   -1,   -1,  302,  303,  304,  305,  306,  263,  264,
   -1,   -1,   -1,  268,  269,  270,   -1,   -1,   40,   41,
   -1,   43,   -1,   45,   -1,   -1,  281,   -1,  283,  284,
  285,   -1,  287,   -1,   -1,   -1,   -1,  292,  293,  294,
  295,   63,   -1,   -1,  299,   -1,   -1,  302,  303,  304,
  305,  306,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   40,   41,   -1,   43,   -1,   45,   -1,   -1,
   -1,   -1,   -1,  263,  264,   -1,   -1,   -1,  268,  269,
  270,   -1,   -1,   -1,   -1,   63,   -1,   -1,   -1,   -1,
   -1,  281,   -1,  283,  284,  285,   -1,  287,   -1,   -1,
   -1,   -1,  292,  293,  294,  295,   -1,   -1,   -1,  299,
   -1,   -1,  302,  303,  304,  305,  306,   -1,   -1,  263,
  264,   -1,   -1,   -1,  268,  269,  270,   -1,   -1,   40,
   41,   -1,   43,   -1,   45,   -1,   -1,  281,   -1,  283,
  284,  285,   -1,  287,   -1,   -1,   -1,   -1,  292,  293,
  294,  295,   63,   -1,   -1,  299,   -1,   -1,  302,  303,
  304,  305,  306,  263,  264,   -1,   -1,   -1,  268,  269,
  270,   -1,   -1,   40,   41,   -1,   43,   -1,   45,   -1,
   -1,  281,   -1,  283,  284,  285,   -1,  287,   -1,   -1,
   -1,   -1,  292,  293,  294,  295,   63,   -1,   -1,  299,
   -1,   -1,  302,  303,  304,  305,  306,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   40,   41,   -1,
   43,   -1,   45,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   63,  263,  264,   -1,   -1,   -1,  268,  269,  270,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  281,
   -1,  283,  284,  285,   -1,  287,   -1,   -1,   -1,   -1,
  292,  293,  294,  295,   -1,   -1,   -1,  299,   -1,   -1,
  302,  303,  304,  305,  306,  263,  264,   -1,   -1,   -1,
  268,  269,  270,   -1,   -1,   40,   41,   -1,   43,   -1,
   45,   -1,   -1,  281,   -1,  283,  284,  285,   -1,  287,
   -1,   -1,   -1,   -1,  292,  293,  294,  295,   63,   -1,
   -1,  299,   -1,   -1,  302,  303,  304,  305,  306,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   40,
   41,   -1,   43,   -1,   45,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,  263,  264,   -1,   -1,   -1,  268,  269,  270,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
  281,   -1,  283,  284,  285,   -1,  287,   -1,   -1,   -1,
   -1,  292,  293,  294,  295,   -1,   -1,   -1,  299,   -1,
   -1,  302,  303,  304,  305,  306,  263,  264,   -1,   -1,
   -1,  268,  269,  270,   40,   -1,   -1,   43,   -1,   45,
   -1,   -1,   -1,   -1,  281,   -1,  283,  284,  285,   -1,
  287,   -1,   -1,   -1,   -1,  292,  293,  294,  295,   -1,
   -1,   -1,  299,   -1,   -1,  302,  303,  304,  305,  306,
  263,  264,   -1,   -1,   -1,  268,  269,  270,   -1,   -1,
   -1,   -1,   40,   -1,   -1,   43,   -1,   45,  281,   -1,
  283,  284,  285,   -1,  287,   -1,   -1,   -1,   -1,  292,
  293,  294,  295,   -1,   -1,   -1,  299,   -1,   -1,  302,
  303,  304,  305,  306,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   40,   -1,   -1,   43,   -1,   45,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  263,  264,
   -1,   -1,   -1,  268,  269,  270,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,  281,   -1,  283,  284,
  285,   -1,  287,   -1,   -1,   -1,   -1,  292,  293,  294,
  295,   -1,   -1,   -1,  299,   -1,   -1,  302,  303,  304,
  305,  306,  263,  264,   -1,   -1,   -1,  268,  269,  270,
   40,   -1,   -1,   43,   -1,   45,   -1,   -1,   -1,   -1,
  281,   -1,  283,  284,  285,   -1,  287,   -1,   -1,   -1,
   -1,  292,  293,  294,  295,   -1,   -1,   -1,  299,   -1,
   -1,  302,  303,  304,  305,  306,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   40,   -1,   -1,   43,   -1,   45,
   -1,   -1,   -1,  259,   -1,   -1,   -1,  263,  264,   -1,
   -1,   -1,  268,  269,  270,   -1,   -1,   63,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  281,   -1,  283,  284,  285,
   -1,  287,   -1,   -1,   -1,   -1,  292,  293,  294,  295,
   -1,   -1,   -1,  299,   -1,   -1,  302,  303,  304,  305,
  306,  259,   -1,   -1,   40,  263,  264,   43,   -1,   45,
  268,  269,  270,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  281,   -1,  283,  284,  285,   -1,  287,
   -1,   -1,   -1,   -1,  292,  293,  294,  295,   -1,   -1,
   -1,  299,   -1,   -1,  302,  303,  304,  305,  306,  259,
   -1,   -1,   40,  263,  264,   43,   -1,   45,  268,  269,
  270,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,  281,   -1,  283,  284,  285,   -1,  287,   -1,   -1,
   -1,   -1,  292,  293,  294,  295,   -1,   -1,   -1,  299,
   -1,   -1,  302,  303,  304,  305,  306,   40,   -1,   -1,
   43,   -1,   45,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  259,
   -1,   -1,   -1,  263,  264,   -1,   -1,   -1,  268,  269,
  270,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,  281,   -1,  283,  284,  285,   -1,  287,   -1,   -1,
   -1,   -1,  292,  293,  294,  295,   -1,   -1,   -1,  299,
   -1,   -1,  302,  303,  304,  305,  306,  263,  264,   -1,
   -1,   -1,  268,  269,  270,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  281,   -1,  283,  284,  285,
   -1,  287,   -1,   -1,   -1,   -1,  292,  293,  294,  295,
   -1,   -1,   -1,  299,   -1,   -1,  302,  303,  304,  305,
  306,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  259,   -1,   -1,   -1,  263,  264,   -1,
   -1,   -1,  268,  269,  270,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,  281,   -1,  283,  284,  285,
   -1,  287,   -1,   -1,   -1,   -1,  292,  293,  294,  295,
   -1,   -1,   -1,  299,   -1,   -1,  302,  303,  304,  305,
  306,   -1,   -1,   -1,   -1,  263,  264,   -1,   -1,   -1,
  268,  269,  270,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  281,   -1,  283,  284,  285,   -1,  287,
   -1,   -1,   -1,   -1,  292,  293,  294,  295,   -1,   -1,
   -1,  299,   -1,   -1,  302,  303,  304,  305,  306,   -1,
  263,  264,   28,   29,   -1,  268,  269,  270,   34,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   43,  281,   -1,
  283,  284,  285,   -1,  287,   -1,   -1,   -1,   -1,  292,
  293,  294,  295,   -1,   -1,   -1,  299,   -1,   -1,  302,
  303,  304,  305,  306,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   93,   94,   95,
   96,   97,   98,   -1,   -1,   -1,   -1,   -1,   -1,  105,
   -1,   -1,   -1,   -1,  110,   -1,   -1,  113,  114,   -1,
   -1,  117,   -1,  119,  120,   -1,   -1,   -1,  124,  125,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  135,
   -1,   -1,   -1,  139,   -1,  141,  142,  143,  144,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  155,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  165,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,  193,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,  209,  210,  211,  212,   -1,  214,   -1,
  216,  217,   -1,   -1,   -1,   -1,   -1,   -1,  224,  225,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
  236,  237,  238,  239,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,  264,   -1,
   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,   -1,
  276,  277,  278,  279,  280,   -1,  282,  283,  284,
};
#define YYFINAL 1
#ifndef YYDEBUG
#define YYDEBUG 0
#endif
#define YYMAXTOKEN 306
#if YYDEBUG
const char *yyname[] = {
""end-of-file"",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,""'%'"",0,0,""'('"",""')'"",""'*'"",""'+'"",""','"",""'-'"",0,""'/'"",0,0,0,0,0,0,0,0,0,0,
""':'"",""';'"",""'<'"",0,""'>'"",""'?'"",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,""'['"",0,""']'"",""'^'"",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,""'p'"",0,0,0,0,0,0,0,
0,0,0,""'{'"",""'|'"",""'}'"",0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,""BEGIN"",""END"",""REGEX"",""SEMINEW"",
""NEWLINE"",""COMMENT"",""FUN1"",""FUNN"",""GRGR"",""PRINT"",""PRINTF"",""SPRINTF_OLD"",
""SPRINTF_NEW"",""SPLIT"",""IF"",""ELSE"",""WHILE"",""FOR"",""IN"",""EXIT"",""NEXT"",""BREAK"",
""CONTINUE"",""RET"",""GETLINE"",""DO"",""SUB"",""GSUB"",""MATCH"",""FUNCTION"",""USERFUN"",
""DELETE"",""ASGNOP"",""OROR"",""ANDAND"",""NUMBER"",""VAR"",""SUBSTR"",""INDEX"",""MATCHOP"",
""RELOP"",""OR"",""STRING"",""UMINUS"",""NOT"",""INCR"",""DECR"",""FIELD"",""VFIELD"",""SVFIELD"",
};
const char *yyrule[] = {
""$accept : program"",
""program : junk hunks"",
""begin : BEGIN '{' maybe states '}' junk"",
""end : END '{' maybe states '}'"",
""end : end NEWLINE"",
""hunks : hunks hunk junk"",
""hunks :"",
""hunk : patpat"",
""hunk : patpat '{' maybe states '}'"",
""hunk : FUNCTION USERFUN '(' arg_list ')' maybe '{' maybe states '}'"",
""hunk : '{' maybe states '}'"",
""hunk : begin"",
""hunk : end"",
""arg_list : expr_list"",
""patpat : cond"",
""patpat : cond ',' cond"",
""cond : expr"",
""cond : match"",
""cond : rel"",
""cond : compound_cond"",
""cond : cond '?' expr ':' expr"",
""compound_cond : '(' compound_cond ')'"",
""compound_cond : cond ANDAND maybe cond"",
""compound_cond : cond OROR maybe cond"",
""compound_cond : NOT cond"",
""rel : expr RELOP expr"",
""rel : expr '>' expr"",
""rel : expr '<' expr"",
""rel : '(' rel ')'"",
""match : expr MATCHOP expr"",
""match : expr MATCHOP REGEX"",
""match : REGEX"",
""match : '(' match ')'"",
""expr : term"",
""expr : expr term"",
""expr : expr '?' expr ':' expr"",
""expr : variable ASGNOP cond"",
""sprintf : SPRINTF_NEW"",
""sprintf : SPRINTF_OLD"",
""term : variable"",
""term : NUMBER"",
""term : STRING"",
""term : term '+' term"",
""term : term '-' term"",
""term : term '*' term"",
""term : term '/' term"",
""term : term '%' term"",
""term : term '^' term"",
""term : term IN VAR"",
""term : variable INCR"",
""term : variable DECR"",
""term : INCR variable"",
""term : DECR variable"",
""term : '-' term"",
""term : '+' term"",
""term : '(' cond ')'"",
""term : GETLINE"",
""term : GETLINE variable"",
""term : GETLINE '<' expr"",
""term : GETLINE variable '<' expr"",
""term : term 'p' GETLINE"",
""term : term 'p' GETLINE variable"",
""term : FUN1"",
""term : FUN1 '(' ')'"",
""term : FUN1 '(' expr ')'"",
""term : FUNN '(' expr_list ')'"",
""term : USERFUN '(' expr_list ')'"",
""term : SPRINTF_NEW '(' expr_list ')'"",
""term : sprintf expr_list"",
""term : SUBSTR '(' expr ',' expr ',' expr ')'"",
""term : SUBSTR '(' expr ',' expr ')'"",
""term : SPLIT '(' expr ',' VAR ',' expr ')'"",
""term : SPLIT '(' expr ',' VAR ',' REGEX ')'"",
""term : SPLIT '(' expr ',' VAR ')'"",
""term : INDEX '(' expr ',' expr ')'"",
""term : MATCH '(' expr ',' REGEX ')'"",
""term : MATCH '(' expr ',' expr ')'"",
""term : SUB '(' expr ',' expr ')'"",
""term : SUB '(' REGEX ',' expr ')'"",
""term : GSUB '(' expr ',' expr ')'"",
""term : GSUB '(' REGEX ',' expr ')'"",
""term : SUB '(' expr ',' expr ',' expr ')'"",
""term : SUB '(' REGEX ',' expr ',' expr ')'"",
""term : GSUB '(' expr ',' expr ',' expr ')'"",
""term : GSUB '(' REGEX ',' expr ',' expr ')'"",
""variable : VAR"",
""variable : VAR '[' expr_list ']'"",
""variable : FIELD"",
""variable : SVFIELD"",
""variable : VFIELD term"",
""expr_list : expr"",
""expr_list : clist"",
""expr_list :"",
""clist : expr ',' maybe expr"",
""clist : clist ',' maybe expr"",
""clist : '(' clist ')'"",
""junk : junk hunksep"",
""junk :"",
""hunksep : ';'"",
""hunksep : SEMINEW"",
""hunksep : NEWLINE"",
""hunksep : COMMENT"",
""maybe : maybe nlstuff"",
""maybe :"",
""nlstuff : NEWLINE"",
""nlstuff : COMMENT"",
""separator : ';' maybe"",
""separator : SEMINEW maybe"",
""separator : NEWLINE maybe"",
""separator : COMMENT maybe"",
""states : states statement"",
""states :"",
""statement : simple separator maybe"",
""statement : ';' maybe"",
""statement : SEMINEW maybe"",
""statement : compound"",
""simpnull : simple"",
""simpnull :"",
""simple : expr"",
""simple : PRINT expr_list redir expr"",
""simple : PRINT expr_list"",
""simple : PRINTF expr_list redir expr"",
""simple : PRINTF expr_list"",
""simple : BREAK"",
""simple : NEXT"",
""simple : EXIT"",
""simple : EXIT expr"",
""simple : CONTINUE"",
""simple : RET"",
""simple : RET expr"",
""simple : DELETE VAR '[' expr_list ']'"",
""redir : '>'"",
""redir : GRGR"",
""redir : '|'"",
""compound : IF '(' cond ')' maybe statement"",
""compound : IF '(' cond ')' maybe statement ELSE maybe statement"",
""compound : WHILE '(' cond ')' maybe statement"",
""compound : DO maybe statement WHILE '(' cond ')'"",
""compound : FOR '(' simpnull ';' cond ';' simpnull ')' maybe statement"",
""compound : FOR '(' simpnull ';' ';' simpnull ')' maybe statement"",
""compound : FOR '(' expr ')' maybe statement"",
""compound : '{' maybe states '}' maybe"",
};
#endif
#ifndef YYSTYPE
typedef int YYSTYPE;
#endif
#ifdef YYSTACKSIZE
#undef YYMAXDEPTH
#define YYMAXDEPTH YYSTACKSIZE
#else
#ifdef YYMAXDEPTH
#define YYSTACKSIZE YYMAXDEPTH
#else
#define YYSTACKSIZE 500
#define YYMAXDEPTH 500
#endif
#endif
int yydebug;
int yynerrs;
int yyerrflag;
int yychar;
short *yyssp;
YYSTYPE *yyvsp;
YYSTYPE yyval;
YYSTYPE yylval;
short yyss[YYSTACKSIZE];
YYSTYPE yyvs[YYSTACKSIZE];
#define yystacksize YYSTACKSIZE
#line 429 ""a2p.y""

int yyparse (void);

#include ""a2py.c""
#line 2178 ""y.tab.c""
#define YYABORT goto yyabort
#define YYREJECT goto yyabort
#define YYACCEPT goto yyaccept
#define YYERROR goto yyerrlab

#if YYDEBUG
#  if defined(WIN32) && !defined(__BORLANDC__)
EXTERN_C _CRTIMP char *getenv(const char *);
#  else
EXTERN_C char *getenv(const char *);
#  endif
#endif

int
yyparse(void)
{
    register int yym, yyn, yystate;
#if YYDEBUG
    register const char *yys;

    if ((yys = getenv(""YYDEBUG"")))
    {
        yyn = *yys;
        if (yyn >= '0' && yyn <= '9')
            yydebug = yyn - '0';
    }
#endif

    yynerrs = 0;
    yyerrflag = 0;
    yychar = (-1);

    yyssp = yyss;
    yyvsp = yyvs;
    *yyssp = yystate = 0;

yyloop:
    if (((yyn = yydefred[yystate])) != 0) goto yyreduce;
    if (yychar < 0)
    {
        if ((yychar = yylex()) < 0) yychar = 0;
#if YYDEBUG
        if (yydebug)
        {
            yys = 0;
            if (yychar <= YYMAXTOKEN) yys = yyname[yychar];
            if (!yys) yys = ""illegal-symbol"";
            printf(""%sdebug: state %d, reading %d (%s)\n"",
                    YYPREFIX, yystate, yychar, yys);
        }
#endif
    }
    if ((yyn = yysindex[yystate]) && (yyn += yychar) >= 0 &&
            yyn <= YYTABLESIZE && yycheck[yyn] == yychar)
    {
#if YYDEBUG
        if (yydebug)
            printf(""%sdebug: state %d, shifting to state %d\n"",
                    YYPREFIX, yystate, yytable[yyn]);
#endif
        if (yyssp >= yyss + yystacksize - 1)
        {
            goto yyoverflow;
        }
        *++yyssp = yystate = yytable[yyn];
        *++yyvsp = yylval;
        yychar = (-1);
        if (yyerrflag > 0)  --yyerrflag;
        goto yyloop;
    }
    if ((yyn = yyrindex[yystate]) && (yyn += yychar) >= 0 &&
            yyn <= YYTABLESIZE && yycheck[yyn] == yychar)
    {
        yyn = yytable[yyn];
        goto yyreduce;
    }
    if (yyerrflag) goto yyinrecovery;
#ifdef lint

#endif

    yyerror(""syntax error"");
#ifdef lint

#endif

    ++yynerrs;
yyinrecovery:
    if (yyerrflag < 3)
    {
        yyerrflag = 3;
        for (;;)
        {
            if ((yyn = yysindex[*yyssp]) && (yyn += YYERRCODE) >= 0 &&
                    yyn <= YYTABLESIZE && yycheck[yyn] == YYERRCODE)
            {
#if YYDEBUG
                if (yydebug)
                    printf(""%sdebug: state %d, error recovery shifting\
 to state %d\n"", YYPREFIX, *yyssp, yytable[yyn]);
#endif
                if (yyssp >= yyss + yystacksize - 1)
                {
                    goto yyoverflow;
                }
                *++yyssp = yystate = yytable[yyn];
                *++yyvsp = yylval;
                goto yyloop;
            }
            else
            {
#if YYDEBUG
                if (yydebug)
                    printf(""%sdebug: error recovery discarding state %d\n"",
                            YYPREFIX, *yyssp);
#endif
                if (yyssp <= yyss) goto yyabort;
                --yyssp;
                --yyvsp;
            }
        }
    }
    else
    {
        if (yychar == 0) goto yyabort;
#if YYDEBUG
        if (yydebug)
        {
            yys = 0;
            if (yychar <= YYMAXTOKEN) yys = yyname[yychar];
            if (!yys) yys = ""illegal-symbol"";
            printf(""%sdebug: state %d, error recovery discards token %d (%s)\n"",
                    YYPREFIX, yystate, yychar, yys);
        }
#endif
        yychar = (-1);
        goto yyloop;
    }
yyreduce:
#if YYDEBUG
    if (yydebug)
        printf(""%sdebug: state %d, reducing by rule %d (%s)\n"",
                YYPREFIX, yystate, yyn, yyrule[yyn]);
#endif
    yym = yylen[yyn];
    yyval = yyvsp[1-yym];
    switch (yyn)
    {
case 1:
#line 52 ""a2p.y""
{ root = oper4(OPROG,yyvsp[-1],begins,yyvsp[0],ends); }
break;
case 2:
#line 56 ""a2p.y""
{ begins = oper4(OJUNK,begins,yyvsp[-3],yyvsp[-2],yyvsp[0]); in_begin = FALSE;
		    yyval = Nullop; }
break;
case 3:
#line 61 ""a2p.y""
{ ends = oper3(OJUNK,ends,yyvsp[-2],yyvsp[-1]); yyval = Nullop; }
break;
case 4:
#line 63 ""a2p.y""
{ yyval = yyvsp[-1]; }
break;
case 5:
#line 67 ""a2p.y""
{ yyval = oper3(OHUNKS,yyvsp[-2],yyvsp[-1],yyvsp[0]); }
break;
case 6:
#line 69 ""a2p.y""
{ yyval = Nullop; }
break;
case 7:
#line 73 ""a2p.y""
{ yyval = oper1(OHUNK,yyvsp[0]); need_entire = TRUE; }
break;
case 8:
#line 75 ""a2p.y""
{ yyval = oper2(OHUNK,yyvsp[-4],oper2(OJUNK,yyvsp[-2],yyvsp[-1])); }
break;
case 9:
#line 77 ""a2p.y""
{ fixfargs(yyvsp[-8],yyvsp[-6],0); yyval = oper5(OUSERDEF,yyvsp[-8],yyvsp[-6],yyvsp[-4],yyvsp[-2],yyvsp[-1]); }
break;
case 10:
#line 79 ""a2p.y""
{ yyval = oper2(OHUNK,Nullop,oper2(OJUNK,yyvsp[-2],yyvsp[-1])); }
break;
case 13:
#line 85 ""a2p.y""
{ yyval = rememberargs(yyval); }
break;
case 14:
#line 89 ""a2p.y""
{ yyval = oper1(OPAT,yyvsp[0]); }
break;
case 15:
#line 91 ""a2p.y""
{ yyval = oper2(ORANGE,yyvsp[-2],yyvsp[0]); }
break;
case 20:
#line 99 ""a2p.y""
{ yyval = oper3(OCOND,yyvsp[-4],yyvsp[-2],yyvsp[0]); }
break;
case 21:
#line 104 ""a2p.y""
{ yyval = oper1(OCPAREN,yyvsp[-1]); }
break;
case 22:
#line 106 ""a2p.y""
{ yyval = oper3(OCANDAND,yyvsp[-3],yyvsp[-1],yyvsp[0]); }
break;
case 23:
#line 108 ""a2p.y""
{ yyval = oper3(OCOROR,yyvsp[-3],yyvsp[-1],yyvsp[0]); }
break;
case 24:
#line 110 ""a2p.y""
{ yyval = oper1(OCNOT,yyvsp[0]); }
break;
case 25:
#line 114 ""a2p.y""
{ yyval = oper3(ORELOP,yyvsp[-1],yyvsp[-2],yyvsp[0]); }
break;
case 26:
#line 116 ""a2p.y""
{ yyval = oper3(ORELOP,string("">"",1),yyvsp[-2],yyvsp[0]); }
break;
case 27:
#line 118 ""a2p.y""
{ yyval = oper3(ORELOP,string(""<"",1),yyvsp[-2],yyvsp[0]); }
break;
case 28:
#line 120 ""a2p.y""
{ yyval = oper1(ORPAREN,yyvsp[-1]); }
break;
case 29:
#line 124 ""a2p.y""
{ yyval = oper3(OMATCHOP,yyvsp[-1],yyvsp[-2],yyvsp[0]); }
break;
case 30:
#line 126 ""a2p.y""
{ yyval = oper3(OMATCHOP,yyvsp[-1],yyvsp[-2],oper1(OREGEX,yyvsp[0])); }
break;
case 31:
#line 128 ""a2p.y""
{ yyval = oper1(OREGEX,yyvsp[0]); }
break;
case 32:
#line 130 ""a2p.y""
{ yyval = oper1(OMPAREN,yyvsp[-1]); }
break;
case 33:
#line 134 ""a2p.y""
{ yyval = yyvsp[0]; }
break;
case 34:
#line 136 ""a2p.y""
{ yyval = oper2(OCONCAT,yyvsp[-1],yyvsp[0]); }
break;
case 35:
#line 138 ""a2p.y""
{ yyval = oper3(OCOND,yyvsp[-4],yyvsp[-2],yyvsp[0]); }
break;
case 36:
#line 140 ""a2p.y""
{
		    yyval = oper3(OASSIGN,yyvsp[-1],yyvsp[-2],yyvsp[0]);
		    if ((ops[yyvsp[-2]].ival & 255) == OFLD)
			lval_field = TRUE;
		    else if ((ops[yyvsp[-2]].ival & 255) == OVFLD)
			lval_field = TRUE;
		}
break;
case 39:
#line 153 ""a2p.y""
{ yyval = yyvsp[0]; }
break;
case 40:
#line 155 ""a2p.y""
{ yyval = oper1(ONUM,yyvsp[0]); }
break;
case 41:
#line 157 ""a2p.y""
{ yyval = oper1(OSTR,yyvsp[0]); }
break;
case 42:
#line 159 ""a2p.y""
{ yyval = oper2(OADD,yyvsp[-2],yyvsp[0]); }
break;
case 43:
#line 161 ""a2p.y""
{ yyval = oper2(OSUBTRACT,yyvsp[-2],yyvsp[0]); }
break;
case 44:
#line 163 ""a2p.y""
{ yyval = oper2(OMULT,yyvsp[-2],yyvsp[0]); }
break;
case 45:
#line 165 ""a2p.y""
{ yyval = oper2(ODIV,yyvsp[-2],yyvsp[0]); }
break;
case 46:
#line 167 ""a2p.y""
{ yyval = oper2(OMOD,yyvsp[-2],yyvsp[0]); }
break;
case 47:
#line 169 ""a2p.y""
{ yyval = oper2(OPOW,yyvsp[-2],yyvsp[0]); }
break;
case 48:
#line 171 ""a2p.y""
{ yyval = oper2(ODEFINED,aryrefarg(yyvsp[0]),yyvsp[-2]); }
break;
case 49:
#line 173 ""a2p.y""
{
		    yyval = oper1(OPOSTINCR,yyvsp[-1]);
		    if ((ops[yyvsp[-1]].ival & 255) == OFLD)
			lval_field = TRUE;
		    else if ((ops[yyvsp[-1]].ival & 255) == OVFLD)
			lval_field = TRUE;
		}
break;
case 50:
#line 181 ""a2p.y""
{
		    yyval = oper1(OPOSTDECR,yyvsp[-1]);
		    if ((ops[yyvsp[-1]].ival & 255) == OFLD)
			lval_field = TRUE;
		    else if ((ops[yyvsp[-1]].ival & 255) == OVFLD)
			lval_field = TRUE;
		}
break;
case 51:
#line 189 ""a2p.y""
{
		    yyval = oper1(OPREINCR,yyvsp[0]);
		    if ((ops[yyvsp[0]].ival & 255) == OFLD)
			lval_field = TRUE;
		    else if ((ops[yyvsp[0]].ival & 255) == OVFLD)
			lval_field = TRUE;
		}
break;
case 52:
#line 197 ""a2p.y""
{
		    yyval = oper1(OPREDECR,yyvsp[0]);
		    if ((ops[yyvsp[0]].ival & 255) == OFLD)
			lval_field = TRUE;
		    else if ((ops[yyvsp[0]].ival & 255) == OVFLD)
			lval_field = TRUE;
		}
break;
case 53:
#line 205 ""a2p.y""
{ yyval = oper1(OUMINUS,yyvsp[0]); }
break;
case 54:
#line 207 ""a2p.y""
{ yyval = oper1(OUPLUS,yyvsp[0]); }
break;
case 55:
#line 209 ""a2p.y""
{ yyval = oper1(OPAREN,yyvsp[-1]); }
break;
case 56:
#line 211 ""a2p.y""
{ yyval = oper0(OGETLINE); }
break;
case 57:
#line 213 ""a2p.y""
{ yyval = oper1(OGETLINE,yyvsp[0]); }
break;
case 58:
#line 215 ""a2p.y""
{ yyval = oper3(OGETLINE,Nullop,string(""<"",1),yyvsp[0]);
		    if (ops[yyvsp[0]].ival != OSTR + (1<<8)) do_fancy_opens = TRUE; }
break;
case 59:
#line 218 ""a2p.y""
{ yyval = oper3(OGETLINE,yyvsp[-2],string(""<"",1),yyvsp[0]);
		    if (ops[yyvsp[0]].ival != OSTR + (1<<8)) do_fancy_opens = TRUE; }
break;
case 60:
#line 221 ""a2p.y""
{ yyval = oper3(OGETLINE,Nullop,string(""|"",1),yyvsp[-2]);
		    if (ops[yyvsp[-2]].ival != OSTR + (1<<8)) do_fancy_opens = TRUE; }
break;
case 61:
#line 224 ""a2p.y""
{ yyval = oper3(OGETLINE,yyvsp[0],string(""|"",1),yyvsp[-3]);
		    if (ops[yyvsp[-3]].ival != OSTR + (1<<8)) do_fancy_opens = TRUE; }
break;
case 62:
#line 227 ""a2p.y""
{ yyval = oper0(yyvsp[0]); need_entire = do_chop = TRUE; }
break;
case 63:
#line 229 ""a2p.y""
{ yyval = oper1(yyvsp[-2],Nullop); need_entire = do_chop = TRUE; }
break;
case 64:
#line 231 ""a2p.y""
{ yyval = oper1(yyvsp[-3],yyvsp[-1]); }
break;
case 65:
#line 233 ""a2p.y""
{ yyval = oper1(yyvsp[-3],yyvsp[-1]); }
break;
case 66:
#line 235 ""a2p.y""
{ yyval = oper2(OUSERFUN,yyvsp[-3],yyvsp[-1]); }
break;
case 67:
#line 237 ""a2p.y""
{ yyval = oper1(OSPRINTF,yyvsp[-1]); }
break;
case 68:
#line 239 ""a2p.y""
{ yyval = oper1(OSPRINTF,yyvsp[0]); }
break;
case 69:
#line 241 ""a2p.y""
{ yyval = oper3(OSUBSTR,yyvsp[-5],yyvsp[-3],yyvsp[-1]); }
break;
case 70:
#line 243 ""a2p.y""
{ yyval = oper2(OSUBSTR,yyvsp[-3],yyvsp[-1]); }
break;
case 71:
#line 245 ""a2p.y""
{ yyval = oper3(OSPLIT,yyvsp[-5],aryrefarg(numary(yyvsp[-3])),yyvsp[-1]); }
break;
case 72:
#line 247 ""a2p.y""
{ yyval = oper3(OSPLIT,yyvsp[-5],aryrefarg(numary(yyvsp[-3])),oper1(OREGEX,yyvsp[-1]));}
break;
case 73:
#line 249 ""a2p.y""
{ yyval = oper2(OSPLIT,yyvsp[-3],aryrefarg(numary(yyvsp[-1]))); }
break;
case 74:
#line 251 ""a2p.y""
{ yyval = oper2(OINDEX,yyvsp[-3],yyvsp[-1]); }
break;
case 75:
#line 253 ""a2p.y""
{ yyval = oper2(OMATCH,yyvsp[-3],oper1(OREGEX,yyvsp[-1])); }
break;
case 76:
#line 255 ""a2p.y""
{ yyval = oper2(OMATCH,yyvsp[-3],yyvsp[-1]); }
break;
case 77:
#line 257 ""a2p.y""
{ yyval = oper2(OSUB,yyvsp[-3],yyvsp[-1]); }
break;
case 78:
#line 259 ""a2p.y""
{ yyval = oper2(OSUB,oper1(OREGEX,yyvsp[-3]),yyvsp[-1]); }
break;
case 79:
#line 261 ""a2p.y""
{ yyval = oper2(OGSUB,yyvsp[-3],yyvsp[-1]); }
break;
case 80:
#line 263 ""a2p.y""
{ yyval = oper2(OGSUB,oper1(OREGEX,yyvsp[-3]),yyvsp[-1]); }
break;
case 81:
#line 265 ""a2p.y""
{ yyval = oper3(OSUB,yyvsp[-5],yyvsp[-3],yyvsp[-1]); }
break;
case 82:
#line 267 ""a2p.y""
{ yyval = oper3(OSUB,oper1(OREGEX,yyvsp[-5]),yyvsp[-3],yyvsp[-1]); }
break;
case 83:
#line 269 ""a2p.y""
{ yyval = oper3(OGSUB,yyvsp[-5],yyvsp[-3],yyvsp[-1]); }
break;
case 84:
#line 271 ""a2p.y""
{ yyval = oper3(OGSUB,oper1(OREGEX,yyvsp[-5]),yyvsp[-3],yyvsp[-1]); }
break;
case 85:
#line 275 ""a2p.y""
{ yyval = oper1(OVAR,yyvsp[0]); }
break;
case 86:
#line 277 ""a2p.y""
{ yyval = oper2(OVAR,aryrefarg(yyvsp[-3]),yyvsp[-1]); }
break;
case 87:
#line 279 ""a2p.y""
{ yyval = oper1(OFLD,yyvsp[0]); }
break;
case 88:
#line 281 ""a2p.y""
{ yyval = oper1(OVFLD,oper1(OVAR,yyvsp[0])); }
break;
case 89:
#line 283 ""a2p.y""
{ yyval = oper1(OVFLD,yyvsp[0]); }
break;
case 92:
#line 290 ""a2p.y""
{ yyval = Nullop; }
break;
case 93:
#line 294 ""a2p.y""
{ yyval = oper3(OCOMMA,yyvsp[-3],yyvsp[-1],yyvsp[0]); }
break;
case 94:
#line 296 ""a2p.y""
{ yyval = oper3(OCOMMA,yyvsp[-3],yyvsp[-1],yyvsp[0]); }
break;
case 95:
#line 298 ""a2p.y""
{ yyval = yyvsp[-1]; }
break;
case 96:
#line 302 ""a2p.y""
{ yyval = oper2(OJUNK,yyvsp[-1],yyvsp[0]); }
break;
case 97:
#line 304 ""a2p.y""
{ yyval = Nullop; }
break;
case 98:
#line 308 ""a2p.y""
{ yyval = oper2(OJUNK,oper0(OSEMICOLON),oper0(ONEWLINE)); }
break;
case 99:
#line 310 ""a2p.y""
{ yyval = oper2(OJUNK,oper0(OSEMICOLON),oper0(ONEWLINE)); }
break;
case 100:
#line 312 ""a2p.y""
{ yyval = oper0(ONEWLINE); }
break;
case 101:
#line 314 ""a2p.y""
{ yyval = oper1(OCOMMENT,yyvsp[0]); }
break;
case 102:
#line 318 ""a2p.y""
{ yyval = oper2(OJUNK,yyvsp[-1],yyvsp[0]); }
break;
case 103:
#line 320 ""a2p.y""
{ yyval = Nullop; }
break;
case 104:
#line 324 ""a2p.y""
{ yyval = oper0(ONEWLINE); }
break;
case 105:
#line 326 ""a2p.y""
{ yyval = oper1(OCOMMENT,yyvsp[0]); }
break;
case 106:
#line 331 ""a2p.y""
{ yyval = oper2(OJUNK,oper0(OSEMICOLON),yyvsp[0]); }
break;
case 107:
#line 333 ""a2p.y""
{ yyval = oper2(OJUNK,oper0(OSNEWLINE),yyvsp[0]); }
break;
case 108:
#line 335 ""a2p.y""
{ yyval = oper2(OJUNK,oper0(OSNEWLINE),yyvsp[0]); }
break;
case 109:
#line 337 ""a2p.y""
{ yyval = oper2(OJUNK,oper1(OSCOMMENT,yyvsp[-1]),yyvsp[0]); }
break;
case 110:
#line 341 ""a2p.y""
{ yyval = oper2(OSTATES,yyvsp[-1],yyvsp[0]); }
break;
case 111:
#line 343 ""a2p.y""
{ yyval = Nullop; }
break;
case 112:
#line 348 ""a2p.y""
{ yyval = oper2(OJUNK,oper2(OSTATE,yyvsp[-2],yyvsp[-1]),yyvsp[0]); }
break;
case 113:
#line 350 ""a2p.y""
{ yyval = oper2(OSTATE,Nullop,oper2(OJUNK,oper0(OSEMICOLON),yyvsp[0])); }
break;
case 114:
#line 352 ""a2p.y""
{ yyval = oper2(OSTATE,Nullop,oper2(OJUNK,oper0(OSNEWLINE),yyvsp[0])); }
break;
case 117:
#line 358 ""a2p.y""
{ yyval = Nullop; }
break;
case 119:
#line 364 ""a2p.y""
{ yyval = oper3(OPRINT,yyvsp[-2],yyvsp[-1],yyvsp[0]);
		    do_opens = TRUE;
		    saw_ORS = saw_OFS = TRUE;
		    if (!yyvsp[-2]) need_entire = TRUE;
		    if (ops[yyvsp[0]].ival != OSTR + (1<<8)) do_fancy_opens = TRUE; }
break;
case 120:
#line 370 ""a2p.y""
{ yyval = oper1(OPRINT,yyvsp[0]);
		    if (!yyvsp[0]) need_entire = TRUE;
		    saw_ORS = saw_OFS = TRUE;
		}
break;
case 121:
#line 375 ""a2p.y""
{ yyval = oper3(OPRINTF,yyvsp[-2],yyvsp[-1],yyvsp[0]);
		    do_opens = TRUE;
		    if (!yyvsp[-2]) need_entire = TRUE;
		    if (ops[yyvsp[0]].ival != OSTR + (1<<8)) do_fancy_opens = TRUE; }
break;
case 122:
#line 380 ""a2p.y""
{ yyval = oper1(OPRINTF,yyvsp[0]);
		    if (!yyvsp[0]) need_entire = TRUE;
		}
break;
case 123:
#line 384 ""a2p.y""
{ yyval = oper0(OBREAK); }
break;
case 124:
#line 386 ""a2p.y""
{ yyval = oper0(ONEXT); }
break;
case 125:
#line 388 ""a2p.y""
{ yyval = oper0(OEXIT); }
break;
case 126:
#line 390 ""a2p.y""
{ yyval = oper1(OEXIT,yyvsp[0]); }
break;
case 127:
#line 392 ""a2p.y""
{ yyval = oper0(OCONTINUE); }
break;
case 128:
#line 394 ""a2p.y""
{ yyval = oper0(ORETURN); }
break;
case 129:
#line 396 ""a2p.y""
{ yyval = oper1(ORETURN,yyvsp[0]); }
break;
case 130:
#line 398 ""a2p.y""
{ yyval = oper2(ODELETE,aryrefarg(yyvsp[-3]),yyvsp[-1]); }
break;
case 131:
#line 402 ""a2p.y""
{ yyval = oper1(OREDIR,string("">"",1)); }
break;
case 132:
#line 404 ""a2p.y""
{ yyval = oper1(OREDIR,string("">>"",2)); }
break;
case 133:
#line 406 ""a2p.y""
{ yyval = oper1(OREDIR,string(""|"",1)); }
break;
case 134:
#line 411 ""a2p.y""
{ yyval = oper2(OIF,yyvsp[-3],bl(yyvsp[0],yyvsp[-1])); }
break;
case 135:
#line 413 ""a2p.y""
{ yyval = oper3(OIF,yyvsp[-6],bl(yyvsp[-3],yyvsp[-4]),bl(yyvsp[0],yyvsp[-1])); }
break;
case 136:
#line 415 ""a2p.y""
{ yyval = oper2(OWHILE,yyvsp[-3],bl(yyvsp[0],yyvsp[-1])); }
break;
case 137:
#line 417 ""a2p.y""
{ yyval = oper2(ODO,bl(yyvsp[-4],yyvsp[-5]),yyvsp[-1]); }
break;
case 138:
#line 419 ""a2p.y""
{ yyval = oper4(OFOR,yyvsp[-7],yyvsp[-5],yyvsp[-3],bl(yyvsp[0],yyvsp[-1])); }
break;
case 139:
#line 421 ""a2p.y""
{ yyval = oper4(OFOR,yyvsp[-6],string("""",0),yyvsp[-3],bl(yyvsp[0],yyvsp[-1])); }
break;
case 140:
#line 423 ""a2p.y""
{ yyval = oper2(OFORIN,yyvsp[-3],bl(yyvsp[0],yyvsp[-1])); }
break;
case 141:
#line 425 ""a2p.y""
{ yyval = oper3(OBLOCK,oper2(OJUNK,yyvsp[-3],yyvsp[-2]),Nullop,yyvsp[0]); }
break;
#line 2878 ""y.tab.c""
    }
    yyssp -= yym;
    yystate = *yyssp;
    yyvsp -= yym;
    yym = yylhs[yyn];
    if (yystate == 0 && yym == 0)
    {
#if YYDEBUG
        if (yydebug)
            printf(""%sdebug: after reduction, shifting from state 0 to\
 state %d\n"", YYPREFIX, YYFINAL);
#endif
        yystate = YYFINAL;
        *++yyssp = YYFINAL;
        *++yyvsp = yyval;
        if (yychar < 0)
        {
            if ((yychar = yylex()) < 0) yychar = 0;
#if YYDEBUG
            if (yydebug)
            {
                yys = 0;
                if (yychar <= YYMAXTOKEN) yys = yyname[yychar];
                if (!yys) yys = ""illegal-symbol"";
                printf(""%sdebug: state %d, reading %d (%s)\n"",
                        YYPREFIX, YYFINAL, yychar, yys);
            }
#endif
        }
        if (yychar == 0) goto yyaccept;
        goto yyloop;
    }
    if ((yyn = yygindex[yym]) && (yyn += yystate) >= 0 &&
            yyn <= YYTABLESIZE && yycheck[yyn] == yystate)
        yystate = yytable[yyn];
    else
        yystate = yydgoto[yym];
#if YYDEBUG
    if (yydebug)
        printf(""%sdebug: after reduction, shifting from state %d \
to state %d\n"", YYPREFIX, *yyssp, yystate);
#endif
    if (yyssp >= yyss + yystacksize - 1)
    {
        goto yyoverflow;
    }
    *++yyssp = yystate;
    *++yyvsp = yyval;
    goto yyloop;
yyoverflow:
    yyerror(""yacc stack overflow"");
yyabort:
    return (1);
yyaccept:
    return (0);
}
",False,
85,87,NomosTestfiles/Artistic/Artistic-1.0-cl8.txt,Artistic-1.0-cl8,"The Artistic License
Preamble

The intent of this document is to state the conditions under which a Package may be copied, such that the Copyright Holder maintains some semblance of artistic control over the development of the package, while giving the users of the package the right to use and distribute the Package in a more-or-less customary fashion, plus the right to make reasonable modifications.

Definitions:

""Package"" refers to the collection of files distributed by the Copyright Holder, and derivatives of that collection of files created through textual modification.

""Standard Version"" refers to such a Package if it has not been modified, or has been modified in accordance with the wishes of the Copyright Holder.

""Copyright Holder"" is whoever is named in the copyright or copyrights for the package.

""You"" is you, if you're thinking about copying or distributing this Package.

""Reasonable copying fee"" is whatever you can justify on the basis of media cost, duplication charges, time of people involved, and so on. (You will not be required to justify it to the Copyright Holder, but only to the computing community at large as a market that must bear the fee.)

""Freely Available"" means that no fee is charged for the item itself, though there may be fees involved in handling the item. It also means that recipients of the item may redistribute it under the same conditions they received it.

1. You may make and give away verbatim copies of the source form of the Standard Version of this Package without restriction, provided that you duplicate all of the original copyright notices and associated disclaimers.

2. You may apply bug fixes, portability fixes and other modifications derived from the Public Domain or from the Copyright Holder. A Package modified in such a way shall still be considered the Standard Version.

3. You may otherwise modify your copy of this Package in any way, provided that you insert a prominent notice in each changed file stating how and when you changed that file, and provided that you do at least ONE of the following:

  a) place your modifications in the Public Domain or otherwise make them Freely Available, such as by posting said modifications to Usenet or an equivalent medium, or placing the modifications on a major archive site such as ftp.uu.net, or by allowing the Copyright Holder to include your modifications in the Standard Version of the Package.

  b) use the modified Package only within your corporation or organization.

  c) rename any non-standard executables so the names do not conflict with standard executables, which must also be provided, and provide a separate manual page for each non-standard executable that clearly documents how it differs from the Standard Version.

  d) make other distribution arrangements with the Copyright Holder.

4. You may distribute the programs of this Package in object code or executable form, provided that you do at least ONE of the following:

  a) distribute a Standard Version of the executables and library files, together with instructions (in the manual page or equivalent) on where to get the Standard Version.

  b) accompany the distribution with the machine-readable source of the Package with your modifications.

  c) accompany any non-standard executables with their corresponding Standard Version executables, giving the non-standard executables non-standard names, and clearly documenting the differences in manual pages (or equivalent), together with instructions on where to get the Standard Version.

  d) make other distribution arrangements with the Copyright Holder.

5. You may charge a reasonable copying fee for any distribution of this Package. You may charge any fee you choose for support of this Package. You may not charge a fee for this Package itself. However, you may distribute this Package in aggregate with other (possibly commercial) programs as part of a larger (possibly commercial) software distribution provided that you do not advertise this Package as a product of your own.

6. The scripts and library files supplied as input to or produced as output from the programs of this Package do not automatically fall under the copyright of this Package, but belong to whomever generated them, and may be sold commercially, and may be aggregated with this Package.

7. C or perl subroutines supplied by you and linked into this Package shall not be considered part of this Package.

8.Aggregation of this Package with a commercial distribution is always permitted provided that the use of this Package is embedded; that is, when no overt attempt is made to make this Package's interfaces visible to the end user of the commercial distribution. Such use shall not be construed as a distribution of this Package.

9. The name of the Copyright Holder may not be used to endorse or promote products derived from this software without specific prior written permission.

10. THIS PACKAGE IS PROVIDED ""AS IS"" AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.

The End",False,"```
The Artistic License
Preamble

The intent of this document is to state the conditions under which a Package may be copied, such that the Copyright Holder maintains some semblance of artistic control over the development of the package, while giving the users of the package the right to use and distribute the Package in a more-or-less customary fashion, plus the right to make reasonable modifications.

Definitions:

""Package"" refers to the collection of files distributed by the Copyright Holder, and derivatives of that collection of files created through textual modification.

""Standard Version"" refers to such a Package if it has not been modified, or has been modified in accordance with the wishes of the Copyright Holder.

""Copyright Holder"" is whoever is named in the copyright or copyrights for the package.

""You"" is you, if you're thinking about copying or distributing this Package.

""Reasonable copying fee"" is whatever you can justify on the basis of media cost, duplication charges, time of people involved, and so on. (You will not be required to justify it to the Copyright Holder, but only to the computing community at large as a market that must bear the fee.)

""Freely Available"" means that no fee is charged for the item itself, though there may be fees involved in handling the item. It also means that recipients of the item may redistribute it under the same conditions they received it.

1. You may make and give away verbatim copies of the source form of the Standard Version of this Package without restriction, provided that you duplicate all of the original copyright notices and associated disclaimers.

2. You may apply bug fixes, portability fixes and other modifications derived from the Public Domain or from the Copyright Holder. A Package modified in such a way shall still be considered the Standard Version.

3. You may otherwise modify your copy of this Package in any way, provided that you insert a prominent notice in each changed file stating how and when you changed that file, and provided that you do at least ONE of the following:

  a) place your modifications in the Public Domain or otherwise make them Freely Available, such as by posting said modifications to Usenet or an equivalent medium, or placing the modifications on a major archive site such as ftp.uu.net, or by allowing the Copyright Holder to include your modifications in the Standard Version of the Package.

  b) use the modified Package only within your corporation or organization.

  c) rename any non-standard executables so the names do not conflict with standard executables, which must also be provided, and provide a separate manual page for each non-standard executable that clearly documents how it differs from the Standard Version.

  d) make other distribution arrangements with the Copyright Holder.

4. You may distribute the programs of this Package in object code or executable form, provided that you do at least ONE of the following:

  a) distribute a Standard Version of the executables and library files, together with instructions (in the manual page or equivalent) on where to get the Standard Version.

  b) accompany the distribution with the machine-readable source of the Package with your modifications.

  c) accompany any non-standard executables with their corresponding Standard Version executables, giving the non-standard executables non-standard names, and clearly documenting the differences in manual pages (or equivalent), together with instructions on where to get the Standard Version.

  d) make other distribution arrangements with the Copyright Holder.

5. You may charge a reasonable copying fee for any distribution of this Package. You may charge any fee you choose for support of this Package. You may not charge a fee for this Package itself. However, you may distribute this Package in aggregate with other (possibly commercial) programs as part of a larger (possibly commercial) software distribution provided that you do not advertise this Package as a product of your own.

6. The scripts and library files supplied as input to or produced as output from the programs of this Package do not automatically fall under the copyright of this Package, but belong to whomever generated them, and may be sold commercially, and may be aggregated with this Package.

7. C or perl subroutines supplied by you and linked into this Package shall not be considered part of this Package.

8.Aggregation of this Package with a commercial distribution is always permitted provided that the use of this Package is embedded; that is, when no overt attempt is made to make this Package's interfaces visible to the end user of the commercial distribution. Such use shall not be construed as a distribution of this Package.

9. The name of the Copyright Holder may not be used to endorse or promote products derived from this software without specific prior written permission.

10. THIS PACKAGE IS PROVIDED ""AS IS"" AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.

The End```"
86,88,NomosTestfiles/Artistic/Artistic-1.0-Perl.txt,Artistic-1.0-Perl,"The ""Artistic License""

Preamble

The intent of this document is to state the conditions under which a Package may be copied, such that the Copyright Holder maintains some semblance of artistic control over the development of the package, while giving the users of the package the right to use and distribute the Package in a more-or-less customary fashion, plus the right to make reasonable modifications.

Definitions:

""Package"" refers to the collection of files distributed by the Copyright Holder, and derivatives of that collection of files created through textual modification.

""Standard Version"" refers to such a Package if it has not been modified, or has been modified in accordance with the wishes of the Copyright Holder as specified below.

""Copyright Holder"" is whoever is named in the copyright or copyrights for the package.

""You"" is you, if you're thinking about copying or distributing this Package.

""Reasonable copying fee"" is whatever you can justify on the basis of media cost, duplication charges, time of people involved, and so on.  (You will not be required to justify it to the Copyright Holder, but only to the computing community at large as a market that must bear the fee.)

""Freely Available"" means that no fee is charged for the item itself, though there may be fees involved in handling the item. It also means that recipients of the item may redistribute it under the same conditions they received it.

1. You may make and give away verbatim copies of the source form of the Standard Version of this Package without restriction, provided that you duplicate all of the original copyright notices and associated disclaimers.

2. You may apply bug fixes, portability fixes and other modifications derived from the Public Domain or from the Copyright Holder.  A Package modified in such a way shall still be considered the Standard Version.

3. You may otherwise modify your copy of this Package in any way, provided that you insert a prominent notice in each changed file stating how and when you changed that file, and provided that you do at least ONE of the following:

    a) place your modifications in the Public Domain or otherwise make them Freely Available, such as by posting said modifications to Usenet or an equivalent medium, or placing the modifications on a major archive site such as uunet.uu.net, or by allowing the Copyright Holder to include your modifications in the Standard Version of the Package.

    b) use the modified Package only within your corporation or organization.

    c) rename any non-standard executables so the names do not conflict with standard executables, which must also be provided, and provide a separate manual page for each non-standard executable that clearly documents how it differs from the Standard Version.

    d) make other distribution arrangements with the Copyright Holder.

4. You may distribute the programs of this Package in object code or executable form, provided that you do at least ONE of the following:

    a) distribute a Standard Version of the executables and library files, together with instructions (in the manual page or equivalent) on where to get the Standard Version.

    b) accompany the distribution with the machine-readable source of the Package with your modifications.

    c) give non-standard executables non-standard names, and clearly document the differences in manual pages (or equivalent), together with instructions on where to get the Standard Version.

    d) make other distribution arrangements with the Copyright Holder.

5. You may charge a reasonable copying fee for any distribution of this Package.  You may charge any fee you choose for support of this Package.  You may not charge a fee for this Package itself.  However, you may distribute this Package in aggregate with other (possibly commercial) programs as part of a larger (possibly commercial) software distribution provided that you do not advertise this Package as a product of your own.  You may embed this Package's interpreter within an executable of yours (by linking); this shall be construed as a mere form of aggregation, provided that the complete Standard Version of the interpreter is so embedded.

6. The scripts and library files supplied as input to or produced as output from the programs of this Package do not automatically fall under the copyright of this Package, but belong to whoever generated them, and may be sold commercially, and may be aggregated with this Package.  If such scripts or library files are aggregated with this Package via the so-called ""undump"" or ""unexec"" methods of producing a binary executable image, then distribution of such an image shall neither be construed as a distribution of this Package nor shall it fall under the restrictions of Paragraphs 3 and 4, provided that you do not represent such an executable image as a Standard Version of this Package.

7. C subroutines (or comparably compiled subroutines in other languages) supplied by you and linked into this Package in order to emulate subroutines and variables of the language defined by this Package shall not be considered part of this Package, but are the equivalent of input as in Paragraph 6, provided these subroutines do not change the language in any way that would cause it to fail the regression tests for the language.

8. Aggregation of this Package with a commercial distribution is always permitted provided that the use of this Package is embedded; that is, when no overt attempt is made to make this Package's interfaces visible to the end user of the commercial distribution.  Such use shall not be construed as a distribution of this Package.

9. The name of the Copyright Holder may not be used to endorse or promote products derived from this software without specific prior written permission.

10. THIS PACKAGE IS PROVIDED ""AS IS"" AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.

The End
",False,"```
The ""Artistic License""

Preamble

The intent of this document is to state the conditions under which a Package may be copied, such that the Copyright Holder maintains some semblance of artistic control over the development of the package, while giving the users of the package the right to use and distribute the Package in a more-or-less customary fashion, plus the right to make reasonable modifications.

Definitions:

""Package"" refers to the collection of files distributed by the Copyright Holder, and derivatives of that collection of files created through textual modification.

""Standard Version"" refers to such a Package if it has not been modified, or has been modified in accordance with the wishes of the Copyright Holder as specified below.

""Copyright Holder"" is whoever is named in the copyright or copyrights for the package.

""You"" is you, if you're thinking about copying or distributing this Package.

""Reasonable copying fee"" is whatever you can justify on the basis of media cost, duplication charges, time of people involved, and so on.  (You will not be required to justify it to the Copyright Holder, but only to the computing community at large as a market that must bear the fee.)

""Freely Available"" means that no fee is charged for the item itself, though there may be fees involved in handling the item. It also means that recipients of the item may redistribute it under the same conditions they received it.

1. You may make and give away verbatim copies of the source form of the Standard Version of this Package without restriction, provided that you duplicate all of the original copyright notices and associated disclaimers.

2. You may apply bug fixes, portability fixes and other modifications derived from the Public Domain or from the Copyright Holder.  A Package modified in such a way shall still be considered the Standard Version.

3. You may otherwise modify your copy of this Package in any way, provided that you insert a prominent notice in each changed file stating how and when you changed that file, and provided that you do at least ONE of the following:

    a) place your modifications in the Public Domain or otherwise make them Freely Available, such as by posting said modifications to Usenet or an equivalent medium, or placing the modifications on a major archive site such as uunet.uu.net, or by allowing the Copyright Holder to include your modifications in the Standard Version of the Package.

    b) use the modified Package only within your corporation or organization.

    c) rename any non-standard executables so the names do not conflict with standard executables, which must also be provided, and provide a separate manual page for each non-standard executable that clearly documents how it differs from the Standard Version.

    d) make other distribution arrangements with the Copyright Holder.

4. You may distribute the programs of this Package in object code or executable form, provided that you do at least ONE of the following:

    a) distribute a Standard Version of the executables and library files, together with instructions (in the manual page or equivalent) on where to get the Standard Version.

    b) accompany the distribution with the machine-readable source of the Package with your modifications.

    c) give non-standard executables non-standard names, and clearly document the differences in manual pages (or equivalent), together with instructions on where to get the Standard Version.

    d) make other distribution arrangements with the Copyright Holder.

5. You may charge a reasonable copying fee for any distribution of this Package.  You may charge any fee you choose for support of this Package.  You may not charge a fee for this Package itself.  However, you may distribute this Package in aggregate with other (possibly commercial) programs as part of a larger (possibly commercial) software distribution provided that you do not advertise this Package as a product of your own.  You may embed this Package's interpreter within an executable of yours (by linking); this shall be construed as a mere form of aggregation, provided that the complete Standard Version of the interpreter is so embedded.

6. The scripts and library files supplied as input to or produced as output from the programs of this Package do not automatically fall under the copyright of this Package, but belong to whoever generated them, and may be sold commercially, and may be aggregated with this Package.  If such scripts or library files are aggregated with this Package via the so-called ""undump"" or ""unexec"" methods of producing a binary executable image, then distribution of such an image shall neither be construed as a distribution of this Package nor shall it fall under the restrictions of Paragraphs 3 and 4, provided that you do not represent such an executable image as a Standard Version of this Package.

7. C subroutines (or comparably compiled subroutines in other languages) supplied by you and linked into this Package in order to emulate subroutines and variables of the language defined by this Package shall not be considered part of this Package, but are the equivalent of input as in Paragraph 6, provided these subroutines do not change the language in any way that would cause it to fail the regression tests for the language.

8. Aggregation of this Package with a commercial distribution is always permitted provided that the use of this Package is embedded; that is, when no overt attempt is made to make this Package's interfaces visible to the end user of the commercial distribution.  Such use shall not be construed as a distribution of this Package.

9. The name of the Copyright Holder may not be used to endorse or promote products derived from this software without specific prior written permission.

10. THIS PACKAGE IS PROVIDED ""AS IS"" AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.

The End```"
87,89,NomosTestfiles/Artistic/Artistic-1.0.txt,Artistic-1.0,"The Artistic License
Preamble

The intent of this document is to state the conditions under which a Package may be copied, such that the Copyright Holder maintains some semblance of artistic control over the development of the package, while giving the users of the package the right to use and distribute the Package in a more-or-less customary fashion, plus the right to make reasonable modifications.

Definitions:

""Package"" refers to the collection of files distributed by the Copyright Holder, and derivatives of that collection of files created through textual modification.
""Standard Version"" refers to such a Package if it has not been modified, or has been modified in accordance with the wishes of the Copyright Holder.
""Copyright Holder"" is whoever is named in the copyright or copyrights for the package.
""You"" is you, if you're thinking about copying or distributing this Package.
""Reasonable copying fee"" is whatever you can justify on the basis of media cost, duplication charges, time of people involved, and so on. (You will not be required to justify it to the Copyright Holder, but only to the computing community at large as a market that must bear the fee.)
""Freely Available"" means that no fee is charged for the item itself, though there may be fees involved in handling the item. It also means that recipients of the item may redistribute it under the same conditions they received it.
1. You may make and give away verbatim copies of the source form of the Standard Version of this Package without restriction, provided that you duplicate all of the original copyright notices and associated disclaimers.

2. You may apply bug fixes, portability fixes and other modifications derived from the Public Domain or from the Copyright Holder. A Package modified in such a way shall still be considered the Standard Version.

3. You may otherwise modify your copy of this Package in any way, provided that you insert a prominent notice in each changed file stating how and when you changed that file, and provided that you do at least ONE of the following:

a) place your modifications in the Public Domain or otherwise make them Freely Available, such as by posting said modifications to Usenet or an equivalent medium, or placing the modifications on a major archive site such as ftp.uu.net, or by allowing the Copyright Holder to include your modifications in the Standard Version of the Package.

b) use the modified Package only within your corporation or organization.

c) rename any non-standard executables so the names do not conflict with standard executables, which must also be provided, and provide a separate manual page for each non-standard executable that clearly documents how it differs from the Standard Version.

d) make other distribution arrangements with the Copyright Holder.

4. You may distribute the programs of this Package in object code or executable form, provided that you do at least ONE of the following:

a) distribute a Standard Version of the executables and library files, together with instructions (in the manual page or equivalent) on where to get the Standard Version.

b) accompany the distribution with the machine-readable source of the Package with your modifications.

c) accompany any non-standard executables with their corresponding Standard Version executables, giving the non-standard executables non-standard names, and clearly documenting the differences in manual pages (or equivalent), together with instructions on where to get the Standard Version.

d) make other distribution arrangements with the Copyright Holder.

5. You may charge a reasonable copying fee for any distribution of this Package. You may charge any fee you choose for support of this Package. You may not charge a fee for this Package itself. However, you may distribute this Package in aggregate with other (possibly commercial) programs as part of a larger (possibly commercial) software distribution provided that you do not advertise this Package as a product of your own.

6. The scripts and library files supplied as input to or produced as output from the programs of this Package do not automatically fall under the copyright of this Package, but belong to whomever generated them, and may be sold commercially, and may be aggregated with this Package.

7. C or perl subroutines supplied by you and linked into this Package shall not be considered part of this Package.

8. The name of the Copyright Holder may not be used to endorse or promote products derived from this software without specific prior written permission.

9. THIS PACKAGE IS PROVIDED ""AS IS"" AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.

The End
",False,"```
The Artistic License
Preamble

The intent of this document is to state the conditions under which a Package may be copied, such that the Copyright Holder maintains some semblance of artistic control over the development of the package, while giving the users of the package the right to use and distribute the Package in a more-or-less customary fashion, plus the right to make reasonable modifications.

Definitions:

""Package"" refers to the collection of files distributed by the Copyright Holder, and derivatives of that collection of files created through textual modification.
""Standard Version"" refers to such a Package if it has not been modified, or has been modified in accordance with the wishes of the Copyright Holder.
""Copyright Holder"" is whoever is named in the copyright or copyrights for the package.
""You"" is you, if you're thinking about copying or distributing this Package.
""Reasonable copying fee"" is whatever you can justify on the basis of media cost, duplication charges, time of people involved, and so on. (You will not be required to justify it to the Copyright Holder, but only to the computing community at large as a market that must bear the fee.)
""Freely Available"" means that no fee is charged for the item itself, though there may be fees involved in handling the item. It also means that recipients of the item may redistribute it under the same conditions they received it.
1. You may make and give away verbatim copies of the source form of the Standard Version of this Package without restriction, provided that you duplicate all of the original copyright notices and associated disclaimers.

2. You may apply bug fixes, portability fixes and other modifications derived from the Public Domain or from the Copyright Holder. A Package modified in such a way shall still be considered the Standard Version.

3. You may otherwise modify your copy of this Package in any way, provided that you insert a prominent notice in each changed file stating how and when you changed that file, and provided that you do at least ONE of the following:

a) place your modifications in the Public Domain or otherwise make them Freely Available, such as by posting said modifications to Usenet or an equivalent medium, or placing the modifications on a major archive site such as ftp.uu.net, or by allowing the Copyright Holder to include your modifications in the Standard Version of the Package.

b) use the modified Package only within your corporation or organization.

c) rename any non-standard executables so the names do not conflict with standard executables, which must also be provided, and provide a separate manual page for each non-standard executable that clearly documents how it differs from the Standard Version.

d) make other distribution arrangements with the Copyright Holder.

4. You may distribute the programs of this Package in object code or executable form, provided that you do at least ONE of the following:

a) distribute a Standard Version of the executables and library files, together with instructions (in the manual page or equivalent) on where to get the Standard Version.

b) accompany the distribution with the machine-readable source of the Package with your modifications.

c) accompany any non-standard executables with their corresponding Standard Version executables, giving the non-standard executables non-standard names, and clearly documenting the differences in manual pages (or equivalent), together with instructions on where to get the Standard Version.

d) make other distribution arrangements with the Copyright Holder.

5. You may charge a reasonable copying fee for any distribution of this Package. You may charge any fee you choose for support of this Package. You may not charge a fee for this Package itself. However, you may distribute this Package in aggregate with other (possibly commercial) programs as part of a larger (possibly commercial) software distribution provided that you do not advertise this Package as a product of your own.

6. The scripts and library files supplied as input to or produced as output from the programs of this Package do not automatically fall under the copyright of this Package, but belong to whomever generated them, and may be sold commercially, and may be aggregated with this Package.

7. C or perl subroutines supplied by you and linked into this Package shall not be considered part of this Package.

8. The name of the Copyright Holder may not be used to endorse or promote products derived from this software without specific prior written permission.

9. THIS PACKAGE IS PROVIDED ""AS IS"" AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.

The End```"
88,90,NomosTestfiles/Artistic/Artistic-2.0_ref_a.txt,Artistic-2.0,"## Original code and the switchr R package are
## Copyright 2018 Genentech Inc. All Rights Reserved.
## Author: Gabriel Becker <gabembecker@gmail.com>
## Distributed under the Artistic 2.0 License
",False,"```
## Copyright 2018 Genentech Inc. All Rights Reserved.
## Distributed under the Artistic 2.0 License
```"
89,91,NomosTestfiles/Artistic/Artistic-2.0.txt,Artistic-2.0,"         The Artistic License 2.0

     Copyright (c) 2000-2006, The Perl Foundation.

     Everyone is permitted to copy and distribute verbatim copies
      of this license document, but changing it is not allowed.

Preamble

This license establishes the terms under which a given free software
Package may be copied, modified, distributed, and/or redistributed.
The intent is that the Copyright Holder maintains some artistic
control over the development of that Package while still keeping the
Package available as open source and free software.

You are always permitted to make arrangements wholly outside of this
license directly with the Copyright Holder of a given Package.  If the
terms of this license do not permit the full use that you propose to
make of the Package, you should contact the Copyright Holder and seek
a different licensing arrangement. 

Definitions

    ""Copyright Holder"" means the individual(s) or organization(s)
    named in the copyright notice for the entire Package.

    ""Contributor"" means any party that has contributed code or other
    material to the Package, in accordance with the Copyright Holder's
    procedures.

    ""You"" and ""your"" means any person who would like to copy,
    distribute, or modify the Package.

    ""Package"" means the collection of files distributed by the
    Copyright Holder, and derivatives of that collection and/or of
    those files. A given Package may consist of either the Standard
    Version, or a Modified Version.

    ""Distribute"" means providing a copy of the Package or making it
    accessible to anyone else, or in the case of a company or
    organization, to others outside of your company or organization.

    ""Distributor Fee"" means any fee that you charge for Distributing
    this Package or providing support for this Package to another
    party.  It does not mean licensing fees.

    ""Standard Version"" refers to the Package if it has not been
    modified, or has been modified only in ways explicitly requested
    by the Copyright Holder.

    ""Modified Version"" means the Package, if it has been changed, and
    such changes were not explicitly requested by the Copyright
    Holder. 

    ""Original License"" means this Artistic License as Distributed with
    the Standard Version of the Package, in its current version or as
    it may be modified by The Perl Foundation in the future.

    ""Source"" form means the source code, documentation source, and
    configuration files for the Package.

    ""Compiled"" form means the compiled bytecode, object code, binary,
    or any other form resulting from mechanical transformation or
    translation of the Source form.


Permission for Use and Modification Without Distribution

(1)  You are permitted to use the Standard Version and create and use
Modified Versions for any purpose without restriction, provided that
you do not Distribute the Modified Version.


Permissions for Redistribution of the Standard Version

(2)  You may Distribute verbatim copies of the Source form of the
Standard Version of this Package in any medium without restriction,
either gratis or for a Distributor Fee, provided that you duplicate
all of the original copyright notices and associated disclaimers.  At
your discretion, such verbatim copies may or may not include a
Compiled form of the Package.

(3)  You may apply any bug fixes, portability changes, and other
modifications made available from the Copyright Holder.  The resulting
Package will still be considered the Standard Version, and as such
will be subject to the Original License.


Distribution of Modified Versions of the Package as Source 

(4)  You may Distribute your Modified Version as Source (either gratis
or for a Distributor Fee, and with or without a Compiled form of the
Modified Version) provided that you clearly document how it differs
from the Standard Version, including, but not limited to, documenting
any non-standard features, executables, or modules, and provided that
you do at least ONE of the following:

    (a)  make the Modified Version available to the Copyright Holder
    of the Standard Version, under the Original License, so that the
    Copyright Holder may include your modifications in the Standard
    Version.

    (b)  ensure that installation of your Modified Version does not
    prevent the user installing or running the Standard Version. In
    addition, the Modified Version must bear a name that is different
    from the name of the Standard Version.

    (c)  allow anyone who receives a copy of the Modified Version to
    make the Source form of the Modified Version available to others
    under
  
 	(i)  the Original License or

 	(ii)  a license that permits the licensee to freely copy,
 	modify and redistribute the Modified Version using the same
 	licensing terms that apply to the copy that the licensee
 	received, and requires that the Source form of the Modified
 	Version, and of any works derived from it, be made freely
 	available in that license fees are prohibited but Distributor
 	Fees are allowed.


Distribution of Compiled Forms of the Standard Version 
or Modified Versions without the Source

(5)  You may Distribute Compiled forms of the Standard Version without
the Source, provided that you include complete instructions on how to
get the Source of the Standard Version.  Such instructions must be
valid at the time of your distribution.  If these instructions, at any
time while you are carrying out such distribution, become invalid, you
must provide new instructions on demand or cease further distribution.
If you provide valid instructions or cease distribution within thirty
days after you become aware that the instructions are invalid, then
you do not forfeit any of your rights under this license.

(6)  You may Distribute a Modified Version in Compiled form without
the Source, provided that you comply with Section 4 with respect to
the Source of the Modified Version.


Aggregating or Linking the Package 

(7)  You may aggregate the Package (either the Standard Version or
Modified Version) with other packages and Distribute the resulting
aggregation provided that you do not charge a licensing fee for the
Package.  Distributor Fees are permitted, and licensing fees for other
components in the aggregation are permitted. The terms of this license
apply to the use and Distribution of the Standard or Modified Versions
as included in the aggregation.

(8) You are permitted to link Modified and Standard Versions with
other works, to embed the Package in a larger work of your own, or to
build stand-alone binary or bytecode versions of applications that
include the Package, and Distribute the result without restriction,
provided the result does not expose a direct interface to the Package.


Items That are Not Considered Part of a Modified Version 

(9) Works (including, but not limited to, modules and scripts) that
merely extend or make use of the Package, do not, by themselves, cause
the Package to be a Modified Version.  In addition, such works are not
considered parts of the Package itself, and are not subject to the
terms of this license.


General Provisions

(10)  Any use, modification, and distribution of the Standard or
Modified Versions is governed by this Artistic License. By using,
modifying or distributing the Package, you accept this license. Do not
use, modify, or distribute the Package, if you do not accept this
license.

(11)  If your Modified Version has been derived from a Modified
Version made by someone other than you, you are nevertheless required
to ensure that your Modified Version complies with the requirements of
this license.

(12)  This license does not grant you the right to use any trademark,
service mark, tradename, or logo of the Copyright Holder.

(13)  This license includes the non-exclusive, worldwide,
free-of-charge patent license to make, have made, use, offer to sell,
sell, import and otherwise transfer the Package with respect to any
patent claims licensable by the Copyright Holder that are necessarily
infringed by the Package. If you institute patent litigation
(including a cross-claim or counterclaim) against any party alleging
that the Package constitutes direct or contributory patent
infringement, then this Artistic License to you shall terminate on the
date that such litigation is filed.

(14)  Disclaimer of Warranty:
THE PACKAGE IS PROVIDED BY THE COPYRIGHT HOLDER AND CONTRIBUTORS ""AS
IS' AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES. THE IMPLIED
WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR
NON-INFRINGEMENT ARE DISCLAIMED TO THE EXTENT PERMITTED BY YOUR LOCAL
LAW. UNLESS REQUIRED BY LAW, NO COPYRIGHT HOLDER OR CONTRIBUTOR WILL
BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES ARISING IN ANY WAY OUT OF THE USE OF THE PACKAGE, EVEN IF
ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
",False,"```
         The Artistic License 2.0

     Copyright (c) 2000-2006, The Perl Foundation.

     Everyone is permitted to copy and distribute verbatim copies
      of this license document, but changing it is not allowed.

Preamble

This license establishes the terms under which a given free software
Package may be copied, modified, distributed, and/or redistributed.
The intent is that the Copyright Holder maintains some artistic
control over the development of that Package while still keeping the
Package available as open source and free software.

You are always permitted to make arrangements wholly outside of this
license directly with the Copyright Holder of a given Package.  If the
terms of this license do not permit the full use that you propose to
make of the Package, you should contact the Copyright Holder and seek
a different licensing arrangement. 

Definitions

    ""Copyright Holder"" means the individual(s) or organization(s)
    named in the copyright notice for the entire Package.

    ""Contributor"" means any party that has contributed code or other
    material to the Package, in accordance with the Copyright Holder's
    procedures.

    ""You"" and ""your"" means any person who would like to copy,
    distribute, or modify the Package.

    ""Package"" means the collection of files distributed by the
    Copyright Holder, and derivatives of that collection and/or of
    those files. A given Package may consist of either the Standard
    Version, or a Modified Version.

    ""Distribute"" means providing a copy of the Package or making it
    accessible to anyone else, or in the case of a company or
    organization, to others outside of your company or organization.

    ""Distributor Fee"" means any fee that you charge for Distributing
    this Package or providing support for this Package to another
    party.  It does not mean licensing fees.

    ""Standard Version"" refers to the Package if it has not been
    modified, or has been modified only in ways explicitly requested
    by the Copyright Holder.

    ""Modified Version"" means the Package, if it has been changed, and
    such changes were not explicitly requested by the Copyright
    Holder. 

    ""Original License"" means this Artistic License as Distributed with
    the Standard Version of the Package, in its current version or as
    it may be modified by The Perl Foundation in the future.

    ""Source"" form means the source code, documentation source, and
    configuration files for the Package.

    ""Compiled"" form means the compiled bytecode, object code, binary,
    or any other form resulting from mechanical transformation or
    translation of the Source form.


Permission for Use and Modification Without Distribution

(1)  You are permitted to use the Standard Version and create and use
Modified Versions for any purpose without restriction, provided that
you do not Distribute the Modified Version.


Permissions for Redistribution of the Standard Version

(2)  You may Distribute verbatim copies of the Source form of the
Standard Version of this Package in any medium without restriction,
either gratis or for a Distributor Fee, provided that you duplicate
all of the original copyright notices and associated disclaimers.  At
your discretion, such verbatim copies may or may not include a
Compiled form of the Package.

(3)  You may apply any bug fixes, portability changes, and other
modifications made available from the Copyright Holder.  The resulting
Package will still be considered the Standard Version, and as such
will be subject to the Original License.


Distribution of Modified Versions of the Package as Source 

(4)  You may Distribute your Modified Version as Source (either gratis
or for a Distributor Fee, and with or without a Compiled form of the
Modified Version) provided that you clearly document how it differs
from the Standard Version, including, but not limited to, documenting
any non-standard features, executables, or modules, and provided that
you do at least ONE of the following:

    (a)  make the Modified Version available to the Copyright Holder
    of the Standard Version, under the Original License, so that the
    Copyright Holder may include your modifications in the Standard
    Version.

    (b)  ensure that installation of your Modified Version does not
    prevent the user installing or running the Standard Version. In
    addition, the Modified Version must bear a name that is different
    from the name of the Standard Version.

    (c)  allow anyone who receives a copy of the Modified Version to
    make the Source form of the Modified Version available to others
  
 	(i)  the Original License or

 	(ii)  a license that permits the licensee to freely copy,
 	modify and redistribute the Modified Version using the same
 	licensing terms that apply to the copy that the licensee
 	received, and requires that the Source form of the Modified 
 	Version, and of any works derived from it, be made freely
 	available in that license fees are prohibited but Distributor
 	Fees are allowed.


Distribution of Compiled Forms of the Standard Version 
or Modified Versions without the Source

(5)  You may Distribute Compiled forms of the Standard Version without
the Source, provided that you include complete instructions on how to
get the Source of the Standard Version.  Such instructions must be
valid at the time of your distribution.  If these instructions, at any
time while you are carrying out such distribution, become invalid, you
must provide new instructions on demand or cease further distribution.
If you provide valid instructions or cease distribution within thirty
days after you become aware that the instructions are invalid, then
you do not forfeit any of your rights under this license.

(6)  You may Distribute a Modified Version in Compiled form without
the Source, provided that you comply with Section 4 with respect to
the Source of the Modified Version.


Aggregating or Linking the Package 

(7)  You may aggregate the Package (either the Standard Version or
Modified Version) with other packages and Distribute the resulting
aggregation provided that you do not charge a licensing fee for the
Package.  Distributor Fees are permitted, and licensing fees for other
components in the aggregation are permitted. The terms of this license
apply to the use and Distribution of the Standard or Modified Versions
as included in the aggregation.

(8) You are permitted to link Modified and Standard Versions with
other works, to embed the Package in a larger work of your own, or to
build stand-alone binary or bytecode versions of applications that
include the Package, and Distribute the result without restriction,
provided the result does not expose a direct interface to the Package.


Items That are Not Considered Part of a Modified Version 

(9) Works (including, but not limited to, modules and scripts) that
merely extend or make use of the Package, do not, by themselves, cause
the Package to be a Modified Version.  In addition, such works are not
considered parts of the Package itself, and are not subject to the
terms of this license.


General Provisions

(10)  Any use, modification, and distribution of the Standard or
Modified Versions is governed by this Artistic License. By using,
modifying or distributing the Package, you accept this license. Do not
use, modify, or distribute the Package, if you do not accept this
license.

(11)  If your Modified Version has been derived from a Modified
Version made by someone other than you, you are nevertheless required
to ensure that your Modified Version complies with the requirements of
this license.

(12)  This license does not grant you the right to use any trademark,
service mark, tradename, or logo of the Copyright Holder.

(13)  This license includes the non-exclusive, worldwide,
free-of-charge patent license to make, have made, use, offer to sell,
sell, import and otherwise transfer the Package with respect to any
patent claims licensable by the Copyright Holder that are necessarily
infringed by the Package. If you institute patent litigation
(including a cross-claim or counterclaim) against any party alleging
that the Package constitutes direct or contributory patent
infringement, then this Artistic License to you shall terminate on the
date that such litigation is filed.

(14)  Disclaimer of Warranty:
THE PACKAGE IS PROVIDED BY THE COPYRIGHT HOLDER AND CONTRIBUTORS ""AS
IS' AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES. THE IMPLIED
WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR
NON-INFRINGEMENT ARE DISCLAIMED TO THE EXTENT PERMITTED BY YOUR LOCAL
LAW. UNLESS REQUIRED BY LAW, NO COPYRIGHT HOLDER OR CONTRIBUTOR WILL
BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
DAMAGES ARISING IN ANY WAY OUT OF THE USE OF THE PACKAGE, EVEN IF
ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.```"
90,92,NomosTestfiles/Artistic/Hero.java,Artistic-1.0,"/*
 * Hero.java
 * Copyright (C) 2001, Sandra and Klaus Rennecke.
 *
 * This software may be copied only under the terms of the
 * Artistic License, which can be found in the project documentation
 * and at http://www.opensource.org/licenses/artistic-license.html.
 *
 * THIS SOFTWARE IS PROVIDED ""AS IS"" AND WITHOUT ANY EXPRESS OR IMPLIED
 * WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF
 * MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.
 *
 * $Date: 2004/04/18 07:00:58 $
 */

package saga.model;

import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;
import java.io.Serializable;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.Set;

import saga.control.Control;
import saga.control.HeroLocation;
import saga.model.features.Guild;
import saga.model.features.Shop;
import saga.model.items.Armor;
import saga.model.items.GoldCoin;
import saga.model.items.Weapon;



/**
 * TODO: documentation
 * @author  Sandra Rennecke
 * @version $Revision: 1.1 $
 */
public class Hero extends Mob implements Serializable {
    
    public static final String PROPERTY_HP = ""Hero.hp"";
    public static final String PROPERTY_GOLD = ""Hero.gold"";
    public static final String PROPERTY_WC = ""Hero.wc"";
    public static final String PROPERTY_AC = ""Hero.ac"";
    public static final String PROPERTY_AP = ""Hero.ap"";
    public static final String PROPERTY_ATTACK = ""Hero.attack"";
    public static final String PROPERTY_SKILL = ""Hero.skill"";
    
    
    private HashMap skills;
    Inventory i;
    private boolean male = false;
    
    private Weapon weapon;
    private ArmorSlots wornArmor;
    protected long creationDate;
    protected long birthDate;
    protected int skillPoints;
    
    private static final long serialVersionUID = 4731606345656457822L;
    
    
    
    /** Deserialization constructor. */
    protected Hero() {
    }
    
    public Hero(String name) {
        this(name, 1, 2, 1, 1, 1, 1, 1);
    }
    
    public Hero(String name, int str, int con, int aur,
                int wis, int dex, int agi, int cha) {
        
        super(name, dex, str, con * 10, 1);
        
        skills = new HashMap();
        i = new Inventory(str * 10);
        
        this.str = str;
        this.con = con;
        this.aur = aur;
        this.wis = wis;
        this.dex = dex;
        this.agi = agi;
        this.cha = cha;
        
        weapon = null;
        wornArmor = new ArmorSlots();
        creationDate = Time.getTime().getRealTime();
        skillPoints = 0;
        
        // establish listener
        readResolve();
    }
    
    /** Resolve this hero instance after deserialization. This
     * re-establishes listener relations. */
    private Object readResolve() {
        if (i != null) {
            // add a property change listener to inventory to forward
            // action point change
            i.addPropertyChangeListener(new PropertyChangeListener() {
                public void propertyChange(PropertyChangeEvent ev) {
                    if (propertyChangeSupport != null) {
                        propertyChangeSupport.firePropertyChange
                        (PROPERTY_AP, -1, getActionPoints());
                    }
                }
            });
        }
        return this;
    }
    
    public void addSkillPoints(int n) {
        skillPoints += n;
    }
    public int getSkillPoints() {
        return skillPoints;
    }
    
    public void addSkill(String name, double value, boolean silent) {
        
        if (!skills.containsKey(name)) {
            Integer newValue = new Integer((int)(value * 10));
            skills.put(name, newValue);
            if (propertyChangeSupport != null) {
                propertyChangeSupport.firePropertyChange
                (PROPERTY_SKILL, name, newValue);
            }
            if (!silent) {
                Control.message(getName() + "" learned "" + name
                                + ""("" + value + "")"");
            }
            return;
        }
        int oldval = ((Integer)skills.get(name)).intValue();
        skills.remove(name);
        int val = oldval+((int)(value * 10));
        Integer newValue = new Integer(val);
        skills.put(name, newValue);
        if (propertyChangeSupport != null) {
            propertyChangeSupport.firePropertyChange
            (PROPERTY_SKILL, name, newValue);
        }
        if (!silent) {
            Control.message(getName() + "" gained "" + name
                            + ""("" + ((double)(val / 10.0)) + "")"");
        }
        if (name.equals(Skill.ATTACK)) {
            if (propertyChangeSupport != null) {
                propertyChangeSupport.firePropertyChange
                (PROPERTY_ATTACK, oldval / 10, getAttack());
            }
        }
    }
    public void addSkill(String name, double value) {
        addSkill(name, value, false);
    }
    
    public double skillValue(String name) {
        if (!skills.containsKey(name)) {
            return 0.0;
        }
        return (((Integer)skills.get(name)).intValue() / 10.0);
    }
    
    public Set getSkills() {
        return skills.entrySet();
    }
    public Inventory getInventory() {
        return i;
    }
    
    public void setMale(boolean val) {
        male = val;
    }
    
    public boolean isMale() {
        return male;
    }
    public boolean isFemale() {
        return !male;
    }
    
    public int getStr() {
        return str;
    }
    public void setStr(int newVal) {
        int oldWc = getWc();
        int oldAp = getActionPoints();
        str = newVal;
        if (propertyChangeSupport != null) {
            propertyChangeSupport
                .firePropertyChange(PROPERTY_WC, oldWc, getWc());
            propertyChangeSupport
                .firePropertyChange(PROPERTY_AP, oldAp, getActionPoints());
        }
        
    }
    public int getCon(){
        return con;
    }
    
    public void setCon(int newVal) {
        con = newVal;
        maxhp = con * 10;
        setHp(con * 10);
    }
    
    public int getAur() {
        return aur;
    }
    public int getWis() {
        return wis;
    }
    public int getDex() {
        return dex;
    }
    public void setDex(int newVal) {
        int oldAc = getAc();
        dex = newVal;
        if (propertyChangeSupport != null) {
            propertyChangeSupport
                .firePropertyChange(PROPERTY_AC, oldAc, getAc());
        }
    }
    
    public int getAgi() {
        return agi;
    }
    
    public void setAgi(int newVal) {
        int oldAc = getAc();
        agi = newVal;
        if (propertyChangeSupport != null) {
            propertyChangeSupport
                .firePropertyChange(PROPERTY_AC, oldAc, getAc());
        }
    }
    
    public int getCha(){
        return cha;
    }
    public int getGold(){
        return i.getNumber(Shop.coin);
    }
    
    /**
     * Wield the given weapon <var>w</var>.
     * Previously wielded weapon is removed and added to the inventory.
     * @param w The weapon to wield.
     * @param silent True to suppress output.
     */
    public void wield(Weapon w, boolean silent) {
        if (w != null && !w.canWield(this)) {
            if (!silent) {
                Control.infoIcon(""You are not allowed to wield "" + w,
                                 ""Wielding Weapon"", w);
            }
            return;
        }
        
        int oldWc = getWc();
        
        Weapon oldWeapon = weapon;
        if (oldWeapon != null) {
            if (!silent) {
                Control.infoIcon(""You unwield "" + oldWeapon,
                                 ""Wielding Weapon"", oldWeapon);
            }
            weapon = null;
            addItem(oldWeapon, 1, silent);
        }
        
        if (w != null) {
            removeItem(w, 1, silent);
            weapon = w;
            if(!silent) {
                Control.infoIcon(""You wield "" + w, ""Wielding Weapon"", w);
            }
        }
        
        if (propertyChangeSupport != null) {
            propertyChangeSupport
                .firePropertyChange(PROPERTY_WC, oldWc, getWc());
        }
    }
    
    /**
     * Wield the given weapon <var>w</var>.
     * Previously wielded weapon is removed and added to the inventory.
     * @param w The weapon to wield.
     */
    public void wield(Weapon w) {
        wield(w, false);
    }
    
    /**
     * Wear the given armor <var>a</var>, in the appropriate slot.
     * Previously worn armor is removed and added to the inventory.
     * @param a The armor to wear.
     * @param silent True to suppress output.
     */
    public void wear(Armor a, boolean silent) {
        int oldAc = getAc();
        
        if (a == null) {
            Control.error(""Hero.wear(null)"");
            return;
        }
        Armor oldArmor = wornArmor.getArmor(a.getSlot());
        if (oldArmor!=null) {
            addItem(oldArmor, 1, silent);
        }
        wornArmor.wear(a);
        removeItem(a, 1, silent);
        
        if (!silent) {
            Control.infoIcon(""You wear "" + a, ""Wearing Armor"", a);
        }
        
        if (propertyChangeSupport != null) {
            propertyChangeSupport
                .firePropertyChange(PROPERTY_AC, oldAc, getAc());
        }
    }
    
    /**
     * Wear the given armor <var>a</var>, in the appropriate slot.
     * Previously worn armor is removed and added to the inventory.
     * @param a The armor to wear.
     */
    public void wear(Armor a) {
        wear(a, false);
    }
    
    /**
     * Remove the worn armor <var>a</var>.
     * @param a The armor to remove.
     * @param silent True to suppress output.
     */
    public void removeArmor(Armor a, boolean silent) {
        int oldAc = getAc();
        
        if (a == null) {
            Control.error(""Hero.removeArmor(null)"");
            return;
        }
        
        if (!wornArmor.remove(a)) {
            Control.error(""Cannot remove armor ""+a);
            return;
        }
        addItem(a, 1, silent);
                
        if (!silent) {
            Control.infoIcon(""You stop wearing "" + a, ""Wearing Armor"", a);
        }
        
        if (propertyChangeSupport != null) {
            propertyChangeSupport
                .firePropertyChange(PROPERTY_AC, oldAc, getAc());
        }
    }
    
    public Object[] getAllWeapons() {
        ArrayList l = new ArrayList();
        Iterator it = i.getMiscItems().iterator();
        while (it.hasNext()) {
            Object o = it.next();
            if (o instanceof Weapon) {
                l.add(o);
            }
        }
        return l.toArray();
    }
    
    public Object[] getAllArmor() {
        ArrayList l = new ArrayList();
        Iterator it = i.getMiscItems().iterator();
        while (it.hasNext()) {
            Object o = it.next();
            if (o instanceof Armor) {
                l.add(o);
            }
        }
        return l.toArray();
    }
    
    public Weapon getWeapon() {
        return weapon;
    }
    
    /**
     * Get the worn armor in <var>slot</var>, if any.
     * @param slot The slot to query for armor.
     * @return the armor worn in <var>slot</var>, or null.
     */
    public Armor getArmor(int slot) {
        return wornArmor == null ? null : wornArmor.getArmor(slot);
    }
    
    /**
     * Add <var>number</var> <var>item</var>s to inventory.
     * @return true on success, false otherwise.
     * @param item The item to add.
     * @param number The amount of items to add.
     */
    public boolean addItem(Item item, int number) {
        return addItem(item, number, false);
    }
    
    /**
     * Add <var>number</var> <var>item</var>s to inventory.
     * @return true on success, false otherwise.
     * @param silent True to suppress output.
     * @param item The item to add.
     * @param number The amount of items to add.
     */
    public boolean addItem(Item item, int number, boolean silent) {
        if (item == null) {
            return false;
        }
        
        int oldGold = getGold();
        try {
            return i.addItem(item, number, silent);
        } finally {
            if (item instanceof GoldCoin && propertyChangeSupport != null) {
                propertyChangeSupport
                    .firePropertyChange(PROPERTY_GOLD, oldGold, getGold());
            }
        }
    }
    
    /**
     * Remove <var>number</var> <var>item</var>s from inventory.
     * @param item The item to remove.
     * @param number The amount of items to remove.
     * @return true on success, false otherwise.
     */
    public boolean removeItem(Item item, int number) {
        return removeItem(item, number, false);
    }
    
    /**
     * Remove <var>number</var> <var>item</var>s from inventory.
     * @return true on success, false otherwise.
     * @param silent True to suppress output.
     * @param item The item to remove.
     * @param number The amount of items to remove.
     */
    public boolean removeItem(Item item, int number, boolean silent) {
        if (item == null) {
            return false;
        }
        if (item instanceof GoldCoin) {
            int oldGold = getGold();
            if(number > oldGold) {
                return false;
            }
            if (propertyChangeSupport != null) {
                propertyChangeSupport
                    .firePropertyChange(PROPERTY_GOLD, oldGold,
                                        oldGold - number);
            }
        }
        return i.removeItem(item, number, silent);
    }
    
    /**
     * @return hp left after damage is done
     */
    public int damage(int amount) {
        int oldHp = getHp();
        int newHp = super.damage(amount);
        if (propertyChangeSupport != null) {
            propertyChangeSupport
                .firePropertyChange(PROPERTY_HP, oldHp, newHp);
        }
        //if damage is done to Hero, DEFENSE goes up 10% of the time
        if(Control.random(0, 100) <= 10){
            addSkill(Skill.DEFENSE, 0.1);
        }
        return newHp;
    }
    
    public void heal(int amount) {
        int oldHp = getHp();
        super.heal(amount);
        if (propertyChangeSupport != null) {
            propertyChangeSupport
                .firePropertyChange(PROPERTY_HP, oldHp, getHp());
        }
    }
    
    public void setHp(int hp) {
        int oldHp = getHp();
        super.setHp(hp);
        if (propertyChangeSupport != null) {
            propertyChangeSupport
                .firePropertyChange(PROPERTY_HP, oldHp, getHp());
        }
    }
    
    public int getAc() {
        return super.getAc() + getArmorAc();
    }
    
    public int getArmorAc() {
        return wornArmor.getTotalAc();
    }
    
    public int getWc() {
        int mod = 0;
        if (weapon != null) {
            mod = weapon.getWc();
        }
        return super.getWc() + mod;
    }
    /**
     *@return attack value, the higher the more likely to hit
     **/
    public int getAttack() {
        int attack = super.getAttack();
        int aSkill = (int)skillValue(Skill.ATTACK);
        return attack + aSkill;
    }
    
    /**
     * All damage taken is reduced by 0-resist
     *
     *@return resistance to specified damage type
     **/
    public int getResist(int damageType) {
        
        //Default:  10% of AC resist damage
        int resist = super.getResist(damageType);
        // 20% of defense Skill resist damage
        resist += (int)(skillValue(Skill.DEFENSE) / 5.0);
        
        return resist;
    }
    
    public void setBirthDate(long date) {
        birthDate = date;
    }
    
    public long getBirthDate() {
        return birthDate;
    }
    
    public QuestList getQuestList() {
        QuestList quests = new QuestList();
        Guild guild = HeroLocation.getHeroLocation()
            .getIslandMap().getTownMap().getGuild();
        Quest quest = guild.getQuest(this);
        if (quest != null) {
            quests.addQuest(quest);
        }
        return quests;
    }
    
    public void randomEquip(int level) {
        addItem(saga.model.items.LongSword.getLongSword(
        saga.model.items.LongSword.SHABBY_SWORD), 1);
        Armor a = Armor.getChest(Armor.RED_ROBE, level);
        addItem(a, 1);
        addItem(Armor.getCloak(Armor.BROWN_CLOAK, level), 1);
        addItem(Armor.getBoots(Armor.WORN_LEATHER_BOOTS, level), 1);
        addItem(Armor.getGloves(Armor.WORN_LEATHER_GLOVES, level), 1);
        addItem(Armor.getHelm(Armor.WORN_LEATHER_HELM, level), 1);
        addItem(Armor.getShield(Armor.ORC_SHIELD, level), 1);
        addItem(new saga.model.items.GoldCoin(), 100 * level);
    }
    
    /** Getter for property actionPoints.
     * @return Value of property actionPoints.
     */
    public int getActionPoints() {
        int actionPoints = super.getActionPoints();
        int maxWeight = getMaxWeight();
        int weight = (int)Math.ceil(getInventory().getWeight());
        if (weight > maxWeight) {
            weight -= maxWeight;
            if (weight < maxWeight) {
                actionPoints -= actionPoints * weight / maxWeight;
            } else {
                actionPoints = 0; // duh
            }
        }
        return actionPoints;
    }
    
    /** Setter for property speed.
     * @param speed New value of property speed.
     */
    public void setSpeed(int speed) {
        int oldAp = getActionPoints();
        super.setSpeed(speed);
        if (propertyChangeSupport != null) {
            propertyChangeSupport.firePropertyChange
            (PROPERTY_AP, oldAp, getActionPoints());
        }
    }
    
    /** Getter for property maxWeight.
     * @return Value of property maxWeight.
     */
    public int getMaxWeight() {
        return getStr() * 10;
    }
}
",False,"```java
 * Copyright (C) 2001, Sandra and Klaus Rennecke.
 *
 * This software may be copied only under the terms of the
 * Artistic License, which can be found in the project documentation
 * and at http://www.opensource.org/licenses/artistic-license.html.
 *
 * THIS SOFTWARE IS PROVIDED ""AS IS"" AND WITHOUT ANY EXPRESS OR IMPLIED
 * WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF
 * MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.
 *
 * $Date: 2004/04/18 07:00:58 $
 */
```"
91,93,NomosTestfiles/Artistic/macos_main.cpp,Artistic-1.0,"/* =========================================================================  Copyright (C) 2001 Eric Lavigne  Permission is granted to anyone to use this software for any purpose on any  computer system, and to redistribute it freely, subject to the following   restrictions:  - The author is not responsible for the consequences of use of this   software, no matter how awful, even if they arise from defects in it.  - The origin of this software must not be misrepresented, either by   explicit claim or by omission.  - You are allowed to distributed modified copies of the software, in source   and binary form, provided they are marked plainly as altered versions, and  are not misrepresented as being the original software. ========================================================================= */#include <stdlib.h>#include <string.h>#include <stdio.h>#include <Memory.h>#include <GUSICommandLine.h>#include <stdlib.h>/* ========================================================================= */DECLARE_MAIN(curl)REGISTER_MAIN_STARTREGISTER_MAIN(curl)REGISTER_MAIN_END/* ========================================================================= */int main(){  ::MaxApplZone();  for (int i = 1; i <= 10; i++)    ::MoreMasters();  (void) exec_commands();    return 0;}",False,"```
/* =========================================================================  Copyright (C) 2001 Eric Lavigne  Permission is granted to anyone to use this software for any purpose on any  computer system, and to redistribute it freely, subject to the following   restrictions:  - The author is not responsible for the consequences of use of this   software, no matter how awful, even if they arise from defects in it.  - The origin of this software must not be misrepresented, either by   explicit claim or by omission.  - You are allowed to distributed modified copies of the software, in source   and binary form, provided they are marked plainly as altered versions, and  are not misrepresented as being the original software. ========================================================================= */
```"
92,94,NomosTestfiles/ATT/ATT-Lucent.txt,ATT,"/****************************************************************
*
* The author of this software is David M. Gay.
*
* Copyright (c) 1991, 2000, 2001 by Lucent Technologies.
*
* Permission to use, copy, modify, and distribute this software for any
* purpose without fee is hereby granted, provided that this entire notice
* is included in all copies of any software which is or includes a copy
* or modification of this software and in all copies of the supporting
* documentation for such software.
*
* THIS SOFTWARE IS BEING PROVIDED ""AS IS"", WITHOUT ANY EXPRESS OR IMPLIED
* WARRANTY. IN PARTICULAR, NEITHER THE AUTHOR NOR LUCENT MAKES ANY
* REPRESENTATION OR WARRANTY OF ANY KIND CONCERNING THE MERCHANTABILITY
* OF THIS SOFTWARE OR ITS FITNESS FOR ANY PARTICULAR PURPOSE.
*
***************************************************************/",False,"```
* Copyright (c) 1991, 2000, 2001 by Lucent Technologies.
*
* Permission to use, copy, modify, and distribute this software for any
* purpose without fee is hereby granted, provided that this entire notice
* is included in all copies of any software which is or includes a copy
* or modification of this software and in all copies of the supporting
* documentation for such software.
*
* THIS SOFTWARE IS BEING PROVIDED ""AS IS"", WITHOUT ANY EXPRESS OR IMPLIED
* WARRANTY. IN PARTICULAR, NEITHER THE AUTHOR NOR LUCENT MAKES ANY
* REPRESENTATION OR WARRANTY OF ANY KIND CONCERNING THE MERCHANTABILITY
* OF THIS SOFTWARE OR ITS FITNESS FOR ANY PARTICULAR PURPOSE.
```"
93,95,NomosTestfiles/ATT/ATT.txt,ATT,"Copyright (c) 1991 by AT&T.

Permission to use, copy, modify, and distribute this software for any
purpose without fee is hereby granted, provided that this entire notice
is included in all copies of any software which is or includes a copy
or modification of this software and in all copies of the supporting
documentation for such software.

THIS SOFTWARE IS BEING PROVIDED ""AS IS"", WITHOUT ANY EXPRESS OR IMPLIED
WARRANTY. IN PARTICULAR, NEITHER THE AUTHOR NOR AT&T MAKES ANY
REPRESENTATION OR WARRANTY OF ANY KIND CONCERNING THE MERCHANTABILITY
OF THIS SOFTWARE OR ITS FITNESS FOR ANY PARTICULAR PURPOSE.",False,"```
Copyright (c) 1991 by AT&T.

Permission to use, copy, modify, and distribute this software for any
purpose without fee is hereby granted, provided that this entire notice
is included in all copies of any software which is or includes a copy
or modification of this software and in all copies of the supporting
documentation for such software.

THIS SOFTWARE IS BEING PROVIDED ""AS IS"", WITHOUT ANY EXPRESS OR IMPLIED
WARRANTY. IN PARTICULAR, NEITHER THE AUTHOR NOR AT&T MAKES ANY
REPRESENTATION OR WARRANTY OF ANY KIND CONCERNING THE MERCHANTABILITY
OF THIS SOFTWARE OR ITS FITNESS FOR ANY PARTICULAR PURPOSE.
```"
94,96,NomosTestfiles/ATT/NOTICE.libutf,"ATT
LPL-1.02","/*
* The authors of this software are Rob Pike and Ken Thompson.
* Copyright (c) 2002 by Lucent Technologies.
* Permission to use, copy, modify, and distribute this software for any
* purpose without fee is hereby granted, provided that this entire notice
* is included in all copies of any software which is or includes a copy
* or modification of this software and in all copies of the supporting
* documentation for such software.
* THIS SOFTWARE IS BEING PROVIDED ""AS IS"", WITHOUT ANY EXPRESS OR IMPLIED
* WARRANTY. IN PARTICULAR, NEITHER THE AUTHORS NOR LUCENT TECHNOLOGIES MAKE ANY
* REPRESENTATION OR WARRANTY OF ANY KIND CONCERNING THE MERCHANTABILITY
* OF THIS SOFTWARE OR ITS FITNESS FOR ANY PARTICULAR PURPOSE.
*/

This is a Unix port of the Plan 9 formatted I/O package.

Please send comments about the packaging
to Russ Cox <rsc@swtch.com>.


----

This software is also made available under the Lucent Public License
version 1.02; see http://plan9.bell-labs.com/plan9dist/license.html
",False,"```
* Copyright (c) 2002 by Lucent Technologies.
* Permission to use, copy, modify, and distribute this software for any
* purpose without fee is hereby granted, provided that this entire notice
* is included in all copies of any software which is or includes a copy
* or modification of this software and in all copies of the supporting
* documentation for such software.
* THIS SOFTWARE IS BEING PROVIDED ""AS IS"", WITHOUT ANY EXPRESS OR IMPLIED
* WARRANTY. IN PARTICULAR, NEITHER THE AUTHORS NOR LUCENT TECHNOLOGIES MAKE ANY
* REPRESENTATION OR WARRANTY OF ANY KIND CONCERNING THE MERCHANTABILITY
* OF THIS SOFTWARE OR ITS FITNESS FOR ANY PARTICULAR PURPOSE.
```"
95,97,NomosTestfiles/Authorship-inference/setup,No_license_found,"#!/usr/bin/perl -w
# -*- Mode: Perl -*-
# setup.pl ---
# Author : Manoj Srivastava ( srivasta@tiamat.datasync.com )
# Created On : Wed Mar 4 15:11:47 1998
# Created On Node : tiamat.datasync.com
# Last Modified By : Manoj Srivastava
# Last Modified On : Tue May 19 11:25:32 1998
# Last Machine Used: tiamat.datasync.com
# Update Count : 87
# Status : Unknown, Use with caution!
# HISTORY :
# Description :
# This file is designed to go into /usr/lib/apt/methods/setup
#

#use strict;
#use diagnostics;
#printf STDERR ""DEBUG: Arguments $ARGV[0];$ARGV[1];$ARGV[2];\n"";


# Handle the arguments
my $vardir=$ARGV[0];
my $method=$ARGV[1];
my $option=$ARGV[2];
my $config_file = '/etc/apt/sources.list';

my $boldon=`setterm -bold on`;
my $boldoff=`setterm -bold off`;

my @known_types = ('deb');
my @known_access = ('http', 'ftp', 'file');
my @typical_distributions = ('stable', 'unstable', 'testing', 'non-US');
my @typical_components = ('main', 'contrib', 'non-free');

my %known_access = map {($_,$_)} @known_access;
my %typical_distributions = map {($_,$_)} @typical_distributions;

# Read the config file, creating source records
sub read_config {
my %params = @_;
my @Config = ();

die ""Required parameter Filename Missing"" unless
$params{'Filename'};

open (CONFIG, ""$params{'Filename'}"") ||
die ""Could not open $params{'Filename'}: $!"";
while (<CONFIG>) {
chomp;
my $rec = {};
my ($type, $urn, $distribution, $components) =
m/^\s*(\S+)\s+(\S+)\s+(\S+)\s*(?:\s+(\S.*))?$/o;
$rec->{'Type'} = $type;
$rec->{'URN'} = $urn;
$rec->{'Distribution'} = $distribution;
$rec->{'Components'} = $components;
push @Config, $rec;
}
close(CONFIG);

return @Config;
}

# write the config file; writing out the current set of source records
sub write_config {
my %params = @_;
my $rec;
my %Seen = ();

die ""Required parameter Filename Missing"" unless
$params{'Filename'};
die ""Required parameter Config Missing"" unless
$params{'Config'};

open (CONFIG, "">$params{'Filename'}"") ||
die ""Could not open $params{'Filename'} for writing: $!"";
for $rec (@{$params{'Config'}}) {
my $line = ""$rec->{'Type'} $rec->{'URN'} $rec->{'Distribution'} "";
$line .= ""$rec->{'Components'}"" if $rec->{'Components'};
$line .= ""\n"";
print CONFIG $line unless $Seen{$line}++;
}
close(CONFIG);
}

# write the config file; writing out the current set of source records
sub print_config {
my %params = @_;
my $rec;
my %Seen = ();

die ""Required parameter Config Missing"" unless
$params{'Config'};

for $rec (@{$params{'Config'}}) {
next unless $rec;

my $line = ""$rec->{'Type'} "" if $rec->{'Type'};
$line .= ""$rec->{'URN'} "" if $rec->{'URN'};
$line .= ""$rec->{'Distribution'} "" if $rec->{'Distribution'};
$line .= ""$rec->{'Components'}"" if $rec->{'Components'};
$line .= ""\n"";
print $line unless $Seen{$line}++;
}
}

# Ask for and add a source record
sub get_source {
my %params = @_;
my $rec = {};
my $answer;
my ($type, $urn, $distribution, $components);

if ($params{'Default'}) {
($type, $urn, $distribution, $components) =
$params{'Default'} =~ m/^\s*(\S+)\s+(\S+)\s+(\S+)\s+(\S.*)$/o;
}

$type = 'deb';
$urn = ""http://http.us.debian.org/debian"" unless $urn;
$distribution = ""stable"" unless $distribution;
$components = ""main contrib non-free"" unless $components;


$rec->{'Type'} = 'deb';
$| = 1;

my $done = 0;

while (!$done) {
print ""\n"";
print ""$boldon URL [$urn]: $boldoff"";

$answer=<STDIN>;
chomp ($answer);
$answer =~ s/\s*//og;

if ($answer =~ /^\s*$/o) {
$rec->{'URN'} = $urn;
last;
}
else {
my ($scheme) = $answer =~ /^\s*([^:]+):/o;
if (! defined $known_access{$scheme}) {
  print ""Unknown access scheme $scheme in $answer\n"";
  print "" The available access methods known to me are\n"";
  print join (' ', @known_access), ""\n"";
  print ""\n"";
}
else {
  $rec->{'URN'} = $answer;
  last;
}
}
}

print ""\n"";

print "" Please give the distribution tag to get or a path to the\n"";
print "" package file ending in a /. The distribution\n"";
print "" tags are typically something like:$boldon "";
print join(' ', @typical_distributions), ""$boldoff\n"";
print ""\n"";
print ""$boldon Distribution [$distribution]:$boldoff "";
$answer=<STDIN>;
chomp ($answer);
$answer =~ s/\s*//og;

if ($answer =~ /^\s*$/o) {
$rec->{'Distribution'} = $distribution;
$rec->{'Components'} = &get_components($components);
}
elsif ($answer =~ m|/$|o) {
$rec->{'Distribution'} = ""$answer"";
$rec->{'Components'} = """";
}
else {
# A distribution tag, eh?
warn ""$answer does not seem to be a typical distribution tag\n""
unless defined $typical_distributions{$answer};

$rec->{'Distribution'} = ""$answer"";
$rec->{'Components'} = &get_components($components);
}

return $rec;
}

sub get_components {
my $default = shift;
my $answer;

print ""\n"";
print "" Please give the components to get\n"";
print "" The components are typically something like:$boldon "";
print join(' ', @typical_components), ""$boldoff\n"";
print ""\n"";
print ""$boldon Components [$default]:$boldoff "";
$answer=<STDIN>;
chomp ($answer);
$answer =~ s/\s+/ /og;

if ($answer =~ /^\s*$/o) {
return $default;
}
else {
return $answer;
}
}

sub get_sources {
my @Config = ();
my $done = 0;

my @Oldconfig = ();

if (-e $config_file) {
@Oldconfig = &read_config('Filename' => $config_file)
}

print ""\t$boldon Set up a list of distribution source locations $boldoff \n"";
print ""\n"";

print "" Please give the base URL of the debian distribution.\n"";
print "" The access schemes I know about are:$boldon "";
print join (' ', @known_access), ""$boldoff\n"";
# print "" The mirror scheme is special that it does not specify the\n"";
# print "" location of a debian archive but specifies the location\n"";
# print "" of a list of mirrors to use to access the archive.\n"";
print ""\n"";
print "" For example:\n"";
print "" file:/mnt/debian,\n"";
print "" ftp://ftp.debian.org/debian,\n"";
print "" http://ftp.de.debian.org/debian,\n"";
# print "" and the special mirror scheme,\n"";
# print "" mirror:http://www.debian.org/archivemirrors \n"";
print ""\n"";

my $index = 0;
while (!$done) {
if ($Oldconfig[$index]) {
push (@Config, &get_source('Default' => $Oldconfig[$index++]));
}
else {
push (@Config, &get_source());
}
print ""\n"";
print ""$boldon Would you like to add another source?[y/N]$boldoff "";
my $answer = <STDIN>;
chomp ($answer);
$answer =~ s/\s+/ /og;
if ($answer =~ /^\s*$/o) {
last;
}
elsif ($answer !~ m/\s*y/io) {
last;
}
}

return @Config;
}

sub main {
if (-e $config_file) {
my @Oldconfig = &read_config('Filename' => $config_file);

print ""$boldon I see you already have a source list.$boldoff\n"";
print ""-"" x 72, ""\n"";
&print_config('Config' => \@Oldconfig);
print ""-"" x 72, ""\n"";
print ""$boldon Do you wish to overwrite it? [y/N]$boldoff "";
my $answer = <STDIN>;
chomp ($answer);
$answer =~ s/\s+/ /og;
exit 0 unless $answer =~ m/\s*y/io;
}
# OK. They want to be here.
my @Config = &get_sources();
#&print_config('Config' => \@Config);
&write_config('Config' => \@Config, 'Filename' => $config_file);
}

&main();

",False,"```
# -*- Mode: Perl -*-
# setup.pl ---
# Author : Manoj Srivastava ( srivasta@tiamat.datasync.com )
# Created On : Wed Mar 4 15:11:47 1998
# Created On Node : tiamat.datasync.com
# Last Modified By : Manoj Srivastava
# Last Modified On : Tue May 19 11:25:32 1998
# Last Machine Used: tiamat.datasync.com
# Update Count : 87
# Status : Unknown, Use with caution!
# HISTORY :
# Description :
# This file is designed to go into /usr/lib/apt/methods/setup
#

```"
96,98,NomosTestfiles/Beerware/hash_md5prime.c,"Beerware
RSA-MD","/* This file is not used by busybox right now.
 * However, the code here seems to be a tiny bit smaller
 * than one in md5.c. Need to investigate which one
 * is better overall...
 * Hint: grep for md5prime to find places where you can switch
 * md5.c/md5prime.c
 */

/*
 * MD5C.C - RSA Data Security, Inc., MD5 message-digest algorithm
 *
 * Copyright (C) 1991-2, RSA Data Security, Inc. Created 1991. All
 * rights reserved.
 *
 * License to copy and use this software is granted provided that it
 * is identified as the ""RSA Data Security, Inc. MD5 Message-Digest
 * Algorithm"" in all material mentioning or referencing this software
 * or this function.
 *
 * License is also granted to make and use derivative works provided
 * that such works are identified as ""derived from the RSA Data
 * Security, Inc. MD5 Message-Digest Algorithm"" in all material
 * mentioning or referencing the derived work.
 *
 * RSA Data Security, Inc. makes no representations concerning either
 * the merchantability of this software or the suitability of this
 * software for any particular purpose. It is provided ""as is""
 * without express or implied warranty of any kind.
 *
 * These notices must be retained in any copies of any part of this
 * documentation and/or software.
 *
 * $FreeBSD: src/lib/libmd/md5c.c,v 1.9.2.1 1999/08/29 14:57:12 peter Exp $
 *
 * This code is the same as the code published by RSA Inc.  It has been
 * edited for clarity and style only.
 *
 * ----------------------------------------------------------------------------
 * The md5_crypt() function was taken from freeBSD's libcrypt and contains
 * this license:
 *    ""THE BEER-WARE LICENSE"" (Revision 42):
 *     <phk@login.dknet.dk> wrote this file.  As long as you retain this notice you
 *     can do whatever you want with this stuff. If we meet some day, and you think
 *     this stuff is worth it, you can buy me a beer in return.   Poul-Henning Kamp
 *
 * $FreeBSD: src/lib/libcrypt/crypt.c,v 1.7.2.1 1999/08/29 14:56:33 peter Exp $
 *
 * ----------------------------------------------------------------------------
 * On April 19th, 2001 md5_crypt() was modified to make it reentrant
 * by Erik Andersen <andersen@uclibc.org>
 *
 * June 28, 2001             Manuel Novoa III
 *
 * ""Un-inlined"" code using loops and static const tables in order to
 * reduce generated code size (on i386 from approx 4k to approx 2.5k).
 *
 * June 29, 2001             Manuel Novoa III
 *
 * Completely removed static PADDING array.
 *
 * Reintroduced the loop unrolling in md5_transform and added the
 * MD5_SMALL option for configurability.  Define below as:
 *       0    fully unrolled loops
 *       1    partially unrolled (4 ops per loop)
 *       2    no unrolling -- introduces the need to swap 4 variables (slow)
 *       3    no unrolling and all 4 loops merged into one with switch
 *               in each loop (glacial)
 * On i386, sizes are roughly (-Os -fno-builtin):
 *     0: 3k     1: 2.5k     2: 2.2k     3: 2k
 *
 * Since SuSv3 does not require crypt_r, modified again August 7, 2002
 * by Erik Andersen to remove reentrance stuff...
 */

#include ""libbb.h""

/* 1: fastest, 3: smallest */
#if CONFIG_MD5_SMALL < 1
# define MD5_SMALL 1
#elif CONFIG_MD5_SMALL > 3
# define MD5_SMALL 3
#else
# define MD5_SMALL CONFIG_MD5_SMALL
#endif

#if BB_LITTLE_ENDIAN
#define memcpy32_cpu2le memcpy
#define memcpy32_le2cpu memcpy
#else
/* Encodes input (uint32_t) into output (unsigned char).
 * Assumes len is a multiple of 4. */
static void
memcpy32_cpu2le(unsigned char *output, uint32_t *input, unsigned len)
{
	unsigned i, j;
	for (i = 0, j = 0; j < len; i++, j += 4) {
		output[j] = input[i];
		output[j+1] = (input[i] >> 8);
		output[j+2] = (input[i] >> 16);
		output[j+3] = (input[i] >> 24);
	}
}
/* Decodes input (unsigned char) into output (uint32_t).
 * Assumes len is a multiple of 4. */
static void
memcpy32_le2cpu(uint32_t *output, const unsigned char *input, unsigned len)
{
	unsigned i, j;
	for (i = 0, j = 0; j < len; i++, j += 4)
		output[i] = ((uint32_t)input[j])
			| (((uint32_t)input[j+1]) << 8)
			| (((uint32_t)input[j+2]) << 16)
			| (((uint32_t)input[j+3]) << 24);
}
#endif /* i386 */

/* F, G, H and I are basic MD5 functions. */
#define F(x, y, z) (((x) & (y)) | (~(x) & (z)))
#define G(x, y, z) (((x) & (z)) | ((y) & ~(z)))
#define H(x, y, z) ((x) ^ (y) ^ (z))
#define I(x, y, z) ((y) ^ ((x) | ~(z)))

/* rotl32 rotates x left n bits. */
#define rotl32(x, n) (((x) << (n)) | ((x) >> (32 - (n))))

/*
 * FF, GG, HH, and II transformations for rounds 1, 2, 3, and 4.
 * Rotation is separate from addition to prevent recomputation.
 */
#define FF(a, b, c, d, x, s, ac) { \
	(a) += F((b), (c), (d)) + (x) + (uint32_t)(ac); \
	(a) = rotl32((a), (s)); \
	(a) += (b); \
	}
#define GG(a, b, c, d, x, s, ac) { \
	(a) += G((b), (c), (d)) + (x) + (uint32_t)(ac); \
	(a) = rotl32((a), (s)); \
	(a) += (b); \
	}
#define HH(a, b, c, d, x, s, ac) { \
	(a) += H((b), (c), (d)) + (x) + (uint32_t)(ac); \
	(a) = rotl32((a), (s)); \
	(a) += (b); \
	}
#define II(a, b, c, d, x, s, ac) { \
	(a) += I((b), (c), (d)) + (x) + (uint32_t)(ac); \
	(a) = rotl32((a), (s)); \
	(a) += (b); \
	}

/* MD5 basic transformation. Transforms state based on block. */
static void md5_transform(uint32_t state[4], const unsigned char block[64])
{
	uint32_t a, b, c, d, x[16];
#if MD5_SMALL > 1
	uint32_t temp;
	const unsigned char *ps;

	static const unsigned char S[] = {
		7, 12, 17, 22,
		5, 9, 14, 20,
		4, 11, 16, 23,
		6, 10, 15, 21
	};
#endif /* MD5_SMALL > 1 */

#if MD5_SMALL > 0
	const uint32_t *pc;
	const unsigned char *pp;
	int i;

	static const uint32_t C[] = {
		/* round 1 */
		0xd76aa478, 0xe8c7b756, 0x242070db, 0xc1bdceee,
		0xf57c0faf, 0x4787c62a, 0xa8304613, 0xfd469501,
		0x698098d8, 0x8b44f7af, 0xffff5bb1, 0x895cd7be,
		0x6b901122, 0xfd987193, 0xa679438e, 0x49b40821,
		/* round 2 */
		0xf61e2562, 0xc040b340, 0x265e5a51, 0xe9b6c7aa,
		0xd62f105d, 0x2441453,  0xd8a1e681, 0xe7d3fbc8,
		0x21e1cde6, 0xc33707d6, 0xf4d50d87, 0x455a14ed,
		0xa9e3e905, 0xfcefa3f8, 0x676f02d9, 0x8d2a4c8a,
		/* round 3 */
		0xfffa3942, 0x8771f681, 0x6d9d6122, 0xfde5380c,
		0xa4beea44, 0x4bdecfa9, 0xf6bb4b60, 0xbebfbc70,
		0x289b7ec6, 0xeaa127fa, 0xd4ef3085, 0x4881d05,
		0xd9d4d039, 0xe6db99e5, 0x1fa27cf8, 0xc4ac5665,
		/* round 4 */
		0xf4292244, 0x432aff97, 0xab9423a7, 0xfc93a039,
		0x655b59c3, 0x8f0ccc92, 0xffeff47d, 0x85845dd1,
		0x6fa87e4f, 0xfe2ce6e0, 0xa3014314, 0x4e0811a1,
		0xf7537e82, 0xbd3af235, 0x2ad7d2bb, 0xeb86d391
	};
	static const unsigned char P[] = {
		0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, /* 1 */
		1, 6, 11, 0, 5, 10, 15, 4, 9, 14, 3, 8, 13, 2, 7, 12, /* 2 */
		5, 8, 11, 14, 1, 4, 7, 10, 13, 0, 3, 6, 9, 12, 15, 2, /* 3 */
		0, 7, 14, 5, 12, 3, 10, 1, 8, 15, 6, 13, 4, 11, 2, 9  /* 4 */
	};

#endif /* MD5_SMALL > 0 */

	memcpy32_le2cpu(x, block, 64);

	a = state[0];
	b = state[1];
	c = state[2];
	d = state[3];

#if MD5_SMALL > 2
	pc = C;
	pp = P;
	ps = S - 4;
	for (i = 0; i < 64; i++) {
		if ((i & 0x0f) == 0) ps += 4;
		temp = a;
		switch (i>>4) {
			case 0:
				temp += F(b, c, d);
				break;
			case 1:
				temp += G(b, c, d);
				break;
			case 2:
				temp += H(b, c, d);
				break;
			case 3:
				temp += I(b, c, d);
				break;
		}
		temp += x[*pp++] + *pc++;
		temp = rotl32(temp, ps[i & 3]);
		temp += b;
		a = d; d = c; c = b; b = temp;
	}
#elif MD5_SMALL > 1
	pc = C;
	pp = P;
	ps = S;
	/* Round 1 */
	for (i = 0; i < 16; i++) {
		FF(a, b, c, d, x[*pp], ps[i & 0x3], *pc); pp++; pc++;
		temp = d; d = c; c = b; b = a; a = temp;
	}
	/* Round 2 */
	ps += 4;
	for (; i < 32; i++) {
		GG(a, b, c, d, x[*pp], ps[i & 0x3], *pc); pp++; pc++;
		temp = d; d = c; c = b; b = a; a = temp;
	}
	/* Round 3 */
	ps += 4;
	for (; i < 48; i++) {
		HH(a, b, c, d, x[*pp], ps[i & 0x3], *pc); pp++; pc++;
		temp = d; d = c; c = b; b = a; a = temp;
	}
	/* Round 4 */
	ps += 4;
	for (; i < 64; i++) {
		II(a, b, c, d, x[*pp], ps[i & 0x3], *pc); pp++; pc++;
		temp = d; d = c; c = b; b = a; a = temp;
	}
#elif MD5_SMALL > 0
	pc = C;
	pp = P;
	/* Round 1 */
	for (i = 0; i < 4; i++) {
		FF(a, b, c, d, x[*pp],  7, *pc); pp++; pc++;
		FF(d, a, b, c, x[*pp], 12, *pc); pp++; pc++;
		FF(c, d, a, b, x[*pp], 17, *pc); pp++; pc++;
		FF(b, c, d, a, x[*pp], 22, *pc); pp++; pc++;
	}
	/* Round 2 */
	for (i = 0; i < 4; i++) {
		GG(a, b, c, d, x[*pp],  5, *pc); pp++; pc++;
		GG(d, a, b, c, x[*pp],  9, *pc); pp++; pc++;
		GG(c, d, a, b, x[*pp], 14, *pc); pp++; pc++;
		GG(b, c, d, a, x[*pp], 20, *pc); pp++; pc++;
	}
	/* Round 3 */
	for (i = 0; i < 4; i++) {
		HH(a, b, c, d, x[*pp],  4, *pc); pp++; pc++;
		HH(d, a, b, c, x[*pp], 11, *pc); pp++; pc++;
		HH(c, d, a, b, x[*pp], 16, *pc); pp++; pc++;
		HH(b, c, d, a, x[*pp], 23, *pc); pp++; pc++;
	}
	/* Round 4 */
	for (i = 0; i < 4; i++) {
		II(a, b, c, d, x[*pp],  6, *pc); pp++; pc++;
		II(d, a, b, c, x[*pp], 10, *pc); pp++; pc++;
		II(c, d, a, b, x[*pp], 15, *pc); pp++; pc++;
		II(b, c, d, a, x[*pp], 21, *pc); pp++; pc++;
	}
#else
	/* Round 1 */
#define S11 7
#define S12 12
#define S13 17
#define S14 22
	FF(a, b, c, d, x[ 0], S11, 0xd76aa478); /* 1 */
	FF(d, a, b, c, x[ 1], S12, 0xe8c7b756); /* 2 */
	FF(c, d, a, b, x[ 2], S13, 0x242070db); /* 3 */
	FF(b, c, d, a, x[ 3], S14, 0xc1bdceee); /* 4 */
	FF(a, b, c, d, x[ 4], S11, 0xf57c0faf); /* 5 */
	FF(d, a, b, c, x[ 5], S12, 0x4787c62a); /* 6 */
	FF(c, d, a, b, x[ 6], S13, 0xa8304613); /* 7 */
	FF(b, c, d, a, x[ 7], S14, 0xfd469501); /* 8 */
	FF(a, b, c, d, x[ 8], S11, 0x698098d8); /* 9 */
	FF(d, a, b, c, x[ 9], S12, 0x8b44f7af); /* 10 */
	FF(c, d, a, b, x[10], S13, 0xffff5bb1); /* 11 */
	FF(b, c, d, a, x[11], S14, 0x895cd7be); /* 12 */
	FF(a, b, c, d, x[12], S11, 0x6b901122); /* 13 */
	FF(d, a, b, c, x[13], S12, 0xfd987193); /* 14 */
	FF(c, d, a, b, x[14], S13, 0xa679438e); /* 15 */
	FF(b, c, d, a, x[15], S14, 0x49b40821); /* 16 */
	/* Round 2 */
#define S21 5
#define S22 9
#define S23 14
#define S24 20
	GG(a, b, c, d, x[ 1], S21, 0xf61e2562); /* 17 */
	GG(d, a, b, c, x[ 6], S22, 0xc040b340); /* 18 */
	GG(c, d, a, b, x[11], S23, 0x265e5a51); /* 19 */
	GG(b, c, d, a, x[ 0], S24, 0xe9b6c7aa); /* 20 */
	GG(a, b, c, d, x[ 5], S21, 0xd62f105d); /* 21 */
	GG(d, a, b, c, x[10], S22,  0x2441453); /* 22 */
	GG(c, d, a, b, x[15], S23, 0xd8a1e681); /* 23 */
	GG(b, c, d, a, x[ 4], S24, 0xe7d3fbc8); /* 24 */
	GG(a, b, c, d, x[ 9], S21, 0x21e1cde6); /* 25 */
	GG(d, a, b, c, x[14], S22, 0xc33707d6); /* 26 */
	GG(c, d, a, b, x[ 3], S23, 0xf4d50d87); /* 27 */
	GG(b, c, d, a, x[ 8], S24, 0x455a14ed); /* 28 */
	GG(a, b, c, d, x[13], S21, 0xa9e3e905); /* 29 */
	GG(d, a, b, c, x[ 2], S22, 0xfcefa3f8); /* 30 */
	GG(c, d, a, b, x[ 7], S23, 0x676f02d9); /* 31 */
	GG(b, c, d, a, x[12], S24, 0x8d2a4c8a); /* 32 */
	/* Round 3 */
#define S31 4
#define S32 11
#define S33 16
#define S34 23
	HH(a, b, c, d, x[ 5], S31, 0xfffa3942); /* 33 */
	HH(d, a, b, c, x[ 8], S32, 0x8771f681); /* 34 */
	HH(c, d, a, b, x[11], S33, 0x6d9d6122); /* 35 */
	HH(b, c, d, a, x[14], S34, 0xfde5380c); /* 36 */
	HH(a, b, c, d, x[ 1], S31, 0xa4beea44); /* 37 */
	HH(d, a, b, c, x[ 4], S32, 0x4bdecfa9); /* 38 */
	HH(c, d, a, b, x[ 7], S33, 0xf6bb4b60); /* 39 */
	HH(b, c, d, a, x[10], S34, 0xbebfbc70); /* 40 */
	HH(a, b, c, d, x[13], S31, 0x289b7ec6); /* 41 */
	HH(d, a, b, c, x[ 0], S32, 0xeaa127fa); /* 42 */
	HH(c, d, a, b, x[ 3], S33, 0xd4ef3085); /* 43 */
	HH(b, c, d, a, x[ 6], S34,  0x4881d05); /* 44 */
	HH(a, b, c, d, x[ 9], S31, 0xd9d4d039); /* 45 */
	HH(d, a, b, c, x[12], S32, 0xe6db99e5); /* 46 */
	HH(c, d, a, b, x[15], S33, 0x1fa27cf8); /* 47 */
	HH(b, c, d, a, x[ 2], S34, 0xc4ac5665); /* 48 */
	/* Round 4 */
#define S41 6
#define S42 10
#define S43 15
#define S44 21
	II(a, b, c, d, x[ 0], S41, 0xf4292244); /* 49 */
	II(d, a, b, c, x[ 7], S42, 0x432aff97); /* 50 */
	II(c, d, a, b, x[14], S43, 0xab9423a7); /* 51 */
	II(b, c, d, a, x[ 5], S44, 0xfc93a039); /* 52 */
	II(a, b, c, d, x[12], S41, 0x655b59c3); /* 53 */
	II(d, a, b, c, x[ 3], S42, 0x8f0ccc92); /* 54 */
	II(c, d, a, b, x[10], S43, 0xffeff47d); /* 55 */
	II(b, c, d, a, x[ 1], S44, 0x85845dd1); /* 56 */
	II(a, b, c, d, x[ 8], S41, 0x6fa87e4f); /* 57 */
	II(d, a, b, c, x[15], S42, 0xfe2ce6e0); /* 58 */
	II(c, d, a, b, x[ 6], S43, 0xa3014314); /* 59 */
	II(b, c, d, a, x[13], S44, 0x4e0811a1); /* 60 */
	II(a, b, c, d, x[ 4], S41, 0xf7537e82); /* 61 */
	II(d, a, b, c, x[11], S42, 0xbd3af235); /* 62 */
	II(c, d, a, b, x[ 2], S43, 0x2ad7d2bb); /* 63 */
	II(b, c, d, a, x[ 9], S44, 0xeb86d391); /* 64 */
#endif

	state[0] += a;
	state[1] += b;
	state[2] += c;
	state[3] += d;

	/* Zeroize sensitive information. */
	memset(x, 0, sizeof(x));
}


/* MD5 initialization. */
void FAST_FUNC md5_begin(md5_ctx_t *context)
{
	context->count[0] = context->count[1] = 0;
	/* Load magic initialization constants.  */
	context->state[0] = 0x67452301;
	context->state[1] = 0xefcdab89;
	context->state[2] = 0x98badcfe;
	context->state[3] = 0x10325476;
}

/*
 * MD5 block update operation. Continues an MD5 message-digest
 * operation, processing another message block, and updating
 * the context.
 */
void FAST_FUNC md5_hash(const void *buffer, size_t inputLen, md5_ctx_t *context)
{
	unsigned i, idx, partLen;
	const unsigned char *input = buffer;

	/* Compute number of bytes mod 64 */
	idx = (context->count[0] >> 3) & 0x3F;

	/* Update number of bits */
	context->count[0] += (inputLen << 3);
	if (context->count[0] < (inputLen << 3))
		context->count[1]++;
	context->count[1] += (inputLen >> 29);

	/* Transform as many times as possible. */
	i = 0;
	partLen = 64 - idx;
	if (inputLen >= partLen) {
		memcpy(&context->buffer[idx], input, partLen);
		md5_transform(context->state, context->buffer);
		for (i = partLen; i + 63 < inputLen; i += 64)
			md5_transform(context->state, &input[i]);
		idx = 0;
	}

	/* Buffer remaining input */
	memcpy(&context->buffer[idx], &input[i], inputLen - i);
}

/*
 * MD5 finalization. Ends an MD5 message-digest operation,
 * writing the message digest.
 */
void FAST_FUNC md5_end(void *digest, md5_ctx_t *context)
{
	unsigned idx, padLen;
	unsigned char bits[8];
	unsigned char padding[64];

	/* Add padding followed by original length. */
	memset(padding, 0, sizeof(padding));
	padding[0] = 0x80;
	/* save number of bits */
	memcpy32_cpu2le(bits, context->count, 8);
	/* pad out to 56 mod 64 */
	idx = (context->count[0] >> 3) & 0x3f;
	padLen = (idx < 56) ? (56 - idx) : (120 - idx);
	md5_hash(padding, padLen, context);
	/* append length (before padding) */
	md5_hash(bits, 8, context);

	/* Store state in digest */
	memcpy32_cpu2le(digest, context->state, 16);
}
",False,
97,99,NomosTestfiles/Bittorrent/bittorrent.nsi,BitTorrent-1.0,"# The contents of this file are subject to the BitTorrent Open Source License
# Version 1.0 (the License).  You may not copy or use this file, in either
# source code or executable form, except in compliance with the License.  You
# may obtain a copy of the License at http://www.bittorrent.com/license/.
#
# Software distributed under the License is distributed on an AS IS basis,
# WITHOUT WARRANTY OF ANY KIND, either express or implied.  See the License
# for the specific language governing rights and limitations under the
# License.

# Written by Bram Cohen and Matt Chisholm

!define VERSION ""4.0.1""
!define APPNAME ""BitTorrent""
Outfile ${APPNAME}-${VERSION}.exe
Name ""${APPNAME}""
SilentInstall silent
SetCompressor lzma
InstallDir ""$PROGRAMFILES\${APPNAME}\""

; This function ensures that you have administrator privileges
; it is copied from:
;http://nsis.sourceforge.net/archive/viewpage.php?pageid=275
Function IsUserAdmin
Push $R0
Push $R1
Push $R2

ClearErrors
UserInfo::GetName
IfErrors Win9x
Pop $R1
UserInfo::GetAccountType
Pop $R2

StrCmp $R2 ""Admin"" 0 Continue
StrCpy $R0 ""true""
Goto Done

Continue:
StrCmp $R2 """" Win9x
StrCpy $R0 ""false""
Goto Done

Win9x:
StrCpy $R0 ""true""

Done:

Pop $R2
Pop $R1
Exch $R0
FunctionEnd

Function QuitIt
  checkforit:
    Processes::FindProcess ""btdownloadgui.exe""
    StrCmp $R0 ""1"" foundit didntfindit

  waitforit:
    Sleep 2000
    Goto checkforit
 
  foundit:
    MessageBox MB_OKCANCEL ""You must quit ${APPNAME} before installing this \
    version.$\r$\nPlease quit it and press OK to continue."" IDOK waitforit
    Abort
  didntfindit:

  checkforit2:
    Processes::FindProcess ""btmaketorrentgui.exe""
    StrCmp $R0 ""1"" foundit2 didntfindit2

  waitforit2:
    Sleep 2000
    Goto checkforit2

  foundit2:
    MessageBox MB_OKCANCEL ""You must quit ${APPNAME} metafile creator before \
    installing this version.$\r$\nPlease quit it and press OK to continue."" \
    IDOK waitforit2
    Abort
  didntfindit2:

FunctionEnd

; This function is a copy of QuitIt because NSIS enforces weird namespace crap
Function un.QuitIt
  checkforit:
    Processes::FindProcess ""btdownloadgui.exe""
    StrCmp $R0 ""1"" foundit didntfindit

  waitforit:
    Sleep 2000
    Goto checkforit
 
  foundit:
    MessageBox MB_OKCANCEL ""You must quit ${APPNAME} before installing this \
    version.$\r$\nPlease quit it and press OK to continue."" IDOK waitforit
    Abort
  didntfindit:

  checkforit2:
    Processes::FindProcess ""btmaketorrentgui.exe""
    StrCmp $R0 ""1"" foundit2 didntfindit2

  waitforit2:
    Sleep 2000
    Goto checkforit2

  foundit2:
    MessageBox MB_OKCANCEL ""You must quit ${APPNAME} metafile creator before \
    installing this version.$\r$\nPlease quit it and press OK to continue."" \
    IDOK waitforit2
    Abort
  didntfindit2:

FunctionEnd


; This function automatically uninstalls older versions.
; It is partly copied from: 
; http://nsis.sourceforge.net/archive/viewpage.php?pageid=326
Function .onInit
  Call QuitIt
  ClearErrors

  ReadRegStr $R0 HKLM \
  ""Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAME}"" \
  ""UninstallString""
  StrCmp $R0 """" done

  MessageBox MB_OKCANCEL|MB_ICONEXCLAMATION \
  ""Another version of ${APPNAME} is already installed. $\n$\nClick `OK` to \
  remove the already installed version and continue installing this version. \ 
  $\n$\nClick `Cancel` to cancel this installation."" \
  IDOK uninst
  Abort
  
;Run the uninstaller
uninst:
  ExecWait '$R0 _?=$INSTDIR /S' ;Do not copy the uninstaller to a temp file

  IfErrors no_remove_uninstaller

  Goto endofuninst
  no_remove_uninstaller: 
    MessageBox MB_OK ""Uninstallation failed. Aborting.""
    Abort
  endofuninst:
done:

FunctionEnd

Section ""Install""
  Call IsUserAdmin
  Pop $R0
  StrCmp $R0 ""false"" abortinstall continueinstall

  abortinstall:
  MessageBox MB_OK ""You must have Administrator privileges to install ${APPNAME}."" 
  Goto endofinstall

  continueinstall:

  SetOutPath $INSTDIR
  WriteUninstaller ""$INSTDIR\uninstall.exe""
  File dist\*.exe
  File dist\*.pyd
  File dist\*.dll
  File dist\library.zip
  File /r dist\images
  File /r dist\lib
  File /r dist\etc
  File /r dist\share
  File redirdonate.html
  File credits.txt
  File LICENSE.txt
  File README.txt

  ; registry entries
  WriteRegStr HKCR .torrent """" bittorrent
  DeleteRegKey HKCR "".torrent\Content Type""
  WriteRegStr HKCR ""MIME\Database\Content Type\application/x-bittorrent"" Extension .torrent
  WriteRegStr HKCR bittorrent """" ""TORRENT File""
  WriteRegBin HKCR bittorrent EditFlags 00000100
  WriteRegStr HKCR ""bittorrent\shell"" """" open
  WriteRegStr HKCR ""bittorrent\shell\open\command"" """" `""$INSTDIR\btdownloadgui.exe"" --responsefile ""%1""`
  WriteRegStr HKLM ""Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAME}"" ""DisplayName"" ""${APPNAME} ${VERSION}""
  WriteRegStr HKLM ""Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAME}"" ""UninstallString"" '""$INSTDIR\uninstall.exe""'

  ; Add items to start menu
  CreateDirectory ""$SMPROGRAMS\${APPNAME}""
  CreateShortCut ""$SMPROGRAMS\${APPNAME}\Downloader.lnk""   ""$INSTDIR\btdownloadgui.exe""
  CreateShortCut ""$SMPROGRAMS\${APPNAME}\Make Torrent.lnk"" ""$INSTDIR\btmaketorrentgui.exe""
  CreateShortCut ""$SMPROGRAMS\${APPNAME}\Donate.lnk""       ""$INSTDIR\redirdonate.html""

  ExecShell open ""$INSTDIR\redirdonate.html""
  Sleep 2000
  MessageBox MB_OK ""${APPNAME} has been successfully installed!$\r$\n$\r$\nTo use ${APPNAME}, visit a web site which uses it and click on a link.""
  BringToFront
  endofinstall:
SectionEnd

Section ""Uninstall""
  Call un.QuitIt
  DeleteRegKey HKCR .torrent
  DeleteRegKey HKCR ""MIME\Database\Content Type\application/x-bittorrent""
  DeleteRegKey HKCR bittorrent
  DeleteRegKey HKLM ""Software\Microsoft\Windows\CurrentVersion\Uninstall\${APPNAME}""
  RMDir /r ""$INSTDIR""
  RMDir /r ""$SMPROGRAMS\${APPNAME}""
SectionEnd
",False,"```
# The contents of this file are subject to the BitTorrent Open Source License
# Version 1.0 (the License).  You may not copy or use this file, in either
# source code or executable form, except in compliance with the License.  You
# may obtain a copy of the License at http://www.bittorrent.com/license/.
#
# Software distributed under the License is distributed on an AS IS basis,
# WITHOUT WARRANTY OF ANY KIND, either express or implied.  See the License
# for the specific language governing rights and limitations under the
# License.
```"
98,100,NomosTestfiles/Bittorrent/bittorrent.py,BitTorrent-1.1,"#!/usr/bin/env python

# The contents of this file are subject to the BitTorrent Open Source License
# Version 1.1 (the License).  You may not copy or use this file, in either
# source code or executable form, except in compliance with the License.  You
# may obtain a copy of the License at http://www.bittorrent.com/license/.
#
# Software distributed under the License is distributed on an AS IS basis,
# WITHOUT WARRANTY OF ANY KIND, either express or implied.  See the License
# for the specific language governing rights and limitations under the
# License.

# Written by Uoti Urpala and Matt Chisholm

from __future__ import division

from BitTorrent.platform import install_translation
install_translation()

import sys
import itertools
import math
import os
import threading
import datetime
import random
import atexit

assert sys.version_info >= (2, 3), _(""Install Python %s or greater"") % '2.3'

from BitTorrent import BTFailure, INFO, WARNING, ERROR, CRITICAL, status_dict, app_name

from BitTorrent import configfile

from BitTorrent.defaultargs import get_defaults
from BitTorrent.IPC import ipc_interface
from BitTorrent.prefs import Preferences
from BitTorrent.platform import doc_root, btspawn, path_wrap, os_version, is_frozen_exe, get_startup_dir, create_shortcut, remove_shortcut
from BitTorrent import zurllib

defaults = get_defaults('bittorrent')
defaults.extend((('donated' , '', ''), # the version that the user last donated for
                 ('notified', '', ''), # the version that the user was last notified of
                 ))


ui_options = [
    'max_upload_rate'       ,
    'minport'               ,
    'maxport'               ,
    'next_torrent_time'     ,
    'next_torrent_ratio'    ,
    'last_torrent_ratio'    ,
    'seed_forever'          ,
    'seed_last_forever'     ,
    'ask_for_save'          ,
    'save_in'               ,
    'open_from'             ,
    'ip'                    ,
    'start_torrent_behavior',
    'upnp'                  ,
    ]

if os.name == 'nt':
    ui_options.extend( [
        'launch_on_startup'     ,
        'minimize_to_tray'      ,
        ])

advanced_ui_options_index = len(ui_options)

ui_options.extend([
    'min_uploads'     ,
    'max_uploads'     ,
    'max_initiate'    ,
    'max_incomplete'  ,
    'max_allow_in'    ,
    'max_files_open'  ,
    'forwarded_port'  ,
    'display_interval',
    'donated'         ,
    'notified'        ,
    ])


if is_frozen_exe:
    ui_options.append('progressbar_hack')
    defproghack = 0
    if os_version == 'XP':
        # turn on progress bar hack by default for Win XP 
        defproghack = 1
    defaults.extend((('progressbar_hack' , defproghack, ''),)) 


NAG_FREQUENCY = 3
PORT_RANGE = 5

defconfig = dict([(name, value) for (name, value, doc) in defaults])
del name, value, doc

def btgui_exit(ipc):
    ipc.stop()

class global_logger(object):
    def __init__(self, logger = None):
        self.logger = logger
    def __call__(self, severity, msg):
        if self.logger:
            self.logger(severity, msg)
        else:
            sys.stderr.write(""%s: %s\n"" % (status_dict[severity], msg))        

# if it's application global, why do we pass a reference to it everywhere?
global_log_func = global_logger()

if __name__ == '__main__':
    zurllib.add_unsafe_thread()
    
    try:
        config, args = configfile.parse_configuration_and_args(defaults,
                                        'bittorrent', sys.argv[1:], 0, None)
    except BTFailure, e:
        print str(e)
        sys.exit(1)

    config = Preferences().initWithDict(config)
    advanced_ui = config['advanced']

    newtorrents = args
    for opt in ('responsefile', 'url'):
        if config[opt]:
            print '""--%s""' % opt, _(""deprecated, do not use"")
            newtorrents.append(config[opt])

    ipc = ipc_interface(config, global_log_func)

    # this could be on the ipc object
    ipc_master = True
    try:
        ipc.create()
    except BTFailure:
        ipc_master = False

        try:
            ipc.send_command('no-op')
        except BTFailure:
            global_log_func(ERROR, _(""Failed to communicate with another %s process ""
                                     ""but one seems to be running."") + 
                                   _("" Closing all %s windows may fix the problem."")
                                   % (app_name, app_name))
            sys.exit(1)

    # make sure we clean up the ipc when we close
    atexit.register(btgui_exit, ipc)

    # it's not obvious, but 'newtorrents' is carried on to the gui
    # __main__ if we're the IPC master
    
    if not ipc_master:
        
        if newtorrents:
            # Not sure if anything really useful could be done if
            # these send_command calls fail
            for name in newtorrents:
                ipc.send_command('start_torrent', name, config['save_as'])
            sys.exit(0)
            
        try:
            ipc.send_command('show_error', _(""%s already running"")%app_name)
        except BTFailure:
            global_log_func(ERROR, _(""Failed to communicate with another %s process."") +
                                   _("" Closing all %s windows may fix the problem."")
                                   % app_name)
        sys.exit(1)


import gtk
import pango
import gobject
import webbrowser

assert gtk.pygtk_version >= (2, 6), _(""PyGTK %s or newer required"") % '2.6'

from BitTorrent import HELP_URL, DONATE_URL, SEARCH_URL, version, branch

from BitTorrent import TorrentQueue
from BitTorrent import LaunchPath
from BitTorrent import Desktop
from BitTorrent import ClientIdentifier
from BitTorrent import NewVersion

from BitTorrent.parseargs import makeHelp
from BitTorrent.TorrentQueue import RUNNING, RUN_QUEUED, QUEUED, KNOWN, ASKING_LOCATION
from BitTorrent.TrayIcon import TrayIcon
from BitTorrent.StatusLight import GtkStatusLight as StatusLight
from BitTorrent.GUI import * 


main_torrent_dnd_tip = _(""drag to reorder"")
torrent_menu_tip = _(""right-click for menu"")
torrent_tip_format = '%s:\n %s\n %s'

rate_label = ': %s'

speed_classes = {
    (   4,    5):_(""dialup""           ),
    (   6,   14):_(""DSL/cable 128k up""),
    (  15,   29):_(""DSL/cable 256k up""),
    (  30,   91):_(""DSL 768k up""      ),
    (  92,  137):_(""T1""               ),
    ( 138,  182):_(""T1/E1""            ),
    ( 183,  249):_(""E1""               ),
    ( 250, 5446):_(""T3""               ),
    (5447,18871):_(""OC3""              ),
    }

def find_dir(path):
    if os.path.isdir(path):
        return path
    directory, garbage = os.path.split(path)
    while directory:
        if os.access(directory, os.F_OK) and os.access(directory, os.W_OK):
            return directory
        directory, garbage = os.path.split(directory)
        if garbage == '':
            break        
    return None

def smart_dir(path):
    path = find_dir(path)
    if path is None:
        path = Desktop.desktop
    return path

class MenuItem(gtk.MenuItem): 
    def __init__(self, label, accel_group=None, func=None):
        gtk.MenuItem.__init__(self, label)
        if func is not None:
            self.connect(""activate"", func)
        else:
            self.set_sensitive(False)

        if accel_group is not None:
            label = label.decode('utf-8')
            accel_index = label.find('_')
            if -1 < accel_index < len(label) - 1:
                accel_char = long(ord(label[accel_index+1]))
                accel_key  = gtk.gdk.unicode_to_keyval(accel_char)
                if accel_key != accel_char | 0x01000000:
                    self.add_accelerator(""activate"", accel_group, accel_key,
                                         gtk.gdk.CONTROL_MASK, gtk.ACCEL_VISIBLE)
        self.show()


def build_menu(menu_items, accel_group=None):
    menu = gtk.Menu()
    for label,func in menu_items:
        if label == '----':
            s = gtk.SeparatorMenuItem()
            s.show()
            menu.add(s)
        else:
            item = MenuItem(label, accel_group=accel_group, func=func)
            item.show()
            menu.add(item)
    return menu


class Validator(gtk.Entry):
    valid_chars = '1234567890'
    minimum = None
    maximum = None
    cast = int
    
    def __init__(self, option_name, config, setfunc):
        gtk.Entry.__init__(self)
        self.option_name = option_name
        self.config      = config
        self.setfunc     = setfunc

        self.set_text(str(config[option_name]))
            
        self.set_size_request(self.width,-1)
        
        self.connect('insert-text', self.text_inserted)
        self.connect('focus-out-event', self.focus_out)

    def get_value(self):
        value = None
        try:
            value = self.cast(self.get_text())
        except ValueError:
            pass
        return value

    def set_value(self, value):
        self.set_text(str(value))
        self.setfunc(self.option_name, value)        
        
    def focus_out(self, entry, widget):
        value = self.get_value()

        if value is None:
            return

        if (self.minimum is not None) and (value < self.minimum):
            value = self.minimum
        if (self.maximum is not None) and (value > self.maximum):
            value = self.maximum

        self.set_value(value)

    def text_inserted(self, entry, input, position, user_data):
        for i in input:
            if (self.valid_chars is not None) and (i not in self.valid_chars):
                self.emit_stop_by_name('insert-text')
                return True
        return False

class IPValidator(Validator):
    valid_chars = '1234567890.'
    width = 128
    cast = str

class PortValidator(Validator):
    width = 64
    minimum = 1024
    maximum = 65535

    def add_end(self, end_name):
        self.end_option_name = end_name

    def set_value(self, value):
        self.set_text(str(value))
        self.setfunc(self.option_name, value)
        self.setfunc(self.end_option_name, value+PORT_RANGE)


class PercentValidator(Validator):
    width = 48
    minimum = 0

class MinutesValidator(Validator):
    width = 48
    minimum = 1

class EnterUrlDialog(MessageDialog):
    flags = gtk.DIALOG_DESTROY_WITH_PARENT
    def __init__(self, parent):
        self.entry = gtk.Entry()
        self.entry.show()
        self.main = parent
        MessageDialog.__init__(self, parent.mainwindow,
                               _(""Enter torrent URL""),
                               _(""Enter the URL of a torrent file to open:""),
                               type=gtk.MESSAGE_QUESTION,
                               buttons=gtk.BUTTONS_OK_CANCEL,
                               yesfunc=lambda *args: parent.open_url(self.entry.get_text()),
                               default=gtk.RESPONSE_OK
                               )
        hbox = gtk.HBox()
        hbox.pack_start(self.entry, padding=SPACING)
        hbox.show()
        self.entry.set_activates_default(True)
        self.entry.set_flags(gtk.CAN_FOCUS)
        self.vbox.pack_start(hbox)
        self.entry.grab_focus()

    def close(self, *args):
        self.destroy()

    def destroy(self):
        MessageDialog.destroy(self)
        self.main.window_closed('enterurl')


class RateSliderBox(gtk.VBox):
    base = 10
    multiplier = 4
    max_exponent = 3.3

    def __init__(self, config, torrentqueue):
        gtk.VBox.__init__(self, homogeneous=False)
        self.config = config
        self.torrentqueue = torrentqueue

        if self.config['max_upload_rate'] < self.slider_to_rate(0):
            self.config['max_upload_rate'] = self.slider_to_rate(0)

        self.speed_classes = {
            (   4,    5):_(""dialup""           ),
            (   6,   14):_(""DSL/cable 128k up""),
            (  15,   29):_(""DSL/cable 256k up""),
            (  30,   91):_(""DSL 768k up""      ),
            (  92,  137):_(""T1""               ),
            ( 138,  182):_(""T1/E1""            ),
            ( 183,  249):_(""E1""               ),
            ( 250, 5446):_(""T3""               ),
            (5447,18871):_(""OC3""              ),
            }

        biggest_size = 0
        for v in self.speed_classes.values():
            width = gtk.Label(v).size_request()[0]
            if width > biggest_size:
                biggest_size = width

        self.rate_slider_label_box = gtk.HBox(spacing=SPACING,
                                              homogeneous=True)
        
        self.rate_slider_label = gtk.Label(_(""Maximum upload rate:""))
        self.rate_slider_label.set_ellipsize(pango.ELLIPSIZE_START)
        self.rate_slider_label.set_alignment(1, 0.5)
        self.rate_slider_label_box.pack_start(self.rate_slider_label,
                                              expand=True, fill=True)

        self.rate_slider_value = gtk.Label(
            self.value_to_label(self.config['max_upload_rate']))
        self.rate_slider_value.set_alignment(0, 0.5)
        self.rate_slider_value.set_size_request(biggest_size, -1)

        self.rate_slider_label_box.pack_start(self.rate_slider_value,
                                              expand=True, fill=True)

        self.rate_slider_adj = gtk.Adjustment(
            self.rate_to_slider(self.config['max_upload_rate']), 0,
            self.max_exponent, 0.01, 0.1)
        
        self.rate_slider = gtk.HScale(self.rate_slider_adj)
        self.rate_slider.set_draw_value(False)
        self.rate_slider_adj.connect('value_changed', self.set_max_upload_rate)

        self.pack_start(self.rate_slider       , expand=False, fill=False)
        self.pack_start(self.rate_slider_label_box , expand=False, fill=False)

        if False: # this shows the legend for the slider
            self.rate_slider_legend = gtk.HBox(homogeneous=True)
            for i in range(int(self.max_exponent+1)):
                label = gtk.Label(str(self.slider_to_rate(i)))
                alabel = halign(label, i/self.max_exponent)
                self.rate_slider_legend.pack_start(alabel,
                                                   expand=True, fill=True)
            self.pack_start(self.rate_slider_legend, expand=False, fill=False)


    def start(self):
        self.set_max_upload_rate(self.rate_slider_adj)

    def rate_to_slider(self, value):
        return math.log(value/self.multiplier, self.base)

    def slider_to_rate(self, value):
        return int(round(self.base**value * self.multiplier))

    def value_to_label(self, value):
        conn_type = ''
        for key, conn in self.speed_classes.items():
            min_v, max_v = key
            if min_v <= value <= max_v:
                conn_type = ' (%s)'%conn
                break
        label = str(Rate(value*1024)) + conn_type
        return label

    def set_max_upload_rate(self, adj):
        option = 'max_upload_rate'
        value = self.slider_to_rate(adj.get_value())
        self.config[option] = value
        self.torrentqueue.set_config(option, value)
        self.rate_slider_value.set_text(self.value_to_label(int(value)))


class StopStartButton(gtk.Button):
    stop_tip  = _(""Temporarily stop all running torrents"")
    start_tip = _(""Resume downloading"")

    def __init__(self, main):
        gtk.Button.__init__(self)
        self.main = main
        self.connect('clicked', self.toggle)

        self.stop_image = gtk.Image()
        self.stop_image.set_from_stock('bt-pause', gtk.ICON_SIZE_BUTTON)
        self.stop_image.show()

        self.start_image = gtk.Image()
        self.start_image.set_from_stock('bt-play', gtk.ICON_SIZE_BUTTON)
        self.start_image.show()

    def toggle(self, widget):
        self.set_paused(not self.main.config['pause'])

    def set_paused(self, paused):
        image = self.get_child()
        if paused:
            if image == self.stop_image:
                self.remove(self.stop_image)
            if image != self.start_image:
                self.add(self.start_image)
            self.main.tooltips.set_tip(self, self.start_tip)
            self.main.stop_queue()
        else:
            if image == self.start_image:
                self.remove(self.start_image)
            if image != self.stop_image:
                self.add(self.stop_image)
            self.main.tooltips.set_tip(self, self.stop_tip )
            self.main.restart_queue()


class VersionWindow(Window):
    def __init__(self, main, newversion, download_url):
        Window.__init__(self)
        self.set_title(_(""New %s version available"")%app_name)
        self.set_border_width(SPACING)
        self.set_resizable(False)
        self.main = main
        self.newversion = newversion
        self.download_url = download_url
        self.connect('destroy', lambda w: self.main.window_closed('version'))
        self.vbox = gtk.VBox(spacing=SPACING)
        self.hbox = gtk.HBox(spacing=SPACING)
        self.image = gtk.Image()
        self.image.set_from_stock(gtk.STOCK_DIALOG_INFO, gtk.ICON_SIZE_DIALOG)
        self.hbox.pack_start(self.image)
        
        self.label = gtk.Label()
        self.label.set_markup(
            (_(""A newer version of %s is available.\n"") % app_name) +
            (_(""You are using %s, and the new version is %s.\n"") % (version, newversion)) +
            (_(""You can always get the latest version from \n%s"") % self.download_url)
            ) 
        self.label.set_selectable(True)
        self.hbox.pack_start(self.label)
        self.vbox.pack_start(self.hbox)
        self.bbox = gtk.HBox(spacing=SPACING)

        self.closebutton = gtk.Button(_(""Download _later""))
        self.closebutton.connect('clicked', self.close)

        self.newversionbutton = gtk.Button(_(""Download _now""))
        self.newversionbutton.connect('clicked', self.get_newversion)

        self.bbox.pack_end(self.newversionbutton, expand=False, fill=False)
        self.bbox.pack_end(self.closebutton     , expand=False, fill=False)

        self.checkbox = gtk.CheckButton(_(""_Remind me later""))
        self.checkbox.set_active(True)
        self.checkbox.connect('toggled', self.remind_toggle)
        
        self.bbox.pack_start(self.checkbox, expand=False, fill=False)

        self.vbox.pack_start(self.bbox)
        
        self.add(self.vbox)
        self.show_all()

    def remind_toggle(self, widget):
        v = self.checkbox.get_active()
        notified = ''
        if v:
            notified = ''
        else:
            notified = self.newversion
        self.main.set_config('notified', str(notified))

    def close(self, widget):
        self.destroy()

    def get_newversion(self, widget):
        if self.main.updater.can_install():
            if self.main.updater.torrentfile is None:
                self.main.visit_url(self.download_url)
            else:
                self.main.start_auto_update()
        else:
            self.main.visit_url(self.download_url)
        self.destroy()


class AboutWindow(object):

    def __init__(self, main, donatefunc):
        self.win = Window()
        self.win.set_title(_(""About %s"")%app_name)
        self.win.set_size_request(300,400)
        self.win.set_border_width(SPACING)
        self.win.set_resizable(False)
        self.win.connect('destroy', lambda w: main.window_closed('about'))
        self.scroll = gtk.ScrolledWindow()
        self.scroll.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_ALWAYS)
        self.scroll.set_shadow_type(gtk.SHADOW_IN)

        self.outervbox = gtk.VBox()

        self.outervbox.pack_start(get_logo(96), expand=False, fill=False)

        version_str = version
        if int(version_str[2]) % 2:
            version_str = version_str + ' ' + _(""Beta"")

        self.outervbox.pack_start(gtk.Label(_(""Version %s"")%version_str), expand=False, fill=False)

        if branch is not None:
            blabel = gtk.Label('cdv client dir: %s' % branch)
            self.outervbox.pack_start(blabel, expand=False, fill=False)

        self.vbox = gtk.VBox()
        self.vbox.set_size_request(250, -1)

        for i, fn in enumerate(('credits', 'credits-l10n')):
            if i != 0:
                self.vbox.pack_start(gtk.HSeparator(), padding=SPACING,
                                     expand=False, fill=False)
            filename = os.path.join(doc_root, fn+'.txt')
            l = ''
            if not os.access(filename, os.F_OK|os.R_OK):
                l = _(""Couldn't open %s"") % filename
            else:
                credits_f = file(filename)
                l = credits_f.read()
                credits_f.close()
            if os.name == 'nt':
                # gtk ignores blank lines on win98
                l = l.replace('\n\n', '\n\t\n')
            label = gtk.Label(l.strip())
            label.set_line_wrap(True)
            label.set_selectable(True)
            label.set_justify(gtk.JUSTIFY_CENTER)
            label.set_size_request(250,-1)
            self.vbox.pack_start(label, expand=False, fill=False)

        self.scroll.add_with_viewport(self.vbox)

        self.outervbox.pack_start(self.scroll, padding=SPACING)

        self.donatebutton = gtk.Button(_(""Donate""))
        self.donatebutton.connect('clicked', donatefunc)
        self.donatebuttonbox = gtk.HButtonBox()
        self.donatebuttonbox.pack_start(self.donatebutton,
                                        expand=False, fill=False)
        self.outervbox.pack_end(self.donatebuttonbox, expand=False, fill=False)

        self.win.add(self.outervbox)

        self.win.show_all()

    def close(self, widget):
        self.win.destroy()    


class LogWindow(object):
    def __init__(self, main, logbuffer, config):
        self.config = config
        self.main = main
        self.win = Window()
        self.win.set_title(_(""%s Activity Log"")%app_name)
        self.win.set_default_size(600, 200)
        self.win.set_border_width(SPACING)
            
        self.buffer = logbuffer
        self.text = gtk.TextView(self.buffer)
        self.text.set_editable(False)
        self.text.set_cursor_visible(False)
        self.text.set_wrap_mode(gtk.WRAP_WORD)

        self.scroll = gtk.ScrolledWindow()
        self.scroll.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_ALWAYS)
        self.scroll.set_shadow_type(gtk.SHADOW_IN)
        self.scroll.add(self.text)

        self.vbox = gtk.VBox(spacing=SPACING)
        self.vbox.pack_start(self.scroll)

        self.buttonbox = gtk.HButtonBox()
        self.buttonbox.set_spacing(SPACING)
        
        self.closebutton = gtk.Button(stock='gtk-close')
        self.closebutton.connect('clicked', self.close)
        
        self.savebutton = gtk.Button(stock='gtk-save')
        self.savebutton.connect('clicked', self.save_log_file_selection)

        self.clearbutton = gtk.Button(stock='gtk-clear')
        self.clearbutton.connect('clicked', self.clear_log)

        self.buttonbox.pack_start(self.savebutton)
        self.buttonbox.pack_start(self.closebutton)

        self.hbox2 = gtk.HBox(homogeneous=False)

        self.hbox2.pack_end(self.buttonbox, expand=False, fill=False)

        bb = gtk.HButtonBox()
        bb.pack_start(self.clearbutton)
        self.hbox2.pack_start(bb, expand=False, fill=True)

        self.vbox.pack_end(self.hbox2, expand=False, fill=True)

        self.win.add(self.vbox)        
        self.win.connect(""destroy"", lambda w: self.main.window_closed('log'))
        self.scroll_to_end()
        self.win.show_all()

    def scroll_to_end(self):
        mark = self.buffer.create_mark(None, self.buffer.get_end_iter())
        self.text.scroll_mark_onscreen(mark)

    def save_log_file_selection(self, *args):
        name = 'bittorrent.log'
        path = smart_dir(self.config['save_in'])
        fullname = os.path.join(path, name)
        self.main.open_window('savefile',
                              title=_(""Save log in:""),
                              fullname=fullname,
                              got_location_func=self.save_log,
                              no_location_func=lambda: self.main.window_closed('savefile'))


    def save_log(self, saveas):
        self.main.window_closed('savefile')
        f = file(saveas, 'w')
        f.write(self.buffer.get_text(self.buffer.get_start_iter(),
                                     self.buffer.get_end_iter()))
        save_message = self.buffer.log_text(_(""log saved""), None)
        f.write(save_message)
        f.close()

    def clear_log(self, *args):
        self.buffer.clear_log()

    def close(self, widget):
        self.win.destroy()


class LogBuffer(gtk.TextBuffer):

    def __init__(self):
        gtk.TextBuffer.__init__(self)

        tt = self.get_tag_table()

        size_tag = gtk.TextTag('small')
        size_tag.set_property('size-points', 10)
        tt.add(size_tag)

        info_tag = gtk.TextTag('info')
        info_tag.set_property('foreground', '#00a040')
        tt.add(info_tag)

        warning_tag = gtk.TextTag('warning')
        warning_tag.set_property('foreground', '#a09000')
        tt.add(warning_tag)

        error_tag = gtk.TextTag('error')
        error_tag.set_property('foreground', '#b00000')
        tt.add(error_tag)

        critical_tag = gtk.TextTag('critical')
        critical_tag.set_property('foreground', '#b00000')
        critical_tag.set_property('weight', pango.WEIGHT_BOLD)
        tt.add(critical_tag)


    def log_text(self, text, severity=CRITICAL):
        now_str = datetime.datetime.strftime(datetime.datetime.now(),
                                             '[%Y-%m-%d %H:%M:%S] ')
        self.insert_with_tags_by_name(self.get_end_iter(), now_str, 'small')
        if severity is not None:
            self.insert_with_tags_by_name(self.get_end_iter(), '%s\n'%text,
                                          'small', status_dict[severity])
        else:
            self.insert_with_tags_by_name(self.get_end_iter(),
                                          ' -- %s -- \n'%text, 'small')
            
        return now_str+text+'\n'

    def clear_log(self):
        self.set_text('')
        self.log_text(_(""log cleared""), None)


class CheckButton(gtk.CheckButton): 
    def __init__(self, label, main, option_name, initial_value,
                 extra_callback=None):
        gtk.CheckButton.__init__(self, label)
        self.main = main
        self.option_name = option_name
        self.option_type = type(initial_value)
        self.set_active(bool(initial_value))
        self.extra_callback = extra_callback
        self.connect('toggled', self.callback)

    def callback(self, *args):
        self.main.config[self.option_name] = \
            self.option_type(not self.main.config[self.option_name])
        self.main.setfunc(self.option_name, self.main.config[self.option_name])
        if self.extra_callback is not None:
            self.extra_callback()


class SettingsWindow(object):

    def __init__(self, main, config, setfunc):
        self.main = main
        self.setfunc = setfunc
        self.config = config
        self.win = Window()
        self.win.connect(""destroy"", lambda w: main.window_closed('settings'))
        self.win.set_title(_(""%s Settings"")%app_name)
        self.win.set_border_width(SPACING)

        self.notebook = gtk.Notebook()

        self.vbox = gtk.VBox(spacing=SPACING)
        self.vbox.pack_start(self.notebook, expand=False, fill=False)

        # General tab
        if os.name == 'nt':
            self.cb_box = gtk.VBox(spacing=SPACING)
            self.cb_box.set_border_width(SPACING)
            self.notebook.append_page(self.cb_box, gtk.Label(_(""General"")))

            self.startup_checkbutton = CheckButton(
                _(""Launch BitTorrent when Windows starts""), self,
                'launch_on_startup', self.config['launch_on_startup'])
            self.cb_box.pack_start(self.startup_checkbutton, expand=False, fill=False)
            self.startup_checkbutton.connect('toggled', self.launch_on_startup)

            self.minimize_checkbutton = CheckButton(
                _(""Minimize to system tray""), self,
                'minimize_to_tray', self.config['minimize_to_tray'])
            self.cb_box.pack_start(self.minimize_checkbutton, expand=False, fill=False)

            # allow the user to set the progress bar text to all black
            self.progressbar_hack = CheckButton(
                _(""Progress bar text is always black\n(requires restart)""),
                self, 'progressbar_hack', self.config['progressbar_hack'])

            self.cb_box.pack_start(self.progressbar_hack, expand=False, fill=False)
            # end General tab

        # Saving tab
        self.saving_box = gtk.VBox(spacing=SPACING)
        self.saving_box.set_border_width(SPACING)
        self.notebook.append_page(self.saving_box, gtk.Label(_(""Saving"")))

        self.dl_frame = gtk.Frame(_(""Save new downloads in:""))
        self.saving_box.pack_start(self.dl_frame, expand=False, fill=False)

        self.dl_box = gtk.VBox(spacing=SPACING)
        self.dl_box.set_border_width(SPACING)
        self.dl_frame.add(self.dl_box)
        self.save_in_box = gtk.HBox(spacing=SPACING)

        self.dl_save_in = gtk.Entry()
        self.dl_save_in.set_editable(False)
        self.set_save_in(self.config['save_in'])
        self.save_in_box.pack_start(self.dl_save_in, expand=True, fill=True)

        self.dl_save_in_button = gtk.Button(_(""Change...""))
        self.dl_save_in_button.connect('clicked', self.get_save_in)
        self.save_in_box.pack_start(self.dl_save_in_button, expand=False, fill=False)
        self.dl_box.pack_start(self.save_in_box, expand=False, fill=False)

        self.dl_ask_checkbutton = CheckButton(
            _(""Ask where to save each new download""), self,
            'ask_for_save', self.config['ask_for_save'])

        self.dl_box.pack_start(self.dl_ask_checkbutton, expand=False, fill=False)
        # end Saving tab

        # Downloading tab
        self.downloading_box = gtk.VBox(spacing=SPACING)
        self.downloading_box.set_border_width(SPACING)
        self.notebook.append_page(self.downloading_box, gtk.Label(_(""Downloading"")))

        self.dnd_frame = gtk.Frame(_(""When starting a new torrent:""))
        self.dnd_box = gtk.VBox(spacing=SPACING, homogeneous=True)
        self.dnd_box.set_border_width(SPACING)

        self.dnd_states = ['replace','add','ask']
        self.dnd_original_state = self.config['start_torrent_behavior']
        
        self.always_replace_radio = gtk.RadioButton(
            group=None,
            label=_(""_Stop another running torrent to make room""))
        self.dnd_box.pack_start(self.always_replace_radio)
        self.always_replace_radio.state_name = self.dnd_states[0]
        
        self.always_add_radio = gtk.RadioButton(
            group=self.always_replace_radio,
            label=_(""_Don't stop other running torrents""))
        self.dnd_box.pack_start(self.always_add_radio)
        self.always_add_radio.state_name = self.dnd_states[1]

        self.always_ask_radio = gtk.RadioButton(
            group=self.always_replace_radio,
            label=_(""_Ask each time"")
            )
        self.dnd_box.pack_start(self.always_ask_radio)
        self.always_ask_radio.state_name = self.dnd_states[2]

        self.dnd_group = self.always_replace_radio.get_group()
        for r in self.dnd_group:
            r.connect('toggled', self.start_torrent_behavior_changed)

        self.set_start_torrent_behavior(self.config['start_torrent_behavior'])
        
        self.dnd_frame.add(self.dnd_box)
        self.downloading_box.pack_start(self.dnd_frame, expand=False, fill=False)

        # Seeding tab
        self.seeding_box = gtk.VBox(spacing=SPACING)
        self.seeding_box.set_border_width(SPACING)
        self.notebook.append_page(self.seeding_box, gtk.Label(_(""Seeding"")))

        def colon_split(framestr):
            COLONS = (':', u'\uff1a')
            for colon in COLONS:
                if colon in framestr:
                    return framestr.split(colon)
            return '', framestr
        
        nt_framestr = _(""Seed completed torrents: until share ratio reaches [_] percent, or for [_] minutes, whichever comes first."")
        nt_title, nt_rem = colon_split(nt_framestr)
        nt_msg1, nt_msg2, nt_msg4 = nt_rem.split('[_]')
        nt_msg3 = ''
        if ',' in nt_msg2:
            nt_msg2, nt_msg3 = nt_msg2.split(',')
            nt_msg2 += ','

        self.next_torrent_frame = gtk.Frame(nt_title+':')
        self.next_torrent_box   = gtk.VBox(spacing=SPACING, homogeneous=True)
        self.next_torrent_box.set_border_width(SPACING) 
        
        self.next_torrent_frame.add(self.next_torrent_box)


        self.next_torrent_ratio_box = gtk.HBox()
        self.next_torrent_ratio_box.pack_start(gtk.Label(nt_msg1),
                                               fill=False, expand=False)
        self.next_torrent_ratio_field = PercentValidator('next_torrent_ratio',
                                                         self.config, self.setfunc)
        self.next_torrent_ratio_box.pack_start(self.next_torrent_ratio_field,
                                               fill=False, expand=False)
        self.next_torrent_ratio_box.pack_start(gtk.Label(nt_msg2),
                                               fill=False, expand=False)
        self.next_torrent_box.pack_start(self.next_torrent_ratio_box)


        self.next_torrent_time_box = gtk.HBox()
        self.next_torrent_time_box.pack_start(gtk.Label(nt_msg3),
                                              fill=False, expand=False)
        self.next_torrent_time_field = MinutesValidator('next_torrent_time',
                                                        self.config, self.setfunc)
        self.next_torrent_time_box.pack_start(self.next_torrent_time_field,
                                              fill=False, expand=False)
        self.next_torrent_time_box.pack_start(gtk.Label(nt_msg4),
                                              fill=False, expand=False)
        self.next_torrent_box.pack_start(self.next_torrent_time_box)

        def seed_forever_extra():
            for field in (self.next_torrent_ratio_field,
                          self.next_torrent_time_field):
                field.set_sensitive(not self.config['seed_forever'])

        seed_forever_extra()
        self.seed_forever = CheckButton( _(""Seed indefinitely""), self,
                                         'seed_forever',
                                         self.config['seed_forever'],
                                         seed_forever_extra)
        self.next_torrent_box.pack_start(self.seed_forever)
        # end next torrent seed behavior

        # begin last torrent seed behavior
        lt_framestr = _(""Seed last completed torrent: until share ratio reaches [_] percent."")
        lt_title, lt_rem = colon_split(lt_framestr)
        lt_msg1, lt_msg2 = lt_rem.split('[_]')
        
        self.seeding_box.pack_start(self.next_torrent_frame, expand=False, fill=False)

        self.last_torrent_frame = gtk.Frame(lt_title+':')
        self.last_torrent_vbox = gtk.VBox(spacing=SPACING)
        self.last_torrent_vbox.set_border_width(SPACING)
        self.last_torrent_box = gtk.HBox()
        self.last_torrent_box.pack_start(gtk.Label(lt_msg1),
                                         expand=False, fill=False)
        self.last_torrent_ratio_field = PercentValidator('last_torrent_ratio',
                                                         self.config, self.setfunc)
        self.last_torrent_box.pack_start(self.last_torrent_ratio_field,
                                         fill=False, expand=False)
        self.last_torrent_box.pack_start(gtk.Label(lt_msg2),
                                         fill=False, expand=False)
        self.last_torrent_vbox.pack_start(self.last_torrent_box)
        
        def seed_last_forever_extra():
            self.last_torrent_ratio_field.set_sensitive(
                not self.config['seed_last_forever'])

        seed_last_forever_extra()

        self.seed_last_forever = CheckButton(_(""Seed indefinitely""), self,
                                             'seed_last_forever',
                                             self.config['seed_last_forever'],
                                             seed_last_forever_extra)
        self.last_torrent_vbox.pack_start(self.seed_last_forever)

        self.last_torrent_frame.add(self.last_torrent_vbox)
        self.seeding_box.pack_start(self.last_torrent_frame, expand=False, fill=False)

        # Network tab
        self.network_box = gtk.VBox(spacing=SPACING)
        self.network_box.set_border_width(SPACING)
        self.notebook.append_page(self.network_box, gtk.Label(_(""Network"")))

        self.port_range_frame = gtk.Frame(_(""Look for available port:""))        
        self.port_range_box = gtk.VBox(spacing=SPACING)
        self.port_range_box.set_border_width(SPACING)
        
        self.port_range = gtk.HBox()
        self.port_range.pack_start(gtk.Label(_(""starting at port: "")),
                                   expand=False, fill=False)
        self.minport_field = PortValidator('minport', self.config, self.setfunc)
        self.minport_field.add_end('maxport')
        self.port_range.pack_start(self.minport_field, expand=False, fill=False)
        self.minport_field.settingswindow = self
        self.port_range.pack_start(gtk.Label(' (1024-65535)'),
                                   expand=False, fill=False)
        self.port_range_box.pack_start(self.port_range,
                                       expand=False, fill=False)

        self.upnp = CheckButton(_(""Enable automatic port mapping"")+' (_UPnP)',
                                self, 'upnp', self.config['upnp'], None)
        self.port_range_box.pack_start(self.upnp,
                                   expand=False, fill=False)

        self.port_range_frame.add(self.port_range_box)
        self.network_box.pack_start(self.port_range_frame, expand=False, fill=False)

        self.ip_frame = gtk.Frame(_(""IP to report to the tracker:""))
        self.ip_box = gtk.VBox()
        self.ip_box.set_border_width(SPACING)
        self.ip_field = IPValidator('ip', self.config, self.setfunc)
        self.ip_box.pack_start(self.ip_field, expand=False, fill=False)
        label = gtk.Label(_(""(Has no effect unless you are on the\nsame local network as the tracker)""))
        label.set_line_wrap(True)
        self.ip_box.pack_start(lalign(label), expand=False, fill=False)
        self.ip_frame.add(self.ip_box)
        self.network_box.pack_start(self.ip_frame, expand=False, fill=False)

        # end Network tab        

        # Language tab
        self.languagechooser = LanguageChooser()
        self.notebook.append_page(self.languagechooser, gtk.Label(""Language""))
        # end Language tab

        # Advanced tab
        if advanced_ui:
            self.advanced_box = gtk.VBox(spacing=SPACING)
            self.advanced_box.set_border_width(SPACING)
            hint = gtk.Label(_(""WARNING: Changing these settings can\nprevent %s from functioning correctly."")%app_name)
            self.advanced_box.pack_start(lalign(hint), expand=False, fill=False)
            self.store = gtk.ListStore(*[gobject.TYPE_STRING] * 2)
            for option in ui_options[advanced_ui_options_index:]:
                self.store.append((option, str(self.config[option])))

            self.treeview = gtk.TreeView(self.store)
            r = gtk.CellRendererText()
            column = gtk.TreeViewColumn(_(""Option""), r, text=0)
            self.treeview.append_column(column)
            r = gtk.CellRendererText()
            r.set_property('editable', True)
            r.connect('edited', self.store_value_edited)
            column = gtk.TreeViewColumn(_(""Value""), r, text=1)
            self.treeview.append_column(column)
            self.advanced_frame = gtk.Frame()
            self.advanced_frame.set_shadow_type(gtk.SHADOW_IN)
            self.advanced_frame.add(self.treeview)

            self.advanced_box.pack_start(self.advanced_frame, expand=False, fill=False)
            self.notebook.append_page(self.advanced_box, gtk.Label(_(""Advanced"")))
        

        self.win.add(self.vbox)
        self.win.show_all()


    def get_save_in(self, widget=None):
        self.file_selection = self.main.open_window('choosefolder',
                                                    title=_(""Choose default download directory""),
                                                    fullname=self.config['save_in'],
                                                    got_location_func=self.set_save_in,
                                                    no_location_func=lambda: self.main.window_closed('choosefolder'))

    def set_save_in(self, save_location):
        self.main.window_closed('choosefolder')
        if os.path.isdir(save_location):
            if save_location[-1] != os.sep:
                save_location += os.sep
            self.config['save_in'] = save_location
            save_in = path_wrap(self.config['save_in'])
            self.dl_save_in.set_text(save_in)
            self.setfunc('save_in', self.config['save_in'])

    def launch_on_startup(self, *args):
        dst = os.path.join(get_startup_dir(), app_name)
        if self.config['launch_on_startup']:
            src = os.path.abspath(sys.argv[0])
            create_shortcut(src, dst, ""--start_minimized"")
        else:
            try:
                remove_shortcut(dst)
            except Exception, e:
                self.main.global_error(WARNING, _(""Failed to remove shortcut: %s"") % str(e))

    def set_start_torrent_behavior(self, state_name):
        if state_name in self.dnd_states:
            for r in self.dnd_group:
                if r.state_name == state_name:
                    r.set_active(True)
                else:
                    r.set_active(False)
        else:
            self.always_replace_radio.set_active(True)        

    def start_torrent_behavior_changed(self, radiobutton):
        if radiobutton.get_active():
            self.setfunc('start_torrent_behavior', radiobutton.state_name)

    def store_value_edited(self, cell, row, new_text):
        it = self.store.get_iter_from_string(row)
        option = ui_options[int(row)+advanced_ui_options_index]
        t = type(defconfig[option])
        try:
            if t is type(None) or t is str:
                value = new_text
            elif t is int or t is long:
                value = int(new_text)
            elif t is float:
                value = float(new_text)
            elif t is bool:
                value = value == 'True'
            else:
                raise TypeError, str(t)
        except ValueError:
            return
        self.setfunc(option, value)
        self.store.set(it, 1, str(value))

    def close(self, widget):
        self.win.destroy()


class FileListWindow(object):

    SET_PRIORITIES = False

    def __init__(self, metainfo, closefunc):
        self.metainfo = metainfo
        self.setfunc = None
        self.allocfunc = None
        self.win = Window()
        self.win.set_title(_('Files in ""%s""') % self.metainfo.name)
        self.win.connect(""destroy"", closefunc)
        self.tooltips = gtk.Tooltips()

        self.filepath_to_iter = {}

        self.box1 = gtk.VBox()

        size_request = (0,0)
        if self.SET_PRIORITIES:
            self.toolbar = gtk.Toolbar()
            for label, tip, stockicon, method, arg in (
                (_(""Never"" ), _(""Never download""   ), gtk.STOCK_DELETE, self.dosomething, -1,),
                (_(""Normal""), _(""Download normally""), gtk.STOCK_NEW   , self.dosomething,  0,),
                (_(""First"" ), _(""Download first""   ),'bt-finished'    , self.dosomething, +1,),):
                self.make_tool_item(label, tip, stockicon, method, arg)
            size_request = (-1,54)
            self.box1.pack_start(self.toolbar, False)
            
        self.sw = gtk.ScrolledWindow()
        self.sw.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)
        self.box1.pack_start(self.sw)
        self.win.add(self.box1)

        columns = [_(""Filename""),_(""Length""),_('%')]
        pre_size_list = ['M'*30, '6666 MB', '100.0', 'Download','black']
        if self.SET_PRIORITIES:
            columns.append(_(""Download""))
        num_columns = len(pre_size_list)

        self.store = gtk.TreeStore(*[gobject.TYPE_STRING] * num_columns)
        self.store.append(None, pre_size_list)
        self.treeview = gtk.TreeView(self.store)
        self.treeview.set_enable_search(True)
        self.treeview.set_search_column(0)
        cs = []
        for i, name in enumerate(columns):
            r = gtk.CellRendererText()
            r.set_property('xalign', (0, 1, 1, 1)[i])
            if i == 0:
                column = gtk.TreeViewColumn(name, r, text = i, foreground = len(pre_size_list)-1)
            else:
                column = gtk.TreeViewColumn(name, r, text = i)
            column.set_resizable(True)
            self.treeview.append_column(column)
            cs.append(column)

        self.sw.add(self.treeview)
        self.treeview.set_headers_visible(False)
        self.treeview.columns_autosize()
        self.box1.show_all()
        self.treeview.realize()

        for column in cs:
            column.set_fixed_width(max(5,column.get_width()))
            column.set_sizing(gtk.TREE_VIEW_COLUMN_FIXED)
        self.treeview.set_headers_visible(True)
        self.store.clear()

        if self.SET_PRIORITIES:
            self.treeview.get_selection().set_mode(gtk.SELECTION_MULTIPLE)
        else:
            self.treeview.get_selection().set_mode(gtk.SELECTION_NONE)

        self.piecelen = self.metainfo.piece_length
        self.lengths = self.metainfo.sizes
        self.initialize_file_priorities()#[0,0])
        for name, size, priority in itertools.izip(self.metainfo.orig_files,
                                        self.metainfo.sizes, self.priorities):
            parent_name, local_name = os.path.split(name)
            parent_iter = self.recursive_add(parent_name)
            
            row = [local_name, Size(size), '?','', 'black']
            it = self.store.append(parent_iter, row)
            self.filepath_to_iter[name] = it
            
        self.treeview.expand_all()
        tvsr = self.treeview.size_request()
        vertical_padding = 18 
        size_request = [max(size_request[0],tvsr[0]),
                        (size_request[1] + tvsr[1] ) + vertical_padding]
        maximum_height = 300
        if size_request[1] > maximum_height - SCROLLBAR_WIDTH:
            size_request[1] = maximum_height
            size_request[0] = size_request[0] + SCROLLBAR_WIDTH
        self.win.set_default_size(*size_request)
                                  
        self.win.show_all()

    def recursive_add(self, fullpath):
        if fullpath == '':
            return None
        elif self.filepath_to_iter.has_key(fullpath):
            return self.filepath_to_iter[fullpath]
        else:
            parent_path, local_path = os.path.split(fullpath)
            parent_iter = self.recursive_add(parent_path)
            it = self.store.append(parent_iter,
                                   (local_path,) +
                                   ('',) * (self.store.get_n_columns()-2) +
                                   ('black',))
            self.filepath_to_iter[fullpath] = it
            return it

    def make_tool_item(self, label, tip, stockicon, method, arg): 
        icon = gtk.Image()
        icon.set_from_stock(stockicon, gtk.ICON_SIZE_SMALL_TOOLBAR)
        item = gtk.ToolButton(icon_widget=icon, label=label)
        item.set_homogeneous(True)
        item.set_tooltip(self.tooltips, tip)
        if arg is not None:
            item.connect('clicked', method, arg)
        else:
            item.connect('clicked', method)
        self.toolbar.insert(item, 0)

    def initialize_file_priorities(self):
        self.priorities = []
        for length in self.lengths:
            self.priorities.append(0)

## Uoti wrote these methods. I have no idea what this code is supposed to do.
##        --matt
##    def set_priorities(self, widget):
##        r = []
##        piece = 0
##        pos = 0
##        curprio = prevprio = 1000
##        for priority, length in itertools.izip(self.priorities, self.lengths):
##            pos += length
##            curprio = min(priority, curprio)
##            while pos >= (piece + 1) * self.piecelen:
##                if curprio != prevprio:
##                    r.extend((piece, curprio))
##                prevprio = curprio
##                if curprio == priority:
##                    piece = pos // self.piecelen
##                else:
##                    piece += 1
##                if pos == piece * self.piecelen:
##                    curprio = 1000
##                else:
##                    curprio = priority
##        if curprio != prevprio:
##            r.extend((piece, curprio))
##        self.setfunc(r)
##        it = self.store.get_iter_first()
##        for i in xrange(len(self.priorities)):
##            self.store.set_value(it, 5, ""black"")
##            it = self.store.iter_next(it)
##        self.origpriorities = list(self.priorities)
##
##    def initialize_file_priorities(self, piecepriorities):
##        self.priorities = []
##        piecepriorities = piecepriorities + [999999999]
##        it = iter(piecepriorities)
##        assert it.next() == 0
##        pos = piece = curprio = 0
##        for length in self.lengths:
##            pos += length
##            priority = curprio
##            while pos >= piece * self.piecelen:
##                curprio = it.next()
##                if pos > piece * self.piecelen:
##                    priority = max(priority, curprio)
##                piece = it.next()
##            self.priorities.append(priority)
##        self.origpriorities = list(self.priorities)

    def dosomething(self, widget, dowhat):
        self.treeview.get_selection().selected_foreach(self.adjustfile, dowhat)

    def adjustfile(self, treemodel, path, it, dowhat):
        length = treemodel.get(it, 1)[0]
        if length == '':
            child = treemodel.iter_children(it)
            while True:
                if child is None:
                    return
                elif not treemodel.is_ancestor(it, child):
                    return
                else:
                    self.adjustfile(treemodel, path, child, dowhat)
                child = treemodel.iter_next(child)
            
        else:
            # BUG: need to set file priorities in backend here
            if dowhat == -1:
                text, color = _(""never""), 'darkgrey'
            elif dowhat == 1:
                text, color = _(""first""), 'darkgreen'
            else:
                text, color = '', 'black'
            treemodel.set_value(it, 3, text )
            treemodel.set_value(it, 4, color)

    def update(self, left, allocated):
        for name, left, total, alloc in itertools.izip(
            self.metainfo.orig_files, left, self.lengths, allocated):
            it = self.filepath_to_iter[name]
            if total == 0:
                p = 1
            else:
                p = (total - left) / total
            self.store.set_value(it, 2, ""%.1f"" % (int(p * 1000)/10))

    def close(self):
        self.win.destroy()


class PeerListWindow(object):

    def __init__(self, torrent_name, closefunc):
        self.win = Window()
        self.win.connect(""destroy"", closefunc)
        self.win.set_title( _('Peers for ""%s""')%torrent_name)
        self.sw = gtk.ScrolledWindow()
        self.sw.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_ALWAYS)
        self.sw.set_shadow_type(gtk.SHADOW_IN)
        self.win.add(self.sw)

        column_header = [_(""IP address""), _(""Client""), _(""Connection""), _(""KB/s down""), _(""KB/s up""), _(""MB downloaded""), _(""MB uploaded""), _(""% complete""), _(""KB/s est. peer download"")]
        pre_size_list = ['666.666.666.666', 'TorrentStorm 1.3', 'bad peer', 66666, 66666, '1666.66', '1666.66', '100.0', 6666]
        numeric_cols = [3,4,5,6,7,8]
        store_types = [gobject.TYPE_STRING]*3  + [gobject.TYPE_INT]*2 + [gobject.TYPE_STRING]*3 + [gobject.TYPE_INT]
        
        if advanced_ui:
            column_header[2:2] = [_(""Peer ID"")]
            pre_size_list[2:2] = ['-AZ2104-']
            store_types[2:2]   = [gobject.TYPE_STRING]
            column_header[5:5] = [_(""Interested""),_(""Choked""),_(""Snubbed"")]
            pre_size_list[5:5] = ['*','*','*']
            store_types[5:5]   = [gobject.TYPE_STRING]*3
            column_header[9:9] = [_(""Interested""),_(""Choked""),_(""Optimistic upload"")]
            pre_size_list[9:9] = ['*','*','*']
            store_types[9:9]   = [gobject.TYPE_STRING]*3
            numeric_cols = [4,8,12,13,14,15]

        num_columns = len(column_header)
        self.store = gtk.ListStore(*store_types)
        self.store.append(pre_size_list)

        def makesortfunc(sort_func):
            def sortfunc(treemodel, iter1, iter2, column):
                a_str = treemodel.get_value(iter1, column)
                b_str = treemodel.get_value(iter2, column)
                if a_str is not None and b_str is not None:
                    return sort_func(a_str,b_str)
                else:
                    return 0
            return sortfunc

        def ip_sort(a_str,b_str):
            for a,b in zip(a_str.split('.'), b_str.split('.')):
                if a == b:
                    continue
                if len(a) == len(b):
                    return cmp(a,b)
                return cmp(int(a), int(b))
            return 0

        def float_sort(a_str,b_str):
            a,b = 0,0
            try: a = float(a_str)
            except ValueError: pass
            try: b = float(b_str)
            except ValueError: pass
            return cmp(a,b)

        self.store.set_sort_func(0, makesortfunc(ip_sort), 0)
        for i in range(2,5):
            self.store.set_sort_func(num_columns-i, makesortfunc(float_sort), num_columns-i)
        
        self.treeview = gtk.TreeView(self.store)
        cs = []
        for i, name in enumerate(column_header):
            r = gtk.CellRendererText()
            if i in numeric_cols:
                r.set_property('xalign', 1)
            column = gtk.TreeViewColumn(name, r, text = i)
            column.set_resizable(True)
            column.set_min_width(5)
            column.set_sort_column_id(i)
            self.treeview.append_column(column)
            cs.append(column)
        self.treeview.set_rules_hint(True)
        self.sw.add(self.treeview)
        self.treeview.set_headers_visible(False)
        self.treeview.columns_autosize()
        self.sw.show_all()
        self.treeview.realize()
        for column in cs:
            column.set_fixed_width(column.get_width())
            column.set_sizing(gtk.TREE_VIEW_COLUMN_FIXED)
        self.treeview.set_headers_visible(True)
        self.store.clear()
        self.treeview.get_selection().set_mode(gtk.SELECTION_NONE)
        width = self.treeview.size_request()[0]
        self.win.set_default_size(width+SCROLLBAR_WIDTH, 300)
        self.win.show_all()
        self.prev = []


    def update(self, peers, bad_peers):
        fields = []

        def p_bool(value): return value and '*' or ''

        for peer in peers:
            field = []
            field.append(peer['ip']) 

            client, version = ClientIdentifier.identify_client(peer['id']) 
            field.append(client + ' ' + version)

            if advanced_ui:
                field.append(zurllib.quote(peer['id'])) 
                
            field.append(peer['initiation'] == 'R' and _(""remote"") or _(""local""))
            dl = peer['download']
            ul = peer['upload']

            for l in (dl, ul):
                rate = l[1]
                if rate > 100:
                    field.append(int(round(rate/(2**10)))) 
                else:
                    field.append(0)
                if advanced_ui:
                    field.append(p_bool(l[2]))
                    field.append(p_bool(l[3]))
                    if len(l) > 4:
                        field.append(p_bool(l[4]))
                    else:
                        field.append(p_bool(peer['is_optimistic_unchoke']))

            field.append('%.2f'%round(dl[0] / 2**20, 2))
            field.append('%.2f'%round(ul[0] / 2**20, 2))
            field.append('%.1f'%round(int(peer['completed']*1000)/10, 1))

            field.append(int(peer['speed']//(2**10)))

            fields.append(field)

        for (ip, (is_banned, stats)) in bad_peers.iteritems():
            field = []
            field.append(ip)

            client, version = ClientIdentifier.identify_client(stats.peerid)
            field.append(client + ' ' + version)

            if advanced_ui:
                field.append(zurllib.quote(stats.peerid))

            field.append(_(""bad peer""))

            # the sortable peer list won't take strings in these fields
            field.append(0) 

            if advanced_ui:
                field.extend([0] * 7) # upRate, * fields
            else:
                field.extend([0] * 1) # upRate
                
            field.append(_(""%d ok"") % stats.numgood)
            field.append(_(""%d bad"") % len(stats.bad))
            if is_banned: # completion
                field.append(_(""banned""))
            else:
                field.append(_(""ok""))
            field.append(0) # peer dl rate
            fields.append(field)

        if self.store.get_sort_column_id() < 0:
            # ListStore is unsorted, it might be faster to set only modified fields
            it = self.store.get_iter_first()
            for old, new in itertools.izip(self.prev, fields):
                if old != new:
                    for i, value in enumerate(new):
                        if value != old[i]:
                            self.store.set_value(it, i, value)
                it = self.store.iter_next(it)
            for i in range(len(fields), len(self.prev)):
                self.store.remove(it)
            for i in range(len(self.prev), len(fields)):
                self.store.append(fields[i])
            self.prev = fields
        else:
            # ListStore is sorted, no reason not to to reset all fields
            self.store.clear()
            for field in fields:
                self.store.append(field)
            
        

    def close(self):
        self.win.destroy()


class TorrentInfoWindow(object):

    def __init__(self, torrent_box, closefunc):
        self.win = Window()
        self.torrent_box = torrent_box
        name = self.torrent_box.metainfo.name
        self.win.set_title(_('Info for ""%s""')%name)
        self.win.set_size_request(-1,-1)
        self.win.set_border_width(SPACING)
        self.win.set_resizable(False)
        self.win.connect('destroy', closefunc)
        self.vbox = gtk.VBox(spacing=SPACING)

        self.table = gtk.Table(rows=4, columns=3, homogeneous=False)
        self.table.set_row_spacings(SPACING)
        self.table.set_col_spacings(SPACING)
        y = 0

        def add_item(key, val, y):
            self.table.attach(ralign(gtk.Label(key)), 0, 1, y, y+1)
            v = gtk.Label(val)
            v.set_selectable(True)
            self.table.attach(lalign(v), 1, 2, y, y+1)

        add_item(_(""Torrent name:""), name, y)
        y+=1

        announce = ''
        if self.torrent_box.metainfo.is_trackerless:
            announce = _(""(trackerless torrent)"")
        else:
            announce = self.torrent_box.metainfo.announce
        add_item(_(""Announce url:""), announce, y)
        y+=1

        size = Size(self.torrent_box.metainfo.total_bytes)
        num_files = _("", in one file"")
        if self.torrent_box.is_batch:
            num_files = _("", in %d files"") % len(self.torrent_box.metainfo.sizes)
        add_item(_(""Total size:""),  str(size)+num_files, y)
        y+=1

        if advanced_ui:
            pl = self.torrent_box.metainfo.piece_length
            count, lastlen = divmod(size, pl)
            sizedetail = '%d x %d + %d = %d' % (count, pl, lastlen, int(size))
            add_item(_(""Pieces:""), sizedetail, y)
            y+=1
            add_item(_(""Info hash:""), self.torrent_box.infohash.encode('hex'), y)
            y+=1

        path = self.torrent_box.dlpath
        filename = ''
        if path is None:
            path = ''
        else:
            if not self.torrent_box.is_batch:
                path,filename = os.path.split(self.torrent_box.dlpath)
            if path[-1] != os.sep:
                path += os.sep
            path = path_wrap(path)
        add_item(_(""Save in:""), path, y)
        y+=1

        if not self.torrent_box.is_batch:
            add_item(_(""File name:""), path_wrap(filename), y)
            y+=1

        self.vbox.pack_start(self.table)        

        if self.torrent_box.metainfo.comment not in (None, ''):
            commentbuffer = gtk.TextBuffer()
            commentbuffer.set_text(self.torrent_box.metainfo.comment)
            commenttext = gtk.TextView(commentbuffer)
            commenttext.set_editable(False)
            commenttext.set_cursor_visible(False)
            commenttext.set_wrap_mode(gtk.WRAP_WORD)
            commentscroll = gtk.ScrolledWindow()
            commentscroll.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_ALWAYS)
            commentscroll.set_shadow_type(gtk.SHADOW_IN)
            commentscroll.add(commenttext)
            self.vbox.pack_start(commentscroll)

        self.vbox.pack_start(gtk.HSeparator(), expand=False, fill=False)

        self.hbox = gtk.HBox(spacing=SPACING)
        lbbox = gtk.HButtonBox()
        rbbox = gtk.HButtonBox()
        lbbox.set_spacing(SPACING)

        if LaunchPath.can_launch_files:
            opendirbutton = IconButton(_(""_Open directory""), stock=gtk.STOCK_OPEN)
            opendirbutton.connect('clicked', self.torrent_box.open_dir)
            lbbox.pack_start(opendirbutton, expand=False, fill=False)
            opendirbutton.set_sensitive(self.torrent_box.can_open_dir())

        filelistbutton = IconButton(_(""Show _file list""), stock='gtk-index')
        if self.torrent_box.is_batch:
            filelistbutton.connect('clicked', self.torrent_box.open_filelist)
        else:
            filelistbutton.set_sensitive(False)
        lbbox.pack_start(filelistbutton, expand=False, fill=False)

        closebutton = gtk.Button(stock='gtk-close')
        closebutton.connect('clicked', lambda w: self.close())
        rbbox.pack_end(closebutton, expand=False, fill=False)

        self.hbox.pack_start(lbbox, expand=False, fill=False)
        self.hbox.pack_end(  rbbox, expand=False, fill=False)

        self.vbox.pack_end(self.hbox, expand=False, fill=False)

        self.win.add(self.vbox)
        
        self.win.show_all()

    def close(self):
        self.win.destroy()


class TorrentBox(gtk.EventBox):
    torrent_tip_format = '%s:\n %s\n %s'
    
    def __init__(self, infohash, metainfo, dlpath, completion, main):
        gtk.EventBox.__init__(self)
        self.infohash = infohash
        self.metainfo = metainfo
        self.completion = completion
        self.main = main

        self.main_torrent_dnd_tip = _(""drag to reorder"")
        self.torrent_menu_tip = _(""right-click for menu"")

        self.set_save_location(dlpath)

        self.uptotal   = self.main.torrents[self.infohash].uptotal
        self.downtotal = self.main.torrents[self.infohash].downtotal
        if self.downtotal > 0:
            self.up_down_ratio = self.uptotal / self.metainfo.total_bytes
        else:
            self.up_down_ratio = None

        self.infowindow = None
        self.filelistwindow = None
        self.is_batch = metainfo.is_batch
        self.menu = None
        self.menu_handler = None

        self.vbox = gtk.VBox(homogeneous=False, spacing=SPACING)
        self.label = gtk.Label()
        self.set_name()
        
        self.vbox.pack_start(lalign(self.label), expand=False, fill=False)

        self.hbox = gtk.HBox(homogeneous=False, spacing=SPACING)

        self.icon = gtk.Image()
        self.icon.set_size_request(-1, 29)

        self.iconbox = gtk.VBox()
        self.iconevbox = gtk.EventBox()        
        self.iconevbox.add(self.icon)
        self.iconbox.pack_start(self.iconevbox, expand=False, fill=False)
        self.hbox.pack_start(self.iconbox, expand=False, fill=False)
        
        self.vbox.pack_start(self.hbox)
        
        self.infobox = gtk.VBox(homogeneous=False)

        self.progressbarbox = gtk.HBox(homogeneous=False, spacing=SPACING)
        self.progressbar = gtk.ProgressBar()

        self.reset_progressbar_color()
        
        if self.completion is not None:
            self.progressbar.set_fraction(self.completion)
            if self.completion >= 1:
                done_label = self.make_done_label()
                self.progressbar.set_text(done_label)
            else:
                self.progressbar.set_text('%.1f%%'%(self.completion*100))
        else:
            self.progressbar.set_text('?')
            
        self.progressbarbox.pack_start(self.progressbar,
                                       expand=True, fill=True)

        self.buttonevbox = gtk.EventBox()
        self.buttonbox = gtk.HBox(homogeneous=True, spacing=SPACING)

        self.infobutton = gtk.Button()
        self.infoimage = gtk.Image()
        self.infoimage.set_from_stock('bt-info', gtk.ICON_SIZE_BUTTON)
        self.infobutton.add(self.infoimage)
        self.infobutton.connect('clicked', self.open_info)
        self.main.tooltips.set_tip(self.infobutton,
                                   _(""Torrent info""))

        self.buttonbox.pack_start(self.infobutton, expand=True)

        self.cancelbutton = gtk.Button()
        self.cancelimage = gtk.Image()
        if self.completion is not None and self.completion >= 1:
            self.cancelimage.set_from_stock('bt-remove', gtk.ICON_SIZE_BUTTON)
            self.main.tooltips.set_tip(self.cancelbutton,
                                       _(""Remove torrent""))
        else:
            self.cancelimage.set_from_stock('bt-abort', gtk.ICON_SIZE_BUTTON)
            self.main.tooltips.set_tip(self.cancelbutton,
                                       _(""Abort torrent""))
            
        self.cancelbutton.add(self.cancelimage)
        # not using 'clicked' because we want to check for CTRL key
        self.cancelbutton.connect('button-release-event', self.confirm_remove)
        
        self.buttonbox.pack_start(self.cancelbutton, expand=True, fill=False)
        self.buttonevbox.add(self.buttonbox)

        vbuttonbox = gtk.VBox(homogeneous=False)
        vbuttonbox.pack_start(self.buttonevbox, expand=False, fill=False)
        self.hbox.pack_end(vbuttonbox, expand=False, fill=False)

        self.infobox.pack_start(self.progressbarbox, expand=False, fill=False)

        self.hbox.pack_start(self.infobox, expand=True, fill=True)
        self.add( self.vbox )

        self.drag_source_set(gtk.gdk.BUTTON1_MASK,
                             TARGET_ALL,
                             gtk.gdk.ACTION_MOVE|gtk.gdk.ACTION_COPY)
        self.connect('drag_data_get', self.drag_data_get)

        self.connect('drag_begin' , self.drag_begin )
        self.connect('drag_end'   , self.drag_end   )
        self.cursor_handler_id = self.connect('enter_notify_event', self.change_cursors)


    def set_save_location(self, dlpath):
        self.dlpath = dlpath
        updater_infohash = self.main.updater.infohash
        if updater_infohash == self.infohash:
            my_installer_dir = os.path.split(self.dlpath)[0]
            if self.main.updater.installer_dir != my_installer_dir:
                self.main.updater.set_installer_dir(my_installer_dir)


    def reset_progressbar_color(self):
        # Hack around broken GTK-Wimp theme:
        # make progress bar text always black
        # see task #694
        if is_frozen_exe and self.main.config['progressbar_hack']:
            style = self.progressbar.get_style().copy()
            black = style.black
            self.progressbar.modify_fg(gtk.STATE_PRELIGHT, black)
        

    def change_cursors(self, *args):
        # BUG: this is in a handler that is disconnected because the
        # window attributes are None until after show_all() is called
        self.window.set_cursor(gtk.gdk.Cursor(gtk.gdk.HAND2))
        self.buttonevbox.window.set_cursor(gtk.gdk.Cursor(gtk.gdk.LEFT_PTR))
        self.disconnect(self.cursor_handler_id)
        

    def drag_data_get(self, widget, context, selection, targetType, eventTime):
        selection.set(selection.target, 8, self.infohash)

    def drag_begin(self, *args):
        pass

    def drag_end(self, *args):
        self.main.drag_end()

    def make_done_label(self, statistics=None):
        s = ''
        if statistics and statistics['timeEst'] is not None:
            s = _("", will seed for %s"") % Duration(statistics['timeEst'])
        elif statistics:
            s = _("", will seed indefinitely."")

        if self.up_down_ratio is not None:
            done_label = _(""Done, share ratio: %d%%"") % \
                         (self.up_down_ratio*100) + s
        elif statistics is not None:
            done_label = _(""Done, %s uploaded"") % \
                         Size(statistics['upTotal']) + s
        else:
            done_label = _(""Done"")

        return done_label
        

    def set_name(self):
        self.label.set_text(self.metainfo.name)
        self.label.set_ellipsize(pango.ELLIPSIZE_END)

    def make_menu(self, extra_menu_items=[]):
        if self.menu_handler:
            self.disconnect(self.menu_handler)

        ## Basic Info
        menu_items = [ MenuItem(_(""Torrent _info""   ), func=self.open_info), ]
        open_dir_func = None
        if LaunchPath.can_launch_files and self.can_open_dir():
            open_dir_func = self.open_dir
        menu_items.append( MenuItem(_(""_Open directory"" ), func=open_dir_func) )
        filelistfunc = None
        if self.is_batch:
            filelistfunc = self.open_filelist
        menu_items.append(MenuItem(_(""_File list""), func=filelistfunc))
        if self.torrent_state == RUNNING:
            menu_items.append(MenuItem(_(""_Peer list""), func=self.open_peerlist))
        ## end Basic Info

        menu_items.append(gtk.SeparatorMenuItem())

        ## Settings
        # change save location
        change_save_location_func = None
        if self.torrent_state != RUNNING and self.completion <= 0:
            change_save_location_func = self.change_save_location
        menu_items.append(MenuItem(_(""_Change location""),
                                   func=change_save_location_func))
        # seed forever item
        self.seed_forever_item = gtk.CheckMenuItem(_(""_Seed indefinitely""))
        self.reset_seed_forever()
        def sft(widget, *args):
            active = widget.get_active()
            infohash = self.infohash
            for option in ('seed_forever', 'seed_last_forever'):
                self.main.torrentqueue.set_config(option, active, infohash)
                self.main.torrentqueue.set_config(option, active, infohash)
        self.seed_forever_item.connect('toggled', sft)
        menu_items.append(self.seed_forever_item)
        ## end Settings

        menu_items.append(gtk.SeparatorMenuItem())

        ## Queue state dependent items
        if self.torrent_state == KNOWN:
            menu_items.append( MenuItem(_(""Re_start""), func=self.move_to_end   ))
        elif self.torrent_state == QUEUED:
            #Here's where we'll put the ""Start hash check"" menu item
            menu_items.append(MenuItem(_(""Download _now""), func=self.start))            
        elif self.torrent_state in (RUNNING, RUN_QUEUED):
            # no items for here
            pass

        ## Completion dependent items
        if self.completion is not None and self.completion >= 1:
            if self.torrent_state != KNOWN:
                menu_items.append(MenuItem(_(""_Finish""), func=self.finish))
            menu_items.append( MenuItem(_(""_Remove"" ), func=self.confirm_remove))
        else:
            if self.torrent_state in (RUNNING, RUN_QUEUED):
                menu_items.append(MenuItem(_(""Download _later""), func=self.move_to_end))
            else:
                #Here's where we'll put the ""Seed _later"" menu item
                pass
            menu_items.append(MenuItem(_(""_Abort"" ), func=self.confirm_remove))

        ## build the menu
        self.menu = gtk.Menu()

        for i in menu_items:
            i.show()
            self.menu.add(i)

        self.menu_handler = self.connect_object(""event"", self.show_menu, self.menu)

    def reset_seed_forever(self):
        sfb = False
        d = self.main.torrents[self.infohash].config.getDict()
        if d.has_key('seed_forever'):
            sfb = d['seed_forever']
        self.seed_forever_item.set_active(bool(sfb))        

    def change_save_location(self, widget=None):
        self.main.change_save_location(self.infohash)

    def open_info(self, widget=None):
        if self.infowindow is None:
            self.infowindow = TorrentInfoWindow(self, self.infoclosed)
    
    def infoclosed(self, widget=None):
        self.infowindow = None

    def close_info(self):
        if self.infowindow is not None:
            self.infowindow.close()

    def open_filelist(self, widget):
        if not self.is_batch:
            return
        if self.filelistwindow is None:
            self.filelistwindow = FileListWindow(self.metainfo,
                                                 self.filelistclosed)
            self.main.torrentqueue.check_completion(self.infohash, True)

    def filelistclosed(self, widget):
        self.filelistwindow = None

    def close_filelist(self):
        if self.filelistwindow is not None:
            self.filelistwindow.close()

    def close_child_windows(self):
        self.close_info()
        self.close_filelist()

    def destroy(self):
        if self.menu is not None:
            self.menu.destroy()
        self.menu = None
        gtk.EventBox.destroy(self)

    def show_menu(self, widget, event):
        if event.type == gtk.gdk.BUTTON_PRESS and event.button == 3:
            widget.popup(None, None, None, event.button, event.time)
            return True
        return False

    def _short_path(self, dlpath):
        path_length = 40
        sep = '...'
        ret = os.path.split(dlpath)[0]
        if len(ret) > path_length+len(sep):
            return ret[:int(path_length/2)]+sep+ret[-int(path_length/2):]
        else:
            return ret

    def get_path_to_open(self):
        path = self.dlpath
        if not self.is_batch:
            path = os.path.split(self.dlpath)[0]
        return path

    def can_open_dir(self):
        return os.access(self.get_path_to_open(), os.F_OK|os.R_OK)
        
    def open_dir(self, widget):
        LaunchPath.launchdir(self.get_path_to_open())

    def confirm_remove(self, widget, event=None):
        if event is not None and event.get_state() & gtk.gdk.CONTROL_MASK:
            self.remove()
        else:
            message = _('Are you sure you want to remove ""%s""?') % self.metainfo.name
            if self.completion >= 1:
                if self.up_down_ratio is not None:
                    message = _(""Your share ratio for this torrent is %d%%. "")%(self.up_down_ratio*100) + message
                else:
                    message = _(""You have uploaded %s to this torrent. "")%(Size(self.uptotal)) + message

            d = MessageDialog(self.main.mainwindow,
                              _(""Remove this torrent?""),
                              message, 
                              type=gtk.MESSAGE_QUESTION,
                              buttons=gtk.BUTTONS_OK_CANCEL,
                              yesfunc=self.remove,
                              default=gtk.RESPONSE_OK,
                              )

    def remove(self):
        self.main.torrentqueue.remove_torrent(self.infohash)


class KnownTorrentBox(TorrentBox):

    torrent_state = KNOWN

    def __init__(self, infohash, metainfo, dlpath, completion, main):
        TorrentBox.__init__(self, infohash, metainfo, dlpath, completion, main)

        status_tip = ''
        if completion >= 1:
            self.icon.set_from_stock('bt-finished', gtk.ICON_SIZE_LARGE_TOOLBAR)
            status_tip = _(""Finished"")
            known_torrent_dnd_tip = _(""drag into list to seed"")
        else:
            self.icon.set_from_stock('bt-broken', gtk.ICON_SIZE_LARGE_TOOLBAR)
            status_tip = _(""Failed"")
            known_torrent_dnd_tip = _(""drag into list to resume"")

        self.main.tooltips.set_tip(self.iconevbox,
                                   self.torrent_tip_format % (status_tip,
                                                              known_torrent_dnd_tip,
                                                              self.torrent_menu_tip))
        self.make_menu()
        self.show_all()

    def move_to_end(self, widget):
        self.main.change_torrent_state(self.infohash, QUEUED)
        

class DroppableTorrentBox(TorrentBox):

    def __init__(self, infohash, metainfo, dlpath, completion, main):
        TorrentBox.__init__(self, infohash, metainfo, dlpath, completion, main)

        self.drag_dest_set(gtk.DEST_DEFAULT_DROP,
                           TARGET_ALL,
                           gtk.gdk.ACTION_MOVE|gtk.gdk.ACTION_COPY)

        self.connect('drag_data_received', self.drag_data_received)
        self.connect('drag_motion', self.drag_motion)
        self.index = None

    def drag_data_received(self, widget, context, x, y, selection, targetType, time):
        if targetType == BT_TARGET_TYPE:
            half_height = self.size_request()[1] // 2
            where = cmp(y, half_height)
            if where == 0: where = 1
            self.parent.put_infohash_at_child(selection.data, self, where)
        else:
            self.main.accept_dropped_file(widget, context, x, y, selection, targetType, time)
        
    def drag_motion(self, widget, context, x, y, time):
        self.get_current_index()
        half_height = self.size_request()[1] // 2
        if y < half_height: 
            self.parent.highlight_before_index(self.index)
        else:
            self.parent.highlight_after_index(self.index)
        return False

    def drag_end(self, *args):
        self.parent.highlight_child()
        TorrentBox.drag_end(self, *args)

    def get_current_index(self):
        self.index = self.parent.get_index_from_child(self)


class QueuedTorrentBox(DroppableTorrentBox):
    icon_name = 'bt-queued'
    torrent_state = QUEUED

    def __init__(self, infohash, metainfo, dlpath, completion, main):
        DroppableTorrentBox.__init__(self, infohash, metainfo, dlpath, completion, main)

        self.state_name = _(""Waiting"")
        self.main.tooltips.set_tip(self.iconevbox,
                                   self.torrent_tip_format % (self.state_name,
                                                              self.main_torrent_dnd_tip,
                                                              self.torrent_menu_tip))

        self.icon.set_from_stock(self.icon_name, gtk.ICON_SIZE_LARGE_TOOLBAR)
        self.make_menu()
        self.show_all()

    def start(self, widget):
        self.main.runbox.put_infohash_last(self.infohash)

    def finish(self, widget):
        self.main.change_torrent_state(self.infohash, KNOWN)


class PausedTorrentBox(DroppableTorrentBox):
    icon_name = 'bt-paused'
    torrent_state = RUN_QUEUED

    def __init__(self, infohash, metainfo, dlpath, completion, main):
        DroppableTorrentBox.__init__(self, infohash, metainfo, dlpath, completion, main)

        self.state_name = _(""Paused"")
        self.main.tooltips.set_tip(self.iconevbox,
                                   self.torrent_tip_format % (self.state_name,
                                                              self.main_torrent_dnd_tip,
                                                              self.torrent_menu_tip))

        self.icon.set_from_stock(self.icon_name, gtk.ICON_SIZE_LARGE_TOOLBAR)
        self.make_menu()
        self.show_all()

    def move_to_end(self, widget):
        self.main.change_torrent_state(self.infohash, QUEUED)

    def finish(self, widget):
        self.main.change_torrent_state(self.infohash, KNOWN)

    def update_status(self, statistics):
        # in case the TorrentQueue thread calls widget.update_status()
        # before the GUI has changed the torrent widget to a
        # RunningTorrentBox
        pass


class RunningTorrentBox(PausedTorrentBox):
    torrent_state = RUNNING

    def __init__(self, infohash, metainfo, dlpath, completion, main):
        DroppableTorrentBox.__init__(self, infohash, metainfo, dlpath, completion, main)

        self.main.tooltips.set_tip(self.iconevbox,
                                   self.torrent_tip_format % (_(""Running""),
                                                              self.main_torrent_dnd_tip,
                                                              self.torrent_menu_tip))

        self.seed = False
        self.peerlistwindow = None
        self.update_peer_list_flag = 0

        self.icon.set_from_stock('bt-running', gtk.ICON_SIZE_LARGE_TOOLBAR)

        self.rate_label_box = gtk.HBox(homogeneous=True)

        self.up_rate   = gtk.Label()
        self.down_rate = gtk.Label()
        self.rate_label_box.pack_start(lalign(self.up_rate  ),
                                       expand=True, fill=True)
        self.rate_label_box.pack_start(lalign(self.down_rate),
                                       expand=True, fill=True)

        self.infobox.pack_start(self.rate_label_box)        

        if advanced_ui:
            self.extrabox = gtk.VBox(homogeneous=False)
            #self.extrabox = self.vbox
            
            self.up_curr    = FancyLabel(_(""Current up: %s""  ), 0)
            self.down_curr  = FancyLabel(_(""Current down: %s""), 0)
            self.curr_box   = gtk.HBox(homogeneous=True)
            self.curr_box.pack_start(lalign(self.up_curr  ), expand=True, fill=True)
            self.curr_box.pack_start(lalign(self.down_curr), expand=True, fill=True)
            self.extrabox.pack_start(self.curr_box)
            
            self.up_prev    = FancyLabel(_(""Previous up: %s""  ), 0)
            self.down_prev  = FancyLabel(_(""Previous down: %s""), 0)
            self.prev_box   = gtk.HBox(homogeneous=True)
            self.prev_box.pack_start(lalign(self.up_prev  ), expand=True, fill=True)
            self.prev_box.pack_start(lalign(self.down_prev), expand=True, fill=True)
            self.extrabox.pack_start(self.prev_box)

            self.share_ratio = FancyLabel(_(""Share ratio: %0.02f%%""), 0)
            self.extrabox.pack_start(lalign(self.share_ratio))

            self.peer_info = FancyLabel(_(""%s peers, %s seeds. Totals from ""
                                          ""tracker: %s""), 0, 0, 'NA')
            self.extrabox.pack_start(lalign(self.peer_info))

            self.dist_copies = FancyLabel(_(""Distributed copies: %d; Next: %s""), 0, '')
            self.extrabox.pack_start(lalign(self.dist_copies))

            self.piece_info = FancyLabel(_(""Pieces: %d total, %d complete, ""
                                           ""%d partial, %d active (%d empty)""), *(0,)*5)
            self.extrabox.pack_start(lalign(self.piece_info))

            self.bad_info = FancyLabel(_(""%d bad pieces + %s in discarded requests""), 0, 0)
            self.extrabox.pack_start(lalign(self.bad_info))

            # extra info
            
            pl = self.metainfo.piece_length
            tl = self.metainfo.total_bytes
            count, lastlen = divmod(tl, pl)
            self.piece_count = count + (lastlen > 0)

            self.infobox.pack_end(self.extrabox, expand=False, fill=False)

        self.make_menu()
        self.show_all() 


    def change_to_completed(self):
        self.completion = 1.0
        self.cancelimage.set_from_stock('bt-remove', gtk.ICON_SIZE_BUTTON)
        self.main.tooltips.set_tip(self.cancelbutton,
                                   _(""Remove torrent""))

        updater_infohash = self.main.updater.infohash
        if updater_infohash == self.infohash:
            self.main.updater.start_install()

        self.make_menu()

    def close_child_windows(self):
        TorrentBox.close_child_windows(self)
        self.close_peerlist()

    def open_filelist(self, widget):
        if not self.is_batch:
            return
        if self.filelistwindow is None:
            self.filelistwindow = FileListWindow(self.metainfo,
                                                 self.filelistclosed)
            self.main.make_statusrequest()

    def open_peerlist(self, widget):
        if self.peerlistwindow is None:
            self.peerlistwindow = PeerListWindow(self.metainfo.name,
                                                 self.peerlistclosed)
            self.main.make_statusrequest()

    def peerlistclosed(self, widget):
        self.peerlistwindow = None
        self.update_peer_list_flag = 0

    def close_peerlist(self):
        if self.peerlistwindow is not None:
            self.peerlistwindow.close()

    rate_label = ': %s'
    eta_label = '?'
    done_label = _(""Done"")
    progress_bar_label = _(""%.1f%% done, %s remaining"")
    down_rate_label = _(""Download rate"")
    up_rate_label = _(""Upload rate""  )
    
    def update_status(self, statistics):
        fractionDone = statistics.get('fractionDone')
        activity = statistics.get('activity')

        self.main.set_title(torrentName=self.metainfo.name,
                            fractionDone=fractionDone)

        dt = self.downtotal
        if statistics.has_key('downTotal'):
            dt += statistics['downTotal']

        ut = self.uptotal
        if statistics.has_key('upTotal'):
            ut += statistics['upTotal']

        if dt > 0:
            self.up_down_ratio = ut / self.metainfo.total_bytes

        done_label = self.done_label
        eta_label = self.eta_label
        if 'numPeers' in statistics:
            eta = statistics.get('timeEst')
            if eta is not None:
                eta_label = Duration(eta)
            if fractionDone == 1:
                done_label = self.make_done_label(statistics)

        if fractionDone == 1:
            self.progressbar.set_fraction(1)
            self.progressbar.set_text(done_label)
            self.reset_seed_forever()
            if not self.completion >= 1:
                self.change_to_completed()
        else:
            self.progressbar.set_fraction(fractionDone)
            progress_bar_label = self.progress_bar_label % \
                                 (int(fractionDone*1000)/10, eta_label) 
            self.progressbar.set_text(progress_bar_label)
            

        if 'numPeers' not in statistics:
            return

        self.down_rate.set_text(self.down_rate_label+self.rate_label %
                                Rate(statistics['downRate']))
        self.up_rate.set_text  (self.up_rate_label+self.rate_label %
                                Rate(statistics['upRate']))

        if advanced_ui:
            if self.up_down_ratio is not None:
                self.share_ratio.set_value(self.up_down_ratio*100)

            num_seeds = statistics['numSeeds']
            if self.seed:
                num_seeds = statistics['numOldSeeds'] = 0 # !@# XXX

            if statistics['trackerPeers'] is not None:
                totals = '%d/%d' % (statistics['trackerPeers'],
                                    statistics['trackerSeeds'])
            else:
                totals = _(""NA"")
            self.peer_info.set_value(statistics['numPeers'], num_seeds, totals)

            self.up_curr.set_value(str(Size(statistics['upTotal'])))
            self.down_curr.set_value(str(Size(statistics['downTotal'])))

            self.up_prev.set_value(str(Size(self.uptotal)))
            self.down_prev.set_value(str(Size(self.downtotal)))

            # refresh extra info
            self.piece_info.set_value(self.piece_count,
                                      statistics['storage_numcomplete'],
                                      statistics['storage_dirty'],
                                      statistics['storage_active'],
                                      statistics['storage_new'] )

            self.dist_copies.set_value( statistics['numCopies'], ', '.join([""%d:%.1f%%"" % (a, int(b*1000)/10) for a, b in zip(itertools.count(int(statistics['numCopies']+1)), statistics['numCopyList'])]))

            self.bad_info.set_value(statistics['storage_numflunked'], Size(statistics['discarded']))
        
        if self.peerlistwindow is not None:
            if self.update_peer_list_flag == 0:
                spew = statistics.get('spew')
                if spew is not None:
                    self.peerlistwindow.update(spew, statistics['bad_peers'])
            self.update_peer_list_flag = (self.update_peer_list_flag + 1) % 4
        if self.filelistwindow is not None:
            if 'files_left' in statistics:
                self.filelistwindow.update(statistics['files_left'],
                                           statistics['files_allocated'])


class DroppableHSeparator(PaddedHSeparator):

    def __init__(self, box, spacing=SPACING):
        PaddedHSeparator.__init__(self, spacing)
        self.box = box
        self.main = box.main

        self.drag_dest_set(gtk.DEST_DEFAULT_DROP,
                           TARGET_ALL,
                           gtk.gdk.ACTION_MOVE|gtk.gdk.ACTION_COPY)

        self.connect('drag_data_received', self.drag_data_received)
        self.connect('drag_motion'       , self.drag_motion       )

    def drag_highlight(self):
        self.sep.drag_highlight()
        self.main.add_unhighlight_handle()

    def drag_unhighlight(self):
        self.sep.drag_unhighlight()

    def drag_data_received(self, widget, context, x, y, selection, targetType, time):
        if targetType == BT_TARGET_TYPE:
            self.box.drop_on_separator(self, selection.data)
        else:
            self.main.accept_dropped_file(widget, context, x, y, selection, targetType, time)

    def drag_motion(self, wid, context, x, y, time):
        self.drag_highlight()
        return False


class DroppableBox(HSeparatedBox):
    def __init__(self, main, spacing=0):
        HSeparatedBox.__init__(self, spacing=spacing)
        self.main = main
        self.drag_dest_set(gtk.DEST_DEFAULT_DROP,
                           TARGET_ALL,
                           gtk.gdk.ACTION_MOVE|gtk.gdk.ACTION_COPY)
        self.connect('drag_data_received', self.drag_data_received)
        self.connect('drag_motion', self.drag_motion)

    def drag_motion(self, widget, context, x, y, time):
        return False

    def drag_data_received(self, widget, context, x, y, selection, targetType, time):
        pass


class KnownBox(DroppableBox):

    def __init__(self, main, spacing=0):
        DroppableBox.__init__(self, main, spacing=spacing)
        self.drag_dest_set(gtk.DEST_DEFAULT_DROP,
                           TARGET_ALL,
                           gtk.gdk.ACTION_MOVE|gtk.gdk.ACTION_COPY)

    def pack_start(self, widget, *args, **kwargs):
        old_len = len(self.get_children())
        DroppableBox.pack_start(self, widget, *args, **kwargs)
        if old_len <= 0:
            self.main.maximize_known_pane()
        self.main.knownscroll.scroll_to_bottom()

    def remove(self, widget):
        DroppableBox.remove(self, widget)
        new_len = len(self.get_children())
        if new_len == 0:
            self.main.maximize_known_pane()

    def drag_data_received(self, widget, context, x, y, selection, targetType, time):
        if targetType == BT_TARGET_TYPE:
            infohash = selection.data
            self.main.finish(infohash)
        else:
            self.main.accept_dropped_file(widget, context, x, y, selection, targetType, time)

    def drag_motion(self, widget, context, x, y, time):
        self.main.drag_highlight(widget=self)
    
    def drag_highlight(self):
        self.main.knownscroll.drag_highlight()
        self.main.add_unhighlight_handle()

    def drag_unhighlight(self):
        self.main.knownscroll.drag_unhighlight()


class RunningAndQueueBox(gtk.VBox):

    def __init__(self, main, **kwargs):
        gtk.VBox.__init__(self, **kwargs)
        self.main = main

    def drop_on_separator(self, sep, infohash):
        self.main.change_torrent_state(infohash, QUEUED, 0)

    def highlight_between(self):
        self.drag_highlight()

    def drag_highlight(self):
        self.get_children()[1].drag_highlight()

    def drag_unhighlight(self):
        self.get_children()[1].drag_unhighlight()
        

class SpacerBox(DroppableBox):
    
    def drag_data_received(self, widget, context, x, y, selection, targetType, time):
        if targetType == BT_TARGET_TYPE:
            infohash = selection.data
            self.main.queuebox.put_infohash_last(infohash)
        else:
            self.main.accept_dropped_file(widget, context, x, y, selection, targetType, time)
            
        return True

BEFORE = -1
AFTER  =  1

class ReorderableBox(DroppableBox):

    def new_separator(self):
        return DroppableHSeparator(self)

    def __init__(self, main):
        DroppableBox.__init__(self, main)
        self.main = main

        self.drag_dest_set(gtk.DEST_DEFAULT_DROP,
                           TARGET_ALL,
                           gtk.gdk.ACTION_MOVE|gtk.gdk.ACTION_COPY)

        self.connect('drag_data_received', self.drag_data_received)
        self.connect('drag_motion'       , self.drag_motion)

    def drag_data_received(self, widget, context, x, y, selection, targetType, time):
        
        if targetType == BT_TARGET_TYPE:
            half_height = self.size_request()[1] // 2
            if y < half_height:
                self.put_infohash_first(selection.data)
            else:
                self.put_infohash_last(selection.data)
        else:
            self.main.accept_dropped_file(widget, context, x, y, selection, targetType, time)
        return True

    def drag_motion(self, widget, context, x, y, time):
        return False

    def drag_highlight(self):
        final = self.get_children()[-1]
        final.drag_highlight()
        self.main.add_unhighlight_handle()

    def drag_unhighlight(self): 
        self.highlight_child(index=None)
        self.parent.drag_unhighlight()

    def highlight_before_index(self, index):
        self.drag_unhighlight()
        children = self._get_children()
        if index > 0:
            children[index*2 - 1].drag_highlight()
        else:
            self.highlight_at_top()

    def highlight_after_index(self, index):
        self.drag_unhighlight()
        children = self._get_children()
        if index*2 < len(children)-1:
            children[index*2 + 1].drag_highlight()
        else:
            self.highlight_at_bottom()

    def highlight_child(self, index=None):
        for i, child in enumerate(self._get_children()):
            if index is not None and i == index*2:
                child.drag_highlight()
            else:
                child.drag_unhighlight()


    def drop_on_separator(self, sep, infohash):
        children = self._get_children()
        for i, child in enumerate(children):
            if child == sep:
                reference_child = children[i-1]
                self.put_infohash_at_child(infohash, reference_child, AFTER)
                break


    def get_queue(self):
        queue = []
        c = self.get_children()
        for t in c:
            queue.append(t.infohash)
        return queue

    def put_infohash_first(self, infohash):
        self.highlight_child()
        children = self.get_children()
        if len(children) > 1 and infohash == children[0].infohash:
            return
        
        self.put_infohash_at_index(infohash, 0)

    def put_infohash_last(self, infohash):
        self.highlight_child()
        children = self.get_children()
        end = len(children)
        if len(children) > 1 and infohash == children[end-1].infohash:
            return

        self.put_infohash_at_index(infohash, end)

    def put_infohash_at_child(self, infohash, reference_child, where):
        self.highlight_child()
        if infohash == reference_child.infohash:
            return
        
        target_index = self.get_index_from_child(reference_child)
        if where == AFTER:
            target_index += 1
        self.put_infohash_at_index(infohash, target_index)

    def get_index_from_child(self, child):
        c = self.get_children()
        ret = -1
        try:
            ret = c.index(child)
        except ValueError:
            pass
        return ret

    def highlight_at_top(self):
        raise NotImplementedError

    def highlight_at_bottom(self):
        raise NotImplementedError

    def put_infohash_at_index(self, infohash, end):
        raise NotImplementedError

class RunningBox(ReorderableBox):

    def put_infohash_at_index(self, infohash, target_index):
        #print 'RunningBox.put_infohash_at_index', infohash.encode('hex')[:8], target_index

        l = self.get_queue()
        replaced = None
        if l:
            replaced = l[-1]
        self.main.confirm_replace_running_torrent(infohash, replaced,
                                                  target_index)

    def highlight_at_top(self):
        pass
        # BUG: Don't know how I will indicate in the UI that the top of the list is highlighted

    def highlight_at_bottom(self):
        self.parent.highlight_between()


class QueuedBox(ReorderableBox):

    def put_infohash_at_index(self, infohash, target_index):
        #print 'want to put', infohash.encode('hex'), 'at', target_index
        self.main.change_torrent_state(infohash, QUEUED, target_index)

    def highlight_at_top(self):
        self.parent.highlight_between()

    def highlight_at_bottom(self):
        pass
        # BUG: Don't know how I will indicate in the UI that the bottom of the list is highlighted



class Struct(object):
    pass


class SearchField(gtk.Entry):
    def __init__(self, default_text, visit_url_func):
        gtk.Entry.__init__(self)
        self.default_text = default_text
        self.visit_url_func = visit_url_func
        self.set_text(self.default_text)
        self.set_size_request(150, -1)

        # default gtk Entry dnd processing is broken on linux!
        #  - default Motion handling causes asyncs
        #  - there's no way to filter the default text dnd
        # see the parent window for a very painful work-around
        self.drag_dest_unset()
        
        self.connect('key-press-event', self.check_for_enter)
        self.connect('button-press-event', self.begin_edit)
        self.search_completion = gtk.EntryCompletion()
        self.search_completion.set_text_column(0)
        self.search_store = gtk.ListStore(gobject.TYPE_STRING)
        self.search_completion.set_model(self.search_store)
        self.set_completion(self.search_completion)
        self.reset_text()
        self.timeout_id = None

    def begin_edit(self, *args):
        if self.get_text() == self.default_text:
            self.set_text('')

    def check_for_enter(self, widget, event):
        if event.keyval in (gtk.keysyms.Return, gtk.keysyms.KP_Enter):
            self.search()

    def reset_text(self):
        self.set_text(self.default_text)

    def search(self, *args):
        search_term = self.get_text()
        if search_term and search_term != self.default_text:
            self.search_store.append([search_term])
            search_url = SEARCH_URL % {'query' :zurllib.quote(search_term),
                                       'client':'M-%s'%version.replace('.','-')}
            
            self.timeout_id = gobject.timeout_add(2000, self.resensitize)
            self.set_sensitive(False)
            self.visit_url_func(search_url, callback=self.resensitize)
        else:
            self.reset_text()
            self.select_region(0, -1)
            self.grab_focus()

    def resensitize(self):
        self.set_sensitive(True)
        self.reset_text()
        if self.timeout_id is not None:
            gobject.source_remove(self.timeout_id)
            self.timeout_id = None


class DownloadInfoFrame(object):

    def __init__(self, config, torrentqueue):
        self.config = config
        if self.config['save_in'] == '':
           self.config['save_in'] = smart_dir('')
        
        self.torrentqueue = torrentqueue
        self.torrents = {}
        self.running_torrents = {}
        self.lists = {}
        self.update_handle = None
        self.unhighlight_handle = None
        self.custom_size = False
        self.child_windows = {}
        self.postponed_save_windows = []
        self.helpwindow     = None
        self.errordialog    = None

        self.mainwindow = Window(gtk.WINDOW_TOPLEVEL)

        #tray icon
        self.trayicon = TrayIcon(not self.config['start_minimized'],
                                 toggle_func=self.toggle_shown,
                                 quit_func=self.quit)
        self.traythread = threading.Thread(target=self.trayicon.enable,
                                           args=())
        self.traythread.setDaemon(True)

        if os.name == ""nt"":
            # gtk has no way to check this?
            self.iconized = False
            self.mainwindow.connect('window-state-event', self.window_event) 

        if self.config['start_minimized']:
            self.mainwindow.iconify()
       
        gtk.threads_enter()

        self.mainwindow.set_border_width(0)

        self.set_seen_remote_connections(False)
        self.set_seen_connections(False)

        self.mainwindow.drag_dest_set(gtk.DEST_DEFAULT_ALL,
                                      TARGET_EXTERNAL,
                                      gtk.gdk.ACTION_MOVE|gtk.gdk.ACTION_COPY)

        self.mainwindow.connect('drag_leave'        , self.drag_leave         )
        self.mainwindow.connect('drag_data_received', self.accept_dropped_file)

        self.mainwindow.set_size_request(WINDOW_WIDTH, -1)

        self.mainwindow.connect('destroy', self.cancel)

        self.mainwindow.connect('size-allocate', self.size_was_allocated)

        self.accel_group = gtk.AccelGroup()

        self.mainwindow.add_accel_group(self.accel_group)

        #self.accel_group.connect(ord('W'), gtk.gdk.CONTROL_MASK, gtk.ACCEL_LOCKED,
        #                         lambda *args: self.mainwindow.destroy())

        self.tooltips = gtk.Tooltips()

        self.logbuffer = LogBuffer()
        self.log_text(_(""%s started"")%app_name, severity=None)

        self.box1 = gtk.VBox(homogeneous=False, spacing=0)

        self.box2 = gtk.VBox(homogeneous=False, spacing=0)
        self.box2.set_border_width(SPACING)

        self.menubar = gtk.MenuBar()
        self.box1.pack_start(self.menubar, expand=False, fill=False)

        self.ssbutton = StopStartButton(self)

        # keystrokes used: A D F H L N O P Q S U X (E)

        quit_menu_label = _(""_Quit"")
        if os.name == 'nt':
            quit_menu_label = _(""E_xit"")
        
        file_menu_items = ((_(""_Open torrent file""), self.select_torrent_to_open),
                           (_(""Open torrent _URL""), self.enter_url_to_open),
                           (_(""Make _new torrent"" ), self.make_new_torrent),

                           ('----'          , None),
                           (_(""_Pause/Play""), self.ssbutton.toggle),
                           ('----'          , None),
                           (quit_menu_label , lambda w: self.mainwindow.destroy()),
                           )
        view_menu_items = ((_(""Show/Hide _finished torrents""), self.toggle_known),
                           # BUG: if you reorder this menu, see def set_custom_size() first
                           (_(""_Resize window to fit""), lambda w: self.resize_to_fit()),
                           ('----'             , None),
                           (_(""_Log"")          , lambda w: self.open_window('log')),
                           # 'View log of all download activity',
                           #('----'            , None),
                           (_(""_Settings"")     , lambda w: self.open_window('settings')),
                           #'Change download behavior and network settings',
                           )
        help_menu_items = ((_(""_Help"")         , self.open_help),
                           #(_(""_Help Window"") , lambda w: self.open_window('help')),
                           (_(""_About"")         , lambda w: self.open_window('about')),
                           (_(""_Donate"")        , lambda w: self.donate()),
                           #(_(""Rais_e"")        , lambda w: self.raiseerror()), 
                           )
        
        self.filemenu = gtk.MenuItem(_(""_File""))

        self.filemenu.set_submenu(build_menu(file_menu_items, self.accel_group))
        self.filemenu.show()

        self.viewmenu = gtk.MenuItem(_(""_View""))
        self.viewmenu.set_submenu(build_menu(view_menu_items, self.accel_group))
        self.viewmenu.show()

        self.helpmenu = gtk.MenuItem(_(""_Help""))
        self.helpmenu.set_submenu(build_menu(help_menu_items, self.accel_group))
        self.helpmenu.show()

        if os.name != 'nt':
            self.helpmenu.set_right_justified(True)

        self.menubar.append(self.filemenu)
        self.menubar.append(self.viewmenu)
        self.menubar.append(self.helpmenu)
        
        self.menubar.show()

        self.header = gtk.HBox(homogeneous=False)

        self.box1.pack_start(self.box2, expand=False, fill=False)

        # control box: rate slider, start-stop button, search widget, status light
        self.controlbox = gtk.HBox(homogeneous=False)

        controlbox_padding = SPACING//2

        # stop-start button
        self.controlbox.pack_start(malign(self.ssbutton),
                                   expand=False, fill=False)

        # rate slider
        self.rate_slider_box = RateSliderBox(self.config, self.torrentqueue)
        self.controlbox.pack_start(self.rate_slider_box,
                                   expand=True, fill=True,
                                   padding=controlbox_padding)

        self.controlbox.pack_start(gtk.VSeparator(), expand=False, fill=False,
                                   padding=controlbox_padding)

        # search box 
        self.search_field = SearchField(_(""Search for torrents""), self.visit_url)
        sfa = gtk.Alignment(xalign=0, yalign=0.5, xscale=1, yscale=0)
        sfa.add(self.search_field)
        self.controlbox.pack_start(sfa,
                                   expand=False, fill=False, padding=controlbox_padding)

        # separator
        self.controlbox.pack_start(gtk.VSeparator(), expand=False, fill=False,
                                   padding=controlbox_padding)

        # status light
        self.status_light = StatusLight(self)

        self.controlbox.pack_start(malign(self.status_light),
                                   expand=False, fill=False)

        self.box2.pack_start(self.controlbox,
                             expand=False, fill=False, padding=0)
        # end control box

        self.paned = gtk.VPaned()

        self.knownscroll = ScrolledWindow()
        self.knownscroll.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_ALWAYS)
        self.knownscroll.set_shadow_type(gtk.SHADOW_NONE)
        self.knownscroll.set_size_request(-1, SPACING)

        self.knownbox = KnownBox(self)
        self.knownbox.set_border_width(SPACING)

        self.knownscroll.add_with_viewport(self.knownbox)
        self.paned.pack1(self.knownscroll, resize=False, shrink=True)

        
        self.mainscroll = AutoScrollingWindow()
        self.mainscroll.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_ALWAYS)
        self.mainscroll.set_shadow_type(gtk.SHADOW_NONE)
        self.mainscroll.set_size_request(-1, SPACING)

        self.scrollbox = RunningAndQueueBox(self, homogeneous=False)
        self.scrollbox.set_border_width(SPACING)
        
        self.runbox = RunningBox(self)
        self.scrollbox.pack_start(self.runbox, expand=False, fill=False)

        self.scrollbox.pack_start(DroppableHSeparator(self.scrollbox), expand=False, fill=False)

        self.queuebox = QueuedBox(self)
        self.scrollbox.pack_start(self.queuebox, expand=False, fill=False)

        self.scrollbox.pack_start(SpacerBox(self), expand=True, fill=True) 

        self.mainscroll.add_with_viewport(self.scrollbox)

        self.paned.pack2(self.mainscroll, resize=True, shrink=False)

        self.box1.pack_start(self.paned)

        self.box1.show_all()

        self.mainwindow.add(self.box1)

        self.set_title()
        self.set_size()
        
        self.mainwindow.show()
        
        self.paned.set_position(0)
        self.search_field.grab_focus()

        self.updater = NewVersion.Updater(
            gtk_wrap, 
            self.new_version, 
            self.torrentqueue.start_new_torrent,
            self.confirm_install_new_version   ,
            self.global_error                  ,
            self.config['new_version']         ,
            self.config['current_version']     )

        self.nag()
        
        gtk.threads_leave()

    def window_event(self, widget, event, *args):
        if event.changed_mask == gtk.gdk.WINDOW_STATE_ICONIFIED:
            if self.config['minimize_to_tray']:
                if self.iconized == False:
                    self.mainwindow.hide()
            self.trayicon.set_toggle_state(self.iconized)
            self.iconized = not self.iconized

    def drag_leave(self, *args):
        self.drag_end()

    def make_new_torrent(self, widget=None):
        btspawn(self.torrentqueue, 'maketorrent')

    def accept_dropped_file(self, widget, context, x, y, selection,
                            targetType, time):
        if targetType == EXTERNAL_FILE_TYPE:
            d = selection.data.strip()
            file_uris = d.split('\r\n')
            for file_uri in file_uris:
                # this catches non-url entries, I've seen ""\x00"" at the end of lists
                if file_uri.find(':/') != -1:
                    file_name = zurllib.url2pathname(file_uri)
                    file_name = file_name[7:]
                    if os.name == 'nt':
                        file_name = file_name.strip('\\')
                    self.open_torrent( file_name )
        elif targetType == EXTERNAL_STRING_TYPE:

            data = selection.data.strip()

            # size must be > 0,0 for the intersection code to register it
            drop_rect = gtk.gdk.Rectangle(x, y, 1, 1)
            if ((self.search_field.intersect(drop_rect) is not None) and
                (not data.lower().endswith("".torrent""))):

                client_point = self.mainwindow.translate_coordinates(self.search_field, x, y)
                layout_offset = self.search_field.get_layout_offsets()
                point = []
                # subtract (not add) the offset, because we're hit-testing the layout, not the widget
                point.append(client_point[0] - layout_offset[0])
                point.append(client_point[1] - layout_offset[1])
                # ha ha ha. pango is so ridiculous
                point[0] *= pango.SCALE
                point[1] *= pango.SCALE
                layout = self.search_field.get_layout()
                position = layout.xy_to_index(*point)
                self.search_field.insert_text(data, position[0])
            else:                    
                self.open_url(data)

    def drag_highlight(self, widget=None):
        widgets = (self.knownbox, self.runbox, self.queuebox) 
        for w in widgets:
            if w != widget:
                w.drag_unhighlight()
        for w in widgets:
            if w == widget:
                w.drag_highlight()
                self.add_unhighlight_handle()

    def drag_end(self):
        self.drag_highlight(widget=None)
        self.mainscroll.stop_scrolling()

    def set_title(self, torrentName=None, fractionDone=None):
        title = app_name
        trunc = '...'
        sep = ': '

        if self.config['pause']:
            title += sep+_(""(stopped)"")
        elif len(self.running_torrents) == 1 and torrentName and \
               fractionDone is not None:
            maxlen = WINDOW_TITLE_LENGTH - len(app_name) - len(trunc) - len(sep)
            if len(torrentName) > maxlen:
                torrentName = torrentName[:maxlen] + trunc
            title = '%s%s%0.1f%%%s%s'% (app_name,
                                            sep,
                                            (int(fractionDone*1000)/10),
                                            sep,
                                            torrentName)
        elif len(self.running_torrents) > 1:
            title += sep+_(""(multiple)"")

        if self.mainwindow.get_title() != title:
            self.mainwindow.set_title(title)
        if self.trayicon.get_tooltip() != title:
            self.trayicon.set_tooltip(title)

    def _guess_size(self):
        paned_height = self.scrollbox.size_request()[1]
        if hasattr(self.paned, 'style_get_property'):
            paned_height += self.paned.style_get_property('handle-size')
        else:
            paned_height += 5
        paned_height += self.paned.get_position()
        paned_height += 4 # fudge factor, probably from scrolled window beveling ?
        paned_height = max(paned_height, MIN_MULTI_PANE_HEIGHT)

        new_height = self.menubar.size_request()[1] + \
                     self.box2.size_request()[1] + \
                     paned_height
        new_height = min(new_height, MAX_WINDOW_HEIGHT)
        new_width = max(self.scrollbox.size_request()[0] + SCROLLBAR_WIDTH, WINDOW_WIDTH)
        return new_width, new_height

    def set_size(self):
        if not self.custom_size:
            self.mainwindow.resize(*self._guess_size())

    def size_was_allocated(self, *args):
        current_size = self.mainwindow.get_size()
        target_size = self._guess_size()
        if current_size == target_size:
            self.set_custom_size(False)
        else:
            self.set_custom_size(True)

    def resize_to_fit(self):
        self.set_custom_size(False)
        self.set_size()

    def set_custom_size(self, val):
        self.custom_size = val
        # BUG this is a hack:
        self.viewmenu.get_submenu().get_children()[1].set_sensitive(val)

    # BUG need to add handler on resize event to keep track of
    # old_position when pane is hidden manually
    def split_pane(self):
        pos = self.paned.get_position()
        if pos > 0:
            self.paned.old_position = pos
            self.paned.set_position(0)
        else:
            if hasattr(self.paned, 'old_position'):
                self.paned.set_position(self.paned.old_position)
            else:
                self.maximize_known_pane()

    def maximize_known_pane(self):
        self.set_pane_position(self.knownbox.size_request()[1])        

    def set_pane_position(self, pane_position):
            pane_position = min(MAX_WINDOW_HEIGHT//2, pane_position)
            self.paned.set_position(pane_position)

    def toggle_known(self, widget=None):
        self.split_pane()

    def open_window(self, window_name, *args, **kwargs):
        if os.name == 'nt':
            self.mainwindow.present()
        savewidget = SaveFileSelection
        if window_name == 'savedir':
            savewidget = CreateFolderSelection
            window_name = 'savefile'
        if self.child_windows.has_key(window_name):
            if window_name == 'savefile':
                kwargs['show'] = False
                self.postponed_save_windows.append(savewidget(self, **kwargs))
            return

        if window_name == 'log'       :
            self.child_windows[window_name] = LogWindow(self, self.logbuffer, self.config)
        elif window_name == 'about'   :
            self.child_windows[window_name] = AboutWindow(self, lambda w: self.donate())
        elif window_name == 'help'    :
            self.child_windows[window_name] = HelpWindow(self, makeHelp('bittorrent', defaults))
        elif window_name == 'settings':
            self.child_windows[window_name] = SettingsWindow(self, self.config, self.set_config)
        elif window_name == 'version' :
            self.child_windows[window_name] = VersionWindow(self, *args)
        elif window_name == 'openfile':
            self.child_windows[window_name] = OpenFileSelection(self, **kwargs)
        elif window_name == 'savefile':
            self.child_windows[window_name] = savewidget(self, **kwargs)
        elif window_name == 'choosefolder':
            self.child_windows[window_name] = ChooseFolderSelection(self, **kwargs)            
        elif window_name == 'enterurl':
            self.child_windows[window_name] = EnterUrlDialog(self, **kwargs)

        return self.child_windows[window_name]

    def window_closed(self, window_name):
        if self.child_windows.has_key(window_name):
            del self.child_windows[window_name]
        if window_name == 'savefile' and self.postponed_save_windows:
            newwin = self.postponed_save_windows.pop(-1)
            newwin.show()
            self.child_windows['savefile'] = newwin
    
    def close_window(self, window_name):
        self.child_windows[window_name].close(None)

    def new_version(self, newversion, download_url):
        if not self.config['notified'] or \
               newversion != NewVersion.Version.from_str(self.config['notified']):
            if not self.torrents.has_key(self.updater.infohash):
                self.open_window('version', newversion, download_url)
            else:
                dlpath = os.path.split(self.torrents[self.updater.infohash].dlpath)[0]
                self.updater.set_installer_dir(dlpath)
                self.updater.start_install()

    def check_version(self):
        self.updater.check() 

    def start_auto_update(self):
        if not self.torrents.has_key(self.updater.infohash):
            self.updater.download()
        else:
            self.global_error(INFO, _(""Already downloading %s installer"") % self.updater.version)

    def confirm_install_new_version(self):
        MessageDialog(self.mainwindow,
                      _(""Install new %s now?"")%app_name,
                      _(""Do you want to quit %s and install the new version, ""
                        ""%s, now?"")%(app_name,self.updater.version),
                      type=gtk.MESSAGE_QUESTION,
                      buttons=gtk.BUTTONS_YES_NO,
                      yesfunc=self.install_new_version,
                      nofunc=None,
                      default=gtk.RESPONSE_YES
                      )

    def install_new_version(self):
        self.updater.launch_installer(self.torrentqueue)
        self.cancel()
        

    def open_help(self,widget):
        if self.helpwindow is None:
            msg = (_(""%s help is at \n%s\nWould you like to go there now?"")%
                  (app_name, HELP_URL))
            self.helpwindow = MessageDialog(self.mainwindow,
                                            _(""Visit help web page?""),
                                            msg,
                                            type=gtk.MESSAGE_QUESTION,
                                            buttons=gtk.BUTTONS_OK_CANCEL,
                                            yesfunc=self.visit_help,
                                            nofunc =self.help_closed,
                                            default=gtk.RESPONSE_OK
                                            )

    def visit_help(self):
        self.visit_url(HELP_URL)
        self.help_closed()
        
    def close_help(self):
        self.helpwindow.close()

    def help_closed(self, widget=None):
        self.helpwindow = None


    def set_config(self, option, value):
        self.config[option] = value
        if option == 'display_interval':
            self.init_updates()
        self.torrentqueue.set_config(option, value)


    def confirm_remove_finished_torrents(self,widget):
        count = 0
        for infohash, t in self.torrents.iteritems():
            if t.state == KNOWN and t.completion >= 1:
                count += 1
        if count:
            if self.paned.get_position() == 0:
                self.toggle_known()
            msg = ''
            if count == 1:
                msg = _(""There is one finished torrent in the list. "") + \
                      _(""Do you want to remove it?"")
            else:
                msg = _(""There are %d finished torrents in the list. "") % count +\
                      _(""Do you want to remove all of them?"")
            MessageDialog(self.mainwindow,
                          _(""Remove all finished torrents?""),
                          msg,
                          type=gtk.MESSAGE_QUESTION,
                          buttons=gtk.BUTTONS_OK_CANCEL,
                          yesfunc=self.remove_finished_torrents,
                          default=gtk.RESPONSE_OK)
        else:
            MessageDialog(self.mainwindow,
                          _(""No finished torrents""),
                          _(""There are no finished torrents to remove.""),
                          type=gtk.MESSAGE_INFO,
                          default=gtk.RESPONSE_OK)

    def remove_finished_torrents(self):
        for infohash, t in self.torrents.iteritems():
            if t.state == KNOWN and t.completion >= 1:
                self.torrentqueue.remove_torrent(infohash)
        if self.paned.get_position() > 0:
            self.toggle_known()

    def cancel(self, widget=None):
        for window_name in self.child_windows.keys():
            self.close_window(window_name)
        
        if self.errordialog is not None:
            self.errordialog.destroy()
            self.errors_closed()

        for t in self.torrents.itervalues():
            if t.widget is not None:
                t.widget.close_child_windows()

        self.torrentqueue.set_done()
        gtk.main_quit()

    # Currently called if the user started bittorrent from a terminal
    # and presses ctrl-c there, or if the user quits BitTorrent from
    # the tray icon (on windows)   
    def quit(self):
        self.mainwindow.destroy()

    def make_statusrequest(self):
        if self.config['pause']:
            return True
        for infohash, t in self.running_torrents.iteritems():
            self.torrentqueue.request_status(infohash, t.widget.peerlistwindow
                             is not None, t.widget.filelistwindow is not None)
        if not len(self.running_torrents):
            self.status_light.send_message('empty')
        return True

    def enter_url_to_open(self, widget): 
        self.open_window('enterurl')

    def open_url(self, url):
        self.torrentqueue.start_new_torrent_by_name(url)

    def select_torrent_to_open(self, widget):
        open_location = self.config['open_from']
        if not open_location:
            open_location = self.config['save_in']
        path = smart_dir(open_location) 
        self.open_window('openfile',
                         title=_(""Open torrent:""),
                         fullname=path,
                         got_location_func=self.open_torrent,
                         no_location_func=lambda: self.window_closed('openfile'))


    def open_torrent(self, name):
        self.window_closed('openfile')
        open_location = os.path.split(name)[0]
        if open_location[-1] != os.sep:
            open_location += os.sep
        self.set_config('open_from',  open_location)

        self.torrentqueue.start_new_torrent_by_name(name)

    def change_save_location(self, infohash):
        def no_location():
            self.window_closed('savefile')

        t = self.torrents[infohash]
        metainfo = t.metainfo
        
        selector = self.open_window(metainfo.is_batch and 'savedir' or \
                                                          'savefile',
                      title=_(""Change save location for "") + metainfo.name,
                      fullname=t.dlpath,
                      got_location_func = \
                            lambda fn: self.got_changed_location(infohash, fn),
                      no_location_func=no_location)

    def got_changed_location(self, infohash, fullpath):
        self.window_closed('savefile')
        self.torrentqueue.set_save_location(infohash, fullpath)

    def save_location(self, infohash, metainfo):
        name = metainfo.name_fs

        if self.config['save_as'] and \
               os.access(os.path.split(self.config['save_as'])[0], os.W_OK):
            path = self.config['save_as']
            self.got_location(infohash, path, store_in_config=False)
            self.config['save_as'] = ''
            return

        path = smart_dir(self.config['save_in'])

        fullname = os.path.join(path, name)

        if not self.config['ask_for_save']:
            if os.access(fullname, os.F_OK):
                message = MessageDialog(self.mainwindow,
                                        _(""File exists!""),
                                        _('""%s"" already exists. '
                                          ""Do you want to choose a different file name?"") % path_wrap(name),
                                        buttons=gtk.BUTTONS_YES_NO,
                                        nofunc= lambda : self.got_location(infohash, fullname),
                                        yesfunc=lambda : self.get_save_location(infohash, metainfo, fullname),
                                        default=gtk.RESPONSE_NO)

            else:
                self.got_location(infohash, fullname)
        else:
            self.get_save_location(infohash, metainfo, fullname)

    def get_save_location(self, infohash, metainfo, fullname):
        def no_location():
            self.window_closed('savefile')
            self.torrentqueue.remove_torrent(infohash)

        selector = self.open_window(metainfo.is_batch and 'savedir' or \
                                                          'savefile',
                                    title=_(""Save location for "") + metainfo.name,
                                    fullname=fullname,
                                    got_location_func = lambda fn: \
                                              self.got_location(infohash, fn),
                                    no_location_func=no_location)
        
        self.torrents[infohash].widget = selector

    def got_location(self, infohash, fullpath, store_in_config=True):
        self.window_closed('savefile')
        self.torrents[infohash].widget = None
        save_in = os.path.split(fullpath)[0]

        metainfo = self.torrents[infohash].metainfo
        if metainfo.is_batch:
            bottom_dirs, top_dir_name = os.path.split(save_in)
            if metainfo.name_fs == top_dir_name:

                message = MessageDialog(self.mainwindow, _(""Directory exists!""),
                                        _('""%s"" already exists.'\
                                          "" Do you intend to create an identical,""\
                                          "" duplicate directory inside the existing""\
                                          "" directory?"")%path_wrap(save_in),
                                        buttons=gtk.BUTTONS_YES_NO,
                                        nofunc =lambda : self.got_location(infohash, save_in ),
                                        yesfunc=lambda : self._got_location(infohash, save_in, fullpath, store_in_config=store_in_config),
                                        default=gtk.RESPONSE_NO,
                                        )
                return
        self._got_location(infohash, save_in, fullpath, store_in_config=store_in_config)

    def _got_location(self, infohash, save_in, fullpath, store_in_config=True):
        if store_in_config:
            if save_in[-1] != os.sep:
                save_in += os.sep
            self.set_config('save_in', save_in)
        self.torrents[infohash].dlpath = fullpath
        self.torrentqueue.set_save_location(infohash, fullpath)

    def add_unhighlight_handle(self):
        if self.unhighlight_handle is not None:
            gobject.source_remove(self.unhighlight_handle)
            
        self.unhighlight_handle = gobject.timeout_add(2000,
                                                      self.unhighlight_after_a_while,
                                                      priority=gobject.PRIORITY_LOW)

    def unhighlight_after_a_while(self):
        self.drag_highlight()
        gobject.source_remove(self.unhighlight_handle)
        self.unhighlight_handle = None
        return False

    def init_updates(self):
        if self.update_handle is not None:
            gobject.source_remove(self.update_handle)
        self.update_handle = gobject.timeout_add(
            int(self.config['display_interval'] * 1000),
            self.make_statusrequest)

    def remove_torrent_widget(self, infohash):
        t = self.torrents[infohash]
        self.lists[t.state].remove(infohash)
        if t.state == RUNNING:
            del self.running_torrents[infohash]
            self.set_title()
        if t.state == ASKING_LOCATION:
            if t.widget is not None:
                t.widget.destroy()
            return

        if t.state in (KNOWN, RUNNING, QUEUED):
            t.widget.close_child_windows()

        if t.state == RUNNING:
            self.runbox.remove(t.widget)
        elif t.state == QUEUED:
            self.queuebox.remove(t.widget)
        elif t.state == KNOWN:
            self.knownbox.remove(t.widget)
            
        t.widget.destroy()

        self.set_size()

    def create_torrent_widget(self, infohash, queuepos=None):
        t = self.torrents[infohash]
        l = self.lists.setdefault(t.state, [])
        if queuepos is None:
            l.append(infohash)
        else:
            l.insert(queuepos, infohash)
        if t.state == ASKING_LOCATION:
            self.save_location(infohash, t.metainfo)
            self.nag()
            return
        elif t.state == RUNNING:
            self.running_torrents[infohash] = t
            if not self.config['pause']:
                t.widget = RunningTorrentBox(infohash, t.metainfo, t.dlpath,
                                             t.completion, self)
            else:
                t.widget = PausedTorrentBox(infohash, t.metainfo, t.dlpath,
                                             t.completion, self)
            box = self.runbox
        elif t.state == QUEUED:
            t.widget = QueuedTorrentBox(infohash, t.metainfo, t.dlpath,
                                        t.completion, self)
            box = self.queuebox
        elif t.state == KNOWN:
            t.widget = KnownTorrentBox(infohash, t.metainfo, t.dlpath,
                                       t.completion, self)
            box = self.knownbox
        box.pack_start(t.widget, expand=False, fill=False)
        if queuepos is not None:
            box.reorder_child(t.widget, queuepos)

        self.set_size()

    def log_text(self, text, severity=ERROR):
        self.logbuffer.log_text(text, severity)
        if self.child_windows.has_key('log'):
            self.child_windows['log'].scroll_to_end()

    def _error(self, severity, err_str):
        err_str = err_str.decode('utf-8', 'replace').encode('utf-8')
        err_str = err_str.strip()
        if severity >= ERROR:
            self.error_modal(err_str)
        self.log_text(err_str, severity)

    def error(self, infohash, severity, text):
        if self.torrents.has_key(infohash):
            name = self.torrents[infohash].metainfo.name
            err_str = '""%s"" : %s'%(name,text)
            self._error(severity, err_str)
        else:
            ihex = infohash.encode('hex')
            err_str = '""%s"" : %s'%(ihex,text)
            self._error(severity, err_str)
            self._error(WARNING, 'Previous error raised for invalid infohash: ""%s""' % ihex)

    def global_error(self, severity, text):
        err_str = _(""(global message) : %s"")%text
        self._error(severity, err_str)

    def error_modal(self, text):
        if self.child_windows.has_key('log'):
            return

        title = _(""%s Error"") % app_name
        
        if self.errordialog is not None:
            if not self.errordialog.multi:
                self.errordialog.destroy()
                self.errordialog = MessageDialog(self.mainwindow, title, 
                                                 _(""Multiple errors have occurred. ""
                                                   ""Click OK to view the error log.""),
                                                 buttons=gtk.BUTTONS_OK_CANCEL,
                                                 yesfunc=self.multiple_errors_yes,
                                                 nofunc=self.errors_closed,
                                                 default=gtk.RESPONSE_OK
                                                 )
                self.errordialog.multi = True
            else:
                # already showing the multi error dialog, so do nothing
                pass
        else:
            self.errordialog = MessageDialog(self.mainwindow, title, text,
                                             yesfunc=self.errors_closed,
                                             default=gtk.RESPONSE_OK)
            self.errordialog.multi = False


    def multiple_errors_yes(self):
        self.errors_closed()
        self.open_window('log')

    def errors_closed(self):
        self.errordialog = None

    def open_log(self):
        self.open_window('log')

    def stop_queue(self):
        self.set_config('pause', True)
        self.set_title()
        self.status_light.send_message('stop')
        self.set_seen_remote_connections(False)
        self.set_seen_connections(False)
        q = list(self.runbox.get_queue())
        for infohash in q:
            t = self.torrents[infohash]
            self.remove_torrent_widget(infohash)
            self.create_torrent_widget(infohash)

    def restart_queue(self):
        self.set_config('pause', False)
        q = list(self.runbox.get_queue())
        for infohash in q:
            t = self.torrents[infohash]
            self.remove_torrent_widget(infohash)
            self.create_torrent_widget(infohash)
        self.start_status_light()

    def start_status_light(self):
        if len(self.running_torrents):
            self.status_light.send_message('start')
        else:
            self.status_light.send_message('empty')

    def update_status(self, torrent, statistics):
        if self.config['pause']:
            self.status_light.send_message('start')
            return

        if self.seen_remote_connections:
            self.status_light.send_message('seen_remote_peers')
        elif self.seen_connections:
            self.status_light.send_message('seen_peers')
        else:
            self.start_status_light()
        
        self.running_torrents[torrent].widget.update_status(statistics)
        if statistics.get('numPeers'):
            self.set_seen_connections(seen=True)
        if (not self.seen_remote_connections and
            statistics.get('ever_got_incoming')):
            self.set_seen_remote_connections(seen=True)
        if self.updater is not None:
            updater_infohash = self.updater.infohash
            if self.torrents.has_key(updater_infohash):
                updater_torrent = self.torrents[updater_infohash]
                if updater_torrent.state == QUEUED:
                    self.change_torrent_state(updater_infohash, RUNNING,
                                              index=0, replaced=0,
                                              force_running=True)

    def set_seen_remote_connections(self, seen=False):
        if seen:
            self.status_light.send_message('seen_remote_peers')
        self.seen_remote_connections = seen

    def set_seen_connections(self, seen=False):
        if seen:
            self.status_light.send_message('seen_peers')
        self.seen_connections = seen

    def new_displayed_torrent(self, infohash, metainfo, dlpath, state, config,
                              completion=None, uptotal=0, downtotal=0):
        t = Struct()
        t.metainfo = metainfo
        t.dlpath = dlpath
        t.state = state
        t.config = config
        t.completion = completion
        t.uptotal = uptotal
        t.downtotal = downtotal
        t.widget = None
        self.torrents[infohash] = t
        self.create_torrent_widget(infohash)

    def torrent_state_changed(self, infohash, dlpath, state, completion,
                              uptotal, downtotal, queuepos=None):
        t = self.torrents[infohash]
        self.remove_torrent_widget(infohash)
        t.dlpath = dlpath
        t.state = state
        t.completion = completion
        t.uptotal = uptotal
        t.downtotal = downtotal
        self.create_torrent_widget(infohash, queuepos)

    def reorder_torrent(self, infohash, queuepos):
        self.remove_torrent_widget(infohash)
        self.create_torrent_widget(infohash, queuepos)

    def update_completion(self, infohash, completion, files_left=None,
                          files_allocated=None):
        t = self.torrents[infohash]
        if files_left is not None and t.widget.filelistwindow is not None:
            t.widget.filelistwindow.update(files_left, files_allocated)

    def removed_torrent(self, infohash):
        self.remove_torrent_widget(infohash)
        del self.torrents[infohash]

    def change_torrent_state(self, infohash, newstate, index=None,
                             replaced=None, force_running=False):
        t = self.torrents[infohash]
        pred = succ = None
        if index is not None:
            l = self.lists.setdefault(newstate, [])
            if index > 0:
                pred = l[index - 1]
            if index < len(l):
                succ = l[index]
        self.torrentqueue.change_torrent_state(infohash, t.state, newstate,
                                         pred, succ, replaced, force_running)

    def finish(self, infohash):
        t = self.torrents[infohash]
        if t is None or t.state == KNOWN:
            return
        self.change_torrent_state(infohash, KNOWN)

    def confirm_replace_running_torrent(self, infohash, replaced, index):
        replace_func = lambda *args: self.change_torrent_state(infohash,
                                RUNNING, index, replaced)
        add_func     = lambda *args: self.change_torrent_state(infohash,
                                RUNNING, index, force_running=True)
        moved_torrent = self.torrents[infohash]

        if moved_torrent.state == RUNNING:
            self.change_torrent_state(infohash, RUNNING, index)
            return

        if self.config['start_torrent_behavior'] == 'replace':
            replace_func()
            return
        elif self.config['start_torrent_behavior'] == 'add':
            add_func()
            return
        
        moved_torrent_name = moved_torrent.metainfo.name
        confirm = MessageDialog(self.mainwindow,
                                _(""Stop running torrent?""),
                                _('You are about to start ""%s"". Do you want to stop another running torrent as well?')%(moved_torrent_name),
                                type=gtk.MESSAGE_QUESTION,
                                buttons=gtk.BUTTONS_YES_NO,
                                yesfunc=replace_func,
                                nofunc=add_func,
                                default=gtk.RESPONSE_YES)

    def nag(self):
        if ((self.config['donated'] != version) and
            #(random.random() * NAG_FREQUENCY) < 1) and
            False):
            title = _(""Have you donated?"")
            message = _(""Welcome to the new version of %s. Have you donated?"")%app_name
            self.nagwindow = MessageDialog(self.mainwindow,
                                           title,
                                           message,
                                           type=gtk.MESSAGE_QUESTION,
                                           buttons=gtk.BUTTONS_YES_NO,
                                           yesfunc=self.nag_yes, nofunc=self.nag_no,
                                           default=gtk.RESPONSE_NO)
            
    def nag_no(self):
        self.donate()

    def nag_yes(self):
        self.set_config('donated', version)
        MessageDialog(self.mainwindow,
                      _(""Thanks!""),
                      _(""Thanks for donating! To donate again, ""
                        'select ""Donate"" from the ""Help"" menu.'),
                      type=gtk.MESSAGE_INFO,
                      default=gtk.RESPONSE_OK
                      )

    def donate(self):
        self.visit_url(DONATE_URL)


    def visit_url(self, url, callback=None):
        t = threading.Thread(target=self._visit_url,
                             args=(url,callback))
        t.setDaemon(True)
        t.start()

    def _visit_url(self, url, callback=None):
        webbrowser.open(url)
        if callback:
            gtk_wrap(callback)

    def toggle_shown(self):
        if self.config['minimize_to_tray']:
            if self.mainwindow.get_property('visible'):
                self.mainwindow.hide()
            else:
                self.mainwindow.show_all()
        else:
            if not self.iconized:
                self.mainwindow.iconify()
            else:
                self.mainwindow.deiconify()
                

    def raiseerror(self, *args):
        raise ValueError('test traceback behavior')

#this class provides a thin layer around the loop so that the main window
#doesn't have to run it. It protects againstexceptions in mainwindow creation
#preventing the loop from starting (and causing ""The grey screen of BT"")
class MainLoop:
    def __init__(self):
        self.mainwindow = None
        self.started = 0
        
        gtk.threads_init()

    def set_mainwindow(self, mainwindow):
        self.mainwindow = mainwindow

    def run(self):
        self.mainwindow.traythread.start()
        gtk.threads_enter()        

        if self.mainwindow:
            self.mainwindow.ssbutton.set_paused(self.mainwindow.config['pause'])
            self.mainwindow.rate_slider_box.start()
            self.mainwindow.init_updates()

        try:
            #the main loop has been started
            self.started = 1
            gtk.main() 
        except KeyboardInterrupt:
            gtk.threads_leave()
            if self.mainwindow:
                self.mainwindow.torrentqueue.set_done()
            raise
        
        gtk.threads_leave()

    def quit(self):
        if self.mainwindow: 
            self.mainwindow.quit()
        

def btgui_exit_gtk(mainloop):
    # if the main loop has never run, we have to run it to flush blocking threads
    # if it has run, running it a second time will cause duplicate-destruction problems
    if not mainloop.started:
        # queue up a command to close the gui
        gobject.idle_add(lock_wrap, mainloop.quit)
        # run the main loop so we process all queued commands, then quit
        mainloop.run()

if __name__ == '__main__':

    mainloop = MainLoop()

    # make sure we start the gtk loop once before we close
    atexit.register(btgui_exit_gtk, mainloop)

    torrentqueue = TorrentQueue.TorrentQueue(config, ui_options, ipc)
    d = DownloadInfoFrame(config,TorrentQueue.ThreadWrappedQueue(torrentqueue))

    mainloop.set_mainwindow(d)
    global_log_func.logger = d.global_error
    
    startflag = threading.Event()
    dlthread = threading.Thread(target = torrentqueue.run,
                                args = (d, gtk_wrap, startflag))
    dlthread.setDaemon(False)
    dlthread.start()
    startflag.wait()
    # the wait may have been terminated because of an error
    if torrentqueue.initialized == -1:
        raise BTFailure(_(""Could not start the TorrentQueue, see above for errors.""))
    
    torrentqueue.rawserver.install_sigint_handler()
    for name in newtorrents:
        d.torrentqueue.start_new_torrent_by_name(name)

    try:
        mainloop.run()
    except KeyboardInterrupt:
        # the gtk main loop is closed in MainLoop
        sys.exit(1)
    d.trayicon.disable()
    
",False,
99,101,NomosTestfiles/BSD/0BSD.txt,0BSD,"
Copyright (C) 2006 by Rob Landley <rob@landley.net>

Permission to use, copy, modify, and/or distribute this software for any purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED ""AS IS"" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

",False,"```
Copyright (C) 2006 by Rob Landley <rob@landley.net>

Permission to use, copy, modify, and/or distribute this software for any purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED ""AS IS"" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
```"
100,102,NomosTestfiles/BSD/access.c,BSD-style,"/* This is file ACCESS.C */
/*
* Copyright (C) 1993 DJ Delorie
* All rights reserved.
*
* Redistribution, modification, and use in source and binary forms is permitted
* provided that the above copyright notice and following paragraph are
* duplicated in all such forms.
*
* This file is distributed WITHOUT ANY WARRANTY; without even the implied
* warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
*/

#include <fcntl.h>
#include <sys/stat.h>
#include <unistd.h>

int access(const char *fn, int flags)
{
struct stat s;
if (stat(fn, &s))
return -1;
if (s.st_mode & S_IFDIR)
return 0;
if (flags & W_OK)
{
if (s.st_mode & S_IWRITE)
return 0;
return -1;
}
return 0;
}
",False,"```
/*
* Copyright (C) 1993 DJ Delorie
* All rights reserved.
*
* Redistribution, modification, and use in source and binary forms is permitted
* provided that the above copyright notice and following paragraph are
* duplicated in all such forms.
*
* This file is distributed WITHOUT ANY WARRANTY; without even the implied
* warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
*/
```"
101,103,NomosTestfiles/BSD/AMPAS.txt,AMPAS,"Copyright (c) 2006 Academy of Motion Picture Arts and Sciences (""A.M.P.A.S.""). Portions contributed by others as indicated. All rights reserved.

A world-wide, royalty-free, non-exclusive right to distribute, copy, modify, create derivatives, and use, in source and binary forms, is hereby granted, subject to acceptance of this license. Performance of any of the aforementioned acts indicates acceptance to be bound by the following terms and conditions:

* Redistributions of source code must retain the above copyright notice, this list of conditions and the Disclaimer of Warranty.

* Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the Disclaimer of Warranty in the documentation and/or other materials provided with the distribution.

* Nothing in this license shall be deemed to grant any rights to trademarks, copyrights, patents, trade secrets or any other intellectual property of A.M.P.A.S. or any contributors, except as expressly stated herein, and neither the name of A.M.P.A.S. nor of any other contributors to this software, may be used to endorse or promote products derived from this software without specific prior written permission of A.M.P.A.S. or contributor, as appropriate.

This license shall be governed by the laws of the State of California, and subject to the jurisdiction of the courts therein.

Disclaimer of Warranty: THIS SOFTWARE IS PROVIDED BY A.M.P.A.S. AND CONTRIBUTORS ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT ARE DISCLAIMED. IN NO EVENT SHALL A.M.P.A.S., ANY CONTRIBUTORS OR DISTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
",False,"```
Copyright (c) 2006 Academy of Motion Picture Arts and Sciences (""A.M.P.A.S.""). Portions contributed by others as indicated. All rights reserved.

A world-wide, royalty-free, non-exclusive right to distribute, copy, modify, create derivatives, and use, in source and binary forms, is hereby granted, subject to acceptance of this license. Performance of any of the aforementioned acts indicates acceptance to be bound by the following terms and conditions:

* Redistributions of source code must retain the above copyright notice, this list of conditions and the Disclaimer of Warranty.

* Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the Disclaimer of Warranty in the documentation and/or other materials provided with the distribution.

* Nothing in this license shall be deemed to grant any rights to trademarks, copyrights, patents, trade secrets or any other intellectual property of A.M.P.A.S. or any contributors, except as expressly stated herein, and neither the name of A.M.P.A.S. nor of any other contributors to this software, may be used to endorse or promote products derived from this software without specific prior written permission of A.M.P.A.S. or contributor, as appropriate.

This license shall be governed by the laws of the State of California, and subject to the jurisdiction of the courts therein.

Disclaimer of Warranty: THIS SOFTWARE IS PROVIDED BY A.M.P.A.S. AND CONTRIBUTORS ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT ARE DISCLAIMED. IN NO EVENT SHALL A.M.P.A.S., ANY CONTRIBUTORS OR DISTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
102,104,NomosTestfiles/BSD/ANT+SharedSourceLicense.txt,ANT+SharedSource,"ANT+ Shared Source License

This software is subject to the ANT+ Shared Source License www.thisisant.com/swlicenses

Copyright (c) Dynastream Innovations, Inc. 2016
All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following
conditions are met:
1.	Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
2.	Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following
    disclaimer in the documentation and/or other materials provided with the distribution.
3.	Neither the name of Dynastream nor the names of its contributors may be used to endorse or promote products derived
    from this software without specific prior written permission.

The following actions are prohibited:

1.	Redistribution of source code containing the ANT+ Network Key. The ANT+ Network Key is available to ANT+
    Adopters.Please refer to http://thisisant.com to become an ANT+ Adopter and access the key.
2.	Reverse engineering, decompilation, and/or disassembly of software provided in binary form under this license.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND ANY EXPRESS OR
IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS FOR A PARTICULAR PURPOSE ARE HEREBY DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER
OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; DAMAGE TO ANY DEVICE, LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
THE POSSIBILITY OF SUCH DAMAGE. SOME STATES DO NOT ALLOW THE EXCLUSION OF INCIDENTAL OR
CONSEQUENTIAL DAMAGES, SO THE ABOVE LIMITATIONS MAY NOT APPLY TO YOU.
",False,"```
ANT+ Shared Source License

This software is subject to the ANT+ Shared Source License www.thisisant.com/swlicenses

Copyright (c) Dynastream Innovations, Inc. 2016
All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following
conditions are met:
1.	Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
2.	Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following
    disclaimer in the documentation and/or other materials provided with the distribution.
3.	Neither the name of Dynastream nor the names of its contributors may be used to endorse or promote products derived
    from this software without specific prior written permission.

The following actions are prohibited:

1.	Redistribution of source code containing the ANT+ Network Key. The ANT+ Network Key is available to ANT+
    Adopters.Please refer to http://thisisant.com to become an ANT+ Adopter and access the key.
2.	Reverse engineering, decompilation, and/or disassembly of software provided in binary form under this license.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND ANY EXPRESS OR
IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS FOR A PARTICULAR PURPOSE ARE HEREBY DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER
OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; DAMAGE TO ANY DEVICE, LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
THE POSSIBILITY OF SUCH DAMAGE. SOME STATES DO NOT ALLOW THE EXCLUSION OF INCIDENTAL OR
CONSEQUENTIAL DAMAGES, SO THE ABOVE LIMITATIONS MAY NOT APPLY TO YOU.
```"
103,105,NomosTestfiles/BSD/autoopts.c,"BSD
Dual-license
LGPL-3.0-or-later","
/**
 * \file autoopts.c
 *
 *  Time-stamp:      ""2010-12-18 12:09:04 bkorb""
 *
 *  This file contains all of the routines that must be linked into
 *  an executable to use the generated option processing.  The optional
 *  routines are in separately compiled modules so that they will not
 *  necessarily be linked in.
 *
 *  This file is part of AutoOpts, a companion to AutoGen.
 *  AutoOpts is free software.
 *  AutoOpts is Copyright (c) 1992-2010 by Bruce Korb - all rights reserved
 *
 *  AutoOpts is available under any one of two licenses.  The license
 *  in use must be one of these two and the choice is under the control
 *  of the user of the license.
 *
 *   The GNU Lesser General Public License, version 3 or later
 *      See the files ""COPYING.lgplv3"" and ""COPYING.gplv3""
 *
 *   The Modified Berkeley Software Distribution License
 *      See the file ""COPYING.mbsd""
 *
 *  These files have the following md5sums:
 *
 *  43b91e8ca915626ed3818ffb1b71248b pkg/libopts/COPYING.gplv3
 *  06a1a2e4760c90ea5e1dad8dfaac4d39 pkg/libopts/COPYING.lgplv3
 *  66a5cedaf62c4b2637025f049f9b826f pkg/libopts/COPYING.mbsd
 */

#ifndef PKGDATADIR
#  define PKGDATADIR """"
#endif

static char const   zNil[] = """";
static arg_types_t  argTypes             = { NULL };
static char         zOptFmtLine[16]      = { NUL };
static ag_bool      displayEnum          = AG_FALSE;
static char const   pkgdatadir_default[] = PKGDATADIR;
static char const * program_pkgdatadir   = pkgdatadir_default;
static tOptionLoadMode option_load_mode  = OPTION_LOAD_UNCOOKED;

       FILE *       option_usage_fp      = NULL;

/* = = = START-STATIC-FORWARD = = = */
static tSuccess
findOptDesc(tOptions* pOpts, tOptState* pOptState);

static tSuccess
next_opt_arg_must(tOptions* pOpts, tOptState* pOptState);

static tSuccess
next_opt_arg_may(tOptions* pOpts, tOptState* pOptState);

static tSuccess
next_opt_arg_none(tOptions* pOpts, tOptState* pOptState);

static tSuccess
nextOption(tOptions* pOpts, tOptState* pOptState);

static tSuccess
doPresets(tOptions* pOpts);

static int
checkConsistency(tOptions* pOpts);
/* = = = END-STATIC-FORWARD = = = */

LOCAL void *
ao_malloc(size_t sz)
{
    void * res = malloc(sz);
    if (res == NULL) {
        fprintf(stderr, zAO_Alloc, (int)sz);
        exit(EXIT_FAILURE);
    }
    return res;
}
#undef  malloc
#define malloc(_s) ao_malloc(_s)

LOCAL void *
ao_realloc(void *p, size_t sz)
{
    void * res = (p == NULL) ? malloc(sz) : realloc(p, sz);
    if (res == NULL) {
        fprintf(stderr, zAO_Realloc, (int)sz, p);
        exit(EXIT_FAILURE);
    }
    return res;
}
#undef  realloc
#define realloc(_p,_s) ao_realloc(_p,_s)


LOCAL void
ao_free(void *p)
{
    if (p != NULL)
        free(p);
}
#undef  free
#define free(_p) ao_free(_p)


LOCAL char *
ao_strdup(char const *str)
{
    char * res = strdup(str);
    if (res == NULL) {
        fprintf(stderr, zAO_Strdup, (int)strlen(str));
        exit(EXIT_FAILURE);
    }
    return res;
}
#undef  strdup
#define strdup(_p) ao_strdup(_p)

#ifndef HAVE_PATHFIND
#  include ""compat/pathfind.c""
#endif

#ifndef HAVE_SNPRINTF
#  include ""compat/snprintf.c""
#endif

#ifndef HAVE_STRDUP
#  include ""compat/strdup.c""
#endif

#ifndef HAVE_STRCHR
#  include ""compat/strchr.c""
#endif

/*
 *  handle_opt
 *
 *  This routine handles equivalencing, sets the option state flags and
 *  invokes the handler procedure, if any.
 */
LOCAL tSuccess
handle_opt(tOptions* pOpts, tOptState* pOptState)
{
    /*
     *  Save a copy of the option procedure pointer.
     *  If this is an equivalence class option, we still want this proc.
     */
    tOptDesc* pOD = pOptState->pOD;
    tOptProc* pOP = pOD->pOptProc;
    if (pOD->fOptState & OPTST_ALLOC_ARG)
        AGFREE(pOD->optArg.argString);

    pOD->optArg.argString = pOptState->pzOptArg;

    /*
     *  IF we are presetting options, then we will ignore any un-presettable
     *  options.  They are the ones either marked as such.
     */
    if (  ((pOpts->fOptSet & OPTPROC_PRESETTING) != 0)
       && ((pOD->fOptState & OPTST_NO_INIT) != 0)
       )
        return PROBLEM;

    /*
     *  IF this is an equivalence class option,
     *  THEN
     *      Save the option value that got us to this option
     *      entry.  (It may not be pOD->optChar[0], if this is an
     *      equivalence entry.)
     *      set the pointer to the equivalence class base
     */
    if (pOD->optEquivIndex != NO_EQUIVALENT) {
        tOptDesc* p = pOpts->pOptDesc + pOD->optEquivIndex;

        /*
         * IF the current option state has not been defined (set on the
         *    command line), THEN we will allow continued resetting of
         *    the value.  Once ""defined"", then it must not change.
         */
        if ((pOD->fOptState & OPTST_DEFINED) != 0) {
            /*
             *  The equivalenced-to option has been found on the command
             *  line before.  Make sure new occurrences are the same type.
             *
             *  IF this option has been previously equivalenced and
             *     it was not the same equivalenced-to option,
             *  THEN we have a usage problem.
             */
            if (p->optActualIndex != pOD->optIndex) {
                fprintf(stderr, (char*)zMultiEquiv, p->pz_Name, pOD->pz_Name,
                        (pOpts->pOptDesc + p->optActualIndex)->pz_Name);
                return FAILURE;
            }
        } else {
            /*
             *  Set the equivalenced-to actual option index to no-equivalent
             *  so that we set all the entries below.  This option may either
             *  never have been selected before, or else it was selected by
             *  some sort of ""presetting"" mechanism.
             */
            p->optActualIndex = NO_EQUIVALENT;
        }

        if (p->optActualIndex != pOD->optIndex) {
            /*
             *  First time through, copy over the state
             *  and add in the equivalence flag
             */
            p->optActualValue = pOD->optValue;
            p->optActualIndex = pOD->optIndex;
            pOptState->flags |= OPTST_EQUIVALENCE;
        }

        /*
         *  Copy the most recent option argument.  set membership state
         *  is kept in ``p->optCookie''.  Do not overwrite.
         */
        p->optArg.argString = pOD->optArg.argString;
        pOD = p;

    } else {
        pOD->optActualValue = pOD->optValue;
        pOD->optActualIndex = pOD->optIndex;
    }

    pOD->fOptState &= OPTST_PERSISTENT_MASK;
    pOD->fOptState |= (pOptState->flags & ~OPTST_PERSISTENT_MASK);

    /*
     *  Keep track of count only for DEFINED (command line) options.
     *  IF we have too many, build up an error message and bail.
     */
    if (  (pOD->fOptState & OPTST_DEFINED)
       && (++pOD->optOccCt > pOD->optMaxCt)  )  {

        if ((pOpts->fOptSet & OPTPROC_ERRSTOP) != 0) {
            char const * pzEqv =
                (pOD->optEquivIndex != NO_EQUIVALENT) ? zEquiv : zNil;

            fputs(zErrOnly, stderr);

            if (pOD->optMaxCt > 1)
                fprintf(stderr, zAtMost, pOD->optMaxCt, pOD->pz_Name, pzEqv);
            else
                fprintf(stderr, zOnlyOne, pOD->pz_Name, pzEqv);
        }

        return FAILURE;
    }

    /*
     *  If provided a procedure to call, call it
     */
    if (pOP != NULL)
        (*pOP)(pOpts, pOD);

    return SUCCESS;
}


/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
 *
 *  HUNT FOR OPTIONS IN THE ARGUMENT LIST
 *
 *  The next four procedures are ""private"" to nextOption().
 *  nextOption() uses findOptDesc() to find the next descriptor and it, in
 *  turn, uses longOptionFind() and shortOptionFind() to actually do the hunt.
 *
 *  longOptionFind
 *
 *  Find the long option descriptor for the current option
 */
LOCAL tSuccess
longOptionFind(tOptions* pOpts, char* pzOptName, tOptState* pOptState)
{
    ag_bool    disable  = AG_FALSE;
    char*      pzEq     = strchr(pzOptName, '=');
    tOptDesc*  pOD      = pOpts->pOptDesc;
    int        idx      = 0;
    int        idxLim   = pOpts->optCt;
    int        matchCt  = 0;
    int        matchIdx = 0;
    int        nameLen;
    char       opt_name_buf[128];

    /*
     *  IF the value is attached to the name,
     *  copy it off so we can NUL terminate.
     */
    if (pzEq != NULL) {
        nameLen = (int)(pzEq - pzOptName);
        if (nameLen >= sizeof(opt_name_buf))
            return FAILURE;
        memcpy(opt_name_buf, pzOptName, nameLen);
        opt_name_buf[nameLen] = NUL;
        pzOptName = opt_name_buf;
        pzEq++;

    } else nameLen = strlen(pzOptName);

    do  {
        /*
         *  If option disabled or a doc option, skip to next
         */
        if (pOD->pz_Name == NULL)
            continue;

        if (  SKIP_OPT(pOD)
           && (pOD->fOptState != (OPTST_OMITTED | OPTST_NO_INIT)))
            continue;

        if (strneqvcmp(pzOptName, pOD->pz_Name, nameLen) == 0) {
            /*
             *  IF we have a complete match
             *  THEN it takes priority over any already located partial
             */
            if (pOD->pz_Name[ nameLen ] == NUL) {
                matchCt  = 1;
                matchIdx = idx;
                break;
            }
        }

        /*
         *  IF       there is a disable name
         *     *AND* no argument value has been supplied
         *              (disabled options may have no argument)
         *     *AND* the option name matches the disable name
         *  THEN ...
         */
        else if (  (pOD->pz_DisableName != NULL)
                && (strneqvcmp(pzOptName, pOD->pz_DisableName, nameLen) == 0)
                )  {
            disable  = AG_TRUE;

            /*
             *  IF we have a complete match
             *  THEN it takes priority over any already located partial
             */
            if (pOD->pz_DisableName[ nameLen ] == NUL) {
                matchCt  = 1;
                matchIdx = idx;
                break;
            }
        }

        else
            continue;

        /*
         *  We found a partial match, either regular or disabling.
         *  Remember the index for later.
         */
        matchIdx = idx;

        if (++matchCt > 1)
            break;

    } while (pOD++, (++idx < idxLim));

    /*
     *  Make sure we either found an exact match or found only one partial
     */
    if (matchCt == 1) {
        pOD = pOpts->pOptDesc + matchIdx;

        if (SKIP_OPT(pOD)) {
            fprintf(stderr, zDisabledErr, pOpts->pzProgName, pOD->pz_Name);
            if (pOD->pzText != NULL)
                fprintf(stderr, "" -- %s"", pOD->pzText);
            fputc('\n', stderr);
            (*pOpts->pUsageProc)(pOpts, EXIT_FAILURE);
            /* NOTREACHED */
        }

        /*
         *  IF we found a disablement name,
         *  THEN set the bit in the callers' flag word
         */
        if (disable)
            pOptState->flags |= OPTST_DISABLED;

        pOptState->pOD      = pOD;
        pOptState->pzOptArg = pzEq;
        pOptState->optType  = TOPT_LONG;
        return SUCCESS;
    }

    /*
     *  IF there is no equal sign
     *     *AND* we are using named arguments
     *     *AND* there is a default named option,
     *  THEN return that option.
     */
    if (  (pzEq == NULL)
       && NAMED_OPTS(pOpts)
       && (pOpts->specOptIdx.default_opt != NO_EQUIVALENT)) {
        pOptState->pOD = pOpts->pOptDesc + pOpts->specOptIdx.default_opt;

        pOptState->pzOptArg = pzOptName;
        pOptState->optType  = TOPT_DEFAULT;
        return SUCCESS;
    }

    /*
     *  IF we are to stop on errors (the default, actually)
     *  THEN call the usage procedure.
     */
    if ((pOpts->fOptSet & OPTPROC_ERRSTOP) != 0) {
        fprintf(stderr, (matchCt == 0) ? zIllOptStr : zAmbigOptStr,
                pOpts->pzProgPath, pzOptName);
        (*pOpts->pUsageProc)(pOpts, EXIT_FAILURE);
    }

    return FAILURE;
}


/*
 *  shortOptionFind
 *
 *  Find the short option descriptor for the current option
 */
LOCAL tSuccess
shortOptionFind(tOptions* pOpts, uint_t optValue, tOptState* pOptState)
{
    tOptDesc*  pRes = pOpts->pOptDesc;
    int        ct   = pOpts->optCt;

    /*
     *  Search the option list
     */
    do  {
        if (optValue != pRes->optValue)
            continue;

        if (SKIP_OPT(pRes)) {
            if (  (pRes->fOptState == (OPTST_OMITTED | OPTST_NO_INIT))
               && (pRes->pz_Name != NULL)) {
                fprintf(stderr, zDisabledErr, pOpts->pzProgPath, pRes->pz_Name);
                if (pRes->pzText != NULL)
                    fprintf(stderr, "" -- %s"", pRes->pzText);
                fputc('\n', stderr);
                (*pOpts->pUsageProc)(pOpts, EXIT_FAILURE);
                /* NOTREACHED */
            }
            goto short_opt_error;
        }

        pOptState->pOD     = pRes;
        pOptState->optType = TOPT_SHORT;
        return SUCCESS;

    } while (pRes++, --ct > 0);

    /*
     *  IF    the character value is a digit
     *    AND there is a special number option (""-n"")
     *  THEN the result is the ""option"" itself and the
     *       option is the specially marked ""number"" option.
     */
    if (  IS_DEC_DIGIT_CHAR(optValue)
       && (pOpts->specOptIdx.number_option != NO_EQUIVALENT) ) {
        pOptState->pOD = \
        pRes           = pOpts->pOptDesc + pOpts->specOptIdx.number_option;
        (pOpts->pzCurOpt)--;
        pOptState->optType = TOPT_SHORT;
        return SUCCESS;
    }

short_opt_error:

    /*
     *  IF we are to stop on errors (the default, actually)
     *  THEN call the usage procedure.
     */
    if ((pOpts->fOptSet & OPTPROC_ERRSTOP) != 0) {
        fprintf(stderr, zIllOptChr, pOpts->pzProgPath, optValue);
        (*pOpts->pUsageProc)(pOpts, EXIT_FAILURE);
    }

    return FAILURE;
}


/*
 *  findOptDesc
 *
 *  Find the option descriptor for the current option
 */
static tSuccess
findOptDesc(tOptions* pOpts, tOptState* pOptState)
{
    /*
     *  IF we are continuing a short option list (e.g. -xyz...)
     *  THEN continue a single flag option.
     *  OTHERWISE see if there is room to advance and then do so.
     */
    if ((pOpts->pzCurOpt != NULL) && (*pOpts->pzCurOpt != NUL))
        return shortOptionFind(pOpts, (tAoUC)*(pOpts->pzCurOpt), pOptState);

    if (pOpts->curOptIdx >= pOpts->origArgCt)
        return PROBLEM; /* NORMAL COMPLETION */

    pOpts->pzCurOpt = pOpts->origArgVect[ pOpts->curOptIdx ];

    /*
     *  IF all arguments must be named options, ...
     */
    if (NAMED_OPTS(pOpts)) {
        char *   pz  = pOpts->pzCurOpt;
        int      def;
        tSuccess res; 
        tAoUS *  def_opt;

        pOpts->curOptIdx++;

        if (*pz != '-')
            return longOptionFind(pOpts, pz, pOptState);

        /*
         *  The name is prefixed with one or more hyphens.  Strip them off
         *  and disable the ""default_opt"" setting.  Use heavy recasting to
         *  strip off the ""const"" quality of the ""default_opt"" field.
         */
        while (*(++pz) == '-')   ;
        def_opt = (void *)&(pOpts->specOptIdx.default_opt);
        def = *def_opt;
        *def_opt = NO_EQUIVALENT;
        res = longOptionFind(pOpts, pz, pOptState);
        *def_opt = def;
        return res;
    }

    /*
     *  Note the kind of flag/option marker
     */
    if (*((pOpts->pzCurOpt)++) != '-')
        return PROBLEM; /* NORMAL COMPLETION - this + rest are operands */

    /*
     *  Special hack for a hyphen by itself
     */
    if (*(pOpts->pzCurOpt) == NUL)
        return PROBLEM; /* NORMAL COMPLETION - this + rest are operands */

    /*
     *  The current argument is to be processed as an option argument
     */
    pOpts->curOptIdx++;

    /*
     *  We have an option marker.
     *  Test the next character for long option indication
     */
    if (pOpts->pzCurOpt[0] == '-') {
        if (*++(pOpts->pzCurOpt) == NUL)
            /*
             *  NORMAL COMPLETION - NOT this arg, but rest are operands
             */
            return PROBLEM;

        /*
         *  We do not allow the hyphen to be used as a flag value.
         *  Therefore, if long options are not to be accepted, we punt.
         */
        if ((pOpts->fOptSet & OPTPROC_LONGOPT) == 0) {
            fprintf(stderr, zIllOptStr, pOpts->pzProgPath,
                    zIllegal, pOpts->pzCurOpt-2);
            return FAILURE;
        }

        return longOptionFind(pOpts, pOpts->pzCurOpt, pOptState);
    }

    /*
     *  If short options are not allowed, then do long
     *  option processing.  Otherwise the character must be a
     *  short (i.e. single character) option.
     */
    if ((pOpts->fOptSet & OPTPROC_SHORTOPT) != 0)
        return shortOptionFind(pOpts, (tAoUC)*(pOpts->pzCurOpt), pOptState);

    return longOptionFind(pOpts, pOpts->pzCurOpt, pOptState);
}


static tSuccess
next_opt_arg_must(tOptions* pOpts, tOptState* pOptState)
{
    /*
     *  An option argument is required.  Long options can either have
     *  a separate command line argument, or an argument attached by
     *  the '=' character.  Figure out which.
     */
    switch (pOptState->optType) {
    case TOPT_SHORT:
        /*
         *  See if an arg string follows the flag character
         */
        if (*++(pOpts->pzCurOpt) == NUL)
            pOpts->pzCurOpt = pOpts->origArgVect[ pOpts->curOptIdx++ ];
        pOptState->pzOptArg = pOpts->pzCurOpt;
        break;

    case TOPT_LONG:
        /*
         *  See if an arg string has already been assigned (glued on
         *  with an `=' character)
         */
        if (pOptState->pzOptArg == NULL)
            pOptState->pzOptArg = pOpts->origArgVect[ pOpts->curOptIdx++ ];
        break;

    default:
#ifdef DEBUG
        fputs(""AutoOpts lib error: option type not selected\n"", stderr);
        exit(EXIT_FAILURE);
#endif

    case TOPT_DEFAULT:
        /*
         *  The option was selected by default.  The current token is
         *  the option argument.
         */
        break;
    }

    /*
     *  Make sure we did not overflow the argument list.
     */
    if (pOpts->curOptIdx > pOpts->origArgCt) {
        fprintf(stderr, zMisArg, pOpts->pzProgPath, pOptState->pOD->pz_Name);
        return FAILURE;
    }

    pOpts->pzCurOpt = NULL;  /* next time advance to next arg */
    return SUCCESS;
}


static tSuccess
next_opt_arg_may(tOptions* pOpts, tOptState* pOptState)
{
    /*
     *  An option argument is optional.
     */
    switch (pOptState->optType) {
    case TOPT_SHORT:
        if (*++pOpts->pzCurOpt != NUL)
            pOptState->pzOptArg = pOpts->pzCurOpt;
        else {
            char* pzLA = pOpts->origArgVect[ pOpts->curOptIdx ];

            /*
             *  BECAUSE it is optional, we must make sure
             *  we did not find another flag and that there
             *  is such an argument.
             */
            if ((pzLA == NULL) || (*pzLA == '-'))
                pOptState->pzOptArg = NULL;
            else {
                pOpts->curOptIdx++; /* argument found */
                pOptState->pzOptArg = pzLA;
            }
        }
        break;

    case TOPT_LONG:
        /*
         *  Look for an argument if we don't already have one (glued on
         *  with a `=' character) *AND* we are not in named argument mode
         */
        if (  (pOptState->pzOptArg == NULL)
           && (! NAMED_OPTS(pOpts))) {
            char* pzLA = pOpts->origArgVect[ pOpts->curOptIdx ];

            /*
             *  BECAUSE it is optional, we must make sure
             *  we did not find another flag and that there
             *  is such an argument.
             */
            if ((pzLA == NULL) || (*pzLA == '-'))
                pOptState->pzOptArg = NULL;
            else {
                pOpts->curOptIdx++; /* argument found */
                pOptState->pzOptArg = pzLA;
            }
        }
        break;

    default:
    case TOPT_DEFAULT:
        fputs(zAO_Woops, stderr );
        exit(EX_SOFTWARE);
    }

    /*
     *  After an option with an optional argument, we will
     *  *always* start with the next option because if there
     *  were any characters following the option name/flag,
     *  they would be interpreted as the argument.
     */
    pOpts->pzCurOpt = NULL;
    return SUCCESS;
}


static tSuccess
next_opt_arg_none(tOptions* pOpts, tOptState* pOptState)
{
    /*
     *  No option argument.  Make sure next time around we find
     *  the correct option flag character for short options
     */
    if (pOptState->optType == TOPT_SHORT)
        (pOpts->pzCurOpt)++;

    /*
     *  It is a long option.  Make sure there was no ``=xxx'' argument
     */
    else if (pOptState->pzOptArg != NULL) {
        fprintf(stderr, zNoArg, pOpts->pzProgPath, pOptState->pOD->pz_Name);
        return FAILURE;
    }

    /*
     *  It is a long option.  Advance to next command line argument.
     */
    else
        pOpts->pzCurOpt = NULL;
    return SUCCESS;
}

/*
 *  nextOption
 *
 *  Find the option descriptor and option argument (if any) for the
 *  next command line argument.  DO NOT modify the descriptor.  Put
 *  all the state in the state argument so that the option can be skipped
 *  without consequence (side effect).
 */
static tSuccess
nextOption(tOptions* pOpts, tOptState* pOptState)
{
    {
        tSuccess res;
        res = findOptDesc(pOpts, pOptState);
        if (! SUCCESSFUL(res))
            return res;
    }

    if (  ((pOptState->flags & OPTST_DEFINED) != 0)
       && ((pOptState->pOD->fOptState & OPTST_NO_COMMAND) != 0)) {
        fprintf(stderr, zNotCmdOpt, pOptState->pOD->pz_Name);
        return FAILURE;
    }

    pOptState->flags |= (pOptState->pOD->fOptState & OPTST_PERSISTENT_MASK);

    /*
     *  Figure out what to do about option arguments.  An argument may be
     *  required, not associated with the option, or be optional.  We detect the
     *  latter by examining for an option marker on the next possible argument.
     *  Disabled mode option selection also disables option arguments.
     */
    {
        enum { ARG_NONE, ARG_MAY, ARG_MUST } arg_type = ARG_NONE;
        tSuccess res;

        if ((pOptState->flags & OPTST_DISABLED) != 0)
            arg_type = ARG_NONE;

        else if (OPTST_GET_ARGTYPE(pOptState->flags) == OPARG_TYPE_NONE)
            arg_type = ARG_NONE;

        else if (pOptState->flags & OPTST_ARG_OPTIONAL)
            arg_type = ARG_MAY;

        else
            arg_type = ARG_MUST;

        switch (arg_type) {
        case ARG_MUST: res = next_opt_arg_must(pOpts, pOptState); break;
        case ARG_MAY:  res = next_opt_arg_may( pOpts, pOptState); break;
        case ARG_NONE: res = next_opt_arg_none(pOpts, pOptState); break;
        }

        return res;
    }
}


/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
 *
 *  DO PRESETS
 *
 *  The next several routines do the immediate action pass on the command
 *  line options, then the environment variables, then the config files in
 *  reverse order.  Once done with that, the order is reversed and all
 *  the config files and environment variables are processed again, this
 *  time only processing the non-immediate action options.  doPresets()
 *  will then return for optionProcess() to do the final pass on the command
 *  line arguments.
 */

/*
 *  doImmediateOpts - scan the command line for immediate action options
 */
LOCAL tSuccess
doImmediateOpts(tOptions* pOpts)
{
    pOpts->curOptIdx = 1;     /* start by skipping program name */
    pOpts->pzCurOpt  = NULL;

    /*
     *  Examine all the options from the start.  We process any options that
     *  are marked for immediate processing.
     */
    for (;;) {
        tOptState optState = OPTSTATE_INITIALIZER(PRESET);

        switch (nextOption(pOpts, &optState)) {
        case FAILURE: goto optionsDone;
        case PROBLEM: return SUCCESS; /* no more args */
        case SUCCESS: break;
        }

        /*
         *  IF this *is* an immediate-attribute option, then do it.
         */
        if (! DO_IMMEDIATELY(optState.flags))
            continue;

        if (! SUCCESSFUL(handle_opt(pOpts, &optState)))
            break;
    } optionsDone:;

    if ((pOpts->fOptSet & OPTPROC_ERRSTOP) != 0)
        (*pOpts->pUsageProc)(pOpts, EXIT_FAILURE);
    return FAILURE;
}


LOCAL tSuccess
doRegularOpts(tOptions* pOpts)
{
    /*
     *  Now, process all the options from our current position onward.
     *  (This allows interspersed options and arguments for the few
     *  non-standard programs that require it.)
     */
    for (;;) {
        tOptState optState = OPTSTATE_INITIALIZER(DEFINED);

        switch (nextOption(pOpts, &optState)) {
        case FAILURE: goto optionsDone;
        case PROBLEM: return SUCCESS; /* no more args */
        case SUCCESS: break;
        }

        /*
         *  IF this is not being processed normally (i.e. is immediate action)
         *  THEN skip it (unless we are supposed to do it a second time).
         */
        if (! DO_NORMALLY(optState.flags)) {
            if (! DO_SECOND_TIME(optState.flags))
                continue;
            optState.pOD->optOccCt--; /* don't count last time */
        }

        if (! SUCCESSFUL(handle_opt(pOpts, &optState)))
            break;
    } optionsDone:;
    if ((pOpts->fOptSet & OPTPROC_ERRSTOP) != 0)
        (*pOpts->pUsageProc)(pOpts, EXIT_FAILURE);
    return FAILURE;
}


/*
 *  doPresets - check for preset values from a config file or the envrionment
 */
static tSuccess
doPresets(tOptions* pOpts)
{
    tOptDesc * pOD = NULL;

    if (! SUCCESSFUL(doImmediateOpts(pOpts)))
        return FAILURE;

    /*
     *  IF this option set has a --save-opts option, then it also
     *  has a --load-opts option.  See if a command line option has disabled
     *  option presetting.
     */
    if (  (pOpts->specOptIdx.save_opts != NO_EQUIVALENT)
       && (pOpts->specOptIdx.save_opts != 0)) {
        pOD = pOpts->pOptDesc + pOpts->specOptIdx.save_opts + 1;
        if (DISABLED_OPT(pOD))
            return SUCCESS;
    }

    /*
     *  Until we return from this procedure, disable non-presettable opts
     */
    pOpts->fOptSet |= OPTPROC_PRESETTING;
    /*
     *  IF there are no config files,
     *  THEN do any environment presets and leave.
     */
    if (pOpts->papzHomeList == NULL) {
        doEnvPresets(pOpts, ENV_ALL);
    }
    else {
        doEnvPresets(pOpts, ENV_IMM);

        /*
         *  Check to see if environment variables have disabled presetting.
         */
        if ((pOD != NULL) && ! DISABLED_OPT(pOD))
            internalFileLoad(pOpts);

        /*
         *  ${PROGRAM_LOAD_OPTS} value of ""no"" cannot disable other environment
         *  variable options.  Only the loading of .rc files.
         */
        doEnvPresets(pOpts, ENV_NON_IMM);
    }
    pOpts->fOptSet &= ~OPTPROC_PRESETTING;

    return SUCCESS;
}


/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
 *
 *  VERIFY OPTION CONSISTENCY
 *
 *  Make sure that the argument list passes our consistency tests.
 */
static int
checkConsistency(tOptions* pOpts)
{
    int        errCt = 0;
    tOptDesc*  pOD   = pOpts->pOptDesc;
    int        oCt   = pOpts->presetOptCt;

    /*
     *  FOR each of ""oCt"" options, ...
     */
    for (;;) {
        const int*  pMust = pOD->pOptMust;
        const int*  pCant = pOD->pOptCant;

        /*
         *  IF the current option was provided on the command line
         *  THEN ensure that any ""MUST"" requirements are not
         *       ""DEFAULT"" (unspecified) *AND* ensure that any
         *       ""CANT"" options have not been SET or DEFINED.
         */
        if (SELECTED_OPT(pOD)) {
            if (pMust != NULL) for (;;) {
                tOptDesc*  p = pOpts->pOptDesc + *(pMust++);
                if (UNUSED_OPT(p)) {
                    const tOptDesc* pN = pOpts->pOptDesc + pMust[-1];
                    errCt++;
                    fprintf(stderr, zReqFmt, pOD->pz_Name, pN->pz_Name);
                }

                if (*pMust == NO_EQUIVALENT)
                    break;
            }

            if (pCant != NULL) for (;;) {
                tOptDesc*  p = pOpts->pOptDesc + *(pCant++);
                if (SELECTED_OPT(p)) {
                    const tOptDesc* pN = pOpts->pOptDesc + pCant[-1];
                    errCt++;
                    fprintf(stderr, zCantFmt, pOD->pz_Name, pN->pz_Name);
                }

                if (*pCant == NO_EQUIVALENT)
                    break;
            }
        }

        /*
         *  IF       this option is not equivalenced to another,
         *        OR it is equivalenced to itself (is the equiv. root)
         *  THEN we need to make sure it occurs often enough.
         */
        if (  (pOD->optEquivIndex == NO_EQUIVALENT)
           || (pOD->optEquivIndex == pOD->optIndex) )   do {
            /*
             *  IF the occurrence counts have been satisfied,
             *  THEN there is no problem.
             */
            if (pOD->optOccCt >= pOD->optMinCt)
                break;

            /*
             *  IF MUST_SET means SET and PRESET are okay,
             *  so min occurrence count doesn't count
             */
            if (  (pOD->fOptState & OPTST_MUST_SET)
               && (pOD->fOptState & (OPTST_PRESET | OPTST_SET)) )
                break;

            errCt++;
            if (pOD->optMinCt > 1)
                 fprintf(stderr, zNotEnough, pOD->pz_Name, pOD->optMinCt);
            else fprintf(stderr, zNeedOne, pOD->pz_Name);
        } while (0);

        if (--oCt <= 0)
            break;
        pOD++;
    }

    /*
     *  IF we are stopping on errors, check to see if any remaining
     *  arguments are required to be there or prohibited from being there.
     */
    if ((pOpts->fOptSet & OPTPROC_ERRSTOP) != 0) {

        /*
         *  Check for prohibition
         */
        if ((pOpts->fOptSet & OPTPROC_NO_ARGS) != 0) {
            if (pOpts->origArgCt > pOpts->curOptIdx) {
                fprintf(stderr, zNoArgs, pOpts->pzProgName);
                ++errCt;
            }
        }

        /*
         *  ELSE not prohibited, check for being required
         */
        else if ((pOpts->fOptSet & OPTPROC_ARGS_REQ) != 0) {
            if (pOpts->origArgCt <= pOpts->curOptIdx) {
                fprintf(stderr, zArgsMust, pOpts->pzProgName);
                ++errCt;
            }
        }
    }

    return errCt;
}


/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
 *
 *  THESE ROUTINES ARE CALLABLE FROM THE GENERATED OPTION PROCESSING CODE
 */
/*=--subblock=arg=arg_type,arg_name,arg_desc =*/
/*=*
 * library:  opts
 * header:   your-opts.h
 *
 * lib_description:
 *
 *  These are the routines that libopts users may call directly from their
 *  code.  There are several other routines that can be called by code
 *  generated by the libopts option templates, but they are not to be
 *  called from any other user code.  The @file{options.h} header is
 *  fairly clear about this, too.
=*/

/*=export_func optionProcess
 *
 * what: this is the main option processing routine
 *
 * arg:  + tOptions* + pOpts + program options descriptor +
 * arg:  + int       + argc  + program arg count  +
 * arg:  + char**    + argv  + program arg vector +
 *
 * ret_type:  int
 * ret_desc:  the count of the arguments processed
 *
 * doc:
 *
 * This is the main entry point for processing options.  It is intended
 * that this procedure be called once at the beginning of the execution of
 * a program.  Depending on options selected earlier, it is sometimes
 * necessary to stop and restart option processing, or to select completely
 * different sets of options.  This can be done easily, but you generally
 * do not want to do this.
 *
 * The number of arguments processed always includes the program name.
 * If one of the arguments is ""--"", then it is counted and the processing
 * stops.  If an error was encountered and errors are to be tolerated, then
 * the returned value is the index of the argument causing the error.
 * A hyphen by itself (""-"") will also cause processing to stop and will
 * @emph{not} be counted among the processed arguments.  A hyphen by itself
 * is treated as an operand.  Encountering an operand stops option
 * processing.
 *
 * err:  Errors will cause diagnostics to be printed.  @code{exit(3)} may
 *       or may not be called.  It depends upon whether or not the options
 *       were generated with the ""allow-errors"" attribute, or if the
 *       ERRSKIP_OPTERR or ERRSTOP_OPTERR macros were invoked.
=*/
int
optionProcess(tOptions * pOpts, int argCt, char ** argVect)
{
    if (! SUCCESSFUL(validateOptionsStruct(pOpts, argVect[0])))
        exit(EX_SOFTWARE);

    /*
     *  Establish the real program name, the program full path,
     *  and do all the presetting the first time thru only.
     */
    if ((pOpts->fOptSet & OPTPROC_INITDONE) == 0) {
        pOpts->origArgCt   = argCt;
        pOpts->origArgVect = argVect;
        pOpts->fOptSet    |= OPTPROC_INITDONE;
        if (HAS_pzPkgDataDir(pOpts))
            program_pkgdatadir = pOpts->pzPkgDataDir;

        if (! SUCCESSFUL(doPresets(pOpts)))
            return 0;

        /*
         *  IF option name conversion was suppressed but it is not suppressed
         *  for the command line, then it's time to translate option names.
         *  Usage text will not get retranslated.
         */
        if (  ((pOpts->fOptSet & OPTPROC_TRANSLATE) != 0)
           && (pOpts->pTransProc != NULL)
           && ((pOpts->fOptSet & OPTPROC_NO_XLAT_MASK)
              == OPTPROC_NXLAT_OPT_CFG)  )  {

            pOpts->fOptSet &= ~OPTPROC_NXLAT_OPT_CFG;
            (*pOpts->pTransProc)();
        }

        if ((pOpts->fOptSet & OPTPROC_REORDER) != 0)
            optionSort(pOpts);

        pOpts->curOptIdx   = 1;
        pOpts->pzCurOpt    = NULL;
    }

    /*
     *  IF we are (re)starting,
     *  THEN reset option location
     */
    else if (pOpts->curOptIdx <= 0) {
        pOpts->curOptIdx = 1;
        pOpts->pzCurOpt  = NULL;
    }

    if (! SUCCESSFUL(doRegularOpts(pOpts)))
        return pOpts->origArgCt;

    /*
     *  IF    there were no errors
     *    AND we have RC/INI files
     *    AND there is a request to save the files
     *  THEN do that now before testing for conflicts.
     *       (conflicts are ignored in preset options)
     */
    if (  (pOpts->specOptIdx.save_opts != NO_EQUIVALENT)
       && (pOpts->specOptIdx.save_opts != 0)) {
        tOptDesc*  pOD = pOpts->pOptDesc + pOpts->specOptIdx.save_opts;

        if (SELECTED_OPT(pOD)) {
            optionSaveFile(pOpts);
            exit(EXIT_SUCCESS);
        }
    }

    /*
     *  IF we are checking for errors,
     *  THEN look for too few occurrences of required options
     */
    if ((pOpts->fOptSet & OPTPROC_ERRSTOP) != 0) {
        if (checkConsistency(pOpts) != 0)
            (*pOpts->pUsageProc)(pOpts, EXIT_FAILURE);
    }

    return pOpts->curOptIdx;
}

/*
 * Local Variables:
 * mode: C
 * c-file-style: ""stroustrup""
 * indent-tabs-mode: nil
 * End:
 * end of autoopts/autoopts.c */
",False,
104,106,NomosTestfiles/BSD/BSD-1-Clause.txt,BSD-1-Clause,"
Copyright (c) <year> <owner> All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

    1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.

THIS SOFTWARE IS PROVIDED BY Berkeley Software Design, Inc. ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL Berkeley Software Design, Inc. BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

",False,"```
Copyright (c) <year> <owner> All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

    1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.

THIS SOFTWARE IS PROVIDED BY Berkeley Software Design, Inc. ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL Berkeley Software Design, Inc. BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
105,107,NomosTestfiles/BSD/BSD-2-Clause_2.txt,BSD-2-Clause,"/*-
* Copyright (c) 2005 Bruce D. Evans and Steven G. Kargl
* All rights reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions
* are met:
* 1. Redistributions of source code must retain the above copyright
* notice unmodified, this list of conditions, and the following
* disclaimer.
* 2. Redistributions in binary form must reproduce the above copyright
* notice, this list of conditions and the following disclaimer in the
* documentation and/or other materials provided with the distribution.
*
* THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
* OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
* IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
* INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
* NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
* THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
* (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
* THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
",False,"```
/*-
* Copyright (c) 2005 Bruce D. Evans and Steven G. Kargl
* All rights reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions
* are met:
* 1. Redistributions of source code must retain the above copyright
* notice unmodified, this list of conditions, and the following
* disclaimer.
* 2. Redistributions in binary form must reproduce the above copyright
* notice, this list of conditions and the following disclaimer in the
* documentation and/or other materials provided with the distribution.
*
* THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
* OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
* IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
* INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
* NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
* THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
* (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
* THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
```"
106,108,NomosTestfiles/BSD/BSD-2-Clause_3.txt,BSD-2-Clause,"# errors [![Travis-CI](https://travis-ci.org/pkg/errors.svg)](https://travis-ci.org/pkg/errors) [![AppVeyor](https://ci.appveyor.com/api/projects/status/b98mptawhudj53ep/branch/master?svg=true)](https://ci.appveyor.com/project/davecheney/errors/branch/master) [![GoDoc](https://godoc.org/github.com/pkg/errors?status.svg)](http://godoc.org/github.com/pkg/errors) [![Report card](https://goreportcard.com/badge/github.com/pkg/errors)](https://goreportcard.com/report/github.com/pkg/errors)

Package errors provides simple error handling primitives.

`go get github.com/pkg/errors`

The traditional error handling idiom in Go is roughly akin to
```go
if err != nil {
return err
}
```
which applied recursively up the call stack results in error reports without context or debugging information. The errors package allows programmers to add context to the failure path in their code in a way that does not destroy the original value of the error.

## Adding context to an error

The errors.Wrap function returns a new error that adds context to the original error. For example
```go
_, err := ioutil.ReadAll(r)
if err != nil {
return errors.Wrap(err, ""read failed"")
}
```
## Retrieving the cause of an error

Using `errors.Wrap` constructs a stack of errors, adding context to the preceding error. Depending on the nature of the error it may be necessary to reverse the operation of errors.Wrap to retrieve the original error for inspection. Any error value which implements this interface can be inspected by `errors.Cause`.
```go
type causer interface {
Cause() error
}
```
`errors.Cause` will recursively retrieve the topmost error which does not implement `causer`, which is assumed to be the original cause. For example:
```go
switch err := errors.Cause(err).(type) {
case *MyError:
// handle specifically
default:
// unknown error
}
```

[Read the package documentation for more information](https://godoc.org/github.com/pkg/errors).

## Contributing

We welcome pull requests, bug fixes and issue reports. With that said, the bar for adding new symbols to this package is intentionally set high.

Before proposing a change, please discuss your change by raising an issue.

## Licence

BSD-2-Clause",False,"```
## Licence

BSD-2-Clause
```"
107,109,NomosTestfiles/BSD/BSD-2-Clause_AND_Imlib2.txt,"Imlib2
BSD-2-Clause","""Description"": ""Normal smoothscale method, based on Imlib2's smoothscale."",
""LicenseId"": ""BSD-2-Clause AND Imlib2"",
""License"": ""BSD 2-clause \""Simplified\"" License and Imlib2 License"",
""LicenseFile"": ""QIMAGETRANSFORM_LICENSE.txt"",
""Copyright"": ""Copyright (C) 2004, 2005 Daniel M. Duley.
(C) Carsten Haitzler and various contributors.
(C) Willem Monsuwe <willem@stack.nl>""
",False,"```
Copyright (C) 2004, 2005 Daniel M. Duley.
(C) Carsten Haitzler and various contributors.
(C) Willem Monsuwe <willem@stack.nl>
```"
108,110,NomosTestfiles/BSD/BSD-2-Clause-FreeBSD.txt,BSD-2-Clause-FreeBSD,"The FreeBSD Copyright

Copyright 1992-2012 The FreeBSD Project. All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

	1.	Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.

	2.	Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE FREEBSD PROJECT ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE FREEBSD PROJECT OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
The views and conclusions contained in the software and documentation are those of the authors and should not be interpreted as representing official policies, either expressed or implied, of the FreeBSD Project.
",False,"```
The FreeBSD Copyright

Copyright 1992-2012 The FreeBSD Project. All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

	1.	Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.

	2.	Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE FREEBSD PROJECT ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE FREEBSD PROJECT OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
The views and conclusions contained in the software and documentation are those of the authors and should not be interpreted as representing official policies, either expressed or implied, of the FreeBSD Project.
```"
109,111,NomosTestfiles/BSD/BSD-2-Clause-NetBSD.txt,BSD-2-Clause-NetBSD,"NetBSD License

Copyright (c) 2008 The NetBSD Foundation, Inc.
All rights reserved.
  
This code is derived from software contributed to The NetBSD Foundation by 
  
Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.
  
THIS SOFTWARE IS PROVIDED BY THE NETBSD FOUNDATION, INC. AND CONTRIBUTORS ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE FOUNDATION OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 
",False,"```
NetBSD License

Copyright (c) 2008 The NetBSD Foundation, Inc.
All rights reserved.
  
This code is derived from software contributed to The NetBSD Foundation by 
  
Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.
  
THIS SOFTWARE IS PROVIDED BY THE NETBSD FOUNDATION, INC. AND CONTRIBUTORS ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE FOUNDATION OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
110,112,NomosTestfiles/BSD/BSD-2-Clause_not_BSD-style.txt,BSD-2-Clause,"/*-
* Copyright 2003-2005 Colin Percival
* All rights reserved
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted providing that the following conditions
* are met:
* 1. Redistributions of source code must retain the above copyright
* notice, this list of conditions and the following disclaimer.
* 2. Redistributions in binary form must reproduce the above copyright
* notice, this list of conditions and the following disclaimer in the
* documentation and/or other materials provided with the distribution.
*
* THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
* WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
* ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
* DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
* OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
* HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
* STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING
* IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
* POSSIBILITY OF SUCH DAMAGE.
*/",False,"```
/*-
* Copyright 2003-2005 Colin Percival
* All rights reserved
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted providing that the following conditions
* are met:
* 1. Redistributions of source code must retain the above copyright
* notice, this list of conditions and the following disclaimer.
* 2. Redistributions in binary form must reproduce the above copyright
* notice, this list of conditions and the following disclaimer in the
* documentation and/or other materials provided with the distribution.
*
* THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
* IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
* WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
* ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
* DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
* OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
* HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
* STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING
* IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
* POSSIBILITY OF SUCH DAMAGE.
*/
```"
111,113,NomosTestfiles/BSD/BSD-2-Clause-Patent.txt,BSD-2-Clause-Patent,"Copyright (c) <YEAR> <COPYRIGHT HOLDERS>

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

Subject to the terms and conditions of this license, each copyright holder and contributor hereby grants to those receiving rights under this license a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable (except for failure to satisfy the conditions of this license) patent license to make, have made, use, offer to sell, sell, import, and otherwise transfer this software, where such license applies only to those patent claims, already acquired or hereafter acquired, licensable by such copyright holder or contributor that are necessarily infringed by:

(a) their Contribution(s) (the licensed copyrights of copyright holders and non-copyrightable additions of contributors, in source or binary form) alone; or
(b) combination of their Contribution(s) with the work of authorship to which such Contribution(s) was added by such copyright holder or contributor, if, at the time the Contribution is added, such addition causes such combination to be necessarily infringed. The patent license shall not apply to any other combinations which include the Contribution.

Except as expressly stated above, no rights or licenses from any copyright holder or contributor is granted under this license, whether expressly, by implication, estoppel or otherwise.

DISCLAIMER

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDERS OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
",False,"```
Copyright (c) <YEAR> <COPYRIGHT HOLDERS>

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

Subject to the terms and conditions of this license, each copyright holder and contributor hereby grants to those receiving rights under this license a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable (except for failure to satisfy the conditions of this license) patent license to make, have made, use, offer to sell, sell, import, and otherwise transfer this software, where such license applies only to those patent claims, already acquired or hereafter acquired, licensable by such copyright holder or contributor that are necessarily infringed by:

(a) their Contribution(s) (the licensed copyrights of copyright holders and non-copyrightable additions of contributors, in source or binary form) alone; or
(b) combination of their Contribution(s) with the work of authorship to which such Contribution(s) was added by such copyright holder or contributor, if, at the time the Contribution is added, such addition causes such combination to be necessarily infringed. The patent license shall not apply to any other combinations which include the Contribution.

Except as expressly stated above, no rights or licenses from any copyright holder or contributor is granted under this license, whether expressly, by implication, estoppel or otherwise.

DISCLAIMER

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDERS OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
112,114,NomosTestfiles/BSD/BSD-2-Clause_ref_a.txt,BSD-2-Clause,"#### License

All source material within __lib__ directory are BSD 2-Clause licensed.
See [LICENSE](LICENSE) for details.
The license is also repeated at the top of each source file.
",False,"```
#### License

All source material within __lib__ directory are BSD 2-Clause licensed.
See [LICENSE](LICENSE) for details.
The license is also repeated at the top of each source file.
```"
113,115,NomosTestfiles/BSD/BSD-2-Clause_ref_b.txt,BSD-2-Clause,"/* Copyright 2004 Bob Proulx <bob@proulx.com>
Distributed under the two-clause BSD licence;
see the COPYING file for details. */

#include <stdio.h>
#include <stdlib.h>

int foo() { return 0; }

int main()
{
foo();
}
",False,"```
/* Copyright 2004 Bob Proulx <bob@proulx.com>
Distributed under the two-clause BSD licence;
see the COPYING file for details. */
```"
114,116,NomosTestfiles/BSD/BSD-2-Clause_ref_c.txt,BSD-2-Clause,"/*

Copyright (c) 2016, PyData Development Team
All rights reserved.

Distributed under the terms of the BSD Simplified License.

The full license is in the LICENSE file, distributed with this software.

Written by Mark Wiebe (mwwiebe@gmail.com)
Copyright (c) 2011 by Enthought, Inc.

Copyright (c) 2005-2011, NumPy Developers
All rights reserved.

See NUMPY_LICENSE.txt for the license.

This file implements string parsing and creation for NumPy datetime.

*/",False,"```
Copyright (c) 2016, PyData Development Team
All rights reserved.

Distributed under the terms of the BSD Simplified License.

The full license is in the LICENSE file, distributed with this software.
```"
115,117,NomosTestfiles/BSD/BSD-2-Clause_ref_d.txt,BSD-2-Clause,"# Moving maximum / minimum code taken from Bottleneck under the terms
# of its Simplified BSD license
# https://github.com/kwgoodman/bottleneck",False,"```
# Moving maximum / minimum code taken from Bottleneck under the terms
# of its Simplified BSD license
# https://github.com/kwgoodman/bottleneck
```"
116,118,NomosTestfiles/BSD/BSD-2-Clause.txt,BSD-2-Clause,"Copyright (c) <YEAR>, <OWNER>
All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.

Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
",False,"```
Copyright (c) <YEAR>, <OWNER>
All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.

Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
117,119,NomosTestfiles/BSD/bsd-3-1,BSD-3-Clause,"----------------------------------------------------------------------
/* * Automatically Tuned Linear Algebra Software v3.6.0 * (C) Copyright 1997 R. Clint Whaley * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions * are met: * 1. Redistributions of source code must retain the above copyright * notice, this list of conditions and the following disclaimer. * 2. Redistributions in binary form must reproduce the above copyright * notice, this list of conditions, and the following disclaimer in the * documentation and/or other materials provided with the distribution. * 3. The name of the ATLAS group or the names of its contributers may * not be used to endorse or promote products derived from this * software without specific written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS * ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR * PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE ATLAS GROUP OR ITS CONTRIBUTORS * BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. *
   */
----------------------------------------------------------------------
",False,"```
/* * Automatically Tuned Linear Algebra Software v3.6.0 * (C) Copyright 1997 R. Clint Whaley * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions * are met: * 1. Redistributions of source code must retain the above copyright * notice, this list of conditions and the following disclaimer. * 2. Redistributions in binary form must reproduce the above copyright * notice, this list of conditions, and the following disclaimer in the * documentation and/or other materials provided with the distribution. * 3. The name of the ATLAS group or the names of its contributers may * not be used to endorse or promote products derived from this * software without specific written permission. * * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS * ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR * PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE ATLAS GROUP OR ITS CONTRIBUTORS * BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE * POSSIBILITY OF SUCH DAMAGE. *
   */
```"
118,120,NomosTestfiles/BSD/bsd-3-2,BSD-3-Clause,"----------------------------------------------------------------------
/* $Header: /src/pub/tcsh/ed.term.c,v 1.31 2004/11/23 02:10:48 christos Exp $ /
   / * ed.term.c: Low level terminal interface /
   /- * Copyright (c) 1980, 1991 The Regents of the University of California. * All rights reserved. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions * are met: * 1. Redistributions of source code must retain the above copyright * notice, this list of conditions and the following disclaimer. * 2. Redistributions in binary form must reproduce the above copyright * notice, this list of conditions and the following disclaimer in the * documentation and/or other materials provided with the distribution. * 3. Neither the name of the University nor the names of its contributors * may be used to endorse or promote products derived from this software * without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF * SUCH DAMAGE.
   */
----------------------------------------------------------------------
",False,"```
/* * Copyright (c) 1980, 1991 The Regents of the University of California. * All rights reserved. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions * are met: * 1. Redistributions of source code must retain the above copyright * notice, this list of conditions and the following disclaimer. * 2. Redistributions in binary form must reproduce the above copyright * notice, this list of conditions and the following disclaimer in the * documentation and/or other materials provided with the distribution. * 3. Neither the name of the University nor the names of its contributors * may be used to endorse or promote products derived from this software * without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE * ARE DISCLAIMED. IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF * SUCH DAMAGE.
   */
```"
119,121,NomosTestfiles/BSD/bsd-3-3,BSD-3-Clause,"----------------------------------------------------------------------
/* $OpenBSD: fmt_scaled.c,v 1.9 2007/03/20 03:42:52 tedu Exp $ */

/* * Copyright (c) 2001, 2002, 2003 Ian F. Darwin. All rights reserved. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions * are met: * 1. Redistributions of source code must retain the above copyright * notice, this list of conditions and the following disclaimer. * 2. Redistributions in binary form must reproduce the above copyright * notice, this list of conditions and the following disclaimer in the * documentation and/or other materials provided with the distribution. * 3. The name of the author may not be used to endorse or promote products * derived from this software without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
   */

/* OPENBSD ORIGINAL: lib/libutil/fmt_scaled.c */

/* * fmt_scaled: Format numbers scaled for human comprehension * scan_scaled: Scan numbers in this format. * * ""Human-readable"" output uses 4 digits max, and puts a unit suffix at * the end. Makes output compact and easy-to-read esp. on huge disks. * Formatting code was originally in OpenBSD ""df"", converted to library routine. * Scanning code written for OpenBSD libutil.
   */
----------------------------------------------------------------------
",False,"```
/* * Copyright (c) 2001, 2002, 2003 Ian F. Darwin. All rights reserved. * * Redistribution and use in source and binary forms, with or without * modification, are permitted provided that the following conditions * are met: * 1. Redistributions of source code must retain the above copyright * notice, this list of conditions and the following disclaimer. * 2. Redistributions in binary form must reproduce the above copyright * notice, this list of conditions and the following disclaimer in the * documentation and/or other materials provided with the distribution. * 3. The name of the author may not be used to endorse or promote products * derived from this software without specific prior written permission. * * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
   */
```"
120,122,NomosTestfiles/BSD/bsd-3-4,BSD-3-Clause,"/*
 *  Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions are met:

 *  Redistributions of source code must retain the above copyright notice,
 this list of conditions and the following disclaimer.

 *  Redistributions in binary form must reproduce the above copyright
 notice, this list of conditions and the following disclaimer in the
 documentation and/or other materials provided with the distribution.

 *  The name of Fabasoft R&D Software GmbH & Co KG or any of its subsidiaries,
 brand or product names may not be used to endorse or promote products
 derived from this software without specific prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDER ``AS IS'' AND ANY
 EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT HOLDER BE
 LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
 BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
 WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
 OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN
 IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

",False,"```
 *  Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions are met:

 *  Redistributions of source code must retain the above copyright notice,
 this list of conditions and the following disclaimer.

 *  Redistributions in binary form must reproduce the above copyright
 notice, this list of conditions and the following disclaimer in the
 documentation and/or other materials provided with the distribution.

 *  The name of Fabasoft R&D Software GmbH & Co KG or any of its subsidiaries,
 brand or product names may not be used to endorse or promote products
 derived from this software without specific prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDER ``AS IS'' AND ANY
 EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT HOLDER BE
 LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
 BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
 WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
 OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN
 IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */ 
```"
121,123,NomosTestfiles/BSD/BSD-3-Clause_2.txt,BSD-3-Clause,"// Copyright (c) 1994-2006 Sun Microsystems Inc.
// All Rights Reserved.
//
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions
// are met:
//
// - Redistributions of source code must retain the above copyright notice,
// this list of conditions and the following disclaimer.
//
// - Redistribution in binary form must reproduce the above copyright
// notice, this list of conditions and the following disclaimer in the
// documentation and/or other materials provided with the
// distribution.
//
// - Neither the name of Sun Microsystems or the names of contributors may
// be used to endorse or promote products derived from this software without
// specific prior written permission.
//
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
// ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
// FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
// COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
// INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
// (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
// HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
// STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
// ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
// OF THE POSSIBILITY OF SUCH DAMAGE.

",False,"```
// Copyright (c) 1994-2006 Sun Microsystems Inc.
// All Rights Reserved.
//
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions
// are met:
//
// - Redistributions of source code must retain the above copyright notice,
// this list of conditions and the following disclaimer.
//
// - Redistribution in binary form must reproduce the above copyright
// notice, this list of conditions and the following disclaimer in the
// documentation and/or other materials provided with the
// distribution.
//
// - Neither the name of Sun Microsystems or the names of contributors may
// be used to endorse or promote products derived from this software without
// specific prior written permission.
//
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
// ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
// FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
// COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
// INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
// (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
// HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
// STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
// ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
// OF THE POSSIBILITY OF SUCH DAMAGE.
```"
122,124,NomosTestfiles/BSD/BSD-3-Clause_3.txt,BSD-3-Clause,"Native Go Zookeeper Client Library
===================================

[![Build Status](https://travis-ci.org/samuel/go-zookeeper.png)](https://travis-ci.org/samuel/go-zookeeper)

Documentation: http://godoc.org/github.com/samuel/go-zookeeper/zk

License
-------

3-clause BSD. See LICENSE file.",False,"```
License
-------

3-clause BSD. See LICENSE file.
```"
123,125,NomosTestfiles/BSD/BSD-3-Clause_4.txt,BSD-3-Clause,"This is a working copy of GoogleTest for the Android NDK.

Project: https://code.google.com/p/googletest/
Checkout: svn checkout http://googletest.googlecode.com/svn/trunk@653
Patches: See patches.ndk/
Licensing: 3-clause BSD. See googletest/LICENSE file.

Note that the latest official release to date (1.6.0) doesn't work
too well with Android. This is based on a more recent revision that
includes many needed bugfixes.",False,"```
Licensing: 3-clause BSD. See googletest/LICENSE file.
```"
124,126,NomosTestfiles/BSD/BSD-3-Clause_5.txt,BSD-3-Clause,"Name: libsatsolver
Version: 0.16.4
Release: 1
License: BSD 3-Clause
Url: git://gitorious.org/opensuse/sat-solver.git
Source: satsolver-%{version}.tar.bz2
BuildRoot: %{_tmppath}/%{name}-%{version}-build
Group: Development/Libraries/C and C++
Prefix: /usr

BuildRequires: doxygen
%if 0%{?mandriva_version}
# force this version on mandriva
BuildRequires: libneon0.26-devel
%endif
%if 0%{?fedora_version}
BuildRequires: db4-devel ruby ruby-rdoc
%endif
%if 0%{?suse_version}
%if 0%{?suse_version} < 1030
BuildRequires: expat
%else
BuildRequires: libexpat-devel
%endif
%if 0%{?suse_version} < 1100
BuildRequires: graphviz
%endif
%if 0%{?suse_version} > 1020
BuildRequires: fdupes
%endif
%else
BuildRequires: expat-devel
%endif
BuildRequires: cmake rpm-devel gcc-c++
BuildRequires: zlib-devel
# the testsuite uses the check framework
BuildRequires: check-devel
Summary: A new approach to package dependency solving",False,"```
License: BSD 3-Clause
```"
125,127,NomosTestfiles/BSD/BSD-3-Clause_6.txt,BSD-3-Clause,"/*
* Copyright (c) 1989 - 1994, Julianne Frances Haugh
* Copyright (c) 1996 - 1998, Marek Michałkiewicz
* Copyright (c) 2001 - 2006, Tomasz Kłoczko
* Copyright (c) 2007 - 2009, Nicolas François
* All rights reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions
* are met:
* 1. Redistributions of source code must retain the above copyright
* notice, this list of conditions and the following disclaimer.
* 2. Redistributions in binary form must reproduce the above copyright
* notice, this list of conditions and the following disclaimer in the
* documentation and/or other materials provided with the distribution.
* 3. The name of the copyright holders or contributors may not be used to
* endorse or promote products derived from this software without
* specific prior written permission.
*
* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
* ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
* LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
* PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
* HOLDERS OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
* LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
* THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
* (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
* OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/",False,"```
* Copyright (c) 1989 - 1994, Julianne Frances Haugh
* Copyright (c) 1996 - 1998, Marek Michałkiewicz
* Copyright (c) 2001 - 2006, Tomasz Kłoczko
* Copyright (c) 2007 - 2009, Nicolas François
* All rights reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions
* are met:
* 1. Redistributions of source code must retain the above copyright
* notice, this list of conditions and the following disclaimer.
* 2. Redistributions in binary form must reproduce the above copyright
* notice, this list of conditions and the following disclaimer in the
* documentation and/or other materials provided with the distribution.
* 3. The name of the copyright holders or contributors may not be used to
* endorse or promote products derived from this software without
* specific prior written permission.
*
* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
* ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
* LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
* PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
* HOLDERS OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
* LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
* THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
* (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
* OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
126,128,NomosTestfiles/BSD/BSD-3-Clause_7.txt,BSD-3-Clause,"/*
* Copyright (c) 2001 Sun Microsystems, Inc. All Rights Reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions are met:
*
* -Redistributions of source code must retain the above copyright notice, this
* list of conditions and the following disclaimer.
*
* -Redistribution in binary form must reproduct the above copyright notice,
* this list of conditions and the following disclaimer in the documentation
* and/or other materials provided with the distribution.
*
* Neither the name of Sun Microsystems, Inc. or the names of contributors may
* be used to endorse or promote products derived from this software without
* specific prior written permission.
*
* This software is provided ""AS IS,"" without a warranty of any kind. ALL
* EXPRESS OR IMPLIED CONDITIONS, REPRESENTATIONS AND WARRANTIES, INCLUDING ANY
* IMPLIED WARRANTY OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE OR
* NON-INFRINGEMENT, ARE HEREBY EXCLUDED. SUN AND ITS LICENSORS SHALL NOT BE
* LIABLE FOR ANY DAMAGES SUFFERED BY LICENSEE AS A RESULT OF USING, MODIFYING
* OR DISTRIBUTING THE SOFTWARE OR ITS DERIVATIVES. IN NO EVENT WILL SUN OR ITS
* LICENSORS BE LIABLE FOR ANY LOST REVENUE, PROFIT OR DATA, OR FOR DIRECT,
* INDIRECT, SPECIAL, CONSEQUENTIAL, INCIDENTAL OR PUNITIVE DAMAGES, HOWEVER
* CAUSED AND REGARDLESS OF THE THEORY OF LIABILITY, ARISING OUT OF THE USE OF
* OR INABILITY TO USE SOFTWARE, EVEN IF SUN HAS BEEN ADVISED OF THE
* POSSIBILITY OF SUCH DAMAGES.
*
* You acknowledge that Software is not designed,licensed or intended for use in
* the design, construction, operation or maintenance of any nuclear facility.
*/
",False,"```
* Copyright (c) 2001 Sun Microsystems, Inc. All Rights Reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions are met:
*
* -Redistributions of source code must retain the above copyright notice, this
* list of conditions and the following disclaimer.
*
* -Redistribution in binary form must reproduct the above copyright notice,
* this list of conditions and the following disclaimer in the documentation
* and/or other materials provided with the distribution.
*
* Neither the name of Sun Microsystems, Inc. or the names of contributors may
* be used to endorse or promote products derived from this software without
* specific prior written permission.
*
* This software is provided ""AS IS,"" without a warranty of any kind. ALL
* EXPRESS OR IMPLIED CONDITIONS, REPRESENTATIONS AND WARRANTIES, INCLUDING ANY
* IMPLIED WARRANTY OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE OR
* NON-INFRINGEMENT, ARE HEREBY EXCLUDED. SUN AND ITS LICENSORS SHALL NOT BE
* LIABLE FOR ANY DAMAGES SUFFERED BY LICENSEE AS A RESULT OF USING, MODIFYING
* OR DISTRIBUTING THE SOFTWARE OR ITS DERIVATIVES. IN NO EVENT WILL SUN OR ITS
* LICENSORS BE LIABLE FOR ANY LOST REVENUE, PROFIT OR DATA, OR FOR DIRECT,
* INDIRECT, SPECIAL, CONSEQUENTIAL, INCIDENTAL OR PUNITIVE DAMAGES, HOWEVER
* CAUSED AND REGARDLESS OF THE THEORY OF LIABILITY, ARISING OUT OF THE USE OF
* OR INABILITY TO USE SOFTWARE, EVEN IF SUN HAS BEEN ADVISED OF THE
* POSSIBILITY OF SUCH DAMAGES.
*
* You acknowledge that Software is not designed,licensed or intended for use in
* the design, construction, operation or maintenance of any nuclear facility.
```"
127,129,NomosTestfiles/BSD/BSD-3-Clause_8.txt,BSD-3-Clause,"# Copyright (c) 2006, Pino Toscano, <toscano.pino@tiscali.it>
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
#
# 1. Redistributions of source code must retain the copyright
# notice, this list of conditions and the following disclaimer.
# 2. Redistributions in binary form must reproduce the copyright
# notice, this list of conditions and the following disclaimer in the
# documentation and/or other materials provided with the distribution.
# 3. The name of the author may not be used to endorse or promote products
# derived from this software without specific prior written permission.
#
# THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
# IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
# OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
# IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
# INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
# NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
# DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
# THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
# THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.",False,"```
# Copyright (c) 2006, Pino Toscano, <toscano.pino@tiscali.it>
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
#
# 1. Redistributions of source code must retain the copyright
# notice, this list of conditions and the following disclaimer.
# 2. Redistributions in binary form must reproduce the copyright
# notice, this list of conditions and the following disclaimer in the
# documentation and/or other materials provided with the distribution.
# 3. The name of the author may not be used to endorse or promote products
# derived from this software without specific prior written permission.
#
# THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
# IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
# OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
# IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
# INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
# NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
# DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
# THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
# THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
128,130,NomosTestfiles/BSD/BSD-3-Clause_AND_CC0-1.0.txt,"CC0-1.0
BSD-3-Clause","{
""Id"": ""sha3_endian"",
""Name"": ""Secure Hash Algorithm SHA-3 - brg_endian"",
""QDocModule"": ""qtcore"",
""QtUsage"": ""Used in Qt Core (QCryptographicHash)."",
""Files"": ""brg_endian.h"",

""Description"": ""SHA-3, originally known as Keccak, is a cryptographic hash function."",
""License"": ""BSD 3-clause \""New\"" or \""Revised\"" License"",
""LicenseFile"": ""BRG_ENDIAN_LICENSE"",
""LicenseId"": ""BSD-3-Clause"",
""Copyright"": ""Copyright (c) 1998-2008, Brian Gladman, Worcester, UK. All rights reserved.""
},
{
""Id"": ""sha3_keccak"",
""Name"": ""Secure Hash Algorithm SHA-3 - Keccak"",
""QDocModule"": ""qtcore"",
""QtUsage"": ""Used in Qt Core (QCryptographicHash)."",
""Files"": ""KeccakF-1600-32-rvk.macros KeccakF-1600-32.macros KeccakF-1600-64.macros KeccakF-1600-interface.h KeccakF-1600-opt32.c KeccakF-1600-opt64.c KeccakF-1600-unrolling.macros KeccakNISTInterface.c KeccakNISTInterface.h KeccakSponge.c KeccakSponge.h"",

""Description"": ""SHA-3, originally known as Keccak, is a cryptographic hash function."",
""License"": ""Creative Commons Zero v1.0 Universal"",
""LicenseId"": ""CC0-1.0"",
""LicenseFile"": ""CC0_LICENSE"",
""Copyright"": ""Guido Bertoni, Joan Daemen, Michaël Peeters and Gilles Van Assche.

To the extent possible under law, the implementers have waived all copyright
and related or neighboring rights to the source code in this file.""
}
",False,"```
Creative Commons Zero v1.0 Universal

To the extent possible under law, the implementers have waived all copyright
and related or neighboring rights to the source code in this file.
```"
129,131,NomosTestfiles/BSD/BSD-3-Clause_and_LGPL-3.0.txt,"BSD-3-Clause
LGPL-3.0-only","# Opening an Issue

For a good bug report:

1. [Search][] for existing Issues, both on GitHub and in general with Google/Stack Overflow before posting a duplicate question.
2. Update to pyzmq master, if possible, especially if you are already using git. It's
possible that the bug you are about to report has already been fixed.

Many things reported as pyzmq Issues are often just libzmq-related,
and don't have anything to do with pyzmq itself.
These are better directed to [zeromq-dev][].

When making a bug report, it is helpful to tell us as much as you can about your system
(such as pyzmq version, libzmq version, Python version, OS Version, how you built/installed pyzmq and libzmq, etc.)

The basics:

```python
import sys
import zmq

print ""libzmq-%s"" % zmq.zmq_version()
print ""pyzmq-%s"" % zmq.pyzmq_version()
print ""Python-%s"" % sys.version
```

Which will give something like:

libzmq-3.3.0
pyzmq-2.2dev
Python-2.7.2 (default, Jun 20 2012, 16:23:33)
[GCC 4.2.1 Compatible Apple Clang 4.0 (tags/Apple/clang-418.0.60)]

[search]: https://github.com/zeromq/pyzmq/issues
[zeromq-dev]: mailto:zeromq-dev@zeromq.org


# Licensing and contributing to PyZMQ

PyZMQ uses different licenses for different parts of the code.

The 'core' of PyZMQ (located in zmq/core) is licensed under LGPLv3.
This just means that if you make any changes to how that code works,
you must release those changes under the LGPL.
If you just *use* pyzmq, then you can use any license you want for your own code.

We don't feel that the restrictions imposed by the LGPL make sense for the
'non-core' functionality in pyzmq (derivative code must *also* be LGPL or GPL),
especially for examples and utility code, so we have relicensed all 'non-core'
code under the more permissive BSD (specifically Modified BSD aka New BSD aka
3-clause BSD), where possible. This means that you can copy this code and build
your own apps without needing to license your own code with the LGPL or GPL.

## Your contributions

**Pull Requests are welcome!**

When you contribute to PyZMQ, your contributions are made under the same
license as the file you are working on. Any new, original code should be BSD
licensed.

We don't enforce strict style, but when in doubt [PEP8][] is a good guideline.
The only thing we really don't like is mixing up 'cleanup' in real work.

Examples are copyright their respective authors, and BSD unless otherwise
specified by the author. You can LGPL (or GPL or MIT or Apache, etc.) your own new
examples if you like, but we strongly encourage using the default BSD license.

[PEP8]: http://www.python.org/dev/peps/pep-0008

## Inherited licenses in pyzmq

Some code outside the core is taken from other open-source projects, and
inherits that project's license.

* zmq/eventloop contains files inherited and adapted from [tornado][], and inherits the Apache license

* zmq/ssh/forward.py is from [paramiko][], and inherits LGPL

* zmq/devices/monitoredqueue.pxd is derived from the zmq_device function in
libzmq, and inherits LGPL

* perf examples are (c) iMatix, and LGPL

[tornado]: http://www.tornadoweb.org
[paramiko]: http://www.lag.net/paramiko
",False,"```
PyZMQ uses different licenses for different parts of the code.

The 'core' of PyZMQ (located in zmq/core) is licensed under LGPLv3.
This just means that if you make any changes to how that code works,
you must release those changes under the LGPL.
If you just *use* pyzmq, then you can use any license you want for your own code.

We don't feel that the restrictions imposed by the LGPL make sense for the
'non-core' functionality in pyzmq (derivative code must *also* be LGPL or GPL),
especially for examples and utility code, so we have relicensed all 'non-core'
code under the more permissive BSD (specifically Modified BSD aka New BSD aka
3-clause BSD), where possible. This means that you can copy this code and build
your own apps without needing to license your own code with the LGPL or GPL.
```"
130,132,NomosTestfiles/BSD/BSD-3-Clause-Attribution_CMU.txt,BSD-3-Clause-Attribution,"/*
* Copyright (c) 1998-2003 Carnegie Mellon University. All rights reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions
* are met:
*
* 1. Redistributions of source code must retain the above copyright
* notice, this list of conditions and the following disclaimer.
*
* 2. Redistributions in binary form must reproduce the above copyright
* notice, this list of conditions and the following disclaimer in
* the documentation and/or other materials provided with the
* distribution.
*
* 3. The name ""Carnegie Mellon University"" must not be used to
* endorse or promote products derived from this software without
* prior written permission. For permission or any other legal
* details, please contact
* Office of Technology Transfer
* Carnegie Mellon University
* 5000 Forbes Avenue
* Pittsburgh, PA 15213-3890
* (412) 268-4387, fax: (412) 268-7395
* tech-transfer@andrew.cmu.edu
*
* 4. Redistributions of any form whatsoever must retain the following
* acknowledgment:
* ""This product includes software developed by Computing Services
* at Carnegie Mellon University (http://www.cmu.edu/computing/).""
*
* CARNEGIE MELLON UNIVERSITY DISCLAIMS ALL WARRANTIES WITH REGARD TO
* THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
* AND FITNESS, IN NO EVENT SHALL CARNEGIE MELLON UNIVERSITY BE LIABLE
* FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
* WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN
* AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING
* OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
*/

",False,"```
* Copyright (c) 1998-2003 Carnegie Mellon University. All rights reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions
* are met:
*
* 1. Redistributions of source code must retain the above copyright
* notice, this list of conditions and the following disclaimer.
*
* 2. Redistributions in binary form must reproduce the above copyright
* notice, this list of conditions and the following disclaimer in
* the documentation and/or other materials provided with the
* distribution.
*
* 3. The name ""Carnegie Mellon University"" must not be used to
* endorse or promote products derived from this software without
* prior written permission. For permission or any other legal
* details, please contact
* Office of Technology Transfer
* Carnegie Mellon University
* 5000 Forbes Avenue
* Pittsburgh, PA 15213-3890
* (412) 268-4387, fax: (412) 268-7395
* tech-transfer@andrew.cmu.edu
*
* 4. Redistributions of any form whatsoever must retain the following
* acknowledgment:
* ""This product includes software developed by Computing Services
* at Carnegie Mellon University (http://www.cmu.edu/computing/).""
*
* CARNEGIE MELLON UNIVERSITY DISCLAIMS ALL WARRANTIES WITH REGARD TO
* THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
* AND FITNESS, IN NO EVENT SHALL CARNEGIE MELLON UNIVERSITY BE LIABLE
* FOR ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
* WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN
* AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING
* OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
```"
131,133,NomosTestfiles/BSD/BSD-3-Clause-Attribution.txt,BSD-3-Clause-Attribution,"Copyright (c) [year] Universidad de Palermo, Argentina. All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:

1. Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.

2. Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in
   the documentation and/or other materials provided with the
   distribution.

3. Neither the name of the copyright holder nor the names of its
   contributors may be used to endorse or promote products derived from
   this software without specific prior written permission.

4. Redistributions of any form whatsoever must retain the following
   acknowledgment: 'This product includes software developed by the
   ""Universidad de Palermo, Argentina"" (http://www.palermo.edu/).'

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS
OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF
THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE.

",False,"```
Copyright (c) [year] Universidad de Palermo, Argentina. All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:

1. Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.

2. Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in
   the documentation and/or other materials provided with the
   distribution.

3. Neither the name of the copyright holder nor the names of its
   contributors may be used to endorse or promote products derived from
   this software without specific prior written permission.

4. Redistributions of any form whatsoever must retain the following
   acknowledgment: 'This product includes software developed by the
   ""Universidad de Palermo, Argentina"" (http://www.palermo.edu/).'

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS
OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF
THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE.
```"
132,134,NomosTestfiles/BSD/BSD-3-Clause-Clear_a.txt,BSD-3-Clause-Clear,"/*
* Sigma Control API DUT (station/AP)
* Copyright (c) 2010-2011, Atheros Communications, Inc.
* Copyright (c) 2011-2015, Qualcomm Atheros, Inc.
* All Rights Reserved.
* Licensed under the Clear BSD license. See README for more details.
*/
",False,"```
/*
* Sigma Control API DUT (station/AP)
* Copyright (c) 2010-2011, Atheros Communications, Inc.
* Copyright (c) 2011-2015, Qualcomm Atheros, Inc.
* All Rights Reserved.
* Licensed under the Clear BSD license. See README for more details.
*/
```"
133,135,NomosTestfiles/BSD/BSD-3-Clause-Clear.c,BSD-3-Clause-Clear,"/*
** THIS IS A TEST FILE FOR THE SPDX LICENSE DETECTION TESTS											
**																										
** This file has been auto generated using the SPDX License List as represented by
** the JSON files:  https://github.com/spdx/license-list-data 
** 
** This file is for test purposes only. It WILL NOT compile or do anything useful otherwise.
**
** Test File Version: 1.0 No SPDX Identifiers - License List version 2.6
**
** DISCLAIMER
**
** Any copyrights appearing in this test file do so because they were part of the license text as stored by SPDX and are included 
** only for test purposes as they are part of the license text.	They have no meaning, implied or specific, otherwise.	
*/




/*
** LICENSE HEADER AND COPYRIGHT TO DETECT	
** This section either uses either the standard license header, or if one does not exist, the license 
** text as shown on the SPDX License List. In addition, if the file was generated using the write 
** license identifiers option, they will appear before the license text.
** 										
**
** SPDX License to detect: https://spdx.org/licenses/BSD-3-Clause-Clear.html				
*/


// REUSE-IgnoreStart
/* SPDX-License-Identifier: BSD-3-Clause-Clear */
// REUSE-IgnoreEnd
/*
The Clear BSD License

Copyright (c) [xxxx]-[xxxx] [Owner
Organization]
All rights reserved.

Redistribution and use in source
and binary forms, with or without modification, are permitted (subject
to the limitations in the disclaimer below) provided that the
following conditions are met:

     * Redistributions of source code
must retain the above copyright notice, this list of conditions and
the following disclaimer.

     * Redistributions in binary form must
reproduce the above copyright notice, this list of conditions and the
following disclaimer in the documentation and/or other materials
provided with the distribution.

     * Neither the name of [Owner
Organization] nor the names of its contributors may be used to endorse
or promote products derived from this software without specific prior
written permission.

NO EXPRESS OR IMPLIED LICENSES TO ANY PARTY'S
PATENT RIGHTS ARE GRANTED BY THIS LICENSE. THIS SOFTWARE IS PROVIDED
BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND ANY EXPRESS OR
IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN
IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

/*
** Fake code so we have something.
*/
#include <nothing.h>


int
noop_fun(int arg1)
{
	short retval;
	
	recalculatearg(&arg1);
	
	switch (arg1)
	{
		case 0:
			if (arg1) {
					retval = 1;
			} else {
			retval = 2;
			}
		case 1:
			retval = 2;
		case 2:
			retval = morpharg(arg1);
		case 3:
			if (arg1) {
				retval = 6;
			} else {
				retval = 7;
			}
		case 4:
			retval = upscalearg(arg1);
		default:
			retval = 0;
	}
	
	return retval;
}

",False,"```
/* SPDX-License-Identifier: BSD-3-Clause-Clear */
/*
The Clear BSD License

Copyright (c) [xxxx]-[xxxx] [Owner
Organization]
All rights reserved.

Redistribution and use in source
and binary forms, with or without modification, are permitted (subject
to the limitations in the disclaimer below) provided that the
following conditions are met:

     * Redistributions of source code
must retain the above copyright notice, this list of conditions and
the following disclaimer.

     * Redistributions in binary form must
reproduce the above copyright notice, this list of conditions and the
following disclaimer in the documentation and/or other materials
provided with the distribution.

     * Neither the name of [Owner
Organization] nor the names of its contributors may be used to endorse
or promote products derived from this software without specific prior
written permission.

NO EXPRESS OR IMPLIED LICENSES TO ANY PARTY'S
PATENT RIGHTS ARE GRANTED BY THIS LICENSE. THIS SOFTWARE IS PROVIDED
BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND ANY EXPRESS OR
IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN
IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
```"
134,136,NomosTestfiles/BSD/BSD-3-Clause-Clear.txt,BSD-3-Clause-Clear,"The Clear BSD License

Copyright (c) [xxxx]-[xxxx] [Owner
Organization]
All rights reserved.

Redistribution and use in source
and binary forms, with or without modification, are permitted (subject
to the limitations in the disclaimer below) provided that the
following conditions are met:

     * Redistributions of source code
must retain the above copyright notice, this list of conditions and
the following disclaimer.

     * Redistributions in binary form must
reproduce the above copyright notice, this list of conditions and the
following disclaimer in the documentation and/or other materials
provided with the distribution.

     * Neither the name of [Owner
Organization] nor the names of its contributors may be used to endorse
or promote products derived from this software without specific prior
written permission.

NO EXPRESS OR IMPLIED LICENSES TO ANY PARTY'S
PATENT RIGHTS ARE GRANTED BY THIS LICENSE. THIS SOFTWARE IS PROVIDED
BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND ANY EXPRESS OR
IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN
IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
",False,"```
The Clear BSD License

Copyright (c) [xxxx]-[xxxx] [Owner
Organization]
All rights reserved.

Redistribution and use in source
and binary forms, with or without modification, are permitted (subject
to the limitations in the disclaimer below) provided that the
following conditions are met:

     * Redistributions of source code
must retain the above copyright notice, this list of conditions and
the following disclaimer.

     * Redistributions in binary form must
reproduce the above copyright notice, this list of conditions and the
following disclaimer in the documentation and/or other materials
provided with the distribution.

     * Neither the name of [Owner
Organization] nor the names of its contributors may be used to endorse
or promote products derived from this software without specific prior
written permission.

NO EXPRESS OR IMPLIED LICENSES TO ANY PARTY'S
PATENT RIGHTS ARE GRANTED BY THIS LICENSE. THIS SOFTWARE IS PROVIDED
BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND ANY EXPRESS OR
IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN
IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
135,137,NomosTestfiles/BSD/BSD-3-Clause-LBNL_a.txt,BSD-3-Clause-LBNL,"/*
* include/dd_inline.h
*
* This work was supported by the Director, Office of Science, Division
* of Mathematical, Information, and Computational Sciences of the
* U.S. Department of Energy under contract numbers DE-AC03-76SF00098 and
* DE-AC02-05CH11231.
* 
* Copyright (c) 2003-2009, The Regents of the University of California,
* through Lawrence Berkeley National Laboratory (subject to receipt of
* any required approvals from U.S. Dept. of Energy) All rights reserved.
*
* By downloading or using this software you are agreeing to the modified
* BSD license ""BSD-LBNL-License.doc"" (see LICENSE.txt).
*/
",False,"```
* Copyright (c) 2003-2009, The Regents of the University of California,
* through Lawrence Berkeley National Laboratory (subject to receipt of
* any required approvals from U.S. Dept. of Energy) All rights reserved.
*
* By downloading or using this software you are agreeing to the modified
* BSD license ""BSD-LBNL-License.doc"" (see LICENSE.txt).
```"
136,138,NomosTestfiles/BSD/BSD-3-Clause-Open-MPI.txt,BSD-3-Clause-Open-MPI,"Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

- Redistributions of source code must retain the above copyright
  notice, this list of conditions and the following disclaimer.

- Redistributions in binary form must reproduce the above copyright
  notice, this list of conditions and the following disclaimer listed
  in this license in the documentation and/or other materials
  provided with the distribution.

- Neither the name of the copyright holders nor the names of its
  contributors may be used to endorse or promote products derived from
  this software without specific prior written permission.

The copyright holders provide no reassurances that the source code
provided does not infringe any patent, copyright, or any other
intellectual property rights of third parties.  The copyright holders
disclaim any liability to any recipient for claims brought against
recipient by any third party for infringement of that parties
intellectual property rights.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.",False,"```
Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

- Redistributions of source code must retain the above copyright
  notice, this list of conditions and the following disclaimer.

- Redistributions in binary form must reproduce the above copyright
  notice, this list of conditions and the following disclaimer listed
  in this license in the documentation and/or other materials
  provided with the distribution.

- Neither the name of the copyright holders nor the names of its
  contributors may be used to endorse or promote products derived from
  this software without specific prior written permission.

The copyright holders provide no reassurances that the source code
provided does not infringe any patent, copyright, or any other
intellectual property rights of third parties.  The copyright holders
disclaim any liability to any recipient for claims brought against
recipient by any third party for infringement of that parties
intellectual property rights.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
137,139,NomosTestfiles/BSD/BSD-3-Clause.txt,BSD-3-Clause,"Copyright (c) <YEAR>, <OWNER>
All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
Neither the name of the <ORGANIZATION> nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.
THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
",False,"```
Copyright (c) <YEAR>, <OWNER>
All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
Neither the name of the <ORGANIZATION> nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.
THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
138,140,NomosTestfiles/BSD/bsd-3.txt,BSD-3-Clause,"Copyright (c) 2013, Michael Bostock
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice, this
list of conditions and the following disclaimer.

* Redistributions in binary form must reproduce the above copyright notice,
this list of conditions and the following disclaimer in the documentation
and/or other materials provided with the distribution.

* The name Michael Bostock may not be used to endorse or promote products
derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS""
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL MICHAEL BOSTOCK BE LIABLE FOR ANY DIRECT,
INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
",False,"```
Copyright (c) 2013, Michael Bostock
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice, this
list of conditions and the following disclaimer.

* Redistributions in binary form must reproduce the above copyright notice,
this list of conditions and the following disclaimer in the documentation
and/or other materials provided with the distribution.

* The name Michael Bostock may not be used to endorse or promote products
derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS""
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL MICHAEL BOSTOCK BE LIABLE FOR ANY DIRECT,
INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
139,141,NomosTestfiles/BSD/BSD-4-Clause_2.txt,BSD-4-Clause,"/** @file
Minimum and Greatest Width Integer types.

Copyright (c) 2010, Intel Corporation. All rights reserved.<BR>
This program and the accompanying materials are licensed and made available under
the terms and conditions of the BSD License that accompanies this distribution.
The full text of the license may be found at
http://opensource.org/licenses/bsd-license.php.

THE PROGRAM IS DISTRIBUTED UNDER THE BSD LICENSE ON AN ""AS IS"" BASIS,
WITHOUT WARRANTIES OR REPRESENTATIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED.

Portions Copyright (c) 2001 The NetBSD Foundation, Inc.
All rights reserved.

This code is derived from software contributed to The NetBSD Foundation
by Klaus Klein.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:
1. Redistributions of source code must retain the above copyright
notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright
notice, this list of conditions and the following disclaimer in the
documentation and/or other materials provided with the distribution.
3. All advertising materials mentioning features or use of this software
must display the following acknowledgement:
This product includes software developed by the NetBSD
Foundation, Inc. and its contributors.
4. Neither the name of The NetBSD Foundation nor the names of its
contributors may be used to endorse or promote products derived
from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE NETBSD FOUNDATION, INC. AND CONTRIBUTORS
``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE FOUNDATION OR CONTRIBUTORS
BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE.

NetBSD: int_mwgwtypes.h,v 1.5 2005/12/24 20:06:47 perry Exp
**/
",False,"```
Copyright (c) 2010, Intel Corporation. All rights reserved.<BR>
This program and the accompanying materials are licensed and made available under
the terms and conditions of the BSD License that accompanies this distribution.
The full text of the license may be found at
http://opensource.org/licenses/bsd-license.php.

THE PROGRAM IS DISTRIBUTED UNDER THE BSD LICENSE ON AN ""AS IS"" BASIS,
WITHOUT WARRANTIES OR REPRESENTATIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:
1. Redistributions of source code must retain the above copyright
notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright
notice, this list of conditions and the following disclaimer in the
documentation and/or other materials provided with the distribution.
3. All advertising materials mentioning features or use of this software
must display the following acknowledgement:
This product includes software developed by the NetBSD
Foundation, Inc. and its contributors.
4. Neither the name of The NetBSD Foundation nor the names of its
contributors may be used to endorse or promote products derived
from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE NETBSD FOUNDATION, INC. AND CONTRIBUTORS
``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE FOUNDATION OR CONTRIBUTORS
BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE.
```"
140,142,NomosTestfiles/BSD/BSD-4-Clause_3.txt,BSD-4-Clause,"/*
* Copyright (c) 2001 Wasabi Systems, Inc.
* All rights reserved.
*
* Written by Frank van der Linden for Wasabi Systems, Inc.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions
* are met:
* 1. Redistributions of source code must retain the above copyright
* notice, this list of conditions and the following disclaimer.
* 2. Redistributions in binary form must reproduce the above copyright
* notice, this list of conditions and the following disclaimer in the
* documentation and/or other materials provided with the distribution.
* 3. All advertising materials mentioning features or use of this software
* must display the following acknowledgement:
* This product includes software developed for the NetBSD Project by
* Wasabi Systems, Inc.
* 4. The name of Wasabi Systems, Inc. may not be used to endorse
* or promote products derived from this software without specific prior
* written permission.
*
* THIS SOFTWARE IS PROVIDED BY WASABI SYSTEMS, INC. ``AS IS'' AND
* ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
* TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
* PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL WASABI SYSTEMS, INC
* BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
* CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
* SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
* INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
* CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
* ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
* POSSIBILITY OF SUCH DAMAGE.
*/
",False,"```
* Copyright (c) 2001 Wasabi Systems, Inc.
* All rights reserved.
*
* Written by Frank van der Linden for Wasabi Systems, Inc.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions
* are met:
* 1. Redistributions of source code must retain the above copyright
* notice, this list of conditions and the following disclaimer.
* 2. Redistributions in binary form must reproduce the above copyright
* notice, this list of conditions and the following disclaimer in the
* documentation and/or other materials provided with the distribution.
* 3. All advertising materials mentioning features or use of this software
* must display the following acknowledgement:
* This product includes software developed for the NetBSD Project by
* Wasabi Systems, Inc.
* 4. The name of Wasabi Systems, Inc. may not be used to endorse
* or promote products derived from this software without specific prior
* written permission.
*
* THIS SOFTWARE IS PROVIDED BY WASABI SYSTEMS, INC. ``AS IS'' AND
* ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
* TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
* PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL WASABI SYSTEMS, INC
* BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
* CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
* SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
* INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
* CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
* ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
* POSSIBILITY OF SUCH DAMAGE.
```"
141,143,NomosTestfiles/BSD/BSD-4-Clause_4.txt,BSD-4-Clause,"""Description"": ""An instrumentation framework for building dynamic analysis tools."",
""Homepage"": ""http://valgrind.org/"",
""License"": ""BSD 4-clause \""Original\"" or \""Old\"" License"",
""LicenseId"": ""BSD-4-Clause"",
""LicenseFile"": ""VALGRIND_LICENSE.txt"",
""Copyright"": ""Copyright (C) 2000-2007 Julian Seward
Copyright (C) 2003-2007 Josef Weidendorfer.""
",False,"```
License: BSD 4-clause \""Original\"" or \""Old\"" License
```"
142,144,NomosTestfiles/BSD/BSD-4-Clause.txt,BSD-4-Clause,"Copyright (c) <year>, <copyright holder>
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:
1. Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in the
   documentation and/or other materials provided with the distribution.
3. All advertising materials mentioning features or use of this software
   must display the following acknowledgement:
   This product includes software developed by the <organization>.
4. Neither the name of the <organization> nor the
   names of its contributors may be used to endorse or promote products
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ''AS IS'' AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY
DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
",False,"```
Copyright (c) <year>, <copyright holder>
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:
1. Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in the
   documentation and/or other materials provided with the distribution.
3. All advertising materials mentioning features or use of this software
   must display the following acknowledgement:
   This product includes software developed by the <organization>.
4. Neither the name of the <organization> nor the
   names of its contributors may be used to endorse or promote products
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ''AS IS'' AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY
DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
143,145,NomosTestfiles/BSD/BSD-4-Clause-UC_and_ISC.txt,"BSD-4-Clause-UC
ISC","/*-
* Copyright (c) 1985, 1988, 1993
* The Regents of the University of California. All rights reserved.
*
* Portions copyright (c) 1999, 2000
* Intel Corporation.
* All rights reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions
* are met:
*
* 1. Redistributions of source code must retain the above copyright
* notice, this list of conditions and the following disclaimer.
*
* 2. Redistributions in binary form must reproduce the above copyright
* notice, this list of conditions and the following disclaimer in the
* documentation and/or other materials provided with the distribution.
*
* 3. All advertising materials mentioning features or use of this software
* must display the following acknowledgement:
*
* This product includes software developed by the University of
* California, Berkeley, Intel Corporation, and its contributors.
*
* 4. Neither the name of University, Intel Corporation, or their respective
* contributors may be used to endorse or promote products derived from
* this software without specific prior written permission.
*
* THIS SOFTWARE IS PROVIDED BY THE REGENTS, INTEL CORPORATION AND
* CONTRIBUTORS ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING,
* BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
* FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE REGENTS,
* INTEL CORPORATION OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
* INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
* NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
* THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
* (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
* THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*
* Portions Copyright (c) 1993 by Digital Equipment Corporation.
*
* Permission to use, copy, modify, and distribute this software for any
* purpose with or without fee is hereby granted, provided that the above
* copyright notice and this permission notice appear in all copies, and that
* the name of Digital Equipment Corporation not be used in advertising or
* publicity pertaining to distribution of the document or software without
* specific, written prior permission.
*
* THE SOFTWARE IS PROVIDED ""AS IS"" AND DIGITAL EQUIPMENT CORP. DISCLAIMS ALL
* WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES
* OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL DIGITAL EQUIPMENT
* CORPORATION BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
* DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
* PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS
* ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS
* SOFTWARE.
* -
* --Copyright--
*/
",False,"```
/*-
* Copyright (c) 1985, 1988, 1993
* The Regents of the University of California. All rights reserved.
*
* Portions copyright (c) 1999, 2000
* Intel Corporation.
* All rights reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions
* are met:
*
* 1. Redistributions of source code must retain the above copyright
* notice, this list of conditions and the following disclaimer.
*
* 2. Redistributions in binary form must reproduce the above copyright
* notice, this list of conditions and the following disclaimer in the
* documentation and/or other materials provided with the distribution.
*
* 3. All advertising materials mentioning features or use of this software
* must display the following acknowledgement:
*
* This product includes software developed by the University of
* California, Berkeley, Intel Corporation, and its contributors.
*
* 4. Neither the name of University, Intel Corporation, or their respective
* contributors may be used to endorse or promote products derived from
* this software without specific prior written permission.
*
* THIS SOFTWARE IS PROVIDED BY THE REGENTS, INTEL CORPORATION AND
* CONTRIBUTORS ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING,
* BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
* FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE REGENTS,
* INTEL CORPORATION OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
* INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
* NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
* THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
* (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
* THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*
* Portions Copyright (c) 1993 by Digital Equipment Corporation.
*
* Permission to use, copy, modify, and distribute this software for any
* purpose with or without fee is hereby granted, provided that the above
* copyright notice and this permission notice appear in all copies, and that
* the name of Digital Equipment Corporation not be used in advertising or
* publicity pertaining to distribution of the document or software without
* specific, written prior permission.
*
* THE SOFTWARE IS PROVIDED ""AS IS"" AND DIGITAL EQUIPMENT CORP. DISCLAIMS ALL
* WARRANTIES WITH REGARD TO THIS SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES
* OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL DIGITAL EQUIPMENT
* CORPORATION BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
* DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
* PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS
* ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS
* SOFTWARE.
*
* -
* --Copyright--
*/
```"
144,146,NomosTestfiles/BSD/BSD-4-Clause-UC.txt,BSD-4-Clause-UC,"BSD-4-Clause (University of California-Specific)

Copyright [various years] The Regents of the University of California. All rights reserved.
 
Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
 
1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
 
2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
 
3. All advertising materials mentioning features or use of this software must display the following acknowledgement: This product includes software developed by the University of California, Berkeley and its contributors.

4. Neither the name of the University nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.
 
THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
",False,"```
Copyright [various years] The Regents of the University of California. All rights reserved.
 
Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
 
1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
 
2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
 
3. All advertising materials mentioning features or use of this software must display the following acknowledgement: This product includes software developed by the University of California, Berkeley and its contributors.

4. Neither the name of the University nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.
 
THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
145,147,NomosTestfiles/BSD/BSD_ref_a.txt,BSD,"/*
* YUI Compressor
* http://developer.yahoo.com/yui/compressor/
* Author: Julien Lecomte - http://www.julienlecomte.net/
* Copyright (c) 2011 Yahoo! Inc. All rights reserved.
* The copyrights embodied in the content of this file are licensed
* by Yahoo! Inc. under the BSD (revised) open source license.
*/
",False,"```
* Copyright (c) 2011 Yahoo! Inc. All rights reserved.
* The copyrights embodied in the content of this file are licensed
* by Yahoo! Inc. under the BSD (revised) open source license.
```"
146,148,NomosTestfiles/BSD/BSD_ref_b.txt,BSD,"CurvesAIP is BSD-licensed software (https://github.com/virtuald/curvesapi/)
Copyright (c) 2005, Graph Builder",False,"```
CurvesAIP is BSD-licensed software (https://github.com/virtuald/curvesapi/)
Copyright (c) 2005, Graph Builder
```"
147,149,NomosTestfiles/BSD/BSD_style_aa.txt,BSD-style,"/* $OpenBSD: umac.c,v 1.4 2011/10/19 10:39:48 djm Exp $ */
/* -----------------------------------------------------------------------
*
* umac.c -- C Implementation UMAC Message Authentication
*
* Version 0.93b of rfc4418.txt -- 2006 July 18
*
* For a full description of UMAC message authentication see the UMAC
* world-wide-web page at http://www.cs.ucdavis.edu/~rogaway/umac
* Please report bugs and suggestions to the UMAC webpage.
*
* Copyright (c) 1999-2006 Ted Krovetz
*
* Permission to use, copy, modify, and distribute this software and
* its documentation for any purpose and with or without fee, is hereby
* granted provided that the above copyright notice appears in all copies
* and in supporting documentation, and that the name of the copyright
* holder not be used in advertising or publicity pertaining to
* distribution of the software without specific, written prior permission.
*
* Comments should be directed to Ted Krovetz (tdk@acm.org)
*
* ---------------------------------------------------------------------- */

/* ////////////////////// IMPORTANT NOTES /////////////////////////////////
*
* 1) This version does not work properly on messages larger than 16MB
*
* 2) If you set the switch to use SSE2, then all data must be 16-byte
* aligned
*
* 3) When calling the function umac(), it is assumed that msg is in
* a writable buffer of length divisible by 32 bytes. The message itself
* does not have to fill the entire buffer, but bytes beyond msg may be
* zeroed.
*
* 4) Three free AES implementations are supported by this implementation of
* UMAC. Paulo Barreto's version is in the public domain and can be found
* at http://www.esat.kuleuven.ac.be/~rijmen/rijndael/ (search for
* ""Barreto""). The only two files needed are rijndael-alg-fst.c and
* rijndael-alg-fst.h. Brian Gladman's version is distributed with the GNU
* Public lisence at http://fp.gladman.plus.com/AES/index.htm. It
* includes a fast IA-32 assembly version. The OpenSSL crypo library is
* the third.
*
* 5) With FORCE_C_ONLY flags set to 0, incorrect results are sometimes
* produced under gcc with optimizations set -O3 or higher. Dunno why.
*
/////////////////////////////////////////////////////////////////////// */

/* ---------------------------------------------------------------------- */
/* --- User Switches ---------------------------------------------------- */
/* ---------------------------------------------------------------------- */

#ifndef UMAC_OUTPUT_LEN
#define UMAC_OUTPUT_LEN 8 /* Alowable: 4, 8, 12, 16 */
#endif

#if UMAC_OUTPUT_LEN != 4 && UMAC_OUTPUT_LEN != 8 && \
UMAC_OUTPUT_LEN != 12 && UMAC_OUTPUT_LEN != 16
# error UMAC_OUTPUT_LEN must be defined to 4, 8, 12 or 16
#endif

/* #define FORCE_C_ONLY 1 ANSI C and 64-bit integers req'd */
/* #define AES_IMPLEMENTAION 1 1 = OpenSSL, 2 = Barreto, 3 = Gladman */
/* #define SSE2 0 Is SSE2 is available? */
/* #define RUN_TESTS 0 Run basic correctness/speed tests */
/* #define UMAC_AE_SUPPORT 0 Enable auhthenticated encrytion */

/* ---------------------------------------------------------------------- */
/* -- Global Includes --------------------------------------------------- */
/* ---------------------------------------------------------------------- */

#include ""includes.h""
#include <sys/types.h>

#include ""xmalloc.h""
#include ""umac.h""
#include <string.h>
#include <stdlib.h>
#include <stddef.h>

/* ---------------------------------------------------------------------- */
/* --- Primitive Data Types --- */
/* ---------------------------------------------------------------------- */

/* The following assumptions may need change on your system */
typedef u_int8_t UINT8; /* 1 byte */
typedef u_int16_t UINT16; /* 2 byte */
typedef u_int32_t UINT32; /* 4 byte */
typedef u_int64_t UINT64; /* 8 bytes */
typedef unsigned int UWORD; /* Register */

/* ---------------------------------------------------------------------- */
/* --- Constants -------------------------------------------------------- */
/* ---------------------------------------------------------------------- */

#define UMAC_KEY_LEN 16 /* UMAC takes 16 bytes of external key */

/* Message ""words"" are read from memory in an endian-specific manner. */
/* For this implementation to behave correctly, __LITTLE_ENDIAN__ must */
/* be set true if the host computer is little-endian. */

#if BYTE_ORDER == LITTLE_ENDIAN
#define __LITTLE_ENDIAN__ 1
#else
#define __LITTLE_ENDIAN__ 0
#endif

/* ---------------------------------------------------------------------- */
/* ---------------------------------------------------------------------- */
/* ----- Architecture Specific ------------------------------------------ */
/* ---------------------------------------------------------------------- */
/* ---------------------------------------------------------------------- */


/* ---------------------------------------------------------------------- */
/* ---------------------------------------------------------------------- */
/* ----- Primitive Routines --------------------------------------------- */
/* ---------------------------------------------------------------------- */
/* ---------------------------------------------------------------------- */


/* ---------------------------------------------------------------------- */
/* --- 32-bit by 32-bit to 64-bit Multiplication ------------------------ */
/* ---------------------------------------------------------------------- */

#define MUL64(a,b) ((UINT64)((UINT64)(UINT32)(a) * (UINT64)(UINT32)(b)))

/* ---------------------------------------------------------------------- */
/* --- Endian Conversion --- Forcing assembly on some platforms */
/* ---------------------------------------------------------------------- */

#if HAVE_SWAP32
#define LOAD_UINT32_REVERSED(p) (swap32(*(UINT32 *)(p)))
#define STORE_UINT32_REVERSED(p,v) (*(UINT32 *)(p) = swap32(v))
#else /* HAVE_SWAP32 */

static UINT32 LOAD_UINT32_REVERSED(void *ptr)
{
UINT32 temp = *(UINT32 *)ptr;
temp = (temp >> 24) | ((temp & 0x00FF0000) >> 8 )
| ((temp & 0x0000FF00) << 8 ) | (temp << 24);
return (UINT32)temp;
}

# if (__LITTLE_ENDIAN__)
static void STORE_UINT32_REVERSED(void *ptr, UINT32 x)
{
UINT32 i = (UINT32)x;
*(UINT32 *)ptr = (i >> 24) | ((i & 0x00FF0000) >> 8 )
| ((i & 0x0000FF00) << 8 ) | (i << 24);
}
# endif /* __LITTLE_ENDIAN */
#endif /* HAVE_SWAP32 */

/* The following definitions use the above reversal-primitives to do the right
* thing on endian specific load and stores.
*/

#if (__LITTLE_ENDIAN__)
#define LOAD_UINT32_LITTLE(ptr) (*(UINT32 *)(ptr))
#define STORE_UINT32_BIG(ptr,x) STORE_UINT32_REVERSED(ptr,x)
#else
#define LOAD_UINT32_LITTLE(ptr) LOAD_UINT32_REVERSED(ptr)
#define STORE_UINT32_BIG(ptr,x) (*(UINT32 *)(ptr) = (UINT32)(x))
#endif

/* ---------------------------------------------------------------------- */
/* ---------------------------------------------------------------------- */
/* ----- Begin KDF & PDF Section ---------------------------------------- */
/* ---------------------------------------------------------------------- */
/* ---------------------------------------------------------------------- */

/* UMAC uses AES with 16 byte block and key lengths */
#define AES_BLOCK_LEN 16

/* OpenSSL's AES */
#include ""openbsd-compat/openssl-compat.h""
#ifndef USE_BUILTIN_RIJNDAEL
# include <openssl/aes.h>
#endif
typedef AES_KEY aes_int_key[1];
#define aes_encryption(in,out,int_key) \
AES_encrypt((u_char *)(in),(u_char *)(out),(AES_KEY *)int_key)
#define aes_key_setup(key,int_key) \
AES_set_encrypt_key((u_char *)(key),UMAC_KEY_LEN*8,int_key)

/* The user-supplied UMAC key is stretched using AES in a counter
* mode to supply all random bits needed by UMAC. The kdf function takes
* an AES internal key representation 'key' and writes a stream of
* 'nbytes' bytes to the memory pointed at by 'bufp'. Each distinct
* 'ndx' causes a distinct byte stream.
*/
static void kdf(void *bufp, aes_int_key key, UINT8 ndx, int nbytes)
{
UINT8 in_buf[AES_BLOCK_LEN] = {0};
UINT8 out_buf[AES_BLOCK_LEN];
UINT8 *dst_buf = (UINT8 *)bufp;
int i;

/* Setup the initial value */
in_buf[AES_BLOCK_LEN-9] = ndx;
in_buf[AES_BLOCK_LEN-1] = i = 1;

while (nbytes >= AES_BLOCK_LEN) {
aes_encryption(in_buf, out_buf, key);
memcpy(dst_buf,out_buf,AES_BLOCK_LEN);
in_buf[AES_BLOCK_LEN-1] = ++i;
nbytes -= AES_BLOCK_LEN;
dst_buf += AES_BLOCK_LEN;
}
if (nbytes) {
aes_encryption(in_buf, out_buf, key);
memcpy(dst_buf,out_buf,nbytes);
}
}

/* The final UHASH result is XOR'd with the output of a pseudorandom
* function. Here, we use AES to generate random output and
* xor the appropriate bytes depending on the last bits of nonce.
* This scheme is optimized for sequential, increasing big-endian nonces.
*/

typedef struct {
UINT8 cache[AES_BLOCK_LEN]; /* Previous AES output is saved */
UINT8 nonce[AES_BLOCK_LEN]; /* The AES input making above cache */
aes_int_key prf_key; /* Expanded AES key for PDF */
} pdf_ctx;

static void pdf_init(pdf_ctx *pc, aes_int_key prf_key)
{
UINT8 buf[UMAC_KEY_LEN];

kdf(buf, prf_key, 0, UMAC_KEY_LEN);
aes_key_setup(buf, pc->prf_key);

/* Initialize pdf and cache */
memset(pc->nonce, 0, sizeof(pc->nonce));
aes_encryption(pc->nonce, pc->cache, pc->prf_key);
}

static void pdf_gen_xor(pdf_ctx *pc, UINT8 nonce[8], UINT8 buf[8])
{
/* 'ndx' indicates that we'll be using the 0th or 1st eight bytes
* of the AES output. If last time around we returned the ndx-1st
* element, then we may have the result in the cache already.
*/

#if (UMAC_OUTPUT_LEN == 4)
#define LOW_BIT_MASK 3
#elif (UMAC_OUTPUT_LEN == 8)
#define LOW_BIT_MASK 1
#elif (UMAC_OUTPUT_LEN > 8)
#define LOW_BIT_MASK 0
#endif

UINT8 tmp_nonce_lo[4];
#if LOW_BIT_MASK != 0
int ndx = nonce[7] & LOW_BIT_MASK;
#endif
*(UINT32 *)tmp_nonce_lo = ((UINT32 *)nonce)[1];
tmp_nonce_lo[3] &= ~LOW_BIT_MASK; /* zero last bit */

if ( (((UINT32 *)tmp_nonce_lo)[0] != ((UINT32 *)pc->nonce)[1]) ||
(((UINT32 *)nonce)[0] != ((UINT32 *)pc->nonce)[0]) )
{
((UINT32 *)pc->nonce)[0] = ((UINT32 *)nonce)[0];
((UINT32 *)pc->nonce)[1] = ((UINT32 *)tmp_nonce_lo)[0];
aes_encryption(pc->nonce, pc->cache, pc->prf_key);
}

#if (UMAC_OUTPUT_LEN == 4)
*((UINT32 *)buf) ^= ((UINT32 *)pc->cache)[ndx];
#elif (UMAC_OUTPUT_LEN == 8)
*((UINT64 *)buf) ^= ((UINT64 *)pc->cache)[ndx];
#elif (UMAC_OUTPUT_LEN == 12)
((UINT64 *)buf)[0] ^= ((UINT64 *)pc->cache)[0];
((UINT32 *)buf)[2] ^= ((UINT32 *)pc->cache)[2];
#elif (UMAC_OUTPUT_LEN == 16)
((UINT64 *)buf)[0] ^= ((UINT64 *)pc->cache)[0];
((UINT64 *)buf)[1] ^= ((UINT64 *)pc->cache)[1];
#endif
}

/* ---------------------------------------------------------------------- */
/* ---------------------------------------------------------------------- */
/* ----- Begin NH Hash Section ------------------------------------------ */
/* ---------------------------------------------------------------------- */
/* ---------------------------------------------------------------------- */

/* The NH-based hash functions used in UMAC are described in the UMAC paper
* and specification, both of which can be found at the UMAC website.
* The interface to this implementation has two
* versions, one expects the entire message being hashed to be passed
* in a single buffer and returns the hash result immediately. The second
* allows the message to be passed in a sequence of buffers. In the
* muliple-buffer interface, the client calls the routine nh_update() as
* many times as necessary. When there is no more data to be fed to the
* hash, the client calls nh_final() which calculates the hash output.
* Before beginning another hash calculation the nh_reset() routine
* must be called. The single-buffer routine, nh(), is equivalent to
* the sequence of calls nh_update() and nh_final(); however it is
* optimized and should be prefered whenever the multiple-buffer interface
* is not necessary. When using either interface, it is the client's
* responsability to pass no more than L1_KEY_LEN bytes per hash result.
*
* The routine nh_init() initializes the nh_ctx data structure and
* must be called once, before any other PDF routine.
*/

/* The ""nh_aux"" routines do the actual NH hashing work. They
* expect buffers to be multiples of L1_PAD_BOUNDARY. These routines
* produce output for all STREAMS NH iterations in one call,
* allowing the parallel implementation of the streams.
*/

#define STREAMS (UMAC_OUTPUT_LEN / 4) /* Number of times hash is applied */
#define L1_KEY_LEN 1024 /* Internal key bytes */
#define L1_KEY_SHIFT 16 /* Toeplitz key shift between streams */
#define L1_PAD_BOUNDARY 32 /* pad message to boundary multiple */
#define ALLOC_BOUNDARY 16 /* Keep buffers aligned to this */
#define HASH_BUF_BYTES 64 /* nh_aux_hb buffer multiple */

typedef struct {
UINT8 nh_key [L1_KEY_LEN + L1_KEY_SHIFT * (STREAMS - 1)]; /* NH Key */
UINT8 data [HASH_BUF_BYTES]; /* Incoming data buffer */
int next_data_empty; /* Bookeeping variable for data buffer. */
int bytes_hashed; /* Bytes (out of L1_KEY_LEN) incorperated. */
UINT64 state[STREAMS]; /* on-line state */
} nh_ctx;


#if (UMAC_OUTPUT_LEN == 4)

static void nh_aux(void *kp, void *dp, void *hp, UINT32 dlen)
/* NH hashing primitive. Previous (partial) hash result is loaded and
* then stored via hp pointer. The length of the data pointed at by ""dp"",
* ""dlen"", is guaranteed to be divisible by L1_PAD_BOUNDARY (32). Key
* is expected to be endian compensated in memory at key setup.
*/
{
UINT64 h;
UWORD c = dlen / 32;
UINT32 *k = (UINT32 *)kp;
UINT32 *d = (UINT32 *)dp;
UINT32 d0,d1,d2,d3,d4,d5,d6,d7;
UINT32 k0,k1,k2,k3,k4,k5,k6,k7;

h = *((UINT64 *)hp);
do {
d0 = LOAD_UINT32_LITTLE(d+0); d1 = LOAD_UINT32_LITTLE(d+1);
d2 = LOAD_UINT32_LITTLE(d+2); d3 = LOAD_UINT32_LITTLE(d+3);
d4 = LOAD_UINT32_LITTLE(d+4); d5 = LOAD_UINT32_LITTLE(d+5);
d6 = LOAD_UINT32_LITTLE(d+6); d7 = LOAD_UINT32_LITTLE(d+7);
k0 = *(k+0); k1 = *(k+1); k2 = *(k+2); k3 = *(k+3);
k4 = *(k+4); k5 = *(k+5); k6 = *(k+6); k7 = *(k+7);
h += MUL64((k0 + d0), (k4 + d4));
h += MUL64((k1 + d1), (k5 + d5));
h += MUL64((k2 + d2), (k6 + d6));
h += MUL64((k3 + d3), (k7 + d7));

d += 8;
k += 8;
} while (--c);
*((UINT64 *)hp) = h;
}

#elif (UMAC_OUTPUT_LEN == 8)

static void nh_aux(void *kp, void *dp, void *hp, UINT32 dlen)
/* Same as previous nh_aux, but two streams are handled in one pass,
* reading and writing 16 bytes of hash-state per call.
*/
{
UINT64 h1,h2;
UWORD c = dlen / 32;
UINT32 *k = (UINT32 *)kp;
UINT32 *d = (UINT32 *)dp;
UINT32 d0,d1,d2,d3,d4,d5,d6,d7;
UINT32 k0,k1,k2,k3,k4,k5,k6,k7,
k8,k9,k10,k11;

h1 = *((UINT64 *)hp);
h2 = *((UINT64 *)hp + 1);
k0 = *(k+0); k1 = *(k+1); k2 = *(k+2); k3 = *(k+3);
do {
d0 = LOAD_UINT32_LITTLE(d+0); d1 = LOAD_UINT32_LITTLE(d+1);
d2 = LOAD_UINT32_LITTLE(d+2); d3 = LOAD_UINT32_LITTLE(d+3);
d4 = LOAD_UINT32_LITTLE(d+4); d5 = LOAD_UINT32_LITTLE(d+5);
d6 = LOAD_UINT32_LITTLE(d+6); d7 = LOAD_UINT32_LITTLE(d+7);
k4 = *(k+4); k5 = *(k+5); k6 = *(k+6); k7 = *(k+7);
k8 = *(k+8); k9 = *(k+9); k10 = *(k+10); k11 = *(k+11);

h1 += MUL64((k0 + d0), (k4 + d4));
h2 += MUL64((k4 + d0), (k8 + d4));

h1 += MUL64((k1 + d1), (k5 + d5));
h2 += MUL64((k5 + d1), (k9 + d5));

h1 += MUL64((k2 + d2), (k6 + d6));
h2 += MUL64((k6 + d2), (k10 + d6));

h1 += MUL64((k3 + d3), (k7 + d7));
h2 += MUL64((k7 + d3), (k11 + d7));

k0 = k8; k1 = k9; k2 = k10; k3 = k11;

d += 8;
k += 8;
} while (--c);
((UINT64 *)hp)[0] = h1;
((UINT64 *)hp)[1] = h2;
}

#elif (UMAC_OUTPUT_LEN == 12)

static void nh_aux(void *kp, void *dp, void *hp, UINT32 dlen)
/* Same as previous nh_aux, but two streams are handled in one pass,
* reading and writing 24 bytes of hash-state per call.
*/
{
UINT64 h1,h2,h3;
UWORD c = dlen / 32;
UINT32 *k = (UINT32 *)kp;
UINT32 *d = (UINT32 *)dp;
UINT32 d0,d1,d2,d3,d4,d5,d6,d7;
UINT32 k0,k1,k2,k3,k4,k5,k6,k7,
k8,k9,k10,k11,k12,k13,k14,k15;

h1 = *((UINT64 *)hp);
h2 = *((UINT64 *)hp + 1);
h3 = *((UINT64 *)hp + 2);
k0 = *(k+0); k1 = *(k+1); k2 = *(k+2); k3 = *(k+3);
k4 = *(k+4); k5 = *(k+5); k6 = *(k+6); k7 = *(k+7);
do {
d0 = LOAD_UINT32_LITTLE(d+0); d1 = LOAD_UINT32_LITTLE(d+1);
d2 = LOAD_UINT32_LITTLE(d+2); d3 = LOAD_UINT32_LITTLE(d+3);
d4 = LOAD_UINT32_LITTLE(d+4); d5 = LOAD_UINT32_LITTLE(d+5);
d6 = LOAD_UINT32_LITTLE(d+6); d7 = LOAD_UINT32_LITTLE(d+7);
k8 = *(k+8); k9 = *(k+9); k10 = *(k+10); k11 = *(k+11);
k12 = *(k+12); k13 = *(k+13); k14 = *(k+14); k15 = *(k+15);

h1 += MUL64((k0 + d0), (k4 + d4));
h2 += MUL64((k4 + d0), (k8 + d4));
h3 += MUL64((k8 + d0), (k12 + d4));

h1 += MUL64((k1 + d1), (k5 + d5));
h2 += MUL64((k5 + d1), (k9 + d5));
h3 += MUL64((k9 + d1), (k13 + d5));

h1 += MUL64((k2 + d2), (k6 + d6));
h2 += MUL64((k6 + d2), (k10 + d6));
h3 += MUL64((k10 + d2), (k14 + d6));

h1 += MUL64((k3 + d3), (k7 + d7));
h2 += MUL64((k7 + d3), (k11 + d7));
h3 += MUL64((k11 + d3), (k15 + d7));

k0 = k8; k1 = k9; k2 = k10; k3 = k11;
k4 = k12; k5 = k13; k6 = k14; k7 = k15;

d += 8;
k += 8;
} while (--c);
((UINT64 *)hp)[0] = h1;
((UINT64 *)hp)[1] = h2;
((UINT64 *)hp)[2] = h3;
}

#elif (UMAC_OUTPUT_LEN == 16)

static void nh_aux(void *kp, void *dp, void *hp, UINT32 dlen)
/* Same as previous nh_aux, but two streams are handled in one pass,
* reading and writing 24 bytes of hash-state per call.
*/
{
UINT64 h1,h2,h3,h4;
UWORD c = dlen / 32;
UINT32 *k = (UINT32 *)kp;
UINT32 *d = (UINT32 *)dp;
UINT32 d0,d1,d2,d3,d4,d5,d6,d7;
UINT32 k0,k1,k2,k3,k4,k5,k6,k7,
k8,k9,k10,k11,k12,k13,k14,k15,
k16,k17,k18,k19;

h1 = *((UINT64 *)hp);
h2 = *((UINT64 *)hp + 1);
h3 = *((UINT64 *)hp + 2);
h4 = *((UINT64 *)hp + 3);
k0 = *(k+0); k1 = *(k+1); k2 = *(k+2); k3 = *(k+3);
k4 = *(k+4); k5 = *(k+5); k6 = *(k+6); k7 = *(k+7);
do {
d0 = LOAD_UINT32_LITTLE(d+0); d1 = LOAD_UINT32_LITTLE(d+1);
d2 = LOAD_UINT32_LITTLE(d+2); d3 = LOAD_UINT32_LITTLE(d+3);
d4 = LOAD_UINT32_LITTLE(d+4); d5 = LOAD_UINT32_LITTLE(d+5);
d6 = LOAD_UINT32_LITTLE(d+6); d7 = LOAD_UINT32_LITTLE(d+7);
k8 = *(k+8); k9 = *(k+9); k10 = *(k+10); k11 = *(k+11);
k12 = *(k+12); k13 = *(k+13); k14 = *(k+14); k15 = *(k+15);
k16 = *(k+16); k17 = *(k+17); k18 = *(k+18); k19 = *(k+19);

h1 += MUL64((k0 + d0), (k4 + d4));
h2 += MUL64((k4 + d0), (k8 + d4));
h3 += MUL64((k8 + d0), (k12 + d4));
h4 += MUL64((k12 + d0), (k16 + d4));

h1 += MUL64((k1 + d1), (k5 + d5));
h2 += MUL64((k5 + d1), (k9 + d5));
h3 += MUL64((k9 + d1), (k13 + d5));
h4 += MUL64((k13 + d1), (k17 + d5));

h1 += MUL64((k2 + d2), (k6 + d6));
h2 += MUL64((k6 + d2), (k10 + d6));
h3 += MUL64((k10 + d2), (k14 + d6));
h4 += MUL64((k14 + d2), (k18 + d6));

h1 += MUL64((k3 + d3), (k7 + d7));
h2 += MUL64((k7 + d3), (k11 + d7));
h3 += MUL64((k11 + d3), (k15 + d7));
h4 += MUL64((k15 + d3), (k19 + d7));

k0 = k8; k1 = k9; k2 = k10; k3 = k11;
k4 = k12; k5 = k13; k6 = k14; k7 = k15;
k8 = k16; k9 = k17; k10 = k18; k11 = k19;

d += 8;
k += 8;
} while (--c);
((UINT64 *)hp)[0] = h1;
((UINT64 *)hp)[1] = h2;
((UINT64 *)hp)[2] = h3;
((UINT64 *)hp)[3] = h4;
}

/* ---------------------------------------------------------------------- */
#endif /* UMAC_OUTPUT_LENGTH */
/* ---------------------------------------------------------------------- */


/* ---------------------------------------------------------------------- */

static void nh_transform(nh_ctx *hc, UINT8 *buf, UINT32 nbytes)
/* This function is a wrapper for the primitive NH hash functions. It takes
* as argument ""hc"" the current hash context and a buffer which must be a
* multiple of L1_PAD_BOUNDARY. The key passed to nh_aux is offset
* appropriately according to how much message has been hashed already.
*/
{
UINT8 *key;

key = hc->nh_key + hc->bytes_hashed;
nh_aux(key, buf, hc->state, nbytes);
}

/* ---------------------------------------------------------------------- */

#if (__LITTLE_ENDIAN__)
static void endian_convert(void *buf, UWORD bpw, UINT32 num_bytes)
/* We endian convert the keys on little-endian computers to */
/* compensate for the lack of big-endian memory reads during hashing. */
{
UWORD iters = num_bytes / bpw;
if (bpw == 4) {
UINT32 *p = (UINT32 *)buf;
do {
*p = LOAD_UINT32_REVERSED(p);
p++;
} while (--iters);
} else if (bpw == 8) {
UINT32 *p = (UINT32 *)buf;
UINT32 t;
do {
t = LOAD_UINT32_REVERSED(p+1);
p[1] = LOAD_UINT32_REVERSED(p);
p[0] = t;
p += 2;
} while (--iters);
}
}
#define endian_convert_if_le(x,y,z) endian_convert((x),(y),(z))
#else
#define endian_convert_if_le(x,y,z) do{}while(0) /* Do nothing */
#endif

/* ---------------------------------------------------------------------- */

static void nh_reset(nh_ctx *hc)
/* Reset nh_ctx to ready for hashing of new data */
{
hc->bytes_hashed = 0;
hc->next_data_empty = 0;
hc->state[0] = 0;
#if (UMAC_OUTPUT_LEN >= 8)
hc->state[1] = 0;
#endif
#if (UMAC_OUTPUT_LEN >= 12)
hc->state[2] = 0;
#endif
#if (UMAC_OUTPUT_LEN == 16)
hc->state[3] = 0;
#endif

}

/* ---------------------------------------------------------------------- */

static void nh_init(nh_ctx *hc, aes_int_key prf_key)
/* Generate nh_key, endian convert and reset to be ready for hashing. */
{
kdf(hc->nh_key, prf_key, 1, sizeof(hc->nh_key));
endian_convert_if_le(hc->nh_key, 4, sizeof(hc->nh_key));
nh_reset(hc);
}

/* ---------------------------------------------------------------------- */

static void nh_update(nh_ctx *hc, UINT8 *buf, UINT32 nbytes)
/* Incorporate nbytes of data into a nh_ctx, buffer whatever is not an */
/* even multiple of HASH_BUF_BYTES. */
{
UINT32 i,j;

j = hc->next_data_empty;
if ((j + nbytes) >= HASH_BUF_BYTES) {
if (j) {
i = HASH_BUF_BYTES - j;
memcpy(hc->data+j, buf, i);
nh_transform(hc,hc->data,HASH_BUF_BYTES);
nbytes -= i;
buf += i;
hc->bytes_hashed += HASH_BUF_BYTES;
}
if (nbytes >= HASH_BUF_BYTES) {
i = nbytes & ~(HASH_BUF_BYTES - 1);
nh_transform(hc, buf, i);
nbytes -= i;
buf += i;
hc->bytes_hashed += i;
}
j = 0;
}
memcpy(hc->data + j, buf, nbytes);
hc->next_data_empty = j + nbytes;
}

/* ---------------------------------------------------------------------- */

static void zero_pad(UINT8 *p, int nbytes)
{
/* Write ""nbytes"" of zeroes, beginning at ""p"" */
if (nbytes >= (int)sizeof(UWORD)) {
while ((ptrdiff_t)p % sizeof(UWORD)) {
*p = 0;
nbytes--;
p++;
}
while (nbytes >= (int)sizeof(UWORD)) {
*(UWORD *)p = 0;
nbytes -= sizeof(UWORD);
p += sizeof(UWORD);
}
}
while (nbytes) {
*p = 0;
nbytes--;
p++;
}
}

/* ---------------------------------------------------------------------- */

static void nh_final(nh_ctx *hc, UINT8 *result)
/* After passing some number of data buffers to nh_update() for integration
* into an NH context, nh_final is called to produce a hash result. If any
* bytes are in the buffer hc->data, incorporate them into the
* NH context. Finally, add into the NH accumulation ""state"" the total number
* of bits hashed. The resulting numbers are written to the buffer ""result"".
* If nh_update was never called, L1_PAD_BOUNDARY zeroes are incorporated.
*/
{
int nh_len, nbits;

if (hc->next_data_empty != 0) {
nh_len = ((hc->next_data_empty + (L1_PAD_BOUNDARY - 1)) &
~(L1_PAD_BOUNDARY - 1));
zero_pad(hc->data + hc->next_data_empty,
nh_len - hc->next_data_empty);
nh_transform(hc, hc->data, nh_len);
hc->bytes_hashed += hc->next_data_empty;
} else if (hc->bytes_hashed == 0) {
nh_len = L1_PAD_BOUNDARY;
zero_pad(hc->data, L1_PAD_BOUNDARY);
nh_transform(hc, hc->data, nh_len);
}

nbits = (hc->bytes_hashed << 3);
((UINT64 *)result)[0] = ((UINT64 *)hc->state)[0] + nbits;
#if (UMAC_OUTPUT_LEN >= 8)
((UINT64 *)result)[1] = ((UINT64 *)hc->state)[1] + nbits;
#endif
#if (UMAC_OUTPUT_LEN >= 12)
((UINT64 *)result)[2] = ((UINT64 *)hc->state)[2] + nbits;
#endif
#if (UMAC_OUTPUT_LEN == 16)
((UINT64 *)result)[3] = ((UINT64 *)hc->state)[3] + nbits;
#endif
nh_reset(hc);
}

/* ---------------------------------------------------------------------- */

static void nh(nh_ctx *hc, UINT8 *buf, UINT32 padded_len,
UINT32 unpadded_len, UINT8 *result)
/* All-in-one nh_update() and nh_final() equivalent.
* Assumes that padded_len is divisible by L1_PAD_BOUNDARY and result is
* well aligned
*/
{
UINT32 nbits;

/* Initialize the hash state */
nbits = (unpadded_len << 3);

((UINT64 *)result)[0] = nbits;
#if (UMAC_OUTPUT_LEN >= 8)
((UINT64 *)result)[1] = nbits;
#endif
#if (UMAC_OUTPUT_LEN >= 12)
((UINT64 *)result)[2] = nbits;
#endif
#if (UMAC_OUTPUT_LEN == 16)
((UINT64 *)result)[3] = nbits;
#endif

nh_aux(hc->nh_key, buf, result, padded_len);
}

/* ---------------------------------------------------------------------- */
/* ---------------------------------------------------------------------- */
/* ----- Begin UHASH Section -------------------------------------------- */
/* ---------------------------------------------------------------------- */
/* ---------------------------------------------------------------------- */

/* UHASH is a multi-layered algorithm. Data presented to UHASH is first
* hashed by NH. The NH output is then hashed by a polynomial-hash layer
* unless the initial data to be hashed is short. After the polynomial-
* layer, an inner-product hash is used to produce the final UHASH output.
*
* UHASH provides two interfaces, one all-at-once and another where data
* buffers are presented sequentially. In the sequential interface, the
* UHASH client calls the routine uhash_update() as many times as necessary.
* When there is no more data to be fed to UHASH, the client calls
* uhash_final() which
* calculates the UHASH output. Before beginning another UHASH calculation
* the uhash_reset() routine must be called. The all-at-once UHASH routine,
* uhash(), is equivalent to the sequence of calls uhash_update() and
* uhash_final(); however it is optimized and should be
* used whenever the sequential interface is not necessary.
*
* The routine uhash_init() initializes the uhash_ctx data structure and
* must be called once, before any other UHASH routine.
*/

/* ---------------------------------------------------------------------- */
/* ----- Constants and uhash_ctx ---------------------------------------- */
/* ---------------------------------------------------------------------- */

/* ---------------------------------------------------------------------- */
/* ----- Poly hash and Inner-Product hash Constants --------------------- */
/* ---------------------------------------------------------------------- */

/* Primes and masks */
#define p36 ((UINT64)0x0000000FFFFFFFFBull) /* 2^36 - 5 */
#define p64 ((UINT64)0xFFFFFFFFFFFFFFC5ull) /* 2^64 - 59 */
#define m36 ((UINT64)0x0000000FFFFFFFFFull) /* The low 36 of 64 bits */


/* ---------------------------------------------------------------------- */

typedef struct uhash_ctx {
nh_ctx hash; /* Hash context for L1 NH hash */
UINT64 poly_key_8[STREAMS]; /* p64 poly keys */
UINT64 poly_accum[STREAMS]; /* poly hash result */
UINT64 ip_keys[STREAMS*4]; /* Inner-product keys */
UINT32 ip_trans[STREAMS]; /* Inner-product translation */
UINT32 msg_len; /* Total length of data passed */
/* to uhash */
} uhash_ctx;
typedef struct uhash_ctx *uhash_ctx_t;

/* ---------------------------------------------------------------------- */


/* The polynomial hashes use Horner's rule to evaluate a polynomial one
* word at a time. As described in the specification, poly32 and poly64
* require keys from special domains. The following implementations exploit
* the special domains to avoid overflow. The results are not guaranteed to
* be within Z_p32 and Z_p64, but the Inner-Product hash implementation
* patches any errant values.
*/

static UINT64 poly64(UINT64 cur, UINT64 key, UINT64 data)
{
UINT32 key_hi = (UINT32)(key >> 32),
key_lo = (UINT32)key,
cur_hi = (UINT32)(cur >> 32),
cur_lo = (UINT32)cur,
x_lo,
x_hi;
UINT64 X,T,res;

X = MUL64(key_hi, cur_lo) + MUL64(cur_hi, key_lo);
x_lo = (UINT32)X;
x_hi = (UINT32)(X >> 32);

res = (MUL64(key_hi, cur_hi) + x_hi) * 59 + MUL64(key_lo, cur_lo);

T = ((UINT64)x_lo << 32);
res += T;
if (res < T)
res += 59;

res += data;
if (res < data)
res += 59;

return res;
}


/* Although UMAC is specified to use a ramped polynomial hash scheme, this
* implementation does not handle all ramp levels. Because we don't handle
* the ramp up to p128 modulus in this implementation, we are limited to
* 2^14 poly_hash() invocations per stream (for a total capacity of 2^24
* bytes input to UMAC per tag, ie. 16MB).
*/
static void poly_hash(uhash_ctx_t hc, UINT32 data_in[])
{
int i;
UINT64 *data=(UINT64*)data_in;

for (i = 0; i < STREAMS; i++) {
if ((UINT32)(data[i] >> 32) == 0xfffffffful) {
hc->poly_accum[i] = poly64(hc->poly_accum[i],
hc->poly_key_8[i], p64 - 1);
hc->poly_accum[i] = poly64(hc->poly_accum[i],
hc->poly_key_8[i], (data[i] - 59));
} else {
hc->poly_accum[i] = poly64(hc->poly_accum[i],
hc->poly_key_8[i], data[i]);
}
}
}


/* ---------------------------------------------------------------------- */


/* The final step in UHASH is an inner-product hash. The poly hash
* produces a result not neccesarily WORD_LEN bytes long. The inner-
* product hash breaks the polyhash output into 16-bit chunks and
* multiplies each with a 36 bit key.
*/

static UINT64 ip_aux(UINT64 t, UINT64 *ipkp, UINT64 data)
{
t = t + ipkp[0] * (UINT64)(UINT16)(data >> 48);
t = t + ipkp[1] * (UINT64)(UINT16)(data >> 32);
t = t + ipkp[2] * (UINT64)(UINT16)(data >> 16);
t = t + ipkp[3] * (UINT64)(UINT16)(data);

return t;
}

static UINT32 ip_reduce_p36(UINT64 t)
{
/* Divisionless modular reduction */
UINT64 ret;

ret = (t & m36) + 5 * (t >> 36);
if (ret >= p36)
ret -= p36;

/* return least significant 32 bits */
return (UINT32)(ret);
}


/* If the data being hashed by UHASH is no longer than L1_KEY_LEN, then
* the polyhash stage is skipped and ip_short is applied directly to the
* NH output.
*/
static void ip_short(uhash_ctx_t ahc, UINT8 *nh_res, u_char *res)
{
UINT64 t;
UINT64 *nhp = (UINT64 *)nh_res;

t = ip_aux(0,ahc->ip_keys, nhp[0]);
STORE_UINT32_BIG((UINT32 *)res+0, ip_reduce_p36(t) ^ ahc->ip_trans[0]);
#if (UMAC_OUTPUT_LEN >= 8)
t = ip_aux(0,ahc->ip_keys+4, nhp[1]);
STORE_UINT32_BIG((UINT32 *)res+1, ip_reduce_p36(t) ^ ahc->ip_trans[1]);
#endif
#if (UMAC_OUTPUT_LEN >= 12)
t = ip_aux(0,ahc->ip_keys+8, nhp[2]);
STORE_UINT32_BIG((UINT32 *)res+2, ip_reduce_p36(t) ^ ahc->ip_trans[2]);
#endif
#if (UMAC_OUTPUT_LEN == 16)
t = ip_aux(0,ahc->ip_keys+12, nhp[3]);
STORE_UINT32_BIG((UINT32 *)res+3, ip_reduce_p36(t) ^ ahc->ip_trans[3]);
#endif
}

/* If the data being hashed by UHASH is longer than L1_KEY_LEN, then
* the polyhash stage is not skipped and ip_long is applied to the
* polyhash output.
*/
static void ip_long(uhash_ctx_t ahc, u_char *res)
{
int i;
UINT64 t;

for (i = 0; i < STREAMS; i++) {
/* fix polyhash output not in Z_p64 */
if (ahc->poly_accum[i] >= p64)
ahc->poly_accum[i] -= p64;
t = ip_aux(0,ahc->ip_keys+(i*4), ahc->poly_accum[i]);
STORE_UINT32_BIG((UINT32 *)res+i,
ip_reduce_p36(t) ^ ahc->ip_trans[i]);
}
}


/* ---------------------------------------------------------------------- */

/* ---------------------------------------------------------------------- */

/* Reset uhash context for next hash session */
static int uhash_reset(uhash_ctx_t pc)
{
nh_reset(&pc->hash);
pc->msg_len = 0;
pc->poly_accum[0] = 1;
#if (UMAC_OUTPUT_LEN >= 8)
pc->poly_accum[1] = 1;
#endif
#if (UMAC_OUTPUT_LEN >= 12)
pc->poly_accum[2] = 1;
#endif
#if (UMAC_OUTPUT_LEN == 16)
pc->poly_accum[3] = 1;
#endif
return 1;
}

/* ---------------------------------------------------------------------- */

/* Given a pointer to the internal key needed by kdf() and a uhash context,
* initialize the NH context and generate keys needed for poly and inner-
* product hashing. All keys are endian adjusted in memory so that native
* loads cause correct keys to be in registers during calculation.
*/
static void uhash_init(uhash_ctx_t ahc, aes_int_key prf_key)
{
int i;
UINT8 buf[(8*STREAMS+4)*sizeof(UINT64)];

/* Zero the entire uhash context */
memset(ahc, 0, sizeof(uhash_ctx));

/* Initialize the L1 hash */
nh_init(&ahc->hash, prf_key);

/* Setup L2 hash variables */
kdf(buf, prf_key, 2, sizeof(buf)); /* Fill buffer with index 1 key */
for (i = 0; i < STREAMS; i++) {
/* Fill keys from the buffer, skipping bytes in the buffer not
* used by this implementation. Endian reverse the keys if on a
* little-endian computer.
*/
memcpy(ahc->poly_key_8+i, buf+24*i, 8);
endian_convert_if_le(ahc->poly_key_8+i, 8, 8);
/* Mask the 64-bit keys to their special domain */
ahc->poly_key_8[i] &= ((UINT64)0x01ffffffu << 32) + 0x01ffffffu;
ahc->poly_accum[i] = 1; /* Our polyhash prepends a non-zero word */
}

/* Setup L3-1 hash variables */
kdf(buf, prf_key, 3, sizeof(buf)); /* Fill buffer with index 2 key */
for (i = 0; i < STREAMS; i++)
memcpy(ahc->ip_keys+4*i, buf+(8*i+4)*sizeof(UINT64),
4*sizeof(UINT64));
endian_convert_if_le(ahc->ip_keys, sizeof(UINT64),
sizeof(ahc->ip_keys));
for (i = 0; i < STREAMS*4; i++)
ahc->ip_keys[i] %= p36; /* Bring into Z_p36 */

/* Setup L3-2 hash variables */
/* Fill buffer with index 4 key */
kdf(ahc->ip_trans, prf_key, 4, STREAMS * sizeof(UINT32));
endian_convert_if_le(ahc->ip_trans, sizeof(UINT32),
STREAMS * sizeof(UINT32));
}

/* ---------------------------------------------------------------------- */

#if 0
static uhash_ctx_t uhash_alloc(u_char key[])
{
/* Allocate memory and force to a 16-byte boundary. */
uhash_ctx_t ctx;
u_char bytes_to_add;
aes_int_key prf_key;

ctx = (uhash_ctx_t)malloc(sizeof(uhash_ctx)+ALLOC_BOUNDARY);
if (ctx) {
if (ALLOC_BOUNDARY) {
bytes_to_add = ALLOC_BOUNDARY -
((ptrdiff_t)ctx & (ALLOC_BOUNDARY -1));
ctx = (uhash_ctx_t)((u_char *)ctx + bytes_to_add);
*((u_char *)ctx - 1) = bytes_to_add;
}
aes_key_setup(key,prf_key);
uhash_init(ctx, prf_key);
}
return (ctx);
}
#endif

/* ---------------------------------------------------------------------- */

#if 0
static int uhash_free(uhash_ctx_t ctx)
{
/* Free memory allocated by uhash_alloc */
u_char bytes_to_sub;

if (ctx) {
if (ALLOC_BOUNDARY) {
bytes_to_sub = *((u_char *)ctx - 1);
ctx = (uhash_ctx_t)((u_char *)ctx - bytes_to_sub);
}
free(ctx);
}
return (1);
}
#endif
/* ---------------------------------------------------------------------- */

static int uhash_update(uhash_ctx_t ctx, u_char *input, long len)
/* Given len bytes of data, we parse it into L1_KEY_LEN chunks and
* hash each one with NH, calling the polyhash on each NH output.
*/
{
UWORD bytes_hashed, bytes_remaining;
UINT64 result_buf[STREAMS];
UINT8 *nh_result = (UINT8 *)&result_buf;

if (ctx->msg_len + len <= L1_KEY_LEN) {
nh_update(&ctx->hash, (UINT8 *)input, len);
ctx->msg_len += len;
} else {

bytes_hashed = ctx->msg_len % L1_KEY_LEN;
if (ctx->msg_len == L1_KEY_LEN)
bytes_hashed = L1_KEY_LEN;

if (bytes_hashed + len >= L1_KEY_LEN) {

/* If some bytes have been passed to the hash function */
/* then we want to pass at most (L1_KEY_LEN - bytes_hashed) */
/* bytes to complete the current nh_block. */
if (bytes_hashed) {
bytes_remaining = (L1_KEY_LEN - bytes_hashed);
nh_update(&ctx->hash, (UINT8 *)input, bytes_remaining);
nh_final(&ctx->hash, nh_result);
ctx->msg_len += bytes_remaining;
poly_hash(ctx,(UINT32 *)nh_result);
len -= bytes_remaining;
input += bytes_remaining;
}

/* Hash directly from input stream if enough bytes */
while (len >= L1_KEY_LEN) {
nh(&ctx->hash, (UINT8 *)input, L1_KEY_LEN,
L1_KEY_LEN, nh_result);
ctx->msg_len += L1_KEY_LEN;
len -= L1_KEY_LEN;
input += L1_KEY_LEN;
poly_hash(ctx,(UINT32 *)nh_result);
}
}

/* pass remaining < L1_KEY_LEN bytes of input data to NH */
if (len) {
nh_update(&ctx->hash, (UINT8 *)input, len);
ctx->msg_len += len;
}
}

return (1);
}

/* ---------------------------------------------------------------------- */

static int uhash_final(uhash_ctx_t ctx, u_char *res)
/* Incorporate any pending data, pad, and generate tag */
{
UINT64 result_buf[STREAMS];
UINT8 *nh_result = (UINT8 *)&result_buf;

if (ctx->msg_len > L1_KEY_LEN) {
if (ctx->msg_len % L1_KEY_LEN) {
nh_final(&ctx->hash, nh_result);
poly_hash(ctx,(UINT32 *)nh_result);
}
ip_long(ctx, res);
} else {
nh_final(&ctx->hash, nh_result);
ip_short(ctx,nh_result, res);
}
uhash_reset(ctx);
return (1);
}

/* ---------------------------------------------------------------------- */

#if 0
static int uhash(uhash_ctx_t ahc, u_char *msg, long len, u_char *res)
/* assumes that msg is in a writable buffer of length divisible by */
/* L1_PAD_BOUNDARY. Bytes beyond msg[len] may be zeroed. */
{
UINT8 nh_result[STREAMS*sizeof(UINT64)];
UINT32 nh_len;
int extra_zeroes_needed;

/* If the message to be hashed is no longer than L1_HASH_LEN, we skip
* the polyhash.
*/
if (len <= L1_KEY_LEN) {
if (len == 0) /* If zero length messages will not */
nh_len = L1_PAD_BOUNDARY; /* be seen, comment out this case */
else
nh_len = ((len + (L1_PAD_BOUNDARY - 1)) & ~(L1_PAD_BOUNDARY - 1));
extra_zeroes_needed = nh_len - len;
zero_pad((UINT8 *)msg + len, extra_zeroes_needed);
nh(&ahc->hash, (UINT8 *)msg, nh_len, len, nh_result);
ip_short(ahc,nh_result, res);
} else {
/* Otherwise, we hash each L1_KEY_LEN chunk with NH, passing the NH
* output to poly_hash().
*/
do {
nh(&ahc->hash, (UINT8 *)msg, L1_KEY_LEN, L1_KEY_LEN, nh_result);
poly_hash(ahc,(UINT32 *)nh_result);
len -= L1_KEY_LEN;
msg += L1_KEY_LEN;
} while (len >= L1_KEY_LEN);
if (len) {
nh_len = ((len + (L1_PAD_BOUNDARY - 1)) & ~(L1_PAD_BOUNDARY - 1));
extra_zeroes_needed = nh_len - len;
zero_pad((UINT8 *)msg + len, extra_zeroes_needed);
nh(&ahc->hash, (UINT8 *)msg, nh_len, len, nh_result);
poly_hash(ahc,(UINT32 *)nh_result);
}

ip_long(ahc, res);
}

uhash_reset(ahc);
return 1;
}
#endif

/* ---------------------------------------------------------------------- */
/* ---------------------------------------------------------------------- */
/* ----- Begin UMAC Section --------------------------------------------- */
/* ---------------------------------------------------------------------- */
/* ---------------------------------------------------------------------- */

/* The UMAC interface has two interfaces, an all-at-once interface where
* the entire message to be authenticated is passed to UMAC in one buffer,
* and a sequential interface where the message is presented a little at a
* time. The all-at-once is more optimaized than the sequential version and
* should be preferred when the sequential interface is not required.
*/
struct umac_ctx {
uhash_ctx hash; /* Hash function for message compression */
pdf_ctx pdf; /* PDF for hashed output */
void *free_ptr; /* Address to free this struct via */
} umac_ctx;

/* ---------------------------------------------------------------------- */

#if 0
int umac_reset(struct umac_ctx *ctx)
/* Reset the hash function to begin a new authentication. */
{
uhash_reset(&ctx->hash);
return (1);
}
#endif

/* ---------------------------------------------------------------------- */

int umac_delete(struct umac_ctx *ctx)
/* Deallocate the ctx structure */
{
if (ctx) {
if (ALLOC_BOUNDARY)
ctx = (struct umac_ctx *)ctx->free_ptr;
xfree(ctx);
}
return (1);
}

/* ---------------------------------------------------------------------- */

struct umac_ctx *umac_new(u_char key[])
/* Dynamically allocate a umac_ctx struct, initialize variables,
* generate subkeys from key. Align to 16-byte boundary.
*/
{
struct umac_ctx *ctx, *octx;
size_t bytes_to_add;
aes_int_key prf_key;

octx = ctx = xmalloc(sizeof(*ctx) + ALLOC_BOUNDARY);
if (ctx) {
if (ALLOC_BOUNDARY) {
bytes_to_add = ALLOC_BOUNDARY -
((ptrdiff_t)ctx & (ALLOC_BOUNDARY - 1));
ctx = (struct umac_ctx *)((u_char *)ctx + bytes_to_add);
}
ctx->free_ptr = octx;
aes_key_setup(key,prf_key);
pdf_init(&ctx->pdf, prf_key);
uhash_init(&ctx->hash, prf_key);
}

return (ctx);
}

/* ---------------------------------------------------------------------- */

int umac_final(struct umac_ctx *ctx, u_char tag[], u_char nonce[8])
/* Incorporate any pending data, pad, and generate tag */
{
uhash_final(&ctx->hash, (u_char *)tag);
pdf_gen_xor(&ctx->pdf, (UINT8 *)nonce, (UINT8 *)tag);

return (1);
}

/* ---------------------------------------------------------------------- */

int umac_update(struct umac_ctx *ctx, u_char *input, long len)
/* Given len bytes of data, we parse it into L1_KEY_LEN chunks and */
/* hash each one, calling the PDF on the hashed output whenever the hash- */
/* output buffer is full. */
{
uhash_update(&ctx->hash, input, len);
return (1);
}

/* ---------------------------------------------------------------------- */

#if 0
int umac(struct umac_ctx *ctx, u_char *input,
long len, u_char tag[],
u_char nonce[8])
/* All-in-one version simply calls umac_update() and umac_final(). */
{
uhash(&ctx->hash, input, len, (u_char *)tag);
pdf_gen_xor(&ctx->pdf, (UINT8 *)nonce, (UINT8 *)tag);

return (1);
}
#endif

/* ---------------------------------------------------------------------- */
/* ---------------------------------------------------------------------- */
/* ----- End UMAC Section ----------------------------------------------- */
/* ---------------------------------------------------------------------- */
/* ---------------------------------------------------------------------- */
",False,
148,150,NomosTestfiles/BSD/BSD_style_ab.txt,BSD,"/*

Copyright (c) 2013 Red Hat, Inc. All rights reserved.

This copyrighted material is made available to anyone wishing to use, modify,
copy, or redistribute it subject to the terms and conditions of the BSD
License. This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY expressed or implied, including the implied warranties
of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. A copy of this license
is available at http://www.opensource.org/licenses. Any Red Hat trademarks that
are incorporated in the source code or documentation are not subject to the BSD
License and may only be used or replicated with the express permission of
Red Hat, Inc.

*/
",False,"```
Copyright (c) 2013 Red Hat, Inc. All rights reserved.

This copyrighted material is made available to anyone wishing to use, modify,
copy, or redistribute it subject to the terms and conditions of the BSD
License. This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY expressed or implied, including the implied warranties
of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. A copy of this license
is available at http://www.opensource.org/licenses. Any Red Hat trademarks that
are incorporated in the source code or documentation are not subject to the BSD
License and may only be used or replicated with the express permission of
Red Hat, Inc.
```"
149,151,NomosTestfiles/BSD/BSD_style_a.txt,BSD-style,"/*-
* Copyright (c) 2002-2004 Sam Leffler, Errno Consulting, Atheros
* Communications, Inc. All rights reserved.
*
* Redistribution and use in source and binary forms are permitted
* provided that the following conditions are met:
* 1. The materials contained herein are unmodified and are used
* unmodified.
* 2. Redistributions of source code must retain the above copyright
* notice, this list of conditions and the following NO
* ''WARRANTY'' disclaimer below (''Disclaimer''), without
* modification.
* 3. Redistributions in binary form must reproduce at minimum a
* disclaimer similar to the Disclaimer below and any redistribution
* must be conditioned upon including a substantially similar
* Disclaimer requirement for further binary redistribution.
* 4. Neither the names of the above-listed copyright holders nor the
* names of any contributors may be used to endorse or promote
* product derived from this software without specific prior written
* permission.
*
* NO WARRANTY
* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
* ''AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
* LIMITED TO, THE IMPLIED WARRANTIES OF NONINFRINGEMENT,
* MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
* IN NO EVENT SHALL THE COPYRIGHT HOLDERS OR CONTRIBUTORS BE LIABLE
* FOR SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
* LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF
* USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
* ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
* OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
* OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
* SUCH DAMAGES.
*
* $Id: COPYRIGHT,v 1.2 2004/05/15 22:26:24 samleffler Exp $
*/",False,"```
* Copyright (c) 2002-2004 Sam Leffler, Errno Consulting, Atheros
* Communications, Inc. All rights reserved.
*
* Redistribution and use in source and binary forms are permitted
* provided that the following conditions are met:
* 1. The materials contained herein are unmodified and are used
* unmodified.
* 2. Redistributions of source code must retain the above copyright
* notice, this list of conditions and the following NO
* ''WARRANTY'' disclaimer below (''Disclaimer''), without
* modification.
* 3. Redistributions in binary form must reproduce at minimum a
* disclaimer similar to the Disclaimer below and any redistribution
* must be conditioned upon including a substantially similar
* Disclaimer requirement for further binary redistribution.
* 4. Neither the names of the above-listed copyright holders nor the
* names of any contributors may be used to endorse or promote
* product derived from this software without specific prior written
* permission.
*
* NO WARRANTY
* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
* ''AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
* LIMITED TO, THE IMPLIED WARRANTIES OF NONINFRINGEMENT,
* MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
* IN NO EVENT SHALL THE COPYRIGHT HOLDERS OR CONTRIBUTORS BE LIABLE
* FOR SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
* LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF
* USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
* ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
* OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
* OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
* SUCH DAMAGES.
*
* $Id: COPYRIGHT,v 1.2 2004/05/15 22:26:24 samleffler Exp $
```"
150,152,NomosTestfiles/BSD/BSD_style_b.txt,BSD-style,"Copyright (c) 2003 The Visigoth Software Society. All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

   1.

      Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.

   2.

      The end-user documentation included with the redistribution, if
      any, must include the following acknowledgement: /""This product
      includes software developed by the Visigoth Software Society
      (http://www.visigoths.org/).""/ Alternately, this acknowledgement
      may appear in the software itself, if and wherever such
      third-party acknowledgements normally appear.

   3.

      Neither the name ""FreeMarker"", ""Visigoth"", nor any of the names of
      the project contributors may be used to endorse or promote
      products derived from this software without prior written
      permission. For written permission, please contact
      visigoths@visigoths.org.

   4.

      Products derived from this software may not be called ""FreeMarker""
      or ""Visigoth"" nor may ""FreeMarker"" or ""Visigoth"" appear in their
      names without prior written permission of the Visigoth Software
      Society.

THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN
NO EVENT SHALL THE VISIGOTH SOFTWARE SOCIETY OR ITS CONTRIBUTORS BE
LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
THE POSSIBILITY OF SUCH DAMAGE.",False,"```
Copyright (c) 2003 The Visigoth Software Society. All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

   1.

      Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.

   2.

      The end-user documentation included with the redistribution, if
      any, must include the following acknowledgement: /""This product
      includes software developed by the Visigoth Software Society
      (http://www.visigoths.org/).""/ Alternately, this acknowledgement
      may appear in the software itself, if and wherever such
      third-party acknowledgements normally appear.

   3.

      Neither the name ""FreeMarker"", ""Visigoth"", nor any of the names of
      the project contributors may be used to endorse or promote
      products derived from this software without prior written
      permission. For written permission, please contact
      visigoths@visigoths.org.

   4.

      Products derived from this software may not be called ""FreeMarker""
      or ""Visigoth"" nor may ""FreeMarker"" or ""Visigoth"" appear in their
      names without prior written permission of the Visigoth Software
      Society.

THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN
NO EVENT SHALL THE VISIGOTH SOFTWARE SOCIETY OR ITS CONTRIBUTORS BE
LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
THE POSSIBILITY OF SUCH DAMAGE.
```"
151,153,NomosTestfiles/BSD/BSD_style_c.txt,BSD-3-Clause,"// Copyright (c) 2007. Adobe Systems Incorporated.
// All rights reserved.
//
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions are met:
//
//   * Redistributions of source code must retain the above copyright notice,
//     this list of conditions and the following disclaimer.
//   * Redistributions in binary form must reproduce the above copyright notice,
//     this list of conditions and the following disclaimer in the documentation
//     and/or other materials provided with the distribution.
//   * Neither the name of Adobe Systems Incorporated nor the names of its
//     contributors may be used to endorse or promote products derived from this
//     software without specific prior written permission.
//
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS""
// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
// ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
// LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
// SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
// INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
// CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
// ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
// POSSIBILITY OF SUCH DAMAGE.",False,"```
// Copyright (c) 2007. Adobe Systems Incorporated.
// All rights reserved.
//
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions are met:
//
//   * Redistributions of source code must retain the above copyright notice,
//     this list of conditions and the following disclaimer.
//   * Redistributions in binary form must reproduce the above copyright notice,
//     this list of conditions and the following disclaimer in the documentation
//     and/or other materials provided with the distribution.
//   * Neither the name of Adobe Systems Incorporated nor the names of its
//     contributors may be used to endorse or promote products derived from this
//     software without specific prior written permission.
//
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS""
// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
// ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
// LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
// SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
// INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
// CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
// ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
// POSSIBILITY OF SUCH DAMAGE.
```"
152,154,NomosTestfiles/BSD/BSD_style_d.txt,BSD-3-Clause,"This Debian package was created by Peter Eisentraut <petere@debian.org>
on Feb 26 2005.

The source was downloaded from <http://jline.sourceforge.net/>.

Upstream author: Marc Prud'hommeaux <marc@apocalypse.org>

Copyright:

Copyright (c) 2002, 2003, 2004, 2005, 2006, Marc Prud'hommeaux <mwp1@cornell.edu>
All rights reserved.

Redistribution and use in source and binary forms, with or
without modification, are permitted provided that the following
conditions are met:

Redistributions of source code must retain the above copyright
notice, this list of conditions and the following disclaimer.

Redistributions in binary form must reproduce the above copyright
notice, this list of conditions and the following disclaimer
in the documentation and/or other materials provided with
the distribution.

Neither the name of JLine nor the names of its contributors
may be used to endorse or promote products derived from this
software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING,
BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO
EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY,
OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING
IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
OF THE POSSIBILITY OF SUCH DAMAGE.",False,"```
Copyright (c) 2002, 2003, 2004, 2005, 2006, Marc Prud'hommeaux <mwp1@cornell.edu>
All rights reserved.

Redistribution and use in source and binary forms, with or
without modification, are permitted provided that the following
conditions are met:

Redistributions of source code must retain the above copyright
notice, this list of conditions and the following disclaimer.

Redistributions in binary form must reproduce the above copyright
notice, this list of conditions and the following disclaimer
in the documentation and/or other materials provided with
the distribution.

Neither the name of JLine nor the names of its contributors
may be used to endorse or promote products derived from this
software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING,
BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO
EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY,
OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING
IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
OF THE POSSIBILITY OF SUCH DAMAGE.
```"
153,155,NomosTestfiles/BSD/BSD_style_e.txt,BSD,"Copyright:

getopt, more, pg, wall, and whereis may be redistributed under the terms
of the UCB BSD license found on Debian systems in the file
/usr/share/common-licenses/BSD",False,"```
Copyright:

getopt, more, pg, wall, and whereis may be redistributed under the terms
of the UCB BSD license found on Debian systems in the file
/usr/share/common-licenses/BSD
```"
154,156,NomosTestfiles/BSD/BSD_style_f.txt,BSD-2-Clause,"XRCed is released under the following terms:

Copyright (c) 2002, Roman Rolinsky <rollrom@users.sourceforge.net>
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice,
this list of conditions and the following disclaimer.
* Redistributions in binary form must reproduce the above copyright notice,
this list of conditions and the following disclaimer in the documentation
and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS""
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE.",False,"```
XRCed is released under the following terms:

Copyright (c) 2002, Roman Rolinsky <rollrom@users.sourceforge.net>
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice,
this list of conditions and the following disclaimer.
* Redistributions in binary form must reproduce the above copyright notice,
this list of conditions and the following disclaimer in the documentation
and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS""
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE.
```"
155,157,NomosTestfiles/BSD/BSD_style_g.txt,BSD-3-Clause,"    Copyright (C) 1995, 1996, 1997, and 1998 WIDE Project.
     All rights reserved.

     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
     are met:
     1. Redistributions of source code must retain the above copyright
        notice, this list of conditions and the following disclaimer.
     2. Redistributions in binary form must reproduce the above copyright
        notice, this list of conditions and the following disclaimer in the
        documentation and/or other materials provided with the distribution.
     3. Neither the name of the project nor the names of its contributors
        may be used to endorse or promote products derived from this software
        without specific prior written permission.

     THIS SOFTWARE IS PROVIDED BY THE PROJECT AND CONTRIBUTORS ``AS IS'' AND
     GAI_ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
     IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
     ARE DISCLAIMED.  IN NO EVENT SHALL THE PROJECT OR CONTRIBUTORS BE LIABLE
     FOR GAI_ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
     CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
     SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
     INTERRUPTION) HOWEVER CAUSED AND ON GAI_ANY THEORY OF LIABILITY, WHETHER
     IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
     ARISING IN GAI_ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
     OF THE POSSIBILITY OF SUCH DAMAGE.",False,"```
    Copyright (C) 1995, 1996, 1997, and 1998 WIDE Project.
     All rights reserved.

     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
     are met:
     1. Redistributions of source code must retain the above copyright
        notice, this list of conditions and the following disclaimer.
     2. Redistributions in binary form must reproduce the above copyright
        notice, this list of conditions and the following disclaimer in the
        documentation and/or other materials provided with the distribution.
     3. Neither the name of the project nor the names of its contributors
        may be used to endorse or promote products derived from this software
        without specific prior written permission.

     THIS SOFTWARE IS PROVIDED BY THE PROJECT AND CONTRIBUTORS ``AS IS'' AND
     GAI_ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
     IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
     ARE DISCLAIMED.  IN NO EVENT SHALL THE PROJECT OR CONTRIBUTORS BE LIABLE
     FOR GAI_ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
     CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
     SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
     INTERRUPTION) HOWEVER CAUSED AND ON GAI_ANY THEORY OF LIABILITY, WHETHER
     IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
     ARISING IN GAI_ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
     OF THE POSSIBILITY OF SUCH DAMAGE.
```"
156,158,NomosTestfiles/BSD/BSD_style_h.txt,BSD,"     ---------------------------------------------------------------------  
    /                       Copyright (c) 1996.                           \ 
   |          The Regents of the University of California.                 |
   |                        All rights reserved.                           |
   |                                                                       |
   |   Permission to use, copy, modify, and distribute this software for   |
   |   any purpose without fee is hereby granted, provided that this en-   |
   |   tire notice is included in all copies of any software which is or   |
   |   includes  a  copy  or  modification  of  this software and in all   |
   |   copies of the supporting documentation for such software.           |
   |                                                                       |
   |   This  work was produced at the University of California, Lawrence   |
   |   Livermore National Laboratory under  contract  no.  W-7405-ENG-48   |
   |   between  the  U.S.  Department  of  Energy and The Regents of the   |
   |   University of California for the operation of UC LLNL.              |
   |                                                                       |
   |                              DISCLAIMER                               |
   |                                                                       |
   |   This  software was prepared as an account of work sponsored by an   |
   |   agency of the United States Government. Neither the United States   |
   |   Government  nor the University of California nor any of their em-   |
   |   ployees, makes any warranty, express or implied, or  assumes  any   |
   |   liability  or  responsibility  for the accuracy, completeness, or   |
   |   usefulness of any information,  apparatus,  product,  or  process   |
   |   disclosed,   or  represents  that  its  use  would  not  infringe   |
   |   privately-owned rights. Reference herein to any specific  commer-   |
   |   cial  products,  process,  or  service  by trade name, trademark,   |
   |   manufacturer, or otherwise, does not  necessarily  constitute  or   |
   |   imply  its endorsement, recommendation, or favoring by the United   |
   |   States Government or the University of California. The views  and   |
   |   opinions  of authors expressed herein do not necessarily state or   |
   |   reflect those of the United States Government or  the  University   |
   |   of  California,  and shall not be used for advertising or product   |
    \  endorsement purposes.                                              / 
     ---------------------------------------------------------------------",False,"```
     ---------------------------------------------------------------------  
    /                       Copyright (c) 1996.                           \ 
   |          The Regents of the University of California.                 |
   |                        All rights reserved.                           |
   |                                                                       |
   |   Permission to use, copy, modify, and distribute this software for   |
   |   any purpose without fee is hereby granted, provided that this en-   |
   |   tire notice is included in all copies of any software which is or   |
   |   includes  a  copy  or  modification  of  this software and in all   |
   |   copies of the supporting documentation for such software.           |
   |                                                                       |
   |   This  work was produced at the University of California, Lawrence   |
   |   Livermore National Laboratory under  contract  no.  W-7405-ENG-48   |
   |   between  the  U.S.  Department  of  Energy and The Regents of the   |
   |   University of California for the operation of UC LLNL.              |
   |                                                                       |
   |                              DISCLAIMER                               |
   |                                                                       |
   |   This  software was prepared as an account of work sponsored by an   |
   |   agency of the United States Government. Neither the United States   |
   |   Government  nor the University of California nor any of their em-   |
   |   ployees, makes any warranty, express or implied, or  assumes  any   |
   |   liability  or  responsibility  for the accuracy, completeness, or   |
   |   usefulness of any information,  apparatus,  product,  or  process   |
   |   disclosed,   or  represents  that  its  use  would  not  infringe   |
   |   privately-owned rights. Reference herein to any specific  commer-   |
   |   cial  products,  process,  or  service  by trade name, trademark,   |
   |   manufacturer, or otherwise, does  not  necessarily  constitute  or   |
   |   imply  its endorsement, recommendation, or favoring by the United   |
   |   States Government or the University of California. The views  and   |
   |   opinions  of authors expressed herein do not necessarily state or   |
   |   reflect those of the United States Government or  the  University   |
   |   of  California,  and shall not be used for advertising or product   |
    \  endorsement purposes.                                              / 
     ---------------------------------------------------------------------
```"
157,159,NomosTestfiles/BSD/BSD_style_i.txt,BSD-3-Clause,"Licenses and Acknowledgements for Incorporated Software
=======================================================

Mersenne Twister
----------------

The `_random' module includes code based on a download from
`http://www.math.keio.ac.jp/~matumoto/MT2002/emt19937ar.html'.  The
following are the verbatim comments from the original code:

     A C-program for MT19937, with initialization improved 2002/1/26.
     Coded by Takuji Nishimura and Makoto Matsumoto.

     Before using, initialize the state by using init_genrand(seed)
     or init_by_array(init_key, key_length).

     Copyright (C) 1997 - 2002, Makoto Matsumoto and Takuji Nishimura,
     All rights reserved.

     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
     are met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in the
         documentation and/or other materials provided with the distribution.

      3. The names of its contributors may not be used to endorse or promote
         products derived from this software without specific prior written
         permission.

     THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
     ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
     LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
     A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT
     OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
     SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
     TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
     PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
     LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
     NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
     SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

     Any feedback is very welcome.
     http://www.math.keio.ac.jp/matumoto/emt.html
     email: matumoto@math.keio.ac.jp",False,"```
     Copyright (C) 1997 - 2002, Makoto Matsumoto and Takuji Nishimura,
     All rights reserved.

     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions
     are met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in the
         documentation and/or other materials provided with the distribution.

      3. The names of its contributors may not be used to endorse or promote
         products derived from this software without specific prior written
         permission.

     THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
     ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
     LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
     A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT
     OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
     SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
     TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
     PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
     LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
     NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
     SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
158,163,NomosTestfiles/BSD/BSD_style_m.txt,BSD,"Copyright:

Upstream Author: Thom May <thom@ubuntu.com>

License:

Software licensed under the BSD license, see /usr/share/common-licenses/BSD
",False,"```
Copyright:

Upstream Author: Thom May <thom@ubuntu.com>

License:

Software licensed under the BSD license, see /usr/share/common-licenses/BSD
```"
159,164,NomosTestfiles/BSD/BSD_style_n.txt,BSD-3-Clause,"Copyright (C) 1998-2001 Wichert Akkerman <wakkerma@deephackmode.org>
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:
1. Redistributions of source code must retain the above copyright
notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright
notice, this list of conditions and the following disclaimer in the
documentation and/or other materials provided with the distribution.
3. The name of the author may not be used to endorse or promote products
derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.",False,"```
Copyright (C) 1998-2001 Wichert Akkerman <wakkerma@deephackmode.org>
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:
1. Redistributions of source code must retain the above copyright
notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright
notice, this list of conditions and the following disclaimer in the
documentation and/or other materials provided with the distribution.
3. The name of the author may not be used to endorse or promote products
derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
160,165,NomosTestfiles/BSD/BSD_style_o.txt,BSD,"getopt, more, pg, wall, and whereis may be redistributed under the terms
of the UCB BSD license found on Debian systems in the file
/usr/share/common-licenses/BSD",False,"```
getopt, more, pg, wall, and whereis may be redistributed under the terms
of the UCB BSD license found on Debian systems in the file
/usr/share/common-licenses/BSD
```"
161,166,NomosTestfiles/BSD/BSD_style_p.txt,BSD-style,"t was downloaded from http://www.jdom.org/.

Copyright:

Copyright (C) 2001 Brett McLaughlin & Jason Hunter.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:

1. Redistributions of source code must retain the above copyright
notice, this list of conditions, and the following disclaimer.

2. Redistributions in binary form must reproduce the above copyright
notice, this list of conditions, and the disclaimer that follows
these conditions in the documentation and/or other materials
provided with the distribution.

3. The name ""JDOM"" must not be used to endorse or promote products
derived from this software without prior written permission. For
written permission, please contact license@jdom.org.

4. Products derived from this software may not be called ""JDOM"", nor
may ""JDOM"" appear in their name, without prior written permission
from the JDOM Project Management (pm@jdom.org).

In addition, we request (but do not require) that you include in the
end-user documentation provided with the redistribution and/or in the
software itself an acknowledgement equivalent to the following:
""This product includes software developed by the
JDOM Project (http://www.jdom.org/).""
Alternatively, the acknowledgment may be graphical using the logos
available at http://www.jdom.org/images/logos.

THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE JDOM AUTHORS OR THE PROJECT
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF
USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
SUCH DAMAGE.

This software consists of voluntary contributions made by many
individuals on behalf of the JDOM Project and was originally
created by Brett McLaughlin <brett@jdom.org> and
Jason Hunter <jhunter@jdom.org>. For more information on the
JDOM Project, please see <http://www.jdom.org/>.",False,"```
Copyright:

Copyright (C) 2001 Brett McLaughlin & Jason Hunter.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:

1. Redistributions of source code must retain the above copyright
notice, this list of conditions, and the following disclaimer.

2. Redistributions in binary form must reproduce the above copyright
notice, this list of conditions, and the disclaimer that follows
these conditions in the documentation and/or other materials
provided with the distribution.

3. The name ""JDOM"" must not be used to endorse or promote products
derived from this software without prior written permission. For
written permission, please contact license@jdom.org.

4. Products derived from this software may not be called ""JDOM"", nor
may ""JDOM"" appear in their name, without prior written permission
from the JDOM Project Management (pm@jdom.org).

In addition, we request (but do not require) that you include in the
end-user documentation provided with the redistribution and/or in the
software itself an acknowledgement equivalent to the following:
""This product includes software developed by the
JDOM Project (http://www.jdom.org/).""
Alternatively, the acknowledgment may be graphical using the logos
available at http://www.jdom.org/images/logos.

THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE JDOM AUTHORS OR THE PROJECT
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF
USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
SUCH DAMAGE.

This software consists of voluntary contributions made by many
individuals on behalf of the JDOM Project and was originally
created by Brett McLaughlin <brett@jdom.org> and
Jason Hunter <jhunter@jdom.org>. For more information on the
JDOM Project, please see <http://www.jdom.org/>.
```"
162,167,NomosTestfiles/BSD/BSD_style_q.txt,BSD-style,"Less
Copyright (C) 1984-1999 Mark Nudelman

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:
1. Redistributions of source code must retain the above copyright
notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright
notice in the documentation and/or other materials provided with
the distribution.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT
OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN
IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
",False,"```
Copyright (C) 1984-1999 Mark Nudelman

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:
1. Redistributions of source code must retain the above copyright
notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright
notice in the documentation and/or other materials provided with
the distribution.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT
OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN
IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
163,168,NomosTestfiles/BSD/BSD_style_s.txt,OpenSSL,"/* ====================================================================
 * Copyright (c) 1998-2004 The OpenSSL Project.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer. 
 *
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in
 *    the documentation and/or other materials provided with the
 *    distribution.
 *
 * 3. All advertising materials mentioning features or use of this
 *    software must display the following acknowledgment:
 *    ""This product includes software developed by the OpenSSL Project
 *    for use in the OpenSSL Toolkit. (http://www.openssl.org/)""
 *
 * 4. The names ""OpenSSL Toolkit"" and ""OpenSSL Project"" must not be used to
 *    endorse or promote products derived from this software without
 *    prior written permission. For written permission, please contact
 *    openssl-core@openssl.org.
 *
 * 5. Products derived from this software may not be called ""OpenSSL""
 *    nor may ""OpenSSL"" appear in their names without prior written
 *    permission of the OpenSSL Project.
 *
 * 6. Redistributions of any form whatsoever must retain the following
 *    acknowledgment:
 *    ""This product includes software developed by the OpenSSL Project
 *    for use in the OpenSSL Toolkit (http://www.openssl.org/)""
 *
 * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
 * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
 * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
 * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
 * OF THE POSSIBILITY OF SUCH DAMAGE.
 * ====================================================================
 *
 * This product includes cryptographic software written by Eric Young
 * (eay@cryptsoft.com).  This product includes software written by Tim
 * Hudson (tjh@cryptsoft.com).
 *
 */
",False,"```
 * Copyright (c) 1998-2004 The OpenSSL Project.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer. 
 *
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in
 *    the documentation and/or other materials provided with the 
 *    distribution.
 *
 * 3. All advertising materials mentioning features or use of this
 *    software must display the following acknowledgment:
 *    ""This product includes software developed by the OpenSSL Project
 *    for use in the OpenSSL Toolkit. (http://www.openssl.org/)""
 *
 * 4. The names ""OpenSSL Toolkit"" and ""OpenSSL Project"" must not be used to
 *    endorse or promote products derived from this software without
 *    prior written permission. For written permission, please contact
 *    openssl-core@openssl.org.
 *
 * 5. Products derived from this software may not be called ""OpenSSL""
 *    nor may ""OpenSSL"" appear in their names without prior written
 *    permission of the OpenSSL Project.
 *
 * 6. Redistributions of any form whatsoever must retain the following
 *    acknowledgment:
 *    ""This product includes software developed by the OpenSSL Project
 *    for use in the OpenSSL Toolkit (http://www.openssl.org/)""
 *
 * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
 * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
 * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
 * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
 * OF THE POSSIBILITY OF SUCH DAMAGE.
 * ====================================================================
 *
 * This product includes cryptographic software written by Eric Young
 * (eay@cryptsoft.com).  This product includes software written by Tim
 * Hudson (tjh@cryptsoft.com).
 *
 */
```"
164,169,NomosTestfiles/BSD/BSD_style_t.txt,SSLeay,"/* Copyright (C) 1995-1998 Eric Young (eay@cryptsoft.com)
 * All rights reserved.
 *
 * This package is an SSL implementation written
 * by Eric Young (eay@cryptsoft.com).
 * The implementation was written so as to conform with Netscapes SSL.
 * 
 * This library is free for commercial and non-commercial use as long as
 * the following conditions are aheared to.  The following conditions
 * apply to all code found in this distribution, be it the RC4, RSA,
 * lhash, DES, etc., code; not just the SSL code.  The SSL documentation
 * included with this distribution is covered by the same copyright terms
 * except that the holder is Tim Hudson (tjh@cryptsoft.com).
 * 
 * Copyright remains Eric Young's, and as such any Copyright notices in
 * the code are not to be removed.
 * If this package is used in a product, Eric Young should be given attribution
 * as the author of the parts of the library used.
 * This can be in the form of a textual message at program startup or
 * in documentation (online or textual) provided with the package.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *    ""This product includes cryptographic software written by
 *     Eric Young (eay@cryptsoft.com)""
 *    The word 'cryptographic' can be left out if the rouines from the library
 *    being used are not cryptographic related :-).
 * 4. If you include any Windows specific code (or a derivative thereof) from 
 *    the apps directory (application code) you must include an acknowledgement:
 *    ""This product includes software written by Tim Hudson (tjh@cryptsoft.com)""
 * 
 * THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 * 
 * The licence and distribution terms for any publically available version or
 * derivative of this code cannot be changed.  i.e. this code cannot simply be
 * copied and put under another distribution licence
 * [including the GNU Public Licence.]
 */
",False,"```
/* Copyright (C) 1995-1998 Eric Young (eay@cryptsoft.com)
 * All rights reserved.
 *
 * This package is an SSL implementation written
 * by Eric Young (eay@cryptsoft.com).
 * The implementation was written so as to conform with Netscapes SSL.
 * 
 * This library is free for commercial and non-commercial use as long as
 * the following conditions are aheared to.  The following conditions
 * apply to all code found in this distribution, be it the RC4, RSA,
 * lhash, DES, etc., code; not just the SSL code.  The SSL documentation
 * included with this distribution is covered by the same copyright terms
 * except that the holder is Tim Hudson (tjh@cryptsoft.com).
 * 
 * Copyright remains Eric Young's, and as such any Copyright notices in
 * the code are not to be removed.
 * If this package is used in a product, Eric Young should be given attribution
 * as the author of the parts of the library used.
 * This can be in the form of a textual message at program startup or
 * in documentation (online or textual) provided with the package.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *    ""This product includes cryptographic software written by
 *     Eric Young (eay@cryptsoft.com)""
 *    The word 'cryptographic' can be left out if the rouines from the library
 *    being used are not cryptographic related :-).
 * 4. If you include any Windows specific code (or a derivative thereof) from 
 *    the apps directory (application code) you must include an acknowledgement:
 *    ""This product includes software written by Tim Hudson (tjh@cryptsoft.com)""
 * 
 * THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 * 
 * The licence and distribution terms for any publically available version or
 * derivative of this code cannot be changed.  i.e. this code cannot simply be
 * copied and put under another distribution licence
 * [including the GNU Public Licence.]
 */
```"
165,170,NomosTestfiles/BSD/BSD_style_u.txt,BSD-3-Clause,"Copyright (c) The Regents of the University of California.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:
1. Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in the
   documentation and/or other materials provided with the distribution.
3. Neither the name of the University nor the names of its contributors
   may be used to endorse or promote products derived from this software
   without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
SUCH DAMAGE.
",False,"```
Copyright (c) The Regents of the University of California.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:
1. Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in the
   documentation and/or other materials provided with the distribution.
3. Neither the name of the University nor the names of its contributors
   may be used to endorse or promote products derived from this software
   without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
SUCH DAMAGE.
```"
166,171,NomosTestfiles/BSD/BSD_style_v.txt,MIT-CMU-style,"      Copyright 2000 by Timothy O'Malley 

                     All Rights Reserved

      Permission to use, copy, modify, and distribute this software
      and its documentation for any purpose and without fee is hereby
      granted, provided that the above copyright notice appear in all
      copies and that both that copyright notice and this permission
      notice appear in supporting documentation, and that the name of
      Timothy O'Malley  not be used in advertising or publicity
      pertaining to distribution of the software without specific, written
      prior permission.

      Timothy O'Malley DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS
      SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS, IN NO EVENT SHALL Timothy O'Malley BE LIABLE FOR
      ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
      WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
      WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS
      ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
",False,"```
      Copyright 2000 by Timothy O'Malley 

                     All Rights Reserved

      Permission to use, copy, modify, and distribute this software
      and its documentation for any purpose and without fee is hereby
      granted, provided that the above copyright notice appear in all
      copies and that both that copyright notice and this permission
      notice appear in supporting documentation, and that the name of
      Timothy O'Malley  not be used in advertising or publicity
      pertaining to distribution of the software without specific, written
      prior permission.

      Timothy O'Malley DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS
      SOFTWARE, INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS, IN NO EVENT SHALL Timothy O'Malley BE LIABLE FOR
      ANY SPECIAL, INDIRECT OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
      WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS,
      WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS
      ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
```"
167,172,NomosTestfiles/BSD/BSD_style_w.txt,BSD-style,"	-------------------------------------------------------------------------------
13	The ""New"" BSD License:
14	**********************
15	
16	Copyright (c) 2005-2008, The Dojo Foundation
17	All rights reserved.
18	
19	Redistribution and use in source and binary forms, with or without
20	modification, are permitted provided that the following conditions are met:
21	
22	  * Redistributions of source code must retain the above copyright notice, this
23	    list of conditions and the following disclaimer.
24	  * Redistributions in binary form must reproduce the above copyright notice,
25	    this list of conditions and the following disclaimer in the documentation
26	    and/or other materials provided with the distribution.
27	  * Neither the name of the Dojo Foundation nor the names of its contributors
28	    may be used to endorse or promote products derived from this software
29	    without specific prior written permission.
30	
31	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND
32	ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
33	WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
34	DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
35	FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
36	DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
37	SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
38	CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
39	OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
40	OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
41	
42	-------------------------------------------------------------------------------
",False,"```
13	The ""New"" BSD License:
14	**********************
15	
16	Copyright (c) 2005-2008, The Dojo Foundation
17	All rights reserved.
18	
19	Redistribution and use in source and binary forms, with or without
20	modification, are permitted provided that the following conditions are met:
21	
22	  * Redistributions of source code must retain the above copyright notice, this
23	    list of conditions and the following disclaimer.
24	  * Redistributions in binary form must reproduce the above copyright notice,
25	    this list of conditions and the following disclaimer in the documentation
26	    and/or other materials provided with the distribution.
27	  * Neither the name of the Dojo Foundation nor the names of its contributors
28	    may be used to endorse or promote products derived from this software
29	    without specific prior written permission.
30	
31	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND
32	ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
33	WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
34	DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
35	FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
36	DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
37	SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
38	CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
39	OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
40	OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
41	
42	-------------------------------------------------------------------------------
```"
168,173,NomosTestfiles/BSD/BSD_style_x.txt,"BSD-style
Govt-work","Copyright © <YEAR> <HOLDERS>. All rights reserved.

<PRODUCT> is distributed subject to the following license conditions:
SOFTWARE LICENSE AGREEMENT
Software: <PRODUCT>

   1.

      The ""Software"", below, refers to <PRODUCT> (in either source code, or binary form and accompanying documentation). Each licensee is addressed as ""you"" or ""Licensee.""
   2.

      The copyright holders shown above and their third-party licensors hereby grant Licensee a royalty-free nonexclusive license, subject to the limitations stated herein and U.S. Government license rights.
   3.

      You may modify and make a copy or copies of the Software for use within your organization, if you meet the following conditions:
         1. Copies in source code must include the copyright notice and this Software License Agreement.
         2. Copies in binary form must include the copyright notice and this Software License Agreement in the documentation and/or other materials provided with the copy.
   4.

      You may modify a copy or copies of the Software or any portion of it, thus forming a work based on the Software, and distribute copies of such work outside your organization, if you meet all of the following conditions:
         1. Copies in source code must include the copyright notice and this Software License Agreement;
         2. Copies in binary form must include the copyright notice and this Software License Agreement in the documentation and/or other materials provided with the copy;
         3. Modified copies and works based on the Software must carry prominent notices stating that you changed specified portions of the Software.
   5.

      Portions of the Software resulted from work developed under a U.S. Government contract and are subject to the following license: the Government is granted for itself and others acting on its behalf a paid-up, nonexclusive, irrevocable worldwide license in this computer software to reproduce, prepare derivative works, and perform publicly and display publicly.
   6.

      WARRANTY DISCLAIMER. THE SOFTWARE IS SUPPLIED ""AS IS"" WITHOUT WARRANTY OF ANY KIND. THE COPYRIGHT HOLDERS, THEIR THIRD PARTY LICENSORS, THE UNITED STATES, THE UNITED STATES DEPARTMENT OF ENERGY, AND THEIR EMPLOYEES: (1) DISCLAIM ANY WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, TITLE OR NON-INFRINGEMENT, (2) DO NOT ASSUME ANY LEGAL LIABILITY OR RESPONSIBILITY FOR THE ACCURACY, COMPLETENESS, OR USEFULNESS OF THE SOFTWARE, (3) DO NOT REPRESENT THAT USE OF THE SOFTWARE WOULD NOT INFRINGE PRIVATELY OWNED RIGHTS, (4) DO NOT WARRANT THAT THE SOFTWARE WILL FUNCTION UNINTERRUPTED, THAT IT IS ERROR-FREE OR THAT ANY ERRORS WILL BE CORRECTED.
   7.

      LIMITATION OF LIABILITY. IN NO EVENT WILL THE COPYRIGHT HOLDERS, THEIR THIRD PARTY LICENSORS, THE UNITED STATES, THE UNITED STATES DEPARTMENT OF ENERGY, OR THEIR EMPLOYEES: BE LIABLE FOR ANY INDIRECT, INCIDENTAL, CONSEQUENTIAL, SPECIAL OR PUNITIVE DAMAGES OF ANY KIND OR NATURE, INCLUDING BUT NOT LIMITED TO LOSS OF PROFITS OR LOSS OF DATA, FOR ANY REASON WHATSOEVER, WHETHER SUCH LIABILITY IS ASSERTED ON THE BASIS OF CONTRACT, TORT (INCLUDING NEGLIGENCE OR STRICT LIABILITY), OR OTHERWISE, EVEN IF ANY OF SAID PARTIES HAS BEEN WARNED OF THE POSSIBILITY OF SUCH LOSS OR DAMAGES.

",False,"```
Copyright © <YEAR> <HOLDERS>. All rights reserved.

<PRODUCT> is distributed subject to the following license conditions:
SOFTWARE LICENSE AGREEMENT
Software: <PRODUCT>

   1.

      The ""Software"", below, refers to <PRODUCT> (in either source code, or binary form and accompanying documentation). Each licensee is addressed as ""you"" or ""Licensee.""
   2.

      The copyright holders shown above and their third-party licensors hereby grant Licensee a royalty-free nonexclusive license, subject to the limitations stated herein and U.S. Government license rights.
   3.

      You may modify and make a copy or copies of the Software for use within your organization, if you meet the following conditions:
         1. Copies in source code must include the copyright notice and this Software License Agreement.
         2. Copies in binary form must include the copyright notice and this Software License Agreement in the documentation and/or other materials provided with the copy.
   4.

      You may modify a copy or copies of the Software or any portion of it, thus forming a work based on the Software, and distribute copies of such work outside your organization, if you meet all of the following conditions:
         1. Copies in source code must include the copyright notice and this Software License Agreement;
         2. Copies in binary form must include the copyright notice and this Software License Agreement in the documentation and/or other materials provided with the copy;
         3. Modified copies and works based on the Software must carry prominent notices stating that you changed specified portions of the Software.
   5.

      Portions of the Software resulted from work developed under a U.S. Government contract and are subject to the following license: the Government is granted for itself and others acting on its behalf a paid-up, nonexclusive, irrevocable worldwide license in this computer software to reproduce, prepare derivative works, and perform publicly and display publicly.
   6.

      WARRANTY DISCLAIMER. THE SOFTWARE IS SUPPLIED ""AS IS"" WITHOUT WARRANTY OF ANY KIND. THE COPYRIGHT HOLDERS, THEIR THIRD PARTY LICENSORS, THE UNITED STATES, THE UNITED STATES DEPARTMENT OF ENERGY, AND THEIR EMPLOYEES: (1) DISCLAIM ANY WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, TITLE OR NON-INFRINGEMENT, (2) DO NOT ASSUME ANY LEGAL LIABILITY OR RESPONSIBILITY FOR THE ACCURACY, COMPLETENESS, OR USEFULNESS OF THE SOFTWARE, (3) DO NOT REPRESENT THAT USE OF THE SOFTWARE WOULD NOT INFRINGE PRIVATELY OWNED RIGHTS, (4) DO NOT WARRANT THAT THE SOFTWARE WILL FUNCTION UNINTERRUPTED, THAT IT IS ERROR-FREE OR THAT ANY ERRORS WILL BE CORRECTED.
   7.

      LIMITATION OF LIABILITY. IN NO EVENT WILL THE COPYRIGHT HOLDERS, THEIR THIRD PARTY LICENSORS, THE UNITED STATES, THE UNITED STATES DEPARTMENT OF ENERGY, OR THEIR EMPLOYEES: BE LIABLE FOR ANY INDIRECT, INCIDENTAL, CONSEQUENTIAL, SPECIAL OR PUNITIVE DAMAGES OF ANY KIND OR NATURE, INCLUDING BUT NOT LIMITED TO LOSS OF PROFITS OR LOSS OF DATA, FOR ANY REASON WHATSOEVER, WHETHER SUCH LIABILITY IS ASSERTED ON THE BASIS OF CONTRACT, TORT (INCLUDING NEGLIGENCE OR STRICT LIABILITY), OR OTHERWISE, EVEN IF ANY OF SAID PARTIES HAS BEEN WARNED OF THE POSSIBILITY OF SUCH LOSS OR DAMAGES.
```"
169,174,NomosTestfiles/BSD/BSD_style_y.txt,PHP-3.0,"-------------------------------------------------------------------- 
                  The PHP License, version 3.0
Copyright (c) 1999 - 2006 The PHP Group. All rights reserved.
-------------------------------------------------------------------- 

Redistribution and use in source and binary forms, with or without
modification, is permitted provided that the following conditions
are met:

  1. Redistributions of source code must retain the above copyright
     notice, this list of conditions and the following disclaimer.
 
  2. Redistributions in binary form must reproduce the above copyright
     notice, this list of conditions and the following disclaimer in
     the documentation and/or other materials provided with the
     distribution.
 
  3. The name ""PHP"" must not be used to endorse or promote products
     derived from this software without prior written permission. For
     written permission, please contact group@php.net.
  
  4. Products derived from this software may not be called ""PHP"", nor
     may ""PHP"" appear in their name, without prior written permission
     from group@php.net.  You may indicate that your software works in
     conjunction with PHP by saying ""Foo for PHP"" instead of calling
     it ""PHP Foo"" or ""phpfoo""
 
  5. The PHP Group may publish revised and/or new versions of the
     license from time to time. Each version will be given a
     distinguishing version number.
     Once covered code has been published under a particular version
     of the license, you may always continue to use it under the terms
     of that version. You may also choose to use such covered code
     under the terms of any subsequent version of the license
     published by the PHP Group. No one other than the PHP Group has
     the right to modify the terms applicable to covered code created
     under this License.

  6. Redistributions of any form whatsoever must retain the following
     acknowledgment:
     ""This product includes PHP, freely available from
     <http://www.php.net/>"".

THIS SOFTWARE IS PROVIDED BY THE PHP DEVELOPMENT TEAM ``AS IS'' AND 
ANY EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A 
PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE PHP
DEVELOPMENT TEAM OR ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, 
INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES 
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR 
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
OF THE POSSIBILITY OF SUCH DAMAGE.

-------------------------------------------------------------------- 

This software consists of voluntary contributions made by many
individuals on behalf of the PHP Group.

The PHP Group can be contacted via Email at group@php.net.

For more information on the PHP Group and the PHP project, 
please see <http://www.php.net>.

This product includes the Zend Engine, freely available at
<http://www.zend.com>.",False,"```
                  The PHP License, version 3.0
Copyright (c) 1999 - 2006 The PHP Group. All rights reserved.
-------------------------------------------------------------------- 

Redistribution and use in source and binary forms, with or without
modification, is permitted provided that the following conditions
are met:

  1. Redistributions of source code must retain the above copyright
     notice, this list of conditions and the following disclaimer.
 
  2. Redistributions in binary form must reproduce the above copyright
     notice, this list of conditions and the following disclaimer in
     the documentation and/or other materials provided with the
     distribution.
 
  3. The name ""PHP"" must not be used to endorse or promote products
     derived from this software without prior written permission. For
     written permission, please contact group@php.net.
  
  4. Products derived from this software may not be called ""PHP"", nor
     may ""PHP"" appear in their name, without prior written permission
     from group@php.net.  You may indicate that your software works in
     conjunction with PHP by saying ""Foo for PHP"" instead of calling
     it ""PHP Foo"" or ""phpfoo""
 
  5. The PHP Group may publish revised and/or new versions of the
     license from time to time. Each version will be given a
     distinguishing version number.
     Once covered code has been published under a particular version
     of the license, you may always continue to use it under the terms
     of that version. You may also choose to use such covered code
     under the terms of any subsequent version of the license
     published by the PHP Group. No one other than the PHP Group has
     the right to modify the terms applicable to covered code created
     under this License.

  6. Redistributions of any form whatsoever must retain the following
     acknowledgment:
     ""This product includes PHP, freely available from
     <http://www.php.net/>"".

THIS SOFTWARE IS PROVIDED BY THE PHP DEVELOPMENT TEAM ``AS IS'' AND 
ANY EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A 
PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE PHP
DEVELOPMENT TEAM OR ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, 
INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES 
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR 
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
OF THE POSSIBILITY OF SUCH DAMAGE.

-------------------------------------------------------------------- 
```"
170,175,NomosTestfiles/BSD/BSD_style_z.txt,OLDAP-2.3,"The OpenLDAP Public License
  Version 2.3, 28 July 2000

Redistribution and use of this software and associated documentation
(""Software""), with or without modification, are permitted provided
that the following conditions are met:

1. Redistributions of source code must retain copyright statements
and notices.

2. Redistributions in binary form must reproduce applicable copyright
statements and notices, this list of conditions, and the following
disclaimer in the documentation and/or other materials provided
with the distribution.

3. Redistributions must contain a verbatim copy of this document.

4. The name ""OpenLDAP"" must not be used to endorse or promote
products derived from this Software without prior written permission
of the OpenLDAP Foundation.

5. Products derived from this Software may not be called ""OpenLDAP""
nor may ""OpenLDAP"" appear in their names without prior written
permission of the OpenLDAP Foundation.

6. Due credit should be given to the OpenLDAP Project
(http://www.openldap.org/).

7. The OpenLDAP Foundation may revise this license from time to
time.  Each revision is distinguished by a version number.  You
may use the Software under terms of this license revision or under
the terms of any subsequent revision of the license.

THIS SOFTWARE IS PROVIDED BY THE OPENLDAP FOUNDATION AND CONTRIBUTORS
``AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT
NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL
THE OPENLDAP FOUNDATION OR ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
OF THE POSSIBILITY OF SUCH DAMAGE.

OpenLDAP is a trademark of the OpenLDAP Foundation.

Copyright 1999-2000 The OpenLDAP Foundation, Redwood City,
California, USA.  All Rights Reserved.  Permission to copy and
distributed verbatim copies of this document is granted.",False,"```
The OpenLDAP Public License
  Version 2.3, 28 July 2000

Redistribution and use of this software and associated documentation
(""Software""), with or without modification, are permitted provided
that the following conditions are met:

1. Redistributions of source code must retain copyright statements
and notices.

2. Redistributions in binary form must reproduce applicable copyright
statements and notices, this list of conditions, and the following
disclaimer in the documentation and/or other materials provided
with the distribution.

3. Redistributions must contain a verbatim copy of this document.

4. The name ""OpenLDAP"" must not be used to endorse or promote
products derived from this Software without prior written permission
of the OpenLDAP Foundation.

5. Products derived from this Software may not be called ""OpenLDAP""
nor may ""OpenLDAP"" appear in their names without prior written
permission of the OpenLDAP Foundation.

6. Due credit should be given to the OpenLDAP Project
(http://www.openldap.org/).

7. The OpenLDAP Foundation may revise this license from time to
time.  Each revision is distinguished by a version number.  You
may use the Software under terms of this license revision or under
the terms of any subsequent revision of the license.

THIS SOFTWARE IS PROVIDED BY THE OPENLDAP FOUNDATION AND CONTRIBUTORS
``AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT
NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL
THE OPENLDAP FOUNDATION OR ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
OF THE POSSIBILITY OF SUCH DAMAGE.

OpenLDAP is a trademark of the OpenLDAP Foundation.

Copyright 1999-2000 The OpenLDAP Foundation, Redwood City,
California, USA.  All Rights Reserved.  Permission to copy and
distributed verbatim copies of this document is granted.
```"
171,176,NomosTestfiles/BSD/bsd.txt,"BSD-3-Clause
MIT","The BSD 3-Clause License

    The following is a BSD 3-Clause (""BSD New"" or ""BSD Simplified"") license template. To generate your own license, change the values of OWNER, ORGANIZATION and YEAR from their original values as given here, and substitute your own.

    Note: You may omit clause 3 and still be OSD-conformant. Despite its colloquial name ""BSD New"", this is not the newest version of the BSD license; it was followed by the even newer BSD-2-Clause version, sometimes known as the ""Simplified BSD License"". On January 9th, 2008 the OSI Board approved BSD-2-Clause, which is used by FreeBSD and others. It omits the final ""no-endorsement"" clause and is thus roughly equivalent to the MIT License.

    Historical Background: The original license used on BSD Unix had four clauses. The advertising clause (the third of four clauses) required you to acknowledge use of U.C. Berkeley code in your advertising of any product using that code. It was officially rescinded by the Director of the Office of Technology Licensing of the University of California on July 22nd, 1999. He states that clause 3 is ""hereby deleted in its entirety."" The four clause license has not been approved by OSI. The license below does not contain the advertising clause.

    This prelude is not part of the license.

<OWNER> = Regents of the University of California
<ORGANIZATION> = University of California, Berkeley
<YEAR> = 1998

In the original BSD license, both occurrences of the phrase ""COPYRIGHT HOLDERS AND CONTRIBUTORS"" in the disclaimer read ""REGENTS AND CONTRIBUTORS"".

Here is the license template:

Copyright (c) <YEAR>, <OWNER>
All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

    Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
    Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
    Neither the name of the <ORGANIZATION> nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
",False,"```
Copyright (c) <YEAR>, <OWNER>
All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

    Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
    Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
    Neither the name of the <ORGANIZATION> nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
172,177,NomosTestfiles/BSD/bug3537_DNSDigest.c,"Apache-2.0
BSD-style
GPL","<!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.0 Transitional//EN"" ""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"">
<html xmlns=""http://www.w3.org/1999/xhtml"" xml:lang=""en"">
<head>
<meta http-equiv=""content-type"" content=""text/html; charset=utf-8"" />
<title>FOSSology - DNSDigest.c - FOSSology</title>
<meta name=""description"" content=""Redmine"" />
<meta name=""keywords"" content=""issue,bug,tracker"" />
<meta name=""csrf-param"" content=""authenticity_token""/>
<meta name=""csrf-token"" content=""BePCBSOB/G9kvDUAeFeQkaceZBTBDjNd6J+u958OcwQ=""/>
<link rel='shortcut icon' href='/favicon.ico?1200087899' />
<link href=""/themes/red-andy/stylesheets/application.css?1317061750"" media=""all"" rel=""stylesheet"" type=""text/css"" />

<script src=""/javascripts/prototype.js?1317407706"" type=""text/javascript""></script>
<script src=""/javascripts/effects.js?1317407706"" type=""text/javascript""></script>
<script src=""/javascripts/dragdrop.js?1317407706"" type=""text/javascript""></script>
<script src=""/javascripts/controls.js?1317407706"" type=""text/javascript""></script>
<script src=""/javascripts/application.js?1317407742"" type=""text/javascript""></script>
<script type=""text/javascript"">
//<![CDATA[
Event.observe(window, 'load', function(){ new WarnLeavingUnsaved('The current page contains unsaved text that will be lost if you leave this page.'); });
//]]>
</script>

<!--[if IE 6]>
    <style type=""text/css"">
      * html body{ width: expression( document.documentElement.clientWidth < 900 ? '900px' : '100%' ); }
      body {behavior: url(/stylesheets/csshover.htc?1317407706);}
    </style>
<![endif]-->

<!-- page specific tags -->
    <link href=""/stylesheets/scm.css?1317407706"" media=""screen"" rel=""stylesheet"" type=""text/css"" /></head>
<body class=""theme-Red-andy controller-attachments action-show"">
<div id=""wrapper"">
<div id=""wrapper2"">
<div id=""top-menu"">
    <div id=""account"">
        <ul><li><a href=""/login"" class=""login"">Sign in</a></li>
<li><a href=""/account/register"" class=""register"">Register</a></li></ul>    </div>
    
    <ul><li><a href=""/"" class=""home"">Home</a></li>
<li><a href=""/projects"" class=""projects"">Projects</a></li>
<li><a href=""http://www.redmine.org/guide"" class=""help"">Help</a></li></ul></div>
      
<div id=""header"">
    
    <div id=""quick-search"">
        <form action=""/search/index/fossology"" method=""get"">
        
        <a href=""/search/index/fossology"" accesskey=""4"">Search</a>:
        <input accesskey=""f"" class=""small"" id=""q"" name=""q"" size=""20"" type=""text"" />
        </form>
        
    </div>
    
    
    <h1>FOSSology</h1>
    
    
    <div id=""main-menu"">
        <ul><li><a href=""/projects/fossology"" class=""overview"">Overview</a></li>
<li><a href=""/projects/fossology/activity"" class=""activity"">Activity</a></li>
<li><a href=""/projects/fossology/roadmap"" class=""roadmap"">Roadmap</a></li>
<li><a href=""/projects/fossology/issues"" class=""issues"">Backlog</a></li>
<li><a href=""/projects/fossology/news"" class=""news"">News</a></li>
<li><a href=""/projects/fossology/documents"" class=""documents"">Meetings</a></li>
<li><a href=""/projects/fossology/wiki"" class=""wiki"">Documentation</a></li>
<li><a href=""/projects/fossology/boards"" class=""boards"">Forums</a></li>
<li><a href=""/projects/fossology/files"" class=""files"">Files</a></li>
<li><a href=""/projects/fossology/repository"" class=""repository"">Repository</a></li></ul>
    </div>
    
</div>

<div class=""nosidebar"" id=""main"">
    <div id=""sidebar"">        
        
        
    </div>
    
    <div id=""content"">
				
        <h2>DNSDigest.c</h2>

<div class=""attachments"">
<p>Test file - 
   <span class=""author"">Bob Gobeille, 09/25/2012 07:46 pm</span></p>
<p><a href=""/attachments/download/2379/DNSDigest.c"">Download</a>   <span class=""size"">(47.9 kB)</span></p>

</div>
&nbsp;
<div class=""autoscroll"">
<table class=""filecontent syntaxhl"">
<tbody>


<tr><th class=""line-num"" id=""L1""><a href=""#L1"">1</a></th><td class=""line-code""><pre><span class=""c"">/* -*- Mode: C; tab-width: 4 -*-
</pre></td></tr>


<tr><th class=""line-num"" id=""L2""><a href=""#L2"">2</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L3""><a href=""#L3"">3</a></th><td class=""line-code""><pre> * Copyright (c) 2002-2003 Apple Computer, Inc. All rights reserved.
</pre></td></tr>


<tr><th class=""line-num"" id=""L4""><a href=""#L4"">4</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L5""><a href=""#L5"">5</a></th><td class=""line-code""><pre> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
</pre></td></tr>


<tr><th class=""line-num"" id=""L6""><a href=""#L6"">6</a></th><td class=""line-code""><pre> * you may not use this file except in compliance with the License.
</pre></td></tr>


<tr><th class=""line-num"" id=""L7""><a href=""#L7"">7</a></th><td class=""line-code""><pre> * You may obtain a copy of the License at
</pre></td></tr>


<tr><th class=""line-num"" id=""L8""><a href=""#L8"">8</a></th><td class=""line-code""><pre> * 
</pre></td></tr>


<tr><th class=""line-num"" id=""L9""><a href=""#L9"">9</a></th><td class=""line-code""><pre> *     http://www.apache.org/licenses/LICENSE-2.0
</pre></td></tr>


<tr><th class=""line-num"" id=""L10""><a href=""#L10"">10</a></th><td class=""line-code""><pre> * 
</pre></td></tr>


<tr><th class=""line-num"" id=""L11""><a href=""#L11"">11</a></th><td class=""line-code""><pre> * Unless required by applicable law or agreed to in writing, software
</pre></td></tr>


<tr><th class=""line-num"" id=""L12""><a href=""#L12"">12</a></th><td class=""line-code""><pre> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
</pre></td></tr>


<tr><th class=""line-num"" id=""L13""><a href=""#L13"">13</a></th><td class=""line-code""><pre> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
</pre></td></tr>


<tr><th class=""line-num"" id=""L14""><a href=""#L14"">14</a></th><td class=""line-code""><pre> * See the License for the specific language governing permissions and
</pre></td></tr>


<tr><th class=""line-num"" id=""L15""><a href=""#L15"">15</a></th><td class=""line-code""><pre> * limitations under the License.
</pre></td></tr>


<tr><th class=""line-num"" id=""L16""><a href=""#L16"">16</a></th><td class=""line-code""><pre> */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L17""><a href=""#L17"">17</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L18""><a href=""#L18"">18</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L19""><a href=""#L19"">19</a></th><td class=""line-code""><pre><span class=""pp"">#ifdef</span> __cplusplus
</pre></td></tr>


<tr><th class=""line-num"" id=""L20""><a href=""#L20"">20</a></th><td class=""line-code""><pre><span class=""di"">extern</span> <span class=""s""><span class=""dl"">&quot;</span><span class=""k"">C</span><span class=""dl"">&quot;</span></span> {
</pre></td></tr>


<tr><th class=""line-num"" id=""L21""><a href=""#L21"">21</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L22""><a href=""#L22"">22</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L23""><a href=""#L23"">23</a></th><td class=""line-code""><pre><span class=""pp"">#include</span> <span class=""ic"">&quot;mDNSEmbeddedAPI.h&quot;</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L24""><a href=""#L24"">24</a></th><td class=""line-code""><pre><span class=""pp"">#include</span> <span class=""ic"">&quot;DNSCommon.h&quot;</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L25""><a href=""#L25"">25</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L26""><a href=""#L26"">26</a></th><td class=""line-code""><pre><span class=""c"">// Disable certain benign warnings with Microsoft compilers</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L27""><a href=""#L27"">27</a></th><td class=""line-code""><pre><span class=""pp"">#if</span>(defined(_MSC_VER))
</pre></td></tr>


<tr><th class=""line-num"" id=""L28""><a href=""#L28"">28</a></th><td class=""line-code""><pre>        <span class=""c"">// Disable &quot;conditional expression is constant&quot; warning for debug macros.</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L29""><a href=""#L29"">29</a></th><td class=""line-code""><pre>        <span class=""c"">// Otherwise, this generates warnings for the perfectly natural construct &quot;while(1)&quot;</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L30""><a href=""#L30"">30</a></th><td class=""line-code""><pre>        <span class=""c"">// If someone knows a variant way of writing &quot;while(1)&quot; that doesn't generate warning messages, please let us know</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L31""><a href=""#L31"">31</a></th><td class=""line-code""><pre>        <span class=""pp"">#pragma</span> warning(disable:<span class=""i"">4127</span>)
</pre></td></tr>


<tr><th class=""line-num"" id=""L32""><a href=""#L32"">32</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L33""><a href=""#L33"">33</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L34""><a href=""#L34"">34</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L35""><a href=""#L35"">35</a></th><td class=""line-code""><pre> <span class=""c"">// ***************************************************************************</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L36""><a href=""#L36"">36</a></th><td class=""line-code""><pre><span class=""pp"">#if</span> COMPILER_LIKES_PRAGMA_MARK
</pre></td></tr>


<tr><th class=""line-num"" id=""L37""><a href=""#L37"">37</a></th><td class=""line-code""><pre><span class=""pp"">#pragma</span> mark - Byte Swapping Functions
</pre></td></tr>


<tr><th class=""line-num"" id=""L38""><a href=""#L38"">38</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L39""><a href=""#L39"">39</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L40""><a href=""#L40"">40</a></th><td class=""line-code""><pre>mDNSlocal mDNSu16 NToH16(mDNSu8 * bytes)
</pre></td></tr>


<tr><th class=""line-num"" id=""L41""><a href=""#L41"">41</a></th><td class=""line-code""><pre>        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L42""><a href=""#L42"">42</a></th><td class=""line-code""><pre>        <span class=""r"">return</span> (mDNSu16)((mDNSu16)bytes[<span class=""i"">0</span>] &lt;&lt; <span class=""i"">8</span> | (mDNSu16)bytes[<span class=""i"">1</span>]);
</pre></td></tr>


<tr><th class=""line-num"" id=""L43""><a href=""#L43"">43</a></th><td class=""line-code""><pre>        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L44""><a href=""#L44"">44</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L45""><a href=""#L45"">45</a></th><td class=""line-code""><pre>mDNSlocal mDNSu32 NToH32(mDNSu8 * bytes)
</pre></td></tr>


<tr><th class=""line-num"" id=""L46""><a href=""#L46"">46</a></th><td class=""line-code""><pre>        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L47""><a href=""#L47"">47</a></th><td class=""line-code""><pre>        <span class=""r"">return</span> (mDNSu32)((mDNSu32) bytes[<span class=""i"">0</span>] &lt;&lt; <span class=""i"">24</span> | (mDNSu32) bytes[<span class=""i"">1</span>] &lt;&lt; <span class=""i"">16</span> | (mDNSu32) bytes[<span class=""i"">2</span>] &lt;&lt; <span class=""i"">8</span> | (mDNSu32)bytes[<span class=""i"">3</span>]);
</pre></td></tr>


<tr><th class=""line-num"" id=""L48""><a href=""#L48"">48</a></th><td class=""line-code""><pre>        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L49""><a href=""#L49"">49</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L50""><a href=""#L50"">50</a></th><td class=""line-code""><pre> <span class=""c"">// ***************************************************************************</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L51""><a href=""#L51"">51</a></th><td class=""line-code""><pre><span class=""pp"">#if</span> COMPILER_LIKES_PRAGMA_MARK
</pre></td></tr>


<tr><th class=""line-num"" id=""L52""><a href=""#L52"">52</a></th><td class=""line-code""><pre><span class=""pp"">#pragma</span> mark - MD5 Hash Functions
</pre></td></tr>


<tr><th class=""line-num"" id=""L53""><a href=""#L53"">53</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L54""><a href=""#L54"">54</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L55""><a href=""#L55"">55</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L56""><a href=""#L56"">56</a></th><td class=""line-code""><pre><span class=""c"">/* The source for the has is derived CommonCrypto files CommonDigest.h, md32_common.h, md5_locl.h, md5_locl.h, and openssl/md5.h.
</pre></td></tr>


<tr><th class=""line-num"" id=""L57""><a href=""#L57"">57</a></th><td class=""line-code""><pre> * The following changes have been made to the original sources:
</pre></td></tr>


<tr><th class=""line-num"" id=""L58""><a href=""#L58"">58</a></th><td class=""line-code""><pre> *    replaced CC_LONG w/ mDNSu32
</pre></td></tr>


<tr><th class=""line-num"" id=""L59""><a href=""#L59"">59</a></th><td class=""line-code""><pre> *    replaced CC_MD5* with MD5*
</pre></td></tr>


<tr><th class=""line-num"" id=""L60""><a href=""#L60"">60</a></th><td class=""line-code""><pre> *    replaced CC_LONG w/ mDNSu32, removed conditional #defines from md5.h
</pre></td></tr>


<tr><th class=""line-num"" id=""L61""><a href=""#L61"">61</a></th><td class=""line-code""><pre> *    removed extern decls for MD5_Init/Update/Final from CommonDigest.h
</pre></td></tr>


<tr><th class=""line-num"" id=""L62""><a href=""#L62"">62</a></th><td class=""line-code""><pre> *    removed APPLE_COMMON_DIGEST specific #defines from md5_locl.h
</pre></td></tr>


<tr><th class=""line-num"" id=""L63""><a href=""#L63"">63</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L64""><a href=""#L64"">64</a></th><td class=""line-code""><pre> * Note: machine archetecure specific conditionals from the original sources are turned off, but are left in the code
</pre></td></tr>


<tr><th class=""line-num"" id=""L65""><a href=""#L65"">65</a></th><td class=""line-code""><pre> * to aid in platform-specific optimizations and debugging.
</pre></td></tr>


<tr><th class=""line-num"" id=""L66""><a href=""#L66"">66</a></th><td class=""line-code""><pre> * Sources originally distributed under the following license headers:
</pre></td></tr>


<tr><th class=""line-num"" id=""L67""><a href=""#L67"">67</a></th><td class=""line-code""><pre> * CommonDigest.h - APSL
</pre></td></tr>


<tr><th class=""line-num"" id=""L68""><a href=""#L68"">68</a></th><td class=""line-code""><pre> * 
</pre></td></tr>


<tr><th class=""line-num"" id=""L69""><a href=""#L69"">69</a></th><td class=""line-code""><pre> * md32_Common.h
</pre></td></tr>


<tr><th class=""line-num"" id=""L70""><a href=""#L70"">70</a></th><td class=""line-code""><pre> * ====================================================================
</pre></td></tr>


<tr><th class=""line-num"" id=""L71""><a href=""#L71"">71</a></th><td class=""line-code""><pre> * Copyright (c) 1999-2002 The OpenSSL Project.  All rights reserved.
</pre></td></tr>


<tr><th class=""line-num"" id=""L72""><a href=""#L72"">72</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L73""><a href=""#L73"">73</a></th><td class=""line-code""><pre> * Redistribution and use in source and binary forms, with or without
</pre></td></tr>


<tr><th class=""line-num"" id=""L74""><a href=""#L74"">74</a></th><td class=""line-code""><pre> * modification, are permitted provided that the following conditions
</pre></td></tr>


<tr><th class=""line-num"" id=""L75""><a href=""#L75"">75</a></th><td class=""line-code""><pre> * are met:
</pre></td></tr>


<tr><th class=""line-num"" id=""L76""><a href=""#L76"">76</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L77""><a href=""#L77"">77</a></th><td class=""line-code""><pre> * 1. Redistributions of source code must retain the above copyright
</pre></td></tr>


<tr><th class=""line-num"" id=""L78""><a href=""#L78"">78</a></th><td class=""line-code""><pre> *    notice, this list of conditions and the following disclaimer. 
</pre></td></tr>


<tr><th class=""line-num"" id=""L79""><a href=""#L79"">79</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L80""><a href=""#L80"">80</a></th><td class=""line-code""><pre> * 2. Redistributions in binary form must reproduce the above copyright
</pre></td></tr>


<tr><th class=""line-num"" id=""L81""><a href=""#L81"">81</a></th><td class=""line-code""><pre> *    notice, this list of conditions and the following disclaimer in
</pre></td></tr>


<tr><th class=""line-num"" id=""L82""><a href=""#L82"">82</a></th><td class=""line-code""><pre> *    the documentation and/or other materials provided with the
</pre></td></tr>


<tr><th class=""line-num"" id=""L83""><a href=""#L83"">83</a></th><td class=""line-code""><pre> *    distribution.
</pre></td></tr>


<tr><th class=""line-num"" id=""L84""><a href=""#L84"">84</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L85""><a href=""#L85"">85</a></th><td class=""line-code""><pre> * 3. All advertising materials mentioning features or use of this
</pre></td></tr>


<tr><th class=""line-num"" id=""L86""><a href=""#L86"">86</a></th><td class=""line-code""><pre> *    software must display the following acknowledgment:
</pre></td></tr>


<tr><th class=""line-num"" id=""L87""><a href=""#L87"">87</a></th><td class=""line-code""><pre> *    &quot;This product includes software developed by the OpenSSL Project
</pre></td></tr>


<tr><th class=""line-num"" id=""L88""><a href=""#L88"">88</a></th><td class=""line-code""><pre> *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)&quot;
</pre></td></tr>


<tr><th class=""line-num"" id=""L89""><a href=""#L89"">89</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L90""><a href=""#L90"">90</a></th><td class=""line-code""><pre> * 4. The names &quot;OpenSSL Toolkit&quot; and &quot;OpenSSL Project&quot; must not be used to
</pre></td></tr>


<tr><th class=""line-num"" id=""L91""><a href=""#L91"">91</a></th><td class=""line-code""><pre> *    endorse or promote products derived from this software without
</pre></td></tr>


<tr><th class=""line-num"" id=""L92""><a href=""#L92"">92</a></th><td class=""line-code""><pre> *    prior written permission. For written permission, please contact
</pre></td></tr>


<tr><th class=""line-num"" id=""L93""><a href=""#L93"">93</a></th><td class=""line-code""><pre> *    licensing@OpenSSL.org.
</pre></td></tr>


<tr><th class=""line-num"" id=""L94""><a href=""#L94"">94</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L95""><a href=""#L95"">95</a></th><td class=""line-code""><pre> * 5. Products derived from this software may not be called &quot;OpenSSL&quot;
</pre></td></tr>


<tr><th class=""line-num"" id=""L96""><a href=""#L96"">96</a></th><td class=""line-code""><pre> *    nor may &quot;OpenSSL&quot; appear in their names without prior written
</pre></td></tr>


<tr><th class=""line-num"" id=""L97""><a href=""#L97"">97</a></th><td class=""line-code""><pre> *    permission of the OpenSSL Project.
</pre></td></tr>


<tr><th class=""line-num"" id=""L98""><a href=""#L98"">98</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L99""><a href=""#L99"">99</a></th><td class=""line-code""><pre> * 6. Redistributions of any form whatsoever must retain the following
</pre></td></tr>


<tr><th class=""line-num"" id=""L100""><a href=""#L100"">100</a></th><td class=""line-code""><pre> *    acknowledgment:
</pre></td></tr>


<tr><th class=""line-num"" id=""L101""><a href=""#L101"">101</a></th><td class=""line-code""><pre> *    &quot;This product includes software developed by the OpenSSL Project
</pre></td></tr>


<tr><th class=""line-num"" id=""L102""><a href=""#L102"">102</a></th><td class=""line-code""><pre> *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)&quot;
</pre></td></tr>


<tr><th class=""line-num"" id=""L103""><a href=""#L103"">103</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L104""><a href=""#L104"">104</a></th><td class=""line-code""><pre> * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
</pre></td></tr>


<tr><th class=""line-num"" id=""L105""><a href=""#L105"">105</a></th><td class=""line-code""><pre> * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
</pre></td></tr>


<tr><th class=""line-num"" id=""L106""><a href=""#L106"">106</a></th><td class=""line-code""><pre> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
</pre></td></tr>


<tr><th class=""line-num"" id=""L107""><a href=""#L107"">107</a></th><td class=""line-code""><pre> * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
</pre></td></tr>


<tr><th class=""line-num"" id=""L108""><a href=""#L108"">108</a></th><td class=""line-code""><pre> * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
</pre></td></tr>


<tr><th class=""line-num"" id=""L109""><a href=""#L109"">109</a></th><td class=""line-code""><pre> * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
</pre></td></tr>


<tr><th class=""line-num"" id=""L110""><a href=""#L110"">110</a></th><td class=""line-code""><pre> * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
</pre></td></tr>


<tr><th class=""line-num"" id=""L111""><a href=""#L111"">111</a></th><td class=""line-code""><pre> * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
</pre></td></tr>


<tr><th class=""line-num"" id=""L112""><a href=""#L112"">112</a></th><td class=""line-code""><pre> * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
</pre></td></tr>


<tr><th class=""line-num"" id=""L113""><a href=""#L113"">113</a></th><td class=""line-code""><pre> * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
</pre></td></tr>


<tr><th class=""line-num"" id=""L114""><a href=""#L114"">114</a></th><td class=""line-code""><pre> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
</pre></td></tr>


<tr><th class=""line-num"" id=""L115""><a href=""#L115"">115</a></th><td class=""line-code""><pre> * OF THE POSSIBILITY OF SUCH DAMAGE.
</pre></td></tr>


<tr><th class=""line-num"" id=""L116""><a href=""#L116"">116</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L117""><a href=""#L117"">117</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L118""><a href=""#L118"">118</a></th><td class=""line-code""><pre> * md5_dgst.c, md5_locl.h
</pre></td></tr>


<tr><th class=""line-num"" id=""L119""><a href=""#L119"">119</a></th><td class=""line-code""><pre> * ====================================================================
</pre></td></tr>


<tr><th class=""line-num"" id=""L120""><a href=""#L120"">120</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L121""><a href=""#L121"">121</a></th><td class=""line-code""><pre> * This product includes cryptographic software written by Eric Young
</pre></td></tr>


<tr><th class=""line-num"" id=""L122""><a href=""#L122"">122</a></th><td class=""line-code""><pre> * (eay@cryptsoft.com).  This product includes software written by Tim
</pre></td></tr>


<tr><th class=""line-num"" id=""L123""><a href=""#L123"">123</a></th><td class=""line-code""><pre> * Hudson (tjh@cryptsoft.com).
</pre></td></tr>


<tr><th class=""line-num"" id=""L124""><a href=""#L124"">124</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L125""><a href=""#L125"">125</a></th><td class=""line-code""><pre> * Copyright (C) 1995-1998 Eric Young (eay@cryptsoft.com)
</pre></td></tr>


<tr><th class=""line-num"" id=""L126""><a href=""#L126"">126</a></th><td class=""line-code""><pre> * All rights reserved.
</pre></td></tr>


<tr><th class=""line-num"" id=""L127""><a href=""#L127"">127</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L128""><a href=""#L128"">128</a></th><td class=""line-code""><pre> * This package is an SSL implementation written
</pre></td></tr>


<tr><th class=""line-num"" id=""L129""><a href=""#L129"">129</a></th><td class=""line-code""><pre> * by Eric Young (eay@cryptsoft.com).
</pre></td></tr>


<tr><th class=""line-num"" id=""L130""><a href=""#L130"">130</a></th><td class=""line-code""><pre> * The implementation was written so as to conform with Netscapes SSL.
</pre></td></tr>


<tr><th class=""line-num"" id=""L131""><a href=""#L131"">131</a></th><td class=""line-code""><pre> * 
</pre></td></tr>


<tr><th class=""line-num"" id=""L132""><a href=""#L132"">132</a></th><td class=""line-code""><pre> * This library is free for commercial and non-commercial use as long as
</pre></td></tr>


<tr><th class=""line-num"" id=""L133""><a href=""#L133"">133</a></th><td class=""line-code""><pre> * the following conditions are aheared to.  The following conditions
</pre></td></tr>


<tr><th class=""line-num"" id=""L134""><a href=""#L134"">134</a></th><td class=""line-code""><pre> * apply to all code found in this distribution, be it the RC4, RSA,
</pre></td></tr>


<tr><th class=""line-num"" id=""L135""><a href=""#L135"">135</a></th><td class=""line-code""><pre> * lhash, DES, etc., code; not just the SSL code.  The SSL documentation
</pre></td></tr>


<tr><th class=""line-num"" id=""L136""><a href=""#L136"">136</a></th><td class=""line-code""><pre> * included with this distribution is covered by the same copyright terms
</pre></td></tr>


<tr><th class=""line-num"" id=""L137""><a href=""#L137"">137</a></th><td class=""line-code""><pre> * except that the holder is Tim Hudson (tjh@cryptsoft.com).
</pre></td></tr>


<tr><th class=""line-num"" id=""L138""><a href=""#L138"">138</a></th><td class=""line-code""><pre> * 
</pre></td></tr>


<tr><th class=""line-num"" id=""L139""><a href=""#L139"">139</a></th><td class=""line-code""><pre> * Copyright remains Eric Young's, and as such any Copyright notices in
</pre></td></tr>


<tr><th class=""line-num"" id=""L140""><a href=""#L140"">140</a></th><td class=""line-code""><pre> * the code are not to be removed.
</pre></td></tr>


<tr><th class=""line-num"" id=""L141""><a href=""#L141"">141</a></th><td class=""line-code""><pre> * If this package is used in a product, Eric Young should be given attribution
</pre></td></tr>


<tr><th class=""line-num"" id=""L142""><a href=""#L142"">142</a></th><td class=""line-code""><pre> * as the author of the parts of the library used.
</pre></td></tr>


<tr><th class=""line-num"" id=""L143""><a href=""#L143"">143</a></th><td class=""line-code""><pre> * This can be in the form of a textual message at program startup or
</pre></td></tr>


<tr><th class=""line-num"" id=""L144""><a href=""#L144"">144</a></th><td class=""line-code""><pre> * in documentation (online or textual) provided with the package.
</pre></td></tr>


<tr><th class=""line-num"" id=""L145""><a href=""#L145"">145</a></th><td class=""line-code""><pre> * 
</pre></td></tr>


<tr><th class=""line-num"" id=""L146""><a href=""#L146"">146</a></th><td class=""line-code""><pre> * Redistribution and use in source and binary forms, with or without
</pre></td></tr>


<tr><th class=""line-num"" id=""L147""><a href=""#L147"">147</a></th><td class=""line-code""><pre> * modification, are permitted provided that the following conditions
</pre></td></tr>


<tr><th class=""line-num"" id=""L148""><a href=""#L148"">148</a></th><td class=""line-code""><pre> * are met:
</pre></td></tr>


<tr><th class=""line-num"" id=""L149""><a href=""#L149"">149</a></th><td class=""line-code""><pre> * 1. Redistributions of source code must retain the copyright
</pre></td></tr>


<tr><th class=""line-num"" id=""L150""><a href=""#L150"">150</a></th><td class=""line-code""><pre> *    notice, this list of conditions and the following disclaimer.
</pre></td></tr>


<tr><th class=""line-num"" id=""L151""><a href=""#L151"">151</a></th><td class=""line-code""><pre> * 2. Redistributions in binary form must reproduce the above copyright
</pre></td></tr>


<tr><th class=""line-num"" id=""L152""><a href=""#L152"">152</a></th><td class=""line-code""><pre> *    notice, this list of conditions and the following disclaimer in the
</pre></td></tr>


<tr><th class=""line-num"" id=""L153""><a href=""#L153"">153</a></th><td class=""line-code""><pre> *    documentation and/or other materials provided with the distribution.
</pre></td></tr>


<tr><th class=""line-num"" id=""L154""><a href=""#L154"">154</a></th><td class=""line-code""><pre> * 3. All advertising materials mentioning features or use of this software
</pre></td></tr>


<tr><th class=""line-num"" id=""L155""><a href=""#L155"">155</a></th><td class=""line-code""><pre> *    must display the following acknowledgement:
</pre></td></tr>


<tr><th class=""line-num"" id=""L156""><a href=""#L156"">156</a></th><td class=""line-code""><pre> *    &quot;This product includes cryptographic software written by
</pre></td></tr>


<tr><th class=""line-num"" id=""L157""><a href=""#L157"">157</a></th><td class=""line-code""><pre> *     Eric Young (eay@cryptsoft.com)&quot;
</pre></td></tr>


<tr><th class=""line-num"" id=""L158""><a href=""#L158"">158</a></th><td class=""line-code""><pre> *    The word 'cryptographic' can be left out if the rouines from the library
</pre></td></tr>


<tr><th class=""line-num"" id=""L159""><a href=""#L159"">159</a></th><td class=""line-code""><pre> *    being used are not cryptographic related :-).
</pre></td></tr>


<tr><th class=""line-num"" id=""L160""><a href=""#L160"">160</a></th><td class=""line-code""><pre> * 4. If you include any Windows specific code (or a derivative thereof) from 
</pre></td></tr>


<tr><th class=""line-num"" id=""L161""><a href=""#L161"">161</a></th><td class=""line-code""><pre> *    the apps directory (application code) you must include an acknowledgement:
</pre></td></tr>


<tr><th class=""line-num"" id=""L162""><a href=""#L162"">162</a></th><td class=""line-code""><pre> *    &quot;This product includes software written by Tim Hudson (tjh@cryptsoft.com)&quot;
</pre></td></tr>


<tr><th class=""line-num"" id=""L163""><a href=""#L163"">163</a></th><td class=""line-code""><pre> * 
</pre></td></tr>


<tr><th class=""line-num"" id=""L164""><a href=""#L164"">164</a></th><td class=""line-code""><pre> * THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'' AND
</pre></td></tr>


<tr><th class=""line-num"" id=""L165""><a href=""#L165"">165</a></th><td class=""line-code""><pre> * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
</pre></td></tr>


<tr><th class=""line-num"" id=""L166""><a href=""#L166"">166</a></th><td class=""line-code""><pre> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
</pre></td></tr>


<tr><th class=""line-num"" id=""L167""><a href=""#L167"">167</a></th><td class=""line-code""><pre> * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
</pre></td></tr>


<tr><th class=""line-num"" id=""L168""><a href=""#L168"">168</a></th><td class=""line-code""><pre> * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
</pre></td></tr>


<tr><th class=""line-num"" id=""L169""><a href=""#L169"">169</a></th><td class=""line-code""><pre> * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
</pre></td></tr>


<tr><th class=""line-num"" id=""L170""><a href=""#L170"">170</a></th><td class=""line-code""><pre> * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
</pre></td></tr>


<tr><th class=""line-num"" id=""L171""><a href=""#L171"">171</a></th><td class=""line-code""><pre> * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
</pre></td></tr>


<tr><th class=""line-num"" id=""L172""><a href=""#L172"">172</a></th><td class=""line-code""><pre> * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
</pre></td></tr>


<tr><th class=""line-num"" id=""L173""><a href=""#L173"">173</a></th><td class=""line-code""><pre> * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
</pre></td></tr>


<tr><th class=""line-num"" id=""L174""><a href=""#L174"">174</a></th><td class=""line-code""><pre> * SUCH DAMAGE.
</pre></td></tr>


<tr><th class=""line-num"" id=""L175""><a href=""#L175"">175</a></th><td class=""line-code""><pre> * 
</pre></td></tr>


<tr><th class=""line-num"" id=""L176""><a href=""#L176"">176</a></th><td class=""line-code""><pre> * The licence and distribution terms for any publically available version or
</pre></td></tr>


<tr><th class=""line-num"" id=""L177""><a href=""#L177"">177</a></th><td class=""line-code""><pre> * derivative of this code cannot be changed.  i.e. this code cannot simply be
</pre></td></tr>


<tr><th class=""line-num"" id=""L178""><a href=""#L178"">178</a></th><td class=""line-code""><pre> * copied and put under another distribution licence
</pre></td></tr>


<tr><th class=""line-num"" id=""L179""><a href=""#L179"">179</a></th><td class=""line-code""><pre> * [including the GNU Public Licence.]
</pre></td></tr>


<tr><th class=""line-num"" id=""L180""><a href=""#L180"">180</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L181""><a href=""#L181"">181</a></th><td class=""line-code""><pre> */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L182""><a href=""#L182"">182</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L183""><a href=""#L183"">183</a></th><td class=""line-code""><pre><span class=""c"">//from CommonDigest.h</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L184""><a href=""#L184"">184</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L185""><a href=""#L185"">185</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> MD5_DIGEST_LENGTH        <span class=""i"">16</span>                        <span class=""c"">/* digest length in bytes */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L186""><a href=""#L186"">186</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> MD5_BLOCK_BYTES                <span class=""i"">64</span>                        <span class=""c"">/* block size in bytes */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L187""><a href=""#L187"">187</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> MD5_BLOCK_LONG       (MD5_BLOCK_BYTES / <span class=""r"">sizeof</span>(mDNSu32))
</pre></td></tr>


<tr><th class=""line-num"" id=""L188""><a href=""#L188"">188</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L189""><a href=""#L189"">189</a></th><td class=""line-code""><pre><span class=""r"">typedef</span> <span class=""r"">struct</span> MD5state_st
</pre></td></tr>


<tr><th class=""line-num"" id=""L190""><a href=""#L190"">190</a></th><td class=""line-code""><pre>{
</pre></td></tr>


<tr><th class=""line-num"" id=""L191""><a href=""#L191"">191</a></th><td class=""line-code""><pre>        mDNSu32 A,B,C,D;
</pre></td></tr>


<tr><th class=""line-num"" id=""L192""><a href=""#L192"">192</a></th><td class=""line-code""><pre>        mDNSu32 Nl,Nh;
</pre></td></tr>


<tr><th class=""line-num"" id=""L193""><a href=""#L193"">193</a></th><td class=""line-code""><pre>        mDNSu32 data[MD5_BLOCK_LONG];
</pre></td></tr>


<tr><th class=""line-num"" id=""L194""><a href=""#L194"">194</a></th><td class=""line-code""><pre>        <span class=""pt"">int</span> num;
</pre></td></tr>


<tr><th class=""line-num"" id=""L195""><a href=""#L195"">195</a></th><td class=""line-code""><pre>} MD5_CTX;
</pre></td></tr>


<tr><th class=""line-num"" id=""L196""><a href=""#L196"">196</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L197""><a href=""#L197"">197</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L198""><a href=""#L198"">198</a></th><td class=""line-code""><pre><span class=""c"">// from openssl/md5.h</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L199""><a href=""#L199"">199</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L200""><a href=""#L200"">200</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> MD5_CBLOCK        <span class=""i"">64</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L201""><a href=""#L201"">201</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> MD5_LBLOCK        (MD5_CBLOCK/<span class=""i"">4</span>)
</pre></td></tr>


<tr><th class=""line-num"" id=""L202""><a href=""#L202"">202</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> MD5_DIGEST_LENGTH <span class=""i"">16</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L203""><a href=""#L203"">203</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L204""><a href=""#L204"">204</a></th><td class=""line-code""><pre><span class=""pt"">int</span> MD5_Init(MD5_CTX *c);
</pre></td></tr>


<tr><th class=""line-num"" id=""L205""><a href=""#L205"">205</a></th><td class=""line-code""><pre><span class=""pt"">int</span> MD5_Update(MD5_CTX *c, <span class=""di"">const</span> <span class=""di"">void</span> *data, <span class=""pt"">unsigned</span> <span class=""pt"">long</span> len);
</pre></td></tr>


<tr><th class=""line-num"" id=""L206""><a href=""#L206"">206</a></th><td class=""line-code""><pre><span class=""pt"">int</span> MD5_Final(<span class=""pt"">unsigned</span> <span class=""pt"">char</span> *md, MD5_CTX *c);
</pre></td></tr>


<tr><th class=""line-num"" id=""L207""><a href=""#L207"">207</a></th><td class=""line-code""><pre><span class=""di"">void</span> MD5_Transform(MD5_CTX *c, <span class=""di"">const</span> <span class=""pt"">unsigned</span> <span class=""pt"">char</span> *b);
</pre></td></tr>


<tr><th class=""line-num"" id=""L208""><a href=""#L208"">208</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L209""><a href=""#L209"">209</a></th><td class=""line-code""><pre><span class=""c"">// From md5_locl.h</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L210""><a href=""#L210"">210</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L211""><a href=""#L211"">211</a></th><td class=""line-code""><pre><span class=""pp"">#ifndef</span> MD5_LONG_LOG2
</pre></td></tr>


<tr><th class=""line-num"" id=""L212""><a href=""#L212"">212</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> MD5_LONG_LOG2 <span class=""i"">2</span> <span class=""c"">/* default to 32 bits */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L213""><a href=""#L213"">213</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L214""><a href=""#L214"">214</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L215""><a href=""#L215"">215</a></th><td class=""line-code""><pre><span class=""pp"">#ifdef</span> MD5_ASM
</pre></td></tr>


<tr><th class=""line-num"" id=""L216""><a href=""#L216"">216</a></th><td class=""line-code""><pre><span class=""pp""># if</span> defined(__i386) || defined(__i386__) || defined(_M_IX86) || defined(__INTEL__)
</pre></td></tr>


<tr><th class=""line-num"" id=""L217""><a href=""#L217"">217</a></th><td class=""line-code""><pre><span class=""pp"">#  define</span> md5_block_host_order md5_block_asm_host_order
</pre></td></tr>


<tr><th class=""line-num"" id=""L218""><a href=""#L218"">218</a></th><td class=""line-code""><pre><span class=""pp""># elif</span> defined(__sparc) &amp;&amp; defined(OPENSSL_SYS_ULTRASPARC)
</pre></td></tr>


<tr><th class=""line-num"" id=""L219""><a href=""#L219"">219</a></th><td class=""line-code""><pre>   <span class=""di"">void</span> md5_block_asm_data_order_aligned (MD5_CTX *c, <span class=""di"">const</span> mDNSu32 *p,<span class=""pt"">int</span> num);
</pre></td></tr>


<tr><th class=""line-num"" id=""L220""><a href=""#L220"">220</a></th><td class=""line-code""><pre><span class=""pp"">#  define</span> HASH_BLOCK_DATA_ORDER_ALIGNED md5_block_asm_data_order_aligned
</pre></td></tr>


<tr><th class=""line-num"" id=""L221""><a href=""#L221"">221</a></th><td class=""line-code""><pre><span class=""pp""># endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L222""><a href=""#L222"">222</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L223""><a href=""#L223"">223</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L224""><a href=""#L224"">224</a></th><td class=""line-code""><pre><span class=""di"">void</span> md5_block_host_order (MD5_CTX *c, <span class=""di"">const</span> <span class=""di"">void</span> *p,<span class=""pt"">int</span> num);
</pre></td></tr>


<tr><th class=""line-num"" id=""L225""><a href=""#L225"">225</a></th><td class=""line-code""><pre><span class=""di"">void</span> md5_block_data_order (MD5_CTX *c, <span class=""di"">const</span> <span class=""di"">void</span> *p,<span class=""pt"">int</span> num);
</pre></td></tr>


<tr><th class=""line-num"" id=""L226""><a href=""#L226"">226</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L227""><a href=""#L227"">227</a></th><td class=""line-code""><pre><span class=""pp"">#if</span> defined(__i386) || defined(__i386__) || defined(_M_IX86) || defined(__INTEL__)
</pre></td></tr>


<tr><th class=""line-num"" id=""L228""><a href=""#L228"">228</a></th><td class=""line-code""><pre><span class=""c"">/*
</pre></td></tr>


<tr><th class=""line-num"" id=""L229""><a href=""#L229"">229</a></th><td class=""line-code""><pre> * *_block_host_order is expected to handle aligned data while
</pre></td></tr>


<tr><th class=""line-num"" id=""L230""><a href=""#L230"">230</a></th><td class=""line-code""><pre> * *_block_data_order - unaligned. As algorithm and host (x86)
</pre></td></tr>


<tr><th class=""line-num"" id=""L231""><a href=""#L231"">231</a></th><td class=""line-code""><pre> * are in this case of the same &quot;endianness&quot; these two are
</pre></td></tr>


<tr><th class=""line-num"" id=""L232""><a href=""#L232"">232</a></th><td class=""line-code""><pre> * otherwise indistinguishable. But normally you don't want to
</pre></td></tr>


<tr><th class=""line-num"" id=""L233""><a href=""#L233"">233</a></th><td class=""line-code""><pre> * call the same function because unaligned access in places
</pre></td></tr>


<tr><th class=""line-num"" id=""L234""><a href=""#L234"">234</a></th><td class=""line-code""><pre> * where alignment is expected is usually a &quot;Bad Thing&quot;. Indeed,
</pre></td></tr>


<tr><th class=""line-num"" id=""L235""><a href=""#L235"">235</a></th><td class=""line-code""><pre> * on RISCs you get punished with BUS ERROR signal or *severe*
</pre></td></tr>


<tr><th class=""line-num"" id=""L236""><a href=""#L236"">236</a></th><td class=""line-code""><pre> * performance degradation. Intel CPUs are in turn perfectly
</pre></td></tr>


<tr><th class=""line-num"" id=""L237""><a href=""#L237"">237</a></th><td class=""line-code""><pre> * capable of loading unaligned data without such drastic side
</pre></td></tr>


<tr><th class=""line-num"" id=""L238""><a href=""#L238"">238</a></th><td class=""line-code""><pre> * effect. Yes, they say it's slower than aligned load, but no
</pre></td></tr>


<tr><th class=""line-num"" id=""L239""><a href=""#L239"">239</a></th><td class=""line-code""><pre> * exception is generated and therefore performance degradation
</pre></td></tr>


<tr><th class=""line-num"" id=""L240""><a href=""#L240"">240</a></th><td class=""line-code""><pre> * is *incomparable* with RISCs. What we should weight here is
</pre></td></tr>


<tr><th class=""line-num"" id=""L241""><a href=""#L241"">241</a></th><td class=""line-code""><pre> * costs of unaligned access against costs of aligning data.
</pre></td></tr>


<tr><th class=""line-num"" id=""L242""><a href=""#L242"">242</a></th><td class=""line-code""><pre> * According to my measurements allowing unaligned access results
</pre></td></tr>


<tr><th class=""line-num"" id=""L243""><a href=""#L243"">243</a></th><td class=""line-code""><pre> * in ~9% performance improvement on Pentium II operating at
</pre></td></tr>


<tr><th class=""line-num"" id=""L244""><a href=""#L244"">244</a></th><td class=""line-code""><pre> * 266MHz. I won't be surprised if the difference will be higher
</pre></td></tr>


<tr><th class=""line-num"" id=""L245""><a href=""#L245"">245</a></th><td class=""line-code""><pre> * on faster systems:-)
</pre></td></tr>


<tr><th class=""line-num"" id=""L246""><a href=""#L246"">246</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L247""><a href=""#L247"">247</a></th><td class=""line-code""><pre> *                                &lt;appro@fy.chalmers.se&gt;
</pre></td></tr>


<tr><th class=""line-num"" id=""L248""><a href=""#L248"">248</a></th><td class=""line-code""><pre> */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L249""><a href=""#L249"">249</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> md5_block_data_order md5_block_host_order
</pre></td></tr>


<tr><th class=""line-num"" id=""L250""><a href=""#L250"">250</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L251""><a href=""#L251"">251</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L252""><a href=""#L252"">252</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> DATA_ORDER_IS_LITTLE_ENDIAN
</pre></td></tr>


<tr><th class=""line-num"" id=""L253""><a href=""#L253"">253</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L254""><a href=""#L254"">254</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HASH_LONG                mDNSu32
</pre></td></tr>


<tr><th class=""line-num"" id=""L255""><a href=""#L255"">255</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HASH_LONG_LOG2        MD5_LONG_LOG2
</pre></td></tr>


<tr><th class=""line-num"" id=""L256""><a href=""#L256"">256</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HASH_CTX                MD5_CTX
</pre></td></tr>


<tr><th class=""line-num"" id=""L257""><a href=""#L257"">257</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HASH_CBLOCK                MD5_CBLOCK
</pre></td></tr>


<tr><th class=""line-num"" id=""L258""><a href=""#L258"">258</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HASH_LBLOCK                MD5_LBLOCK
</pre></td></tr>


<tr><th class=""line-num"" id=""L259""><a href=""#L259"">259</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L260""><a href=""#L260"">260</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HASH_UPDATE                MD5_Update
</pre></td></tr>


<tr><th class=""line-num"" id=""L261""><a href=""#L261"">261</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HASH_TRANSFORM        MD5_Transform
</pre></td></tr>


<tr><th class=""line-num"" id=""L262""><a href=""#L262"">262</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HASH_FINAL                MD5_Final
</pre></td></tr>


<tr><th class=""line-num"" id=""L263""><a href=""#L263"">263</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L264""><a href=""#L264"">264</a></th><td class=""line-code""><pre><span class=""pp"">#define</span>        HASH_MAKE_STRING(c,s)        <span class=""r"">do</span> {        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L265""><a href=""#L265"">265</a></th><td class=""line-code""><pre>        <span class=""pt"">unsigned</span> <span class=""pt"">long</span> ll;                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L266""><a href=""#L266"">266</a></th><td class=""line-code""><pre>        ll=(c)-&gt;A; HOST_l2c(ll,(s));        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L267""><a href=""#L267"">267</a></th><td class=""line-code""><pre>        ll=(c)-&gt;B; HOST_l2c(ll,(s));        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L268""><a href=""#L268"">268</a></th><td class=""line-code""><pre>        ll=(c)-&gt;C; HOST_l2c(ll,(s));        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L269""><a href=""#L269"">269</a></th><td class=""line-code""><pre>        ll=(c)-&gt;D; HOST_l2c(ll,(s));        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L270""><a href=""#L270"">270</a></th><td class=""line-code""><pre>        } <span class=""r"">while</span> (<span class=""i"">0</span>)
</pre></td></tr>


<tr><th class=""line-num"" id=""L271""><a href=""#L271"">271</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HASH_BLOCK_HOST_ORDER        md5_block_host_order
</pre></td></tr>


<tr><th class=""line-num"" id=""L272""><a href=""#L272"">272</a></th><td class=""line-code""><pre><span class=""pp"">#if</span> !defined(L_ENDIAN) || defined(md5_block_data_order)
</pre></td></tr>


<tr><th class=""line-num"" id=""L273""><a href=""#L273"">273</a></th><td class=""line-code""><pre><span class=""pp"">#define</span>        HASH_BLOCK_DATA_ORDER        md5_block_data_order
</pre></td></tr>


<tr><th class=""line-num"" id=""L274""><a href=""#L274"">274</a></th><td class=""line-code""><pre><span class=""c"">/*
</pre></td></tr>


<tr><th class=""line-num"" id=""L275""><a href=""#L275"">275</a></th><td class=""line-code""><pre> * Little-endians (Intel and Alpha) feel better without this.
</pre></td></tr>


<tr><th class=""line-num"" id=""L276""><a href=""#L276"">276</a></th><td class=""line-code""><pre> * It looks like memcpy does better job than generic
</pre></td></tr>


<tr><th class=""line-num"" id=""L277""><a href=""#L277"">277</a></th><td class=""line-code""><pre> * md5_block_data_order on copying-n-aligning input data.
</pre></td></tr>


<tr><th class=""line-num"" id=""L278""><a href=""#L278"">278</a></th><td class=""line-code""><pre> * But frankly speaking I didn't expect such result on Alpha.
</pre></td></tr>


<tr><th class=""line-num"" id=""L279""><a href=""#L279"">279</a></th><td class=""line-code""><pre> * On the other hand I've got this with egcs-1.0.2 and if
</pre></td></tr>


<tr><th class=""line-num"" id=""L280""><a href=""#L280"">280</a></th><td class=""line-code""><pre> * program is compiled with another (better?) compiler it
</pre></td></tr>


<tr><th class=""line-num"" id=""L281""><a href=""#L281"">281</a></th><td class=""line-code""><pre> * might turn out other way around.
</pre></td></tr>


<tr><th class=""line-num"" id=""L282""><a href=""#L282"">282</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L283""><a href=""#L283"">283</a></th><td class=""line-code""><pre> *                                &lt;appro@fy.chalmers.se&gt;
</pre></td></tr>


<tr><th class=""line-num"" id=""L284""><a href=""#L284"">284</a></th><td class=""line-code""><pre> */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L285""><a href=""#L285"">285</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L286""><a href=""#L286"">286</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L287""><a href=""#L287"">287</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L288""><a href=""#L288"">288</a></th><td class=""line-code""><pre><span class=""c"">// from md32_common.h</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L289""><a href=""#L289"">289</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L290""><a href=""#L290"">290</a></th><td class=""line-code""><pre><span class=""c"">/*
</pre></td></tr>


<tr><th class=""line-num"" id=""L291""><a href=""#L291"">291</a></th><td class=""line-code""><pre> * This is a generic 32 bit &quot;collector&quot; for message digest algorithms.
</pre></td></tr>


<tr><th class=""line-num"" id=""L292""><a href=""#L292"">292</a></th><td class=""line-code""><pre> * Whenever needed it collects input character stream into chunks of
</pre></td></tr>


<tr><th class=""line-num"" id=""L293""><a href=""#L293"">293</a></th><td class=""line-code""><pre> * 32 bit values and invokes a block function that performs actual hash
</pre></td></tr>


<tr><th class=""line-num"" id=""L294""><a href=""#L294"">294</a></th><td class=""line-code""><pre> * calculations.
</pre></td></tr>


<tr><th class=""line-num"" id=""L295""><a href=""#L295"">295</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L296""><a href=""#L296"">296</a></th><td class=""line-code""><pre> * Porting guide.
</pre></td></tr>


<tr><th class=""line-num"" id=""L297""><a href=""#L297"">297</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L298""><a href=""#L298"">298</a></th><td class=""line-code""><pre> * Obligatory macros:
</pre></td></tr>


<tr><th class=""line-num"" id=""L299""><a href=""#L299"">299</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L300""><a href=""#L300"">300</a></th><td class=""line-code""><pre> * DATA_ORDER_IS_BIG_ENDIAN or DATA_ORDER_IS_LITTLE_ENDIAN
</pre></td></tr>


<tr><th class=""line-num"" id=""L301""><a href=""#L301"">301</a></th><td class=""line-code""><pre> *        this macro defines byte order of input stream.
</pre></td></tr>


<tr><th class=""line-num"" id=""L302""><a href=""#L302"">302</a></th><td class=""line-code""><pre> * HASH_CBLOCK
</pre></td></tr>


<tr><th class=""line-num"" id=""L303""><a href=""#L303"">303</a></th><td class=""line-code""><pre> *        size of a unit chunk HASH_BLOCK operates on.
</pre></td></tr>


<tr><th class=""line-num"" id=""L304""><a href=""#L304"">304</a></th><td class=""line-code""><pre> * HASH_LONG
</pre></td></tr>


<tr><th class=""line-num"" id=""L305""><a href=""#L305"">305</a></th><td class=""line-code""><pre> *        has to be at lest 32 bit wide, if it's wider, then
</pre></td></tr>


<tr><th class=""line-num"" id=""L306""><a href=""#L306"">306</a></th><td class=""line-code""><pre> *        HASH_LONG_LOG2 *has to* be defined along
</pre></td></tr>


<tr><th class=""line-num"" id=""L307""><a href=""#L307"">307</a></th><td class=""line-code""><pre> * HASH_CTX
</pre></td></tr>


<tr><th class=""line-num"" id=""L308""><a href=""#L308"">308</a></th><td class=""line-code""><pre> *        context structure that at least contains following
</pre></td></tr>


<tr><th class=""line-num"" id=""L309""><a href=""#L309"">309</a></th><td class=""line-code""><pre> *        members:
</pre></td></tr>


<tr><th class=""line-num"" id=""L310""><a href=""#L310"">310</a></th><td class=""line-code""><pre> *                typedef struct {
</pre></td></tr>


<tr><th class=""line-num"" id=""L311""><a href=""#L311"">311</a></th><td class=""line-code""><pre> *                        ...
</pre></td></tr>


<tr><th class=""line-num"" id=""L312""><a href=""#L312"">312</a></th><td class=""line-code""><pre> *                        HASH_LONG        Nl,Nh;
</pre></td></tr>


<tr><th class=""line-num"" id=""L313""><a href=""#L313"">313</a></th><td class=""line-code""><pre> *                        HASH_LONG        data[HASH_LBLOCK];
</pre></td></tr>


<tr><th class=""line-num"" id=""L314""><a href=""#L314"">314</a></th><td class=""line-code""><pre> *                        int                num;
</pre></td></tr>


<tr><th class=""line-num"" id=""L315""><a href=""#L315"">315</a></th><td class=""line-code""><pre> *                        ...
</pre></td></tr>


<tr><th class=""line-num"" id=""L316""><a href=""#L316"">316</a></th><td class=""line-code""><pre> *                        } HASH_CTX;
</pre></td></tr>


<tr><th class=""line-num"" id=""L317""><a href=""#L317"">317</a></th><td class=""line-code""><pre> * HASH_UPDATE
</pre></td></tr>


<tr><th class=""line-num"" id=""L318""><a href=""#L318"">318</a></th><td class=""line-code""><pre> *        name of &quot;Update&quot; function, implemented here.
</pre></td></tr>


<tr><th class=""line-num"" id=""L319""><a href=""#L319"">319</a></th><td class=""line-code""><pre> * HASH_TRANSFORM
</pre></td></tr>


<tr><th class=""line-num"" id=""L320""><a href=""#L320"">320</a></th><td class=""line-code""><pre> *        name of &quot;Transform&quot; function, implemented here.
</pre></td></tr>


<tr><th class=""line-num"" id=""L321""><a href=""#L321"">321</a></th><td class=""line-code""><pre> * HASH_FINAL
</pre></td></tr>


<tr><th class=""line-num"" id=""L322""><a href=""#L322"">322</a></th><td class=""line-code""><pre> *        name of &quot;Final&quot; function, implemented here.
</pre></td></tr>


<tr><th class=""line-num"" id=""L323""><a href=""#L323"">323</a></th><td class=""line-code""><pre> * HASH_BLOCK_HOST_ORDER
</pre></td></tr>


<tr><th class=""line-num"" id=""L324""><a href=""#L324"">324</a></th><td class=""line-code""><pre> *        name of &quot;block&quot; function treating *aligned* input message
</pre></td></tr>


<tr><th class=""line-num"" id=""L325""><a href=""#L325"">325</a></th><td class=""line-code""><pre> *        in host byte order, implemented externally.
</pre></td></tr>


<tr><th class=""line-num"" id=""L326""><a href=""#L326"">326</a></th><td class=""line-code""><pre> * HASH_BLOCK_DATA_ORDER
</pre></td></tr>


<tr><th class=""line-num"" id=""L327""><a href=""#L327"">327</a></th><td class=""line-code""><pre> *        name of &quot;block&quot; function treating *unaligned* input message
</pre></td></tr>


<tr><th class=""line-num"" id=""L328""><a href=""#L328"">328</a></th><td class=""line-code""><pre> *        in original (data) byte order, implemented externally (it
</pre></td></tr>


<tr><th class=""line-num"" id=""L329""><a href=""#L329"">329</a></th><td class=""line-code""><pre> *        actually is optional if data and host are of the same
</pre></td></tr>


<tr><th class=""line-num"" id=""L330""><a href=""#L330"">330</a></th><td class=""line-code""><pre> *        &quot;endianess&quot;).
</pre></td></tr>


<tr><th class=""line-num"" id=""L331""><a href=""#L331"">331</a></th><td class=""line-code""><pre> * HASH_MAKE_STRING
</pre></td></tr>


<tr><th class=""line-num"" id=""L332""><a href=""#L332"">332</a></th><td class=""line-code""><pre> *        macro convering context variables to an ASCII hash string.
</pre></td></tr>


<tr><th class=""line-num"" id=""L333""><a href=""#L333"">333</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L334""><a href=""#L334"">334</a></th><td class=""line-code""><pre> * Optional macros:
</pre></td></tr>


<tr><th class=""line-num"" id=""L335""><a href=""#L335"">335</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L336""><a href=""#L336"">336</a></th><td class=""line-code""><pre> * B_ENDIAN or L_ENDIAN
</pre></td></tr>


<tr><th class=""line-num"" id=""L337""><a href=""#L337"">337</a></th><td class=""line-code""><pre> *        defines host byte-order.
</pre></td></tr>


<tr><th class=""line-num"" id=""L338""><a href=""#L338"">338</a></th><td class=""line-code""><pre> * HASH_LONG_LOG2
</pre></td></tr>


<tr><th class=""line-num"" id=""L339""><a href=""#L339"">339</a></th><td class=""line-code""><pre> *        defaults to 2 if not states otherwise.
</pre></td></tr>


<tr><th class=""line-num"" id=""L340""><a href=""#L340"">340</a></th><td class=""line-code""><pre> * HASH_LBLOCK
</pre></td></tr>


<tr><th class=""line-num"" id=""L341""><a href=""#L341"">341</a></th><td class=""line-code""><pre> *        assumed to be HASH_CBLOCK/4 if not stated otherwise.
</pre></td></tr>


<tr><th class=""line-num"" id=""L342""><a href=""#L342"">342</a></th><td class=""line-code""><pre> * HASH_BLOCK_DATA_ORDER_ALIGNED
</pre></td></tr>


<tr><th class=""line-num"" id=""L343""><a href=""#L343"">343</a></th><td class=""line-code""><pre> *        alternative &quot;block&quot; function capable of treating
</pre></td></tr>


<tr><th class=""line-num"" id=""L344""><a href=""#L344"">344</a></th><td class=""line-code""><pre> *        aligned input message in original (data) order,
</pre></td></tr>


<tr><th class=""line-num"" id=""L345""><a href=""#L345"">345</a></th><td class=""line-code""><pre> *        implemented externally.
</pre></td></tr>


<tr><th class=""line-num"" id=""L346""><a href=""#L346"">346</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L347""><a href=""#L347"">347</a></th><td class=""line-code""><pre> * MD5 example:
</pre></td></tr>


<tr><th class=""line-num"" id=""L348""><a href=""#L348"">348</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L349""><a href=""#L349"">349</a></th><td class=""line-code""><pre> *        #define DATA_ORDER_IS_LITTLE_ENDIAN
</pre></td></tr>


<tr><th class=""line-num"" id=""L350""><a href=""#L350"">350</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L351""><a href=""#L351"">351</a></th><td class=""line-code""><pre> *        #define HASH_LONG                mDNSu32
</pre></td></tr>


<tr><th class=""line-num"" id=""L352""><a href=""#L352"">352</a></th><td class=""line-code""><pre> *        #define HASH_LONG_LOG2        mDNSu32_LOG2
</pre></td></tr>


<tr><th class=""line-num"" id=""L353""><a href=""#L353"">353</a></th><td class=""line-code""><pre> *        #define HASH_CTX                MD5_CTX
</pre></td></tr>


<tr><th class=""line-num"" id=""L354""><a href=""#L354"">354</a></th><td class=""line-code""><pre> *        #define HASH_CBLOCK                MD5_CBLOCK
</pre></td></tr>


<tr><th class=""line-num"" id=""L355""><a href=""#L355"">355</a></th><td class=""line-code""><pre> *        #define HASH_LBLOCK                MD5_LBLOCK
</pre></td></tr>


<tr><th class=""line-num"" id=""L356""><a href=""#L356"">356</a></th><td class=""line-code""><pre> *        #define HASH_UPDATE                MD5_Update
</pre></td></tr>


<tr><th class=""line-num"" id=""L357""><a href=""#L357"">357</a></th><td class=""line-code""><pre> *        #define HASH_TRANSFORM                MD5_Transform
</pre></td></tr>


<tr><th class=""line-num"" id=""L358""><a href=""#L358"">358</a></th><td class=""line-code""><pre> *        #define HASH_FINAL                MD5_Final
</pre></td></tr>


<tr><th class=""line-num"" id=""L359""><a href=""#L359"">359</a></th><td class=""line-code""><pre> *        #define HASH_BLOCK_HOST_ORDER        md5_block_host_order
</pre></td></tr>


<tr><th class=""line-num"" id=""L360""><a href=""#L360"">360</a></th><td class=""line-code""><pre> *        #define HASH_BLOCK_DATA_ORDER        md5_block_data_order
</pre></td></tr>


<tr><th class=""line-num"" id=""L361""><a href=""#L361"">361</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L362""><a href=""#L362"">362</a></th><td class=""line-code""><pre> *                                        &lt;appro@fy.chalmers.se&gt;
</pre></td></tr>


<tr><th class=""line-num"" id=""L363""><a href=""#L363"">363</a></th><td class=""line-code""><pre> */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L364""><a href=""#L364"">364</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L365""><a href=""#L365"">365</a></th><td class=""line-code""><pre><span class=""pp"">#if</span> !defined(DATA_ORDER_IS_BIG_ENDIAN) &amp;&amp; !defined(DATA_ORDER_IS_LITTLE_ENDIAN)
</pre></td></tr>


<tr><th class=""line-num"" id=""L366""><a href=""#L366"">366</a></th><td class=""line-code""><pre><span class=""pp"">#error</span> <span class=""s""><span class=""dl"">&quot;</span><span class=""k"">DATA_ORDER must be defined!</span><span class=""dl"">&quot;</span></span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L367""><a href=""#L367"">367</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L368""><a href=""#L368"">368</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L369""><a href=""#L369"">369</a></th><td class=""line-code""><pre><span class=""pp"">#ifndef</span> HASH_CBLOCK
</pre></td></tr>


<tr><th class=""line-num"" id=""L370""><a href=""#L370"">370</a></th><td class=""line-code""><pre><span class=""pp"">#error</span> <span class=""s""><span class=""dl"">&quot;</span><span class=""k"">HASH_CBLOCK must be defined!</span><span class=""dl"">&quot;</span></span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L371""><a href=""#L371"">371</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L372""><a href=""#L372"">372</a></th><td class=""line-code""><pre><span class=""pp"">#ifndef</span> HASH_LONG
</pre></td></tr>


<tr><th class=""line-num"" id=""L373""><a href=""#L373"">373</a></th><td class=""line-code""><pre><span class=""pp"">#error</span> <span class=""s""><span class=""dl"">&quot;</span><span class=""k"">HASH_LONG must be defined!</span><span class=""dl"">&quot;</span></span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L374""><a href=""#L374"">374</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L375""><a href=""#L375"">375</a></th><td class=""line-code""><pre><span class=""pp"">#ifndef</span> HASH_CTX
</pre></td></tr>


<tr><th class=""line-num"" id=""L376""><a href=""#L376"">376</a></th><td class=""line-code""><pre><span class=""pp"">#error</span> <span class=""s""><span class=""dl"">&quot;</span><span class=""k"">HASH_CTX must be defined!</span><span class=""dl"">&quot;</span></span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L377""><a href=""#L377"">377</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L378""><a href=""#L378"">378</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L379""><a href=""#L379"">379</a></th><td class=""line-code""><pre><span class=""pp"">#ifndef</span> HASH_UPDATE
</pre></td></tr>


<tr><th class=""line-num"" id=""L380""><a href=""#L380"">380</a></th><td class=""line-code""><pre><span class=""pp"">#error</span> <span class=""s""><span class=""dl"">&quot;</span><span class=""k"">HASH_UPDATE must be defined!</span><span class=""dl"">&quot;</span></span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L381""><a href=""#L381"">381</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L382""><a href=""#L382"">382</a></th><td class=""line-code""><pre><span class=""pp"">#ifndef</span> HASH_TRANSFORM
</pre></td></tr>


<tr><th class=""line-num"" id=""L383""><a href=""#L383"">383</a></th><td class=""line-code""><pre><span class=""pp"">#error</span> <span class=""s""><span class=""dl"">&quot;</span><span class=""k"">HASH_TRANSFORM must be defined!</span><span class=""dl"">&quot;</span></span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L384""><a href=""#L384"">384</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L385""><a href=""#L385"">385</a></th><td class=""line-code""><pre><span class=""pp"">#ifndef</span> HASH_FINAL
</pre></td></tr>


<tr><th class=""line-num"" id=""L386""><a href=""#L386"">386</a></th><td class=""line-code""><pre><span class=""pp"">#error</span> <span class=""s""><span class=""dl"">&quot;</span><span class=""k"">HASH_FINAL must be defined!</span><span class=""dl"">&quot;</span></span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L387""><a href=""#L387"">387</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L388""><a href=""#L388"">388</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L389""><a href=""#L389"">389</a></th><td class=""line-code""><pre><span class=""pp"">#ifndef</span> HASH_BLOCK_HOST_ORDER
</pre></td></tr>


<tr><th class=""line-num"" id=""L390""><a href=""#L390"">390</a></th><td class=""line-code""><pre><span class=""pp"">#error</span> <span class=""s""><span class=""dl"">&quot;</span><span class=""k"">HASH_BLOCK_HOST_ORDER must be defined!</span><span class=""dl"">&quot;</span></span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L391""><a href=""#L391"">391</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L392""><a href=""#L392"">392</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L393""><a href=""#L393"">393</a></th><td class=""line-code""><pre><span class=""c"">#if 0
</pre></td></tr>


<tr><th class=""line-num"" id=""L394""><a href=""#L394"">394</a></th><td class=""line-code""><pre>/*
</pre></td></tr>


<tr><th class=""line-num"" id=""L395""><a href=""#L395"">395</a></th><td class=""line-code""><pre> * Moved below as it's required only if HASH_BLOCK_DATA_ORDER_ALIGNED
</pre></td></tr>


<tr><th class=""line-num"" id=""L396""><a href=""#L396"">396</a></th><td class=""line-code""><pre> * isn't defined.
</pre></td></tr>


<tr><th class=""line-num"" id=""L397""><a href=""#L397"">397</a></th><td class=""line-code""><pre> */
</pre></td></tr>


<tr><th class=""line-num"" id=""L398""><a href=""#L398"">398</a></th><td class=""line-code""><pre>#ifndef HASH_BLOCK_DATA_ORDER
</pre></td></tr>


<tr><th class=""line-num"" id=""L399""><a href=""#L399"">399</a></th><td class=""line-code""><pre>#error &quot;HASH_BLOCK_DATA_ORDER must be defined!&quot;
</pre></td></tr>


<tr><th class=""line-num"" id=""L400""><a href=""#L400"">400</a></th><td class=""line-code""><pre>#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L401""><a href=""#L401"">401</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L402""><a href=""#L402"">402</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L403""><a href=""#L403"">403</a></th><td class=""line-code""><pre><span class=""pp"">#ifndef</span> HASH_LBLOCK
</pre></td></tr>


<tr><th class=""line-num"" id=""L404""><a href=""#L404"">404</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HASH_LBLOCK        (HASH_CBLOCK/<span class=""i"">4</span>)
</pre></td></tr>


<tr><th class=""line-num"" id=""L405""><a href=""#L405"">405</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L406""><a href=""#L406"">406</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L407""><a href=""#L407"">407</a></th><td class=""line-code""><pre><span class=""pp"">#ifndef</span> HASH_LONG_LOG2
</pre></td></tr>


<tr><th class=""line-num"" id=""L408""><a href=""#L408"">408</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HASH_LONG_LOG2        <span class=""i"">2</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L409""><a href=""#L409"">409</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L410""><a href=""#L410"">410</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L411""><a href=""#L411"">411</a></th><td class=""line-code""><pre><span class=""c"">/*
</pre></td></tr>


<tr><th class=""line-num"" id=""L412""><a href=""#L412"">412</a></th><td class=""line-code""><pre> * Engage compiler specific rotate intrinsic function if available.
</pre></td></tr>


<tr><th class=""line-num"" id=""L413""><a href=""#L413"">413</a></th><td class=""line-code""><pre> */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L414""><a href=""#L414"">414</a></th><td class=""line-code""><pre><span class=""pp"">#undef</span> ROTATE
</pre></td></tr>


<tr><th class=""line-num"" id=""L415""><a href=""#L415"">415</a></th><td class=""line-code""><pre><span class=""pp"">#ifndef</span> PEDANTIC
</pre></td></tr>


<tr><th class=""line-num"" id=""L416""><a href=""#L416"">416</a></th><td class=""line-code""><pre><span class=""c""># if 0 /* defined(_MSC_VER) */
</pre></td></tr>


<tr><th class=""line-num"" id=""L417""><a href=""#L417"">417</a></th><td class=""line-code""><pre>#  define ROTATE(a,n)        _lrotl(a,n)
</pre></td></tr>


<tr><th class=""line-num"" id=""L418""><a href=""#L418"">418</a></th><td class=""line-code""><pre># elif defined(__MWERKS__)
</pre></td></tr>


<tr><th class=""line-num"" id=""L419""><a href=""#L419"">419</a></th><td class=""line-code""><pre>#  if defined(__POWERPC__)
</pre></td></tr>


<tr><th class=""line-num"" id=""L420""><a href=""#L420"">420</a></th><td class=""line-code""><pre>#   define ROTATE(a,n)        (unsigned MD32_REG_T)__rlwinm((int)a,n,0,31)
</pre></td></tr>


<tr><th class=""line-num"" id=""L421""><a href=""#L421"">421</a></th><td class=""line-code""><pre>#  elif defined(__MC68K__)
</pre></td></tr>


<tr><th class=""line-num"" id=""L422""><a href=""#L422"">422</a></th><td class=""line-code""><pre>    /* Motorola specific tweak. &lt;appro@fy.chalmers.se&gt; */
</pre></td></tr>


<tr><th class=""line-num"" id=""L423""><a href=""#L423"">423</a></th><td class=""line-code""><pre>#   define ROTATE(a,n)        (n&lt;24 ? __rol(a,n) : __ror(a,32-n))
</pre></td></tr>


<tr><th class=""line-num"" id=""L424""><a href=""#L424"">424</a></th><td class=""line-code""><pre>#  else
</pre></td></tr>


<tr><th class=""line-num"" id=""L425""><a href=""#L425"">425</a></th><td class=""line-code""><pre>#   define ROTATE(a,n)        __rol(a,n)
</pre></td></tr>


<tr><th class=""line-num"" id=""L426""><a href=""#L426"">426</a></th><td class=""line-code""><pre>#  endif
</pre></td></tr>


<tr><th class=""line-num"" id=""L427""><a href=""#L427"">427</a></th><td class=""line-code""><pre># elif defined(__GNUC__) &amp;&amp; __GNUC__&gt;=2 &amp;&amp; !defined(OPENSSL_NO_ASM) &amp;&amp; !defined(OPENSSL_NO_INLINE_ASM)
</pre></td></tr>


<tr><th class=""line-num"" id=""L428""><a href=""#L428"">428</a></th><td class=""line-code""><pre>  /*
</pre></td></tr>


<tr><th class=""line-num"" id=""L429""><a href=""#L429"">429</a></th><td class=""line-code""><pre>   * Some GNU C inline assembler templates. Note that these are
</pre></td></tr>


<tr><th class=""line-num"" id=""L430""><a href=""#L430"">430</a></th><td class=""line-code""><pre>   * rotates by *constant* number of bits! But that's exactly
</pre></td></tr>


<tr><th class=""line-num"" id=""L431""><a href=""#L431"">431</a></th><td class=""line-code""><pre>   * what we need here...
</pre></td></tr>


<tr><th class=""line-num"" id=""L432""><a href=""#L432"">432</a></th><td class=""line-code""><pre>   *
</pre></td></tr>


<tr><th class=""line-num"" id=""L433""><a href=""#L433"">433</a></th><td class=""line-code""><pre>   *                                         &lt;appro@fy.chalmers.se&gt;
</pre></td></tr>


<tr><th class=""line-num"" id=""L434""><a href=""#L434"">434</a></th><td class=""line-code""><pre>   */
</pre></td></tr>


<tr><th class=""line-num"" id=""L435""><a href=""#L435"">435</a></th><td class=""line-code""><pre>  /*
</pre></td></tr>


<tr><th class=""line-num"" id=""L436""><a href=""#L436"">436</a></th><td class=""line-code""><pre>   * LLVM is more strict about compatibility of types between input &amp; output constraints,
</pre></td></tr>


<tr><th class=""line-num"" id=""L437""><a href=""#L437"">437</a></th><td class=""line-code""><pre>   * but we want these to be rotations of 32 bits, not 64, so we explicitly drop the
</pre></td></tr>


<tr><th class=""line-num"" id=""L438""><a href=""#L438"">438</a></th><td class=""line-code""><pre>   * most significant bytes by casting to an unsigned int.
</pre></td></tr>


<tr><th class=""line-num"" id=""L439""><a href=""#L439"">439</a></th><td class=""line-code""><pre>   */
</pre></td></tr>


<tr><th class=""line-num"" id=""L440""><a href=""#L440"">440</a></th><td class=""line-code""><pre>#  if defined(__i386) || defined(__i386__) || defined(__x86_64) || defined(__x86_64__)
</pre></td></tr>


<tr><th class=""line-num"" id=""L441""><a href=""#L441"">441</a></th><td class=""line-code""><pre>#   define ROTATE(a,n)        ({ register unsigned int ret;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L442""><a href=""#L442"">442</a></th><td class=""line-code""><pre>                                asm (                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L443""><a href=""#L443"">443</a></th><td class=""line-code""><pre>                                &quot;roll %1,%0&quot;                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L444""><a href=""#L444"">444</a></th><td class=""line-code""><pre>                                : &quot;=r&quot;(ret)                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L445""><a href=""#L445"">445</a></th><td class=""line-code""><pre>                                : &quot;I&quot;(n), &quot;0&quot;((unsigned int)a)        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L446""><a href=""#L446"">446</a></th><td class=""line-code""><pre>                                : &quot;cc&quot;);                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L447""><a href=""#L447"">447</a></th><td class=""line-code""><pre>                           ret;                                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L448""><a href=""#L448"">448</a></th><td class=""line-code""><pre>                        })
</pre></td></tr>


<tr><th class=""line-num"" id=""L449""><a href=""#L449"">449</a></th><td class=""line-code""><pre>#  elif defined(__powerpc) || defined(__ppc)
</pre></td></tr>


<tr><th class=""line-num"" id=""L450""><a href=""#L450"">450</a></th><td class=""line-code""><pre>#   define ROTATE(a,n)        ({ register unsigned int ret;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L451""><a href=""#L451"">451</a></th><td class=""line-code""><pre>                                asm (                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L452""><a href=""#L452"">452</a></th><td class=""line-code""><pre>                                &quot;rlwinm %0,%1,%2,0,31&quot;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L453""><a href=""#L453"">453</a></th><td class=""line-code""><pre>                                : &quot;=r&quot;(ret)                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L454""><a href=""#L454"">454</a></th><td class=""line-code""><pre>                                : &quot;r&quot;(a), &quot;I&quot;(n));        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L455""><a href=""#L455"">455</a></th><td class=""line-code""><pre>                           ret;                                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L456""><a href=""#L456"">456</a></th><td class=""line-code""><pre>                        })
</pre></td></tr>


<tr><th class=""line-num"" id=""L457""><a href=""#L457"">457</a></th><td class=""line-code""><pre>#  endif
</pre></td></tr>


<tr><th class=""line-num"" id=""L458""><a href=""#L458"">458</a></th><td class=""line-code""><pre># endif
</pre></td></tr>


<tr><th class=""line-num"" id=""L459""><a href=""#L459"">459</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L460""><a href=""#L460"">460</a></th><td class=""line-code""><pre>/*
</pre></td></tr>


<tr><th class=""line-num"" id=""L461""><a href=""#L461"">461</a></th><td class=""line-code""><pre> * Engage compiler specific &quot;fetch in reverse byte order&quot;
</pre></td></tr>


<tr><th class=""line-num"" id=""L462""><a href=""#L462"">462</a></th><td class=""line-code""><pre> * intrinsic function if available.
</pre></td></tr>


<tr><th class=""line-num"" id=""L463""><a href=""#L463"">463</a></th><td class=""line-code""><pre> */
</pre></td></tr>


<tr><th class=""line-num"" id=""L464""><a href=""#L464"">464</a></th><td class=""line-code""><pre># if defined(__GNUC__) &amp;&amp; __GNUC__&gt;=2 &amp;&amp; !defined(OPENSSL_NO_ASM) &amp;&amp; !defined(OPENSSL_NO_INLINE_ASM)
</pre></td></tr>


<tr><th class=""line-num"" id=""L465""><a href=""#L465"">465</a></th><td class=""line-code""><pre>  /* some GNU C inline assembler templates by &lt;appro@fy.chalmers.se&gt; */
</pre></td></tr>


<tr><th class=""line-num"" id=""L466""><a href=""#L466"">466</a></th><td class=""line-code""><pre>#  if (defined(__i386) || defined(__i386__) || defined(__x86_64) || defined(__x86_64__)) &amp;&amp; !defined(I386_ONLY)
</pre></td></tr>


<tr><th class=""line-num"" id=""L467""><a href=""#L467"">467</a></th><td class=""line-code""><pre>#   define BE_FETCH32(a)        ({ register unsigned int l=(a);\
</pre></td></tr>


<tr><th class=""line-num"" id=""L468""><a href=""#L468"">468</a></th><td class=""line-code""><pre>                                asm (                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L469""><a href=""#L469"">469</a></th><td class=""line-code""><pre>                                &quot;bswapl %0&quot;                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L470""><a href=""#L470"">470</a></th><td class=""line-code""><pre>                                : &quot;=r&quot;(l) : &quot;0&quot;(l));        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L471""><a href=""#L471"">471</a></th><td class=""line-code""><pre>                          l;                                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L472""><a href=""#L472"">472</a></th><td class=""line-code""><pre>                        })
</pre></td></tr>


<tr><th class=""line-num"" id=""L473""><a href=""#L473"">473</a></th><td class=""line-code""><pre>#  elif defined(__powerpc)
</pre></td></tr>


<tr><th class=""line-num"" id=""L474""><a href=""#L474"">474</a></th><td class=""line-code""><pre>#   define LE_FETCH32(a)        ({ register unsigned int l;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L475""><a href=""#L475"">475</a></th><td class=""line-code""><pre>                                asm (                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L476""><a href=""#L476"">476</a></th><td class=""line-code""><pre>                                &quot;lwbrx %0,0,%1&quot;                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L477""><a href=""#L477"">477</a></th><td class=""line-code""><pre>                                : &quot;=r&quot;(l)                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L478""><a href=""#L478"">478</a></th><td class=""line-code""><pre>                                : &quot;r&quot;(a));                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L479""><a href=""#L479"">479</a></th><td class=""line-code""><pre>                           l;                                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L480""><a href=""#L480"">480</a></th><td class=""line-code""><pre>                        })
</pre></td></tr>


<tr><th class=""line-num"" id=""L481""><a href=""#L481"">481</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L482""><a href=""#L482"">482</a></th><td class=""line-code""><pre>#  elif defined(__sparc) &amp;&amp; defined(OPENSSL_SYS_ULTRASPARC)
</pre></td></tr>


<tr><th class=""line-num"" id=""L483""><a href=""#L483"">483</a></th><td class=""line-code""><pre>#  define LE_FETCH32(a)        ({ register unsigned int l;                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L484""><a href=""#L484"">484</a></th><td class=""line-code""><pre>                                asm (                                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L485""><a href=""#L485"">485</a></th><td class=""line-code""><pre>                                &quot;lda [%1]#ASI_PRIMARY_LITTLE,%0&quot;\
</pre></td></tr>


<tr><th class=""line-num"" id=""L486""><a href=""#L486"">486</a></th><td class=""line-code""><pre>                                : &quot;=r&quot;(l)                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L487""><a href=""#L487"">487</a></th><td class=""line-code""><pre>                                : &quot;r&quot;(a));                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L488""><a href=""#L488"">488</a></th><td class=""line-code""><pre>                           l;                                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L489""><a href=""#L489"">489</a></th><td class=""line-code""><pre>                        })
</pre></td></tr>


<tr><th class=""line-num"" id=""L490""><a href=""#L490"">490</a></th><td class=""line-code""><pre>#  endif
</pre></td></tr>


<tr><th class=""line-num"" id=""L491""><a href=""#L491"">491</a></th><td class=""line-code""><pre># endif
</pre></td></tr>


<tr><th class=""line-num"" id=""L492""><a href=""#L492"">492</a></th><td class=""line-code""><pre>#endif /* PEDANTIC */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L493""><a href=""#L493"">493</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L494""><a href=""#L494"">494</a></th><td class=""line-code""><pre><span class=""pp"">#if</span> HASH_LONG_LOG2==<span class=""i"">2</span>        <span class=""c"">/* Engage only if sizeof(HASH_LONG)== 4 */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L495""><a href=""#L495"">495</a></th><td class=""line-code""><pre><span class=""c"">/* A nice byte order reversal from Wei Dai &lt;weidai@eskimo.com&gt; */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L496""><a href=""#L496"">496</a></th><td class=""line-code""><pre><span class=""pp"">#ifdef</span> ROTATE
</pre></td></tr>


<tr><th class=""line-num"" id=""L497""><a href=""#L497"">497</a></th><td class=""line-code""><pre><span class=""c"">/* 5 instructions with rotate instruction, else 9 */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L498""><a href=""#L498"">498</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> REVERSE_FETCH32(a,l)        (                                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L499""><a href=""#L499"">499</a></th><td class=""line-code""><pre>                l=*(<span class=""di"">const</span> HASH_LONG *)(a),                                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L500""><a href=""#L500"">500</a></th><td class=""line-code""><pre>                ((ROTATE(l,<span class=""i"">8</span>)&amp;<span class=""hx"">0x00FF00FF</span>)|(ROTATE((l&amp;<span class=""hx"">0x00FF00FF</span>),<span class=""i"">24</span>)))        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L501""><a href=""#L501"">501</a></th><td class=""line-code""><pre>                                )
</pre></td></tr>


<tr><th class=""line-num"" id=""L502""><a href=""#L502"">502</a></th><td class=""line-code""><pre><span class=""pp"">#else</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L503""><a href=""#L503"">503</a></th><td class=""line-code""><pre><span class=""c"">/* 6 instructions with rotate instruction, else 8 */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L504""><a href=""#L504"">504</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> REVERSE_FETCH32(a,l)        (                                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L505""><a href=""#L505"">505</a></th><td class=""line-code""><pre>                l=*(<span class=""di"">const</span> HASH_LONG *)(a),                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L506""><a href=""#L506"">506</a></th><td class=""line-code""><pre>                l=(((l&gt;&gt;<span class=""i"">8</span>)&amp;<span class=""hx"">0x00FF00FF</span>)|((l&amp;<span class=""hx"">0x00FF00FF</span>)&lt;&lt;<span class=""i"">8</span>)),        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L507""><a href=""#L507"">507</a></th><td class=""line-code""><pre>                ROTATE(l,<span class=""i"">16</span>)                                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L508""><a href=""#L508"">508</a></th><td class=""line-code""><pre>                                )
</pre></td></tr>


<tr><th class=""line-num"" id=""L509""><a href=""#L509"">509</a></th><td class=""line-code""><pre><span class=""c"">/*
</pre></td></tr>


<tr><th class=""line-num"" id=""L510""><a href=""#L510"">510</a></th><td class=""line-code""><pre> * Originally the middle line started with l=(((l&amp;0xFF00FF00)&gt;&gt;8)|...
</pre></td></tr>


<tr><th class=""line-num"" id=""L511""><a href=""#L511"">511</a></th><td class=""line-code""><pre> * It's rewritten as above for two reasons:
</pre></td></tr>


<tr><th class=""line-num"" id=""L512""><a href=""#L512"">512</a></th><td class=""line-code""><pre> *        - RISCs aren't good at long constants and have to explicitely
</pre></td></tr>


<tr><th class=""line-num"" id=""L513""><a href=""#L513"">513</a></th><td class=""line-code""><pre> *          compose 'em with several (well, usually 2) instructions in a
</pre></td></tr>


<tr><th class=""line-num"" id=""L514""><a href=""#L514"">514</a></th><td class=""line-code""><pre> *          register before performing the actual operation and (as you
</pre></td></tr>


<tr><th class=""line-num"" id=""L515""><a href=""#L515"">515</a></th><td class=""line-code""><pre> *          already realized:-) having same constant should inspire the
</pre></td></tr>


<tr><th class=""line-num"" id=""L516""><a href=""#L516"">516</a></th><td class=""line-code""><pre> *          compiler to permanently allocate the only register for it;
</pre></td></tr>


<tr><th class=""line-num"" id=""L517""><a href=""#L517"">517</a></th><td class=""line-code""><pre> *        - most modern CPUs have two ALUs, but usually only one has
</pre></td></tr>


<tr><th class=""line-num"" id=""L518""><a href=""#L518"">518</a></th><td class=""line-code""><pre> *          circuitry for shifts:-( this minor tweak inspires compiler
</pre></td></tr>


<tr><th class=""line-num"" id=""L519""><a href=""#L519"">519</a></th><td class=""line-code""><pre> *          to schedule shift instructions in a better way...
</pre></td></tr>


<tr><th class=""line-num"" id=""L520""><a href=""#L520"">520</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L521""><a href=""#L521"">521</a></th><td class=""line-code""><pre> *                                &lt;appro@fy.chalmers.se&gt;
</pre></td></tr>


<tr><th class=""line-num"" id=""L522""><a href=""#L522"">522</a></th><td class=""line-code""><pre> */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L523""><a href=""#L523"">523</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L524""><a href=""#L524"">524</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L525""><a href=""#L525"">525</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L526""><a href=""#L526"">526</a></th><td class=""line-code""><pre><span class=""pp"">#ifndef</span> ROTATE
</pre></td></tr>


<tr><th class=""line-num"" id=""L527""><a href=""#L527"">527</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> ROTATE(a,n)     (((a)&lt;&lt;(n))|(((a)&amp;<span class=""hx"">0xffffffff</span>)&gt;&gt;(<span class=""i"">32</span>-(n))))
</pre></td></tr>


<tr><th class=""line-num"" id=""L528""><a href=""#L528"">528</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L529""><a href=""#L529"">529</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L530""><a href=""#L530"">530</a></th><td class=""line-code""><pre><span class=""c"">/*
</pre></td></tr>


<tr><th class=""line-num"" id=""L531""><a href=""#L531"">531</a></th><td class=""line-code""><pre> * Make some obvious choices. E.g., HASH_BLOCK_DATA_ORDER_ALIGNED
</pre></td></tr>


<tr><th class=""line-num"" id=""L532""><a href=""#L532"">532</a></th><td class=""line-code""><pre> * and HASH_BLOCK_HOST_ORDER ought to be the same if input data
</pre></td></tr>


<tr><th class=""line-num"" id=""L533""><a href=""#L533"">533</a></th><td class=""line-code""><pre> * and host are of the same &quot;endianess&quot;. It's possible to mask
</pre></td></tr>


<tr><th class=""line-num"" id=""L534""><a href=""#L534"">534</a></th><td class=""line-code""><pre> * this with blank #define HASH_BLOCK_DATA_ORDER though...
</pre></td></tr>


<tr><th class=""line-num"" id=""L535""><a href=""#L535"">535</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L536""><a href=""#L536"">536</a></th><td class=""line-code""><pre> *                                &lt;appro@fy.chalmers.se&gt;
</pre></td></tr>


<tr><th class=""line-num"" id=""L537""><a href=""#L537"">537</a></th><td class=""line-code""><pre> */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L538""><a href=""#L538"">538</a></th><td class=""line-code""><pre><span class=""pp"">#if</span> defined(B_ENDIAN)
</pre></td></tr>


<tr><th class=""line-num"" id=""L539""><a href=""#L539"">539</a></th><td class=""line-code""><pre><span class=""pp"">#  if</span> defined(DATA_ORDER_IS_BIG_ENDIAN)
</pre></td></tr>


<tr><th class=""line-num"" id=""L540""><a href=""#L540"">540</a></th><td class=""line-code""><pre><span class=""pp"">#    if</span> !defined(HASH_BLOCK_DATA_ORDER_ALIGNED) &amp;&amp; HASH_LONG_LOG2==<span class=""i"">2</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L541""><a href=""#L541"">541</a></th><td class=""line-code""><pre><span class=""pp"">#      define</span> HASH_BLOCK_DATA_ORDER_ALIGNED        HASH_BLOCK_HOST_ORDER
</pre></td></tr>


<tr><th class=""line-num"" id=""L542""><a href=""#L542"">542</a></th><td class=""line-code""><pre><span class=""pp"">#    endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L543""><a href=""#L543"">543</a></th><td class=""line-code""><pre><span class=""pp"">#  elif</span> defined(DATA_ORDER_IS_LITTLE_ENDIAN)
</pre></td></tr>


<tr><th class=""line-num"" id=""L544""><a href=""#L544"">544</a></th><td class=""line-code""><pre><span class=""pp"">#    ifndef</span> HOST_FETCH32
</pre></td></tr>


<tr><th class=""line-num"" id=""L545""><a href=""#L545"">545</a></th><td class=""line-code""><pre><span class=""pp"">#      ifdef</span> LE_FETCH32
</pre></td></tr>


<tr><th class=""line-num"" id=""L546""><a href=""#L546"">546</a></th><td class=""line-code""><pre><span class=""pp"">#        define</span> HOST_FETCH32(p,l)        LE_FETCH32(p)
</pre></td></tr>


<tr><th class=""line-num"" id=""L547""><a href=""#L547"">547</a></th><td class=""line-code""><pre><span class=""pp"">#      elif</span> defined(REVERSE_FETCH32)
</pre></td></tr>


<tr><th class=""line-num"" id=""L548""><a href=""#L548"">548</a></th><td class=""line-code""><pre><span class=""pp"">#        define</span> HOST_FETCH32(p,l)        REVERSE_FETCH32(p,l)
</pre></td></tr>


<tr><th class=""line-num"" id=""L549""><a href=""#L549"">549</a></th><td class=""line-code""><pre><span class=""pp"">#      endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L550""><a href=""#L550"">550</a></th><td class=""line-code""><pre><span class=""pp"">#    endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L551""><a href=""#L551"">551</a></th><td class=""line-code""><pre><span class=""pp"">#  endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L552""><a href=""#L552"">552</a></th><td class=""line-code""><pre><span class=""pp"">#elif</span> defined(L_ENDIAN)
</pre></td></tr>


<tr><th class=""line-num"" id=""L553""><a href=""#L553"">553</a></th><td class=""line-code""><pre><span class=""pp"">#  if</span> defined(DATA_ORDER_IS_LITTLE_ENDIAN)
</pre></td></tr>


<tr><th class=""line-num"" id=""L554""><a href=""#L554"">554</a></th><td class=""line-code""><pre><span class=""pp"">#    if</span> !defined(HASH_BLOCK_DATA_ORDER_ALIGNED) &amp;&amp; HASH_LONG_LOG2==<span class=""i"">2</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L555""><a href=""#L555"">555</a></th><td class=""line-code""><pre><span class=""pp"">#      define</span> HASH_BLOCK_DATA_ORDER_ALIGNED        HASH_BLOCK_HOST_ORDER
</pre></td></tr>


<tr><th class=""line-num"" id=""L556""><a href=""#L556"">556</a></th><td class=""line-code""><pre><span class=""pp"">#    endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L557""><a href=""#L557"">557</a></th><td class=""line-code""><pre><span class=""pp"">#  elif</span> defined(DATA_ORDER_IS_BIG_ENDIAN)
</pre></td></tr>


<tr><th class=""line-num"" id=""L558""><a href=""#L558"">558</a></th><td class=""line-code""><pre><span class=""pp"">#    ifndef</span> HOST_FETCH32
</pre></td></tr>


<tr><th class=""line-num"" id=""L559""><a href=""#L559"">559</a></th><td class=""line-code""><pre><span class=""pp"">#      ifdef</span> BE_FETCH32
</pre></td></tr>


<tr><th class=""line-num"" id=""L560""><a href=""#L560"">560</a></th><td class=""line-code""><pre><span class=""pp"">#        define</span> HOST_FETCH32(p,l)        BE_FETCH32(p)
</pre></td></tr>


<tr><th class=""line-num"" id=""L561""><a href=""#L561"">561</a></th><td class=""line-code""><pre><span class=""pp"">#      elif</span> defined(REVERSE_FETCH32)
</pre></td></tr>


<tr><th class=""line-num"" id=""L562""><a href=""#L562"">562</a></th><td class=""line-code""><pre><span class=""pp"">#        define</span> HOST_FETCH32(p,l)        REVERSE_FETCH32(p,l)
</pre></td></tr>


<tr><th class=""line-num"" id=""L563""><a href=""#L563"">563</a></th><td class=""line-code""><pre><span class=""pp"">#      endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L564""><a href=""#L564"">564</a></th><td class=""line-code""><pre><span class=""pp"">#    endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L565""><a href=""#L565"">565</a></th><td class=""line-code""><pre><span class=""pp"">#  endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L566""><a href=""#L566"">566</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L567""><a href=""#L567"">567</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L568""><a href=""#L568"">568</a></th><td class=""line-code""><pre><span class=""pp"">#if</span> !defined(HASH_BLOCK_DATA_ORDER_ALIGNED)
</pre></td></tr>


<tr><th class=""line-num"" id=""L569""><a href=""#L569"">569</a></th><td class=""line-code""><pre><span class=""pp"">#ifndef</span> HASH_BLOCK_DATA_ORDER
</pre></td></tr>


<tr><th class=""line-num"" id=""L570""><a href=""#L570"">570</a></th><td class=""line-code""><pre><span class=""pp"">#error</span> <span class=""s""><span class=""dl"">&quot;</span><span class=""k"">HASH_BLOCK_DATA_ORDER must be defined!</span><span class=""dl"">&quot;</span></span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L571""><a href=""#L571"">571</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L572""><a href=""#L572"">572</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L573""><a href=""#L573"">573</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L574""><a href=""#L574"">574</a></th><td class=""line-code""><pre><span class=""pp"">#if</span> defined(DATA_ORDER_IS_BIG_ENDIAN)
</pre></td></tr>


<tr><th class=""line-num"" id=""L575""><a href=""#L575"">575</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L576""><a href=""#L576"">576</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HOST_c2l(c,l)        (l =(((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))&lt;&lt;<span class=""i"">24</span>),                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L577""><a href=""#L577"">577</a></th><td class=""line-code""><pre>                         l|=(((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))&lt;&lt;<span class=""i"">16</span>),                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L578""><a href=""#L578"">578</a></th><td class=""line-code""><pre>                         l|=(((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))&lt;&lt; <span class=""i"">8</span>),                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L579""><a href=""#L579"">579</a></th><td class=""line-code""><pre>                         l|=(((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))    ),                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L580""><a href=""#L580"">580</a></th><td class=""line-code""><pre>                         l)
</pre></td></tr>


<tr><th class=""line-num"" id=""L581""><a href=""#L581"">581</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HOST_p_c2l(c,l,n)        {                                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L582""><a href=""#L582"">582</a></th><td class=""line-code""><pre>                        <span class=""r"">switch</span> (n) {                                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L583""><a href=""#L583"">583</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">0</span>: l =((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))&lt;&lt;<span class=""i"">24</span>;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L584""><a href=""#L584"">584</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">1</span>: l|=((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))&lt;&lt;<span class=""i"">16</span>;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L585""><a href=""#L585"">585</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">2</span>: l|=((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))&lt;&lt; <span class=""i"">8</span>;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L586""><a href=""#L586"">586</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">3</span>: l|=((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)));                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L587""><a href=""#L587"">587</a></th><td class=""line-code""><pre>                                } }
</pre></td></tr>


<tr><th class=""line-num"" id=""L588""><a href=""#L588"">588</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HOST_p_c2l_p(c,l,sc,len) {                                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L589""><a href=""#L589"">589</a></th><td class=""line-code""><pre>                        <span class=""r"">switch</span> (sc) {                                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L590""><a href=""#L590"">590</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">0</span>: l =((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))&lt;&lt;<span class=""i"">24</span>;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L591""><a href=""#L591"">591</a></th><td class=""line-code""><pre>                                <span class=""r"">if</span> (--len == <span class=""i"">0</span>) <span class=""r"">break</span>;                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L592""><a href=""#L592"">592</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">1</span>: l|=((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))&lt;&lt;<span class=""i"">16</span>;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L593""><a href=""#L593"">593</a></th><td class=""line-code""><pre>                                <span class=""r"">if</span> (--len == <span class=""i"">0</span>) <span class=""r"">break</span>;                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L594""><a href=""#L594"">594</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">2</span>: l|=((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))&lt;&lt; <span class=""i"">8</span>;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L595""><a href=""#L595"">595</a></th><td class=""line-code""><pre>                                } }
</pre></td></tr>


<tr><th class=""line-num"" id=""L596""><a href=""#L596"">596</a></th><td class=""line-code""><pre><span class=""c"">/* NOTE the pointer is not incremented at the end of this */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L597""><a href=""#L597"">597</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HOST_c2l_p(c,l,n)        {                                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L598""><a href=""#L598"">598</a></th><td class=""line-code""><pre>                        l=<span class=""i"">0</span>; (c)+=n;                                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L599""><a href=""#L599"">599</a></th><td class=""line-code""><pre>                        <span class=""r"">switch</span> (n) {                                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L600""><a href=""#L600"">600</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">3</span>: l =((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*(--(c))))&lt;&lt; <span class=""i"">8</span>;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L601""><a href=""#L601"">601</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">2</span>: l|=((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*(--(c))))&lt;&lt;<span class=""i"">16</span>;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L602""><a href=""#L602"">602</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">1</span>: l|=((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*(--(c))))&lt;&lt;<span class=""i"">24</span>;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L603""><a href=""#L603"">603</a></th><td class=""line-code""><pre>                                } }
</pre></td></tr>


<tr><th class=""line-num"" id=""L604""><a href=""#L604"">604</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HOST_l2c(l,c)        (*((c)++)=(<span class=""pt"">unsigned</span> <span class=""pt"">char</span>)(((l)&gt;&gt;<span class=""i"">24</span>)&amp;<span class=""hx"">0xff</span>),        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L605""><a href=""#L605"">605</a></th><td class=""line-code""><pre>                         *((c)++)=(<span class=""pt"">unsigned</span> <span class=""pt"">char</span>)(((l)&gt;&gt;<span class=""i"">16</span>)&amp;<span class=""hx"">0xff</span>),        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L606""><a href=""#L606"">606</a></th><td class=""line-code""><pre>                         *((c)++)=(<span class=""pt"">unsigned</span> <span class=""pt"">char</span>)(((l)&gt;&gt; <span class=""i"">8</span>)&amp;<span class=""hx"">0xff</span>),        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L607""><a href=""#L607"">607</a></th><td class=""line-code""><pre>                         *((c)++)=(<span class=""pt"">unsigned</span> <span class=""pt"">char</span>)(((l)    )&amp;<span class=""hx"">0xff</span>),        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L608""><a href=""#L608"">608</a></th><td class=""line-code""><pre>                         l)
</pre></td></tr>


<tr><th class=""line-num"" id=""L609""><a href=""#L609"">609</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L610""><a href=""#L610"">610</a></th><td class=""line-code""><pre><span class=""pp"">#elif</span> defined(DATA_ORDER_IS_LITTLE_ENDIAN)
</pre></td></tr>


<tr><th class=""line-num"" id=""L611""><a href=""#L611"">611</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L612""><a href=""#L612"">612</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HOST_c2l(c,l)        (l =(((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))    ),                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L613""><a href=""#L613"">613</a></th><td class=""line-code""><pre>                         l|=(((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))&lt;&lt; <span class=""i"">8</span>),                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L614""><a href=""#L614"">614</a></th><td class=""line-code""><pre>                         l|=(((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))&lt;&lt;<span class=""i"">16</span>),                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L615""><a href=""#L615"">615</a></th><td class=""line-code""><pre>                         l|=(((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))&lt;&lt;<span class=""i"">24</span>),                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L616""><a href=""#L616"">616</a></th><td class=""line-code""><pre>                         l)
</pre></td></tr>


<tr><th class=""line-num"" id=""L617""><a href=""#L617"">617</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HOST_p_c2l(c,l,n)        {                                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L618""><a href=""#L618"">618</a></th><td class=""line-code""><pre>                        <span class=""r"">switch</span> (n) {                                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L619""><a href=""#L619"">619</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">0</span>: l =((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)));                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L620""><a href=""#L620"">620</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">1</span>: l|=((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))&lt;&lt; <span class=""i"">8</span>;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L621""><a href=""#L621"">621</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">2</span>: l|=((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))&lt;&lt;<span class=""i"">16</span>;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L622""><a href=""#L622"">622</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">3</span>: l|=((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))&lt;&lt;<span class=""i"">24</span>;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L623""><a href=""#L623"">623</a></th><td class=""line-code""><pre>                                } }
</pre></td></tr>


<tr><th class=""line-num"" id=""L624""><a href=""#L624"">624</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HOST_p_c2l_p(c,l,sc,len) {                                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L625""><a href=""#L625"">625</a></th><td class=""line-code""><pre>                        <span class=""r"">switch</span> (sc) {                                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L626""><a href=""#L626"">626</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">0</span>: l =((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)));                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L627""><a href=""#L627"">627</a></th><td class=""line-code""><pre>                                <span class=""r"">if</span> (--len == <span class=""i"">0</span>) <span class=""r"">break</span>;                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L628""><a href=""#L628"">628</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">1</span>: l|=((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))&lt;&lt; <span class=""i"">8</span>;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L629""><a href=""#L629"">629</a></th><td class=""line-code""><pre>                                <span class=""r"">if</span> (--len == <span class=""i"">0</span>) <span class=""r"">break</span>;                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L630""><a href=""#L630"">630</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">2</span>: l|=((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*((c)++)))&lt;&lt;<span class=""i"">16</span>;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L631""><a href=""#L631"">631</a></th><td class=""line-code""><pre>                                } }
</pre></td></tr>


<tr><th class=""line-num"" id=""L632""><a href=""#L632"">632</a></th><td class=""line-code""><pre><span class=""c"">/* NOTE the pointer is not incremented at the end of this */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L633""><a href=""#L633"">633</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HOST_c2l_p(c,l,n)        {                                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L634""><a href=""#L634"">634</a></th><td class=""line-code""><pre>                        l=<span class=""i"">0</span>; (c)+=n;                                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L635""><a href=""#L635"">635</a></th><td class=""line-code""><pre>                        <span class=""r"">switch</span> (n) {                                        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L636""><a href=""#L636"">636</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">3</span>: l =((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*(--(c))))&lt;&lt;<span class=""i"">16</span>;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L637""><a href=""#L637"">637</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">2</span>: l|=((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*(--(c))))&lt;&lt; <span class=""i"">8</span>;        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L638""><a href=""#L638"">638</a></th><td class=""line-code""><pre>                        <span class=""r"">case</span> <span class=""i"">1</span>: l|=((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*(--(c))));                \
</pre></td></tr>


<tr><th class=""line-num"" id=""L639""><a href=""#L639"">639</a></th><td class=""line-code""><pre>                                } }
</pre></td></tr>


<tr><th class=""line-num"" id=""L640""><a href=""#L640"">640</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HOST_l2c(l,c)        (*((c)++)=(<span class=""pt"">unsigned</span> <span class=""pt"">char</span>)(((l)    )&amp;<span class=""hx"">0xff</span>),        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L641""><a href=""#L641"">641</a></th><td class=""line-code""><pre>                         *((c)++)=(<span class=""pt"">unsigned</span> <span class=""pt"">char</span>)(((l)&gt;&gt; <span class=""i"">8</span>)&amp;<span class=""hx"">0xff</span>),        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L642""><a href=""#L642"">642</a></th><td class=""line-code""><pre>                         *((c)++)=(<span class=""pt"">unsigned</span> <span class=""pt"">char</span>)(((l)&gt;&gt;<span class=""i"">16</span>)&amp;<span class=""hx"">0xff</span>),        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L643""><a href=""#L643"">643</a></th><td class=""line-code""><pre>                         *((c)++)=(<span class=""pt"">unsigned</span> <span class=""pt"">char</span>)(((l)&gt;&gt;<span class=""i"">24</span>)&amp;<span class=""hx"">0xff</span>),        \
</pre></td></tr>


<tr><th class=""line-num"" id=""L644""><a href=""#L644"">644</a></th><td class=""line-code""><pre>                         l)
</pre></td></tr>


<tr><th class=""line-num"" id=""L645""><a href=""#L645"">645</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L646""><a href=""#L646"">646</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L647""><a href=""#L647"">647</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L648""><a href=""#L648"">648</a></th><td class=""line-code""><pre><span class=""c"">/*
</pre></td></tr>


<tr><th class=""line-num"" id=""L649""><a href=""#L649"">649</a></th><td class=""line-code""><pre> * Time for some action:-)
</pre></td></tr>


<tr><th class=""line-num"" id=""L650""><a href=""#L650"">650</a></th><td class=""line-code""><pre> */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L651""><a href=""#L651"">651</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L652""><a href=""#L652"">652</a></th><td class=""line-code""><pre><span class=""pt"">int</span> HASH_UPDATE (HASH_CTX *c, <span class=""di"">const</span> <span class=""di"">void</span> *data_, <span class=""pt"">unsigned</span> <span class=""pt"">long</span> len)
</pre></td></tr>


<tr><th class=""line-num"" id=""L653""><a href=""#L653"">653</a></th><td class=""line-code""><pre>        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L654""><a href=""#L654"">654</a></th><td class=""line-code""><pre>        <span class=""di"">const</span> <span class=""pt"">unsigned</span> <span class=""pt"">char</span> *data=(<span class=""di"">const</span> <span class=""pt"">unsigned</span> <span class=""pt"">char</span> *)data_;
</pre></td></tr>


<tr><th class=""line-num"" id=""L655""><a href=""#L655"">655</a></th><td class=""line-code""><pre>        <span class=""di"">register</span> HASH_LONG * p;
</pre></td></tr>


<tr><th class=""line-num"" id=""L656""><a href=""#L656"">656</a></th><td class=""line-code""><pre>        <span class=""di"">register</span> <span class=""pt"">unsigned</span> <span class=""pt"">long</span> l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L657""><a href=""#L657"">657</a></th><td class=""line-code""><pre>        <span class=""pt"">int</span> sw,sc,ew,ec;
</pre></td></tr>


<tr><th class=""line-num"" id=""L658""><a href=""#L658"">658</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L659""><a href=""#L659"">659</a></th><td class=""line-code""><pre>        <span class=""r"">if</span> (len==<span class=""i"">0</span>) <span class=""r"">return</span> <span class=""i"">1</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L660""><a href=""#L660"">660</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L661""><a href=""#L661"">661</a></th><td class=""line-code""><pre>        l=(c-&gt;Nl+(len&lt;&lt;<span class=""i"">3</span>))&amp;<span class=""hx"">0xffffffff</span>L;
</pre></td></tr>


<tr><th class=""line-num"" id=""L662""><a href=""#L662"">662</a></th><td class=""line-code""><pre>        <span class=""c"">/* 95-05-24 eay Fixed a bug with the overflow handling, thanks to
</pre></td></tr>


<tr><th class=""line-num"" id=""L663""><a href=""#L663"">663</a></th><td class=""line-code""><pre>         * Wei Dai &lt;weidai@eskimo.com&gt; for pointing it out. */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L664""><a href=""#L664"">664</a></th><td class=""line-code""><pre>        <span class=""r"">if</span> (l &lt; c-&gt;Nl) <span class=""c"">/* overflow */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L665""><a href=""#L665"">665</a></th><td class=""line-code""><pre>                c-&gt;Nh++;
</pre></td></tr>


<tr><th class=""line-num"" id=""L666""><a href=""#L666"">666</a></th><td class=""line-code""><pre>        c-&gt;Nh+=(len&gt;&gt;<span class=""i"">29</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L667""><a href=""#L667"">667</a></th><td class=""line-code""><pre>        c-&gt;Nl=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L668""><a href=""#L668"">668</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L669""><a href=""#L669"">669</a></th><td class=""line-code""><pre>        <span class=""r"">if</span> (c-&gt;num != <span class=""i"">0</span>)
</pre></td></tr>


<tr><th class=""line-num"" id=""L670""><a href=""#L670"">670</a></th><td class=""line-code""><pre>                {
</pre></td></tr>


<tr><th class=""line-num"" id=""L671""><a href=""#L671"">671</a></th><td class=""line-code""><pre>                p=c-&gt;data;
</pre></td></tr>


<tr><th class=""line-num"" id=""L672""><a href=""#L672"">672</a></th><td class=""line-code""><pre>                sw=c-&gt;num&gt;&gt;<span class=""i"">2</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L673""><a href=""#L673"">673</a></th><td class=""line-code""><pre>                sc=c-&gt;num&amp;<span class=""hx"">0x03</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L674""><a href=""#L674"">674</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L675""><a href=""#L675"">675</a></th><td class=""line-code""><pre>                <span class=""r"">if</span> ((c-&gt;num+len) &gt;= HASH_CBLOCK)
</pre></td></tr>


<tr><th class=""line-num"" id=""L676""><a href=""#L676"">676</a></th><td class=""line-code""><pre>                        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L677""><a href=""#L677"">677</a></th><td class=""line-code""><pre>                        l=p[sw]; HOST_p_c2l(data,l,sc); p[sw++]=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L678""><a href=""#L678"">678</a></th><td class=""line-code""><pre>                        <span class=""r"">for</span> (; sw&lt;HASH_LBLOCK; sw++)
</pre></td></tr>


<tr><th class=""line-num"" id=""L679""><a href=""#L679"">679</a></th><td class=""line-code""><pre>                                {
</pre></td></tr>


<tr><th class=""line-num"" id=""L680""><a href=""#L680"">680</a></th><td class=""line-code""><pre>                                HOST_c2l(data,l); p[sw]=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L681""><a href=""#L681"">681</a></th><td class=""line-code""><pre>                                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L682""><a href=""#L682"">682</a></th><td class=""line-code""><pre>                        HASH_BLOCK_HOST_ORDER (c,p,<span class=""i"">1</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L683""><a href=""#L683"">683</a></th><td class=""line-code""><pre>                        len-=(HASH_CBLOCK-c-&gt;num);
</pre></td></tr>


<tr><th class=""line-num"" id=""L684""><a href=""#L684"">684</a></th><td class=""line-code""><pre>                        c-&gt;num=<span class=""i"">0</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L685""><a href=""#L685"">685</a></th><td class=""line-code""><pre>                        <span class=""c"">/* drop through and do the rest */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L686""><a href=""#L686"">686</a></th><td class=""line-code""><pre>                        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L687""><a href=""#L687"">687</a></th><td class=""line-code""><pre>                <span class=""r"">else</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L688""><a href=""#L688"">688</a></th><td class=""line-code""><pre>                        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L689""><a href=""#L689"">689</a></th><td class=""line-code""><pre>                        c-&gt;num+=len;
</pre></td></tr>


<tr><th class=""line-num"" id=""L690""><a href=""#L690"">690</a></th><td class=""line-code""><pre>                        <span class=""r"">if</span> ((sc+len) &lt; <span class=""i"">4</span>) <span class=""c"">/* ugly, add char's to a word */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L691""><a href=""#L691"">691</a></th><td class=""line-code""><pre>                                {
</pre></td></tr>


<tr><th class=""line-num"" id=""L692""><a href=""#L692"">692</a></th><td class=""line-code""><pre>                                l=p[sw]; HOST_p_c2l_p(data,l,sc,len); p[sw]=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L693""><a href=""#L693"">693</a></th><td class=""line-code""><pre>                                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L694""><a href=""#L694"">694</a></th><td class=""line-code""><pre>                        <span class=""r"">else</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L695""><a href=""#L695"">695</a></th><td class=""line-code""><pre>                                {
</pre></td></tr>


<tr><th class=""line-num"" id=""L696""><a href=""#L696"">696</a></th><td class=""line-code""><pre>                                ew=(c-&gt;num&gt;&gt;<span class=""i"">2</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L697""><a href=""#L697"">697</a></th><td class=""line-code""><pre>                                ec=(c-&gt;num&amp;<span class=""hx"">0x03</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L698""><a href=""#L698"">698</a></th><td class=""line-code""><pre>                                <span class=""r"">if</span> (sc)
</pre></td></tr>


<tr><th class=""line-num"" id=""L699""><a href=""#L699"">699</a></th><td class=""line-code""><pre>                                        l=p[sw];
</pre></td></tr>


<tr><th class=""line-num"" id=""L700""><a href=""#L700"">700</a></th><td class=""line-code""><pre>                                HOST_p_c2l(data,l,sc);
</pre></td></tr>


<tr><th class=""line-num"" id=""L701""><a href=""#L701"">701</a></th><td class=""line-code""><pre>                                p[sw++]=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L702""><a href=""#L702"">702</a></th><td class=""line-code""><pre>                                <span class=""r"">for</span> (; sw &lt; ew; sw++)
</pre></td></tr>


<tr><th class=""line-num"" id=""L703""><a href=""#L703"">703</a></th><td class=""line-code""><pre>                                        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L704""><a href=""#L704"">704</a></th><td class=""line-code""><pre>                                        HOST_c2l(data,l); p[sw]=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L705""><a href=""#L705"">705</a></th><td class=""line-code""><pre>                                        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L706""><a href=""#L706"">706</a></th><td class=""line-code""><pre>                                <span class=""r"">if</span> (ec)
</pre></td></tr>


<tr><th class=""line-num"" id=""L707""><a href=""#L707"">707</a></th><td class=""line-code""><pre>                                        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L708""><a href=""#L708"">708</a></th><td class=""line-code""><pre>                                        HOST_c2l_p(data,l,ec); p[sw]=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L709""><a href=""#L709"">709</a></th><td class=""line-code""><pre>                                        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L710""><a href=""#L710"">710</a></th><td class=""line-code""><pre>                                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L711""><a href=""#L711"">711</a></th><td class=""line-code""><pre>                        <span class=""r"">return</span> <span class=""i"">1</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L712""><a href=""#L712"">712</a></th><td class=""line-code""><pre>                        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L713""><a href=""#L713"">713</a></th><td class=""line-code""><pre>                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L714""><a href=""#L714"">714</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L715""><a href=""#L715"">715</a></th><td class=""line-code""><pre>        sw=(<span class=""pt"">int</span>)(len/HASH_CBLOCK);
</pre></td></tr>


<tr><th class=""line-num"" id=""L716""><a href=""#L716"">716</a></th><td class=""line-code""><pre>        <span class=""r"">if</span> (sw &gt; <span class=""i"">0</span>)
</pre></td></tr>


<tr><th class=""line-num"" id=""L717""><a href=""#L717"">717</a></th><td class=""line-code""><pre>                {
</pre></td></tr>


<tr><th class=""line-num"" id=""L718""><a href=""#L718"">718</a></th><td class=""line-code""><pre><span class=""pp"">#if</span> defined(HASH_BLOCK_DATA_ORDER_ALIGNED)
</pre></td></tr>


<tr><th class=""line-num"" id=""L719""><a href=""#L719"">719</a></th><td class=""line-code""><pre>                <span class=""c"">/*
</pre></td></tr>


<tr><th class=""line-num"" id=""L720""><a href=""#L720"">720</a></th><td class=""line-code""><pre>                 * Note that HASH_BLOCK_DATA_ORDER_ALIGNED gets defined
</pre></td></tr>


<tr><th class=""line-num"" id=""L721""><a href=""#L721"">721</a></th><td class=""line-code""><pre>                 * only if sizeof(HASH_LONG)==4.
</pre></td></tr>


<tr><th class=""line-num"" id=""L722""><a href=""#L722"">722</a></th><td class=""line-code""><pre>                 */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L723""><a href=""#L723"">723</a></th><td class=""line-code""><pre>                <span class=""r"">if</span> ((((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)data)%<span class=""i"">4</span>) == <span class=""i"">0</span>)
</pre></td></tr>


<tr><th class=""line-num"" id=""L724""><a href=""#L724"">724</a></th><td class=""line-code""><pre>                        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L725""><a href=""#L725"">725</a></th><td class=""line-code""><pre>                        <span class=""c"">/* data is properly aligned so that we can cast it: */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L726""><a href=""#L726"">726</a></th><td class=""line-code""><pre>                        HASH_BLOCK_DATA_ORDER_ALIGNED (c,(HASH_LONG *)data,sw);
</pre></td></tr>


<tr><th class=""line-num"" id=""L727""><a href=""#L727"">727</a></th><td class=""line-code""><pre>                        sw*=HASH_CBLOCK;
</pre></td></tr>


<tr><th class=""line-num"" id=""L728""><a href=""#L728"">728</a></th><td class=""line-code""><pre>                        data+=sw;
</pre></td></tr>


<tr><th class=""line-num"" id=""L729""><a href=""#L729"">729</a></th><td class=""line-code""><pre>                        len-=sw;
</pre></td></tr>


<tr><th class=""line-num"" id=""L730""><a href=""#L730"">730</a></th><td class=""line-code""><pre>                        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L731""><a href=""#L731"">731</a></th><td class=""line-code""><pre>                <span class=""r"">else</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L732""><a href=""#L732"">732</a></th><td class=""line-code""><pre><span class=""pp"">#if</span> !defined(HASH_BLOCK_DATA_ORDER)
</pre></td></tr>


<tr><th class=""line-num"" id=""L733""><a href=""#L733"">733</a></th><td class=""line-code""><pre>                        <span class=""r"">while</span> (sw--)
</pre></td></tr>


<tr><th class=""line-num"" id=""L734""><a href=""#L734"">734</a></th><td class=""line-code""><pre>                                {
</pre></td></tr>


<tr><th class=""line-num"" id=""L735""><a href=""#L735"">735</a></th><td class=""line-code""><pre>                                mDNSPlatformMemCopy(p=c-&gt;data,data,HASH_CBLOCK);
</pre></td></tr>


<tr><th class=""line-num"" id=""L736""><a href=""#L736"">736</a></th><td class=""line-code""><pre>                                HASH_BLOCK_DATA_ORDER_ALIGNED(c,p,<span class=""i"">1</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L737""><a href=""#L737"">737</a></th><td class=""line-code""><pre>                                data+=HASH_CBLOCK;
</pre></td></tr>


<tr><th class=""line-num"" id=""L738""><a href=""#L738"">738</a></th><td class=""line-code""><pre>                                len-=HASH_CBLOCK;
</pre></td></tr>


<tr><th class=""line-num"" id=""L739""><a href=""#L739"">739</a></th><td class=""line-code""><pre>                                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L740""><a href=""#L740"">740</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L741""><a href=""#L741"">741</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L742""><a href=""#L742"">742</a></th><td class=""line-code""><pre><span class=""pp"">#if</span> defined(HASH_BLOCK_DATA_ORDER)
</pre></td></tr>


<tr><th class=""line-num"" id=""L743""><a href=""#L743"">743</a></th><td class=""line-code""><pre>                        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L744""><a href=""#L744"">744</a></th><td class=""line-code""><pre>                        HASH_BLOCK_DATA_ORDER(c,data,sw);
</pre></td></tr>


<tr><th class=""line-num"" id=""L745""><a href=""#L745"">745</a></th><td class=""line-code""><pre>                        sw*=HASH_CBLOCK;
</pre></td></tr>


<tr><th class=""line-num"" id=""L746""><a href=""#L746"">746</a></th><td class=""line-code""><pre>                        data+=sw;
</pre></td></tr>


<tr><th class=""line-num"" id=""L747""><a href=""#L747"">747</a></th><td class=""line-code""><pre>                        len-=sw;
</pre></td></tr>


<tr><th class=""line-num"" id=""L748""><a href=""#L748"">748</a></th><td class=""line-code""><pre>                        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L749""><a href=""#L749"">749</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L750""><a href=""#L750"">750</a></th><td class=""line-code""><pre>                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L751""><a href=""#L751"">751</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L752""><a href=""#L752"">752</a></th><td class=""line-code""><pre>        <span class=""r"">if</span> (len!=<span class=""i"">0</span>)
</pre></td></tr>


<tr><th class=""line-num"" id=""L753""><a href=""#L753"">753</a></th><td class=""line-code""><pre>                {
</pre></td></tr>


<tr><th class=""line-num"" id=""L754""><a href=""#L754"">754</a></th><td class=""line-code""><pre>                p = c-&gt;data;
</pre></td></tr>


<tr><th class=""line-num"" id=""L755""><a href=""#L755"">755</a></th><td class=""line-code""><pre>                c-&gt;num = (<span class=""pt"">int</span>)len;
</pre></td></tr>


<tr><th class=""line-num"" id=""L756""><a href=""#L756"">756</a></th><td class=""line-code""><pre>                ew=(<span class=""pt"">int</span>)(len&gt;&gt;<span class=""i"">2</span>);        <span class=""c"">/* words to copy */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L757""><a href=""#L757"">757</a></th><td class=""line-code""><pre>                ec=(<span class=""pt"">int</span>)(len&amp;<span class=""hx"">0x03</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L758""><a href=""#L758"">758</a></th><td class=""line-code""><pre>                <span class=""r"">for</span> (; ew; ew--,p++)
</pre></td></tr>


<tr><th class=""line-num"" id=""L759""><a href=""#L759"">759</a></th><td class=""line-code""><pre>                        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L760""><a href=""#L760"">760</a></th><td class=""line-code""><pre>                        HOST_c2l(data,l); *p=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L761""><a href=""#L761"">761</a></th><td class=""line-code""><pre>                        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L762""><a href=""#L762"">762</a></th><td class=""line-code""><pre>                HOST_c2l_p(data,l,ec);
</pre></td></tr>


<tr><th class=""line-num"" id=""L763""><a href=""#L763"">763</a></th><td class=""line-code""><pre>                *p=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L764""><a href=""#L764"">764</a></th><td class=""line-code""><pre>                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L765""><a href=""#L765"">765</a></th><td class=""line-code""><pre>        <span class=""r"">return</span> <span class=""i"">1</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L766""><a href=""#L766"">766</a></th><td class=""line-code""><pre>        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L767""><a href=""#L767"">767</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L768""><a href=""#L768"">768</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L769""><a href=""#L769"">769</a></th><td class=""line-code""><pre><span class=""di"">void</span> HASH_TRANSFORM (HASH_CTX *c, <span class=""di"">const</span> <span class=""pt"">unsigned</span> <span class=""pt"">char</span> *data)
</pre></td></tr>


<tr><th class=""line-num"" id=""L770""><a href=""#L770"">770</a></th><td class=""line-code""><pre>        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L771""><a href=""#L771"">771</a></th><td class=""line-code""><pre><span class=""pp"">#if</span> defined(HASH_BLOCK_DATA_ORDER_ALIGNED)
</pre></td></tr>


<tr><th class=""line-num"" id=""L772""><a href=""#L772"">772</a></th><td class=""line-code""><pre>        <span class=""r"">if</span> ((((<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)data)%<span class=""i"">4</span>) == <span class=""i"">0</span>)
</pre></td></tr>


<tr><th class=""line-num"" id=""L773""><a href=""#L773"">773</a></th><td class=""line-code""><pre>                <span class=""c"">/* data is properly aligned so that we can cast it: */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L774""><a href=""#L774"">774</a></th><td class=""line-code""><pre>                HASH_BLOCK_DATA_ORDER_ALIGNED (c,(HASH_LONG *)data,<span class=""i"">1</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L775""><a href=""#L775"">775</a></th><td class=""line-code""><pre>        <span class=""r"">else</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L776""><a href=""#L776"">776</a></th><td class=""line-code""><pre><span class=""pp"">#if</span> !defined(HASH_BLOCK_DATA_ORDER)
</pre></td></tr>


<tr><th class=""line-num"" id=""L777""><a href=""#L777"">777</a></th><td class=""line-code""><pre>                {
</pre></td></tr>


<tr><th class=""line-num"" id=""L778""><a href=""#L778"">778</a></th><td class=""line-code""><pre>                mDNSPlatformMemCopy(c-&gt;data,data,HASH_CBLOCK);
</pre></td></tr>


<tr><th class=""line-num"" id=""L779""><a href=""#L779"">779</a></th><td class=""line-code""><pre>                HASH_BLOCK_DATA_ORDER_ALIGNED (c,c-&gt;data,<span class=""i"">1</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L780""><a href=""#L780"">780</a></th><td class=""line-code""><pre>                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L781""><a href=""#L781"">781</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L782""><a href=""#L782"">782</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L783""><a href=""#L783"">783</a></th><td class=""line-code""><pre><span class=""pp"">#if</span> defined(HASH_BLOCK_DATA_ORDER)
</pre></td></tr>


<tr><th class=""line-num"" id=""L784""><a href=""#L784"">784</a></th><td class=""line-code""><pre>        HASH_BLOCK_DATA_ORDER (c,data,<span class=""i"">1</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L785""><a href=""#L785"">785</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L786""><a href=""#L786"">786</a></th><td class=""line-code""><pre>        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L787""><a href=""#L787"">787</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L788""><a href=""#L788"">788</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L789""><a href=""#L789"">789</a></th><td class=""line-code""><pre><span class=""pt"">int</span> HASH_FINAL (<span class=""pt"">unsigned</span> <span class=""pt"">char</span> *md, HASH_CTX *c)
</pre></td></tr>


<tr><th class=""line-num"" id=""L790""><a href=""#L790"">790</a></th><td class=""line-code""><pre>        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L791""><a href=""#L791"">791</a></th><td class=""line-code""><pre>        <span class=""di"">register</span> HASH_LONG *p;
</pre></td></tr>


<tr><th class=""line-num"" id=""L792""><a href=""#L792"">792</a></th><td class=""line-code""><pre>        <span class=""di"">register</span> <span class=""pt"">unsigned</span> <span class=""pt"">long</span> l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L793""><a href=""#L793"">793</a></th><td class=""line-code""><pre>        <span class=""di"">register</span> <span class=""pt"">int</span> i,j;
</pre></td></tr>


<tr><th class=""line-num"" id=""L794""><a href=""#L794"">794</a></th><td class=""line-code""><pre>        <span class=""di"">static</span> <span class=""di"">const</span> <span class=""pt"">unsigned</span> <span class=""pt"">char</span> end[<span class=""i"">4</span>]={<span class=""hx"">0x80</span>,<span class=""hx"">0x00</span>,<span class=""hx"">0x00</span>,<span class=""hx"">0x00</span>};
</pre></td></tr>


<tr><th class=""line-num"" id=""L795""><a href=""#L795"">795</a></th><td class=""line-code""><pre>        <span class=""di"">const</span> <span class=""pt"">unsigned</span> <span class=""pt"">char</span> *cp=end;
</pre></td></tr>


<tr><th class=""line-num"" id=""L796""><a href=""#L796"">796</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L797""><a href=""#L797"">797</a></th><td class=""line-code""><pre>        <span class=""c"">/* c-&gt;num should definitly have room for at least one more byte. */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L798""><a href=""#L798"">798</a></th><td class=""line-code""><pre>        p=c-&gt;data;
</pre></td></tr>


<tr><th class=""line-num"" id=""L799""><a href=""#L799"">799</a></th><td class=""line-code""><pre>        i=c-&gt;num&gt;&gt;<span class=""i"">2</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L800""><a href=""#L800"">800</a></th><td class=""line-code""><pre>        j=c-&gt;num&amp;<span class=""hx"">0x03</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L801""><a href=""#L801"">801</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L802""><a href=""#L802"">802</a></th><td class=""line-code""><pre><span class=""c"">#if 0
</pre></td></tr>


<tr><th class=""line-num"" id=""L803""><a href=""#L803"">803</a></th><td class=""line-code""><pre>        /* purify often complains about the following line as an
</pre></td></tr>


<tr><th class=""line-num"" id=""L804""><a href=""#L804"">804</a></th><td class=""line-code""><pre>         * Uninitialized Memory Read.  While this can be true, the
</pre></td></tr>


<tr><th class=""line-num"" id=""L805""><a href=""#L805"">805</a></th><td class=""line-code""><pre>         * following p_c2l macro will reset l when that case is true.
</pre></td></tr>


<tr><th class=""line-num"" id=""L806""><a href=""#L806"">806</a></th><td class=""line-code""><pre>         * This is because j&amp;0x03 contains the number of 'valid' bytes
</pre></td></tr>


<tr><th class=""line-num"" id=""L807""><a href=""#L807"">807</a></th><td class=""line-code""><pre>         * already in p[i].  If and only if j&amp;0x03 == 0, the UMR will
</pre></td></tr>


<tr><th class=""line-num"" id=""L808""><a href=""#L808"">808</a></th><td class=""line-code""><pre>         * occur but this is also the only time p_c2l will do
</pre></td></tr>


<tr><th class=""line-num"" id=""L809""><a href=""#L809"">809</a></th><td class=""line-code""><pre>         * l= *(cp++) instead of l|= *(cp++)
</pre></td></tr>


<tr><th class=""line-num"" id=""L810""><a href=""#L810"">810</a></th><td class=""line-code""><pre>         * Many thanks to Alex Tang &lt;altitude@cic.net&gt; for pickup this
</pre></td></tr>


<tr><th class=""line-num"" id=""L811""><a href=""#L811"">811</a></th><td class=""line-code""><pre>         * 'potential bug' */
</pre></td></tr>


<tr><th class=""line-num"" id=""L812""><a href=""#L812"">812</a></th><td class=""line-code""><pre>#ifdef PURIFY
</pre></td></tr>


<tr><th class=""line-num"" id=""L813""><a href=""#L813"">813</a></th><td class=""line-code""><pre>        if (j==0) p[i]=0; /* Yeah, but that's not the way to fix it:-) */
</pre></td></tr>


<tr><th class=""line-num"" id=""L814""><a href=""#L814"">814</a></th><td class=""line-code""><pre>#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L815""><a href=""#L815"">815</a></th><td class=""line-code""><pre>        l=p[i];
</pre></td></tr>


<tr><th class=""line-num"" id=""L816""><a href=""#L816"">816</a></th><td class=""line-code""><pre><span class=""pp"">#else</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L817""><a href=""#L817"">817</a></th><td class=""line-code""><pre>        l = (j==<span class=""i"">0</span>) ? <span class=""i"">0</span> : p[i];
</pre></td></tr>


<tr><th class=""line-num"" id=""L818""><a href=""#L818"">818</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L819""><a href=""#L819"">819</a></th><td class=""line-code""><pre>        HOST_p_c2l(cp,l,j); p[i++]=l; <span class=""c"">/* i is the next 'undefined word' */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L820""><a href=""#L820"">820</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L821""><a href=""#L821"">821</a></th><td class=""line-code""><pre>        <span class=""r"">if</span> (i&gt;(HASH_LBLOCK-<span class=""i"">2</span>)) <span class=""c"">/* save room for Nl and Nh */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L822""><a href=""#L822"">822</a></th><td class=""line-code""><pre>                {
</pre></td></tr>


<tr><th class=""line-num"" id=""L823""><a href=""#L823"">823</a></th><td class=""line-code""><pre>                <span class=""r"">if</span> (i&lt;HASH_LBLOCK) p[i]=<span class=""i"">0</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L824""><a href=""#L824"">824</a></th><td class=""line-code""><pre>                HASH_BLOCK_HOST_ORDER (c,p,<span class=""i"">1</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L825""><a href=""#L825"">825</a></th><td class=""line-code""><pre>                i=<span class=""i"">0</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L826""><a href=""#L826"">826</a></th><td class=""line-code""><pre>                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L827""><a href=""#L827"">827</a></th><td class=""line-code""><pre>        <span class=""r"">for</span> (; i&lt;(HASH_LBLOCK-<span class=""i"">2</span>); i++)
</pre></td></tr>


<tr><th class=""line-num"" id=""L828""><a href=""#L828"">828</a></th><td class=""line-code""><pre>                p[i]=<span class=""i"">0</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L829""><a href=""#L829"">829</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L830""><a href=""#L830"">830</a></th><td class=""line-code""><pre><span class=""pp"">#if</span>   defined(DATA_ORDER_IS_BIG_ENDIAN)
</pre></td></tr>


<tr><th class=""line-num"" id=""L831""><a href=""#L831"">831</a></th><td class=""line-code""><pre>        p[HASH_LBLOCK-<span class=""i"">2</span>]=c-&gt;Nh;
</pre></td></tr>


<tr><th class=""line-num"" id=""L832""><a href=""#L832"">832</a></th><td class=""line-code""><pre>        p[HASH_LBLOCK-<span class=""i"">1</span>]=c-&gt;Nl;
</pre></td></tr>


<tr><th class=""line-num"" id=""L833""><a href=""#L833"">833</a></th><td class=""line-code""><pre><span class=""pp"">#elif</span> defined(DATA_ORDER_IS_LITTLE_ENDIAN)
</pre></td></tr>


<tr><th class=""line-num"" id=""L834""><a href=""#L834"">834</a></th><td class=""line-code""><pre>        p[HASH_LBLOCK-<span class=""i"">2</span>]=c-&gt;Nl;
</pre></td></tr>


<tr><th class=""line-num"" id=""L835""><a href=""#L835"">835</a></th><td class=""line-code""><pre>        p[HASH_LBLOCK-<span class=""i"">1</span>]=c-&gt;Nh;
</pre></td></tr>


<tr><th class=""line-num"" id=""L836""><a href=""#L836"">836</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L837""><a href=""#L837"">837</a></th><td class=""line-code""><pre>        HASH_BLOCK_HOST_ORDER (c,p,<span class=""i"">1</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L838""><a href=""#L838"">838</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L839""><a href=""#L839"">839</a></th><td class=""line-code""><pre><span class=""pp"">#ifndef</span> HASH_MAKE_STRING
</pre></td></tr>


<tr><th class=""line-num"" id=""L840""><a href=""#L840"">840</a></th><td class=""line-code""><pre><span class=""pp"">#error</span> <span class=""s""><span class=""dl"">&quot;</span><span class=""k"">HASH_MAKE_STRING must be defined!</span><span class=""dl"">&quot;</span></span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L841""><a href=""#L841"">841</a></th><td class=""line-code""><pre><span class=""pp"">#else</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L842""><a href=""#L842"">842</a></th><td class=""line-code""><pre>        HASH_MAKE_STRING(c,md);
</pre></td></tr>


<tr><th class=""line-num"" id=""L843""><a href=""#L843"">843</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L844""><a href=""#L844"">844</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L845""><a href=""#L845"">845</a></th><td class=""line-code""><pre>        c-&gt;num=<span class=""i"">0</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L846""><a href=""#L846"">846</a></th><td class=""line-code""><pre>        <span class=""c"">/* clear stuff, HASH_BLOCK may be leaving some stuff on the stack
</pre></td></tr>


<tr><th class=""line-num"" id=""L847""><a href=""#L847"">847</a></th><td class=""line-code""><pre>         * but I'm not worried :-)
</pre></td></tr>


<tr><th class=""line-num"" id=""L848""><a href=""#L848"">848</a></th><td class=""line-code""><pre>        OPENSSL_cleanse((void *)c,sizeof(HASH_CTX));
</pre></td></tr>


<tr><th class=""line-num"" id=""L849""><a href=""#L849"">849</a></th><td class=""line-code""><pre>         */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L850""><a href=""#L850"">850</a></th><td class=""line-code""><pre>        <span class=""r"">return</span> <span class=""i"">1</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L851""><a href=""#L851"">851</a></th><td class=""line-code""><pre>        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L852""><a href=""#L852"">852</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L853""><a href=""#L853"">853</a></th><td class=""line-code""><pre><span class=""pp"">#ifndef</span> MD32_REG_T
</pre></td></tr>


<tr><th class=""line-num"" id=""L854""><a href=""#L854"">854</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> MD32_REG_T <span class=""pt"">long</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L855""><a href=""#L855"">855</a></th><td class=""line-code""><pre><span class=""c"">/*
</pre></td></tr>


<tr><th class=""line-num"" id=""L856""><a href=""#L856"">856</a></th><td class=""line-code""><pre> * This comment was originaly written for MD5, which is why it
</pre></td></tr>


<tr><th class=""line-num"" id=""L857""><a href=""#L857"">857</a></th><td class=""line-code""><pre> * discusses A-D. But it basically applies to all 32-bit digests,
</pre></td></tr>


<tr><th class=""line-num"" id=""L858""><a href=""#L858"">858</a></th><td class=""line-code""><pre> * which is why it was moved to common header file.
</pre></td></tr>


<tr><th class=""line-num"" id=""L859""><a href=""#L859"">859</a></th><td class=""line-code""><pre> *
</pre></td></tr>


<tr><th class=""line-num"" id=""L860""><a href=""#L860"">860</a></th><td class=""line-code""><pre> * In case you wonder why A-D are declared as long and not
</pre></td></tr>


<tr><th class=""line-num"" id=""L861""><a href=""#L861"">861</a></th><td class=""line-code""><pre> * as mDNSu32. Doing so results in slight performance
</pre></td></tr>


<tr><th class=""line-num"" id=""L862""><a href=""#L862"">862</a></th><td class=""line-code""><pre> * boost on LP64 architectures. The catch is we don't
</pre></td></tr>


<tr><th class=""line-num"" id=""L863""><a href=""#L863"">863</a></th><td class=""line-code""><pre> * really care if 32 MSBs of a 64-bit register get polluted
</pre></td></tr>


<tr><th class=""line-num"" id=""L864""><a href=""#L864"">864</a></th><td class=""line-code""><pre> * with eventual overflows as we *save* only 32 LSBs in
</pre></td></tr>


<tr><th class=""line-num"" id=""L865""><a href=""#L865"">865</a></th><td class=""line-code""><pre> * *either* case. Now declaring 'em long excuses the compiler
</pre></td></tr>


<tr><th class=""line-num"" id=""L866""><a href=""#L866"">866</a></th><td class=""line-code""><pre> * from keeping 32 MSBs zeroed resulting in 13% performance
</pre></td></tr>


<tr><th class=""line-num"" id=""L867""><a href=""#L867"">867</a></th><td class=""line-code""><pre> * improvement under SPARC Solaris7/64 and 5% under AlphaLinux.
</pre></td></tr>


<tr><th class=""line-num"" id=""L868""><a href=""#L868"">868</a></th><td class=""line-code""><pre> * Well, to be honest it should say that this *prevents* 
</pre></td></tr>


<tr><th class=""line-num"" id=""L869""><a href=""#L869"">869</a></th><td class=""line-code""><pre> * performance degradation.
</pre></td></tr>


<tr><th class=""line-num"" id=""L870""><a href=""#L870"">870</a></th><td class=""line-code""><pre> *                                &lt;appro@fy.chalmers.se&gt;
</pre></td></tr>


<tr><th class=""line-num"" id=""L871""><a href=""#L871"">871</a></th><td class=""line-code""><pre> * Apparently there're LP64 compilers that generate better
</pre></td></tr>


<tr><th class=""line-num"" id=""L872""><a href=""#L872"">872</a></th><td class=""line-code""><pre> * code if A-D are declared int. Most notably GCC-x86_64
</pre></td></tr>


<tr><th class=""line-num"" id=""L873""><a href=""#L873"">873</a></th><td class=""line-code""><pre> * generates better code.
</pre></td></tr>


<tr><th class=""line-num"" id=""L874""><a href=""#L874"">874</a></th><td class=""line-code""><pre> *                                &lt;appro@fy.chalmers.se&gt;
</pre></td></tr>


<tr><th class=""line-num"" id=""L875""><a href=""#L875"">875</a></th><td class=""line-code""><pre> */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L876""><a href=""#L876"">876</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L877""><a href=""#L877"">877</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L878""><a href=""#L878"">878</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L879""><a href=""#L879"">879</a></th><td class=""line-code""><pre><span class=""c"">// from md5_locl.h (continued)</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L880""><a href=""#L880"">880</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L881""><a href=""#L881"">881</a></th><td class=""line-code""><pre><span class=""c"">/*
</pre></td></tr>


<tr><th class=""line-num"" id=""L882""><a href=""#L882"">882</a></th><td class=""line-code""><pre>#define        F(x,y,z)        (((x) &amp; (y))  |  ((~(x)) &amp; (z)))
</pre></td></tr>


<tr><th class=""line-num"" id=""L883""><a href=""#L883"">883</a></th><td class=""line-code""><pre>#define        G(x,y,z)        (((x) &amp; (z))  |  ((y) &amp; (~(z))))
</pre></td></tr>


<tr><th class=""line-num"" id=""L884""><a href=""#L884"">884</a></th><td class=""line-code""><pre>*/</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L885""><a href=""#L885"">885</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L886""><a href=""#L886"">886</a></th><td class=""line-code""><pre><span class=""c"">/* As pointed out by Wei Dai &lt;weidai@eskimo.com&gt;, the above can be
</pre></td></tr>


<tr><th class=""line-num"" id=""L887""><a href=""#L887"">887</a></th><td class=""line-code""><pre> * simplified to the code below.  Wei attributes these optimizations
</pre></td></tr>


<tr><th class=""line-num"" id=""L888""><a href=""#L888"">888</a></th><td class=""line-code""><pre> * to Peter Gutmann's SHS code, and he attributes it to Rich Schroeppel.
</pre></td></tr>


<tr><th class=""line-num"" id=""L889""><a href=""#L889"">889</a></th><td class=""line-code""><pre> */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L890""><a href=""#L890"">890</a></th><td class=""line-code""><pre><span class=""pp"">#define</span>        F(b,c,d)        ((((c) ^ (d)) &amp; (b)) ^ (d))
</pre></td></tr>


<tr><th class=""line-num"" id=""L891""><a href=""#L891"">891</a></th><td class=""line-code""><pre><span class=""pp"">#define</span>        G(b,c,d)        ((((b) ^ (c)) &amp; (d)) ^ (c))
</pre></td></tr>


<tr><th class=""line-num"" id=""L892""><a href=""#L892"">892</a></th><td class=""line-code""><pre><span class=""pp"">#define</span>        H(b,c,d)        ((b) ^ (c) ^ (d))
</pre></td></tr>


<tr><th class=""line-num"" id=""L893""><a href=""#L893"">893</a></th><td class=""line-code""><pre><span class=""pp"">#define</span>        I(b,c,d)        (((~(d)) | (b)) ^ (c))
</pre></td></tr>


<tr><th class=""line-num"" id=""L894""><a href=""#L894"">894</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L895""><a href=""#L895"">895</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> R0(a,b,c,d,k,s,t) { \
</pre></td></tr>


<tr><th class=""line-num"" id=""L896""><a href=""#L896"">896</a></th><td class=""line-code""><pre>        a+=((k)+(t)+F((b),(c),(d))); \
</pre></td></tr>


<tr><th class=""line-num"" id=""L897""><a href=""#L897"">897</a></th><td class=""line-code""><pre>        a=ROTATE(a,s); \
</pre></td></tr>


<tr><th class=""line-num"" id=""L898""><a href=""#L898"">898</a></th><td class=""line-code""><pre>        a+=b; };\
</pre></td></tr>


<tr><th class=""line-num"" id=""L899""><a href=""#L899"">899</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L900""><a href=""#L900"">900</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> R1(a,b,c,d,k,s,t) { \
</pre></td></tr>


<tr><th class=""line-num"" id=""L901""><a href=""#L901"">901</a></th><td class=""line-code""><pre>        a+=((k)+(t)+G((b),(c),(d))); \
</pre></td></tr>


<tr><th class=""line-num"" id=""L902""><a href=""#L902"">902</a></th><td class=""line-code""><pre>        a=ROTATE(a,s); \
</pre></td></tr>


<tr><th class=""line-num"" id=""L903""><a href=""#L903"">903</a></th><td class=""line-code""><pre>        a+=b; };
</pre></td></tr>


<tr><th class=""line-num"" id=""L904""><a href=""#L904"">904</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L905""><a href=""#L905"">905</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> R2(a,b,c,d,k,s,t) { \
</pre></td></tr>


<tr><th class=""line-num"" id=""L906""><a href=""#L906"">906</a></th><td class=""line-code""><pre>        a+=((k)+(t)+H((b),(c),(d))); \
</pre></td></tr>


<tr><th class=""line-num"" id=""L907""><a href=""#L907"">907</a></th><td class=""line-code""><pre>        a=ROTATE(a,s); \
</pre></td></tr>


<tr><th class=""line-num"" id=""L908""><a href=""#L908"">908</a></th><td class=""line-code""><pre>        a+=b; };
</pre></td></tr>


<tr><th class=""line-num"" id=""L909""><a href=""#L909"">909</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L910""><a href=""#L910"">910</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> R3(a,b,c,d,k,s,t) { \
</pre></td></tr>


<tr><th class=""line-num"" id=""L911""><a href=""#L911"">911</a></th><td class=""line-code""><pre>        a+=((k)+(t)+I((b),(c),(d))); \
</pre></td></tr>


<tr><th class=""line-num"" id=""L912""><a href=""#L912"">912</a></th><td class=""line-code""><pre>        a=ROTATE(a,s); \
</pre></td></tr>


<tr><th class=""line-num"" id=""L913""><a href=""#L913"">913</a></th><td class=""line-code""><pre>        a+=b; };
</pre></td></tr>


<tr><th class=""line-num"" id=""L914""><a href=""#L914"">914</a></th><td class=""line-code""><pre>        
</pre></td></tr>


<tr><th class=""line-num"" id=""L915""><a href=""#L915"">915</a></th><td class=""line-code""><pre><span class=""c"">// from md5_dgst.c</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L916""><a href=""#L916"">916</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L917""><a href=""#L917"">917</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L918""><a href=""#L918"">918</a></th><td class=""line-code""><pre><span class=""c"">/* Implemented from RFC1321 The MD5 Message-Digest Algorithm
</pre></td></tr>


<tr><th class=""line-num"" id=""L919""><a href=""#L919"">919</a></th><td class=""line-code""><pre> */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L920""><a href=""#L920"">920</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L921""><a href=""#L921"">921</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> INIT_DATA_A (<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)<span class=""hx"">0x67452301</span>L
</pre></td></tr>


<tr><th class=""line-num"" id=""L922""><a href=""#L922"">922</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> INIT_DATA_B (<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)<span class=""hx"">0xefcdab89</span>L
</pre></td></tr>


<tr><th class=""line-num"" id=""L923""><a href=""#L923"">923</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> INIT_DATA_C (<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)<span class=""hx"">0x98badcfe</span>L
</pre></td></tr>


<tr><th class=""line-num"" id=""L924""><a href=""#L924"">924</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> INIT_DATA_D (<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)<span class=""hx"">0x10325476</span>L
</pre></td></tr>


<tr><th class=""line-num"" id=""L925""><a href=""#L925"">925</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L926""><a href=""#L926"">926</a></th><td class=""line-code""><pre><span class=""pt"">int</span> MD5_Init(MD5_CTX *c)
</pre></td></tr>


<tr><th class=""line-num"" id=""L927""><a href=""#L927"">927</a></th><td class=""line-code""><pre>        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L928""><a href=""#L928"">928</a></th><td class=""line-code""><pre>        c-&gt;A=INIT_DATA_A;
</pre></td></tr>


<tr><th class=""line-num"" id=""L929""><a href=""#L929"">929</a></th><td class=""line-code""><pre>        c-&gt;B=INIT_DATA_B;
</pre></td></tr>


<tr><th class=""line-num"" id=""L930""><a href=""#L930"">930</a></th><td class=""line-code""><pre>        c-&gt;C=INIT_DATA_C;
</pre></td></tr>


<tr><th class=""line-num"" id=""L931""><a href=""#L931"">931</a></th><td class=""line-code""><pre>        c-&gt;D=INIT_DATA_D;
</pre></td></tr>


<tr><th class=""line-num"" id=""L932""><a href=""#L932"">932</a></th><td class=""line-code""><pre>        c-&gt;Nl=<span class=""i"">0</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L933""><a href=""#L933"">933</a></th><td class=""line-code""><pre>        c-&gt;Nh=<span class=""i"">0</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L934""><a href=""#L934"">934</a></th><td class=""line-code""><pre>        c-&gt;num=<span class=""i"">0</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L935""><a href=""#L935"">935</a></th><td class=""line-code""><pre>        <span class=""r"">return</span> <span class=""i"">1</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L936""><a href=""#L936"">936</a></th><td class=""line-code""><pre>        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L937""><a href=""#L937"">937</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L938""><a href=""#L938"">938</a></th><td class=""line-code""><pre><span class=""pp"">#ifndef</span> md5_block_host_order
</pre></td></tr>


<tr><th class=""line-num"" id=""L939""><a href=""#L939"">939</a></th><td class=""line-code""><pre><span class=""di"">void</span> md5_block_host_order (MD5_CTX *c, <span class=""di"">const</span> <span class=""di"">void</span> *data, <span class=""pt"">int</span> num)
</pre></td></tr>


<tr><th class=""line-num"" id=""L940""><a href=""#L940"">940</a></th><td class=""line-code""><pre>        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L941""><a href=""#L941"">941</a></th><td class=""line-code""><pre>        <span class=""di"">const</span> mDNSu32 *X=(<span class=""di"">const</span> mDNSu32 *)data;
</pre></td></tr>


<tr><th class=""line-num"" id=""L942""><a href=""#L942"">942</a></th><td class=""line-code""><pre>        <span class=""di"">register</span> <span class=""pt"">unsigned</span> MD32_REG_T A,B,C,D;
</pre></td></tr>


<tr><th class=""line-num"" id=""L943""><a href=""#L943"">943</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L944""><a href=""#L944"">944</a></th><td class=""line-code""><pre>        A=c-&gt;A;
</pre></td></tr>


<tr><th class=""line-num"" id=""L945""><a href=""#L945"">945</a></th><td class=""line-code""><pre>        B=c-&gt;B;
</pre></td></tr>


<tr><th class=""line-num"" id=""L946""><a href=""#L946"">946</a></th><td class=""line-code""><pre>        C=c-&gt;C;
</pre></td></tr>


<tr><th class=""line-num"" id=""L947""><a href=""#L947"">947</a></th><td class=""line-code""><pre>        D=c-&gt;D;
</pre></td></tr>


<tr><th class=""line-num"" id=""L948""><a href=""#L948"">948</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L949""><a href=""#L949"">949</a></th><td class=""line-code""><pre>        <span class=""r"">for</span> (;num--;X+=HASH_LBLOCK)
</pre></td></tr>


<tr><th class=""line-num"" id=""L950""><a href=""#L950"">950</a></th><td class=""line-code""><pre>                {
</pre></td></tr>


<tr><th class=""line-num"" id=""L951""><a href=""#L951"">951</a></th><td class=""line-code""><pre>        <span class=""c"">/* Round 0 */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L952""><a href=""#L952"">952</a></th><td class=""line-code""><pre>        R0(A,B,C,D,X[ <span class=""i"">0</span>], <span class=""i"">7</span>,<span class=""hx"">0xd76aa478</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L953""><a href=""#L953"">953</a></th><td class=""line-code""><pre>        R0(D,A,B,C,X[ <span class=""i"">1</span>],<span class=""i"">12</span>,<span class=""hx"">0xe8c7b756</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L954""><a href=""#L954"">954</a></th><td class=""line-code""><pre>        R0(C,D,A,B,X[ <span class=""i"">2</span>],<span class=""i"">17</span>,<span class=""hx"">0x242070db</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L955""><a href=""#L955"">955</a></th><td class=""line-code""><pre>        R0(B,C,D,A,X[ <span class=""i"">3</span>],<span class=""i"">22</span>,<span class=""hx"">0xc1bdceee</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L956""><a href=""#L956"">956</a></th><td class=""line-code""><pre>        R0(A,B,C,D,X[ <span class=""i"">4</span>], <span class=""i"">7</span>,<span class=""hx"">0xf57c0faf</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L957""><a href=""#L957"">957</a></th><td class=""line-code""><pre>        R0(D,A,B,C,X[ <span class=""i"">5</span>],<span class=""i"">12</span>,<span class=""hx"">0x4787c62a</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L958""><a href=""#L958"">958</a></th><td class=""line-code""><pre>        R0(C,D,A,B,X[ <span class=""i"">6</span>],<span class=""i"">17</span>,<span class=""hx"">0xa8304613</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L959""><a href=""#L959"">959</a></th><td class=""line-code""><pre>        R0(B,C,D,A,X[ <span class=""i"">7</span>],<span class=""i"">22</span>,<span class=""hx"">0xfd469501</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L960""><a href=""#L960"">960</a></th><td class=""line-code""><pre>        R0(A,B,C,D,X[ <span class=""i"">8</span>], <span class=""i"">7</span>,<span class=""hx"">0x698098d8</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L961""><a href=""#L961"">961</a></th><td class=""line-code""><pre>        R0(D,A,B,C,X[ <span class=""i"">9</span>],<span class=""i"">12</span>,<span class=""hx"">0x8b44f7af</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L962""><a href=""#L962"">962</a></th><td class=""line-code""><pre>        R0(C,D,A,B,X[<span class=""i"">10</span>],<span class=""i"">17</span>,<span class=""hx"">0xffff5bb1</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L963""><a href=""#L963"">963</a></th><td class=""line-code""><pre>        R0(B,C,D,A,X[<span class=""i"">11</span>],<span class=""i"">22</span>,<span class=""hx"">0x895cd7be</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L964""><a href=""#L964"">964</a></th><td class=""line-code""><pre>        R0(A,B,C,D,X[<span class=""i"">12</span>], <span class=""i"">7</span>,<span class=""hx"">0x6b901122</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L965""><a href=""#L965"">965</a></th><td class=""line-code""><pre>        R0(D,A,B,C,X[<span class=""i"">13</span>],<span class=""i"">12</span>,<span class=""hx"">0xfd987193</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L966""><a href=""#L966"">966</a></th><td class=""line-code""><pre>        R0(C,D,A,B,X[<span class=""i"">14</span>],<span class=""i"">17</span>,<span class=""hx"">0xa679438e</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L967""><a href=""#L967"">967</a></th><td class=""line-code""><pre>        R0(B,C,D,A,X[<span class=""i"">15</span>],<span class=""i"">22</span>,<span class=""hx"">0x49b40821</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L968""><a href=""#L968"">968</a></th><td class=""line-code""><pre>        <span class=""c"">/* Round 1 */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L969""><a href=""#L969"">969</a></th><td class=""line-code""><pre>        R1(A,B,C,D,X[ <span class=""i"">1</span>], <span class=""i"">5</span>,<span class=""hx"">0xf61e2562</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L970""><a href=""#L970"">970</a></th><td class=""line-code""><pre>        R1(D,A,B,C,X[ <span class=""i"">6</span>], <span class=""i"">9</span>,<span class=""hx"">0xc040b340</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L971""><a href=""#L971"">971</a></th><td class=""line-code""><pre>        R1(C,D,A,B,X[<span class=""i"">11</span>],<span class=""i"">14</span>,<span class=""hx"">0x265e5a51</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L972""><a href=""#L972"">972</a></th><td class=""line-code""><pre>        R1(B,C,D,A,X[ <span class=""i"">0</span>],<span class=""i"">20</span>,<span class=""hx"">0xe9b6c7aa</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L973""><a href=""#L973"">973</a></th><td class=""line-code""><pre>        R1(A,B,C,D,X[ <span class=""i"">5</span>], <span class=""i"">5</span>,<span class=""hx"">0xd62f105d</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L974""><a href=""#L974"">974</a></th><td class=""line-code""><pre>        R1(D,A,B,C,X[<span class=""i"">10</span>], <span class=""i"">9</span>,<span class=""hx"">0x02441453</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L975""><a href=""#L975"">975</a></th><td class=""line-code""><pre>        R1(C,D,A,B,X[<span class=""i"">15</span>],<span class=""i"">14</span>,<span class=""hx"">0xd8a1e681</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L976""><a href=""#L976"">976</a></th><td class=""line-code""><pre>        R1(B,C,D,A,X[ <span class=""i"">4</span>],<span class=""i"">20</span>,<span class=""hx"">0xe7d3fbc8</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L977""><a href=""#L977"">977</a></th><td class=""line-code""><pre>        R1(A,B,C,D,X[ <span class=""i"">9</span>], <span class=""i"">5</span>,<span class=""hx"">0x21e1cde6</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L978""><a href=""#L978"">978</a></th><td class=""line-code""><pre>        R1(D,A,B,C,X[<span class=""i"">14</span>], <span class=""i"">9</span>,<span class=""hx"">0xc33707d6</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L979""><a href=""#L979"">979</a></th><td class=""line-code""><pre>        R1(C,D,A,B,X[ <span class=""i"">3</span>],<span class=""i"">14</span>,<span class=""hx"">0xf4d50d87</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L980""><a href=""#L980"">980</a></th><td class=""line-code""><pre>        R1(B,C,D,A,X[ <span class=""i"">8</span>],<span class=""i"">20</span>,<span class=""hx"">0x455a14ed</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L981""><a href=""#L981"">981</a></th><td class=""line-code""><pre>        R1(A,B,C,D,X[<span class=""i"">13</span>], <span class=""i"">5</span>,<span class=""hx"">0xa9e3e905</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L982""><a href=""#L982"">982</a></th><td class=""line-code""><pre>        R1(D,A,B,C,X[ <span class=""i"">2</span>], <span class=""i"">9</span>,<span class=""hx"">0xfcefa3f8</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L983""><a href=""#L983"">983</a></th><td class=""line-code""><pre>        R1(C,D,A,B,X[ <span class=""i"">7</span>],<span class=""i"">14</span>,<span class=""hx"">0x676f02d9</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L984""><a href=""#L984"">984</a></th><td class=""line-code""><pre>        R1(B,C,D,A,X[<span class=""i"">12</span>],<span class=""i"">20</span>,<span class=""hx"">0x8d2a4c8a</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L985""><a href=""#L985"">985</a></th><td class=""line-code""><pre>        <span class=""c"">/* Round 2 */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L986""><a href=""#L986"">986</a></th><td class=""line-code""><pre>        R2(A,B,C,D,X[ <span class=""i"">5</span>], <span class=""i"">4</span>,<span class=""hx"">0xfffa3942</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L987""><a href=""#L987"">987</a></th><td class=""line-code""><pre>        R2(D,A,B,C,X[ <span class=""i"">8</span>],<span class=""i"">11</span>,<span class=""hx"">0x8771f681</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L988""><a href=""#L988"">988</a></th><td class=""line-code""><pre>        R2(C,D,A,B,X[<span class=""i"">11</span>],<span class=""i"">16</span>,<span class=""hx"">0x6d9d6122</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L989""><a href=""#L989"">989</a></th><td class=""line-code""><pre>        R2(B,C,D,A,X[<span class=""i"">14</span>],<span class=""i"">23</span>,<span class=""hx"">0xfde5380c</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L990""><a href=""#L990"">990</a></th><td class=""line-code""><pre>        R2(A,B,C,D,X[ <span class=""i"">1</span>], <span class=""i"">4</span>,<span class=""hx"">0xa4beea44</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L991""><a href=""#L991"">991</a></th><td class=""line-code""><pre>        R2(D,A,B,C,X[ <span class=""i"">4</span>],<span class=""i"">11</span>,<span class=""hx"">0x4bdecfa9</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L992""><a href=""#L992"">992</a></th><td class=""line-code""><pre>        R2(C,D,A,B,X[ <span class=""i"">7</span>],<span class=""i"">16</span>,<span class=""hx"">0xf6bb4b60</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L993""><a href=""#L993"">993</a></th><td class=""line-code""><pre>        R2(B,C,D,A,X[<span class=""i"">10</span>],<span class=""i"">23</span>,<span class=""hx"">0xbebfbc70</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L994""><a href=""#L994"">994</a></th><td class=""line-code""><pre>        R2(A,B,C,D,X[<span class=""i"">13</span>], <span class=""i"">4</span>,<span class=""hx"">0x289b7ec6</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L995""><a href=""#L995"">995</a></th><td class=""line-code""><pre>        R2(D,A,B,C,X[ <span class=""i"">0</span>],<span class=""i"">11</span>,<span class=""hx"">0xeaa127fa</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L996""><a href=""#L996"">996</a></th><td class=""line-code""><pre>        R2(C,D,A,B,X[ <span class=""i"">3</span>],<span class=""i"">16</span>,<span class=""hx"">0xd4ef3085</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L997""><a href=""#L997"">997</a></th><td class=""line-code""><pre>        R2(B,C,D,A,X[ <span class=""i"">6</span>],<span class=""i"">23</span>,<span class=""hx"">0x04881d05</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L998""><a href=""#L998"">998</a></th><td class=""line-code""><pre>        R2(A,B,C,D,X[ <span class=""i"">9</span>], <span class=""i"">4</span>,<span class=""hx"">0xd9d4d039</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L999""><a href=""#L999"">999</a></th><td class=""line-code""><pre>        R2(D,A,B,C,X[<span class=""i"">12</span>],<span class=""i"">11</span>,<span class=""hx"">0xe6db99e5</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1000""><a href=""#L1000"">1000</a></th><td class=""line-code""><pre>        R2(C,D,A,B,X[<span class=""i"">15</span>],<span class=""i"">16</span>,<span class=""hx"">0x1fa27cf8</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1001""><a href=""#L1001"">1001</a></th><td class=""line-code""><pre>        R2(B,C,D,A,X[ <span class=""i"">2</span>],<span class=""i"">23</span>,<span class=""hx"">0xc4ac5665</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1002""><a href=""#L1002"">1002</a></th><td class=""line-code""><pre>        <span class=""c"">/* Round 3 */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1003""><a href=""#L1003"">1003</a></th><td class=""line-code""><pre>        R3(A,B,C,D,X[ <span class=""i"">0</span>], <span class=""i"">6</span>,<span class=""hx"">0xf4292244</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1004""><a href=""#L1004"">1004</a></th><td class=""line-code""><pre>        R3(D,A,B,C,X[ <span class=""i"">7</span>],<span class=""i"">10</span>,<span class=""hx"">0x432aff97</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1005""><a href=""#L1005"">1005</a></th><td class=""line-code""><pre>        R3(C,D,A,B,X[<span class=""i"">14</span>],<span class=""i"">15</span>,<span class=""hx"">0xab9423a7</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1006""><a href=""#L1006"">1006</a></th><td class=""line-code""><pre>        R3(B,C,D,A,X[ <span class=""i"">5</span>],<span class=""i"">21</span>,<span class=""hx"">0xfc93a039</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1007""><a href=""#L1007"">1007</a></th><td class=""line-code""><pre>        R3(A,B,C,D,X[<span class=""i"">12</span>], <span class=""i"">6</span>,<span class=""hx"">0x655b59c3</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1008""><a href=""#L1008"">1008</a></th><td class=""line-code""><pre>        R3(D,A,B,C,X[ <span class=""i"">3</span>],<span class=""i"">10</span>,<span class=""hx"">0x8f0ccc92</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1009""><a href=""#L1009"">1009</a></th><td class=""line-code""><pre>        R3(C,D,A,B,X[<span class=""i"">10</span>],<span class=""i"">15</span>,<span class=""hx"">0xffeff47d</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1010""><a href=""#L1010"">1010</a></th><td class=""line-code""><pre>        R3(B,C,D,A,X[ <span class=""i"">1</span>],<span class=""i"">21</span>,<span class=""hx"">0x85845dd1</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1011""><a href=""#L1011"">1011</a></th><td class=""line-code""><pre>        R3(A,B,C,D,X[ <span class=""i"">8</span>], <span class=""i"">6</span>,<span class=""hx"">0x6fa87e4f</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1012""><a href=""#L1012"">1012</a></th><td class=""line-code""><pre>        R3(D,A,B,C,X[<span class=""i"">15</span>],<span class=""i"">10</span>,<span class=""hx"">0xfe2ce6e0</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1013""><a href=""#L1013"">1013</a></th><td class=""line-code""><pre>        R3(C,D,A,B,X[ <span class=""i"">6</span>],<span class=""i"">15</span>,<span class=""hx"">0xa3014314</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1014""><a href=""#L1014"">1014</a></th><td class=""line-code""><pre>        R3(B,C,D,A,X[<span class=""i"">13</span>],<span class=""i"">21</span>,<span class=""hx"">0x4e0811a1</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1015""><a href=""#L1015"">1015</a></th><td class=""line-code""><pre>        R3(A,B,C,D,X[ <span class=""i"">4</span>], <span class=""i"">6</span>,<span class=""hx"">0xf7537e82</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1016""><a href=""#L1016"">1016</a></th><td class=""line-code""><pre>        R3(D,A,B,C,X[<span class=""i"">11</span>],<span class=""i"">10</span>,<span class=""hx"">0xbd3af235</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1017""><a href=""#L1017"">1017</a></th><td class=""line-code""><pre>        R3(C,D,A,B,X[ <span class=""i"">2</span>],<span class=""i"">15</span>,<span class=""hx"">0x2ad7d2bb</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1018""><a href=""#L1018"">1018</a></th><td class=""line-code""><pre>        R3(B,C,D,A,X[ <span class=""i"">9</span>],<span class=""i"">21</span>,<span class=""hx"">0xeb86d391</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1019""><a href=""#L1019"">1019</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1020""><a href=""#L1020"">1020</a></th><td class=""line-code""><pre>        A = c-&gt;A += A;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1021""><a href=""#L1021"">1021</a></th><td class=""line-code""><pre>        B = c-&gt;B += B;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1022""><a href=""#L1022"">1022</a></th><td class=""line-code""><pre>        C = c-&gt;C += C;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1023""><a href=""#L1023"">1023</a></th><td class=""line-code""><pre>        D = c-&gt;D += D;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1024""><a href=""#L1024"">1024</a></th><td class=""line-code""><pre>                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1025""><a href=""#L1025"">1025</a></th><td class=""line-code""><pre>        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1026""><a href=""#L1026"">1026</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1027""><a href=""#L1027"">1027</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1028""><a href=""#L1028"">1028</a></th><td class=""line-code""><pre><span class=""pp"">#ifndef</span> md5_block_data_order
</pre></td></tr>


<tr><th class=""line-num"" id=""L1029""><a href=""#L1029"">1029</a></th><td class=""line-code""><pre><span class=""pp"">#ifdef</span> X
</pre></td></tr>


<tr><th class=""line-num"" id=""L1030""><a href=""#L1030"">1030</a></th><td class=""line-code""><pre><span class=""pp"">#undef</span> X
</pre></td></tr>


<tr><th class=""line-num"" id=""L1031""><a href=""#L1031"">1031</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1032""><a href=""#L1032"">1032</a></th><td class=""line-code""><pre><span class=""di"">void</span> md5_block_data_order (MD5_CTX *c, <span class=""di"">const</span> <span class=""di"">void</span> *data_, <span class=""pt"">int</span> num)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1033""><a href=""#L1033"">1033</a></th><td class=""line-code""><pre>        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1034""><a href=""#L1034"">1034</a></th><td class=""line-code""><pre>        <span class=""di"">const</span> <span class=""pt"">unsigned</span> <span class=""pt"">char</span> *data=data_;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1035""><a href=""#L1035"">1035</a></th><td class=""line-code""><pre>        <span class=""di"">register</span> <span class=""pt"">unsigned</span> MD32_REG_T A,B,C,D,l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1036""><a href=""#L1036"">1036</a></th><td class=""line-code""><pre><span class=""pp"">#ifndef</span> MD32_XARRAY
</pre></td></tr>


<tr><th class=""line-num"" id=""L1037""><a href=""#L1037"">1037</a></th><td class=""line-code""><pre>        <span class=""c"">/* See comment in crypto/sha/sha_locl.h for details. */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1038""><a href=""#L1038"">1038</a></th><td class=""line-code""><pre>        <span class=""pt"">unsigned</span> MD32_REG_T        XX0, XX1, XX2, XX3, XX4, XX5, XX6, XX7,
</pre></td></tr>


<tr><th class=""line-num"" id=""L1039""><a href=""#L1039"">1039</a></th><td class=""line-code""><pre>                                XX8, XX9,XX10,XX11,XX12,XX13,XX14,XX15;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1040""><a href=""#L1040"">1040</a></th><td class=""line-code""><pre><span class=""pp""># define</span> X(i)        XX<span class=""pp"">#</span><span class=""pp"">#i</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1041""><a href=""#L1041"">1041</a></th><td class=""line-code""><pre><span class=""pp"">#else</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1042""><a href=""#L1042"">1042</a></th><td class=""line-code""><pre>        mDNSu32 XX[MD5_LBLOCK];
</pre></td></tr>


<tr><th class=""line-num"" id=""L1043""><a href=""#L1043"">1043</a></th><td class=""line-code""><pre><span class=""pp""># define</span> X(i)        XX[i]
</pre></td></tr>


<tr><th class=""line-num"" id=""L1044""><a href=""#L1044"">1044</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1045""><a href=""#L1045"">1045</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1046""><a href=""#L1046"">1046</a></th><td class=""line-code""><pre>        A=c-&gt;A;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1047""><a href=""#L1047"">1047</a></th><td class=""line-code""><pre>        B=c-&gt;B;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1048""><a href=""#L1048"">1048</a></th><td class=""line-code""><pre>        C=c-&gt;C;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1049""><a href=""#L1049"">1049</a></th><td class=""line-code""><pre>        D=c-&gt;D;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1050""><a href=""#L1050"">1050</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1051""><a href=""#L1051"">1051</a></th><td class=""line-code""><pre>        <span class=""r"">for</span> (;num--;)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1052""><a href=""#L1052"">1052</a></th><td class=""line-code""><pre>                {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1053""><a href=""#L1053"">1053</a></th><td class=""line-code""><pre>        HOST_c2l(data,l); X( <span class=""i"">0</span>)=l;                HOST_c2l(data,l); X( <span class=""i"">1</span>)=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1054""><a href=""#L1054"">1054</a></th><td class=""line-code""><pre>        <span class=""c"">/* Round 0 */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1055""><a href=""#L1055"">1055</a></th><td class=""line-code""><pre>        R0(A,B,C,D,X( <span class=""i"">0</span>), <span class=""i"">7</span>,<span class=""hx"">0xd76aa478</span>L);        HOST_c2l(data,l); X( <span class=""i"">2</span>)=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1056""><a href=""#L1056"">1056</a></th><td class=""line-code""><pre>        R0(D,A,B,C,X( <span class=""i"">1</span>),<span class=""i"">12</span>,<span class=""hx"">0xe8c7b756</span>L);        HOST_c2l(data,l); X( <span class=""i"">3</span>)=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1057""><a href=""#L1057"">1057</a></th><td class=""line-code""><pre>        R0(C,D,A,B,X( <span class=""i"">2</span>),<span class=""i"">17</span>,<span class=""hx"">0x242070db</span>L);        HOST_c2l(data,l); X( <span class=""i"">4</span>)=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1058""><a href=""#L1058"">1058</a></th><td class=""line-code""><pre>        R0(B,C,D,A,X( <span class=""i"">3</span>),<span class=""i"">22</span>,<span class=""hx"">0xc1bdceee</span>L);        HOST_c2l(data,l); X( <span class=""i"">5</span>)=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1059""><a href=""#L1059"">1059</a></th><td class=""line-code""><pre>        R0(A,B,C,D,X( <span class=""i"">4</span>), <span class=""i"">7</span>,<span class=""hx"">0xf57c0faf</span>L);        HOST_c2l(data,l); X( <span class=""i"">6</span>)=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1060""><a href=""#L1060"">1060</a></th><td class=""line-code""><pre>        R0(D,A,B,C,X( <span class=""i"">5</span>),<span class=""i"">12</span>,<span class=""hx"">0x4787c62a</span>L);        HOST_c2l(data,l); X( <span class=""i"">7</span>)=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1061""><a href=""#L1061"">1061</a></th><td class=""line-code""><pre>        R0(C,D,A,B,X( <span class=""i"">6</span>),<span class=""i"">17</span>,<span class=""hx"">0xa8304613</span>L);        HOST_c2l(data,l); X( <span class=""i"">8</span>)=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1062""><a href=""#L1062"">1062</a></th><td class=""line-code""><pre>        R0(B,C,D,A,X( <span class=""i"">7</span>),<span class=""i"">22</span>,<span class=""hx"">0xfd469501</span>L);        HOST_c2l(data,l); X( <span class=""i"">9</span>)=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1063""><a href=""#L1063"">1063</a></th><td class=""line-code""><pre>        R0(A,B,C,D,X( <span class=""i"">8</span>), <span class=""i"">7</span>,<span class=""hx"">0x698098d8</span>L);        HOST_c2l(data,l); X(<span class=""i"">10</span>)=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1064""><a href=""#L1064"">1064</a></th><td class=""line-code""><pre>        R0(D,A,B,C,X( <span class=""i"">9</span>),<span class=""i"">12</span>,<span class=""hx"">0x8b44f7af</span>L);        HOST_c2l(data,l); X(<span class=""i"">11</span>)=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1065""><a href=""#L1065"">1065</a></th><td class=""line-code""><pre>        R0(C,D,A,B,X(<span class=""i"">10</span>),<span class=""i"">17</span>,<span class=""hx"">0xffff5bb1</span>L);        HOST_c2l(data,l); X(<span class=""i"">12</span>)=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1066""><a href=""#L1066"">1066</a></th><td class=""line-code""><pre>        R0(B,C,D,A,X(<span class=""i"">11</span>),<span class=""i"">22</span>,<span class=""hx"">0x895cd7be</span>L);        HOST_c2l(data,l); X(<span class=""i"">13</span>)=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1067""><a href=""#L1067"">1067</a></th><td class=""line-code""><pre>        R0(A,B,C,D,X(<span class=""i"">12</span>), <span class=""i"">7</span>,<span class=""hx"">0x6b901122</span>L);        HOST_c2l(data,l); X(<span class=""i"">14</span>)=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1068""><a href=""#L1068"">1068</a></th><td class=""line-code""><pre>        R0(D,A,B,C,X(<span class=""i"">13</span>),<span class=""i"">12</span>,<span class=""hx"">0xfd987193</span>L);        HOST_c2l(data,l); X(<span class=""i"">15</span>)=l;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1069""><a href=""#L1069"">1069</a></th><td class=""line-code""><pre>        R0(C,D,A,B,X(<span class=""i"">14</span>),<span class=""i"">17</span>,<span class=""hx"">0xa679438e</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1070""><a href=""#L1070"">1070</a></th><td class=""line-code""><pre>        R0(B,C,D,A,X(<span class=""i"">15</span>),<span class=""i"">22</span>,<span class=""hx"">0x49b40821</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1071""><a href=""#L1071"">1071</a></th><td class=""line-code""><pre>        <span class=""c"">/* Round 1 */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1072""><a href=""#L1072"">1072</a></th><td class=""line-code""><pre>        R1(A,B,C,D,X( <span class=""i"">1</span>), <span class=""i"">5</span>,<span class=""hx"">0xf61e2562</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1073""><a href=""#L1073"">1073</a></th><td class=""line-code""><pre>        R1(D,A,B,C,X( <span class=""i"">6</span>), <span class=""i"">9</span>,<span class=""hx"">0xc040b340</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1074""><a href=""#L1074"">1074</a></th><td class=""line-code""><pre>        R1(C,D,A,B,X(<span class=""i"">11</span>),<span class=""i"">14</span>,<span class=""hx"">0x265e5a51</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1075""><a href=""#L1075"">1075</a></th><td class=""line-code""><pre>        R1(B,C,D,A,X( <span class=""i"">0</span>),<span class=""i"">20</span>,<span class=""hx"">0xe9b6c7aa</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1076""><a href=""#L1076"">1076</a></th><td class=""line-code""><pre>        R1(A,B,C,D,X( <span class=""i"">5</span>), <span class=""i"">5</span>,<span class=""hx"">0xd62f105d</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1077""><a href=""#L1077"">1077</a></th><td class=""line-code""><pre>        R1(D,A,B,C,X(<span class=""i"">10</span>), <span class=""i"">9</span>,<span class=""hx"">0x02441453</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1078""><a href=""#L1078"">1078</a></th><td class=""line-code""><pre>        R1(C,D,A,B,X(<span class=""i"">15</span>),<span class=""i"">14</span>,<span class=""hx"">0xd8a1e681</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1079""><a href=""#L1079"">1079</a></th><td class=""line-code""><pre>        R1(B,C,D,A,X( <span class=""i"">4</span>),<span class=""i"">20</span>,<span class=""hx"">0xe7d3fbc8</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1080""><a href=""#L1080"">1080</a></th><td class=""line-code""><pre>        R1(A,B,C,D,X( <span class=""i"">9</span>), <span class=""i"">5</span>,<span class=""hx"">0x21e1cde6</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1081""><a href=""#L1081"">1081</a></th><td class=""line-code""><pre>        R1(D,A,B,C,X(<span class=""i"">14</span>), <span class=""i"">9</span>,<span class=""hx"">0xc33707d6</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1082""><a href=""#L1082"">1082</a></th><td class=""line-code""><pre>        R1(C,D,A,B,X( <span class=""i"">3</span>),<span class=""i"">14</span>,<span class=""hx"">0xf4d50d87</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1083""><a href=""#L1083"">1083</a></th><td class=""line-code""><pre>        R1(B,C,D,A,X( <span class=""i"">8</span>),<span class=""i"">20</span>,<span class=""hx"">0x455a14ed</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1084""><a href=""#L1084"">1084</a></th><td class=""line-code""><pre>        R1(A,B,C,D,X(<span class=""i"">13</span>), <span class=""i"">5</span>,<span class=""hx"">0xa9e3e905</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1085""><a href=""#L1085"">1085</a></th><td class=""line-code""><pre>        R1(D,A,B,C,X( <span class=""i"">2</span>), <span class=""i"">9</span>,<span class=""hx"">0xfcefa3f8</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1086""><a href=""#L1086"">1086</a></th><td class=""line-code""><pre>        R1(C,D,A,B,X( <span class=""i"">7</span>),<span class=""i"">14</span>,<span class=""hx"">0x676f02d9</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1087""><a href=""#L1087"">1087</a></th><td class=""line-code""><pre>        R1(B,C,D,A,X(<span class=""i"">12</span>),<span class=""i"">20</span>,<span class=""hx"">0x8d2a4c8a</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1088""><a href=""#L1088"">1088</a></th><td class=""line-code""><pre>        <span class=""c"">/* Round 2 */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1089""><a href=""#L1089"">1089</a></th><td class=""line-code""><pre>        R2(A,B,C,D,X( <span class=""i"">5</span>), <span class=""i"">4</span>,<span class=""hx"">0xfffa3942</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1090""><a href=""#L1090"">1090</a></th><td class=""line-code""><pre>        R2(D,A,B,C,X( <span class=""i"">8</span>),<span class=""i"">11</span>,<span class=""hx"">0x8771f681</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1091""><a href=""#L1091"">1091</a></th><td class=""line-code""><pre>        R2(C,D,A,B,X(<span class=""i"">11</span>),<span class=""i"">16</span>,<span class=""hx"">0x6d9d6122</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1092""><a href=""#L1092"">1092</a></th><td class=""line-code""><pre>        R2(B,C,D,A,X(<span class=""i"">14</span>),<span class=""i"">23</span>,<span class=""hx"">0xfde5380c</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1093""><a href=""#L1093"">1093</a></th><td class=""line-code""><pre>        R2(A,B,C,D,X( <span class=""i"">1</span>), <span class=""i"">4</span>,<span class=""hx"">0xa4beea44</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1094""><a href=""#L1094"">1094</a></th><td class=""line-code""><pre>        R2(D,A,B,C,X( <span class=""i"">4</span>),<span class=""i"">11</span>,<span class=""hx"">0x4bdecfa9</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1095""><a href=""#L1095"">1095</a></th><td class=""line-code""><pre>        R2(C,D,A,B,X( <span class=""i"">7</span>),<span class=""i"">16</span>,<span class=""hx"">0xf6bb4b60</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1096""><a href=""#L1096"">1096</a></th><td class=""line-code""><pre>        R2(B,C,D,A,X(<span class=""i"">10</span>),<span class=""i"">23</span>,<span class=""hx"">0xbebfbc70</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1097""><a href=""#L1097"">1097</a></th><td class=""line-code""><pre>        R2(A,B,C,D,X(<span class=""i"">13</span>), <span class=""i"">4</span>,<span class=""hx"">0x289b7ec6</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1098""><a href=""#L1098"">1098</a></th><td class=""line-code""><pre>        R2(D,A,B,C,X( <span class=""i"">0</span>),<span class=""i"">11</span>,<span class=""hx"">0xeaa127fa</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1099""><a href=""#L1099"">1099</a></th><td class=""line-code""><pre>        R2(C,D,A,B,X( <span class=""i"">3</span>),<span class=""i"">16</span>,<span class=""hx"">0xd4ef3085</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1100""><a href=""#L1100"">1100</a></th><td class=""line-code""><pre>        R2(B,C,D,A,X( <span class=""i"">6</span>),<span class=""i"">23</span>,<span class=""hx"">0x04881d05</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1101""><a href=""#L1101"">1101</a></th><td class=""line-code""><pre>        R2(A,B,C,D,X( <span class=""i"">9</span>), <span class=""i"">4</span>,<span class=""hx"">0xd9d4d039</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1102""><a href=""#L1102"">1102</a></th><td class=""line-code""><pre>        R2(D,A,B,C,X(<span class=""i"">12</span>),<span class=""i"">11</span>,<span class=""hx"">0xe6db99e5</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1103""><a href=""#L1103"">1103</a></th><td class=""line-code""><pre>        R2(C,D,A,B,X(<span class=""i"">15</span>),<span class=""i"">16</span>,<span class=""hx"">0x1fa27cf8</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1104""><a href=""#L1104"">1104</a></th><td class=""line-code""><pre>        R2(B,C,D,A,X( <span class=""i"">2</span>),<span class=""i"">23</span>,<span class=""hx"">0xc4ac5665</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1105""><a href=""#L1105"">1105</a></th><td class=""line-code""><pre>        <span class=""c"">/* Round 3 */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1106""><a href=""#L1106"">1106</a></th><td class=""line-code""><pre>        R3(A,B,C,D,X( <span class=""i"">0</span>), <span class=""i"">6</span>,<span class=""hx"">0xf4292244</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1107""><a href=""#L1107"">1107</a></th><td class=""line-code""><pre>        R3(D,A,B,C,X( <span class=""i"">7</span>),<span class=""i"">10</span>,<span class=""hx"">0x432aff97</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1108""><a href=""#L1108"">1108</a></th><td class=""line-code""><pre>        R3(C,D,A,B,X(<span class=""i"">14</span>),<span class=""i"">15</span>,<span class=""hx"">0xab9423a7</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1109""><a href=""#L1109"">1109</a></th><td class=""line-code""><pre>        R3(B,C,D,A,X( <span class=""i"">5</span>),<span class=""i"">21</span>,<span class=""hx"">0xfc93a039</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1110""><a href=""#L1110"">1110</a></th><td class=""line-code""><pre>        R3(A,B,C,D,X(<span class=""i"">12</span>), <span class=""i"">6</span>,<span class=""hx"">0x655b59c3</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1111""><a href=""#L1111"">1111</a></th><td class=""line-code""><pre>        R3(D,A,B,C,X( <span class=""i"">3</span>),<span class=""i"">10</span>,<span class=""hx"">0x8f0ccc92</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1112""><a href=""#L1112"">1112</a></th><td class=""line-code""><pre>        R3(C,D,A,B,X(<span class=""i"">10</span>),<span class=""i"">15</span>,<span class=""hx"">0xffeff47d</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1113""><a href=""#L1113"">1113</a></th><td class=""line-code""><pre>        R3(B,C,D,A,X( <span class=""i"">1</span>),<span class=""i"">21</span>,<span class=""hx"">0x85845dd1</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1114""><a href=""#L1114"">1114</a></th><td class=""line-code""><pre>        R3(A,B,C,D,X( <span class=""i"">8</span>), <span class=""i"">6</span>,<span class=""hx"">0x6fa87e4f</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1115""><a href=""#L1115"">1115</a></th><td class=""line-code""><pre>        R3(D,A,B,C,X(<span class=""i"">15</span>),<span class=""i"">10</span>,<span class=""hx"">0xfe2ce6e0</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1116""><a href=""#L1116"">1116</a></th><td class=""line-code""><pre>        R3(C,D,A,B,X( <span class=""i"">6</span>),<span class=""i"">15</span>,<span class=""hx"">0xa3014314</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1117""><a href=""#L1117"">1117</a></th><td class=""line-code""><pre>        R3(B,C,D,A,X(<span class=""i"">13</span>),<span class=""i"">21</span>,<span class=""hx"">0x4e0811a1</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1118""><a href=""#L1118"">1118</a></th><td class=""line-code""><pre>        R3(A,B,C,D,X( <span class=""i"">4</span>), <span class=""i"">6</span>,<span class=""hx"">0xf7537e82</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1119""><a href=""#L1119"">1119</a></th><td class=""line-code""><pre>        R3(D,A,B,C,X(<span class=""i"">11</span>),<span class=""i"">10</span>,<span class=""hx"">0xbd3af235</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1120""><a href=""#L1120"">1120</a></th><td class=""line-code""><pre>        R3(C,D,A,B,X( <span class=""i"">2</span>),<span class=""i"">15</span>,<span class=""hx"">0x2ad7d2bb</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1121""><a href=""#L1121"">1121</a></th><td class=""line-code""><pre>        R3(B,C,D,A,X( <span class=""i"">9</span>),<span class=""i"">21</span>,<span class=""hx"">0xeb86d391</span>L);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1122""><a href=""#L1122"">1122</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1123""><a href=""#L1123"">1123</a></th><td class=""line-code""><pre>        A = c-&gt;A += A;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1124""><a href=""#L1124"">1124</a></th><td class=""line-code""><pre>        B = c-&gt;B += B;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1125""><a href=""#L1125"">1125</a></th><td class=""line-code""><pre>        C = c-&gt;C += C;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1126""><a href=""#L1126"">1126</a></th><td class=""line-code""><pre>        D = c-&gt;D += D;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1127""><a href=""#L1127"">1127</a></th><td class=""line-code""><pre>                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1128""><a href=""#L1128"">1128</a></th><td class=""line-code""><pre>        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1129""><a href=""#L1129"">1129</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1130""><a href=""#L1130"">1130</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1131""><a href=""#L1131"">1131</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1132""><a href=""#L1132"">1132</a></th><td class=""line-code""><pre> <span class=""c"">// ***************************************************************************</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1133""><a href=""#L1133"">1133</a></th><td class=""line-code""><pre><span class=""pp"">#if</span> COMPILER_LIKES_PRAGMA_MARK
</pre></td></tr>


<tr><th class=""line-num"" id=""L1134""><a href=""#L1134"">1134</a></th><td class=""line-code""><pre><span class=""pp"">#pragma</span> mark - base64 -&gt; binary conversion
</pre></td></tr>


<tr><th class=""line-num"" id=""L1135""><a href=""#L1135"">1135</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1136""><a href=""#L1136"">1136</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1137""><a href=""#L1137"">1137</a></th><td class=""line-code""><pre><span class=""di"">static</span> <span class=""di"">const</span> <span class=""pt"">char</span> Base64[] = <span class=""s""><span class=""dl"">&quot;</span><span class=""k"">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/</span><span class=""dl"">&quot;</span></span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1138""><a href=""#L1138"">1138</a></th><td class=""line-code""><pre><span class=""di"">static</span> <span class=""di"">const</span> <span class=""pt"">char</span> Pad64 = <span class=""ch"">'='</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1139""><a href=""#L1139"">1139</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1140""><a href=""#L1140"">1140</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1141""><a href=""#L1141"">1141</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> mDNSisspace(x) (x == <span class=""ch"">'\t'</span> || x == <span class=""ch"">'\n'</span> || x == <span class=""ch"">'\v'</span> || x == <span class=""ch"">'\f'</span> || x == <span class=""ch"">'\r'</span> || x == <span class=""ch"">' '</span>)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1142""><a href=""#L1142"">1142</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1143""><a href=""#L1143"">1143</a></th><td class=""line-code""><pre>mDNSlocal <span class=""di"">const</span> <span class=""pt"">char</span> *mDNSstrchr(<span class=""di"">const</span> <span class=""pt"">char</span> *s, <span class=""pt"">int</span> c)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1144""><a href=""#L1144"">1144</a></th><td class=""line-code""><pre>        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1145""><a href=""#L1145"">1145</a></th><td class=""line-code""><pre>        <span class=""r"">while</span> (<span class=""i"">1</span>)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1146""><a href=""#L1146"">1146</a></th><td class=""line-code""><pre>                {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1147""><a href=""#L1147"">1147</a></th><td class=""line-code""><pre>                <span class=""r"">if</span> (c == *s) <span class=""r"">return</span> s;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1148""><a href=""#L1148"">1148</a></th><td class=""line-code""><pre>                <span class=""r"">if</span> (!*s) <span class=""r"">return</span> mDNSNULL;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1149""><a href=""#L1149"">1149</a></th><td class=""line-code""><pre>                s++;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1150""><a href=""#L1150"">1150</a></th><td class=""line-code""><pre>                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1151""><a href=""#L1151"">1151</a></th><td class=""line-code""><pre>        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1152""><a href=""#L1152"">1152</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1153""><a href=""#L1153"">1153</a></th><td class=""line-code""><pre><span class=""c"">// skips all whitespace anywhere.</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1154""><a href=""#L1154"">1154</a></th><td class=""line-code""><pre><span class=""c"">// converts characters, four at a time, starting at (or after)</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1155""><a href=""#L1155"">1155</a></th><td class=""line-code""><pre><span class=""c"">// src from base - 64 numbers into three 8 bit bytes in the target area.</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1156""><a href=""#L1156"">1156</a></th><td class=""line-code""><pre><span class=""c"">// it returns the number of data bytes stored at the target, or -1 on error.</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1157""><a href=""#L1157"">1157</a></th><td class=""line-code""><pre><span class=""c"">// adapted from BIND sources</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1158""><a href=""#L1158"">1158</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1159""><a href=""#L1159"">1159</a></th><td class=""line-code""><pre>mDNSlocal mDNSs32 DNSDigest_Base64ToBin(<span class=""di"">const</span> <span class=""pt"">char</span> *src, mDNSu8 *target, mDNSu32 targsize)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1160""><a href=""#L1160"">1160</a></th><td class=""line-code""><pre>        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1161""><a href=""#L1161"">1161</a></th><td class=""line-code""><pre>        <span class=""pt"">int</span> tarindex, state, ch;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1162""><a href=""#L1162"">1162</a></th><td class=""line-code""><pre>        <span class=""di"">const</span> <span class=""pt"">char</span> *pos;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1163""><a href=""#L1163"">1163</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1164""><a href=""#L1164"">1164</a></th><td class=""line-code""><pre>        state = <span class=""i"">0</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1165""><a href=""#L1165"">1165</a></th><td class=""line-code""><pre>        tarindex = <span class=""i"">0</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1166""><a href=""#L1166"">1166</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1167""><a href=""#L1167"">1167</a></th><td class=""line-code""><pre>        <span class=""r"">while</span> ((ch = *src++) != <span class=""ch"">'\0'</span>) {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1168""><a href=""#L1168"">1168</a></th><td class=""line-code""><pre>                <span class=""r"">if</span> (mDNSisspace(ch))        <span class=""c"">/* Skip whitespace anywhere. */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1169""><a href=""#L1169"">1169</a></th><td class=""line-code""><pre>                        <span class=""r"">continue</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1170""><a href=""#L1170"">1170</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1171""><a href=""#L1171"">1171</a></th><td class=""line-code""><pre>                <span class=""r"">if</span> (ch == Pad64)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1172""><a href=""#L1172"">1172</a></th><td class=""line-code""><pre>                        <span class=""r"">break</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1173""><a href=""#L1173"">1173</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1174""><a href=""#L1174"">1174</a></th><td class=""line-code""><pre>                pos = mDNSstrchr(Base64, ch);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1175""><a href=""#L1175"">1175</a></th><td class=""line-code""><pre>                <span class=""r"">if</span> (pos == <span class=""i"">0</span>)                 <span class=""c"">/* A non-base64 character. */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1176""><a href=""#L1176"">1176</a></th><td class=""line-code""><pre>                        <span class=""r"">return</span> (-<span class=""i"">1</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1177""><a href=""#L1177"">1177</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1178""><a href=""#L1178"">1178</a></th><td class=""line-code""><pre>                <span class=""r"">switch</span> (state) {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1179""><a href=""#L1179"">1179</a></th><td class=""line-code""><pre>                <span class=""r"">case</span> <span class=""i"">0</span>:
</pre></td></tr>


<tr><th class=""line-num"" id=""L1180""><a href=""#L1180"">1180</a></th><td class=""line-code""><pre>                        <span class=""r"">if</span> (target) {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1181""><a href=""#L1181"">1181</a></th><td class=""line-code""><pre>                                <span class=""r"">if</span> ((mDNSu32)tarindex &gt;= targsize)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1182""><a href=""#L1182"">1182</a></th><td class=""line-code""><pre>                                        <span class=""r"">return</span> (-<span class=""i"">1</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1183""><a href=""#L1183"">1183</a></th><td class=""line-code""><pre>                                target[tarindex] = (mDNSu8)((pos - Base64) &lt;&lt; <span class=""i"">2</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1184""><a href=""#L1184"">1184</a></th><td class=""line-code""><pre>                        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1185""><a href=""#L1185"">1185</a></th><td class=""line-code""><pre>                        state = <span class=""i"">1</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1186""><a href=""#L1186"">1186</a></th><td class=""line-code""><pre>                        <span class=""r"">break</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1187""><a href=""#L1187"">1187</a></th><td class=""line-code""><pre>                <span class=""r"">case</span> <span class=""i"">1</span>:
</pre></td></tr>


<tr><th class=""line-num"" id=""L1188""><a href=""#L1188"">1188</a></th><td class=""line-code""><pre>                        <span class=""r"">if</span> (target) {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1189""><a href=""#L1189"">1189</a></th><td class=""line-code""><pre>                                <span class=""r"">if</span> ((mDNSu32)tarindex + <span class=""i"">1</span> &gt;= targsize)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1190""><a href=""#L1190"">1190</a></th><td class=""line-code""><pre>                                        <span class=""r"">return</span> (-<span class=""i"">1</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1191""><a href=""#L1191"">1191</a></th><td class=""line-code""><pre>                                target[tarindex]   |=  (pos - Base64) &gt;&gt; <span class=""i"">4</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1192""><a href=""#L1192"">1192</a></th><td class=""line-code""><pre>                                target[tarindex+<span class=""i"">1</span>]  = (mDNSu8)(((pos - Base64) &amp; <span class=""hx"">0x0f</span>) &lt;&lt; <span class=""i"">4</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1193""><a href=""#L1193"">1193</a></th><td class=""line-code""><pre>                        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1194""><a href=""#L1194"">1194</a></th><td class=""line-code""><pre>                        tarindex++;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1195""><a href=""#L1195"">1195</a></th><td class=""line-code""><pre>                        state = <span class=""i"">2</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1196""><a href=""#L1196"">1196</a></th><td class=""line-code""><pre>                        <span class=""r"">break</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1197""><a href=""#L1197"">1197</a></th><td class=""line-code""><pre>                <span class=""r"">case</span> <span class=""i"">2</span>:
</pre></td></tr>


<tr><th class=""line-num"" id=""L1198""><a href=""#L1198"">1198</a></th><td class=""line-code""><pre>                        <span class=""r"">if</span> (target) {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1199""><a href=""#L1199"">1199</a></th><td class=""line-code""><pre>                                <span class=""r"">if</span> ((mDNSu32)tarindex + <span class=""i"">1</span> &gt;= targsize)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1200""><a href=""#L1200"">1200</a></th><td class=""line-code""><pre>                                        <span class=""r"">return</span> (-<span class=""i"">1</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1201""><a href=""#L1201"">1201</a></th><td class=""line-code""><pre>                                target[tarindex]   |=  (pos - Base64) &gt;&gt; <span class=""i"">2</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1202""><a href=""#L1202"">1202</a></th><td class=""line-code""><pre>                                target[tarindex+<span class=""i"">1</span>]  = (mDNSu8)(((pos - Base64) &amp; <span class=""hx"">0x03</span>) &lt;&lt; <span class=""i"">6</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1203""><a href=""#L1203"">1203</a></th><td class=""line-code""><pre>                        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1204""><a href=""#L1204"">1204</a></th><td class=""line-code""><pre>                        tarindex++;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1205""><a href=""#L1205"">1205</a></th><td class=""line-code""><pre>                        state = <span class=""i"">3</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1206""><a href=""#L1206"">1206</a></th><td class=""line-code""><pre>                        <span class=""r"">break</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1207""><a href=""#L1207"">1207</a></th><td class=""line-code""><pre>                <span class=""r"">case</span> <span class=""i"">3</span>:
</pre></td></tr>


<tr><th class=""line-num"" id=""L1208""><a href=""#L1208"">1208</a></th><td class=""line-code""><pre>                        <span class=""r"">if</span> (target) {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1209""><a href=""#L1209"">1209</a></th><td class=""line-code""><pre>                                <span class=""r"">if</span> ((mDNSu32)tarindex &gt;= targsize)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1210""><a href=""#L1210"">1210</a></th><td class=""line-code""><pre>                                        <span class=""r"">return</span> (-<span class=""i"">1</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1211""><a href=""#L1211"">1211</a></th><td class=""line-code""><pre>                                target[tarindex] |= (pos - Base64);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1212""><a href=""#L1212"">1212</a></th><td class=""line-code""><pre>                        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1213""><a href=""#L1213"">1213</a></th><td class=""line-code""><pre>                        tarindex++;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1214""><a href=""#L1214"">1214</a></th><td class=""line-code""><pre>                        state = <span class=""i"">0</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1215""><a href=""#L1215"">1215</a></th><td class=""line-code""><pre>                        <span class=""r"">break</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1216""><a href=""#L1216"">1216</a></th><td class=""line-code""><pre>                <span class=""r"">default</span>:
</pre></td></tr>


<tr><th class=""line-num"" id=""L1217""><a href=""#L1217"">1217</a></th><td class=""line-code""><pre>                        <span class=""r"">return</span> -<span class=""i"">1</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1218""><a href=""#L1218"">1218</a></th><td class=""line-code""><pre>                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1219""><a href=""#L1219"">1219</a></th><td class=""line-code""><pre>        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1220""><a href=""#L1220"">1220</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1221""><a href=""#L1221"">1221</a></th><td class=""line-code""><pre>        <span class=""c"">/*
</pre></td></tr>


<tr><th class=""line-num"" id=""L1222""><a href=""#L1222"">1222</a></th><td class=""line-code""><pre>         * We are done decoding Base-64 chars.  Let's see if we ended
</pre></td></tr>


<tr><th class=""line-num"" id=""L1223""><a href=""#L1223"">1223</a></th><td class=""line-code""><pre>         * on a byte boundary, and/or with erroneous trailing characters.
</pre></td></tr>


<tr><th class=""line-num"" id=""L1224""><a href=""#L1224"">1224</a></th><td class=""line-code""><pre>         */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1225""><a href=""#L1225"">1225</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1226""><a href=""#L1226"">1226</a></th><td class=""line-code""><pre>        <span class=""r"">if</span> (ch == Pad64) {                <span class=""c"">/* We got a pad char. */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1227""><a href=""#L1227"">1227</a></th><td class=""line-code""><pre>                ch = *src++;                <span class=""c"">/* Skip it, get next. */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1228""><a href=""#L1228"">1228</a></th><td class=""line-code""><pre>                <span class=""r"">switch</span> (state) {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1229""><a href=""#L1229"">1229</a></th><td class=""line-code""><pre>                <span class=""r"">case</span> <span class=""i"">0</span>:                <span class=""c"">/* Invalid = in first position */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1230""><a href=""#L1230"">1230</a></th><td class=""line-code""><pre>                <span class=""r"">case</span> <span class=""i"">1</span>:                <span class=""c"">/* Invalid = in second position */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1231""><a href=""#L1231"">1231</a></th><td class=""line-code""><pre>                        <span class=""r"">return</span> (-<span class=""i"">1</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1232""><a href=""#L1232"">1232</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1233""><a href=""#L1233"">1233</a></th><td class=""line-code""><pre>                <span class=""r"">case</span> <span class=""i"">2</span>:                <span class=""c"">/* Valid, means one byte of info */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1234""><a href=""#L1234"">1234</a></th><td class=""line-code""><pre>                        <span class=""c"">/* Skip any number of spaces. */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1235""><a href=""#L1235"">1235</a></th><td class=""line-code""><pre>                        <span class=""r"">for</span> ((<span class=""di"">void</span>)mDNSNULL; ch != <span class=""ch"">'\0'</span>; ch = *src++)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1236""><a href=""#L1236"">1236</a></th><td class=""line-code""><pre>                                <span class=""r"">if</span> (!mDNSisspace(ch))
</pre></td></tr>


<tr><th class=""line-num"" id=""L1237""><a href=""#L1237"">1237</a></th><td class=""line-code""><pre>                                        <span class=""r"">break</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1238""><a href=""#L1238"">1238</a></th><td class=""line-code""><pre>                        <span class=""c"">/* Make sure there is another trailing = sign. */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1239""><a href=""#L1239"">1239</a></th><td class=""line-code""><pre>                        <span class=""r"">if</span> (ch != Pad64)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1240""><a href=""#L1240"">1240</a></th><td class=""line-code""><pre>                                <span class=""r"">return</span> (-<span class=""i"">1</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1241""><a href=""#L1241"">1241</a></th><td class=""line-code""><pre>                        ch = *src++;                <span class=""c"">/* Skip the = */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1242""><a href=""#L1242"">1242</a></th><td class=""line-code""><pre>                        <span class=""c"">/* Fall through to &quot;single trailing =&quot; case. */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1243""><a href=""#L1243"">1243</a></th><td class=""line-code""><pre>                        <span class=""c"">/* FALLTHROUGH */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1244""><a href=""#L1244"">1244</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1245""><a href=""#L1245"">1245</a></th><td class=""line-code""><pre>                <span class=""r"">case</span> <span class=""i"">3</span>:                <span class=""c"">/* Valid, means two bytes of info */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1246""><a href=""#L1246"">1246</a></th><td class=""line-code""><pre>                        <span class=""c"">/*
</pre></td></tr>


<tr><th class=""line-num"" id=""L1247""><a href=""#L1247"">1247</a></th><td class=""line-code""><pre>                         * We know this char is an =.  Is there anything but
</pre></td></tr>


<tr><th class=""line-num"" id=""L1248""><a href=""#L1248"">1248</a></th><td class=""line-code""><pre>                         * whitespace after it?
</pre></td></tr>


<tr><th class=""line-num"" id=""L1249""><a href=""#L1249"">1249</a></th><td class=""line-code""><pre>                         */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1250""><a href=""#L1250"">1250</a></th><td class=""line-code""><pre>                        <span class=""r"">for</span> ((<span class=""di"">void</span>)mDNSNULL; ch != <span class=""ch"">'\0'</span>; ch = *src++)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1251""><a href=""#L1251"">1251</a></th><td class=""line-code""><pre>                                <span class=""r"">if</span> (!mDNSisspace(ch))
</pre></td></tr>


<tr><th class=""line-num"" id=""L1252""><a href=""#L1252"">1252</a></th><td class=""line-code""><pre>                                        <span class=""r"">return</span> (-<span class=""i"">1</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1253""><a href=""#L1253"">1253</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1254""><a href=""#L1254"">1254</a></th><td class=""line-code""><pre>                        <span class=""c"">/*
</pre></td></tr>


<tr><th class=""line-num"" id=""L1255""><a href=""#L1255"">1255</a></th><td class=""line-code""><pre>                         * Now make sure for cases 2 and 3 that the &quot;extra&quot;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1256""><a href=""#L1256"">1256</a></th><td class=""line-code""><pre>                         * bits that slopped past the last full byte were
</pre></td></tr>


<tr><th class=""line-num"" id=""L1257""><a href=""#L1257"">1257</a></th><td class=""line-code""><pre>                         * zeros.  If we don't check them, they become a
</pre></td></tr>


<tr><th class=""line-num"" id=""L1258""><a href=""#L1258"">1258</a></th><td class=""line-code""><pre>                         * subliminal channel.
</pre></td></tr>


<tr><th class=""line-num"" id=""L1259""><a href=""#L1259"">1259</a></th><td class=""line-code""><pre>                         */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1260""><a href=""#L1260"">1260</a></th><td class=""line-code""><pre>                        <span class=""r"">if</span> (target &amp;&amp; target[tarindex] != <span class=""i"">0</span>)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1261""><a href=""#L1261"">1261</a></th><td class=""line-code""><pre>                                <span class=""r"">return</span> (-<span class=""i"">1</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1262""><a href=""#L1262"">1262</a></th><td class=""line-code""><pre>                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1263""><a href=""#L1263"">1263</a></th><td class=""line-code""><pre>        } <span class=""r"">else</span> {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1264""><a href=""#L1264"">1264</a></th><td class=""line-code""><pre>                <span class=""c"">/*
</pre></td></tr>


<tr><th class=""line-num"" id=""L1265""><a href=""#L1265"">1265</a></th><td class=""line-code""><pre>                 * We ended by seeing the end of the string.  Make sure we
</pre></td></tr>


<tr><th class=""line-num"" id=""L1266""><a href=""#L1266"">1266</a></th><td class=""line-code""><pre>                 * have no partial bytes lying around.
</pre></td></tr>


<tr><th class=""line-num"" id=""L1267""><a href=""#L1267"">1267</a></th><td class=""line-code""><pre>                 */</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1268""><a href=""#L1268"">1268</a></th><td class=""line-code""><pre>                <span class=""r"">if</span> (state != <span class=""i"">0</span>)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1269""><a href=""#L1269"">1269</a></th><td class=""line-code""><pre>                        <span class=""r"">return</span> (-<span class=""i"">1</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1270""><a href=""#L1270"">1270</a></th><td class=""line-code""><pre>                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1271""><a href=""#L1271"">1271</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1272""><a href=""#L1272"">1272</a></th><td class=""line-code""><pre>        <span class=""r"">return</span> (tarindex);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1273""><a href=""#L1273"">1273</a></th><td class=""line-code""><pre>        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1274""><a href=""#L1274"">1274</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1275""><a href=""#L1275"">1275</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1276""><a href=""#L1276"">1276</a></th><td class=""line-code""><pre> <span class=""c"">// ***************************************************************************</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1277""><a href=""#L1277"">1277</a></th><td class=""line-code""><pre><span class=""pp"">#if</span> COMPILER_LIKES_PRAGMA_MARK
</pre></td></tr>


<tr><th class=""line-num"" id=""L1278""><a href=""#L1278"">1278</a></th><td class=""line-code""><pre><span class=""pp"">#pragma</span> mark - API exported to mDNS Core
</pre></td></tr>


<tr><th class=""line-num"" id=""L1279""><a href=""#L1279"">1279</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1280""><a href=""#L1280"">1280</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1281""><a href=""#L1281"">1281</a></th><td class=""line-code""><pre><span class=""c"">// Constants</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1282""><a href=""#L1282"">1282</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HMAC_IPAD   <span class=""hx"">0x36</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1283""><a href=""#L1283"">1283</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HMAC_OPAD   <span class=""hx"">0x5c</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1284""><a href=""#L1284"">1284</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> MD5_LEN     <span class=""i"">16</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1285""><a href=""#L1285"">1285</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1286""><a href=""#L1286"">1286</a></th><td class=""line-code""><pre><span class=""pp"">#define</span> HMAC_MD5_AlgName (*(<span class=""di"">const</span> domainname*) <span class=""s""><span class=""dl"">&quot;</span><span class=""ch"">\010</span><span class=""dl"">&quot;</span></span> <span class=""s""><span class=""dl"">&quot;</span><span class=""k"">hmac-md5</span><span class=""dl"">&quot;</span></span> <span class=""s""><span class=""dl"">&quot;</span><span class=""ch"">\007</span><span class=""dl"">&quot;</span></span> <span class=""s""><span class=""dl"">&quot;</span><span class=""k"">sig-alg</span><span class=""dl"">&quot;</span></span> <span class=""s""><span class=""dl"">&quot;</span><span class=""ch"">\003</span><span class=""dl"">&quot;</span></span> <span class=""s""><span class=""dl"">&quot;</span><span class=""k"">reg</span><span class=""dl"">&quot;</span></span> <span class=""s""><span class=""dl"">&quot;</span><span class=""ch"">\003</span><span class=""dl"">&quot;</span></span> <span class=""s""><span class=""dl"">&quot;</span><span class=""k"">int</span><span class=""dl"">&quot;</span></span>)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1287""><a href=""#L1287"">1287</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1288""><a href=""#L1288"">1288</a></th><td class=""line-code""><pre><span class=""c"">// Adapted from Appendix, RFC 2104</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1289""><a href=""#L1289"">1289</a></th><td class=""line-code""><pre>mDNSlocal <span class=""di"">void</span> DNSDigest_ConstructHMACKey(DomainAuthInfo *info, <span class=""di"">const</span> mDNSu8 *key, mDNSu32 len)                
</pre></td></tr>


<tr><th class=""line-num"" id=""L1290""><a href=""#L1290"">1290</a></th><td class=""line-code""><pre>        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1291""><a href=""#L1291"">1291</a></th><td class=""line-code""><pre>        MD5_CTX k;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1292""><a href=""#L1292"">1292</a></th><td class=""line-code""><pre>        mDNSu8 buf[MD5_LEN];
</pre></td></tr>


<tr><th class=""line-num"" id=""L1293""><a href=""#L1293"">1293</a></th><td class=""line-code""><pre>        <span class=""pt"">int</span> i;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1294""><a href=""#L1294"">1294</a></th><td class=""line-code""><pre>        
</pre></td></tr>


<tr><th class=""line-num"" id=""L1295""><a href=""#L1295"">1295</a></th><td class=""line-code""><pre>        <span class=""c"">// If key is longer than HMAC_LEN reset it to MD5(key)</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1296""><a href=""#L1296"">1296</a></th><td class=""line-code""><pre>        <span class=""r"">if</span> (len &gt; HMAC_LEN)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1297""><a href=""#L1297"">1297</a></th><td class=""line-code""><pre>                {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1298""><a href=""#L1298"">1298</a></th><td class=""line-code""><pre>                MD5_Init(&amp;k);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1299""><a href=""#L1299"">1299</a></th><td class=""line-code""><pre>                MD5_Update(&amp;k, key, len);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1300""><a href=""#L1300"">1300</a></th><td class=""line-code""><pre>                MD5_Final(buf, &amp;k);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1301""><a href=""#L1301"">1301</a></th><td class=""line-code""><pre>                key = buf;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1302""><a href=""#L1302"">1302</a></th><td class=""line-code""><pre>                len = MD5_LEN;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1303""><a href=""#L1303"">1303</a></th><td class=""line-code""><pre>                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1304""><a href=""#L1304"">1304</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1305""><a href=""#L1305"">1305</a></th><td class=""line-code""><pre>        <span class=""c"">// store key in pads</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1306""><a href=""#L1306"">1306</a></th><td class=""line-code""><pre>        mDNSPlatformMemZero(info-&gt;keydata_ipad, HMAC_LEN);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1307""><a href=""#L1307"">1307</a></th><td class=""line-code""><pre>        mDNSPlatformMemZero(info-&gt;keydata_opad, HMAC_LEN);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1308""><a href=""#L1308"">1308</a></th><td class=""line-code""><pre>        mDNSPlatformMemCopy(info-&gt;keydata_ipad, key, len);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1309""><a href=""#L1309"">1309</a></th><td class=""line-code""><pre>        mDNSPlatformMemCopy(info-&gt;keydata_opad, key, len);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1310""><a href=""#L1310"">1310</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1311""><a href=""#L1311"">1311</a></th><td class=""line-code""><pre>        <span class=""c"">// XOR key with ipad and opad values</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1312""><a href=""#L1312"">1312</a></th><td class=""line-code""><pre>        <span class=""r"">for</span> (i = <span class=""i"">0</span>; i &lt; HMAC_LEN; i++)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1313""><a href=""#L1313"">1313</a></th><td class=""line-code""><pre>                {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1314""><a href=""#L1314"">1314</a></th><td class=""line-code""><pre>                info-&gt;keydata_ipad[i] ^= HMAC_IPAD;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1315""><a href=""#L1315"">1315</a></th><td class=""line-code""><pre>                info-&gt;keydata_opad[i] ^= HMAC_OPAD;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1316""><a href=""#L1316"">1316</a></th><td class=""line-code""><pre>                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1317""><a href=""#L1317"">1317</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1318""><a href=""#L1318"">1318</a></th><td class=""line-code""><pre>        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1319""><a href=""#L1319"">1319</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1320""><a href=""#L1320"">1320</a></th><td class=""line-code""><pre>mDNSexport mDNSs32 DNSDigest_ConstructHMACKeyfromBase64(DomainAuthInfo *info, <span class=""di"">const</span> <span class=""pt"">char</span> *b64key)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1321""><a href=""#L1321"">1321</a></th><td class=""line-code""><pre>        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1322""><a href=""#L1322"">1322</a></th><td class=""line-code""><pre>        mDNSu8 keybuf[<span class=""i"">1024</span>];
</pre></td></tr>


<tr><th class=""line-num"" id=""L1323""><a href=""#L1323"">1323</a></th><td class=""line-code""><pre>        mDNSs32 keylen = DNSDigest_Base64ToBin(b64key, keybuf, <span class=""r"">sizeof</span>(keybuf));
</pre></td></tr>


<tr><th class=""line-num"" id=""L1324""><a href=""#L1324"">1324</a></th><td class=""line-code""><pre>        <span class=""r"">if</span> (keylen &lt; <span class=""i"">0</span>) <span class=""r"">return</span>(keylen);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1325""><a href=""#L1325"">1325</a></th><td class=""line-code""><pre>        DNSDigest_ConstructHMACKey(info, keybuf, (mDNSu32)keylen);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1326""><a href=""#L1326"">1326</a></th><td class=""line-code""><pre>        <span class=""r"">return</span>(keylen);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1327""><a href=""#L1327"">1327</a></th><td class=""line-code""><pre>        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1328""><a href=""#L1328"">1328</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1329""><a href=""#L1329"">1329</a></th><td class=""line-code""><pre>mDNSexport <span class=""di"">void</span> DNSDigest_SignMessage(DNSMessage *msg, mDNSu8 **end, DomainAuthInfo *info, mDNSu16 tcode)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1330""><a href=""#L1330"">1330</a></th><td class=""line-code""><pre>        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1331""><a href=""#L1331"">1331</a></th><td class=""line-code""><pre>        AuthRecord tsig;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1332""><a href=""#L1332"">1332</a></th><td class=""line-code""><pre>        mDNSu8  *rdata, *<span class=""di"">const</span> countPtr = (mDNSu8 *)&amp;msg-&gt;h.numAdditionals;        <span class=""c"">// Get existing numAdditionals value</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1333""><a href=""#L1333"">1333</a></th><td class=""line-code""><pre>        mDNSu32 utc32;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1334""><a href=""#L1334"">1334</a></th><td class=""line-code""><pre>        mDNSu8 utc48[<span class=""i"">6</span>];
</pre></td></tr>


<tr><th class=""line-num"" id=""L1335""><a href=""#L1335"">1335</a></th><td class=""line-code""><pre>        mDNSu8 digest[MD5_LEN];
</pre></td></tr>


<tr><th class=""line-num"" id=""L1336""><a href=""#L1336"">1336</a></th><td class=""line-code""><pre>        mDNSu8 *ptr = *end;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1337""><a href=""#L1337"">1337</a></th><td class=""line-code""><pre>        mDNSu32 len;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1338""><a href=""#L1338"">1338</a></th><td class=""line-code""><pre>        mDNSOpaque16 buf;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1339""><a href=""#L1339"">1339</a></th><td class=""line-code""><pre>        MD5_CTX c;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1340""><a href=""#L1340"">1340</a></th><td class=""line-code""><pre>        mDNSu16 numAdditionals = (mDNSu16)((mDNSu16)countPtr[<span class=""i"">0</span>] &lt;&lt; <span class=""i"">8</span> | countPtr[<span class=""i"">1</span>]);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1341""><a href=""#L1341"">1341</a></th><td class=""line-code""><pre>        
</pre></td></tr>


<tr><th class=""line-num"" id=""L1342""><a href=""#L1342"">1342</a></th><td class=""line-code""><pre>        <span class=""c"">// Init MD5 context, digest inner key pad and message</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1343""><a href=""#L1343"">1343</a></th><td class=""line-code""><pre>    MD5_Init(&amp;c);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1344""><a href=""#L1344"">1344</a></th><td class=""line-code""><pre>    MD5_Update(&amp;c, info-&gt;keydata_ipad, HMAC_LEN);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1345""><a href=""#L1345"">1345</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, (mDNSu8 *)msg, (<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(*end - (mDNSu8 *)msg));
</pre></td></tr>


<tr><th class=""line-num"" id=""L1346""><a href=""#L1346"">1346</a></th><td class=""line-code""><pre>           
</pre></td></tr>


<tr><th class=""line-num"" id=""L1347""><a href=""#L1347"">1347</a></th><td class=""line-code""><pre>        <span class=""c"">// Construct TSIG RR, digesting variables as apporpriate</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1348""><a href=""#L1348"">1348</a></th><td class=""line-code""><pre>        mDNS_SetupResourceRecord(&amp;tsig, mDNSNULL, <span class=""i"">0</span>, kDNSType_TSIG, <span class=""i"">0</span>, kDNSRecordTypeKnownUnique, AuthRecordAny, mDNSNULL, mDNSNULL);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1349""><a href=""#L1349"">1349</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1350""><a href=""#L1350"">1350</a></th><td class=""line-code""><pre>        <span class=""c"">// key name</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1351""><a href=""#L1351"">1351</a></th><td class=""line-code""><pre>        AssignDomainName(&amp;tsig.namestorage, &amp;info-&gt;keyname);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1352""><a href=""#L1352"">1352</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, info-&gt;keyname.c, DomainNameLength(&amp;info-&gt;keyname));
</pre></td></tr>


<tr><th class=""line-num"" id=""L1353""><a href=""#L1353"">1353</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1354""><a href=""#L1354"">1354</a></th><td class=""line-code""><pre>        <span class=""c"">// class</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1355""><a href=""#L1355"">1355</a></th><td class=""line-code""><pre>        tsig.resrec.rrclass = kDNSQClass_ANY;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1356""><a href=""#L1356"">1356</a></th><td class=""line-code""><pre>        buf = mDNSOpaque16fromIntVal(kDNSQClass_ANY);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1357""><a href=""#L1357"">1357</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, buf.b, <span class=""r"">sizeof</span>(mDNSOpaque16));
</pre></td></tr>


<tr><th class=""line-num"" id=""L1358""><a href=""#L1358"">1358</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1359""><a href=""#L1359"">1359</a></th><td class=""line-code""><pre>        <span class=""c"">// ttl</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1360""><a href=""#L1360"">1360</a></th><td class=""line-code""><pre>        tsig.resrec.rroriginalttl = <span class=""i"">0</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1361""><a href=""#L1361"">1361</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, (mDNSu8 *)&amp;tsig.resrec.rroriginalttl, <span class=""r"">sizeof</span>(tsig.resrec.rroriginalttl));
</pre></td></tr>


<tr><th class=""line-num"" id=""L1362""><a href=""#L1362"">1362</a></th><td class=""line-code""><pre>        
</pre></td></tr>


<tr><th class=""line-num"" id=""L1363""><a href=""#L1363"">1363</a></th><td class=""line-code""><pre>        <span class=""c"">// alg name</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1364""><a href=""#L1364"">1364</a></th><td class=""line-code""><pre>        AssignDomainName(&amp;tsig.resrec.rdata-&gt;u.name, &amp;HMAC_MD5_AlgName);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1365""><a href=""#L1365"">1365</a></th><td class=""line-code""><pre>        len = DomainNameLength(&amp;HMAC_MD5_AlgName);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1366""><a href=""#L1366"">1366</a></th><td class=""line-code""><pre>        rdata = tsig.resrec.rdata-&gt;u.data + len;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1367""><a href=""#L1367"">1367</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, HMAC_MD5_AlgName.c, len);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1368""><a href=""#L1368"">1368</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1369""><a href=""#L1369"">1369</a></th><td class=""line-code""><pre>        <span class=""c"">// time</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1370""><a href=""#L1370"">1370</a></th><td class=""line-code""><pre>        <span class=""c"">// get UTC (universal time), convert to 48-bit unsigned in network byte order</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1371""><a href=""#L1371"">1371</a></th><td class=""line-code""><pre>        utc32 = (mDNSu32)mDNSPlatformUTC();
</pre></td></tr>


<tr><th class=""line-num"" id=""L1372""><a href=""#L1372"">1372</a></th><td class=""line-code""><pre>        <span class=""r"">if</span> (utc32 == (<span class=""pt"">unsigned</span>)-<span class=""i"">1</span>) { LogMsg(<span class=""s""><span class=""dl"">&quot;</span><span class=""k"">ERROR: DNSDigest_SignMessage - mDNSPlatformUTC returned bad time -1</span><span class=""dl"">&quot;</span></span>); *end = mDNSNULL; }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1373""><a href=""#L1373"">1373</a></th><td class=""line-code""><pre>        utc48[<span class=""i"">0</span>] = <span class=""i"">0</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1374""><a href=""#L1374"">1374</a></th><td class=""line-code""><pre>        utc48[<span class=""i"">1</span>] = <span class=""i"">0</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1375""><a href=""#L1375"">1375</a></th><td class=""line-code""><pre>        utc48[<span class=""i"">2</span>] = (mDNSu8)((utc32 &gt;&gt; <span class=""i"">24</span>) &amp; <span class=""hx"">0xff</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1376""><a href=""#L1376"">1376</a></th><td class=""line-code""><pre>        utc48[<span class=""i"">3</span>] = (mDNSu8)((utc32 &gt;&gt; <span class=""i"">16</span>) &amp; <span class=""hx"">0xff</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1377""><a href=""#L1377"">1377</a></th><td class=""line-code""><pre>        utc48[<span class=""i"">4</span>] = (mDNSu8)((utc32 &gt;&gt;  <span class=""i"">8</span>) &amp; <span class=""hx"">0xff</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1378""><a href=""#L1378"">1378</a></th><td class=""line-code""><pre>        utc48[<span class=""i"">5</span>] = (mDNSu8)( utc32        &amp; <span class=""hx"">0xff</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1379""><a href=""#L1379"">1379</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1380""><a href=""#L1380"">1380</a></th><td class=""line-code""><pre>        mDNSPlatformMemCopy(rdata, utc48, <span class=""i"">6</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1381""><a href=""#L1381"">1381</a></th><td class=""line-code""><pre>        rdata += <span class=""i"">6</span>;                      
</pre></td></tr>


<tr><th class=""line-num"" id=""L1382""><a href=""#L1382"">1382</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, utc48, <span class=""i"">6</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1383""><a href=""#L1383"">1383</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1384""><a href=""#L1384"">1384</a></th><td class=""line-code""><pre>        <span class=""c"">// 300 sec is fudge recommended in RFC 2485</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1385""><a href=""#L1385"">1385</a></th><td class=""line-code""><pre>        rdata[<span class=""i"">0</span>] = (mDNSu8)((<span class=""i"">300</span> &gt;&gt; <span class=""i"">8</span>)  &amp; <span class=""hx"">0xff</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1386""><a href=""#L1386"">1386</a></th><td class=""line-code""><pre>        rdata[<span class=""i"">1</span>] = (mDNSu8)( <span class=""i"">300</span>        &amp; <span class=""hx"">0xff</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1387""><a href=""#L1387"">1387</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, rdata, <span class=""r"">sizeof</span>(mDNSOpaque16));
</pre></td></tr>


<tr><th class=""line-num"" id=""L1388""><a href=""#L1388"">1388</a></th><td class=""line-code""><pre>        rdata += <span class=""r"">sizeof</span>(mDNSOpaque16);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1389""><a href=""#L1389"">1389</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1390""><a href=""#L1390"">1390</a></th><td class=""line-code""><pre>        <span class=""c"">// digest error (tcode) and other data len (zero) - we'll add them to the rdata later</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1391""><a href=""#L1391"">1391</a></th><td class=""line-code""><pre>        buf.b[<span class=""i"">0</span>] = (mDNSu8)((tcode &gt;&gt; <span class=""i"">8</span>) &amp; <span class=""hx"">0xff</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1392""><a href=""#L1392"">1392</a></th><td class=""line-code""><pre>        buf.b[<span class=""i"">1</span>] = (mDNSu8)( tcode       &amp; <span class=""hx"">0xff</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1393""><a href=""#L1393"">1393</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, buf.b, <span class=""r"">sizeof</span>(mDNSOpaque16));  <span class=""c"">// error</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1394""><a href=""#L1394"">1394</a></th><td class=""line-code""><pre>        buf.NotAnInteger = <span class=""i"">0</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1395""><a href=""#L1395"">1395</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, buf.b, <span class=""r"">sizeof</span>(mDNSOpaque16));  <span class=""c"">// other data len</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1396""><a href=""#L1396"">1396</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1397""><a href=""#L1397"">1397</a></th><td class=""line-code""><pre>        <span class=""c"">// finish the message &amp; tsig var hash</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1398""><a href=""#L1398"">1398</a></th><td class=""line-code""><pre>    MD5_Final(digest, &amp;c);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1399""><a href=""#L1399"">1399</a></th><td class=""line-code""><pre>        
</pre></td></tr>


<tr><th class=""line-num"" id=""L1400""><a href=""#L1400"">1400</a></th><td class=""line-code""><pre>        <span class=""c"">// perform outer MD5 (outer key pad, inner digest)</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1401""><a href=""#L1401"">1401</a></th><td class=""line-code""><pre>        MD5_Init(&amp;c);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1402""><a href=""#L1402"">1402</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, info-&gt;keydata_opad, HMAC_LEN);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1403""><a href=""#L1403"">1403</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, digest, MD5_LEN);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1404""><a href=""#L1404"">1404</a></th><td class=""line-code""><pre>        MD5_Final(digest, &amp;c);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1405""><a href=""#L1405"">1405</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1406""><a href=""#L1406"">1406</a></th><td class=""line-code""><pre>        <span class=""c"">// set remaining rdata fields</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1407""><a href=""#L1407"">1407</a></th><td class=""line-code""><pre>        rdata[<span class=""i"">0</span>] = (mDNSu8)((MD5_LEN &gt;&gt; <span class=""i"">8</span>)  &amp; <span class=""hx"">0xff</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1408""><a href=""#L1408"">1408</a></th><td class=""line-code""><pre>        rdata[<span class=""i"">1</span>] = (mDNSu8)( MD5_LEN        &amp; <span class=""hx"">0xff</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1409""><a href=""#L1409"">1409</a></th><td class=""line-code""><pre>        rdata += <span class=""r"">sizeof</span>(mDNSOpaque16);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1410""><a href=""#L1410"">1410</a></th><td class=""line-code""><pre>        mDNSPlatformMemCopy(rdata, digest, MD5_LEN);                          <span class=""c"">// MAC</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1411""><a href=""#L1411"">1411</a></th><td class=""line-code""><pre>        rdata += MD5_LEN;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1412""><a href=""#L1412"">1412</a></th><td class=""line-code""><pre>        rdata[<span class=""i"">0</span>] = msg-&gt;h.id.b[<span class=""i"">0</span>];                                            <span class=""c"">// original ID</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1413""><a href=""#L1413"">1413</a></th><td class=""line-code""><pre>        rdata[<span class=""i"">1</span>] = msg-&gt;h.id.b[<span class=""i"">1</span>];
</pre></td></tr>


<tr><th class=""line-num"" id=""L1414""><a href=""#L1414"">1414</a></th><td class=""line-code""><pre>        rdata[<span class=""i"">2</span>] = (mDNSu8)((tcode &gt;&gt; <span class=""i"">8</span>) &amp; <span class=""hx"">0xff</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1415""><a href=""#L1415"">1415</a></th><td class=""line-code""><pre>        rdata[<span class=""i"">3</span>] = (mDNSu8)( tcode       &amp; <span class=""hx"">0xff</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1416""><a href=""#L1416"">1416</a></th><td class=""line-code""><pre>        rdata[<span class=""i"">4</span>] = <span class=""i"">0</span>;                                                         <span class=""c"">// other data len</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1417""><a href=""#L1417"">1417</a></th><td class=""line-code""><pre>        rdata[<span class=""i"">5</span>] = <span class=""i"">0</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1418""><a href=""#L1418"">1418</a></th><td class=""line-code""><pre>        rdata += <span class=""i"">6</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1419""><a href=""#L1419"">1419</a></th><td class=""line-code""><pre>        
</pre></td></tr>


<tr><th class=""line-num"" id=""L1420""><a href=""#L1420"">1420</a></th><td class=""line-code""><pre>        tsig.resrec.rdlength = (mDNSu16)(rdata - tsig.resrec.rdata-&gt;u.data);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1421""><a href=""#L1421"">1421</a></th><td class=""line-code""><pre>        *end = PutResourceRecordTTLJumbo(msg, ptr, &amp;numAdditionals, &amp;tsig.resrec, <span class=""i"">0</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1422""><a href=""#L1422"">1422</a></th><td class=""line-code""><pre>        <span class=""r"">if</span> (!*end) { LogMsg(<span class=""s""><span class=""dl"">&quot;</span><span class=""k"">ERROR: DNSDigest_SignMessage - could not put TSIG</span><span class=""dl"">&quot;</span></span>); *end = mDNSNULL; <span class=""r"">return</span>; }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1423""><a href=""#L1423"">1423</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1424""><a href=""#L1424"">1424</a></th><td class=""line-code""><pre>        <span class=""c"">// Write back updated numAdditionals value</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1425""><a href=""#L1425"">1425</a></th><td class=""line-code""><pre>        countPtr[<span class=""i"">0</span>] = (mDNSu8)(numAdditionals &gt;&gt; <span class=""i"">8</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1426""><a href=""#L1426"">1426</a></th><td class=""line-code""><pre>        countPtr[<span class=""i"">1</span>] = (mDNSu8)(numAdditionals &amp;  <span class=""hx"">0xFF</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1427""><a href=""#L1427"">1427</a></th><td class=""line-code""><pre>        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1428""><a href=""#L1428"">1428</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1429""><a href=""#L1429"">1429</a></th><td class=""line-code""><pre>mDNSexport mDNSBool DNSDigest_VerifyMessage(DNSMessage *msg, mDNSu8 *end, LargeCacheRecord * lcr, DomainAuthInfo *info, mDNSu16 * rcode, mDNSu16 * tcode)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1430""><a href=""#L1430"">1430</a></th><td class=""line-code""><pre>        {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1431""><a href=""#L1431"">1431</a></th><td class=""line-code""><pre>        mDNSu8                        *        ptr = (mDNSu8*) &amp;lcr-&gt;r.resrec.rdata-&gt;u.data;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1432""><a href=""#L1432"">1432</a></th><td class=""line-code""><pre>        mDNSs32                                now;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1433""><a href=""#L1433"">1433</a></th><td class=""line-code""><pre>        mDNSs32                                then;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1434""><a href=""#L1434"">1434</a></th><td class=""line-code""><pre>        mDNSu8                                thisDigest[MD5_LEN];
</pre></td></tr>


<tr><th class=""line-num"" id=""L1435""><a href=""#L1435"">1435</a></th><td class=""line-code""><pre>        mDNSu8                                thatDigest[MD5_LEN];
</pre></td></tr>


<tr><th class=""line-num"" id=""L1436""><a href=""#L1436"">1436</a></th><td class=""line-code""><pre>        mDNSu32                                macsize;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1437""><a href=""#L1437"">1437</a></th><td class=""line-code""><pre>        mDNSOpaque16                 buf;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1438""><a href=""#L1438"">1438</a></th><td class=""line-code""><pre>        mDNSu8                                utc48[<span class=""i"">6</span>];
</pre></td></tr>


<tr><th class=""line-num"" id=""L1439""><a href=""#L1439"">1439</a></th><td class=""line-code""><pre>        mDNSs32                                delta;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1440""><a href=""#L1440"">1440</a></th><td class=""line-code""><pre>        mDNSu16                                fudge;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1441""><a href=""#L1441"">1441</a></th><td class=""line-code""><pre>        domainname                *        algo;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1442""><a href=""#L1442"">1442</a></th><td class=""line-code""><pre>        MD5_CTX                                c;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1443""><a href=""#L1443"">1443</a></th><td class=""line-code""><pre>        mDNSBool                        ok = mDNSfalse;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1444""><a href=""#L1444"">1444</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1445""><a href=""#L1445"">1445</a></th><td class=""line-code""><pre>        <span class=""c"">// We only support HMAC-MD5 for now</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1446""><a href=""#L1446"">1446</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1447""><a href=""#L1447"">1447</a></th><td class=""line-code""><pre>        algo = (domainname*) ptr;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1448""><a href=""#L1448"">1448</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1449""><a href=""#L1449"">1449</a></th><td class=""line-code""><pre>        <span class=""r"">if</span> (!SameDomainName(algo, &amp;HMAC_MD5_AlgName))
</pre></td></tr>


<tr><th class=""line-num"" id=""L1450""><a href=""#L1450"">1450</a></th><td class=""line-code""><pre>                {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1451""><a href=""#L1451"">1451</a></th><td class=""line-code""><pre>                LogMsg(<span class=""s""><span class=""dl"">&quot;</span><span class=""k"">ERROR: DNSDigest_VerifyMessage - TSIG algorithm not supported: %##s</span><span class=""dl"">&quot;</span></span>, algo-&gt;c);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1452""><a href=""#L1452"">1452</a></th><td class=""line-code""><pre>                *rcode = kDNSFlag1_RC_NotAuth;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1453""><a href=""#L1453"">1453</a></th><td class=""line-code""><pre>                *tcode = TSIG_ErrBadKey;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1454""><a href=""#L1454"">1454</a></th><td class=""line-code""><pre>                ok = mDNSfalse;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1455""><a href=""#L1455"">1455</a></th><td class=""line-code""><pre>                <span class=""r"">goto</span> exit;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1456""><a href=""#L1456"">1456</a></th><td class=""line-code""><pre>                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1457""><a href=""#L1457"">1457</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1458""><a href=""#L1458"">1458</a></th><td class=""line-code""><pre>        ptr += DomainNameLength(algo);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1459""><a href=""#L1459"">1459</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1460""><a href=""#L1460"">1460</a></th><td class=""line-code""><pre>        <span class=""c"">// Check the times</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1461""><a href=""#L1461"">1461</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1462""><a href=""#L1462"">1462</a></th><td class=""line-code""><pre>        now = mDNSPlatformUTC();
</pre></td></tr>


<tr><th class=""line-num"" id=""L1463""><a href=""#L1463"">1463</a></th><td class=""line-code""><pre>        <span class=""r"">if</span> (now == -<span class=""i"">1</span>)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1464""><a href=""#L1464"">1464</a></th><td class=""line-code""><pre>                {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1465""><a href=""#L1465"">1465</a></th><td class=""line-code""><pre>                LogMsg(<span class=""s""><span class=""dl"">&quot;</span><span class=""k"">ERROR: DNSDigest_VerifyMessage - mDNSPlatformUTC returned bad time -1</span><span class=""dl"">&quot;</span></span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1466""><a href=""#L1466"">1466</a></th><td class=""line-code""><pre>                *rcode = kDNSFlag1_RC_NotAuth;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1467""><a href=""#L1467"">1467</a></th><td class=""line-code""><pre>                *tcode = TSIG_ErrBadTime;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1468""><a href=""#L1468"">1468</a></th><td class=""line-code""><pre>                ok = mDNSfalse;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1469""><a href=""#L1469"">1469</a></th><td class=""line-code""><pre>                <span class=""r"">goto</span> exit;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1470""><a href=""#L1470"">1470</a></th><td class=""line-code""><pre>                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1471""><a href=""#L1471"">1471</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1472""><a href=""#L1472"">1472</a></th><td class=""line-code""><pre>        <span class=""c"">// Get the 48 bit time field, skipping over the first word</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1473""><a href=""#L1473"">1473</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1474""><a href=""#L1474"">1474</a></th><td class=""line-code""><pre>        utc48[<span class=""i"">0</span>] = *ptr++;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1475""><a href=""#L1475"">1475</a></th><td class=""line-code""><pre>        utc48[<span class=""i"">1</span>] = *ptr++;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1476""><a href=""#L1476"">1476</a></th><td class=""line-code""><pre>        utc48[<span class=""i"">2</span>] = *ptr++;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1477""><a href=""#L1477"">1477</a></th><td class=""line-code""><pre>        utc48[<span class=""i"">3</span>] = *ptr++;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1478""><a href=""#L1478"">1478</a></th><td class=""line-code""><pre>        utc48[<span class=""i"">4</span>] = *ptr++;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1479""><a href=""#L1479"">1479</a></th><td class=""line-code""><pre>        utc48[<span class=""i"">5</span>] = *ptr++;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1480""><a href=""#L1480"">1480</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1481""><a href=""#L1481"">1481</a></th><td class=""line-code""><pre>        then  = (mDNSs32)NToH32(utc48 + <span class=""r"">sizeof</span>(mDNSu16));
</pre></td></tr>


<tr><th class=""line-num"" id=""L1482""><a href=""#L1482"">1482</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1483""><a href=""#L1483"">1483</a></th><td class=""line-code""><pre>        fudge = NToH16(ptr);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1484""><a href=""#L1484"">1484</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1485""><a href=""#L1485"">1485</a></th><td class=""line-code""><pre>        ptr += <span class=""r"">sizeof</span>(mDNSu16);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1486""><a href=""#L1486"">1486</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1487""><a href=""#L1487"">1487</a></th><td class=""line-code""><pre>        delta = (now &gt; then) ? now - then : then - now;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1488""><a href=""#L1488"">1488</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1489""><a href=""#L1489"">1489</a></th><td class=""line-code""><pre>        <span class=""r"">if</span> (delta &gt; fudge)
</pre></td></tr>


<tr><th class=""line-num"" id=""L1490""><a href=""#L1490"">1490</a></th><td class=""line-code""><pre>                {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1491""><a href=""#L1491"">1491</a></th><td class=""line-code""><pre>                LogMsg(<span class=""s""><span class=""dl"">&quot;</span><span class=""k"">ERROR: DNSDigest_VerifyMessage - time skew &gt; %d</span><span class=""dl"">&quot;</span></span>, fudge);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1492""><a href=""#L1492"">1492</a></th><td class=""line-code""><pre>                *rcode = kDNSFlag1_RC_NotAuth;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1493""><a href=""#L1493"">1493</a></th><td class=""line-code""><pre>                *tcode = TSIG_ErrBadTime;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1494""><a href=""#L1494"">1494</a></th><td class=""line-code""><pre>                ok = mDNSfalse;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1495""><a href=""#L1495"">1495</a></th><td class=""line-code""><pre>                <span class=""r"">goto</span> exit;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1496""><a href=""#L1496"">1496</a></th><td class=""line-code""><pre>                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1497""><a href=""#L1497"">1497</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1498""><a href=""#L1498"">1498</a></th><td class=""line-code""><pre>        <span class=""c"">// MAC size</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1499""><a href=""#L1499"">1499</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1500""><a href=""#L1500"">1500</a></th><td class=""line-code""><pre>        macsize = (mDNSu32) NToH16(ptr);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1501""><a href=""#L1501"">1501</a></th><td class=""line-code""><pre>        
</pre></td></tr>


<tr><th class=""line-num"" id=""L1502""><a href=""#L1502"">1502</a></th><td class=""line-code""><pre>        ptr += <span class=""r"">sizeof</span>(mDNSu16);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1503""><a href=""#L1503"">1503</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1504""><a href=""#L1504"">1504</a></th><td class=""line-code""><pre>        <span class=""c"">// MAC</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1505""><a href=""#L1505"">1505</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1506""><a href=""#L1506"">1506</a></th><td class=""line-code""><pre>        mDNSPlatformMemCopy(thatDigest, ptr, MD5_LEN);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1507""><a href=""#L1507"">1507</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1508""><a href=""#L1508"">1508</a></th><td class=""line-code""><pre>        <span class=""c"">// Init MD5 context, digest inner key pad and message</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1509""><a href=""#L1509"">1509</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1510""><a href=""#L1510"">1510</a></th><td class=""line-code""><pre>        MD5_Init(&amp;c);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1511""><a href=""#L1511"">1511</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, info-&gt;keydata_ipad, HMAC_LEN);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1512""><a href=""#L1512"">1512</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, (mDNSu8*) msg, (<span class=""pt"">unsigned</span> <span class=""pt"">long</span>)(end - (mDNSu8*) msg));
</pre></td></tr>


<tr><th class=""line-num"" id=""L1513""><a href=""#L1513"">1513</a></th><td class=""line-code""><pre>           
</pre></td></tr>


<tr><th class=""line-num"" id=""L1514""><a href=""#L1514"">1514</a></th><td class=""line-code""><pre>        <span class=""c"">// Key name</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1515""><a href=""#L1515"">1515</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1516""><a href=""#L1516"">1516</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, lcr-&gt;r.resrec.name-&gt;c, DomainNameLength(lcr-&gt;r.resrec.name));
</pre></td></tr>


<tr><th class=""line-num"" id=""L1517""><a href=""#L1517"">1517</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1518""><a href=""#L1518"">1518</a></th><td class=""line-code""><pre>        <span class=""c"">// Class name</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1519""><a href=""#L1519"">1519</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1520""><a href=""#L1520"">1520</a></th><td class=""line-code""><pre>        buf = mDNSOpaque16fromIntVal(lcr-&gt;r.resrec.rrclass);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1521""><a href=""#L1521"">1521</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, buf.b, <span class=""r"">sizeof</span>(mDNSOpaque16));
</pre></td></tr>


<tr><th class=""line-num"" id=""L1522""><a href=""#L1522"">1522</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1523""><a href=""#L1523"">1523</a></th><td class=""line-code""><pre>        <span class=""c"">// TTL</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1524""><a href=""#L1524"">1524</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1525""><a href=""#L1525"">1525</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, (mDNSu8*) &amp;lcr-&gt;r.resrec.rroriginalttl, <span class=""r"">sizeof</span>(lcr-&gt;r.resrec.rroriginalttl));
</pre></td></tr>


<tr><th class=""line-num"" id=""L1526""><a href=""#L1526"">1526</a></th><td class=""line-code""><pre>        
</pre></td></tr>


<tr><th class=""line-num"" id=""L1527""><a href=""#L1527"">1527</a></th><td class=""line-code""><pre>        <span class=""c"">// Algorithm</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1528""><a href=""#L1528"">1528</a></th><td class=""line-code""><pre> 
</pre></td></tr>


<tr><th class=""line-num"" id=""L1529""><a href=""#L1529"">1529</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, algo-&gt;c, DomainNameLength(algo));
</pre></td></tr>


<tr><th class=""line-num"" id=""L1530""><a href=""#L1530"">1530</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1531""><a href=""#L1531"">1531</a></th><td class=""line-code""><pre>        <span class=""c"">// Time</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1532""><a href=""#L1532"">1532</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1533""><a href=""#L1533"">1533</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, utc48, <span class=""i"">6</span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1534""><a href=""#L1534"">1534</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1535""><a href=""#L1535"">1535</a></th><td class=""line-code""><pre>        <span class=""c"">// Fudge</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1536""><a href=""#L1536"">1536</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1537""><a href=""#L1537"">1537</a></th><td class=""line-code""><pre>        buf = mDNSOpaque16fromIntVal(fudge);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1538""><a href=""#L1538"">1538</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, buf.b, <span class=""r"">sizeof</span>(mDNSOpaque16));
</pre></td></tr>


<tr><th class=""line-num"" id=""L1539""><a href=""#L1539"">1539</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1540""><a href=""#L1540"">1540</a></th><td class=""line-code""><pre>        <span class=""c"">// Digest error and other data len (both zero) - we'll add them to the rdata later</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1541""><a href=""#L1541"">1541</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1542""><a href=""#L1542"">1542</a></th><td class=""line-code""><pre>        buf.NotAnInteger = <span class=""i"">0</span>;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1543""><a href=""#L1543"">1543</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, buf.b, <span class=""r"">sizeof</span>(mDNSOpaque16));  <span class=""c"">// error</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1544""><a href=""#L1544"">1544</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, buf.b, <span class=""r"">sizeof</span>(mDNSOpaque16));  <span class=""c"">// other data len</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1545""><a href=""#L1545"">1545</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1546""><a href=""#L1546"">1546</a></th><td class=""line-code""><pre>        <span class=""c"">// Finish the message &amp; tsig var hash</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1547""><a href=""#L1547"">1547</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1548""><a href=""#L1548"">1548</a></th><td class=""line-code""><pre>    MD5_Final(thisDigest, &amp;c);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1549""><a href=""#L1549"">1549</a></th><td class=""line-code""><pre>        
</pre></td></tr>


<tr><th class=""line-num"" id=""L1550""><a href=""#L1550"">1550</a></th><td class=""line-code""><pre>        <span class=""c"">// perform outer MD5 (outer key pad, inner digest)</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1551""><a href=""#L1551"">1551</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1552""><a href=""#L1552"">1552</a></th><td class=""line-code""><pre>        MD5_Init(&amp;c);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1553""><a href=""#L1553"">1553</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, info-&gt;keydata_opad, HMAC_LEN);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1554""><a href=""#L1554"">1554</a></th><td class=""line-code""><pre>        MD5_Update(&amp;c, thisDigest, MD5_LEN);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1555""><a href=""#L1555"">1555</a></th><td class=""line-code""><pre>        MD5_Final(thisDigest, &amp;c);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1556""><a href=""#L1556"">1556</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1557""><a href=""#L1557"">1557</a></th><td class=""line-code""><pre>        <span class=""r"">if</span> (!mDNSPlatformMemSame(thisDigest, thatDigest, MD5_LEN))
</pre></td></tr>


<tr><th class=""line-num"" id=""L1558""><a href=""#L1558"">1558</a></th><td class=""line-code""><pre>                {
</pre></td></tr>


<tr><th class=""line-num"" id=""L1559""><a href=""#L1559"">1559</a></th><td class=""line-code""><pre>                LogMsg(<span class=""s""><span class=""dl"">&quot;</span><span class=""k"">ERROR: DNSDigest_VerifyMessage - bad signature</span><span class=""dl"">&quot;</span></span>);
</pre></td></tr>


<tr><th class=""line-num"" id=""L1560""><a href=""#L1560"">1560</a></th><td class=""line-code""><pre>                *rcode = kDNSFlag1_RC_NotAuth;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1561""><a href=""#L1561"">1561</a></th><td class=""line-code""><pre>                *tcode = TSIG_ErrBadSig;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1562""><a href=""#L1562"">1562</a></th><td class=""line-code""><pre>                ok = mDNSfalse;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1563""><a href=""#L1563"">1563</a></th><td class=""line-code""><pre>                <span class=""r"">goto</span> exit;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1564""><a href=""#L1564"">1564</a></th><td class=""line-code""><pre>                }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1565""><a href=""#L1565"">1565</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1566""><a href=""#L1566"">1566</a></th><td class=""line-code""><pre>        <span class=""c"">// set remaining rdata fields</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1567""><a href=""#L1567"">1567</a></th><td class=""line-code""><pre>        ok = mDNStrue;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1568""><a href=""#L1568"">1568</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1569""><a href=""#L1569"">1569</a></th><td class=""line-code""><pre><span class=""la"">exit:</span>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1570""><a href=""#L1570"">1570</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1571""><a href=""#L1571"">1571</a></th><td class=""line-code""><pre>        <span class=""r"">return</span> ok;
</pre></td></tr>


<tr><th class=""line-num"" id=""L1572""><a href=""#L1572"">1572</a></th><td class=""line-code""><pre>        }
</pre></td></tr>


<tr><th class=""line-num"" id=""L1573""><a href=""#L1573"">1573</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1574""><a href=""#L1574"">1574</a></th><td class=""line-code""><pre>
</pre></td></tr>


<tr><th class=""line-num"" id=""L1575""><a href=""#L1575"">1575</a></th><td class=""line-code""><pre><span class=""pp"">#ifdef</span> __cplusplus
</pre></td></tr>


<tr><th class=""line-num"" id=""L1576""><a href=""#L1576"">1576</a></th><td class=""line-code""><pre>}
</pre></td></tr>


<tr><th class=""line-num"" id=""L1577""><a href=""#L1577"">1577</a></th><td class=""line-code""><pre><span class=""pp"">#endif</span>
</pre></td></tr>


</tbody>
</table>
</div>





        
				<div style=""clear:both;""></div>
    </div>
</div>

<div id=""ajax-indicator"" style=""display:none;""><span>Loading...</span></div>
	
<div id=""footer"">
  <div class=""bgl""><div class=""bgr"">
    Powered by <a href=""http://www.redmine.org/"">Redmine</a> &copy; 2006-2011 Jean-Philippe Lang
  </div></div>
</div>
</div>
</div>

</body>
</html>
",False,
173,178,NomosTestfiles/BSD/bzip2-1.0.5.txt,bzip2-1.0.5,"Version 1.0.5 of 10 December 2007

Copyright © 1996-2007 Julian Seward

This program, bzip2, the associated library libbzip2, and all documentation, are copyright © 1996-2007 Julian Seward. All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

• Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.

• The origin of this software must not be misrepresented; you must not claim that you wrote the original software. If you use this software in a product, an acknowledgment in the product documentation would be appreciated but is not required.

• Altered source versions must be plainly marked as such, and must not be misrepresented as being the original software.

• The name of the author may not be used to endorse or promote products derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
PATENTS: To the best of my knowledge, bzip2 and libbzip2 do not use any patented algorithms. However, I do not have the resources to carry out a patent search. Therefore I cannot give any guarantee of the above statement.
",False,"```
Copyright © 1996-2007 Julian Seward

This program, bzip2, the associated library libbzip2, and all documentation, are copyright © 1996-2007 Julian Seward. All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

• Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.

• The origin of this software must not be misrepresented; you must not claim that you wrote the original software. If you use this software in a product, an acknowledgment in the product documentation would be appreciated but is not required.

• Altered source versions must be plainly marked as such, and must not be misrepresented as being the original software.

• The name of the author may not be used to endorse or promote products derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
PATENTS: To the best of my knowledge, bzip2 and libbzip2 do not use any patented algorithms. However, I do not have the resources to carry out a patent search. Therefore I cannot give any guarantee of the above statement.
```"
174,179,NomosTestfiles/BSD/bzip2-1.0.6.txt,bzip2-1.0.6,"This program, ""bzip2"", the associated library ""libbzip2"", and all documentation, are copyright (C) 1996-2010 Julian R Seward. All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.

2. The origin of this software must not be misrepresented; you must not claim that you wrote the original software. If you use this software in a product, an acknowledgment in the product documentation would be appreciated but is not required.

3. Altered source versions must be plainly marked as such, and must not be misrepresented as being the original software.

4. The name of the author may not be used to endorse or promote products derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

Julian Seward, jseward@bzip.org bzip2/libbzip2 version 1.0.6 of 6 September 2010
",False,"```
This program, ""bzip2"", the associated library ""libbzip2"", and all documentation, are copyright (C) 1996-2010 Julian R Seward. All rights reserved.

Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.

2. The origin of this software must not be misrepresented; you must not claim that you wrote the original software. If you use this software in a product, an acknowledgment in the product documentation would be appreciated but is not required.

3. Altered source versions must be plainly marked as such, and must not be misrepresented as being the original software.

4. The name of the author may not be used to endorse or promote products derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

Julian Seward, jseward@bzip.org bzip2/libbzip2 version 1.0.6 of 6 September 2010
```"
175,180,NomosTestfiles/BSD/chpst.c,BSD-3-Clause,"/*
Copyright (c) 2001-2006, Gerrit Pape
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright notice,
      this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.
   3. The name of the author may not be used to endorse or promote products
      derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO
EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

/* Busyboxed by Denys Vlasenko <vda.linux@googlemail.com> */
/* Dependencies on runit_lib.c removed */

//usage:#define chpst_trivial_usage
//usage:       ""[-vP012] [-u USER[:GRP]] [-U USER[:GRP]] [-e DIR]\n""
//usage:       ""	[-/ DIR] [-n NICE] [-m BYTES] [-d BYTES] [-o N]\n""
//usage:       ""	[-p N] [-f BYTES] [-c BYTES] PROG ARGS""
//usage:#define chpst_full_usage ""\n\n""
//usage:       ""Change the process state, run PROG\n""
//usage:     ""\n	-u USER[:GRP]	Set uid and gid""
//usage:     ""\n	-U USER[:GRP]	Set $UID and $GID in environment""
//usage:     ""\n	-e DIR		Set environment variables as specified by files""
//usage:     ""\n			in DIR: file=1st_line_of_file""
//usage:     ""\n	-/ DIR		Chroot to DIR""
//usage:     ""\n	-n NICE		Add NICE to nice value""
//usage:     ""\n	-m BYTES	Same as -d BYTES -s BYTES -l BYTES""
//usage:     ""\n	-d BYTES	Limit data segment""
//usage:     ""\n	-o N		Limit number of open files per process""
//usage:     ""\n	-p N		Limit number of processes per uid""
//usage:     ""\n	-f BYTES	Limit output file sizes""
//usage:     ""\n	-c BYTES	Limit core file size""
//usage:     ""\n	-v		Verbose""
//usage:     ""\n	-P		Create new process group""
//usage:     ""\n	-0		Close stdin""
//usage:     ""\n	-1		Close stdout""
//usage:     ""\n	-2		Close stderr""
//usage:
//usage:#define envdir_trivial_usage
//usage:       ""DIR PROG ARGS""
//usage:#define envdir_full_usage ""\n\n""
//usage:       ""Set various environment variables as specified by files\n""
//usage:       ""in the directory DIR, run PROG""
//usage:
//usage:#define envuidgid_trivial_usage
//usage:       ""USER PROG ARGS""
//usage:#define envuidgid_full_usage ""\n\n""
//usage:       ""Set $UID to USER's uid and $GID to USER's gid, run PROG""
//usage:
//usage:#define setuidgid_trivial_usage
//usage:       ""USER PROG ARGS""
//usage:#define setuidgid_full_usage ""\n\n""
//usage:       ""Set uid and gid to USER's uid and gid, drop supplementary group ids,\n""
//usage:       ""run PROG""
//usage:
//usage:#define softlimit_trivial_usage
//usage:       ""[-a BYTES] [-m BYTES] [-d BYTES] [-s BYTES] [-l BYTES]\n""
//usage:       ""	[-f BYTES] [-c BYTES] [-r BYTES] [-o N] [-p N] [-t N]\n""
//usage:       ""	PROG ARGS""
//usage:#define softlimit_full_usage ""\n\n""
//usage:       ""Set soft resource limits, then run PROG\n""
//usage:     ""\n	-a BYTES	Limit total size of all segments""
//usage:     ""\n	-m BYTES	Same as -d BYTES -s BYTES -l BYTES -a BYTES""
//usage:     ""\n	-d BYTES	Limit data segment""
//usage:     ""\n	-s BYTES	Limit stack segment""
//usage:     ""\n	-l BYTES	Limit locked memory size""
//usage:     ""\n	-o N		Limit number of open files per process""
//usage:     ""\n	-p N		Limit number of processes per uid""
//usage:     ""\nOptions controlling file sizes:""
//usage:     ""\n	-f BYTES	Limit output file sizes""
//usage:     ""\n	-c BYTES	Limit core file size""
//usage:     ""\nEfficiency opts:""
//usage:     ""\n	-r BYTES	Limit resident set size""
//usage:     ""\n	-t N		Limit CPU time, process receives""
//usage:     ""\n			a SIGXCPU after N seconds""

#include ""libbb.h""
#include <sys/resource.h> /* getrlimit */

/*
Five applets here: chpst, envdir, envuidgid, setuidgid, softlimit.

Only softlimit and chpst are taking options:

# common
-o N            Limit number of open files per process
-p N            Limit number of processes per uid
-m BYTES        Same as -d BYTES -s BYTES -l BYTES [-a BYTES]
-d BYTES        Limit data segment
-f BYTES        Limit output file sizes
-c BYTES        Limit core file size
# softlimit
-a BYTES        Limit total size of all segments
-s BYTES        Limit stack segment
-l BYTES        Limit locked memory size
-r BYTES        Limit resident set size
-t N            Limit CPU time
# chpst
-u USER[:GRP]   Set uid and gid
-U USER[:GRP]   Set $UID and $GID in environment
-e DIR          Set environment variables as specified by files in DIR
-/ DIR          Chroot to DIR
-n NICE         Add NICE to nice value
-v              Verbose
-P              Create new process group
-0 -1 -2        Close fd 0,1,2

Even though we accept all these options for both softlimit and chpst,
they are not to be advertised on their help texts.
We have enough problems with feature creep in other people's
software, don't want to add our own.

envdir, envuidgid, setuidgid take no options, but they reuse code which
handles -e, -U and -u.
*/

enum {
	OPT_a = (1 << 0) * ENABLE_SOFTLIMIT,
	OPT_c = (1 << 1) * (ENABLE_SOFTLIMIT || ENABLE_CHPST),
	OPT_d = (1 << 2) * (ENABLE_SOFTLIMIT || ENABLE_CHPST),
	OPT_f = (1 << 3) * (ENABLE_SOFTLIMIT || ENABLE_CHPST),
	OPT_l = (1 << 4) * ENABLE_SOFTLIMIT,
	OPT_m = (1 << 5) * (ENABLE_SOFTLIMIT || ENABLE_CHPST),
	OPT_o = (1 << 6) * (ENABLE_SOFTLIMIT || ENABLE_CHPST),
	OPT_p = (1 << 7) * (ENABLE_SOFTLIMIT || ENABLE_CHPST),
	OPT_r = (1 << 8) * ENABLE_SOFTLIMIT,
	OPT_s = (1 << 9) * ENABLE_SOFTLIMIT,
	OPT_t = (1 << 10) * ENABLE_SOFTLIMIT,
	OPT_u = (1 << 11) * (ENABLE_CHPST || ENABLE_SETUIDGID),
	OPT_U = (1 << 12) * (ENABLE_CHPST || ENABLE_ENVUIDGID),
	OPT_e = (1 << 13) * (ENABLE_CHPST || ENABLE_ENVDIR),
	OPT_root = (1 << 14) * ENABLE_CHPST,
	OPT_n = (1 << 15) * ENABLE_CHPST,
	OPT_v = (1 << 16) * ENABLE_CHPST,
	OPT_P = (1 << 17) * ENABLE_CHPST,
	OPT_0 = (1 << 18) * ENABLE_CHPST,
	OPT_1 = (1 << 19) * ENABLE_CHPST,
	OPT_2 = (1 << 20) * ENABLE_CHPST,
};

/* TODO: use recursive_action? */
static NOINLINE void edir(const char *directory_name)
{
	int wdir;
	DIR *dir;
	struct dirent *d;
	int fd;

	wdir = xopen(""."", O_RDONLY | O_NDELAY);
	xchdir(directory_name);
	dir = xopendir(""."");
	for (;;) {
		char buf[256];
		char *tail;
		int size;

		errno = 0;
		d = readdir(dir);
		if (!d) {
			if (errno)
				bb_perror_msg_and_die(""readdir %s"",
						directory_name);
			break;
		}
		if (d->d_name[0] == '.')
			continue;
		fd = open(d->d_name, O_RDONLY | O_NDELAY);
		if (fd < 0) {
			if ((errno == EISDIR) && directory_name) {
				if (option_mask32 & OPT_v)
					bb_perror_msg(""warning: %s/%s is a directory"",
						directory_name, d->d_name);
				continue;
			}
			bb_perror_msg_and_die(""open %s/%s"",
						directory_name, d->d_name);
		}
		size = full_read(fd, buf, sizeof(buf)-1);
		close(fd);
		if (size < 0)
			bb_perror_msg_and_die(""read %s/%s"",
					directory_name, d->d_name);
		if (size == 0) {
			unsetenv(d->d_name);
			continue;
		}
		buf[size] = '\n';
		tail = strchr(buf, '\n');
		/* skip trailing whitespace */
		while (1) {
			*tail = '\0';
			tail--;
			if (tail < buf || !isspace(*tail))
				break;
		}
		xsetenv(d->d_name, buf);
	}
	closedir(dir);
	if (fchdir(wdir) == -1)
		bb_perror_msg_and_die(""fchdir"");
	close(wdir);
}

static void limit(int what, long l)
{
	struct rlimit r;

	/* Never fails under Linux (except if you pass it bad arguments) */
	getrlimit(what, &r);
	if ((l < 0) || (l > r.rlim_max))
		r.rlim_cur = r.rlim_max;
	else
		r.rlim_cur = l;
	if (setrlimit(what, &r) == -1)
		bb_perror_msg_and_die(""setrlimit"");
}

int chpst_main(int argc, char **argv) MAIN_EXTERNALLY_VISIBLE;
int chpst_main(int argc UNUSED_PARAM, char **argv)
{
	struct bb_uidgid_t ugid;
	char *set_user = set_user; /* for compiler */
	char *env_user = env_user;
	char *env_dir = env_dir;
	char *root;
	char *nicestr;
	unsigned limita;
	unsigned limitc;
	unsigned limitd;
	unsigned limitf;
	unsigned limitl;
	unsigned limitm;
	unsigned limito;
	unsigned limitp;
	unsigned limitr;
	unsigned limits;
	unsigned limitt;
	unsigned opt;

	if ((ENABLE_CHPST && applet_name[0] == 'c')
	 || (ENABLE_SOFTLIMIT && applet_name[1] == 'o')
	) {
		// FIXME: can we live with int-sized limits?
		// can we live with 40000 days?
		// if yes -> getopt converts strings to numbers for us
		opt_complementary = ""-1:a+:c+:d+:f+:l+:m+:o+:p+:r+:s+:t+"";
		opt = getopt32(argv, ""+a:c:d:f:l:m:o:p:r:s:t:u:U:e:""
			IF_CHPST(""/:n:vP012""),
			&limita, &limitc, &limitd, &limitf, &limitl,
			&limitm, &limito, &limitp, &limitr, &limits, &limitt,
			&set_user, &env_user, &env_dir
			IF_CHPST(, &root, &nicestr));
		argv += optind;
		if (opt & OPT_m) { // -m means -asld
			limita = limits = limitl = limitd = limitm;
			opt |= (OPT_s | OPT_l | OPT_a | OPT_d);
		}
	} else {
		option_mask32 = opt = 0;
		argv++;
		if (!*argv)
			bb_show_usage();
	}

	// envdir?
	if (ENABLE_ENVDIR && applet_name[3] == 'd') {
		env_dir = *argv++;
		opt |= OPT_e;
	}

	// setuidgid?
	if (ENABLE_SETUIDGID && applet_name[1] == 'e') {
		set_user = *argv++;
		opt |= OPT_u;
	}

	// envuidgid?
	if (ENABLE_ENVUIDGID && applet_name[0] == 'e' && applet_name[3] == 'u') {
		env_user = *argv++;
		opt |= OPT_U;
	}

	// we must have PROG [ARGS]
	if (!*argv)
		bb_show_usage();

	// set limits
	if (opt & OPT_d) {
#ifdef RLIMIT_DATA
		limit(RLIMIT_DATA, limitd);
#else
		if (opt & OPT_v)
			bb_error_msg(""system does not support RLIMIT_%s"",
				""DATA"");
#endif
	}
	if (opt & OPT_s) {
#ifdef RLIMIT_STACK
		limit(RLIMIT_STACK, limits);
#else
		if (opt & OPT_v)
			bb_error_msg(""system does not support RLIMIT_%s"",
				""STACK"");
#endif
	}
	if (opt & OPT_l) {
#ifdef RLIMIT_MEMLOCK
		limit(RLIMIT_MEMLOCK, limitl);
#else
		if (opt & OPT_v)
			bb_error_msg(""system does not support RLIMIT_%s"",
				""MEMLOCK"");
#endif
	}
	if (opt & OPT_a) {
#ifdef RLIMIT_VMEM
		limit(RLIMIT_VMEM, limita);
#else
#ifdef RLIMIT_AS
		limit(RLIMIT_AS, limita);
#else
		if (opt & OPT_v)
			bb_error_msg(""system does not support RLIMIT_%s"",
				""VMEM"");
#endif
#endif
	}
	if (opt & OPT_o) {
#ifdef RLIMIT_NOFILE
		limit(RLIMIT_NOFILE, limito);
#else
#ifdef RLIMIT_OFILE
		limit(RLIMIT_OFILE, limito);
#else
		if (opt & OPT_v)
			bb_error_msg(""system does not support RLIMIT_%s"",
				""NOFILE"");
#endif
#endif
	}
	if (opt & OPT_p) {
#ifdef RLIMIT_NPROC
		limit(RLIMIT_NPROC, limitp);
#else
		if (opt & OPT_v)
			bb_error_msg(""system does not support RLIMIT_%s"",
				""NPROC"");
#endif
	}
	if (opt & OPT_f) {
#ifdef RLIMIT_FSIZE
		limit(RLIMIT_FSIZE, limitf);
#else
		if (opt & OPT_v)
			bb_error_msg(""system does not support RLIMIT_%s"",
				""FSIZE"");
#endif
	}
	if (opt & OPT_c) {
#ifdef RLIMIT_CORE
		limit(RLIMIT_CORE, limitc);
#else
		if (opt & OPT_v)
			bb_error_msg(""system does not support RLIMIT_%s"",
				""CORE"");
#endif
	}
	if (opt & OPT_r) {
#ifdef RLIMIT_RSS
		limit(RLIMIT_RSS, limitr);
#else
		if (opt & OPT_v)
			bb_error_msg(""system does not support RLIMIT_%s"",
				""RSS"");
#endif
	}
	if (opt & OPT_t) {
#ifdef RLIMIT_CPU
		limit(RLIMIT_CPU, limitt);
#else
		if (opt & OPT_v)
			bb_error_msg(""system does not support RLIMIT_%s"",
				""CPU"");
#endif
	}

	if (opt & OPT_P)
		setsid();

	if (opt & OPT_e)
		edir(env_dir);

	if (opt & (OPT_u|OPT_U))
		xget_uidgid(&ugid, set_user);

	// chrooted jail must have /etc/passwd if we move this after chroot.
	// OTOH chroot fails for non-roots.
	// Solution: cache uid/gid before chroot, apply uid/gid after.
	if (opt & OPT_U) {
		xsetenv(""GID"", utoa(ugid.gid));
		xsetenv(""UID"", utoa(ugid.uid));
	}

	if (opt & OPT_root) {
		xchroot(root);
	}

	if (opt & OPT_u) {
		if (setgroups(1, &ugid.gid) == -1)
			bb_perror_msg_and_die(""setgroups"");
		xsetgid(ugid.gid);
		xsetuid(ugid.uid);
	}

	if (opt & OPT_n) {
		errno = 0;
		if (nice(xatoi(nicestr)) == -1)
			bb_perror_msg_and_die(""nice"");
	}

	if (opt & OPT_0)
		close(STDIN_FILENO);
	if (opt & OPT_1)
		close(STDOUT_FILENO);
	if (opt & OPT_2)
		close(STDERR_FILENO);

	BB_EXECVP_or_die(argv);
}
",False,"```
Copyright (c) 2001-2006, Gerrit Pape
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright notice,
      this list of conditions and the following disclaimer.
   2. Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.
   3. The name of the author may not be used to endorse or promote products
      derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO
EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
176,181,NomosTestfiles/BSD/DARPA-Cougaar_a.txt,DARPA-Cougaar,"/**
* <copyright>
* Copyright 1997-2002 BBNT Solutions, LLC
* under sponsorship of the Defense Advanced Research Projects Agency (DARPA).
*
* This program is free software; you can redistribute it and/or modify
* it under the terms of the Cougaar Open Source License as published by
* DARPA on the Cougaar Open Source Website (www.cougaar.org).
*
* THE COUGAAR SOFTWARE AND ANY DERIVATIVE SUPPLIED BY LICENSOR IS
* PROVIDED 'AS IS' WITHOUT WARRANTIES OF ANY KIND, WHETHER EXPRESS OR
* IMPLIED, INCLUDING (BUT NOT LIMITED TO) ALL IMPLIED WARRANTIES OF
* MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE, AND WITHOUT
* ANY WARRANTIES AS TO NON-INFRINGEMENT. IN NO EVENT SHALL COPYRIGHT
* HOLDER BE LIABLE FOR ANY DIRECT, SPECIAL, INDIRECT OR CONSEQUENTIAL
* DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE OF DATA OR PROFITS,
* TORTIOUS CONDUCT, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
* PERFORMANCE OF THE COUGAAR SOFTWARE.
* </copyright>
*
* Created on Aug 26, 2002
*/",False,"```
* <copyright>
* Copyright 1997-2002 BBNT Solutions, LLC
* under sponsorship of the Defense Advanced Research Projects Agency (DARPA).
*
* This program is free software; you can redistribute it and/or modify
* it under the terms of the Cougaar Open Source License as published by
* DARPA on the Cougaar Open Source Website (www.cougaar.org).
*
* THE COUGAAR SOFTWARE AND ANY DERIVATIVE SUPPLIED BY LICENSOR IS
* PROVIDED 'AS IS' WITHOUT WARRANTIES OF ANY KIND, WHETHER EXPRESS OR
* IMPLIED, INCLUDING (BUT NOT LIMITED TO) ALL IMPLIED WARRANTIES OF
* MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE, AND WITHOUT
* ANY WARRANTIES AS TO NON-INFRINGEMENT. IN NO EVENT SHALL COPYRIGHT
* HOLDER BE LIABLE FOR ANY DIRECT, SPECIAL, INDIRECT OR CONSEQUENTIAL
* DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE OF DATA OR PROFITS,
* TORTIOUS CONDUCT, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
* PERFORMANCE OF THE COUGAAR SOFTWARE.
* </copyright>
*
* Created on Aug 26, 2002
```"
177,182,NomosTestfiles/BSD/DARPA-Cougaar_b.txt,DARPA-Cougaar,"Cougaar Open Source License 

The Cougaar Open Source License (COSL) is a modified version of the OSI 
approved BSD License. Sections 3 and 4 have been modified. 

COSL License : 

Redistribution and use in source and binary forms, with or without 
modification, are permitted provided that the following conditions 
are met: 

1. Redistributions of source code must retain the original author's copyright notice, 
this list of conditions and the following disclaimer. 

2. Redistributions in binary form must reproduce the original author's copyright 
notice, this list of conditions and the following disclaimer in the 
documentation and/or other materials provided with the distribution. 

3. The end-user documentation included with the redistribution, if 
any, must include the following acknowledgement: ""This product includes 
software developed in part by support from the Defense Advanced Research 
Project Agency (DARPA)."" 

4. Neither the name of the DARPA nor the names of its contributors may 
be used to endorse or promote products derived from this software without 
specific prior written permission. 

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 
""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT 
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR 
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT 
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED 
TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR 
PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF 
LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING 
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS 
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.",False,"```
Cougaar Open Source License 

The Cougaar Open Source License (COSL) is a modified version of the OSI 
approved BSD License. Sections 3 and 4 have been modified. 

COSL License : 

Redistribution and use in source and binary forms, with or without 
modification, are permitted provided that the following conditions 
are met: 

1. Redistributions of source code must retain the original author's copyright notice, 
this list of conditions and the following disclaimer. 

2. Redistributions in binary form must reproduce the original author's copyright 
notice, this list of conditions and the following disclaimer in the 
documentation and/or other materials provided with the distribution. 

3. The end-user documentation included with the redistribution, if 
any, must include the following acknowledgement: ""This product includes 
software developed in part by support from the Defense Advanced Research 
Project Agency (DARPA)."" 

4. Neither the name of the DARPA nor the names of its contributors may 
be used to endorse or promote products derived from this software without 
specific prior written permission. 

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 
""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT 
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR 
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT 
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED 
TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR 
PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF 
LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING 
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS 
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
178,183,NomosTestfiles/BSD/defconfig,"BSD
GPL
LGPL","# Example wpa_supplicant build time configuration
#
# This file lists the configuration options that are used when building the
# hostapd binary. All lines starting with # are ignored. Configuration option
# lines must be commented out complete, if they are not to be included, i.e.,
# just setting VARIABLE=n is not disabling that variable.
#
# This file is included in Makefile, so variables like CFLAGS and LIBS can also
# be modified from here. In most cases, these lines should use += in order not
# to override previous values of the variables.


# Uncomment following two lines and fix the paths if you have installed OpenSSL
# or GnuTLS in non-default location
#CFLAGS += -I/usr/local/openssl/include
#LIBS += -L/usr/local/openssl/lib

# Some Red Hat versions seem to include kerberos header files from OpenSSL, but
# the kerberos files are not in the default include path. Following line can be
# used to fix build issues on such systems (krb5.h not found).
#CFLAGS += -I/usr/include/kerberos

# Example configuration for various cross-compilation platforms

#### sveasoft (e.g., for Linksys WRT54G) ######################################
#CC=mipsel-uclibc-gcc
#CC=/opt/brcm/hndtools-mipsel-uclibc/bin/mipsel-uclibc-gcc
#CFLAGS += -Os
#CPPFLAGS += -I../src/include -I../../src/router/openssl/include
#LIBS += -L/opt/brcm/hndtools-mipsel-uclibc-0.9.19/lib -lssl
###############################################################################

#### openwrt (e.g., for Linksys WRT54G) #######################################
#CC=mipsel-uclibc-gcc
#CC=/opt/brcm/hndtools-mipsel-uclibc/bin/mipsel-uclibc-gcc
#CFLAGS += -Os
#CPPFLAGS=-I../src/include -I../openssl-0.9.7d/include \
#	-I../WRT54GS/release/src/include
#LIBS = -lssl
###############################################################################


# Driver interface for Host AP driver
CONFIG_DRIVER_HOSTAP=y

# Driver interface for Agere driver
#CONFIG_DRIVER_HERMES=y
# Change include directories to match with the local setup
#CFLAGS += -I../../hcf -I../../include -I../../include/hcf
#CFLAGS += -I../../include/wireless

# Driver interface for madwifi driver
#CONFIG_DRIVER_MADWIFI=y
# Change include directories to match with the local setup
#CFLAGS += -I../madwifi/wpa

# Driver interface for Prism54 driver
# (Note: Prism54 is not yet supported, i.e., this will not work as-is and is
# for developers only)
#CONFIG_DRIVER_PRISM54=y

# Driver interface for ndiswrapper
#CONFIG_DRIVER_NDISWRAPPER=y

# Driver interface for Atmel driver
CONFIG_DRIVER_ATMEL=y

# Driver interface for Broadcom driver
#CONFIG_DRIVER_BROADCOM=y
# Example path for wlioctl.h; change to match your configuration
#CFLAGS += -I/opt/WRT54GS/release/src/include

# Driver interface for Intel ipw2100/2200 driver
#CONFIG_DRIVER_IPW=y

# Driver interface for generic Linux wireless extensions
CONFIG_DRIVER_WEXT=y

# Driver interface for FreeBSD net80211 layer (e.g., Atheros driver)
#CONFIG_DRIVER_BSD=y
#CFLAGS += -I/usr/local/include
#LIBS += -L/usr/local/lib

# Driver interface for Windows NDIS
#CONFIG_DRIVER_NDIS=y
#CFLAGS += -I/usr/include/w32api/ddk
#LIBS += -L/usr/local/lib
# For native build using mingw
#CONFIG_NATIVE_WINDOWS=y
# Additional directories for cross-compilation on Linux host for mingw target
#CFLAGS += -I/opt/mingw/mingw32/include/ddk
#LIBS += -L/opt/mingw/mingw32/lib
#CC=mingw32-gcc
# By default, driver_ndis uses WinPcap for low-level operations. This can be
# replaced with the following option which replaces WinPcap calls with NDISUIO.
# However, this requires that WZC is disabled (net stop wzcsvc) before starting
# wpa_supplicant.
# CONFIG_USE_NDISUIO=y

# Driver interface for development testing
#CONFIG_DRIVER_TEST=y

# Driver interface for wired Ethernet drivers
CONFIG_DRIVER_WIRED=y

# Enable IEEE 802.1X Supplicant (automatically included if any EAP method is
# included)
CONFIG_IEEE8021X_EAPOL=y

# EAP-MD5
CONFIG_EAP_MD5=y

# EAP-MSCHAPv2
CONFIG_EAP_MSCHAPV2=y

# EAP-TLS
CONFIG_EAP_TLS=y

# EAL-PEAP
CONFIG_EAP_PEAP=y

# EAP-TTLS
CONFIG_EAP_TTLS=y

# EAP-FAST
# Note: Default OpenSSL package does not include support for all the
# functionality needed for EAP-FAST. If EAP-FAST is enabled with OpenSSL,
# the OpenSSL library must be patched (openssl-0.9.8d-tls-extensions.patch)
# to add the needed functions.
#CONFIG_EAP_FAST=y

# EAP-GTC
CONFIG_EAP_GTC=y

# EAP-OTP
CONFIG_EAP_OTP=y

# EAP-SIM (enable CONFIG_PCSC, if EAP-SIM is used)
#CONFIG_EAP_SIM=y

# EAP-PSK (experimental; this is _not_ needed for WPA-PSK)
#CONFIG_EAP_PSK=y

# EAP-PAX
#CONFIG_EAP_PAX=y

# LEAP
CONFIG_EAP_LEAP=y

# EAP-AKA (enable CONFIG_PCSC, if EAP-AKA is used)
#CONFIG_EAP_AKA=y

# EAP-SAKE
#CONFIG_EAP_SAKE=y

# EAP-GPSK
#CONFIG_EAP_GPSK=y
# Include support for optional SHA256 cipher suite in EAP-GPSK
#CONFIG_EAP_GPSK_SHA256=y

# PKCS#12 (PFX) support (used to read private key and certificate file from
# a file that usually has extension .p12 or .pfx)
CONFIG_PKCS12=y

# Smartcard support (i.e., private key on a smartcard), e.g., with openssl
# engine.
CONFIG_SMARTCARD=y

# PC/SC interface for smartcards (USIM, GSM SIM)
# Enable this if EAP-SIM or EAP-AKA is included
#CONFIG_PCSC=y

# Development testing
#CONFIG_EAPOL_TEST=y

# Select control interface backend for external programs, e.g, wpa_cli:
# unix = UNIX domain sockets (default for Linux/*BSD)
# udp = UDP sockets using localhost (127.0.0.1)
# named_pipe = Windows Named Pipe (default for Windows)
# y = use default (backwards compatibility)
# If this option is commented out, control interface is not included in the
# build.
CONFIG_CTRL_IFACE=y

# Include support for GNU Readline and History Libraries in wpa_cli.
# When building a wpa_cli binary for distribution, please note that these
# libraries are licensed under GPL and as such, BSD license may not apply for
# the resulting binary.
#CONFIG_READLINE=y

# Remove debugging code that is printing out debug message to stdout.
# This can be used to reduce the size of the wpa_supplicant considerably
# if debugging code is not needed. The size reduction can be around 35%
# (e.g., 90 kB).
#CONFIG_NO_STDOUT_DEBUG=y

# Remove WPA support, e.g., for wired-only IEEE 802.1X supplicant, to save
# 35-50 kB in code size.
#CONFIG_NO_WPA=y

# Remove WPA2 support. This allows WPA to be used, but removes WPA2 code to
# save about 1 kB in code size when building only WPA-Personal (no EAP support)
# or 6 kB if building for WPA-Enterprise.
#CONFIG_NO_WPA2=y

# Remove AES extra functions. This can be used to reduce code size by about
# 1.5 kB by removing extra AES modes that are not needed for commonly used
# client configurations (they are needed for some EAP types).
#CONFIG_NO_AES_EXTRAS=y

# Select configuration backend:
# file = text file (e.g., wpa_supplicant.conf)
# winreg = Windows registry (see win_example.reg for an example)
CONFIG_BACKEND=file

# Select program entry point implementation:
# main = UNIX/POSIX like main() function (default)
# main_winsvc = Windows service (read parameters from registry)
# main_none = Very basic example (development use only)
#CONFIG_MAIN=main

# Select wrapper for operatins system and C library specific functions
# unix = UNIX/POSIX like systems (default)
# win32 = Windows systems
# none = Empty template
#CONFIG_OS=unix

# Select event loop implementation
# eloop = select() loop (default)
# eloop_win = Windows events and WaitForMultipleObject() loop
# eloop_none = Empty template
#CONFIG_ELOOP=eloop

# Select layer 2 packet implementation
# linux = Linux packet socket (default)
# pcap = libpcap/libdnet/WinPcap
# freebsd = FreeBSD libpcap
# winpcap = WinPcap with receive thread
# ndis = Windows NDISUIO (note: requires CONFIG_USE_NDISUIO=y)
# none = Empty template
#CONFIG_L2_PACKET=linux

# PeerKey handshake for Station to Station Link (IEEE 802.11e DLS)
CONFIG_PEERKEY=y

# IEEE 802.11w (management frame protection)
# This version is an experimental implementation based on IEEE 802.11w/D1.0
# draft and is subject to change since the standard has not yet been finalized.
# Driver support is also needed for IEEE 802.11w.
#CONFIG_IEEE80211W=y

# Select TLS implementation
# openssl = OpenSSL (default)
# gnutls = GnuTLS (needed for TLS/IA, see also CONFIG_GNUTLS_EXTRA)
# internal = Internal TLSv1 implementation (experimental)
# none = Empty template
#CONFIG_TLS=openssl

# Whether to enable TLS/IA support, which is required for EAP-TTLSv1.
# You need CONFIG_TLS=gnutls for this to have any effect. Please note that
# even though the core GnuTLS library is released under LGPL, this extra
# library uses GPL and as such, the terms of GPL apply to the combination
# of wpa_supplicant and GnuTLS if this option is enabled. BSD license may not
# apply for distribution of the resulting binary.
#CONFIG_GNUTLS_EXTRA=y

# If CONFIG_TLS=internal is used, additional library and include paths are
# needed for LibTomMath. Alternatively, an integrated, minimal version of
# LibTomMath can be used. See beginning of libtommath.c for details on benefits
# and drawbacks of this option.
#CONFIG_INTERNAL_LIBTOMMATH=y
#ifndef CONFIG_INTERNAL_LIBTOMMATH
#LTM_PATH=/usr/src/libtommath-0.39
#CFLAGS += -I$(LTM_PATH)
#LIBS += -L$(LTM_PATH)
#LIBS_p += -L$(LTM_PATH)
#endif

# Include NDIS event processing through WMI into wpa_supplicant/wpasvc.
# This is only for Windows builds and requires WMI-related header files and
# WbemUuid.Lib from Platform SDK even when building with MinGW.
#CONFIG_NDIS_EVENTS_INTEGRATED=y
#PLATFORMSDKLIB=""/opt/Program Files/Microsoft Platform SDK/Lib""

# Add support for DBus control interface
#CONFIG_CTRL_IFACE_DBUS=y

# Add support for loading EAP methods dynamically as shared libraries.
# When this option is enabled, each EAP method can be either included
# statically (CONFIG_EAP_<method>=y) or dynamically (CONFIG_EAP_<method>=dyn).
# Dynamic EAP methods are build as shared objects (eap_*.so) and they need to
# be loaded in the beginning of the wpa_supplicant configuration file
# (see load_dynamic_eap parameter in the example file) before being used in
# the network blocks.
#
# Note that some shared parts of EAP methods are included in the main program
# and in order to be able to use dynamic EAP methods using these parts, the
# main program must have been build with the EAP method enabled (=y or =dyn).
# This means that EAP-TLS/PEAP/TTLS/FAST cannot be added as dynamic libraries
# unless at least one of them was included in the main build to force inclusion
# of the shared code. Similarly, at least one of EAP-SIM/AKA must be included
# in the main build to be able to load these methods dynamically.
#
# Please also note that using dynamic libraries will increase the total binary
# size. Thus, it may not be the best option for targets that have limited
# amount of memory/flash.
#CONFIG_DYNAMIC_EAP_METHODS=y

# Include client MLME (management frame processing).
# This can be used to move MLME processing of Devicescape IEEE 802.11 stack
# into user space.
#CONFIG_CLIENT_MLME=y
# Currently, driver_devicescape.c build requires some additional parameters
# to be able to include some of the kernel header files. Following lines can
# be used to set these (WIRELESS_DEV must point to the root directory of the
# wireless-dev.git tree).
#WIRELESS_DEV=/usr/src/wireless-dev
#CFLAGS += -I$(WIRELESS_DEV)/net/mac80211
",False,"```
# Example wpa_supplicant build time configuration
#
# This file lists the configuration options that are used when building the
# hostapd binary. All lines starting with # are ignored. Configuration option
# lines must be commented out complete, if they are not to be included, i.e.,
# just setting VARIABLE=n is not disabling that variable.
#
# This file is included in Makefile, so variables like CFLAGS and LIBS can also
# be modified from here. In most cases, these lines should use += in order not
# to override previous values of the variables.


# Select configuration backend:
# file = text file (e.g., wpa_supplicant.conf)
# winreg = Windows registry (see win_example.reg for an example)
CONFIG_BACKEND=file

# Select program entry point implementation:
# main = UNIX/POSIX like main() function (default)
# main_winsvc = Windows service (read parameters from registry)
# main_none = Very basic example (development use only)
#CONFIG_MAIN=main

# Select wrapper for operatins system and C library specific functions
# unix = UNIX/POSIX like systems (default)
# win32 = Windows systems
# none = Empty template
#CONFIG_OS=unix

# Select event loop implementation
# eloop = select() loop (default)
# eloop_win = Windows events and WaitForMultipleObject() loop
# eloop_none = Empty template
#CONFIG_ELOOP=eloop

# Select layer 2 packet implementation
# linux = Linux packet socket (default)
# pcap = libpcap/libdnet/WinPcap
# freebsd = FreeBSD libpcap
# winpcap = WinPcap with receive thread
# ndis = Windows NDISUIO (note: requires CONFIG_USE_NDISUIO=y)
# none = Empty template
#CONFIG_L2_PACKET=linux

# PeerKey handshake for Station to Station Link (IEEE 802.11e DLS)
CONFIG_PEERKEY=y

# IEEE 802.11w (management frame protection)
# This version is an experimental implementation based on IEEE 802.11w/D1.0
# draft and is subject to change since the standard has not yet been finalized.
# Driver support is also needed for IEEE 802.11w.
#CONFIG_IEEE80211W=y

# Select TLS implementation
# openssl = OpenSSL (default)
# gnutls = GnuTLS (needed for TLS/IA, see also CONFIG_GNUTLS_EXTRA)
# internal = Internal TLSv1 implementation (experimental)
# none = Empty template
#CONFIG_TLS=openssl

# Whether to enable TLS/IA support, which is required for EAP-TTLSv1.
# You need CONFIG_TLS=gnutls for this to have any effect. Please note that
# even though the core GnuTLS library is released under LGPL, this extra
# library uses GPL and as such, the terms of GPL apply to the combination
# of wpa_supplicant and GnuTLS if this option is enabled. BSD license may not
# apply for distribution of the resulting binary.
#CONFIG_GNUTLS_EXTRA=y

# If CONFIG_TLS=internal is used, additional library and include paths are
# needed for LibTomMath. Alternatively, an integrated, minimal version of
# LibTomMath can be used. See beginning of libtommath.c for details on benefits
# and drawbacks of this option.
#CONFIG_INTERNAL_LIBTOMMATH=y
#ifndef CONFIG_INTERNAL_LIBTOMMATH
#LTM_PATH=/usr/src/libtommath-0.39
#CFLAGS += -I$(LTM_PATH)
#LIBS += -L$(LTM_PATH)
#LIBS_p += -L$(LTM_PATH)
#endif

# Include NDIS event processing through WMI into wpa_supplicant/wpasvc.
# This is only for Windows builds and requires WMI-related header files and
# WbemUuid.Lib from Platform SDK even when building with MinGW.
#CONFIG_NDIS_EVENTS_INTEGRATED=y
#PLATFORMSDKLIB=""/opt/Program Files/Microsoft Platform SDK/Lib""

# Add support for DBus control interface
#CONFIG_CTRL_IFACE_DBUS=y

# Add support for loading EAP methods dynamically as shared libraries.
# When this option is enabled, each EAP method can be either included
# statically (CONFIG_EAP_<method>=y) or dynamically (CONFIG_EAP_<method>=dyn).
# Dynamic EAP methods are build as shared objects (eap_*.so) and they need to
# be loaded in the beginning of the wpa_supplicant configuration file
# (see load_dynamic_eap parameter in the example file) before being used in
# the network blocks.
#
# Note that some shared parts of EAP methods are included in the main program
# and in order to be able to use dynamic EAP methods using these parts, the
# main program must have been build with the EAP method enabled (=y or =dyn).
# This means that EAP-TLS/PEAP/TTLS/FAST cannot be added as dynamic libraries
# unless at least one of them was included in the main build to force inclusion
# of the shared code. Similarly, at least one of EAP-SIM/AKA must be included
# in the main build to be able to load these methods dynamically.
#
# Please also note that using dynamic libraries will increase the total binary
# size. Thus, it may not be the best option for targets that have limited
# amount of memory/flash.
#CONFIG_DYNAMIC_EAP_METHODS=y

# Include client MLME (management frame processing).
# This can be used to move MLME processing of Devicescape IEEE 802.11 stack
# into user space.
#CONFIG_CLIENT_MLME=y
# Currently, driver_devicescape.c build requires some additional parameters
# to be able to include some of the kernel header files. Following lines can
# be used to set these (WIRELESS_DEV must point to the root directory of the
# wireless-dev.git tree).
#WIRELESS_DEV=/usr/src/wireless-dev
#CFLAGS += -I$(WIRELESS_DEV)/net/mac80211



```"
179,184,NomosTestfiles/BSD/destest.c,SSLeay,"/* crypto/des/destest.c */
/* Copyright (C) 1995-1997 Eric Young (eay@mincom.oz.au)
 * All rights reserved.
 *
 * This package is an SSL implementation written
 * by Eric Young (eay@mincom.oz.au).
 * The implementation was written so as to conform with Netscapes SSL.
 * 
 * This library is free for commercial and non-commercial use as long as
 * the following conditions are aheared to.  The following conditions
 * apply to all code found in this distribution, be it the RC4, RSA,
 * lhash, DES, etc., code; not just the SSL code.  The SSL documentation
 * included with this distribution is covered by the same copyright terms
 * except that the holder is Tim Hudson (tjh@mincom.oz.au).
 * 
 * Copyright remains Eric Young's, and as such any Copyright notices in
 * the code are not to be removed.
 * If this package is used in a product, Eric Young should be given attribution
 * as the author of the parts of the library used.
 * This can be in the form of a textual message at program startup or
 * in documentation (online or textual) provided with the package.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *    ""This product includes cryptographic software written by
 *     Eric Young (eay@mincom.oz.au)""
 *    The word 'cryptographic' can be left out if the rouines from the library
 *    being used are not cryptographic related :-).
 * 4. If you include any Windows specific code (or a derivative thereof) from 
 *    the apps directory (application code) you must include an acknowledgement:
 *    ""This product includes software written by Tim Hudson (tjh@mincom.oz.au)""
 * 
 * THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 * 
 * The licence and distribution terms for any publically available version or
 * derivative of this code cannot be changed.  i.e. this code cannot simply be
 * copied and put under another distribution licence
 * [including the GNU Public Licence.]
 */

#ifdef HAVE_CONFIG_H
#include <config.h>
#endif

#if defined(WIN32) || defined(WIN16) || defined(WINDOWS)
#ifndef MSDOS
#define MSDOS
#endif
#endif

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#ifdef HAVE_UNISTD_H
#include <unistd.h>
#endif
#ifdef HAVE_IO_H
#include <io.h>
#endif

#include ""des.h""

/* tisk tisk - the test keys don't all have odd parity :-( */
/* test data */
#define NUM_TESTS 34
static unsigned char key_data[NUM_TESTS][8]={
	{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
	{0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF},
	{0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
	{0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11},
	{0x01,0x23,0x45,0x67,0x89,0xAB,0xCD,0xEF},
	{0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11},
	{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
	{0xFE,0xDC,0xBA,0x98,0x76,0x54,0x32,0x10},
	{0x7C,0xA1,0x10,0x45,0x4A,0x1A,0x6E,0x57},
	{0x01,0x31,0xD9,0x61,0x9D,0xC1,0x37,0x6E},
	{0x07,0xA1,0x13,0x3E,0x4A,0x0B,0x26,0x86},
	{0x38,0x49,0x67,0x4C,0x26,0x02,0x31,0x9E},
	{0x04,0xB9,0x15,0xBA,0x43,0xFE,0xB5,0xB6},
	{0x01,0x13,0xB9,0x70,0xFD,0x34,0xF2,0xCE},
	{0x01,0x70,0xF1,0x75,0x46,0x8F,0xB5,0xE6},
	{0x43,0x29,0x7F,0xAD,0x38,0xE3,0x73,0xFE},
	{0x07,0xA7,0x13,0x70,0x45,0xDA,0x2A,0x16},
	{0x04,0x68,0x91,0x04,0xC2,0xFD,0x3B,0x2F},
	{0x37,0xD0,0x6B,0xB5,0x16,0xCB,0x75,0x46},
	{0x1F,0x08,0x26,0x0D,0x1A,0xC2,0x46,0x5E},
	{0x58,0x40,0x23,0x64,0x1A,0xBA,0x61,0x76},
	{0x02,0x58,0x16,0x16,0x46,0x29,0xB0,0x07},
	{0x49,0x79,0x3E,0xBC,0x79,0xB3,0x25,0x8F},
	{0x4F,0xB0,0x5E,0x15,0x15,0xAB,0x73,0xA7},
	{0x49,0xE9,0x5D,0x6D,0x4C,0xA2,0x29,0xBF},
	{0x01,0x83,0x10,0xDC,0x40,0x9B,0x26,0xD6},
	{0x1C,0x58,0x7F,0x1C,0x13,0x92,0x4F,0xEF},
	{0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01},
	{0x1F,0x1F,0x1F,0x1F,0x0E,0x0E,0x0E,0x0E},
	{0xE0,0xFE,0xE0,0xFE,0xF1,0xFE,0xF1,0xFE},
	{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
	{0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF},
	{0x01,0x23,0x45,0x67,0x89,0xAB,0xCD,0xEF},
	{0xFE,0xDC,0xBA,0x98,0x76,0x54,0x32,0x10}};

static unsigned char plain_data[NUM_TESTS][8]={
	{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
	{0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF},
	{0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x01},
	{0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11},
	{0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11},
	{0x01,0x23,0x45,0x67,0x89,0xAB,0xCD,0xEF},
	{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
	{0x01,0x23,0x45,0x67,0x89,0xAB,0xCD,0xEF},
	{0x01,0xA1,0xD6,0xD0,0x39,0x77,0x67,0x42},
	{0x5C,0xD5,0x4C,0xA8,0x3D,0xEF,0x57,0xDA},
	{0x02,0x48,0xD4,0x38,0x06,0xF6,0x71,0x72},
	{0x51,0x45,0x4B,0x58,0x2D,0xDF,0x44,0x0A},
	{0x42,0xFD,0x44,0x30,0x59,0x57,0x7F,0xA2},
	{0x05,0x9B,0x5E,0x08,0x51,0xCF,0x14,0x3A},
	{0x07,0x56,0xD8,0xE0,0x77,0x47,0x61,0xD2},
	{0x76,0x25,0x14,0xB8,0x29,0xBF,0x48,0x6A},
	{0x3B,0xDD,0x11,0x90,0x49,0x37,0x28,0x02},
	{0x26,0x95,0x5F,0x68,0x35,0xAF,0x60,0x9A},
	{0x16,0x4D,0x5E,0x40,0x4F,0x27,0x52,0x32},
	{0x6B,0x05,0x6E,0x18,0x75,0x9F,0x5C,0xCA},
	{0x00,0x4B,0xD6,0xEF,0x09,0x17,0x60,0x62},
	{0x48,0x0D,0x39,0x00,0x6E,0xE7,0x62,0xF2},
	{0x43,0x75,0x40,0xC8,0x69,0x8F,0x3C,0xFA},
	{0x07,0x2D,0x43,0xA0,0x77,0x07,0x52,0x92},
	{0x02,0xFE,0x55,0x77,0x81,0x17,0xF1,0x2A},
	{0x1D,0x9D,0x5C,0x50,0x18,0xF7,0x28,0xC2},
	{0x30,0x55,0x32,0x28,0x6D,0x6F,0x29,0x5A},
	{0x01,0x23,0x45,0x67,0x89,0xAB,0xCD,0xEF},
	{0x01,0x23,0x45,0x67,0x89,0xAB,0xCD,0xEF},
	{0x01,0x23,0x45,0x67,0x89,0xAB,0xCD,0xEF},
	{0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF},
	{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
	{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},
	{0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF}};

static unsigned char cipher_data[NUM_TESTS][8]={
	{0x8C,0xA6,0x4D,0xE9,0xC1,0xB1,0x23,0xA7},
	{0x73,0x59,0xB2,0x16,0x3E,0x4E,0xDC,0x58},
	{0x95,0x8E,0x6E,0x62,0x7A,0x05,0x55,0x7B},
	{0xF4,0x03,0x79,0xAB,0x9E,0x0E,0xC5,0x33},
	{0x17,0x66,0x8D,0xFC,0x72,0x92,0x53,0x2D},
	{0x8A,0x5A,0xE1,0xF8,0x1A,0xB8,0xF2,0xDD},
	{0x8C,0xA6,0x4D,0xE9,0xC1,0xB1,0x23,0xA7},
	{0xED,0x39,0xD9,0x50,0xFA,0x74,0xBC,0xC4},
	{0x69,0x0F,0x5B,0x0D,0x9A,0x26,0x93,0x9B},
	{0x7A,0x38,0x9D,0x10,0x35,0x4B,0xD2,0x71},
	{0x86,0x8E,0xBB,0x51,0xCA,0xB4,0x59,0x9A},
	{0x71,0x78,0x87,0x6E,0x01,0xF1,0x9B,0x2A},
	{0xAF,0x37,0xFB,0x42,0x1F,0x8C,0x40,0x95},
	{0x86,0xA5,0x60,0xF1,0x0E,0xC6,0xD8,0x5B},
	{0x0C,0xD3,0xDA,0x02,0x00,0x21,0xDC,0x09},
	{0xEA,0x67,0x6B,0x2C,0xB7,0xDB,0x2B,0x7A},
	{0xDF,0xD6,0x4A,0x81,0x5C,0xAF,0x1A,0x0F},
	{0x5C,0x51,0x3C,0x9C,0x48,0x86,0xC0,0x88},
	{0x0A,0x2A,0xEE,0xAE,0x3F,0xF4,0xAB,0x77},
	{0xEF,0x1B,0xF0,0x3E,0x5D,0xFA,0x57,0x5A},
	{0x88,0xBF,0x0D,0xB6,0xD7,0x0D,0xEE,0x56},
	{0xA1,0xF9,0x91,0x55,0x41,0x02,0x0B,0x56},
	{0x6F,0xBF,0x1C,0xAF,0xCF,0xFD,0x05,0x56},
	{0x2F,0x22,0xE4,0x9B,0xAB,0x7C,0xA1,0xAC},
	{0x5A,0x6B,0x61,0x2C,0xC2,0x6C,0xCE,0x4A},
	{0x5F,0x4C,0x03,0x8E,0xD1,0x2B,0x2E,0x41},
	{0x63,0xFA,0xC0,0xD0,0x34,0xD9,0xF7,0x93},
	{0x61,0x7B,0x3A,0x0C,0xE8,0xF0,0x71,0x00},
	{0xDB,0x95,0x86,0x05,0xF8,0xC8,0xC6,0x06},
	{0xED,0xBF,0xD1,0xC6,0x6C,0x29,0xCC,0xC7},
	{0x35,0x55,0x50,0xB2,0x15,0x0E,0x24,0x51},
	{0xCA,0xAA,0xAF,0x4D,0xEA,0xF1,0xDB,0xAE},
	{0xD5,0xD4,0x4F,0xF7,0x20,0x68,0x3D,0x0D},
	{0x2A,0x2B,0xB0,0x08,0xDF,0x97,0xC2,0xF2}};

static unsigned char cipher_ecb2[NUM_TESTS-1][8]={
	{0x92,0x95,0xB5,0x9B,0xB3,0x84,0x73,0x6E},
	{0x19,0x9E,0x9D,0x6D,0xF3,0x9A,0xA8,0x16},
	{0x2A,0x4B,0x4D,0x24,0x52,0x43,0x84,0x27},
	{0x35,0x84,0x3C,0x01,0x9D,0x18,0xC5,0xB6},
	{0x4A,0x5B,0x2F,0x42,0xAA,0x77,0x19,0x25},
	{0xA0,0x6B,0xA9,0xB8,0xCA,0x5B,0x17,0x8A},
	{0xAB,0x9D,0xB7,0xFB,0xED,0x95,0xF2,0x74},
	{0x3D,0x25,0x6C,0x23,0xA7,0x25,0x2F,0xD6},
	{0xB7,0x6F,0xAB,0x4F,0xBD,0xBD,0xB7,0x67},
	{0x8F,0x68,0x27,0xD6,0x9C,0xF4,0x1A,0x10},
	{0x82,0x57,0xA1,0xD6,0x50,0x5E,0x81,0x85},
	{0xA2,0x0F,0x0A,0xCD,0x80,0x89,0x7D,0xFA},
	{0xCD,0x2A,0x53,0x3A,0xDB,0x0D,0x7E,0xF3},
	{0xD2,0xC2,0xBE,0x27,0xE8,0x1B,0x68,0xE3},
	{0xE9,0x24,0xCF,0x4F,0x89,0x3C,0x5B,0x0A},
	{0xA7,0x18,0xC3,0x9F,0xFA,0x9F,0xD7,0x69},
	{0x77,0x2C,0x79,0xB1,0xD2,0x31,0x7E,0xB1},
	{0x49,0xAB,0x92,0x7F,0xD0,0x22,0x00,0xB7},
	{0xCE,0x1C,0x6C,0x7D,0x85,0xE3,0x4A,0x6F},
	{0xBE,0x91,0xD6,0xE1,0x27,0xB2,0xE9,0x87},
	{0x70,0x28,0xAE,0x8F,0xD1,0xF5,0x74,0x1A},
	{0xAA,0x37,0x80,0xBB,0xF3,0x22,0x1D,0xDE},
	{0xA6,0xC4,0xD2,0x5E,0x28,0x93,0xAC,0xB3},
	{0x22,0x07,0x81,0x5A,0xE4,0xB7,0x1A,0xAD},
	{0xDC,0xCE,0x05,0xE7,0x07,0xBD,0xF5,0x84},
	{0x26,0x1D,0x39,0x2C,0xB3,0xBA,0xA5,0x85},
	{0xB4,0xF7,0x0F,0x72,0xFB,0x04,0xF0,0xDC},
	{0x95,0xBA,0xA9,0x4E,0x87,0x36,0xF2,0x89},
	{0xD4,0x07,0x3A,0xF1,0x5A,0x17,0x82,0x0E},
	{0xEF,0x6F,0xAF,0xA7,0x66,0x1A,0x7E,0x89},
	{0xC1,0x97,0xF5,0x58,0x74,0x8A,0x20,0xE7},
	{0x43,0x34,0xCF,0xDA,0x22,0xC4,0x86,0xC8},
	{0x08,0xD7,0xB4,0xFB,0x62,0x9D,0x08,0x85}};

static unsigned char cbc_key [8]={0x01,0x23,0x45,0x67,0x89,0xab,0xcd,0xef};
static unsigned char cbc2_key[8]={0xf0,0xe1,0xd2,0xc3,0xb4,0xa5,0x96,0x87};
static unsigned char cbc3_key[8]={0xfe,0xdc,0xba,0x98,0x76,0x54,0x32,0x10};
static unsigned char cbc_iv  [8]={0xfe,0xdc,0xba,0x98,0x76,0x54,0x32,0x10};
static char cbc_data[40]=""7654321 Now is the time for "";

static unsigned char cbc_ok[32]={
	0xcc,0xd1,0x73,0xff,0xab,0x20,0x39,0xf4,
	0xac,0xd8,0xae,0xfd,0xdf,0xd8,0xa1,0xeb,
	0x46,0x8e,0x91,0x15,0x78,0x88,0xba,0x68,
	0x1d,0x26,0x93,0x97,0xf7,0xfe,0x62,0xb4};

static unsigned char xcbc_ok[32]={
	0x86,0x74,0x81,0x0D,0x61,0xA4,0xA5,0x48,
	0xB9,0x93,0x03,0xE1,0xB8,0xBB,0xBD,0xBD,
	0x64,0x30,0x0B,0xB9,0x06,0x65,0x81,0x76,
	0x04,0x1D,0x77,0x62,0x17,0xCA,0x2B,0xD2,
	};

static unsigned char cbc3_ok[32]={
	0x3F,0xE3,0x01,0xC9,0x62,0xAC,0x01,0xD0,
	0x22,0x13,0x76,0x3C,0x1C,0xBD,0x4C,0xDC,
	0x79,0x96,0x57,0xC0,0x64,0xEC,0xF5,0xD4,
	0x1C,0x67,0x38,0x12,0xCF,0xDE,0x96,0x75};

static unsigned char pcbc_ok[32]={
	0xcc,0xd1,0x73,0xff,0xab,0x20,0x39,0xf4,
	0x6d,0xec,0xb4,0x70,0xa0,0xe5,0x6b,0x15,
	0xae,0xa6,0xbf,0x61,0xed,0x7d,0x9c,0x9f,
	0xf7,0x17,0x46,0x3b,0x8a,0xb3,0xcc,0x88};

static unsigned char cfb_key[8]={0x01,0x23,0x45,0x67,0x89,0xab,0xcd,0xef};
static unsigned char cfb_iv[8]={0x12,0x34,0x56,0x78,0x90,0xab,0xcd,0xef};
static unsigned char cfb_buf1[40],cfb_buf2[40],cfb_tmp[8];
static unsigned char plain[24]=
	{
	0x4e,0x6f,0x77,0x20,0x69,0x73,
	0x20,0x74,0x68,0x65,0x20,0x74,
	0x69,0x6d,0x65,0x20,0x66,0x6f,
	0x72,0x20,0x61,0x6c,0x6c,0x20
	};
static unsigned char cfb_cipher8[24]= {
	0xf3,0x1f,0xda,0x07,0x01,0x14, 0x62,0xee,0x18,0x7f,0x43,0xd8,
	0x0a,0x7c,0xd9,0xb5,0xb0,0xd2, 0x90,0xda,0x6e,0x5b,0x9a,0x87 };
static unsigned char cfb_cipher16[24]={
	0xF3,0x09,0x87,0x87,0x7F,0x57, 0xF7,0x3C,0x36,0xB6,0xDB,0x70,
	0xD8,0xD5,0x34,0x19,0xD3,0x86, 0xB2,0x23,0xB7,0xB2,0xAD,0x1B };
static unsigned char cfb_cipher32[24]={
	0xF3,0x09,0x62,0x49,0xA4,0xDF, 0xA4,0x9F,0x33,0xDC,0x7B,0xAD,
	0x4C,0xC8,0x9F,0x64,0xE4,0x53, 0xE5,0xEC,0x67,0x20,0xDA,0xB6 };
static unsigned char cfb_cipher48[24]={
	0xF3,0x09,0x62,0x49,0xC7,0xF4, 0x30,0xB5,0x15,0xEC,0xBB,0x85,
	0x97,0x5A,0x13,0x8C,0x68,0x60, 0xE2,0x38,0x34,0x3C,0xDC,0x1F };
static unsigned char cfb_cipher64[24]={
	0xF3,0x09,0x62,0x49,0xC7,0xF4, 0x6E,0x51,0xA6,0x9E,0x83,0x9B,
	0x1A,0x92,0xF7,0x84,0x03,0x46, 0x71,0x33,0x89,0x8E,0xA6,0x22 };

static unsigned char ofb_key[8]={0x01,0x23,0x45,0x67,0x89,0xab,0xcd,0xef};
static unsigned char ofb_iv[8]={0x12,0x34,0x56,0x78,0x90,0xab,0xcd,0xef};
static unsigned char ofb_buf1[24],ofb_buf2[24],ofb_tmp[8];
static unsigned char ofb_cipher[24]=
	{
	0xf3,0x09,0x62,0x49,0xc7,0xf4,0x6e,0x51,
	0x35,0xf2,0x4a,0x24,0x2e,0xeb,0x3d,0x3f,
	0x3d,0x6d,0x5b,0xe3,0x25,0x5a,0xf8,0xc3
	};

DES_LONG cbc_cksum_ret=0xB462FEF7L;
unsigned char cbc_cksum_data[8]={0x1D,0x26,0x93,0x97,0xf7,0xfe,0x62,0xb4};

#ifndef NOPROTO
static char *pt(unsigned char *p);
static int cfb_test(int bits, unsigned char *cfb_cipher);
static int cfb64_test(unsigned char *cfb_cipher);
static int ede_cfb64_test(unsigned char *cfb_cipher);
#else
static char *pt();
static int cfb_test();
static int cfb64_test();
static int ede_cfb64_test();
#endif

int main(argc,argv)
int argc;
char *argv[];
	{
	int i,j,err=0;
	des_cblock in,out,outin,iv3;
	des_key_schedule ks,ks2,ks3;
	unsigned char cbc_in[40];
	unsigned char cbc_out[40];
	DES_LONG cs;
	unsigned char cret[8];
	DES_LONG lqret[4];
	int num;
	char *str;

	printf(""Doing ecb\n"");
	for (i=0; i<NUM_TESTS; i++)
		{
		if ((j=des_key_sched((C_Block *)(key_data[i]),ks)) != 0)
			{
			printf(""Key error %2d:%d\n"",i+1,j);
			err=1;
			}
		memcpy(in,plain_data[i],8);
		memset(out,0,8);
		memset(outin,0,8);
		des_ecb_encrypt((C_Block *)in,(C_Block *)out,ks,DES_ENCRYPT);
		des_ecb_encrypt((C_Block *)out,(C_Block *)outin,ks,DES_DECRYPT);

		if (memcmp(out,cipher_data[i],8) != 0)
			{
			printf(""Encryption error %2d\nk=%s p=%s o=%s act=%s\n"",
				i+1,pt(key_data[i]),pt(in),pt(cipher_data[i]),
				pt(out));
			err=1;
			}
		if (memcmp(in,outin,8) != 0)
			{
			printf(""Decryption error %2d\nk=%s p=%s o=%s act=%s\n"",
				i+1,pt(key_data[i]),pt(out),pt(in),pt(outin));
			err=1;
			}
		}

#ifndef LIBDES_LIT
	printf(""Doing ede ecb\n"");
	for (i=0; i<(NUM_TESTS-1); i++)
		{
		if ((j=des_key_sched((C_Block *)(key_data[i]),ks)) != 0)
			{
			err=1;
			printf(""Key error %2d:%d\n"",i+1,j);
			}
		if ((j=des_key_sched((C_Block *)(key_data[i+1]),ks2)) != 0)
			{
			printf(""Key error %2d:%d\n"",i+2,j);
			err=1;
			}
		if ((j=des_key_sched((C_Block *)(key_data[i+2]),ks3)) != 0)
			{
			printf(""Key error %2d:%d\n"",i+3,j);
			err=1;
			}
		memcpy(in,plain_data[i],8);
		memset(out,0,8);
		memset(outin,0,8);
		des_ecb2_encrypt((C_Block *)in,(C_Block *)out,ks,ks2,
			DES_ENCRYPT);
		des_ecb2_encrypt((C_Block *)out,(C_Block *)outin,ks,ks2,
			DES_DECRYPT);

		if (memcmp(out,cipher_ecb2[i],8) != 0)
			{
			printf(""Encryption error %2d\nk=%s p=%s o=%s act=%s\n"",
				i+1,pt(key_data[i]),pt(in),pt(cipher_ecb2[i]),
				pt(out));
			err=1;
			}
		if (memcmp(in,outin,8) != 0)
			{
			printf(""Decryption error %2d\nk=%s p=%s o=%s act=%s\n"",
				i+1,pt(key_data[i]),pt(out),pt(in),pt(outin));
			err=1;
			}
		}
#endif

	printf(""Doing cbc\n"");
	if ((j=des_key_sched((C_Block *)cbc_key,ks)) != 0)
		{
		printf(""Key error %d\n"",j);
		err=1;
		}
	memset(cbc_out,0,40);
	memset(cbc_in,0,40);
	des_cbc_encrypt((C_Block *)cbc_data,(C_Block *)cbc_out,
		(long)strlen((char *)cbc_data)+1,ks,
		(C_Block *)cbc_iv,DES_ENCRYPT);
	if (memcmp(cbc_out,cbc_ok,32) != 0)
		printf(""cbc_encrypt encrypt error\n"");
	des_cbc_encrypt((C_Block *)cbc_out,(C_Block *)cbc_in,
		(long)strlen((char *)cbc_data)+1,ks,
		(C_Block *)cbc_iv,DES_DECRYPT);
	if (memcmp(cbc_in,cbc_data,strlen((char *)cbc_data)) != 0)
		{
		printf(""cbc_encrypt decrypt error\n"");
		err=1;
		}

#ifndef LIBDES_LIT
	printf(""Doing desx cbc\n"");
	if ((j=des_key_sched((C_Block *)cbc_key,ks)) != 0)
		{
		printf(""Key error %d\n"",j);
		err=1;
		}
	memset(cbc_out,0,40);
	memset(cbc_in,0,40);
	memcpy(iv3,cbc_iv,sizeof(cbc_iv));
	des_xcbc_encrypt((C_Block *)cbc_data,(C_Block *)cbc_out,
		(long)strlen((char *)cbc_data)+1,ks,
		(C_Block *)iv3,
		(C_Block *)cbc2_key, (C_Block *)cbc3_key, DES_ENCRYPT);
	if (memcmp(cbc_out,xcbc_ok,32) != 0)
		{
		printf(""des_xcbc_encrypt encrypt error\n"");
		}
	memcpy(iv3,cbc_iv,sizeof(cbc_iv));
	des_xcbc_encrypt((C_Block *)cbc_out,(C_Block *)cbc_in,
		(long)strlen((char *)cbc_data)+1,ks,
		(C_Block *)iv3,
		(C_Block *)cbc2_key, (C_Block *)cbc3_key, DES_DECRYPT);
	if (memcmp(cbc_in,cbc_data,32) != 0)
		{
		printf(""des_xcbc_encrypt decrypt error\n"");
		err=1;
		}
#endif

	printf(""Doing ede cbc\n"");
	if ((j=des_key_sched((C_Block *)cbc_key,ks)) != 0)
		{
		printf(""Key error %d\n"",j);
		err=1;
		}
	if ((j=des_key_sched((C_Block *)cbc2_key,ks2)) != 0)
		{
		printf(""Key error %d\n"",j);
		err=1;
		}
	if ((j=des_key_sched((C_Block *)cbc3_key,ks3)) != 0)
		{
		printf(""Key error %d\n"",j);
		err=1;
		}
	memset(cbc_out,0,40);
	memset(cbc_in,0,40);
	i=strlen((char *)cbc_data)+1;
	i=((i+7)/8)*8;
	memcpy(iv3,cbc_iv,sizeof(cbc_iv));

	des_ede3_cbc_encrypt((C_Block *)cbc_data,(C_Block *)cbc_out,
		16L,ks,ks2,ks3,(C_Block *)iv3,DES_ENCRYPT);
	des_ede3_cbc_encrypt((C_Block *)&(cbc_data[16]),
		(C_Block *)&(cbc_out[16]),
		(long)i-16,ks,ks2,ks3,(C_Block *)iv3,DES_ENCRYPT);
	if (memcmp(cbc_out,cbc3_ok,
		(unsigned int)(strlen((char *)cbc_data)+1+7)/8*8) != 0)
		{
		printf(""des_ede3_cbc_encrypt encrypt error\n"");
		err=1;
		}

	memcpy(iv3,cbc_iv,sizeof(cbc_iv));
	des_ede3_cbc_encrypt((C_Block *)cbc_out,(C_Block *)cbc_in,
		(long)i,ks,ks2,ks3,(C_Block *)iv3,DES_DECRYPT);
	if (memcmp(cbc_in,cbc_data,strlen(cbc_data)+1) != 0)
		{
		printf(""des_ede3_cbc_encrypt decrypt error\n"");
		err=1;
		}

#ifndef LIBDES_LIT
	printf(""Doing pcbc\n"");
	if ((j=des_key_sched((C_Block *)cbc_key,ks)) != 0)
		{
		printf(""Key error %d\n"",j);
		err=1;
		}
	memset(cbc_out,0,40);
	memset(cbc_in,0,40);
	des_pcbc_encrypt((C_Block *)cbc_data,(C_Block *)cbc_out,
		(long)strlen(cbc_data)+1,ks,(C_Block *)cbc_iv,DES_ENCRYPT);
	if (memcmp(cbc_out,pcbc_ok,32) != 0)
		{
		printf(""pcbc_encrypt encrypt error\n"");
		err=1;
		}
	des_pcbc_encrypt((C_Block *)cbc_out,(C_Block *)cbc_in,
		(long)strlen(cbc_data)+1,ks,(C_Block *)cbc_iv,DES_DECRYPT);
	if (memcmp(cbc_in,cbc_data,32) != 0)
		{
		printf(""pcbc_encrypt decrypt error\n"");
		err=1;
		}

	printf(""Doing "");
	printf(""cfb8 "");
	err+=cfb_test(8,cfb_cipher8);
	printf(""cfb16 "");
	err+=cfb_test(16,cfb_cipher16);
	printf(""cfb32 "");
	err+=cfb_test(32,cfb_cipher32);
	printf(""cfb48 "");
	err+=cfb_test(48,cfb_cipher48);
	printf(""cfb64 "");
	err+=cfb_test(64,cfb_cipher64);

	printf(""cfb64() "");
	err+=cfb64_test(cfb_cipher64);

	memcpy(cfb_tmp,cfb_iv,sizeof(cfb_iv));
	for (i=0; i<sizeof(plain); i++)
		des_cfb_encrypt(&(plain[i]),&(cfb_buf1[i]),
			8,(long)1,ks,(C_Block *)cfb_tmp,DES_ENCRYPT);
	if (memcmp(cfb_cipher8,cfb_buf1,sizeof(plain)) != 0)
		{
		printf(""cfb_encrypt small encrypt error\n"");
		err=1;
		}

	memcpy(cfb_tmp,cfb_iv,sizeof(cfb_iv));
	for (i=0; i<sizeof(plain); i++)
		des_cfb_encrypt(&(cfb_buf1[i]),&(cfb_buf2[i]),
			8,(long)1,ks,(C_Block *)cfb_tmp,DES_DECRYPT);
	if (memcmp(plain,cfb_buf2,sizeof(plain)) != 0)
		{
		printf(""cfb_encrypt small decrypt error\n"");
		err=1;
		}

	printf(""ede_cfb64() "");
	err+=ede_cfb64_test(cfb_cipher64);

	printf(""done\n"");

	printf(""Doing ofb\n"");
	des_key_sched((C_Block *)ofb_key,ks);
	memcpy(ofb_tmp,ofb_iv,sizeof(ofb_iv));
	des_ofb_encrypt(plain,ofb_buf1,64,(long)sizeof(plain)/8,ks,
		(C_Block *)ofb_tmp);
	if (memcmp(ofb_cipher,ofb_buf1,sizeof(ofb_buf1)) != 0)
		{
		printf(""ofb_encrypt encrypt error\n"");
		err=1;
		}
	memcpy(ofb_tmp,ofb_iv,sizeof(ofb_iv));
	des_ofb_encrypt(ofb_buf1,ofb_buf2,64,(long)sizeof(ofb_buf1)/8,ks,
		(C_Block *)ofb_tmp);
	if (memcmp(plain,ofb_buf2,sizeof(ofb_buf2)) != 0)
		{
		printf(""ofb_encrypt decrypt error\n"");
		err=1;
		}

	printf(""Doing ofb64\n"");
	des_key_sched((C_Block *)ofb_key,ks);
	memcpy(ofb_tmp,ofb_iv,sizeof(ofb_iv));
	memset(ofb_buf1,0,sizeof(ofb_buf1));
	memset(ofb_buf2,0,sizeof(ofb_buf1));
	num=0;
	for (i=0; i<sizeof(plain); i++)
		{
		des_ofb64_encrypt(&(plain[i]),&(ofb_buf1[i]),1,ks,
			(C_Block *)ofb_tmp,&num);
		}
	if (memcmp(ofb_cipher,ofb_buf1,sizeof(ofb_buf1)) != 0)
		{
		printf(""ofb64_encrypt encrypt error\n"");
		err=1;
		}
	memcpy(ofb_tmp,ofb_iv,sizeof(ofb_iv));
	num=0;
	des_ofb64_encrypt(ofb_buf1,ofb_buf2,(long)sizeof(ofb_buf1),ks,
		(C_Block *)ofb_tmp,&num);
	if (memcmp(plain,ofb_buf2,sizeof(ofb_buf2)) != 0)
		{
		printf(""ofb64_encrypt decrypt error\n"");
		err=1;
		}

	printf(""Doing ede_ofb64\n"");
	des_key_sched((C_Block *)ofb_key,ks);
	memcpy(ofb_tmp,ofb_iv,sizeof(ofb_iv));
	memset(ofb_buf1,0,sizeof(ofb_buf1));
	memset(ofb_buf2,0,sizeof(ofb_buf1));
	num=0;
	for (i=0; i<sizeof(plain); i++)
		{
		des_ede3_ofb64_encrypt(&(plain[i]),&(ofb_buf1[i]),1,ks,ks,ks,
			(C_Block *)ofb_tmp,&num);
		}
	if (memcmp(ofb_cipher,ofb_buf1,sizeof(ofb_buf1)) != 0)
		{
		printf(""ede_ofb64_encrypt encrypt error\n"");
		err=1;
		}
	memcpy(ofb_tmp,ofb_iv,sizeof(ofb_iv));
	num=0;
	des_ede3_ofb64_encrypt(ofb_buf1,ofb_buf2,(long)sizeof(ofb_buf1),ks,
		ks,ks,(C_Block *)ofb_tmp,&num);
	if (memcmp(plain,ofb_buf2,sizeof(ofb_buf2)) != 0)
		{
		printf(""ede_ofb64_encrypt decrypt error\n"");
		err=1;
		}

	printf(""Doing cbc_cksum\n"");
	des_key_sched((C_Block *)cbc_key,ks);
	cs=des_cbc_cksum((C_Block *)cbc_data,(C_Block *)cret,
		(long)strlen(cbc_data),ks,(C_Block *)cbc_iv);
	if (cs != cbc_cksum_ret)
		{
		printf(""bad return value (%08lX), should be %08lX\n"",
			(unsigned long)cs,(unsigned long)cbc_cksum_ret);
		err=1;
		}
	if (memcmp(cret,cbc_cksum_data,8) != 0)
		{
		printf(""bad cbc_cksum block returned\n"");
		err=1;
		}

	printf(""Doing quad_cksum\n"");
	cs=quad_cksum((C_Block *)cbc_data,(C_Block *)lqret,
		(long)strlen(cbc_data),2,(C_Block *)cbc_iv);
	if (cs != 0x70d7a63aL)
		{
		printf(""quad_cksum error, ret %08lx should be 70d7a63a\n"",
			(unsigned long)cs);
		err=1;
		}
	if (lqret[0] != 0x327eba8dL)
		{
		printf(""quad_cksum error, out[0] %08lx is not %08lx\n"",
			(unsigned long)lqret[0],0x327eba8dL);
		err=1;
		}
	if (lqret[1] != 0x201a49ccL)
		{
		printf(""quad_cksum error, out[1] %08lx is not %08lx\n"",
			(unsigned long)lqret[1],0x201a49ccL);
		err=1;
		}
	if (lqret[2] != 0x70d7a63aL)
		{
		printf(""quad_cksum error, out[2] %08lx is not %08lx\n"",
			(unsigned long)lqret[2],0x70d7a63aL);
		err=1;
		}
	if (lqret[3] != 0x501c2c26L)
		{
		printf(""quad_cksum error, out[3] %08lx is not %08lx\n"",
			(unsigned long)lqret[3],0x501c2c26L);
		err=1;
		}
#endif

	printf(""input word alignment test"");
	for (i=0; i<4; i++)
		{
		printf("" %d"",i);
		des_cbc_encrypt((C_Block *)&(cbc_out[i]),(C_Block *)cbc_in,
			(long)strlen(cbc_data)+1,ks,(C_Block *)cbc_iv,
			DES_ENCRYPT);
		}
	printf(""\noutput word alignment test"");
	for (i=0; i<4; i++)
		{
		printf("" %d"",i);
		des_cbc_encrypt((C_Block *)cbc_out,(C_Block *)&(cbc_in[i]),
			(long)strlen(cbc_data)+1,ks,(C_Block *)cbc_iv,
			DES_ENCRYPT);
		}
	printf(""\n"");
	printf(""fast crypt test "");
	str=crypt(""testing"",""ef"");
	if (strcmp(""efGnQx2725bI2"",str) != 0)
		{
		printf(""fast crypt error, %s should be efGnQx2725bI2\n"",str);
		err=1;
		}
	str=crypt(""bca76;23"",""yA"");
	if (strcmp(""yA1Rp/1hZXIJk"",str) != 0)
		{
		printf(""fast crypt error, %s should be yA1Rp/1hZXIJk\n"",str);
		err=1;
		}
	printf(""\n"");
	exit(err);
	return(0);
	}

static char *pt(p)
unsigned char *p;
	{
	static char bufs[10][20];
	static int bnum=0;
	char *ret;
	int i;
	static char *f=""0123456789ABCDEF"";

	ret= &(bufs[bnum++][0]);
	bnum%=10;
	for (i=0; i<8; i++)
		{
		ret[i*2]=f[(p[i]>>4)&0xf];
		ret[i*2+1]=f[p[i]&0xf];
		}
	ret[16]='\0';
	return(ret);
	}

#ifndef LIBDES_LIT

static int cfb_test(bits, cfb_cipher)
int bits;
unsigned char *cfb_cipher;
	{
	des_key_schedule ks;
	int i,err=0;

	des_key_sched((C_Block *)cfb_key,ks);
	memcpy(cfb_tmp,cfb_iv,sizeof(cfb_iv));
	des_cfb_encrypt(plain,cfb_buf1,bits,(long)sizeof(plain),ks,
		(C_Block *)cfb_tmp,DES_ENCRYPT);
	if (memcmp(cfb_cipher,cfb_buf1,sizeof(plain)) != 0)
		{
		err=1;
		printf(""cfb_encrypt encrypt error\n"");
		for (i=0; i<24; i+=8)
			printf(""%s\n"",pt(&(cfb_buf1[i])));
		}
	memcpy(cfb_tmp,cfb_iv,sizeof(cfb_iv));
	des_cfb_encrypt(cfb_buf1,cfb_buf2,bits,(long)sizeof(plain),ks,
		(C_Block *)cfb_tmp,DES_DECRYPT);
	if (memcmp(plain,cfb_buf2,sizeof(plain)) != 0)
		{
		err=1;
		printf(""cfb_encrypt decrypt error\n"");
		for (i=0; i<24; i+=8)
			printf(""%s\n"",pt(&(cfb_buf1[i])));
		}
	return(err);
	}

static int cfb64_test(cfb_cipher)
unsigned char *cfb_cipher;
	{
	des_key_schedule ks;
	int err=0,i,n;

	des_key_sched((C_Block *)cfb_key,ks);
	memcpy(cfb_tmp,cfb_iv,sizeof(cfb_iv));
	n=0;
	des_cfb64_encrypt(plain,cfb_buf1,(long)12,ks,
		(C_Block *)cfb_tmp,&n,DES_ENCRYPT);
	des_cfb64_encrypt(&(plain[12]),&(cfb_buf1[12]),
		(long)sizeof(plain)-12,ks,
		(C_Block *)cfb_tmp,&n,DES_ENCRYPT);
	if (memcmp(cfb_cipher,cfb_buf1,sizeof(plain)) != 0)
		{
		err=1;
		printf(""cfb_encrypt encrypt error\n"");
		for (i=0; i<24; i+=8)
			printf(""%s\n"",pt(&(cfb_buf1[i])));
		}
	memcpy(cfb_tmp,cfb_iv,sizeof(cfb_iv));
	n=0;
	des_cfb64_encrypt(cfb_buf1,cfb_buf2,(long)17,ks,
		(C_Block *)cfb_tmp,&n,DES_DECRYPT);
	des_cfb64_encrypt(&(cfb_buf1[17]),&(cfb_buf2[17]),
		(long)sizeof(plain)-17,ks,
		(C_Block *)cfb_tmp,&n,DES_DECRYPT);
	if (memcmp(plain,cfb_buf2,sizeof(plain)) != 0)
		{
		err=1;
		printf(""cfb_encrypt decrypt error\n"");
		for (i=0; i<24; i+=8)
			printf(""%s\n"",pt(&(cfb_buf2[i])));
		}
	return(err);
	}

static int ede_cfb64_test(cfb_cipher)
unsigned char *cfb_cipher;
	{
	des_key_schedule ks;
	int err=0,i,n;

	des_key_sched((C_Block *)cfb_key,ks);
	memcpy(cfb_tmp,cfb_iv,sizeof(cfb_iv));
	n=0;
	des_ede3_cfb64_encrypt(plain,cfb_buf1,(long)12,ks,ks,ks,
		(C_Block *)cfb_tmp,&n,DES_ENCRYPT);
	des_ede3_cfb64_encrypt(&(plain[12]),&(cfb_buf1[12]),
		(long)sizeof(plain)-12,ks,ks,ks,
		(C_Block *)cfb_tmp,&n,DES_ENCRYPT);
	if (memcmp(cfb_cipher,cfb_buf1,sizeof(plain)) != 0)
		{
		err=1;
		printf(""ede_cfb_encrypt encrypt error\n"");
		for (i=0; i<24; i+=8)
			printf(""%s\n"",pt(&(cfb_buf1[i])));
		}
	memcpy(cfb_tmp,cfb_iv,sizeof(cfb_iv));
	n=0;
	des_ede3_cfb64_encrypt(cfb_buf1,cfb_buf2,(long)17,ks,ks,ks,
		(C_Block *)cfb_tmp,&n,DES_DECRYPT);
	des_ede3_cfb64_encrypt(&(cfb_buf1[17]),&(cfb_buf2[17]),
		(long)sizeof(plain)-17,ks,ks,ks,
		(C_Block *)cfb_tmp,&n,DES_DECRYPT);
	if (memcmp(plain,cfb_buf2,sizeof(plain)) != 0)
		{
		err=1;
		printf(""ede_cfb_encrypt decrypt error\n"");
		for (i=0; i<24; i+=8)
			printf(""%s\n"",pt(&(cfb_buf2[i])));
		}
	return(err);
	}

#endif

",False,
180,185,NomosTestfiles/BSD/DoerffelBSD,BSD-style,"
 Copyright (c) 2009 Tobias Doerffel <tobias.doerffel@gmail.com>
 *
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer,
 *    without modification.
 * 2. Redistributions in binary form must reproduce at minimum a disclaimer
 *    similar to the ""NO WARRANTY"" disclaimer below (""Disclaimer"") and any
 *    redistribution must be conditioned upon including a substantially
 *    similar Disclaimer requirement for further binary redistribution.
 * 3. Neither the names of the above-listed copyright holders nor the names
 *    of any contributors may be used to endorse or promote products derived
 *    from this software without specific prior written permission.
 
",False,"```
 Copyright (c) 2009 Tobias Doerffel <tobias.doerffel@gmail.com>
 *
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer,
 *    without modification.
 * 2. Redistributions in binary form must reproduce at minimum a disclaimer
 *    similar to the ""NO WARRANTY"" disclaimer below (""Disclaimer"") and any
 *    redistribution must be conditioned upon including a substantially
 *    similar Disclaimer requirement for further binary redistribution.
 * 3. Neither the names of the above-listed copyright holders nor the names
 *    of any contributors may be used to endorse or promote products derived
 *    from this software without specific prior written permission.
```"
181,186,NomosTestfiles/BSD/endiantest.c.BSD-2,BSD-2-Clause,"/*====================================================================*
 -  Copyright (C) 2001 Leptonica.  All rights reserved.
 -
 -  Redistribution and use in source and binary forms, with or without
 -  modification, are permitted provided that the following conditions
 -  are met:
 -  1. Redistributions of source code must retain the above copyright
 -     notice, this list of conditions and the following disclaimer.
 -  2. Redistributions in binary form must reproduce the above
 -     copyright notice, this list of conditions and the following
 -     disclaimer in the documentation and/or other materials
 -     provided with the distribution.
 -
 -  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 -  ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 -  LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 -  A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL ANY
 -  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 -  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 -  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 -  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 -  OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 -  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 -  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *====================================================================*/

/* 
 *    endiantest.c
 *
 *    This test was contributed by Bill Janssen.  When used with the
 *    gnu compiler, it allows efficient computation of the endian
 *    flag as part of the normal compilation process.  As a result,
 *    it is not necessary to set this flag either manually or
 *    through the configure Makefile generator.
 */

#include <stdio.h>

int main()
{
/* fprintf(stderr, ""doing the test\n""); */
    long v = 0x04030201;
    if (*((unsigned char *)(&v)) == 0x04)
        printf(""L_BIG_ENDIAN\n"");
    else
        printf(""L_LITTLE_ENDIAN\n"");
    return 0;
}


",False,"```
 -  Copyright (C) 2001 Leptonica.  All rights reserved.
 -
 -  Redistribution and use in source and binary forms, with or without
 -  modification, are permitted provided that the following conditions
 -  are met:
 -  1. Redistributions of source code must retain the above copyright
 -     notice, this list of conditions and the following disclaimer.
 -  2. Redistributions in binary form must reproduce the above
 -     copyright notice, this list of conditions and the following
 -     disclaimer in the documentation and/or other materials
 -     provided with the distribution.
 -
 -  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 -  ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 -  LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 -  A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL ANY
 -  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 -  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 -  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 -  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 -  OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 -  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 -  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
182,187,NomosTestfiles/BSD/Epl.h,BSD-3-Clause-Severability,"/****************************************************************************

  (c) SYSTEC electronic GmbH, D-07973 Greiz, August-Bebel-Str. 29
      www.systec-electronic.com

  Project:      openPOWERLINK

  Description:  include file for EPL API layer

  License:

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions
    are met:

    1. Redistributions of source code must retain the above copyright
       notice, this list of conditions and the following disclaimer.

    2. Redistributions in binary form must reproduce the above copyright
       notice, this list of conditions and the following disclaimer in the
       documentation and/or other materials provided with the distribution.

    3. Neither the name of SYSTEC electronic GmbH nor the names of its
       contributors may be used to endorse or promote products derived
       from this software without prior written permission. For written
       permission, please contact info@systec-electronic.com.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
    COPYRIGHT HOLDERS OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
    INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
    BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
    LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
    CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
    LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
    ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
    POSSIBILITY OF SUCH DAMAGE.

    Severability Clause:

        If a provision of this License is or becomes illegal, invalid or
        unenforceable in any jurisdiction, that shall not affect:
        1. the validity or enforceability in that jurisdiction of any other
           provision of this License; or
        2. the validity or enforceability in other jurisdictions of that or
           any other provision of this License.

  -------------------------------------------------------------------------

                $RCSfile: Epl.h,v $

                $Author: D.Krueger $

                $Revision: 1.8 $  $Date: 2008/11/17 16:40:39 $

                $State: Exp $

                Build Environment:
                    GCC V3.4

  -------------------------------------------------------------------------

  Revision History:

  2006/05/22 d.k.:   start of the implementation, version 1.00

****************************************************************************/

#ifndef _EPL_API_H_
#define _EPL_API_H_

#include ""EplInc.h""
#include ""EplSdo.h""
#include ""EplObd.h""
#include ""EplLed.h""
#include ""EplEvent.h""

//---------------------------------------------------------------------------
// const defines
//---------------------------------------------------------------------------

//---------------------------------------------------------------------------
// typedef
//---------------------------------------------------------------------------

typedef struct {
	unsigned int m_uiNodeId;
	tEplNmtState m_NmtState;
	tEplNmtNodeEvent m_NodeEvent;
	WORD m_wErrorCode;	// EPL error code if m_NodeEvent == kEplNmtNodeEventError
	BOOL m_fMandatory;

} tEplApiEventNode;

typedef struct {
	tEplNmtState m_NmtState;	// local NMT state
	tEplNmtBootEvent m_BootEvent;
	WORD m_wErrorCode;	// EPL error code if m_BootEvent == kEplNmtBootEventError

} tEplApiEventBoot;

typedef struct {
	tEplLedType m_LedType;	// type of the LED (e.g. Status or Error)
	BOOL m_fOn;		// state of the LED (e.g. on or off)

} tEplApiEventLed;

typedef enum {
	kEplApiEventNmtStateChange = 0x10,	// m_NmtStateChange
//    kEplApiEventRequestNmt     = 0x11,    // m_bNmtCmd
	kEplApiEventCriticalError = 0x12,	// m_InternalError, Stack halted
	kEplApiEventWarning = 0x13,	// m_InternalError, Stack running
	kEplApiEventNode = 0x20,	// m_Node
	kEplApiEventBoot = 0x21,	// m_Boot
	kEplApiEventSdo = 0x62,	// m_Sdo
	kEplApiEventObdAccess = 0x69,	// m_ObdCbParam
	kEplApiEventLed = 0x70,	// m_Led

} tEplApiEventType;

typedef union {
	tEplEventNmtStateChange m_NmtStateChange;
	tEplEventError m_InternalError;
	tEplSdoComFinished m_Sdo;
	tEplObdCbParam m_ObdCbParam;
	tEplApiEventNode m_Node;
	tEplApiEventBoot m_Boot;
	tEplApiEventLed m_Led;

} tEplApiEventArg;

typedef tEplKernel(PUBLIC ROM * tEplApiCbEvent) (tEplApiEventType EventType_p,	// IN: event type (enum)
						 tEplApiEventArg * pEventArg_p,	// IN: event argument (union)
						 void GENERIC * pUserArg_p);

typedef struct {
	unsigned int m_uiSizeOfStruct;
	BOOL m_fAsyncOnly;	// do not need to register PRes
	unsigned int m_uiNodeId;	// local node ID
	BYTE m_abMacAddress[6];	// local MAC address

	// 0x1F82: NMT_FeatureFlags_U32
	DWORD m_dwFeatureFlags;
	// Cycle Length (0x1006: NMT_CycleLen_U32) in [us]
	DWORD m_dwCycleLen;	// required for error detection
	// 0x1F98: NMT_CycleTiming_REC
	// 0x1F98.1: IsochrTxMaxPayload_U16
	unsigned int m_uiIsochrTxMaxPayload;	// const
	// 0x1F98.2: IsochrRxMaxPayload_U16
	unsigned int m_uiIsochrRxMaxPayload;	// const
	// 0x1F98.3: PResMaxLatency_U32
	DWORD m_dwPresMaxLatency;	// const in [ns], only required for IdentRes
	// 0x1F98.4: PReqActPayloadLimit_U16
	unsigned int m_uiPreqActPayloadLimit;	// required for initialisation (+28 bytes)
	// 0x1F98.5: PResActPayloadLimit_U16
	unsigned int m_uiPresActPayloadLimit;	// required for initialisation of Pres frame (+28 bytes)
	// 0x1F98.6: ASndMaxLatency_U32
	DWORD m_dwAsndMaxLatency;	// const in [ns], only required for IdentRes
	// 0x1F98.7: MultiplCycleCnt_U8
	unsigned int m_uiMultiplCycleCnt;	// required for error detection
	// 0x1F98.8: AsyncMTU_U16
	unsigned int m_uiAsyncMtu;	// required to set up max frame size
	// 0x1F98.9: Prescaler_U16
	unsigned int m_uiPrescaler;	// required for sync
	// $$$ Multiplexed Slot

	// 0x1C14: DLL_LossOfFrameTolerance_U32 in [ns]
	DWORD m_dwLossOfFrameTolerance;

	// 0x1F8A: NMT_MNCycleTiming_REC
	// 0x1F8A.1: WaitSoCPReq_U32 in [ns]
	DWORD m_dwWaitSocPreq;

	// 0x1F8A.2: AsyncSlotTimeout_U32 in [ns]
	DWORD m_dwAsyncSlotTimeout;

	DWORD m_dwDeviceType;	// NMT_DeviceType_U32
	DWORD m_dwVendorId;	// NMT_IdentityObject_REC.VendorId_U32
	DWORD m_dwProductCode;	// NMT_IdentityObject_REC.ProductCode_U32
	DWORD m_dwRevisionNumber;	// NMT_IdentityObject_REC.RevisionNo_U32
	DWORD m_dwSerialNumber;	// NMT_IdentityObject_REC.SerialNo_U32
	QWORD m_qwVendorSpecificExt1;
	DWORD m_dwVerifyConfigurationDate;	// CFM_VerifyConfiguration_REC.ConfDate_U32
	DWORD m_dwVerifyConfigurationTime;	// CFM_VerifyConfiguration_REC.ConfTime_U32
	DWORD m_dwApplicationSwDate;	// PDL_LocVerApplSw_REC.ApplSwDate_U32 on programmable device or date portion of NMT_ManufactSwVers_VS on non-programmable device
	DWORD m_dwApplicationSwTime;	// PDL_LocVerApplSw_REC.ApplSwTime_U32 on programmable device or time portion of NMT_ManufactSwVers_VS on non-programmable device
	DWORD m_dwIpAddress;
	DWORD m_dwSubnetMask;
	DWORD m_dwDefaultGateway;
	BYTE m_sHostname[32];
	BYTE m_abVendorSpecificExt2[48];

	char *m_pszDevName;	// NMT_ManufactDevName_VS (0x1008/0 local OD)
	char *m_pszHwVersion;	// NMT_ManufactHwVers_VS  (0x1009/0 local OD)
	char *m_pszSwVersion;	// NMT_ManufactSwVers_VS  (0x100A/0 local OD)

	tEplApiCbEvent m_pfnCbEvent;
	void *m_pEventUserArg;
	tEplSyncCb m_pfnCbSync;

} tEplApiInitParam;

typedef struct {
	void *m_pImage;
	unsigned int m_uiSize;

} tEplApiProcessImage;

//---------------------------------------------------------------------------
// function prototypes
//---------------------------------------------------------------------------

tEplKernel PUBLIC EplApiInitialize(tEplApiInitParam * pInitParam_p);

tEplKernel PUBLIC EplApiShutdown(void);

tEplKernel PUBLIC EplApiReadObject(tEplSdoComConHdl * pSdoComConHdl_p,
				   unsigned int uiNodeId_p,
				   unsigned int uiIndex_p,
				   unsigned int uiSubindex_p,
				   void *pDstData_le_p,
				   unsigned int *puiSize_p,
				   tEplSdoType SdoType_p, void *pUserArg_p);

tEplKernel PUBLIC EplApiWriteObject(tEplSdoComConHdl * pSdoComConHdl_p,
				    unsigned int uiNodeId_p,
				    unsigned int uiIndex_p,
				    unsigned int uiSubindex_p,
				    void *pSrcData_le_p,
				    unsigned int uiSize_p,
				    tEplSdoType SdoType_p, void *pUserArg_p);

tEplKernel PUBLIC EplApiFreeSdoChannel(tEplSdoComConHdl SdoComConHdl_p);

tEplKernel PUBLIC EplApiReadLocalObject(unsigned int uiIndex_p,
					unsigned int uiSubindex_p,
					void *pDstData_p,
					unsigned int *puiSize_p);

tEplKernel PUBLIC EplApiWriteLocalObject(unsigned int uiIndex_p,
					 unsigned int uiSubindex_p,
					 void *pSrcData_p,
					 unsigned int uiSize_p);

tEplKernel PUBLIC EplApiCbObdAccess(tEplObdCbParam MEM * pParam_p);

tEplKernel PUBLIC EplApiLinkObject(unsigned int uiObjIndex_p,
				   void *pVar_p,
				   unsigned int *puiVarEntries_p,
				   tEplObdSize * pEntrySize_p,
				   unsigned int uiFirstSubindex_p);

tEplKernel PUBLIC EplApiExecNmtCommand(tEplNmtEvent NmtEvent_p);

tEplKernel PUBLIC EplApiProcess(void);

#if (((EPL_MODULE_INTEGRATION) & (EPL_MODULE_NMT_MN)) != 0)
tEplKernel PUBLIC EplApiMnTriggerStateChange(unsigned int uiNodeId_p,
					     tEplNmtNodeCommand NodeCommand_p);
#endif

tEplKernel PUBLIC EplApiGetIdentResponse(unsigned int uiNodeId_p,
					 tEplIdentResponse **
					 ppIdentResponse_p);

// functions for process image will be implemented in separate file
tEplKernel PUBLIC EplApiProcessImageSetup(void);
tEplKernel PUBLIC EplApiProcessImageExchangeIn(tEplApiProcessImage * pPI_p);
tEplKernel PUBLIC EplApiProcessImageExchangeOut(tEplApiProcessImage * pPI_p);

#endif // #ifndef _EPL_API_H_
",False,"```
Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:

    1. Redistributions of source code must retain the above copyright
       notice, this list of conditions and the following disclaimer.

    2. Redistributions in binary form must reproduce the above copyright
       notice, this list of conditions and the following disclaimer in the
       documentation and/or other materials provided with the distribution.

    3. Neither the name of SYSTEC electronic GmbH nor the names of its
       contributors may be used to endorse or promote products derived
       from this software without prior written permission. For written
       permission, please contact info@systec-electronic.com.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
    COPYRIGHT HOLDERS OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
    INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
    BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
    LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
    CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
    LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
    ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
    POSSIBILITY OF SUCH DAMAGE.

    Severability Clause:

        If a provision of this License is or becomes illegal, invalid or
        unenforceable in any jurisdiction, that shall not affect:
        1. the validity or enforceability in that jurisdiction of any other
           provision of this License; or
        2. the validity or enforceability in other jurisdictions of that or
           any other provision of this License.
```"
183,188,NomosTestfiles/BSD/FindUSB1.cmake,BSD,"# - Try to find the freetype library
# Once done this defines
#
#  LIBUSB_FOUND - system has libusb
#  LIBUSB_INCLUDE_DIR - the libusb include directory
#  LIBUSB_LIBRARIES - Link these to use libusb

# Copyright (c) 2006, 2008  Laurent Montel, <montel@kde.org>
#
# Redistribution and use is allowed according to the terms of the BSD license.
# For details see the accompanying COPYING-CMAKE-SCRIPTS file.


if (LIBUSB_INCLUDE_DIR AND LIBUSB_LIBRARIES)

  # in cache already
  set(LIBUSB_FOUND TRUE)

else (LIBUSB_INCLUDE_DIR AND LIBUSB_LIBRARIES)
  IF (NOT WIN32)
    # use pkg-config to get the directories and then use these values
    # in the FIND_PATH() and FIND_LIBRARY() calls
    find_package(PkgConfig)
    pkg_check_modules(PC_LIBUSB libusb-1.0)
  ENDIF(NOT WIN32)

  FIND_PATH(LIBUSB_INCLUDE_DIR libusb.h
    PATHS ${PC_LIBUSB_INCLUDEDIR} ${PC_LIBUSB_INCLUDE_DIRS})

  FIND_LIBRARY(LIBUSB_LIBRARIES NAMES usb-1.0
    PATHS ${PC_LIBUSB_LIBDIR} ${PC_LIBUSB_LIBRARY_DIRS})

  include(FindPackageHandleStandardArgs)
  FIND_PACKAGE_HANDLE_STANDARD_ARGS(LIBUSB DEFAULT_MSG LIBUSB_LIBRARIES LIBUSB_INCLUDE_DIR)

  MARK_AS_ADVANCED(LIBUSB_INCLUDE_DIR LIBUSB_LIBRARIES)

endif (LIBUSB_INCLUDE_DIR AND LIBUSB_LIBRARIES)
",False,"```
# Copyright (c) 2006, 2008  Laurent Montel, <montel@kde.org>
#
# Redistribution and use is allowed according to the terms of the BSD license.
# For details see the accompanying COPYING-CMAKE-SCRIPTS file.
```"
184,189,NomosTestfiles/BSD/HP-DEC-style.txt,HP-DEC-style,"/*
* Copyright 2000, 2001, 2002
* Broadcom Corporation. All rights reserved.
*
* This software is furnished under license and may be used and copied only
* in accordance with the following terms and conditions. Subject to these
* conditions, you may download, copy, install, use, modify and distribute
* modified or unmodified copies of this software in source and/or binary
* form. No title or ownership is transferred hereby.
*
* 1) Any source code used, modified or distributed must reproduce and
* retain this copyright notice and list of conditions as they appear in
* the source file.
*
* 2) No right is granted to use any trade name, trademark, or logo of
* Broadcom Corporation. The ""Broadcom Corporation"" name may not be
* used to endorse or promote products derived from this software
* without the prior written permission of Broadcom Corporation.
*
* 3) THIS SOFTWARE IS PROVIDED ""AS-IS"" AND ANY EXPRESS OR IMPLIED
* WARRANTIES, INCLUDING BUT NOT LIMITED TO, ANY IMPLIED WARRANTIES OF
* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR
* NON-INFRINGEMENT ARE DISCLAIMED. IN NO EVENT SHALL BROADCOM BE LIABLE
* FOR ANY DAMAGES WHATSOEVER, AND IN PARTICULAR, BROADCOM SHALL NOT BE
* LIABLE FOR DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
* CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
* SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
* BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
* OR OTHERWISE), EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
",False,"```
* Copyright 2000, 2001, 2002
* Broadcom Corporation. All rights reserved.
*
* This software is furnished under license and may be used and copied only
* in accordance with the following terms and conditions. Subject to these
* conditions, you may download, copy, install, use, modify and distribute
* modified or unmodified copies of this software in source and/or binary
* form. No title or ownership is transferred hereby.
*
* 1) Any source code used, modified or distributed must reproduce and
* retain this copyright notice and list of conditions as they appear in
* the source file.
*
* 2) No right is granted to use any trade name, trademark, or logo of
* Broadcom Corporation. The ""Broadcom Corporation"" name may not be
* used to endorse or promote products derived from this software
* without the prior written permission of Broadcom Corporation.
*
* 3) THIS SOFTWARE IS PROVIDED ""AS-IS"" AND ANY EXPRESS OR IMPLIED
* WARRANTIES, INCLUDING BUT NOT LIMITED TO, ANY IMPLIED WARRANTIES OF
* MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR
* NON-INFRINGEMENT ARE DISCLAIMED. IN NO EVENT SHALL BROADCOM BE LIABLE
* FOR ANY DAMAGES WHATSOEVER, AND IN PARTICULAR, BROADCOM SHALL NOT BE
* LIABLE FOR DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
* CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
* SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
* BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
* WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
* OR OTHERWISE), EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
```"
185,190,NomosTestfiles/BSD/HP-DEC.txt,HP-DEC,"Copyright 1997 Digital Equipment Corporation. All rights reserved.

This software is furnished under license and may be used and copied only in
accordance with the following terms and conditions. Subject to these
conditions, you may download, copy, install, use, modify and distribute
this software in source and/or binary form. No title or ownership is
transferred hereby.

1) Any source code used, modified or distributed must reproduce and retain
this copyright notice and list of conditions as they appear in the
source file.

2) No right is granted to use any trade name, trademark, or logo of Digital
Equipment Corporation. Neither the ""Digital Equipment Corporation""
name nor any trademark or logo of Digital Equipment Corporation may be
used to endorse or promote products derived from this software without
the prior written permission of Digital Equipment Corporation.

3) This software is provided ""AS-IS"" and any express or implied warranties,
including but not limited to, any implied warranties of merchantability,
fitness for a particular purpose, or non-infringement are disclaimed.
In no event shall DIGITAL be liable for any damages whatsoever, and in
particular, DIGITAL shall not be liable for special, indirect,
consequential, or incidental damages or damages for lost profits, loss
of revenue or loss of use, whether such damages arise in contract,
negligence, tort, under statute, in equity, at law or otherwise, even
if advised of the possibility of such damage. 
",False,"```
Copyright 1997 Digital Equipment Corporation. All rights reserved.

This software is furnished under license and may be used and copied only in
accordance with the following terms and conditions. Subject to these
conditions, you may download, copy, install, use, modify and distribute
this software in source and/or binary form. No title or ownership is
transferred hereby.

1) Any source code used, modified or distributed must reproduce and retain
this copyright notice and list of conditions as they appear in the
source file.

2) No right is granted to use any trade name, trademark, or logo of Digital
Equipment Corporation. Neither the ""Digital Equipment Corporation""
name nor any trademark or logo of Digital Equipment Corporation may be
used to endorse or promote products derived from this software without
the prior written permission of Digital Equipment Corporation.

3) This software is provided ""AS-IS"" and any express or implied warranties,
including but not limited to, any implied warranties of merchantability,
fitness for a particular purpose, or non-infringement are disclaimed.
In no event shall DIGITAL be liable for any damages whatsoever, and in
particular, DIGITAL shall not be liable for special, indirect,
consequential, or incidental damages or damages for lost profits, loss
of revenue or loss of use, whether such damages arise in contract,
negligence, tort, under statute, in equity, at law or otherwise, even
if advised of the possibility of such damage.
```"
186,191,NomosTestfiles/BSD/htmlArea_ref.txt,BSD-3-Clause,"﻿// I18N constants
//
// LANG: ""pt_br"", ENCODING: UTF-8
// Portuguese Brazilian Translation
//
// Author: Marcio Barbosa, <marcio@mpg.com.br>
// MSN: tomarshall@msn.com - ICQ: 69419933
// Site: http://www.mpg.com.br
//
// Last revision: 06 september 2007
// Please don´t remove this information
// If you modify any source, please insert a comment with your name and e-mail
//
// Distributed under the same terms as HTMLArea itself.
// This notice MUST stay intact for use (see license.txt).
{
""Your Document is not well formed. Check JavaScript console for details."": ""Seu documento não está formatado corretamente. Verifique os detalhes no console do Javascript.""
}",False,"```
// Distributed under the same terms as HTMLArea itself.
// This notice MUST stay intact for use (see license.txt).
```"
187,192,NomosTestfiles/BSD/htmlArea.txt,BSD-3-Clause,"

    htmlArea License (based on BSD license)
    Copyright (c) 2002-2004, interactivetools.com, inc.
    Copyright (c) 2003-2004 dynarch.com
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are met:

    1) Redistributions of source code must retain the above copyright notice,
    this list of conditions and the following disclaimer.

    2) Redistributions in binary form must reproduce the above copyright notice,
    this list of conditions and the following disclaimer in the documentation
    and/or other materials provided with the distribution.

    3) Neither the name of interactivetools.com, inc. nor the names of its
    contributors may be used to endorse or promote products derived from this
    software without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS""
    AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
    IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
    ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
    LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
    CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
    SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
    INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
    CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
    ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
    POSSIBILITY OF SUCH DAMAGE.
",False,"```
    htmlArea License (based on BSD license)
    Copyright (c) 2002-2004, interactivetools.com, inc.
    Copyright (c) 2003-2004 dynarch.com
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are met:

    1) Redistributions of source code must retain the above copyright notice,
    this list of conditions and the following disclaimer.

    2) Redistributions in binary form must reproduce the above copyright notice,
    this list of conditions and the following disclaimer in the documentation
    and/or other materials provided with the distribution.

    3) Neither the name of interactivetools.com, inc. nor the names of its
    contributors may be used to endorse or promote products derived from this
    software without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS""
    AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
    IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
    ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
    LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
    CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
    SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
    INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
    CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
    ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
    POSSIBILITY OF SUCH DAMAGE.
```"
188,193,NomosTestfiles/BSD/ibm.php,"BSD-3-Clause
Zend-1.0","<?php
/**
 * Zend Framework
 *
 * LICENSE
 *
 * This source file is subject to version 1.0 of the Zend Framework
 * license, that is bundled with this package in the file LICENSE.txt, and
 * is available through the world-wide-web at the following URL:
 * http://framework.zend.com/license/new-bsd. If you did not receive
 * a copy of the Zend Framework license and are unable to obtain it
 * through the world-wide-web, please send a note to license@zend.com
 * so we can mail you a copy immediately.
 *
 * @package    Zend_Db
 * @subpackage Adapter
 * @copyright  Copyright (c) 2005-2007 Zend Technologies USA Inc.
 * (http://www.zend.com)
 * @license    http://framework.zend.com/license/new-bsd     New BSD License
 * Zend Framework License version 1.0
 *
 */

/** Zend_Db_Adapter_Pdo_Abstract */
require_once 'Zend/Db/Adapter/Pdo/Abstract.php';

/** Zend_Db_Abstract_Pdo_Ibm_Db2 */
require_once 'Zend/Db/Adapter/Pdo/Ibm/Db2.php';

/** Zend_Db_Abstract_Pdo_Ibm_Ids */
require_once 'Zend/Db/Adapter/Pdo/Ibm/Ids.php';

/** Zend_Db_Statement_Pdo_Ibm */
require_once 'Zend/Db/Statement/Pdo/Ibm.php';

/**
 * Zend_Db_Adapter_Exception
 */
require_once 'Zend/Db/Adapter/Exception.php';


/**
 * @package    Zend_Db
 * @copyright  Copyright (c) 2005-2007 Zend Technologies Inc. (http://www.zend.com)
 * @license    http://framework.zend.com/license/new-bsd     New BSD License
 * @author     Manas Dadarkar <manas@us.ibm.com>
 * @author     Kellen Bombardier <kfbombar@us.ibm.com>
 * @author     Salvador Ledezma <ledezma@us.ibm.com>
 */

class Zend_Db_Adapter_Pdo_Ibm extends Zend_Db_Adapter_Pdo_Abstract
{
    /**
     * PDO type.
     *
     * @var string
     */
    protected $_pdoType = 'ibm';

    /**
     * The IBM data server connected to
     *
     * @var string
     */
    protected $_serverType = null;

    /**
     * Keys are UPPERCASE SQL datatypes or the constants
     * Zend_Db::INT_TYPE, Zend_Db::BIGINT_TYPE, or Zend_Db::FLOAT_TYPE.
     *
     * Values are:
     * 0 = 32-bit integer
     * 1 = 64-bit integer
     * 2 = float or decimal
     *
     * @var array Associative array of datatypes to values 0, 1, or 2.
     */
    protected $_numericDataTypes = array(
                        Zend_Db::INT_TYPE    => Zend_Db::INT_TYPE,
                        Zend_Db::BIGINT_TYPE => Zend_Db::BIGINT_TYPE,
                        Zend_Db::FLOAT_TYPE  => Zend_Db::FLOAT_TYPE,
                        'INTEGER'            => Zend_Db::INT_TYPE,
                        'SMALLINT'           => Zend_Db::INT_TYPE,
                        'BIGINT'             => Zend_Db::BIGINT_TYPE,
                        'DECIMAL'            => Zend_Db::FLOAT_TYPE,
                        'DEC'                => Zend_Db::FLOAT_TYPE,
                        'REAL'               => Zend_Db::FLOAT_TYPE,
                        'NUMERIC'            => Zend_Db::FLOAT_TYPE,
                        'DOUBLE PRECISION'   => Zend_Db::FLOAT_TYPE,
                        'FLOAT'              => Zend_Db::FLOAT_TYPE
                        );

    /**
     * Creates a PDO object and connects to the database.
     *
     * The IBM data server is set.
     * Current options are DB2 or IDS
     * @todo also differentiate between z/OS and i/5

     *
     * @return void
     * @throws Zend_Db_Adapter_Exception
     */
    public function _connect()
    {
        if ($this->_connection) {
            return;
        }
        parent::_connect();

        $this->getConnection()->setAttribute(Zend_Db::ATTR_STRINGIFY_FETCHES, true);

        try {
            if ($this->_serverType === null) {
                $server = substr($this->getConnection()->getAttribute(PDO::ATTR_SERVER_INFO), 0, 3);

                switch ($server) {
                    case 'DB2':
                        $this->_serverType = new Zend_Db_Adapter_Pdo_Ibm_Db2($this);

                        // Add DB2-specific numeric types
                        $this->_numericDataTypes['DECFLOAT'] = Zend_Db::FLOAT_TYPE;
                        $this->_numericDataTypes['DOUBLE']   = Zend_Db::FLOAT_TYPE;
                        $this->_numericDataTypes['NUM']      = Zend_Db::FLOAT_TYPE;

                        break;
                    case 'IDS':
                        $this->_serverType = new Zend_Db_Adapter_Pdo_Ibm_Ids($this);

                        // Add IDS-specific numeric types
                        $this->_numericDataTypes['SERIAL']       = Zend_Db::INT_TYPE;
                        $this->_numericDataTypes['SERIAL8']      = Zend_Db::BIGINT_TYPE;
                        $this->_numericDataTypes['INT8']         = Zend_Db::BIGINT_TYPE;
                        $this->_numericDataTypes['SMALLFLOAT']   = Zend_Db::FLOAT_TYPE;
                        $this->_numericDataTypes['MONEY']        = Zend_Db::FLOAT_TYPE;

                        break;
                    }
            }
        } catch (PDOException $e) {
            require_once 'Zend/Db/Adapter/Exception.php';
            $error = strpos($e->getMessage(), 'driver does not support that attribute');
            if ($error) {
                throw new Zend_Db_Adapter_Exception(""PDO_IBM driver extension is downlevel.  Please use driver release version 1.2.1 or later"");
            } else {
                throw new Zend_Db_Adapter_Exception($e->getMessage());
            }
        }
    }

    /**
     * Creates a PDO DSN for the adapter from $this->_config settings.
     *
     * @return string
     */
    protected function _dsn()
    {
        $this->_checkRequiredOptions($this->_config);

        // check if using full connection string
        if (array_key_exists('host', $this->_config)) {
            $dsn = ';DATABASE=' . $this->_config['dbname']
            . ';HOSTNAME=' . $this->_config['host']
            . ';PORT='     . $this->_config['port']
            // PDO_IBM supports only DB2 TCPIP protocol
            . ';PROTOCOL=' . 'TCPIP;';
        } else {
            // catalogued connection
            $dsn = $this->_config['dbname'];
        }
        return $this->_pdoType . ': ' . $dsn;
    }

    protected function _checkRequiredOptions(array $config)
    {
        parent::_checkRequiredOptions($config);

        if (array_key_exists('host', $this->_config) &&
        !array_key_exists('port', $config)) {
            throw new Zend_Db_Adapter_Exception(""Configuration must have a key for 'port' when 'host' is specified"");
        }
    }

    /**
     * Prepares an SQL statement.
     *
     * @param string $sql The SQL statement with placeholders.
     * @return PDOStatement
     */
    public function prepare($sql)
    {
        $this->_connect();
        $stmt = new Zend_Db_Statement_Pdo_Ibm($this, $sql);
        $stmt->setFetchMode($this->_fetchMode);
        return $stmt;
    }

    /**
     * Returns a list of the tables in the database.
     *
     * @return array
     */
    public function listTables()
    {
        $this->_connect();
        return $this->_serverType->listTables();
    }

    /**
     * Returns the column descriptions for a table.
     *
     * The return value is an associative array keyed by the column name,
     * as returned by the RDBMS.
     *
     * The value of each array element is an associative array
     * with the following keys:
     *
     * SCHEMA_NAME      => string; name of database or schema
     * TABLE_NAME       => string;
     * COLUMN_NAME      => string; column name
     * COLUMN_POSITION  => number; ordinal position of column in table
     * DATA_TYPE        => string; SQL datatype name of column
     * DEFAULT          => string; default expression of column, null if none
     * NULLABLE         => boolean; true if column can have nulls
     * LENGTH           => number; length of CHAR/VARCHAR
     * SCALE            => number; scale of NUMERIC/DECIMAL
     * PRECISION        => number; precision of NUMERIC/DECIMAL
     * UNSIGNED         => boolean; unsigned property of an integer type
     * PRIMARY          => boolean; true if column is part of the primary key
     * PRIMARY_POSITION => integer; position of column in primary key
     *
     * @todo Discover integer unsigned property.
     *
     * @param string $tableName
     * @param string $schemaName OPTIONAL
     * @return array
     */
    public function describeTable($tableName, $schemaName = null)
    {
        $this->_connect();
        return $this->_serverType->describeTable($tableName, $schemaName);
    }

    /**
     * Inserts a table row with specified data.
     * Special handling for PDO_IBM
     * remove empty slots
     *
     * @param mixed $table The table to insert data into.
     * @param array $bind Column-value pairs.
     * @return int The number of affected rows.
     */
    public function insert($table, array $bind)
    {
        $this->_connect();
        $newbind = array();
        if (is_array($bind)) {
            foreach ($bind as $name => $value) {
                if(!is_null($value)) {
                    $newbind[$name] = $value;
                }
            }
        }

        return parent::insert($table, $newbind);
    }

    /**
     * Adds an adapter-specific LIMIT clause to the SELECT statement.
     *
     * @param string $sql
     * @param integer $count
     * @param integer $offset OPTIONAL
     * @return string
     */
    public function limit($sql, $count, $offset = 0)
    {
       $this->_connect();
       return $this->_serverType->limit($sql, $count, $offset);
    }

    /**
     * Gets the last ID generated automatically by an IDENTITY/AUTOINCREMENT
     * column.
     *
     * @param string $tableName OPTIONAL
     * @param string $primaryKey OPTIONAL
     * @return integer
     */
    public function lastInsertId($tableName = null, $primaryKey = null)
    {
        $this->_connect();

         if ($tableName !== null) {
            $sequenceName = $tableName;
            if ($primaryKey) {
                $sequenceName .= ""_$primaryKey"";
            }
            $sequenceName .= '_seq';
            return $this->lastSequenceId($sequenceName);
        }

        $id = $this->getConnection()->lastInsertId();

        return $id;
    }

    /**
     * Return the most recent value from the specified sequence in the database.
     *
     * @param string $sequenceName
     * @return integer
     */
    public function lastSequenceId($sequenceName)
    {
        $this->_connect();
        return $this->_serverType->lastSequenceId($sequenceName);
    }

    /**
     * Generate a new value from the specified sequence in the database,
     * and return it.
     *
     * @param string $sequenceName
     * @return integer
     */
    public function nextSequenceId($sequenceName)
    {
        $this->_connect();
        return $this->_serverType->nextSequenceId($sequenceName);
    }
}
",False,"```php
/** Zend_Db_Adapter_Pdo_Ibm */
require_once 'Zend/Db/Adapter/Pdo/Abstract.php';

/** Zend_Db_Abstract_Pdo_Ibm_Db2 */
require_once 'Zend/Db/Adapter/Pdo/Ibm/Db2.php';

/** Zend_Db_Abstract_Pdo_Ibm_Ids */
require_once 'Zend/Db/Adapter/Pdo/Ibm/Ids.php';

/** Zend_Db_Statement_Pdo_Ibm */
require_once 'Zend/Db/Statement/Pdo/Ibm.php';

/**
 * Zend_Db_Adapter_Exception
 */
require_once 'Zend/Db/Adapter/Exception.php';


/**
 * @package    Zend_Db
 * @copyright  Copyright (c) 2005-2007 Zend Technologies Inc. (http://www.zend.com)
 * @license    http://framework.zend.com/license/new-bsd     New BSD License
 * @author     Manas Dadarkar <manas@us.ibm.com>
 * @author     Kellen Bombardier <kfbombar@us.ibm.com>
 * @author     Salvador Ledezma <ledezma@us.ibm.com>
 */

class Zend_Db_Adapter_Pdo_Ibm extends Zend_Db_Adapter_Pdo_Abstract
{
    /**
     * PDO type.
     *
     * @var string
     */
    protected $_pdoType = 'ibm';

    /**
     * The IBM data server connected to
     *
     * @var string
     */
    protected $_serverType = null;

    /**
     * Keys are UPPERCASE SQL datatypes or the constants
     * Zend_Db::INT_TYPE, Zend_Db::BIGINT_TYPE, or Zend_Db::FLOAT_TYPE.
     *
     * Values are:
     * 0 = 32-bit integer
     * 1 = 64-bit integer
     * 2 = float or decimal
     *
     * @var array Associative array of datatypes to values 0, 1, or 2.
     */
    protected $_numericDataTypes = array(
                        Zend_Db::INT_TYPE    => Zend_Db::INT_TYPE,
                        Zend_Db::BIGINT_TYPE => Zend_Db::BIGINT_TYPE,
                        Zend_Db::FLOAT_TYPE  => Zend_Db::FLOAT_TYPE,
                        'INTEGER'            => Zend_Db::INT_TYPE,
                        'SMALLINT'           => Zend_Db::INT_TYPE,
                        'BIGINT'             => Zend_Db::BIGINT_TYPE,
                        'DECIMAL'            => Zend_Db::FLOAT_TYPE,
                        'DEC'                => Zend_Db::FLOAT_TYPE,
                        'REAL'               => Zend_Db::FLOAT_TYPE,
                        'NUMERIC'            => Zend_Db::FLOAT_TYPE,
                        'DOUBLE PRECISION'   => Zend_Db::FLOAT_TYPE,
                        'FLOAT'              => Zend_Db::FLOAT_TYPE
                        );

    /**
     * Creates a PDO object and connects to the database.
     *
     * The IBM data server is set.
     * Current options are DB2 or IDS
     * @todo also differentiate between z/OS and i/5

     *
     * @return void
     * @throws Zend_Db_Adapter_Exception
     */
    public function _connect()
    {
        if ($this->_connection) {
            return;
        }
        parent::_connect();

        $this->getConnection()->setAttribute(Zend_Db::ATTR_STRINGIFY_FETCHES, true);

        try {
            if ($this->_serverType === null) {
                $server = substr($this->getConnection()->getAttribute(PDO::ATTR_SERVER_INFO), 0, 3);

                switch ($server) {
                    case 'DB2':
                        $this->_serverType = new Zend_Db_Adapter_Pdo_Ibm_Db2($this);

                        // Add DB2-specific numeric types
                        $this->_numericDataTypes['DECFLOAT'] = Zend_Db::FLOAT_TYPE;
                        $this->_numericDataTypes['DOUBLE']   = Zend_Db::FLOAT_TYPE;
                        $this->_numericDataTypes['NUM']      = Zend_Db::FLOAT_TYPE;

                        break;
                    case 'IDS':
                        $this->_serverType = new Zend_Db_Adapter_Pdo_Ibm_Ids($this);

                        // Add IDS-specific numeric types
                        $this->_numericDataTypes['SERIAL']       = Zend_Db::INT_TYPE;
                        $this->_numericDataTypes['SERIAL8']      = Zend_Db::BIGINT_TYPE;
                        $this->_numericDataTypes['INT8']         = Zend_Db::BIGINT_TYPE;
                        $this->_numericDataTypes['SMALLFLOAT']   = Zend_Db::FLOAT_TYPE;
                        $this->_numericDataTypes['MONEY']        = Zend_Db::FLOAT_TYPE;

                        break;
                    }
            }
        } catch (PDOException $e) {
            require_once 'Zend/Db/Adapter/Exception.php';
            $error = strpos($e->getMessage(), 'driver does not support that attribute');
            if ($error) {
                throw new Zend_Db_Adapter_Exception(""PDO_IBM driver extension is downlevel.  Please use driver release version 1.2.1 or later"");
            } else {
                throw new Zend_Db_Adapter_Exception($e->getMessage());
            }
        }
    }

    /**
     * Creates a PDO DSN for the adapter from $this->_config settings.
     *
     * @return string
     */
    protected function _dsn()
    {
        $this->_checkRequiredOptions($this->_config);

        // check if using full connection string
        if (array_key_exists('host', $this->_config)) {
            $dsn = ';DATABASE=' . $this->_config['dbname']
            . ';HOSTNAME=' . $this->_config['host']
            . ';PORT='     . $this->_config['port']
            // PDO_IBM supports only DB2 TCPIP protocol
            . ';PROTOCOL=' . 'TCPIP;';
        } else {
            // catalogued connection
            $dsn = $this->_config['dbname'];
        }
        return $this->_pdoType . ': ' . $dsn;
    }

    protected function _checkRequiredOptions(array $config)
    {
        parent::_checkRequiredOptions($config);

        if (array_key_exists('host', $this->_config) &&
        !array_key_exists('port', $config)) {
            throw new Zend_Db_Adapter_Exception(""Configuration must have a key for 'port' when 'host' is specified"");
        }
    }

    /**
     * Prepares an SQL statement.
     *
     * @param string $sql The SQL statement with placeholders.
     * @return PDOStatement
     */
    public function prepare($sql)
    {
        $this->_connect();
        $stmt = new Zend_Db_Statement_Pdo_Ibm($this, $sql);
        $stmt->setFetchMode($this->_fetchMode);
        return $stmt;
    }

    /**
     * Returns a list of the tables in the database.
     *
     * @return array
     */
    public function listTables()
    {
        $this->_connect();
        return $this->_serverType->listTables();
    }

    /**
     * Returns the column descriptions for a table.
     *
     * The return value is an associative array keyed by the column name,
     * as returned by the RDBMS.
     *
     * The value of each array element is an associative array
     * with the following keys:
     *
     * SCHEMA_NAME      => string; name of database or schema
     * TABLE_NAME       => string;
     * COLUMN_NAME      => string; column name
     * COLUMN_POSITION  => number; ordinal position of column in table
     * DATA_TYPE        => string; SQL datatype name of column
     * DEFAULT          => string; default expression of column, null if none
     * NULLABLE         => boolean; true if column can have nulls
     * LENGTH           => number; length of CHAR/VARCHAR
     * SCALE            => number; scale of NUMERIC/DECIMAL
     * PRECISION        => number; precision of NUMERIC/DECIMAL
     * UNSIGNED         => boolean; unsigned property of an integer type
     * PRIMARY          => boolean; true if column is part of the primary key
     * PRIMARY_POSITION => integer; position of column in primary key
     *
     * @todo Discover integer unsigned property.
     *
     * @param string $tableName
     * @param string $schemaName OPTIONAL
     * @return array
     */
    public function describeTable($tableName, $schemaName = null)
    {
        $this->_connect();
        return $this->_serverType->describeTable($tableName, $schemaName);
    }

    /**
     * Inserts a table row with specified data.
     * Special handling for PDO_IBM
     * remove empty slots
     *
     * @param mixed $table The table to insert data into.
     * @param array $bind Column-value pairs.
     * @return int The number of affected rows.
     */
    public function insert($table, array $bind)
    {
        $this->_connect();
        $newbind = array();
        if (is_array($bind)) {
            foreach ($bind as $name => $value) {
                if(!is_null($value)) {
                    $newbind[$name] = $value;
                }
            }
        }

        return parent::insert($table, $newbind);
    }

    /**
     * Adds an adapter-specific LIMIT clause to the SELECT statement.
     *
     * @param string $sql
     * @param integer $count
     * @param integer $offset OPTIONAL
     * @return string
     */
    public function limit($sql, $count, $offset = 0)
    {
       $this->_connect();
       return $this->_serverType->limit($sql, $count, $offset);
    }

    /**
     * Gets the last ID generated automatically by an IDENTITY/AUTOINCREMENT
     * column.
     *
     * @param string $tableName OPTIONAL
     * @param string $primaryKey OPTIONAL
     * @return integer
     */
    public function lastInsertId($tableName = null, $primaryKey = null)
    {
        $this->_connect();

         if ($tableName !== null) {
            $sequenceName = $tableName;
            if ($primaryKey) {
                $sequenceName .= ""_$primaryKey"";
            }
            $sequenceName .= '_seq';
            return $this->lastSequenceId($sequenceName);
        }

        $id = $this->getConnection()->lastInsertId();

        return $id;
    }

    /**
     * Return the most recent value from the specified sequence in the database.
     *
     * @param string $sequenceName
     * @return integer
     */
    public function lastSequenceId($sequenceName)
    {
        $this->_connect();
        return $this->_serverType->lastSequenceId($sequenceName);
    }

    /**
     * Generate a new value from the specified sequence in the database,
     * and return it.
     *
     * @param string $sequenceName
     * @return integer
     */
    public function nextSequenceId($sequenceName)
    {
        $this->_connect();
        return $this->_serverType->nextSequenceId($sequenceName);
    }
}
```"
189,194,NomosTestfiles/BSD/inetd.c,BSD-4-Clause-UC,"/* vi: set sw=4 ts=4: */
/*      $Slackware: inetd.c 1.79s 2001/02/06 13:18:00 volkerdi Exp $    */
/*      $OpenBSD: inetd.c,v 1.79 2001/01/30 08:30:57 deraadt Exp $      */
/*      $NetBSD: inetd.c,v 1.11 1996/02/22 11:14:41 mycroft Exp $       */
/* Busybox port by Vladimir Oleynik (C) 2001-2005 <dzo@simtreas.ru>     */
/* IPv6 support, many bug fixes by Denys Vlasenko (c) 2008 */
/*
 * Copyright (c) 1983,1991 The Regents of the University of California.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *      This product includes software developed by the University of
 *      California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ""AS IS"" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 */

/* Inetd - Internet super-server
 *
 * This program invokes configured services when a connection
 * from a peer is established or a datagram arrives.
 * Connection-oriented services are invoked each time a
 * connection is made, by creating a process.  This process
 * is passed the connection as file descriptor 0 and is
 * expected to do a getpeername to find out peer's host
 * and port.
 * Datagram oriented services are invoked when a datagram
 * arrives; a process is created and passed a pending message
 * on file descriptor 0. peer's address can be obtained
 * using recvfrom.
 *
 * Inetd uses a configuration file which is read at startup
 * and, possibly, at some later time in response to a hangup signal.
 * The configuration file is ""free format"" with fields given in the
 * order shown below.  Continuation lines for an entry must begin with
 * a space or tab.  All fields must be present in each entry.
 *
 *      service_name                    must be in /etc/services
 *      socket_type                     stream/dgram/raw/rdm/seqpacket
 *      protocol                        must be in /etc/protocols
 *                                      (usually ""tcp"" or ""udp"")
 *      wait/nowait[.max]               single-threaded/multi-threaded, max #
 *      user[.group] or user[:group]    user/group to run daemon as
 *      server_program                  full path name
 *      server_program_arguments        maximum of MAXARGS (20)
 *
 * For RPC services
 *      service_name/version            must be in /etc/rpc
 *      socket_type                     stream/dgram/raw/rdm/seqpacket
 *      rpc/protocol                    ""rpc/tcp"" etc
 *      wait/nowait[.max]               single-threaded/multi-threaded
 *      user[.group] or user[:group]    user to run daemon as
 *      server_program                  full path name
 *      server_program_arguments        maximum of MAXARGS (20)
 *
 * For non-RPC services, the ""service name"" can be of the form
 * hostaddress:servicename, in which case the hostaddress is used
 * as the host portion of the address to listen on.  If hostaddress
 * consists of a single '*' character, INADDR_ANY is used.
 *
 * A line can also consist of just
 *      hostaddress:
 * where hostaddress is as in the preceding paragraph.  Such a line must
 * have no further fields; the specified hostaddress is remembered and
 * used for all further lines that have no hostaddress specified,
 * until the next such line (or EOF).  (This is why * is provided to
 * allow explicit specification of INADDR_ANY.)  A line
 *      *:
 * is implicitly in effect at the beginning of the file.
 *
 * The hostaddress specifier may (and often will) contain dots;
 * the service name must not.
 *
 * For RPC services, host-address specifiers are accepted and will
 * work to some extent; however, because of limitations in the
 * portmapper interface, it will not work to try to give more than
 * one line for any given RPC service, even if the host-address
 * specifiers are different.
 *
 * Comment lines are indicated by a '#' in column 1.
 */

/* inetd rules for passing file descriptors to children
 * (http://www.freebsd.org/cgi/man.cgi?query=inetd):
 *
 * The wait/nowait entry specifies whether the server that is invoked by
 * inetd will take over the socket associated with the service access point,
 * and thus whether inetd should wait for the server to exit before listen-
 * ing for new service requests.  Datagram servers must use ""wait"", as
 * they are always invoked with the original datagram socket bound to the
 * specified service address.  These servers must read at least one datagram
 * from the socket before exiting.  If a datagram server connects to its
 * peer, freeing the socket so inetd can receive further messages on the
 * socket, it is said to be a ""multi-threaded"" server; it should read one
 * datagram from the socket and create a new socket connected to the peer.
 * It should fork, and the parent should then exit to allow inetd to check
 * for new service requests to spawn new servers.  Datagram servers which
 * process all incoming datagrams on a socket and eventually time out are
 * said to be ""single-threaded"".  The comsat(8), biff(1) and talkd(8)
 * utilities are both examples of the latter type of datagram server.  The
 * tftpd(8) utility is an example of a multi-threaded datagram server.
 *
 * Servers using stream sockets generally are multi-threaded and use the
 * ""nowait"" entry. Connection requests for these services are accepted by
 * inetd, and the server is given only the newly-accepted socket connected
 * to a client of the service.  Most stream-based services operate in this
 * manner.  Stream-based servers that use ""wait"" are started with the lis-
 * tening service socket, and must accept at least one connection request
 * before exiting.  Such a server would normally accept and process incoming
 * connection requests until a timeout.
 */

/* Despite of above doc saying that dgram services must use ""wait"",
 * ""udp nowait"" servers are implemented in busyboxed inetd.
 * IPv6 addresses are also implemented. However, they may look ugly -
 * "":::service..."" means ""address '::' (IPv6 wildcard addr)"":""service""...
 * You have to put ""tcp6""/""udp6"" in protocol field to select IPv6.
 */

/* Here's the scoop concerning the user[:group] feature:
 * 1) group is not specified:
 *      a) user = root: NO setuid() or setgid() is done
 *      b) other:       initgroups(name, primary group)
 *                      setgid(primary group as found in passwd)
 *                      setuid()
 * 2) group is specified:
 *      a) user = root: setgid(specified group)
 *                      NO initgroups()
 *                      NO setuid()
 *      b) other:       initgroups(name, specified group)
 *                      setgid(specified group)
 *                      setuid()
 */

//usage:#define inetd_trivial_usage
//usage:       ""[-fe] [-q N] [-R N] [CONFFILE]""
//usage:#define inetd_full_usage ""\n\n""
//usage:       ""Listen for network connections and launch programs\n""
//usage:     ""\n	-f	Run in foreground""
//usage:     ""\n	-e	Log to stderr""
//usage:     ""\n	-q N	Socket listen queue (default: 128)""
//usage:     ""\n	-R N	Pause services after N connects/min""
//usage:     ""\n		(default: 0 - disabled)""

#include <syslog.h>
#include <sys/resource.h> /* setrlimit */
#include <sys/socket.h> /* un.h may need this */
#include <sys/un.h>

#include ""libbb.h""

#if ENABLE_FEATURE_INETD_RPC
# if defined(__UCLIBC__) && ! defined(__UCLIBC_HAS_RPC__)
#  error ""You need to build uClibc with UCLIBC_HAS_RPC for NFS support""
# endif
# include <rpc/rpc.h>
# include <rpc/pmap_clnt.h>
#endif

#if !BB_MMU
/* stream version of chargen is forking but not execing,
 * can't do that (easily) on NOMMU */
#undef  ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_CHARGEN
#define ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_CHARGEN 0
#endif

#define CNT_INTERVAL    60      /* servers in CNT_INTERVAL sec. */
#define RETRYTIME       60      /* retry after bind or server fail */

// TODO: explain, or get rid of setrlimit games

#ifndef RLIMIT_NOFILE
#define RLIMIT_NOFILE   RLIMIT_OFILE
#endif

#ifndef OPEN_MAX
#define OPEN_MAX        64
#endif

/* Reserve some descriptors, 3 stdio + at least: 1 log, 1 conf. file */
#define FD_MARGIN       8

#if ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_DISCARD \
 || ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_ECHO    \
 || ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_CHARGEN \
 || ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_TIME    \
 || ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_DAYTIME
# define INETD_BUILTINS_ENABLED
#endif

typedef struct servtab_t {
	/* The most frequently referenced one: */
	int se_fd;                            /* open descriptor */
	/* NB: 'biggest fields last' saves on code size (~250 bytes) */
	/* [addr:]service socktype proto wait user[:group] prog [args] */
	char *se_local_hostname;              /* addr to listen on */
	char *se_service;                     /* ""80"" or ""www"" or ""mount/2[-3]"" */
	/* socktype is in se_socktype */      /* ""stream"" ""dgram"" ""raw"" ""rdm"" ""seqpacket"" */
	char *se_proto;                       /* ""unix"" or ""[rpc/]tcp[6]"" */
#if ENABLE_FEATURE_INETD_RPC
	int se_rpcprog;                       /* rpc program number */
	int se_rpcver_lo;                     /* rpc program lowest version */
	int se_rpcver_hi;                     /* rpc program highest version */
#define is_rpc_service(sep)       ((sep)->se_rpcver_lo != 0)
#else
#define is_rpc_service(sep)       0
#endif
	pid_t se_wait;                        /* 0:""nowait"", 1:""wait"", >1:""wait"" */
	                                      /* and waiting for this pid */
	socktype_t se_socktype;               /* SOCK_STREAM/DGRAM/RDM/... */
	family_t se_family;                   /* AF_UNIX/INET[6] */
	/* se_proto_no is used by RPC code only... hmm */
	smallint se_proto_no;                 /* IPPROTO_TCP/UDP, n/a for AF_UNIX */
	smallint se_checked;                  /* looked at during merge */
	unsigned se_max;                      /* allowed instances per minute */
	unsigned se_count;                    /* number started since se_time */
	unsigned se_time;                     /* when we started counting */
	char *se_user;                        /* user name to run as */
	char *se_group;                       /* group name to run as, can be NULL */
#ifdef INETD_BUILTINS_ENABLED
	const struct builtin *se_builtin;     /* if built-in, description */
#endif
	struct servtab_t *se_next;
	len_and_sockaddr *se_lsa;
	char *se_program;                     /* server program */
#define MAXARGV 20
	char *se_argv[MAXARGV + 1];           /* program arguments */
} servtab_t;

#ifdef INETD_BUILTINS_ENABLED
/* Echo received data */
#if ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_ECHO
static void FAST_FUNC echo_stream(int, servtab_t *);
static void FAST_FUNC echo_dg(int, servtab_t *);
#endif
/* Internet /dev/null */
#if ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_DISCARD
static void FAST_FUNC discard_stream(int, servtab_t *);
static void FAST_FUNC discard_dg(int, servtab_t *);
#endif
/* Return 32 bit time since 1900 */
#if ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_TIME
static void FAST_FUNC machtime_stream(int, servtab_t *);
static void FAST_FUNC machtime_dg(int, servtab_t *);
#endif
/* Return human-readable time */
#if ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_DAYTIME
static void FAST_FUNC daytime_stream(int, servtab_t *);
static void FAST_FUNC daytime_dg(int, servtab_t *);
#endif
/* Familiar character generator */
#if ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_CHARGEN
static void FAST_FUNC chargen_stream(int, servtab_t *);
static void FAST_FUNC chargen_dg(int, servtab_t *);
#endif

struct builtin {
	/* NB: not necessarily NUL terminated */
	char bi_service7[7];      /* internally provided service name */
	uint8_t bi_fork;          /* 1 if stream fn should run in child */
	void (*bi_stream_fn)(int, servtab_t *) FAST_FUNC;
	void (*bi_dgram_fn)(int, servtab_t *) FAST_FUNC;
};

static const struct builtin builtins[] = {
#if ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_ECHO
	{ ""echo"", 1, echo_stream, echo_dg },
#endif
#if ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_DISCARD
	{ ""discard"", 1, discard_stream, discard_dg },
#endif
#if ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_CHARGEN
	{ ""chargen"", 1, chargen_stream, chargen_dg },
#endif
#if ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_TIME
	{ ""time"", 0, machtime_stream, machtime_dg },
#endif
#if ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_DAYTIME
	{ ""daytime"", 0, daytime_stream, daytime_dg },
#endif
};
#endif /* INETD_BUILTINS_ENABLED */

struct globals {
	rlim_t rlim_ofile_cur;
	struct rlimit rlim_ofile;
	servtab_t *serv_list;
	int global_queuelen;
	int maxsock;         /* max fd# in allsock, -1: unknown */
	/* whenever maxsock grows, prev_maxsock is set to new maxsock,
	 * but if maxsock is set to -1, prev_maxsock is not changed */
	int prev_maxsock;
	unsigned max_concurrency;
	smallint alarm_armed;
	uid_t real_uid; /* user ID who ran us */
	const char *config_filename;
	parser_t *parser;
	char *default_local_hostname;
#if ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_CHARGEN
	char *end_ring;
	char *ring_pos;
	char ring[128];
#endif
	fd_set allsock;
	/* Used in next_line(), and as scratch read buffer */
	char line[256];          /* _at least_ 256, see LINE_SIZE */
} FIX_ALIASING;
#define G (*(struct globals*)&bb_common_bufsiz1)
enum { LINE_SIZE = COMMON_BUFSIZE - offsetof(struct globals, line) };
struct BUG_G_too_big {
	char BUG_G_too_big[sizeof(G) <= COMMON_BUFSIZE ? 1 : -1];
};
#define rlim_ofile_cur  (G.rlim_ofile_cur )
#define rlim_ofile      (G.rlim_ofile     )
#define serv_list       (G.serv_list      )
#define global_queuelen (G.global_queuelen)
#define maxsock         (G.maxsock        )
#define prev_maxsock    (G.prev_maxsock   )
#define max_concurrency (G.max_concurrency)
#define alarm_armed     (G.alarm_armed    )
#define real_uid        (G.real_uid       )
#define config_filename (G.config_filename)
#define parser          (G.parser         )
#define default_local_hostname (G.default_local_hostname)
#define first_ps_byte   (G.first_ps_byte  )
#define last_ps_byte    (G.last_ps_byte   )
#define end_ring        (G.end_ring       )
#define ring_pos        (G.ring_pos       )
#define ring            (G.ring           )
#define allsock         (G.allsock        )
#define line            (G.line           )
#define INIT_G() do { \
	rlim_ofile_cur = OPEN_MAX; \
	global_queuelen = 128; \
	config_filename = ""/etc/inetd.conf""; \
} while (0)

#if 1
# define dbg(...) ((void)0)
#else
# define dbg(...) \
do { \
	int dbg_fd = open(""inetd_debug.log"", O_WRONLY | O_CREAT | O_APPEND, 0666); \
	if (dbg_fd >= 0) { \
		fdprintf(dbg_fd, ""%d: "", getpid()); \
		fdprintf(dbg_fd, __VA_ARGS__); \
		close(dbg_fd); \
	} \
} while (0)
#endif

static void maybe_close(int fd)
{
	if (fd >= 0) {
		close(fd);
		dbg(""closed fd:%d\n"", fd);
	}
}

// TODO: move to libbb?
static len_and_sockaddr *xzalloc_lsa(int family)
{
	len_and_sockaddr *lsa;
	int sz;

	sz = sizeof(struct sockaddr_in);
	if (family == AF_UNIX)
		sz = sizeof(struct sockaddr_un);
#if ENABLE_FEATURE_IPV6
	if (family == AF_INET6)
		sz = sizeof(struct sockaddr_in6);
#endif
	lsa = xzalloc(LSA_LEN_SIZE + sz);
	lsa->len = sz;
	lsa->u.sa.sa_family = family;
	return lsa;
}

static void rearm_alarm(void)
{
	if (!alarm_armed) {
		alarm_armed = 1;
		alarm(RETRYTIME);
	}
}

static void block_CHLD_HUP_ALRM(sigset_t *m)
{
	sigemptyset(m);
	sigaddset(m, SIGCHLD);
	sigaddset(m, SIGHUP);
	sigaddset(m, SIGALRM);
	sigprocmask(SIG_BLOCK, m, m); /* old sigmask is stored in m */
}

static void restore_sigmask(sigset_t *m)
{
	sigprocmask(SIG_SETMASK, m, NULL);
}

#if ENABLE_FEATURE_INETD_RPC
static void register_rpc(servtab_t *sep)
{
	int n;
	struct sockaddr_in ir_sin;
	socklen_t size;

	size = sizeof(ir_sin);
	if (getsockname(sep->se_fd, (struct sockaddr *) &ir_sin, &size) < 0) {
		bb_perror_msg(""getsockname"");
		return;
	}

	for (n = sep->se_rpcver_lo; n <= sep->se_rpcver_hi; n++) {
		pmap_unset(sep->se_rpcprog, n);
		if (!pmap_set(sep->se_rpcprog, n, sep->se_proto_no, ntohs(ir_sin.sin_port)))
			bb_perror_msg(""%s %s: pmap_set(%u,%u,%u,%u)"",
				sep->se_service, sep->se_proto,
				sep->se_rpcprog, n, sep->se_proto_no, ntohs(ir_sin.sin_port));
	}
}

static void unregister_rpc(servtab_t *sep)
{
	int n;

	for (n = sep->se_rpcver_lo; n <= sep->se_rpcver_hi; n++) {
		if (!pmap_unset(sep->se_rpcprog, n))
			bb_perror_msg(""pmap_unset(%u,%u)"", sep->se_rpcprog, n);
	}
}
#endif /* FEATURE_INETD_RPC */

static void bump_nofile(void)
{
	enum { FD_CHUNK = 32 };
	struct rlimit rl;

	/* Never fails under Linux (except if you pass it bad arguments) */
	getrlimit(RLIMIT_NOFILE, &rl);
	rl.rlim_cur = MIN(rl.rlim_max, rl.rlim_cur + FD_CHUNK);
	rl.rlim_cur = MIN(FD_SETSIZE, rl.rlim_cur + FD_CHUNK);
	if (rl.rlim_cur <= rlim_ofile_cur) {
		bb_error_msg(""can't extend file limit, max = %d"",
						(int) rl.rlim_cur);
		return;
	}

	if (setrlimit(RLIMIT_NOFILE, &rl) < 0) {
		bb_perror_msg(""setrlimit"");
		return;
	}

	rlim_ofile_cur = rl.rlim_cur;
}

static void remove_fd_from_set(int fd)
{
	if (fd >= 0) {
		FD_CLR(fd, &allsock);
		dbg(""stopped listening on fd:%d\n"", fd);
		maxsock = -1;
		dbg(""maxsock:%d\n"", maxsock);
	}
}

static void add_fd_to_set(int fd)
{
	if (fd >= 0) {
		FD_SET(fd, &allsock);
		dbg(""started listening on fd:%d\n"", fd);
		if (maxsock >= 0 && fd > maxsock) {
			prev_maxsock = maxsock = fd;
			dbg(""maxsock:%d\n"", maxsock);
			if ((rlim_t)fd > rlim_ofile_cur - FD_MARGIN)
				bump_nofile();
		}
	}
}

static void recalculate_maxsock(void)
{
	int fd = 0;

	/* We may have no services, in this case maxsock should still be >= 0
	 * (code elsewhere is not happy with maxsock == -1) */
	maxsock = 0;
	while (fd <= prev_maxsock) {
		if (FD_ISSET(fd, &allsock))
			maxsock = fd;
		fd++;
	}
	dbg(""recalculated maxsock:%d\n"", maxsock);
	prev_maxsock = maxsock;
	if ((rlim_t)maxsock > rlim_ofile_cur - FD_MARGIN)
		bump_nofile();
}

static void prepare_socket_fd(servtab_t *sep)
{
	int r, fd;

	fd = socket(sep->se_family, sep->se_socktype, 0);
	if (fd < 0) {
		bb_perror_msg(""socket"");
		return;
	}
	setsockopt_reuseaddr(fd);

#if ENABLE_FEATURE_INETD_RPC
	if (is_rpc_service(sep)) {
		struct passwd *pwd;

		/* zero out the port for all RPC services; let bind()
		 * find one. */
		set_nport(&sep->se_lsa->u.sa, 0);

		/* for RPC services, attempt to use a reserved port
		 * if they are going to be running as root. */
		if (real_uid == 0 && sep->se_family == AF_INET
		 && (pwd = getpwnam(sep->se_user)) != NULL
		 && pwd->pw_uid == 0
		) {
			r = bindresvport(fd, &sep->se_lsa->u.sin);
		} else {
			r = bind(fd, &sep->se_lsa->u.sa, sep->se_lsa->len);
		}
		if (r == 0) {
			int saveerrno = errno;
			/* update lsa with port# */
			getsockname(fd, &sep->se_lsa->u.sa, &sep->se_lsa->len);
			errno = saveerrno;
		}
	} else
#endif
	{
		if (sep->se_family == AF_UNIX) {
			struct sockaddr_un *sun;
			sun = (struct sockaddr_un*)&(sep->se_lsa->u.sa);
			unlink(sun->sun_path);
		}
		r = bind(fd, &sep->se_lsa->u.sa, sep->se_lsa->len);
	}
	if (r < 0) {
		bb_perror_msg(""%s/%s: bind"",
				sep->se_service, sep->se_proto);
		close(fd);
		rearm_alarm();
		return;
	}

	if (sep->se_socktype == SOCK_STREAM) {
		listen(fd, global_queuelen);
		dbg(""new sep->se_fd:%d (stream)\n"", fd);
	} else {
		dbg(""new sep->se_fd:%d (!stream)\n"", fd);
	}

	add_fd_to_set(fd);
	sep->se_fd = fd;
}

static int reopen_config_file(void)
{
	free(default_local_hostname);
	default_local_hostname = xstrdup(""*"");
	if (parser != NULL)
		config_close(parser);
	parser = config_open(config_filename);
	return (parser != NULL);
}

static void close_config_file(void)
{
	if (parser) {
		config_close(parser);
		parser = NULL;
	}
}

static void free_servtab_strings(servtab_t *cp)
{
	int i;

	free(cp->se_local_hostname);
	free(cp->se_service);
	free(cp->se_proto);
	free(cp->se_user);
	free(cp->se_group);
	free(cp->se_lsa); /* not a string in fact */
	free(cp->se_program);
	for (i = 0; i < MAXARGV; i++)
		free(cp->se_argv[i]);
}

static servtab_t *new_servtab(void)
{
	servtab_t *newtab = xzalloc(sizeof(servtab_t));
	newtab->se_fd = -1; /* paranoia */
	return newtab;
}

static servtab_t *dup_servtab(servtab_t *sep)
{
	servtab_t *newtab;
	int argc;

	newtab = new_servtab();
	*newtab = *sep; /* struct copy */
	/* deep-copying strings */
	newtab->se_service = xstrdup(newtab->se_service);
	newtab->se_proto = xstrdup(newtab->se_proto);
	newtab->se_user = xstrdup(newtab->se_user);
	newtab->se_group = xstrdup(newtab->se_group);
	newtab->se_program = xstrdup(newtab->se_program);
	for (argc = 0; argc <= MAXARGV; argc++)
		newtab->se_argv[argc] = xstrdup(newtab->se_argv[argc]);
	/* NB: se_fd, se_hostaddr and se_next are always
	 * overwrittend by callers, so we don't bother resetting them
	 * to NULL/0/-1 etc */

	return newtab;
}

/* gcc generates much more code if this is inlined */
static servtab_t *parse_one_line(void)
{
	int argc;
	char *token[6+MAXARGV];
	char *p, *arg;
	char *hostdelim;
	servtab_t *sep;
	servtab_t *nsep;
 new:
	sep = new_servtab();
 more:
	argc = config_read(parser, token, 6+MAXARGV, 1, ""# \t"", PARSE_NORMAL);
	if (!argc) {
		free(sep);
		return NULL;
	}

	/* [host:]service socktype proto wait user[:group] prog [args] */
	/* Check for ""host:...."" line */
	arg = token[0];
	hostdelim = strrchr(arg, ':');
	if (hostdelim) {
		*hostdelim = '\0';
		sep->se_local_hostname = xstrdup(arg);
		arg = hostdelim + 1;
		if (*arg == '\0' && argc == 1) {
			/* Line has just ""host:"", change the
			 * default host for the following lines. */
			free(default_local_hostname);
			default_local_hostname = sep->se_local_hostname;
			goto more;
		}
	} else
		sep->se_local_hostname = xstrdup(default_local_hostname);

	/* service socktype proto wait user[:group] prog [args] */
	sep->se_service = xstrdup(arg);

	/* socktype proto wait user[:group] prog [args] */
	if (argc < 6) {
 parse_err:
		bb_error_msg(""parse error on line %u, line is ignored"",
				parser->lineno);
		free_servtab_strings(sep);
		/* Just ""goto more"" can make sep to carry over e.g.
		 * ""rpc""-ness (by having se_rpcver_lo != 0).
		 * We will be more paranoid: */
		free(sep);
		goto new;
	}

	{
		static const int8_t SOCK_xxx[] ALIGN1 = {
			-1,
			SOCK_STREAM, SOCK_DGRAM, SOCK_RDM,
			SOCK_SEQPACKET, SOCK_RAW
		};
		sep->se_socktype = SOCK_xxx[1 + index_in_strings(
			""stream""""\0"" ""dgram""""\0"" ""rdm""""\0""
			""seqpacket""""\0"" ""raw""""\0""
			, token[1])];
	}

	/* {unix,[rpc/]{tcp,udp}[6]} wait user[:group] prog [args] */
	sep->se_proto = arg = xstrdup(token[2]);
	if (strcmp(arg, ""unix"") == 0) {
		sep->se_family = AF_UNIX;
	} else {
		char *six;
		sep->se_family = AF_INET;
		six = last_char_is(arg, '6');
		if (six) {
#if ENABLE_FEATURE_IPV6
			*six = '\0';
			sep->se_family = AF_INET6;
#else
			bb_error_msg(""%s: no support for IPv6"", sep->se_proto);
			goto parse_err;
#endif
		}
		if (strncmp(arg, ""rpc/"", 4) == 0) {
#if ENABLE_FEATURE_INETD_RPC
			unsigned n;
			arg += 4;
			p = strchr(sep->se_service, '/');
			if (p == NULL) {
				bb_error_msg(""no rpc version: '%s'"", sep->se_service);
				goto parse_err;
			}
			*p++ = '\0';
			n = bb_strtou(p, &p, 10);
			if (n > INT_MAX) {
 bad_ver_spec:
				bb_error_msg(""bad rpc version"");
				goto parse_err;
			}
			sep->se_rpcver_lo = sep->se_rpcver_hi = n;
			if (*p == '-') {
				p++;
				n = bb_strtou(p, &p, 10);
				if (n > INT_MAX || (int)n < sep->se_rpcver_lo)
					goto bad_ver_spec;
				sep->se_rpcver_hi = n;
			}
			if (*p != '\0')
				goto bad_ver_spec;
#else
			bb_error_msg(""no support for rpc services"");
			goto parse_err;
#endif
		}
		/* we don't really need getprotobyname()! */
		if (strcmp(arg, ""tcp"") == 0)
			sep->se_proto_no = IPPROTO_TCP; /* = 6 */
		if (strcmp(arg, ""udp"") == 0)
			sep->se_proto_no = IPPROTO_UDP; /* = 17 */
		if (six)
			*six = '6';
		if (!sep->se_proto_no) /* not tcp/udp?? */
			goto parse_err;
	}

	/* [no]wait[.max] user[:group] prog [args] */
	arg = token[3];
	sep->se_max = max_concurrency;
	p = strchr(arg, '.');
	if (p) {
		*p++ = '\0';
		sep->se_max = bb_strtou(p, NULL, 10);
		if (errno)
			goto parse_err;
	}
	sep->se_wait = (arg[0] != 'n' || arg[1] != 'o');
	if (!sep->se_wait) /* ""no"" seen */
		arg += 2;
	if (strcmp(arg, ""wait"") != 0)
		goto parse_err;

	/* user[:group] prog [args] */
	sep->se_user = xstrdup(token[4]);
	arg = strchr(sep->se_user, '.');
	if (arg == NULL)
		arg = strchr(sep->se_user, ':');
	if (arg) {
		*arg++ = '\0';
		sep->se_group = xstrdup(arg);
	}

	/* prog [args] */
	sep->se_program = xstrdup(token[5]);
#ifdef INETD_BUILTINS_ENABLED
	if (strcmp(sep->se_program, ""internal"") == 0
	 && strlen(sep->se_service) <= 7
	 && (sep->se_socktype == SOCK_STREAM
	     || sep->se_socktype == SOCK_DGRAM)
	) {
		unsigned i;
		for (i = 0; i < ARRAY_SIZE(builtins); i++)
			if (strncmp(builtins[i].bi_service7, sep->se_service, 7) == 0)
				goto found_bi;
		bb_error_msg(""unknown internal service %s"", sep->se_service);
		goto parse_err;
 found_bi:
		sep->se_builtin = &builtins[i];
		/* stream builtins must be ""nowait"", dgram must be ""wait"" */
		if (sep->se_wait != (sep->se_socktype == SOCK_DGRAM))
			goto parse_err;
	}
#endif
	argc = 0;
	while ((arg = token[6+argc]) != NULL && argc < MAXARGV)
		sep->se_argv[argc++] = xstrdup(arg);
	/* Some inetd.conf files have no argv's, not even argv[0].
	 * Fix them up.
	 * (Technically, programs can be execed with argv[0] = NULL,
	 * but many programs do not like that at all) */
	if (argc == 0)
		sep->se_argv[0] = xstrdup(sep->se_program);

	/* catch mixups. ""<service> stream udp ..."" == wtf */
	if (sep->se_socktype == SOCK_STREAM) {
		if (sep->se_proto_no == IPPROTO_UDP)
			goto parse_err;
	}
	if (sep->se_socktype == SOCK_DGRAM) {
		if (sep->se_proto_no == IPPROTO_TCP)
			goto parse_err;
	}

//	bb_info_msg(
//		""ENTRY[%s][%s][%s][%d][%d][%d][%d][%d][%s][%s][%s]"",
//		sep->se_local_hostname, sep->se_service, sep->se_proto, sep->se_wait, sep->se_proto_no,
//		sep->se_max, sep->se_count, sep->se_time, sep->se_user, sep->se_group, sep->se_program);

	/* check if the hostname specifier is a comma separated list
	 * of hostnames. we'll make new entries for each address. */
	while ((hostdelim = strrchr(sep->se_local_hostname, ',')) != NULL) {
		nsep = dup_servtab(sep);
		/* NUL terminate the hostname field of the existing entry,
		 * and make a dup for the new entry. */
		*hostdelim++ = '\0';
		nsep->se_local_hostname = xstrdup(hostdelim);
		nsep->se_next = sep->se_next;
		sep->se_next = nsep;
	}

	/* was doing it here: */
	/* DNS resolution, create copies for each IP address */
	/* IPv6-ization destroyed it :( */

	return sep;
}

static servtab_t *insert_in_servlist(servtab_t *cp)
{
	servtab_t *sep;
	sigset_t omask;

	sep = new_servtab();
	*sep = *cp; /* struct copy */
	sep->se_fd = -1;
#if ENABLE_FEATURE_INETD_RPC
	sep->se_rpcprog = -1;
#endif
	block_CHLD_HUP_ALRM(&omask);
	sep->se_next = serv_list;
	serv_list = sep;
	restore_sigmask(&omask);
	return sep;
}

static int same_serv_addr_proto(servtab_t *old, servtab_t *new)
{
	if (strcmp(old->se_local_hostname, new->se_local_hostname) != 0)
		return 0;
	if (strcmp(old->se_service, new->se_service) != 0)
		return 0;
	if (strcmp(old->se_proto, new->se_proto) != 0)
		return 0;
	return 1;
}

static void reread_config_file(int sig UNUSED_PARAM)
{
	servtab_t *sep, *cp, **sepp;
	len_and_sockaddr *lsa;
	sigset_t omask;
	unsigned n;
	uint16_t port;
	int save_errno = errno;

	if (!reopen_config_file())
		goto ret;
	for (sep = serv_list; sep; sep = sep->se_next)
		sep->se_checked = 0;

	goto first_line;
	while (1) {
		if (cp == NULL) {
 first_line:
			cp = parse_one_line();
			if (cp == NULL)
				break;
		}
		for (sep = serv_list; sep; sep = sep->se_next)
			if (same_serv_addr_proto(sep, cp))
				goto equal_servtab;
		/* not an ""equal"" servtab */
		sep = insert_in_servlist(cp);
		goto after_check;
 equal_servtab:
		{
			int i;

			block_CHLD_HUP_ALRM(&omask);
#if ENABLE_FEATURE_INETD_RPC
			if (is_rpc_service(sep))
				unregister_rpc(sep);
			sep->se_rpcver_lo = cp->se_rpcver_lo;
			sep->se_rpcver_hi = cp->se_rpcver_hi;
#endif
			if (cp->se_wait == 0) {
				/* New config says ""nowait"". If old one
				 * was ""wait"", we currently may be waiting
				 * for a child (and not accepting connects).
				 * Stop waiting, start listening again.
				 * (if it's not true, this op is harmless) */
				add_fd_to_set(sep->se_fd);
			}
			sep->se_wait = cp->se_wait;
			sep->se_max = cp->se_max;
			/* string fields need more love - we don't want to leak them */
#define SWAP(type, a, b) do { type c = (type)a; a = (type)b; b = (type)c; } while (0)
			SWAP(char*, sep->se_user, cp->se_user);
			SWAP(char*, sep->se_group, cp->se_group);
			SWAP(char*, sep->se_program, cp->se_program);
			for (i = 0; i < MAXARGV; i++)
				SWAP(char*, sep->se_argv[i], cp->se_argv[i]);
#undef SWAP
			restore_sigmask(&omask);
			free_servtab_strings(cp);
		}
 after_check:
		/* cp->string_fields are consumed by insert_in_servlist()
		 * or freed at this point, cp itself is not yet freed. */
		sep->se_checked = 1;

		/* create new len_and_sockaddr */
		switch (sep->se_family) {
			struct sockaddr_un *sun;
		case AF_UNIX:
			lsa = xzalloc_lsa(AF_UNIX);
			sun = (struct sockaddr_un*)&lsa->u.sa;
			safe_strncpy(sun->sun_path, sep->se_service, sizeof(sun->sun_path));
			break;

		default: /* case AF_INET, case AF_INET6 */
			n = bb_strtou(sep->se_service, NULL, 10);
#if ENABLE_FEATURE_INETD_RPC
			if (is_rpc_service(sep)) {
				sep->se_rpcprog = n;
				if (errno) { /* se_service is not numeric */
					struct rpcent *rp = getrpcbyname(sep->se_service);
					if (rp == NULL) {
						bb_error_msg(""%s: unknown rpc service"", sep->se_service);
						goto next_cp;
					}
					sep->se_rpcprog = rp->r_number;
				}
				if (sep->se_fd == -1)
					prepare_socket_fd(sep);
				if (sep->se_fd != -1)
					register_rpc(sep);
				goto next_cp;
			}
#endif
			/* what port to listen on? */
			port = htons(n);
			if (errno || n > 0xffff) { /* se_service is not numeric */
				char protoname[4];
				struct servent *sp;
				/* can result only in ""tcp"" or ""udp"": */
				safe_strncpy(protoname, sep->se_proto, 4);
				sp = getservbyname(sep->se_service, protoname);
				if (sp == NULL) {
					bb_error_msg(""%s/%s: unknown service"",
							sep->se_service, sep->se_proto);
					goto next_cp;
				}
				port = sp->s_port;
			}
			if (LONE_CHAR(sep->se_local_hostname, '*')) {
				lsa = xzalloc_lsa(sep->se_family);
				set_nport(&lsa->u.sa, port);
			} else {
				lsa = host_and_af2sockaddr(sep->se_local_hostname,
						ntohs(port), sep->se_family);
				if (!lsa) {
					bb_error_msg(""%s/%s: unknown host '%s'"",
						sep->se_service, sep->se_proto,
						sep->se_local_hostname);
					goto next_cp;
				}
			}
			break;
		} /* end of ""switch (sep->se_family)"" */

		/* did lsa change? Then close/open */
		if (sep->se_lsa == NULL
		 || lsa->len != sep->se_lsa->len
		 || memcmp(&lsa->u.sa, &sep->se_lsa->u.sa, lsa->len) != 0
		) {
			remove_fd_from_set(sep->se_fd);
			maybe_close(sep->se_fd);
			free(sep->se_lsa);
			sep->se_lsa = lsa;
			sep->se_fd = -1;
		} else {
			free(lsa);
		}
		if (sep->se_fd == -1)
			prepare_socket_fd(sep);
 next_cp:
		sep = cp->se_next;
		free(cp);
		cp = sep;
	} /* end of ""while (1) parse lines"" */
	close_config_file();

	/* Purge anything not looked at above - these are stale entries,
	 * new config file doesnt have them. */
	block_CHLD_HUP_ALRM(&omask);
	sepp = &serv_list;
	while ((sep = *sepp) != NULL) {
		if (sep->se_checked) {
			sepp = &sep->se_next;
			continue;
		}
		*sepp = sep->se_next;
		remove_fd_from_set(sep->se_fd);
		maybe_close(sep->se_fd);
#if ENABLE_FEATURE_INETD_RPC
		if (is_rpc_service(sep))
			unregister_rpc(sep);
#endif
		if (sep->se_family == AF_UNIX)
			unlink(sep->se_service);
		free_servtab_strings(sep);
		free(sep);
	}
	restore_sigmask(&omask);
 ret:
	errno = save_errno;
}

static void reap_child(int sig UNUSED_PARAM)
{
	pid_t pid;
	int status;
	servtab_t *sep;
	int save_errno = errno;

	for (;;) {
		pid = wait_any_nohang(&status);
		if (pid <= 0)
			break;
		for (sep = serv_list; sep; sep = sep->se_next) {
			if (sep->se_wait != pid)
				continue;
			/* One of our ""wait"" services */
			if (WIFEXITED(status) && WEXITSTATUS(status))
				bb_error_msg(""%s: exit status %u"",
						sep->se_program, WEXITSTATUS(status));
			else if (WIFSIGNALED(status))
				bb_error_msg(""%s: exit signal %u"",
						sep->se_program, WTERMSIG(status));
			sep->se_wait = 1;
			add_fd_to_set(sep->se_fd);
			break;
		}
	}
	errno = save_errno;
}

static void retry_network_setup(int sig UNUSED_PARAM)
{
	int save_errno = errno;
	servtab_t *sep;

	alarm_armed = 0;
	for (sep = serv_list; sep; sep = sep->se_next) {
		if (sep->se_fd == -1) {
			prepare_socket_fd(sep);
#if ENABLE_FEATURE_INETD_RPC
			if (sep->se_fd != -1 && is_rpc_service(sep))
				register_rpc(sep);
#endif
		}
	}
	errno = save_errno;
}

static void clean_up_and_exit(int sig UNUSED_PARAM)
{
	servtab_t *sep;

	/* XXX signal race walking sep list */
	for (sep = serv_list; sep; sep = sep->se_next) {
		if (sep->se_fd == -1)
			continue;

		switch (sep->se_family) {
		case AF_UNIX:
			unlink(sep->se_service);
			break;
		default: /* case AF_INET, AF_INET6 */
#if ENABLE_FEATURE_INETD_RPC
			if (sep->se_wait == 1 && is_rpc_service(sep))
				unregister_rpc(sep);   /* XXX signal race */
#endif
			break;
		}
		if (ENABLE_FEATURE_CLEAN_UP)
			close(sep->se_fd);
	}
	remove_pidfile(CONFIG_PID_FILE_PATH ""/inetd.pid"");
	exit(EXIT_SUCCESS);
}

int inetd_main(int argc, char **argv) MAIN_EXTERNALLY_VISIBLE;
int inetd_main(int argc UNUSED_PARAM, char **argv)
{
	struct sigaction sa, saved_pipe_handler;
	servtab_t *sep, *sep2;
	struct passwd *pwd;
	struct group *grp = grp; /* for compiler */
	int opt;
	pid_t pid;
	sigset_t omask;

	INIT_G();

	real_uid = getuid();
	if (real_uid != 0) /* run by non-root user */
		config_filename = NULL;

	opt_complementary = ""R+:q+""; /* -q N, -R N */
	opt = getopt32(argv, ""R:feq:"", &max_concurrency, &global_queuelen);
	argv += optind;
	//argc -= optind;
	if (argv[0])
		config_filename = argv[0];
	if (config_filename == NULL)
		bb_error_msg_and_die(""non-root must specify config file"");
	if (!(opt & 2))
		bb_daemonize_or_rexec(0, argv - optind);
	else
		bb_sanitize_stdio();
	if (!(opt & 4)) {
		/* LOG_NDELAY: connect to syslog daemon NOW.
		 * Otherwise, we may open syslog socket
		 * in vforked child, making opened fds and syslog()
		 * internal state inconsistent.
		 * This was observed to leak file descriptors. */
		openlog(applet_name, LOG_PID | LOG_NDELAY, LOG_DAEMON);
		logmode = LOGMODE_SYSLOG;
	}

	if (real_uid == 0) {
		/* run by root, ensure groups vector gets trashed */
		gid_t gid = getgid();
		setgroups(1, &gid);
	}

	write_pidfile(CONFIG_PID_FILE_PATH ""/inetd.pid"");

	/* never fails under Linux (except if you pass it bad arguments) */
	getrlimit(RLIMIT_NOFILE, &rlim_ofile);
	rlim_ofile_cur = rlim_ofile.rlim_cur;
	if (rlim_ofile_cur == RLIM_INFINITY)    /* ! */
		rlim_ofile_cur = OPEN_MAX;

	memset(&sa, 0, sizeof(sa));
	/*sigemptyset(&sa.sa_mask); - memset did it */
	sigaddset(&sa.sa_mask, SIGALRM);
	sigaddset(&sa.sa_mask, SIGCHLD);
	sigaddset(&sa.sa_mask, SIGHUP);
//FIXME: explain why no SA_RESTART
//FIXME: retry_network_setup is unsafe to run in signal handler (many reasons)!
	sa.sa_handler = retry_network_setup;
	sigaction_set(SIGALRM, &sa);
//FIXME: reread_config_file is unsafe to run in signal handler(many reasons)!
	sa.sa_handler = reread_config_file;
	sigaction_set(SIGHUP, &sa);
//FIXME: reap_child is unsafe to run in signal handler (uses stdio)!
	sa.sa_handler = reap_child;
	sigaction_set(SIGCHLD, &sa);
//FIXME: clean_up_and_exit is unsafe to run in signal handler (uses stdio)!
	sa.sa_handler = clean_up_and_exit;
	sigaction_set(SIGTERM, &sa);
	sa.sa_handler = clean_up_and_exit;
	sigaction_set(SIGINT, &sa);
	sa.sa_handler = SIG_IGN;
	sigaction(SIGPIPE, &sa, &saved_pipe_handler);

	reread_config_file(SIGHUP); /* load config from file */

	for (;;) {
		int ready_fd_cnt;
		int ctrl, accepted_fd, new_udp_fd;
		fd_set readable;

		if (maxsock < 0)
			recalculate_maxsock();

		readable = allsock; /* struct copy */
		/* if there are no fds to wait on, we will block
		 * until signal wakes us up (maxsock == 0, but readable
		 * never contains fds 0 and 1...) */
		ready_fd_cnt = select(maxsock + 1, &readable, NULL, NULL, NULL);
		if (ready_fd_cnt < 0) {
			if (errno != EINTR) {
				bb_perror_msg(""select"");
				sleep(1);
			}
			continue;
		}
		dbg(""ready_fd_cnt:%d\n"", ready_fd_cnt);

		for (sep = serv_list; ready_fd_cnt && sep; sep = sep->se_next) {
			if (sep->se_fd == -1 || !FD_ISSET(sep->se_fd, &readable))
				continue;

			dbg(""ready fd:%d\n"", sep->se_fd);
			ready_fd_cnt--;
			ctrl = sep->se_fd;
			accepted_fd = -1;
			new_udp_fd = -1;
			if (!sep->se_wait) {
				if (sep->se_socktype == SOCK_STREAM) {
					ctrl = accepted_fd = accept(sep->se_fd, NULL, NULL);
					dbg(""accepted_fd:%d\n"", accepted_fd);
					if (ctrl < 0) {
						if (errno != EINTR)
							bb_perror_msg(""accept (for %s)"", sep->se_service);
						continue;
					}
				}
				/* ""nowait"" udp */
				if (sep->se_socktype == SOCK_DGRAM
				 && sep->se_family != AF_UNIX
				) {
/* How udp ""nowait"" works:
 * child peeks at (received and buffered by kernel) UDP packet,
 * performs connect() on the socket so that it is linked only
 * to this peer. But this also affects parent, because descriptors
 * are shared after fork() a-la dup(). When parent performs
 * select(), it will see this descriptor connected to the peer (!)
 * and still readable, will act on it and mess things up
 * (can create many copies of same child, etc).
 * Parent must create and use new socket instead. */
					new_udp_fd = socket(sep->se_family, SOCK_DGRAM, 0);
					dbg(""new_udp_fd:%d\n"", new_udp_fd);
					if (new_udp_fd < 0) { /* error: eat packet, forget about it */
 udp_err:
						recv(sep->se_fd, line, LINE_SIZE, MSG_DONTWAIT);
						continue;
					}
					setsockopt_reuseaddr(new_udp_fd);
					/* TODO: better do bind after fork in parent,
					 * so that we don't have two wildcard bound sockets
					 * even for a brief moment? */
					if (bind(new_udp_fd, &sep->se_lsa->u.sa, sep->se_lsa->len) < 0) {
						dbg(""bind(new_udp_fd) failed\n"");
						close(new_udp_fd);
						goto udp_err;
					}
					dbg(""bind(new_udp_fd) succeeded\n"");
				}
			}

			block_CHLD_HUP_ALRM(&omask);
			pid = 0;
#ifdef INETD_BUILTINS_ENABLED
			/* do we need to fork? */
			if (sep->se_builtin == NULL
			 || (sep->se_socktype == SOCK_STREAM
			     && sep->se_builtin->bi_fork))
#endif
			{
				if (sep->se_max != 0) {
					if (++sep->se_count == 1)
						sep->se_time = monotonic_sec();
					else if (sep->se_count >= sep->se_max) {
						unsigned now = monotonic_sec();
						/* did we accumulate se_max connects too quickly? */
						if (now - sep->se_time <= CNT_INTERVAL) {
							bb_error_msg(""%s/%s: too many connections, pausing"",
									sep->se_service, sep->se_proto);
							remove_fd_from_set(sep->se_fd);
							close(sep->se_fd);
							sep->se_fd = -1;
							sep->se_count = 0;
							rearm_alarm(); /* will revive it in RETRYTIME sec */
							restore_sigmask(&omask);
							maybe_close(new_udp_fd);
							maybe_close(accepted_fd);
							continue; /* -> check next fd in fd set */
						}
						sep->se_count = 0;
					}
				}
				/* on NOMMU, streamed chargen
				 * builtin wouldn't work, but it is
				 * not allowed on NOMMU (ifdefed out) */
#ifdef INETD_BUILTINS_ENABLED
				if (BB_MMU && sep->se_builtin)
					pid = fork();
				else
#endif
					pid = vfork();

				if (pid < 0) { /* fork error */
					bb_perror_msg(""vfork""+1);
					sleep(1);
					restore_sigmask(&omask);
					maybe_close(new_udp_fd);
					maybe_close(accepted_fd);
					continue; /* -> check next fd in fd set */
				}
				if (pid == 0)
					pid--; /* -1: ""we did fork and we are child"" */
			}
			/* if pid == 0 here, we didn't fork */

			if (pid > 0) { /* parent */
				if (sep->se_wait) {
					/* wait: we passed socket to child,
					 * will wait for child to terminate */
					sep->se_wait = pid;
					remove_fd_from_set(sep->se_fd);
				}
				if (new_udp_fd >= 0) {
					/* udp nowait: child connected the socket,
					 * we created and will use new, unconnected one */
					xmove_fd(new_udp_fd, sep->se_fd);
					dbg(""moved new_udp_fd:%d to sep->se_fd:%d\n"", new_udp_fd, sep->se_fd);
				}
				restore_sigmask(&omask);
				maybe_close(accepted_fd);
				continue; /* -> check next fd in fd set */
			}

			/* we are either child or didn't fork at all */
#ifdef INETD_BUILTINS_ENABLED
			if (sep->se_builtin) {
				if (pid) { /* ""pid"" is -1: we did fork */
					close(sep->se_fd); /* listening socket */
					dbg(""closed sep->se_fd:%d\n"", sep->se_fd);
					logmode = LOGMODE_NONE; /* make xwrite etc silent */
				}
				restore_sigmask(&omask);
				if (sep->se_socktype == SOCK_STREAM)
					sep->se_builtin->bi_stream_fn(ctrl, sep);
				else
					sep->se_builtin->bi_dgram_fn(ctrl, sep);
				if (pid) /* we did fork */
					_exit(EXIT_FAILURE);
				maybe_close(accepted_fd);
				continue; /* -> check next fd in fd set */
			}
#endif
			/* child */
			setsid();
			/* ""nowait"" udp */
			if (new_udp_fd >= 0) {
				len_and_sockaddr *lsa;
				int r;

				close(new_udp_fd);
				dbg(""closed new_udp_fd:%d\n"", new_udp_fd);
				lsa = xzalloc_lsa(sep->se_family);
				/* peek at the packet and remember peer addr */
				r = recvfrom(ctrl, NULL, 0, MSG_PEEK|MSG_DONTWAIT,
					&lsa->u.sa, &lsa->len);
				if (r < 0)
					goto do_exit1;
				/* make this socket ""connected"" to peer addr:
				 * only packets from this peer will be recv'ed,
				 * and bare write()/send() will work on it */
				connect(ctrl, &lsa->u.sa, lsa->len);
				dbg(""connected ctrl:%d to remote peer\n"", ctrl);
				free(lsa);
			}
			/* prepare env and exec program */
			pwd = getpwnam(sep->se_user);
			if (pwd == NULL) {
				bb_error_msg(""%s: no such %s"", sep->se_user, ""user"");
				goto do_exit1;
			}
			if (sep->se_group && (grp = getgrnam(sep->se_group)) == NULL) {
				bb_error_msg(""%s: no such %s"", sep->se_group, ""group"");
				goto do_exit1;
			}
			if (real_uid != 0 && real_uid != pwd->pw_uid) {
				/* a user running private inetd */
				bb_error_msg(""non-root must run services as himself"");
				goto do_exit1;
			}
			if (pwd->pw_uid != 0) {
				if (sep->se_group)
					pwd->pw_gid = grp->gr_gid;
				/* initgroups, setgid, setuid: */
				change_identity(pwd);
			} else if (sep->se_group) {
				xsetgid(grp->gr_gid);
				setgroups(1, &grp->gr_gid);
			}
			if (rlim_ofile.rlim_cur != rlim_ofile_cur)
				if (setrlimit(RLIMIT_NOFILE, &rlim_ofile) < 0)
					bb_perror_msg(""setrlimit"");

			/* closelog(); - WRONG. we are after vfork,
			 * this may confuse syslog() internal state.
			 * Let's hope libc sets syslog fd to CLOEXEC...
			 */
			xmove_fd(ctrl, STDIN_FILENO);
			xdup2(STDIN_FILENO, STDOUT_FILENO);
			dbg(""moved ctrl:%d to fd 0,1[,2]\n"", ctrl);
			/* manpages of inetd I managed to find either say
			 * that stderr is also redirected to the network,
			 * or do not talk about redirection at all (!) */
			if (!sep->se_wait) /* only for usual ""tcp nowait"" */
				xdup2(STDIN_FILENO, STDERR_FILENO);
			/* NB: among others, this loop closes listening sockets
			 * for nowait stream children */
			for (sep2 = serv_list; sep2; sep2 = sep2->se_next)
				if (sep2->se_fd != ctrl)
					maybe_close(sep2->se_fd);
			sigaction_set(SIGPIPE, &saved_pipe_handler);
			restore_sigmask(&omask);
			dbg(""execing:'%s'\n"", sep->se_program);
			BB_EXECVP(sep->se_program, sep->se_argv);
			bb_perror_msg(""can't execute '%s'"", sep->se_program);
 do_exit1:
			/* eat packet in udp case */
			if (sep->se_socktype != SOCK_STREAM)
				recv(0, line, LINE_SIZE, MSG_DONTWAIT);
			_exit(EXIT_FAILURE);
		} /* for (sep = servtab...) */
	} /* for (;;) */
}

#if !BB_MMU
static const char *const cat_args[] = { ""cat"", NULL };
#endif

/*
 * Internet services provided internally by inetd:
 */
#if ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_ECHO
/* Echo service -- echo data back. */
/* ARGSUSED */
static void FAST_FUNC echo_stream(int s, servtab_t *sep UNUSED_PARAM)
{
#if BB_MMU
	while (1) {
		ssize_t sz = safe_read(s, line, LINE_SIZE);
		if (sz <= 0)
			break;
		xwrite(s, line, sz);
	}
#else
	/* We are after vfork here! */
	/* move network socket to stdin/stdout */
	xmove_fd(s, STDIN_FILENO);
	xdup2(STDIN_FILENO, STDOUT_FILENO);
	/* no error messages please... */
	close(STDERR_FILENO);
	xopen(bb_dev_null, O_WRONLY);
	BB_EXECVP(""cat"", (char**)cat_args);
	/* on failure we return to main, which does exit(EXIT_FAILURE) */
#endif
}
static void FAST_FUNC echo_dg(int s, servtab_t *sep)
{
	enum { BUFSIZE = 12*1024 }; /* for jumbo sized packets! :) */
	char *buf = xmalloc(BUFSIZE); /* too big for stack */
	int sz;
	len_and_sockaddr *lsa = alloca(LSA_LEN_SIZE + sep->se_lsa->len);

	lsa->len = sep->se_lsa->len;
	/* dgram builtins are non-forking - DONT BLOCK! */
	sz = recvfrom(s, buf, BUFSIZE, MSG_DONTWAIT, &lsa->u.sa, &lsa->len);
	if (sz > 0)
		sendto(s, buf, sz, 0, &lsa->u.sa, lsa->len);
	free(buf);
}
#endif  /* FEATURE_INETD_SUPPORT_BUILTIN_ECHO */


#if ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_DISCARD
/* Discard service -- ignore data. */
/* ARGSUSED */
static void FAST_FUNC discard_stream(int s, servtab_t *sep UNUSED_PARAM)
{
#if BB_MMU
	while (safe_read(s, line, LINE_SIZE) > 0)
		continue;
#else
	/* We are after vfork here! */
	/* move network socket to stdin */
	xmove_fd(s, STDIN_FILENO);
	/* discard output */
	close(STDOUT_FILENO);
	xopen(bb_dev_null, O_WRONLY);
	/* no error messages please... */
	xdup2(STDOUT_FILENO, STDERR_FILENO);
	BB_EXECVP(""cat"", (char**)cat_args);
	/* on failure we return to main, which does exit(EXIT_FAILURE) */
#endif
}
/* ARGSUSED */
static void FAST_FUNC discard_dg(int s, servtab_t *sep UNUSED_PARAM)
{
	/* dgram builtins are non-forking - DONT BLOCK! */
	recv(s, line, LINE_SIZE, MSG_DONTWAIT);
}
#endif /* FEATURE_INETD_SUPPORT_BUILTIN_DISCARD */


#if ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_CHARGEN
#define LINESIZ 72
static void init_ring(void)
{
	int i;

	end_ring = ring;
	for (i = ' '; i < 127; i++)
		*end_ring++ = i;
}
/* Character generator. MMU arches only. */
/* ARGSUSED */
static void FAST_FUNC chargen_stream(int s, servtab_t *sep UNUSED_PARAM)
{
	char *rs;
	int len;
	char text[LINESIZ + 2];

	if (!end_ring) {
		init_ring();
		rs = ring;
	}

	text[LINESIZ] = '\r';
	text[LINESIZ + 1] = '\n';
	rs = ring;
	for (;;) {
		len = end_ring - rs;
		if (len >= LINESIZ)
			memmove(text, rs, LINESIZ);
		else {
			memmove(text, rs, len);
			memmove(text + len, ring, LINESIZ - len);
		}
		if (++rs == end_ring)
			rs = ring;
		xwrite(s, text, sizeof(text));
	}
}
/* ARGSUSED */
static void FAST_FUNC chargen_dg(int s, servtab_t *sep)
{
	int len;
	char text[LINESIZ + 2];
	len_and_sockaddr *lsa = alloca(LSA_LEN_SIZE + sep->se_lsa->len);

	/* Eat UDP packet which started it all */
	/* dgram builtins are non-forking - DONT BLOCK! */
	lsa->len = sep->se_lsa->len;
	if (recvfrom(s, text, sizeof(text), MSG_DONTWAIT, &lsa->u.sa, &lsa->len) < 0)
		return;

	if (!end_ring) {
		init_ring();
		ring_pos = ring;
	}

	len = end_ring - ring_pos;
	if (len >= LINESIZ)
		memmove(text, ring_pos, LINESIZ);
	else {
		memmove(text, ring_pos, len);
		memmove(text + len, ring, LINESIZ - len);
	}
	if (++ring_pos == end_ring)
		ring_pos = ring;
	text[LINESIZ] = '\r';
	text[LINESIZ + 1] = '\n';
	sendto(s, text, sizeof(text), 0, &lsa->u.sa, lsa->len);
}
#endif /* FEATURE_INETD_SUPPORT_BUILTIN_CHARGEN */


#if ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_TIME
/*
 * Return a machine readable date and time, in the form of the
 * number of seconds since midnight, Jan 1, 1900.  Since gettimeofday
 * returns the number of seconds since midnight, Jan 1, 1970,
 * we must add 2208988800 seconds to this figure to make up for
 * some seventy years Bell Labs was asleep.
 */
static uint32_t machtime(void)
{
	struct timeval tv;

	gettimeofday(&tv, NULL);
	return htonl((uint32_t)(tv.tv_sec + 2208988800));
}
/* ARGSUSED */
static void FAST_FUNC machtime_stream(int s, servtab_t *sep UNUSED_PARAM)
{
	uint32_t result;

	result = machtime();
	full_write(s, &result, sizeof(result));
}
static void FAST_FUNC machtime_dg(int s, servtab_t *sep)
{
	uint32_t result;
	len_and_sockaddr *lsa = alloca(LSA_LEN_SIZE + sep->se_lsa->len);

	lsa->len = sep->se_lsa->len;
	if (recvfrom(s, line, LINE_SIZE, MSG_DONTWAIT, &lsa->u.sa, &lsa->len) < 0)
		return;

	result = machtime();
	sendto(s, &result, sizeof(result), 0, &lsa->u.sa, lsa->len);
}
#endif /* FEATURE_INETD_SUPPORT_BUILTIN_TIME */


#if ENABLE_FEATURE_INETD_SUPPORT_BUILTIN_DAYTIME
/* Return human-readable time of day */
/* ARGSUSED */
static void FAST_FUNC daytime_stream(int s, servtab_t *sep UNUSED_PARAM)
{
	time_t t;

	t = time(NULL);
	fdprintf(s, ""%.24s\r\n"", ctime(&t));
}
static void FAST_FUNC daytime_dg(int s, servtab_t *sep)
{
	time_t t;
	len_and_sockaddr *lsa = alloca(LSA_LEN_SIZE + sep->se_lsa->len);

	lsa->len = sep->se_lsa->len;
	if (recvfrom(s, line, LINE_SIZE, MSG_DONTWAIT, &lsa->u.sa, &lsa->len) < 0)
		return;

	t = time(NULL);
	sprintf(line, ""%.24s\r\n"", ctime(&t));
	sendto(s, line, strlen(line), 0, &lsa->u.sa, lsa->len);
}
#endif /* FEATURE_INETD_SUPPORT_BUILTIN_DAYTIME */
",False,
190,195,NomosTestfiles/BSD/Inflate.java,"Apache-2.0
BSD-3-Clause","/*
 * Copyright 2009 Red Hat, Inc.
 *
 * Red Hat licenses this file to you under the Apache License, version 2.0
 * (the ""License""); you may not use this file except in compliance with the
 * License.  You may obtain a copy of the License at:
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an ""AS IS"" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
 * License for the specific language governing permissions and limitations
 * under the License.
 */
/*
Copyright (c) 2000,2001,2002,2003 ymnk, JCraft,Inc. All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

  1. Redistributions of source code must retain the above copyright notice,
     this list of conditions and the following disclaimer.

  2. Redistributions in binary form must reproduce the above copyright
     notice, this list of conditions and the following disclaimer in
     the documentation and/or other materials provided with the distribution.

  3. The names of the authors may not be used to endorse or promote products
     derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES,
INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL JCRAFT,
INC. OR ANY CONTRIBUTORS TO THIS SOFTWARE BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
/*
 * This program is based on zlib-1.1.3, so all credit should go authors
 * Jean-loup Gailly(jloup@gzip.org) and Mark Adler(madler@alumni.caltech.edu)
 * and contributors of zlib.
 */

package org.jboss.netty.util.internal.jzlib;

import org.jboss.netty.util.internal.jzlib.JZlib.WrapperType;

final class Inflate {

    private static final int METHOD = 0; // waiting for method byte
    private static final int FLAG = 1; // waiting for flag byte
    private static final int DICT4 = 2; // four dictionary check bytes to go
    private static final int DICT3 = 3; // three dictionary check bytes to go
    private static final int DICT2 = 4; // two dictionary check bytes to go
    private static final int DICT1 = 5; // one dictionary check byte to go
    private static final int DICT0 = 6; // waiting for inflateSetDictionary
    private static final int BLOCKS = 7; // decompressing blocks
    private static final int CHECK4 = 8; // four check bytes to go
    private static final int CHECK3 = 9; // three check bytes to go
    private static final int CHECK2 = 10; // two check bytes to go
    private static final int CHECK1 = 11; // one check byte to go
    private static final int DONE = 12; // finished check, done
    private static final int BAD = 13; // got an error--stay here

    private static final int GZIP_ID1 = 14;
    private static final int GZIP_ID2 = 15;
    private static final int GZIP_CM = 16;
    private static final int GZIP_FLG = 17;
    private static final int GZIP_MTIME_XFL_OS = 18;
    private static final int GZIP_XLEN = 19;
    private static final int GZIP_FEXTRA = 20;
    private static final int GZIP_FNAME = 21;
    private static final int GZIP_FCOMMENT = 22;
    private static final int GZIP_FHCRC = 23;
    private static final int GZIP_CRC32= 24;
    private static final int GZIP_ISIZE = 25;

    private int mode; // current inflate mode
    // mode dependent information
    private int method; // if FLAGS, method byte
    // if CHECK, check values to compare
    private final long[] was = new long[1]; // computed check value
    private long need; // stream check value
    // if BAD, inflateSync's marker bytes count
    private int marker;
    // mode independent information
    private WrapperType wrapperType;
    private int wbits; // log2(window size)  (8..15, defaults to 15)
    private InfBlocks blocks; // current inflate_blocks state
    private int gzipFlag;
    private int gzipBytesToRead;
    private int gzipXLen;
    private int gzipUncompressedBytes;
    private int gzipCRC32;
    private int gzipISize;

    private int inflateReset(ZStream z) {
        if (z == null || z.istate == null) {
            return JZlib.Z_STREAM_ERROR;
        }

        z.total_in = z.total_out = 0;
        z.msg = null;
        switch (wrapperType) {
        case NONE:
            z.istate.mode = BLOCKS;
            break;
        case ZLIB:
        case ZLIB_OR_NONE:
            z.istate.mode = METHOD;
            break;
        case GZIP:
            z.istate.mode = GZIP_ID1;
            break;
        }
        z.istate.blocks.reset(z, null);
        gzipUncompressedBytes = 0;
        return JZlib.Z_OK;
    }

    int inflateEnd(ZStream z) {
        if (blocks != null) {
            blocks.free(z);
        }
        blocks = null;
        //    ZFREE(z, z->state);
        return JZlib.Z_OK;
    }

    int inflateInit(ZStream z, int w, WrapperType wrapperType) {
        z.msg = null;
        blocks = null;

        this.wrapperType = wrapperType;

        if (w < 0) {
            throw new IllegalArgumentException(""w: "" + w);
        }

        // set window size
        if (w < 8 || w > 15) {
            inflateEnd(z);
            return JZlib.Z_STREAM_ERROR;
        }
        wbits = w;

        z.istate.blocks = new InfBlocks(
                z, z.istate.wrapperType == WrapperType.NONE? null : this,
                1 << w);

        // reset state
        inflateReset(z);
        return JZlib.Z_OK;
    }

    int inflate(ZStream z, int f) {
        int r;
        int b;

        if (z == null || z.istate == null || z.next_in == null) {
            return JZlib.Z_STREAM_ERROR;
        }
        f = f == JZlib.Z_FINISH? JZlib.Z_BUF_ERROR : JZlib.Z_OK;
        r = JZlib.Z_BUF_ERROR;
        while (true) {
            //System.out.println(""mode: ""+z.istate.mode);
            switch (z.istate.mode) {
            case METHOD:

                if (z.avail_in == 0) {
                    return r;
                }

                // Switch from zlib to none if necessary.
                if (z.istate.wrapperType == WrapperType.ZLIB_OR_NONE) {
                    if ((z.next_in[z.next_in_index] & 0xf) != JZlib.Z_DEFLATED ||
                        (z.next_in[z.next_in_index] >> 4) + 8 > z.istate.wbits) {
                        z.istate.wrapperType = WrapperType.NONE;
                        z.istate.mode = BLOCKS;
                        break;
                    } else {
                        z.istate.wrapperType = WrapperType.ZLIB;
                    }
                }

                r = f;

                z.avail_in --;
                z.total_in ++;
                if (((z.istate.method = z.next_in[z.next_in_index ++]) & 0xf) != JZlib.Z_DEFLATED) {
                    z.istate.mode = BAD;
                    z.msg = ""unknown compression method"";
                    z.istate.marker = 5; // can't try inflateSync
                    break;
                }
                if ((z.istate.method >> 4) + 8 > z.istate.wbits) {
                    z.istate.mode = BAD;
                    z.msg = ""invalid window size"";
                    z.istate.marker = 5; // can't try inflateSync
                    break;
                }
                z.istate.mode = FLAG;
            case FLAG:

                if (z.avail_in == 0) {
                    return r;
                }
                r = f;

                z.avail_in --;
                z.total_in ++;
                b = z.next_in[z.next_in_index ++] & 0xff;

                if (((z.istate.method << 8) + b) % 31 != 0) {
                    z.istate.mode = BAD;
                    z.msg = ""incorrect header check"";
                    z.istate.marker = 5; // can't try inflateSync
                    break;
                }

                if ((b & JZlib.PRESET_DICT) == 0) {
                    z.istate.mode = BLOCKS;
                    break;
                }
                z.istate.mode = DICT4;
            case DICT4:

                if (z.avail_in == 0) {
                    return r;
                }
                r = f;

                z.avail_in --;
                z.total_in ++;
                z.istate.need = (z.next_in[z.next_in_index ++] & 0xff) << 24 & 0xff000000L;
                z.istate.mode = DICT3;
            case DICT3:

                if (z.avail_in == 0) {
                    return r;
                }
                r = f;

                z.avail_in --;
                z.total_in ++;
                z.istate.need += (z.next_in[z.next_in_index ++] & 0xff) << 16 & 0xff0000L;
                z.istate.mode = DICT2;
            case DICT2:

                if (z.avail_in == 0) {
                    return r;
                }
                r = f;

                z.avail_in --;
                z.total_in ++;
                z.istate.need += (z.next_in[z.next_in_index ++] & 0xff) << 8 & 0xff00L;
                z.istate.mode = DICT1;
            case DICT1:

                if (z.avail_in == 0) {
                    return r;
                }

                z.avail_in --;
                z.total_in ++;
                z.istate.need += z.next_in[z.next_in_index ++] & 0xffL;
                z.adler = z.istate.need;
                z.istate.mode = DICT0;
                return JZlib.Z_NEED_DICT;
            case DICT0:
                z.istate.mode = BAD;
                z.msg = ""need dictionary"";
                z.istate.marker = 0; // can try inflateSync
                return JZlib.Z_STREAM_ERROR;
            case BLOCKS:
                int old_next_out_index = z.next_out_index;
                try {
                    r = z.istate.blocks.proc(z, r);
                    if (r == JZlib.Z_DATA_ERROR) {
                        z.istate.mode = BAD;
                        z.istate.marker = 0; // can try inflateSync
                        break;
                    }
                    if (r == JZlib.Z_OK) {
                        r = f;
                    }
                    if (r != JZlib.Z_STREAM_END) {
                        return r;
                    }
                    r = f;
                    z.istate.blocks.reset(z, z.istate.was);
                } finally {
                    int decompressedBytes = z.next_out_index - old_next_out_index;
                    gzipUncompressedBytes += decompressedBytes;
                    z.crc32 = CRC32.crc32(z.crc32, z.next_out, old_next_out_index, decompressedBytes);
                }

                if (z.istate.wrapperType == WrapperType.NONE) {
                    z.istate.mode = DONE;
                    break;
                } else if (z.istate.wrapperType == WrapperType.ZLIB) {
                    z.istate.mode = CHECK4;
                } else if (z.istate.wrapperType == WrapperType.GZIP){
                    gzipCRC32 = 0;
                    gzipISize = 0;
                    gzipBytesToRead = 4;
                    z.istate.mode = GZIP_CRC32;
                    break;
                } else {
                    z.istate.mode = BAD;
                    z.msg = ""unexpected state"";
                    z.istate.marker = 0;
                    break;
                }
            case CHECK4:
                if (z.avail_in == 0) {
                    return r;
                }
                r = f;

                z.avail_in --;
                z.total_in ++;
                z.istate.need = (z.next_in[z.next_in_index ++] & 0xff) << 24 & 0xff000000L;
                z.istate.mode = CHECK3;
            case CHECK3:
                if (z.avail_in == 0) {
                    return r;
                }
                r = f;

                z.avail_in --;
                z.total_in ++;
                z.istate.need += (z.next_in[z.next_in_index ++] & 0xff) << 16 & 0xff0000L;
                z.istate.mode = CHECK2;
            case CHECK2:
                if (z.avail_in == 0) {
                    return r;
                }
                r = f;

                z.avail_in --;
                z.total_in ++;
                z.istate.need += (z.next_in[z.next_in_index ++] & 0xff) << 8 & 0xff00L;
                z.istate.mode = CHECK1;
            case CHECK1:
                if (z.avail_in == 0) {
                    return r;
                }
                r = f;

                z.avail_in --;
                z.total_in ++;
                z.istate.need += z.next_in[z.next_in_index ++] & 0xffL;

                if ((int) z.istate.was[0] != (int) z.istate.need) {
                    z.istate.mode = BAD;
                    z.msg = ""incorrect data check"";
                    z.istate.marker = 5; // can't try inflateSync
                    break;
                }

                z.istate.mode = DONE;
            case DONE:
                return JZlib.Z_STREAM_END;
            case BAD:
                return JZlib.Z_DATA_ERROR;
            case GZIP_ID1:
                if (z.avail_in == 0) {
                    return r;
                }
                r = f;
                z.avail_in --;
                z.total_in ++;

                if ((z.next_in[z.next_in_index ++] & 0xff) != 31) {
                    z.istate.mode = BAD;
                    z.msg = ""not a gzip stream"";
                    z.istate.marker = 5; // can't try inflateSync
                    break;
                }
                z.istate.mode = GZIP_ID2;
            case GZIP_ID2:
                if (z.avail_in == 0) {
                    return r;
                }
                r = f;
                z.avail_in --;
                z.total_in ++;

                if ((z.next_in[z.next_in_index ++] & 0xff) != 139) {
                    z.istate.mode = BAD;
                    z.msg = ""not a gzip stream"";
                    z.istate.marker = 5; // can't try inflateSync
                    break;
                }
                z.istate.mode = GZIP_CM;
            case GZIP_CM:
                if (z.avail_in == 0) {
                    return r;
                }
                r = f;
                z.avail_in --;
                z.total_in ++;

                if ((z.next_in[z.next_in_index ++] & 0xff) != JZlib.Z_DEFLATED) {
                    z.istate.mode = BAD;
                    z.msg = ""unknown compression method"";
                    z.istate.marker = 5; // can't try inflateSync
                    break;
                }
                z.istate.mode = GZIP_FLG;
            case GZIP_FLG:
                if (z.avail_in == 0) {
                    return r;
                }
                r = f;
                z.avail_in --;
                z.total_in ++;
                gzipFlag = z.next_in[z.next_in_index ++] & 0xff;

                if ((gzipFlag & 0xE2) != 0) {
                    z.istate.mode = BAD;
                    z.msg = ""unsupported flag"";
                    z.istate.marker = 5; // can't try inflateSync
                    break;
                }
                gzipBytesToRead = 6;
                z.istate.mode = GZIP_MTIME_XFL_OS;
            case GZIP_MTIME_XFL_OS:
                while (gzipBytesToRead > 0) {
                    if (z.avail_in == 0) {
                        return r;
                    }
                    r = f;
                    z.avail_in --;
                    z.total_in ++;
                    z.next_in_index ++;
                    gzipBytesToRead --;
                }
                z.istate.mode = GZIP_XLEN;
                gzipXLen = 0;
                gzipBytesToRead = 2;
            case GZIP_XLEN:
                if ((gzipFlag & 4) != 0) {
                    while (gzipBytesToRead > 0) {
                        if (z.avail_in == 0) {
                            return r;
                        }
                        r = f;
                        z.avail_in --;
                        z.total_in ++;
                        gzipXLen |= (z.next_in[z.next_in_index ++] & 0xff) << (1 - gzipBytesToRead) * 8;
                        gzipBytesToRead --;
                    }
                    gzipBytesToRead = gzipXLen;
                    z.istate.mode = GZIP_FEXTRA;
                } else {
                    z.istate.mode = GZIP_FNAME;
                    break;
                }
            case GZIP_FEXTRA:
                while (gzipBytesToRead > 0) {
                    if (z.avail_in == 0) {
                        return r;
                    }
                    r = f;
                    z.avail_in --;
                    z.total_in ++;
                    z.next_in_index ++;
                    gzipBytesToRead --;
                }
                z.istate.mode = GZIP_FNAME;
            case GZIP_FNAME:
                if ((gzipFlag & 8) != 0) {
                    do {
                        if (z.avail_in == 0) {
                            return r;
                        }
                        r = f;
                        z.avail_in --;
                        z.total_in ++;
                    } while (z.next_in[z.next_in_index ++] != 0);
                }
                z.istate.mode = GZIP_FCOMMENT;
            case GZIP_FCOMMENT:
                if ((gzipFlag & 16) != 0) {
                    do {
                        if (z.avail_in == 0) {
                            return r;
                        }
                        r = f;
                        z.avail_in --;
                        z.total_in ++;
                    } while (z.next_in[z.next_in_index ++] != 0);
                }
                gzipBytesToRead = 2;
                z.istate.mode = GZIP_FHCRC;
            case GZIP_FHCRC:
                if ((gzipFlag & 2) != 0) {
                    while (gzipBytesToRead > 0) {
                        if (z.avail_in == 0) {
                            return r;
                        }
                        r = f;
                        z.avail_in --;
                        z.total_in ++;
                        z.next_in_index ++;
                        gzipBytesToRead --;
                    }
                }
                z.istate.mode = BLOCKS;
                break;
            case GZIP_CRC32:
                while (gzipBytesToRead > 0) {
                    if (z.avail_in == 0) {
                        return r;
                    }
                    r = f;
                    z.avail_in --;
                    z.total_in ++;
                    gzipBytesToRead --;
                    z.istate.gzipCRC32 |= (z.next_in[z.next_in_index ++] & 0xff) << (3 - gzipBytesToRead) * 8;
                }

                if (z.crc32 != z.istate.gzipCRC32) {
                    z.istate.mode = BAD;
                    z.msg = ""incorrect CRC32 checksum"";
                    z.istate.marker = 5; // can't try inflateSync
                    break;
                }
                gzipBytesToRead = 4;
                z.istate.mode = GZIP_ISIZE;
            case GZIP_ISIZE:
                while (gzipBytesToRead > 0) {
                    if (z.avail_in == 0) {
                        return r;
                    }
                    r = f;
                    z.avail_in --;
                    z.total_in ++;
                    gzipBytesToRead --;
                    z.istate.gzipISize |= (z.next_in[z.next_in_index ++] & 0xff) << (3 - gzipBytesToRead) * 8;
                }

                if (gzipUncompressedBytes != z.istate.gzipISize) {
                    z.istate.mode = BAD;
                    z.msg = ""incorrect ISIZE checksum"";
                    z.istate.marker = 5; // can't try inflateSync
                    break;
                }

                z.istate.mode = DONE;
                break;
            default:
                return JZlib.Z_STREAM_ERROR;
            }
        }
    }

    int inflateSetDictionary(ZStream z, byte[] dictionary, int dictLength) {
        int index = 0;
        int length = dictLength;
        if (z == null || z.istate == null || z.istate.mode != DICT0) {
            return JZlib.Z_STREAM_ERROR;
        }

        if (Adler32.adler32(1L, dictionary, 0, dictLength) != z.adler) {
            return JZlib.Z_DATA_ERROR;
        }

        z.adler = Adler32.adler32(0, null, 0, 0);

        if (length >= 1 << z.istate.wbits) {
            length = (1 << z.istate.wbits) - 1;
            index = dictLength - length;
        }
        z.istate.blocks.set_dictionary(dictionary, index, length);
        z.istate.mode = BLOCKS;
        return JZlib.Z_OK;
    }

    private static final byte[] mark = { (byte) 0, (byte) 0, (byte) 0xff, (byte) 0xff };

    int inflateSync(ZStream z) {
        int n; // number of bytes to look at
        int p; // pointer to bytes
        int m; // number of marker bytes found in a row
        long r, w; // temporaries to save total_in and total_out

        // set up
        if (z == null || z.istate == null) {
            return JZlib.Z_STREAM_ERROR;
        }
        if (z.istate.mode != BAD) {
            z.istate.mode = BAD;
            z.istate.marker = 0;
        }
        if ((n = z.avail_in) == 0) {
            return JZlib.Z_BUF_ERROR;
        }
        p = z.next_in_index;
        m = z.istate.marker;

        // search
        while (n != 0 && m < 4) {
            if (z.next_in[p] == mark[m]) {
                m ++;
            } else if (z.next_in[p] != 0) {
                m = 0;
            } else {
                m = 4 - m;
            }
            p ++;
            n --;
        }

        // restore
        z.total_in += p - z.next_in_index;
        z.next_in_index = p;
        z.avail_in = n;
        z.istate.marker = m;

        // return no joy or set up to restart on a new block
        if (m != 4) {
            return JZlib.Z_DATA_ERROR;
        }
        r = z.total_in;
        w = z.total_out;
        inflateReset(z);
        z.total_in = r;
        z.total_out = w;
        z.istate.mode = BLOCKS;
        return JZlib.Z_OK;
    }
}
",False,"```
Copyright (c) 2009 Red Hat, Inc.

Red Hat licenses this file to you under the Apache License, version 2.0
(the ""License""); you may not use this file except in compliance with the
License.  You may obtain a copy of the License at:

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an ""AS IS"" BASIS, WITHOUT
WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the
License for the specific language governing permissions and limitations
under the License.



/*
 * This program is based on zlib-1.1.3, so all credit should go authors
 * Jean-loup Gailly(jloup@gzip.org) and Mark Adler(madler@alumni.caltech.edu)
 * and contributors of zlib.
 */

package org.jboss.netty.util.internal.jzlib;

import java.io.IOException;

final class Inflate {

    private static final int METHOD = 0; // waiting for method byte
    private static final int FLAG = 1; // waiting for flag byte
    private static final int DICT4 = 2; // four dictionary check bytes to go
    private static final int DICT3 = 3; // three dictionary check bytes to go
    private static final int DICT2 = 4; // two dictionary check bytes to go
    private static final int DICT1 = 5; // one dictionary check byte to go
    private static final int DICT0 = 6; // waiting for inflateSetDictionary
    private static final int BLOCKS = 7; // decompressing blocks
    private static final int CHECK4 = 8; // four check bytes to go
    private static final int CHECK3 = 9; // three check bytes to go
    private static final int CHECK2 = 10; // two check bytes to go
    private static final int CHECK1 = 11; // one check byte to go
    private static final int DONE = 12; // finished check, done
    private static final int BAD = 13; // got an error--stay here

    private static final int GZIP_ID1 = 14;
    private static final int GZIP_ID2 = 15;
    private static final int GZIP_CM = 16;
    private static final int GZIP_FLG = 17;
    private static final int GZIP_MTIME_XFL_OS = 18;
    private static final int GZIP_XLEN = 19;
    private static final int GZIP_FEXTRA = 20;
    private static final int GZIP_FNAME = 21;
    private static final int GZIP_FCOMMENT = 22;
    private static final int GZIP_FHCRC = 23;
    private static final int GZIP_CRC32= 24;
    private static final int GZIP_ISIZE = 25;

    private int mode; // current inflate mode
    // mode dependent information
    private int method; // if FLAGS, method byte
    // if CHECK, check values to compare
    private long[] was = new long[1]; // computed check value
    private long need; // stream check value
    // if BAD, inflateSync's marker bytes count
    private int marker;
    // mode independent information
    private WrapperType wrapperType;
    private int wbits; // log2(window size)  (8..15, defaults to 15)
    private InfBlocks blocks; // current inflate_blocks state
    private int gzipFlag;
    private int gzipBytesToRead;
    private int gzipUncompressedBytes;
    private int gzipCRC32;
    private int gzipISize;

    private int inflateReset(ZStream z) {
        if (z == null || z.istate == null) {
            return JZlib.Z_STREAM_ERROR;
        }
        z.total_in = z.total_out = 0;
        z.msg = null;
        switch (wrapperType) {
        case NONE:
            z.istate.mode = BLOCKS;
            break;
        case ZLIB:
        case ZLIB_OR_NONE:
            z.istate.mode = METHOD;
            break;
        case GZIP:
            z.istate.mode = GZIP_ID1;
            break;
        }
        z.istate.blocks.reset(z, null);
        gzipUncompressedBytes = 0;
        return JZlib.Z_OK;
    }

    int inflateEnd(ZStream z) {
        if (blocks != null) {
            blocks.free(z);
        }
        blocks = null;
        //    ZFREE(z, z->state);
        return JZlib.Z_OK;
    }

    int inflateInit(ZStream z, int w, WrapperType wrapperType) {
        z."
191,196,NomosTestfiles/BSD/__init__.py,BSD,"""""""
Python Markdown
===============

Python Markdown converts Markdown to HTML and can be used as a library or
called from the command line.

## Basic usage as a module:

    import markdown
    md = Markdown()
    html = md.convert(your_text_string)

## Basic use from the command line:

    markdown source.txt > destination.html

Run ""markdown --help"" to see more options.

## Extensions

See <http://www.freewisdom.org/projects/python-markdown/> for more
information and instructions on how to extend the functionality of
Python Markdown.  Read that before you try modifying this file.

## Authors and License

Started by [Manfred Stienstra](http://www.dwerg.net/).  Continued and
maintained  by [Yuri Takhteyev](http://www.freewisdom.org), [Waylan
Limberg](http://achinghead.com/) and [Artem Yunusov](http://blog.splyer.com).

Contact: markdown@freewisdom.org

Copyright 2007, 2008 The Python Markdown Project (v. 1.7 and later)
Copyright 200? Django Software Foundation (OrderedDict implementation)
Copyright 2004, 2005, 2006 Yuri Takhteyev (v. 0.2-1.6b)
Copyright 2004 Manfred Stienstra (the original version)

License: BSD (see docs/LICENSE for details).
""""""

version = ""2.0.3""
version_info = (2,0,3, ""Final"")

import re
import codecs
import sys
import warnings
import logging
from logging import DEBUG, INFO, WARN, ERROR, CRITICAL


""""""
CONSTANTS
=============================================================================
""""""

""""""
Constants you might want to modify
-----------------------------------------------------------------------------
""""""

# default logging level for command-line use
COMMAND_LINE_LOGGING_LEVEL = CRITICAL
TAB_LENGTH = 4               # expand tabs to this many spaces
ENABLE_ATTRIBUTES = True     # @id = xyz -> <... id=""xyz"">
SMART_EMPHASIS = True        # this_or_that does not become this<i>or</i>that
DEFAULT_OUTPUT_FORMAT = 'xhtml1'     # xhtml or html4 output
HTML_REMOVED_TEXT = ""[HTML_REMOVED]"" # text used instead of HTML in safe mode
BLOCK_LEVEL_ELEMENTS = re.compile(""p|div|h[1-6]|blockquote|pre|table|dl|ol|ul""
                                  ""|script|noscript|form|fieldset|iframe|math""
                                  ""|ins|del|hr|hr/|style|li|dt|dd|thead|tbody""
                                  ""|tr|th|td"")
DOC_TAG = ""div""     # Element used to wrap document - later removed

# Placeholders
STX = u'\u0002'  # Use STX (""Start of text"") for start-of-placeholder
ETX = u'\u0003'  # Use ETX (""End of text"") for end-of-placeholder
INLINE_PLACEHOLDER_PREFIX = STX+""klzzwxh:""
INLINE_PLACEHOLDER = INLINE_PLACEHOLDER_PREFIX + ""%s"" + ETX
AMP_SUBSTITUTE = STX+""amp""+ETX


""""""
Constants you probably do not need to change
-----------------------------------------------------------------------------
""""""

RTL_BIDI_RANGES = ( (u'\u0590', u'\u07FF'),
                     # Hebrew (0590-05FF), Arabic (0600-06FF),
                     # Syriac (0700-074F), Arabic supplement (0750-077F),
                     # Thaana (0780-07BF), Nko (07C0-07FF).
                    (u'\u2D30', u'\u2D7F'), # Tifinagh
                    )


""""""
AUXILIARY GLOBAL FUNCTIONS
=============================================================================
""""""


def message(level, text):
    """""" A wrapper method for logging debug messages. """"""
    logger =  logging.getLogger('MARKDOWN')
    if logger.handlers:
        # The logger is configured
        logger.log(level, text)
        if level > WARN:
            sys.exit(0)
    elif level > WARN:
        raise MarkdownException, text
    else:
        warnings.warn(text, MarkdownWarning)


def isBlockLevel(tag):
    """"""Check if the tag is a block level HTML tag.""""""
    return BLOCK_LEVEL_ELEMENTS.match(tag)

""""""
MISC AUXILIARY CLASSES
=============================================================================
""""""

class AtomicString(unicode):
    """"""A string which should not be further processed.""""""
    pass


class MarkdownException(Exception):
    """""" A Markdown Exception. """"""
    pass


class MarkdownWarning(Warning):
    """""" A Markdown Warning. """"""
    pass


""""""
OVERALL DESIGN
=============================================================================

Markdown processing takes place in four steps:

1. A bunch of ""preprocessors"" munge the input text.
2. BlockParser() parses the high-level structural elements of the
   pre-processed text into an ElementTree.
3. A bunch of ""treeprocessors"" are run against the ElementTree. One such
   treeprocessor runs InlinePatterns against the ElementTree, detecting inline
   markup.
4. Some post-processors are run against the text after the ElementTree has
   been serialized into text.
5. The output is written to a string.

Those steps are put together by the Markdown() class.

""""""

import preprocessors
import blockprocessors
import treeprocessors
import inlinepatterns
import postprocessors
import blockparser
import etree_loader
import odict

# Extensions should use ""markdown.etree"" instead of ""etree"" (or do `from
# markdown import etree`).  Do not import it by yourself.

etree = etree_loader.importETree()

# Adds the ability to output html4
import html4


class Markdown:
    """"""Convert Markdown to HTML.""""""

    def __init__(self,
                 extensions=[],
                 extension_configs={},
                 safe_mode = False, 
                 output_format=DEFAULT_OUTPUT_FORMAT):
        """"""
        Creates a new Markdown instance.

        Keyword arguments:

        * extensions: A list of extensions.
           If they are of type string, the module mdx_name.py will be loaded.
           If they are a subclass of markdown.Extension, they will be used
           as-is.
        * extension-configs: Configuration setting for extensions.
        * safe_mode: Disallow raw html. One of ""remove"", ""replace"" or ""escape"".
        * output_format: Format of output. Supported formats are:
            * ""xhtml1"": Outputs XHTML 1.x. Default.
            * ""xhtml"": Outputs latest supported version of XHTML (currently XHTML 1.1).
            * ""html4"": Outputs HTML 4
            * ""html"": Outputs latest supported version of HTML (currently HTML 4).
            Note that it is suggested that the more specific formats (""xhtml1"" 
            and ""html4"") be used as ""xhtml"" or ""html"" may change in the future
            if it makes sense at that time. 

        """"""
        
        self.safeMode = safe_mode
        self.registeredExtensions = []
        self.docType = """"
        self.stripTopLevelTags = True

        # Preprocessors
        self.preprocessors = odict.OrderedDict()
        self.preprocessors[""html_block""] = \
                preprocessors.HtmlBlockPreprocessor(self)
        self.preprocessors[""reference""] = \
                preprocessors.ReferencePreprocessor(self)
        # footnote preprocessor will be inserted with ""<reference""

        # Block processors - ran by the parser
        self.parser = blockparser.BlockParser()
        self.parser.blockprocessors['empty'] = \
                blockprocessors.EmptyBlockProcessor(self.parser)
        self.parser.blockprocessors['indent'] = \
                blockprocessors.ListIndentProcessor(self.parser)
        self.parser.blockprocessors['code'] = \
                blockprocessors.CodeBlockProcessor(self.parser)
        self.parser.blockprocessors['hashheader'] = \
                blockprocessors.HashHeaderProcessor(self.parser)
        self.parser.blockprocessors['setextheader'] = \
                blockprocessors.SetextHeaderProcessor(self.parser)
        self.parser.blockprocessors['hr'] = \
                blockprocessors.HRProcessor(self.parser)
        self.parser.blockprocessors['olist'] = \
                blockprocessors.OListProcessor(self.parser)
        self.parser.blockprocessors['ulist'] = \
                blockprocessors.UListProcessor(self.parser)
        self.parser.blockprocessors['quote'] = \
                blockprocessors.BlockQuoteProcessor(self.parser)
        self.parser.blockprocessors['paragraph'] = \
                blockprocessors.ParagraphProcessor(self.parser)


        #self.prePatterns = []

        # Inline patterns - Run on the tree
        self.inlinePatterns = odict.OrderedDict()
        self.inlinePatterns[""backtick""] = \
                inlinepatterns.BacktickPattern(inlinepatterns.BACKTICK_RE)
        self.inlinePatterns[""escape""] = \
                inlinepatterns.SimpleTextPattern(inlinepatterns.ESCAPE_RE)
        self.inlinePatterns[""reference""] = \
            inlinepatterns.ReferencePattern(inlinepatterns.REFERENCE_RE, self)
        self.inlinePatterns[""link""] = \
                inlinepatterns.LinkPattern(inlinepatterns.LINK_RE, self)
        self.inlinePatterns[""image_link""] = \
                inlinepatterns.ImagePattern(inlinepatterns.IMAGE_LINK_RE, self)
        self.inlinePatterns[""image_reference""] = \
            inlinepatterns.ImageReferencePattern(inlinepatterns.IMAGE_REFERENCE_RE, self)
        self.inlinePatterns[""autolink""] = \
            inlinepatterns.AutolinkPattern(inlinepatterns.AUTOLINK_RE, self)
        self.inlinePatterns[""automail""] = \
            inlinepatterns.AutomailPattern(inlinepatterns.AUTOMAIL_RE, self)
        self.inlinePatterns[""linebreak2""] = \
            inlinepatterns.SubstituteTagPattern(inlinepatterns.LINE_BREAK_2_RE, 'br')
        self.inlinePatterns[""linebreak""] = \
            inlinepatterns.SubstituteTagPattern(inlinepatterns.LINE_BREAK_RE, 'br')
        self.inlinePatterns[""html""] = \
                inlinepatterns.HtmlPattern(inlinepatterns.HTML_RE, self)
        self.inlinePatterns[""entity""] = \
                inlinepatterns.HtmlPattern(inlinepatterns.ENTITY_RE, self)
        self.inlinePatterns[""not_strong""] = \
                inlinepatterns.SimpleTextPattern(inlinepatterns.NOT_STRONG_RE)
        self.inlinePatterns[""strong_em""] = \
            inlinepatterns.DoubleTagPattern(inlinepatterns.STRONG_EM_RE, 'strong,em')
        self.inlinePatterns[""strong""] = \
            inlinepatterns.SimpleTagPattern(inlinepatterns.STRONG_RE, 'strong')
        self.inlinePatterns[""emphasis""] = \
            inlinepatterns.SimpleTagPattern(inlinepatterns.EMPHASIS_RE, 'em')
        self.inlinePatterns[""emphasis2""] = \
            inlinepatterns.SimpleTagPattern(inlinepatterns.EMPHASIS_2_RE, 'em')
        # The order of the handlers matters!!!


        # Tree processors - run once we have a basic parse.
        self.treeprocessors = odict.OrderedDict()
        self.treeprocessors[""inline""] = treeprocessors.InlineProcessor(self)
        self.treeprocessors[""prettify""] = \
                treeprocessors.PrettifyTreeprocessor(self)

        # Postprocessors - finishing touches.
        self.postprocessors = odict.OrderedDict()
        self.postprocessors[""raw_html""] = \
                postprocessors.RawHtmlPostprocessor(self)
        self.postprocessors[""amp_substitute""] = \
                postprocessors.AndSubstitutePostprocessor()
        # footnote postprocessor will be inserted with "">amp_substitute""

        # Map format keys to serializers
        self.output_formats = {
            'html'  : html4.to_html_string, 
            'html4' : html4.to_html_string,
            'xhtml' : etree.tostring, 
            'xhtml1': etree.tostring,
        }

        self.references = {}
        self.htmlStash = preprocessors.HtmlStash()
        self.registerExtensions(extensions = extensions,
                                configs = extension_configs)
        self.set_output_format(output_format)
        self.reset()

    def registerExtensions(self, extensions, configs):
        """"""
        Register extensions with this instance of Markdown.

        Keyword aurguments:

        * extensions: A list of extensions, which can either
           be strings or objects.  See the docstring on Markdown.
        * configs: A dictionary mapping module names to config options.

        """"""
        for ext in extensions:
            if isinstance(ext, basestring):
                ext = load_extension(ext, configs.get(ext, []))
            if isinstance(ext, Extension):
                try:
                    ext.extendMarkdown(self, globals())
                except NotImplementedError, e:
                    message(ERROR, e)
            else:
                message(ERROR, 'Extension ""%s.%s"" must be of type: ""markdown.Extension"".' \
                    % (ext.__class__.__module__, ext.__class__.__name__))

    def registerExtension(self, extension):
        """""" This gets called by the extension """"""
        self.registeredExtensions.append(extension)

    def reset(self):
        """"""
        Resets all state variables so that we can start with a new text.
        """"""
        self.htmlStash.reset()
        self.references.clear()

        for extension in self.registeredExtensions:
            extension.reset()

    def set_output_format(self, format):
        """""" Set the output format for the class instance. """"""
        try:
            self.serializer = self.output_formats[format.lower()]
        except KeyError:
            message(CRITICAL, 'Invalid Output Format: ""%s"". Use one of %s.' \
                               % (format, self.output_formats.keys()))

    def convert(self, source):
        """"""
        Convert markdown to serialized XHTML or HTML.

        Keyword arguments:

        * source: Source text as a Unicode string.

        """"""

        # Fixup the source text
        if not source.strip():
            return u""""  # a blank unicode string
        try:
            source = unicode(source)
        except UnicodeDecodeError:
            message(CRITICAL, 'UnicodeDecodeError: Markdown only accepts unicode or ascii input.')
            return u""""

        source = source.replace(STX, """").replace(ETX, """")
        source = source.replace(""\r\n"", ""\n"").replace(""\r"", ""\n"") + ""\n\n""
        source = re.sub(r'\n\s+\n', '\n\n', source)
        source = source.expandtabs(TAB_LENGTH)

        # Split into lines and run the line preprocessors.
        self.lines = source.split(""\n"")
        for prep in self.preprocessors.values():
            self.lines = prep.run(self.lines)

        # Parse the high-level elements.
        root = self.parser.parseDocument(self.lines).getroot()

        # Run the tree-processors
        for treeprocessor in self.treeprocessors.values():
            newRoot = treeprocessor.run(root)
            if newRoot:
                root = newRoot

        # Serialize _properly_.  Strip top-level tags.
        output, length = codecs.utf_8_decode(self.serializer(root, encoding=""utf-8""))
        if self.stripTopLevelTags:
            try:
                start = output.index('<%s>'%DOC_TAG)+len(DOC_TAG)+2
                end = output.rindex('</%s>'%DOC_TAG)
                output = output[start:end].strip()
            except ValueError:
                if output.strip().endswith('<%s />'%DOC_TAG):
                    # We have an empty document
                    output = ''
                else:
                    # We have a serious problem
                    message(CRITICAL, 'Failed to strip top level tags.')

        # Run the text post-processors
        for pp in self.postprocessors.values():
            output = pp.run(output)

        return output.strip()

    def convertFile(self, input=None, output=None, encoding=None):
        """"""Converts a markdown file and returns the HTML as a unicode string.

        Decodes the file using the provided encoding (defaults to utf-8),
        passes the file content to markdown, and outputs the html to either
        the provided stream or the file with provided name, using the same
        encoding as the source file.

        **Note:** This is the only place that decoding and encoding of unicode
        takes place in Python-Markdown.  (All other code is unicode-in /
        unicode-out.)

        Keyword arguments:

        * input: Name of source text file.
        * output: Name of output file. Writes to stdout if `None`.
        * encoding: Encoding of input and output files. Defaults to utf-8.

        """"""

        encoding = encoding or ""utf-8""

        # Read the source
        input_file = codecs.open(input, mode=""r"", encoding=encoding)
        text = input_file.read()
        input_file.close()
        text = text.lstrip(u'\ufeff') # remove the byte-order mark

        # Convert
        html = self.convert(text)

        # Write to file or stdout
        if isinstance(output, (str, unicode)):
            output_file = codecs.open(output, ""w"", encoding=encoding)
            output_file.write(html)
            output_file.close()
        else:
            output.write(html.encode(encoding))


""""""
Extensions
-----------------------------------------------------------------------------
""""""

class Extension:
    """""" Base class for extensions to subclass. """"""
    def __init__(self, configs = {}):
        """"""Create an instance of an Extention.

        Keyword arguments:

        * configs: A dict of configuration setting used by an Extension.
        """"""
        self.config = configs

    def getConfig(self, key):
        """""" Return a setting for the given key or an empty string. """"""
        if key in self.config:
            return self.config[key][0]
        else:
            return """"

    def getConfigInfo(self):
        """""" Return all config settings as a list of tuples. """"""
        return [(key, self.config[key][1]) for key in self.config.keys()]

    def setConfig(self, key, value):
        """""" Set a config setting for `key` with the given `value`. """"""
        self.config[key][0] = value

    def extendMarkdown(self, md, md_globals):
        """"""
        Add the various proccesors and patterns to the Markdown Instance.

        This method must be overriden by every extension.

        Keyword arguments:

        * md: The Markdown instance.

        * md_globals: Global variables in the markdown module namespace.

        """"""
        raise NotImplementedError, 'Extension ""%s.%s"" must define an ""extendMarkdown""' \
            'method.' % (self.__class__.__module__, self.__class__.__name__)


def load_extension(ext_name, configs = []):
    """"""Load extension by name, then return the module.

    The extension name may contain arguments as part of the string in the
    following format: ""extname(key1=value1,key2=value2)""

    """"""

    # Parse extensions config params (ignore the order)
    configs = dict(configs)
    pos = ext_name.find(""("") # find the first ""(""
    if pos > 0:
        ext_args = ext_name[pos+1:-1]
        ext_name = ext_name[:pos]
        pairs = [x.split(""="") for x in ext_args.split("","")]
        configs.update([(x.strip(), y.strip()) for (x, y) in pairs])

    # Setup the module names
    ext_module = 'markdown.extensions'
    module_name_new_style = '.'.join([ext_module, ext_name])
    module_name_old_style = '_'.join(['mdx', ext_name])

    # Try loading the extention first from one place, then another
    try: # New style (markdown.extensons.<extension>)
        module = __import__(module_name_new_style, {}, {}, [ext_module])
    except ImportError:
        try: # Old style (mdx.<extension>)
            module = __import__(module_name_old_style)
        except ImportError:
           message(WARN, ""Failed loading extension '%s' from '%s' or '%s'""
               % (ext_name, module_name_new_style, module_name_old_style))
           # Return None so we don't try to initiate none-existant extension
           return None

    # If the module is loaded successfully, we expect it to define a
    # function called makeExtension()
    try:
        return module.makeExtension(configs.items())
    except AttributeError:
        message(CRITICAL, ""Failed to initiate extension '%s'"" % ext_name)


def load_extensions(ext_names):
    """"""Loads multiple extensions""""""
    extensions = []
    for ext_name in ext_names:
        extension = load_extension(ext_name)
        if extension:
            extensions.append(extension)
    return extensions


""""""
EXPORTED FUNCTIONS
=============================================================================

Those are the two functions we really mean to export: markdown() and
markdownFromFile().
""""""

def markdown(text,
             extensions = [],
             safe_mode = False,
             output_format = DEFAULT_OUTPUT_FORMAT):
    """"""Convert a markdown string to HTML and return HTML as a unicode string.

    This is a shortcut function for `Markdown` class to cover the most
    basic use case.  It initializes an instance of Markdown, loads the
    necessary extensions and runs the parser on the given text.

    Keyword arguments:

    * text: Markdown formatted text as Unicode or ASCII string.
    * extensions: A list of extensions or extension names (may contain config args).
    * safe_mode: Disallow raw html.  One of ""remove"", ""replace"" or ""escape"".
    * output_format: Format of output. Supported formats are:
        * ""xhtml1"": Outputs XHTML 1.x. Default.
        * ""xhtml"": Outputs latest supported version of XHTML (currently XHTML 1.1).
        * ""html4"": Outputs HTML 4
        * ""html"": Outputs latest supported version of HTML (currently HTML 4).
        Note that it is suggested that the more specific formats (""xhtml1"" 
        and ""html4"") be used as ""xhtml"" or ""html"" may change in the future
        if it makes sense at that time. 

    Returns: An HTML document as a string.

    """"""
    md = Markdown(extensions=load_extensions(extensions),
                  safe_mode=safe_mode, 
                  output_format=output_format)
    return md.convert(text)


def markdownFromFile(input = None,
                     output = None,
                     extensions = [],
                     encoding = None,
                     safe_mode = False,
                     output_format = DEFAULT_OUTPUT_FORMAT):
    """"""Read markdown code from a file and write it to a file or a stream.""""""
    md = Markdown(extensions=load_extensions(extensions), 
                  safe_mode=safe_mode,
                  output_format=output_format)
    md.convertFile(input, output, encoding)



",False,"```python
License: BSD (see docs/LICENSE for details).
```"
192,197,NomosTestfiles/BSD/license.terms,BSD-style,"------------------------------------------------------------------------
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> [incr Tcl] <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

 AUTHOR:  Michael J. McLennan
          Bell Labs Innovations for Lucent Technologies
          mmclennan@lucent.com
          http://www.tcltk.com/itcl
========================================================================
             Copyright (c) 1993-1996  Lucent Technologies
========================================================================
Permission to use, copy, modify, and distribute this software and its
documentation for any purpose and without fee is hereby granted,
provided that the above copyright notice appear in all copies and that
both that the copyright notice and warranty disclaimer appear in
supporting documentation, and that the names of Lucent Technologies
any of their entities not be used in advertising or publicity
pertaining to distribution of the software without specific, written
prior permission.

Lucent Technologies disclaims all warranties with regard to this
software, including all implied warranties of merchantability and
fitness.  In no event shall Lucent be liable for any special, indirect
or consequential damages or any damages whatsoever resulting from loss
of use, data or profits, whether in an action of contract, negligence
or other tortuous action, arising out of or in connection with the use
or performance of this software.
========================================================================
",False,"```
========================================================================
             Copyright (c) 1993-1996  Lucent Technologies
========================================================================
Permission to use, copy, modify, and distribute this software and its
documentation for any purpose and without fee is hereby granted,
provided that the above copyright notice appear in all copies and that
both that the copyright notice and warranty disclaimer appear in
supporting documentation, and that the names of Lucent Technologies
any of their entities not be used in advertising or publicity
pertaining to distribution of the software without specific, written
prior permission.

Lucent Technologies disclaims all warranties with regard to this
software, including all implied warranties of merchantability and
fitness.  In no event shall Lucent be liable for any special, indirect
or consequential damages or any damages whatsoever resulting from loss
of use, data or profits, whether in an action of contract, negligence
or other tortuous action, arising out of or in connection with the use
or performance of this software.
========================================================================
```"
193,198,NomosTestfiles/BSD/Linux-OpenIB.txt,Linux-OpenIB,"Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

- Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
- Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

THE SOFTWARE IS PROVIDED ""AS IS"", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
",False,"```
Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

- Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
- Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

THE SOFTWARE IS PROVIDED ""AS IS"", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
```"
194,199,NomosTestfiles/BSD/lz4.c,BSD-2-Clause,"/*
   
   LZ4 - Fast LZ compression algorithm
   Copyright (C) 2011-2015, Yann Collet.
   REUSE-IgnoreStart
   SPDX-License-Identifier: BSD-2-Clause
   REUSE-IgnoreStart
   
   You can contact the author at :
   - LZ4 source repository : https://github.com/Cyan4973/lz4
   - LZ4 public forum : https://groups.google.com/forum/#!forum/lz4c
*/


/**************************************
*  Reading and writing into memory
**************************************/

/* customized version of memcpy, which may overwrite up to 7 bytes beyond dstEnd */
static void LZ4_wildCopy(void* dstPtr, const void* srcPtr, void* dstEnd)
{
    BYTE* d = (BYTE*)dstPtr;
    const BYTE* s = (const BYTE*)srcPtr;
    BYTE* e = (BYTE*)dstEnd;
    do { LZ4_copy8(d,s); d+=8; s+=8; } while (d<e);
}


/**************************************
*  Common Constants
**************************************/
#define MINMATCH 4

#define COPYLENGTH 8
#define LASTLITERALS 5
#define MFLIMIT (COPYLENGTH+MINMATCH)
static const int LZ4_minLength = (MFLIMIT+1);

#define KB *(1 <<10)
#define MB *(1 <<20)
#define GB *(1U<<30)

#define MAXD_LOG 16
#define MAX_DISTANCE ((1 << MAXD_LOG) - 1)

#define ML_BITS  4
#define ML_MASK  ((1U<<ML_BITS)-1)
#define RUN_BITS (8-ML_BITS)
#define RUN_MASK ((1U<<RUN_BITS)-1)


/**************************************
*  Local Structures and types
**************************************/
typedef enum { noDict = 0, withPrefix64k, usingExtDict } dict_directive;
typedef enum { endOnOutputSize = 0, endOnInputSize = 1 } endCondition_directive;
typedef enum { full = 0, partial = 1 } earlyEnd_directive;



/*******************************
*  Decompression functions
*******************************/
/*
 * This generic decompression function cover all use cases.
 * It shall be instantiated several times, using different sets of directives
 * Note that it is essential this generic function is really inlined,
 * in order to remove useless branches during compilation optimization.
 */
FORCE_INLINE int LZ4_decompress_generic(
                 const char* const source,
                 char* const dest,
                 int inputSize,
                 int outputSize,         /* If endOnInput==endOnInputSize, this value is the max size of Output Buffer. */

                 int endOnInput,         /* endOnOutputSize, endOnInputSize */
                 int partialDecoding,    /* full, partial */
                 int targetOutputSize,   /* only used if partialDecoding==partial */
                 int dict,               /* noDict, withPrefix64k, usingExtDict */
                 const BYTE* const lowPrefix,  /* == dest if dict == noDict */
                 const BYTE* const dictStart,  /* only if dict==usingExtDict */
                 const size_t dictSize         /* note : = 0 if noDict */
                 )
{
    /* Local Variables */
    const BYTE* ip = (const BYTE*) source;
    const BYTE* const iend = ip + inputSize;

    BYTE* op = (BYTE*) dest;
    BYTE* const oend = op + outputSize;
    BYTE* cpy;
    BYTE* oexit = op + targetOutputSize;
    const BYTE* const lowLimit = lowPrefix - dictSize;

    const BYTE* const dictEnd = (const BYTE*)dictStart + dictSize;
    const size_t dec32table[] = {4, 1, 2, 1, 4, 4, 4, 4};
    const size_t dec64table[] = {0, 0, 0, (size_t)-1, 0, 1, 2, 3};

    const int safeDecode = (endOnInput==endOnInputSize);
    const int checkOffset = ((safeDecode) && (dictSize < (int)(64 KB)));


    /* Special cases */
    if ((partialDecoding) && (oexit> oend-MFLIMIT)) oexit = oend-MFLIMIT;                         /* targetOutputSize too high => decode everything */
    if ((endOnInput) && (unlikely(outputSize==0))) return ((inputSize==1) && (*ip==0)) ? 0 : -1;  /* Empty output buffer */
    if ((!endOnInput) && (unlikely(outputSize==0))) return (*ip==0?1:-1);


    /* Main Loop */
    while (1)
    {
        unsigned token;
        size_t length;
        const BYTE* match;

        /* get literal length */
        token = *ip++;
        if ((length=(token>>ML_BITS)) == RUN_MASK)
        {
            unsigned s;
            do
            {
                s = *ip++;
                length += s;
            }
            while (likely((endOnInput)?ip<iend-RUN_MASK:1) && (s==255));
            if ((safeDecode) && unlikely((size_t)(op+length)<(size_t)(op))) goto _output_error;   /* overflow detection */
            if ((safeDecode) && unlikely((size_t)(ip+length)<(size_t)(ip))) goto _output_error;   /* overflow detection */
        }

        /* copy literals */
        cpy = op+length;
        if (((endOnInput) && ((cpy>(partialDecoding?oexit:oend-MFLIMIT)) || (ip+length>iend-(2+1+LASTLITERALS))) )
            || ((!endOnInput) && (cpy>oend-COPYLENGTH)))
        {
            if (partialDecoding)
            {
                if (cpy > oend) goto _output_error;                           /* Error : write attempt beyond end of output buffer */
                if ((endOnInput) && (ip+length > iend)) goto _output_error;   /* Error : read attempt beyond end of input buffer */
            }
            else
            {
                if ((!endOnInput) && (cpy != oend)) goto _output_error;       /* Error : block decoding must stop exactly there */
                if ((endOnInput) && ((ip+length != iend) || (cpy > oend))) goto _output_error;   /* Error : input must be consumed */
            }
            memcpy(op, ip, length);
            ip += length;
            op += length;
            break;     /* Necessarily EOF, due to parsing restrictions */
        }
        LZ4_wildCopy(op, ip, cpy);
        ip += length; op = cpy;

        /* get offset */
        match = cpy - LZ4_readLE16(ip); ip+=2;
        if ((checkOffset) && (unlikely(match < lowLimit))) goto _output_error;   /* Error : offset outside destination buffer */

        /* get matchlength */
        length = token & ML_MASK;
        if (length == ML_MASK)
        {
            unsigned s;
            do
            {
                if ((endOnInput) && (ip > iend-LASTLITERALS)) goto _output_error;
                s = *ip++;
                length += s;
            } while (s==255);
            if ((safeDecode) && unlikely((size_t)(op+length)<(size_t)op)) goto _output_error;   /* overflow detection */
        }
        length += MINMATCH;

        /* check external dictionary */
        if ((dict==usingExtDict) && (match < lowPrefix))
        {
            if (unlikely(op+length > oend-LASTLITERALS)) goto _output_error;   /* doesn't respect parsing restriction */

            if (length <= (size_t)(lowPrefix-match))
            {
                /* match can be copied as a single segment from external dictionary */
                match = dictEnd - (lowPrefix-match);
                memmove(op, match, length); op += length;
            }
            else
            {
                /* match encompass external dictionary and current segment */
                size_t copySize = (size_t)(lowPrefix-match);
                memcpy(op, dictEnd - copySize, copySize);
                op += copySize;
                copySize = length - copySize;
                if (copySize > (size_t)(op-lowPrefix))   /* overlap within current segment */
                {
                    BYTE* const endOfMatch = op + copySize;
                    const BYTE* copyFrom = lowPrefix;
                    while (op < endOfMatch) *op++ = *copyFrom++;
                }
                else
                {
                    memcpy(op, lowPrefix, copySize);
                    op += copySize;
                }
            }
            continue;
        }

        /* copy repeated sequence */
        cpy = op + length;
        if (unlikely((op-match)<8))
        {
            const size_t dec64 = dec64table[op-match];
            op[0] = match[0];
            op[1] = match[1];
            op[2] = match[2];
            op[3] = match[3];
            match += dec32table[op-match];
            LZ4_copy4(op+4, match);
            op += 8; match -= dec64;
        } else { LZ4_copy8(op, match); op+=8; match+=8; }

        if (unlikely(cpy>oend-12))
        {
            if (cpy > oend-LASTLITERALS) goto _output_error;    /* Error : last LASTLITERALS bytes must be literals */
            if (op < oend-8)
            {
                LZ4_wildCopy(op, match, oend-8);
                match += (oend-8) - op;
                op = oend-8;
            }
            while (op<cpy) *op++ = *match++;
        }
        else
            LZ4_wildCopy(op, match, cpy);
        op=cpy;   /* correction */
    }

    /* end of decoding */
    if (endOnInput)
       return (int) (((char*)op)-dest);     /* Nb of output bytes decoded */
    else
       return (int) (((const char*)ip)-source);   /* Nb of input bytes read */

    /* Overflow error detected */
_output_error:
    return (int) (-(((const char*)ip)-source))-1;
}
",False,"```
SPDX-License-Identifier: BSD-2-Clause
```"
195,200,NomosTestfiles/BSD/lz4.license,"BSD-2-Clause
GPL-2.0-only","This repository uses 2 different licenses :
- all files in the `lib` directory use a BSD 2-Clause license
- all other files use a GPLv2 license, unless explicitly stated otherwise

Relevant license is reminded at the top of each source file,
and with presence of COPYING or LICENSE file in associated directories.

This model is selected to emphasize that
files in the `lib` directory are designed to be included into 3rd party applications,
while all other files, in `programs`, `tests` or `examples`,
receive more limited attention and support for such scenario.
",False,"```
- all files in the `lib` directory use a BSD 2-Clause license
- all other files use a GPLv2 license, unless explicitly stated otherwise
```"
196,201,NomosTestfiles/BSD/manual-bsdstyle,bzip2-1.0.6,"<html>
<head>
<title></title>
<meta name=""Subject"" content="""">
<meta name=""Keywords"" content="""">
<meta name=""Author"" content="""">
<meta name=""Creator"" content=""PassiveTeX 1.25"">
<meta name=""Producer"" content=""pdfTeX-1.40.10"">
<meta name=""CreationDate"" content="""">
</head>
<body>
<pre>
bzip2 and libbzip2, version 1.0.6
A program and library for data compression

Julian Seward, http://www.bzip.org

bzip2 and libbzip2, version 1.0.6: A program and library for data compression
by Julian Seward Version 1.0.6 of 6 September 2010 Copyright © 1996-2010 Julian Seward
This program, bzip2, the associated library libbzip2, and all documentation, are copyright © 1996-2010 Julian Seward. All rights reserved. Redistribution and use in source and binary forms, with or without modiﬁcation, are permitted provided that the following conditions are met: • Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. • The origin of this software must not be misrepresented; you must not claim that you wrote the original software. If you use this software in a product, an acknowledgment in the product documentation would be appreciated but is not required. • Altered source versions must be plainly marked as such, and must not be misrepresented as being the original software. • The name of the author may not be used to endorse or promote products derived from this software without speciﬁc prior written permission. THIS SOFTWARE IS PROVIDED BY THE AUTHOR ""AS IS"" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. PATENTS: To the best of my knowledge, bzip2 and libbzip2 do not use any patented algorithms. However, I do not have the resources to carry out a patent search. Therefore I cannot give any guarantee of the above statement.

Table of Contents
1. Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 2. How to use bzip2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 2.1. NAME . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 2.2. SYNOPSIS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 2.3. DESCRIPTION . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 2.4. OPTIONS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4 2.5. MEMORY MANAGEMENT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5 2.6. RECOVERING DATA FROM DAMAGED FILES ............................................. 6 2.7. PERFORMANCE NOTES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6 2.8. CAVEATS ................................................................................. 7 2.9. AUTHOR . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 3. Programming with libbzip2 ................................................................ 8 3.1. Top-level structure .......................................................................... 8 3.1.1. Low-level summary ....................................................................... 9 3.1.2. High-level summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9 3.1.3. Utility functions summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9 3.2. Error handling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10 3.3. Low-level interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11 3.3.1. BZ2_bzCompressInit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11 3.3.2. BZ2_bzCompress . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13 3.3.3. BZ2_bzCompressEnd . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16 3.3.4. BZ2_bzDecompressInit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16 3.3.5. BZ2_bzDecompress . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17 3.3.6. BZ2_bzDecompressEnd . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18 3.4. High-level interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18 3.4.1. BZ2_bzReadOpen . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19 3.4.2. BZ2_bzRead . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20 3.4.3. BZ2_bzReadGetUnused . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21 3.4.4. BZ2_bzReadClose . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22 3.4.5. BZ2_bzWriteOpen . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22 3.4.6. BZ2_bzWrite . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23 3.4.7. BZ2_bzWriteClose . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23 3.4.8. Handling embedded compressed data streams . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24 3.4.9. Standard ﬁle-reading/writing code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25 3.5. Utility functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26 3.5.1. BZ2_bzBuffToBuffCompress . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26 3.5.2. BZ2_bzBuffToBuffDecompress . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27 3.6. zlib compatibility functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28 3.7. Using the library in a stdio-free environment . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28 3.7.1. Getting rid of stdio . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29 3.7.2. Critical error handling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29 3.8. Making a Windows DLL . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29 4. Miscellanea . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31 4.1. Limitations of the compressed ﬁle format . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31 4.2. Portability issues . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32 4.3. Reporting bugs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32 4.4. Did you get the right package? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33 4.5. Further Reading . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34

iii

1. Introduction
bzip2 compresses ﬁles using the Burrows-Wheeler block-sorting text compression algorithm, and Huffman coding. Compression is generally considerably better than that achieved by more conventional LZ77/LZ78-based compressors, and approaches the performance of the PPM family of statistical compressors. bzip2 is built on top of libbzip2, a ﬂexible library for handling compressed data in the bzip2 format. This manual describes both how to use the program and how to work with the library interface. Most of the manual is devoted to this library, not the program, which is good news if your interest is only in the program. • How to use bzip2 [2] describes how to use bzip2; this is the only part you need to read if you just want to know how to operate the program. • Programming with libbzip2 [8] describes the programming interfaces in detail, and • Miscellanea [31] records some miscellaneous notes which I thought ought to be recorded somewhere.

1

2. How to use bzip2
Table of Contents
2.1. 2.2. 2.3. 2.4. 2.5. 2.6. 2.7. 2.8. 2.9. NAME . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . SYNOPSIS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . DESCRIPTION . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . OPTIONS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . MEMORY MANAGEMENT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . RECOVERING DATA FROM DAMAGED FILES ............................................. PERFORMANCE NOTES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . CAVEATS ................................................................................. AUTHOR . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 2 3 4 5 6 6 7 7

This chapter contains a copy of the bzip2 man page, and nothing else.

2.1. NAME
• bzip2, bunzip2 - a block-sorting ﬁle compressor, v1.0.6 • bzcat - decompresses ﬁles to stdout • bzip2recover - recovers data from damaged bzip2 ﬁles

2.2. SYNOPSIS
• bzip2 [ -cdfkqstvzVL123456789 ] [ ﬁlenames ... ] • bunzip2 [ -fkvsVL ] [ ﬁlenames ... ] • bzcat [ -s ] [ ﬁlenames ... ] • bzip2recover ﬁlename

2

How to use bzip2

2.3. DESCRIPTION
bzip2 compresses ﬁles using the Burrows-Wheeler block sorting text compression algorithm, and Huffman coding. Compression is generally considerably better than that achieved by more conventional LZ77/LZ78-based compressors, and approaches the performance of the PPM family of statistical compressors. The command-line options are deliberately very similar to those of GNU gzip, but they are not identical. bzip2 expects a list of ﬁle names to accompany the command-line ﬂags. Each ﬁle is replaced by a compressed version of itself, with the name original_name.bz2. Each compressed ﬁle has the same modiﬁcation date, permissions, and, when possible, ownership as the corresponding original, so that these properties can be correctly restored at decompression time. File name handling is naive in the sense that there is no mechanism for preserving original ﬁle names, permissions, ownerships or dates in ﬁlesystems which lack these concepts, or have serious ﬁle name length restrictions, such as MS-DOS. bzip2 and bunzip2 will by default not overwrite existing ﬁles. If you want this to happen, specify the -f ﬂag. If no ﬁle names are speciﬁed, bzip2 compresses from standard input to standard output. In this case, bzip2 will decline to write compressed output to a terminal, as this would be entirely incomprehensible and therefore pointless. bunzip2 (or bzip2 -d) decompresses all speciﬁed ﬁles. Files which were not created by bzip2 will be detected and ignored, and a warning issued. bzip2 attempts to guess the ﬁlename for the decompressed ﬁle from that of the compressed ﬁle as follows: • filename.bz2 becomes filename • filename.bz becomes filename • filename.tbz2 becomes filename.tar • filename.tbz becomes filename.tar • anyothername becomes anyothername.out If the ﬁle does not end in one of the recognised endings, .bz2, .bz, .tbz2 or .tbz, bzip2 complains that it cannot guess the name of the original ﬁle, and uses the original name with .out appended. As with compression, supplying no ﬁlenames causes decompression from standard input to standard output. bunzip2 will correctly decompress a ﬁle which is the concatenation of two or more compressed ﬁles. The result is the concatenation of the corresponding uncompressed ﬁles. Integrity testing (-t) of concatenated compressed ﬁles is also supported. You can also compress or decompress ﬁles to the standard output by giving the -c ﬂag. Multiple ﬁles may be compressed and decompressed like this. The resulting outputs are fed sequentially to stdout. Compression of multiple ﬁles in this manner generates a stream containing multiple compressed ﬁle representations. Such a stream can be decompressed correctly only by bzip2 version 0.9.0 or later. Earlier versions of bzip2 will stop after decompressing the ﬁrst ﬁle in the stream. bzcat (or bzip2 -dc) decompresses all speciﬁed ﬁles to the standard output. bzip2 will read arguments from the environment variables BZIP2 and BZIP, in that order, and will process them before any arguments read from the command line. This gives a convenient way to supply default arguments. Compression is always performed, even if the compressed ﬁle is slightly larger than the original. Files of less than about one hundred bytes tend to get larger, since the compression mechanism has a constant overhead in the region of 3

How to use bzip2

50 bytes. Random data (including the output of most ﬁle compressors) is coded at about 8.05 bits per byte, giving an expansion of around 0.5%. As a self-check for your protection, bzip2 uses 32-bit CRCs to make sure that the decompressed version of a ﬁle is identical to the original. This guards against corruption of the compressed data, and against undetected bugs in bzip2 (hopefully very unlikely). The chances of data corruption going undetected is microscopic, about one chance in four billion for each ﬁle processed. Be aware, though, that the check occurs upon decompression, so it can only tell you that something is wrong. It can’t help you recover the original uncompressed data. You can use bzip2recover to try to recover data from damaged ﬁles. Return values: 0 for a normal exit, 1 for environmental problems (ﬁle not found, invalid ﬂags, I/O errors, etc.), 2 to indicate a corrupt compressed ﬁle, 3 for an internal consistency error (eg, bug) which caused bzip2 to panic.

2.4. OPTIONS
-c --stdout Compress or decompress to standard output. -d --decompress Force decompression. bzip2, bunzip2 and bzcat are really the same program, and the decision about what actions to take is done on the basis of which name is used. This ﬂag overrides that mechanism, and forces bzip2 to decompress. -z --compress The complement to -d: forces compression, regardless of the invokation name. -t --test Check integrity of the speciﬁed ﬁle(s), but don’t decompress them. This really performs a trial decompression and throws away the result. -f --force Force overwrite of output ﬁles. Normally, bzip2 will not overwrite existing output ﬁles. bzip2 to break hard links to ﬁles, which it otherwise wouldn’t do.

Also forces

bzip2 normally declines to decompress ﬁles which don’t have the correct magic header bytes. If forced (-f), however, it will pass such ﬁles through unmodiﬁed. This is how GNU gzip behaves. -k --keep Keep (don’t delete) input ﬁles during compression or decompression. -s --small Reduce memory usage, for compression, decompression and testing. Files are decompressed and tested using a modiﬁed algorithm which only requires 2.5 bytes per block byte. This means any ﬁle can be decompressed in 2300k of memory, albeit at about half the normal speed. During compression, -s selects a block size of 200k, which limits memory use to around the same ﬁgure, at the expense of your compression ratio. In short, if your machine is low on memory (8 megabytes or less), use -s for everything. See MEMORY MANAGEMENT [5] below. -q --quiet Suppress non-essential warning messages. Messages pertaining to I/O errors and other critical events will not be suppressed. 4

How to use bzip2

-v --verbose Verbose mode -- show the compression ratio for each ﬁle processed. Further -v’s increase the verbosity level, spewing out lots of information which is primarily of interest for diagnostic purposes. -L --license -V --version Display the software version, license terms and conditions. -1 (or --fast) to -9 (or -best) Set the block size to 100 k, 200 k ... 900 k when compressing. Has no effect when decompressing. See MEMORY MANAGEMENT [5] below. The --fast and --best aliases are primarily for GNU gzip compatibility. In particular, --fast doesn’t make things signiﬁcantly faster. And --best merely selects the default behaviour. -Treats all subsequent arguments as ﬁle names, even if they start with a dash. This is so you can handle ﬁles with names beginning with a dash, for example: bzip2 -- -myfilename. --repetitive-fast , --repetitive-best These ﬂags are redundant in versions 0.9.5 and above. They provided some coarse control over the behaviour of the sorting algorithm in earlier versions, which was sometimes useful. 0.9.5 and above have an improved algorithm which renders these ﬂags irrelevant.

2.5. MEMORY MANAGEMENT
bzip2 compresses large ﬁles in blocks. The block size affects both the compression ratio achieved, and the amount of memory needed for compression and decompression. The ﬂags -1 through -9 specify the block size to be 100,000 bytes through 900,000 bytes (the default) respectively. At decompression time, the block size used for compression is read from the header of the compressed ﬁle, and bunzip2 then allocates itself just enough memory to decompress the ﬁle. Since block sizes are stored in compressed ﬁles, it follows that the ﬂags -1 to -9 are irrelevant to and so ignored during decompression. Compression and decompression requirements, in bytes, can be estimated as: Compression: 400k + ( 8 x block size ) Decompression: 100k + ( 4 x block size ), or 100k + ( 2.5 x block size )

Larger block sizes give rapidly diminishing marginal returns. Most of the compression comes from the ﬁrst two or three hundred k of block size, a fact worth bearing in mind when using bzip2 on small machines. It is also important to appreciate that the decompression memory requirement is set at compression time by the choice of block size. For ﬁles compressed with the default 900k block size, bunzip2 will require about 3700 kbytes to decompress. To support decompression of any ﬁle on a 4 megabyte machine, bunzip2 has an option to decompress using approximately half this amount of memory, about 2300 kbytes. Decompression speed is also halved, so you should use this option only where necessary. The relevant ﬂag is -s. In general, try and use the largest block size memory constraints allow, since that maximises the compression achieved. Compression and decompression speed are virtually unaffected by block size. Another signiﬁcant point applies to ﬁles which ﬁt in a single block -- that means most ﬁles you’d encounter using a large block size. The amount of real memory touched is proportional to the size of the ﬁle, since the ﬁle is smaller 5

How to use bzip2

than a block. For example, compressing a ﬁle 20,000 bytes long with the ﬂag -9 will cause the compressor to allocate around 7600k of memory, but only touch 400k + 20000 * 8 = 560 kbytes of it. Similarly, the decompressor will allocate 3700k but only touch 100k + 20000 * 4 = 180 kbytes. Here is a table which summarises the maximum memory usage for different block sizes. Also recorded is the total compressed size for 14 ﬁles of the Calgary Text Compression Corpus totalling 3,141,622 bytes. This column gives some feel for how compression varies with block size. These ﬁgures tend to understate the advantage of larger block sizes for larger ﬁles, since the Corpus is dominated by smaller ﬁles. Compress Decompress Decompress Corpus Flag usage usage -s usage Size -1 -2 -3 -4 -5 -6 -7 -8 -9 1200k 2000k 2800k 3600k 4400k 5200k 6100k 6800k 7600k 500k 900k 1300k 1700k 2100k 2500k 2900k 3300k 3700k 350k 600k 850k 1100k 1350k 1600k 1850k 2100k 2350k 914704 877703 860338 846899 845160 838626 834096 828642 828642

2.6. RECOVERING DATA FROM DAMAGED FILES
bzip2 compresses ﬁles in blocks, usually 900kbytes long. Each block is handled independently. If a media or transmission error causes a multi-block .bz2 ﬁle to become damaged, it may be possible to recover data from the undamaged blocks in the ﬁle. The compressed representation of each block is delimited by a 48-bit pattern, which makes it possible to ﬁnd the block boundaries with reasonable certainty. Each block also carries its own 32-bit CRC, so damaged blocks can be distinguished from undamaged ones. bzip2recover is a simple program whose purpose is to search for blocks in .bz2 ﬁles, and write each block out into its own .bz2 ﬁle. You can then use bzip2 -t to test the integrity of the resulting ﬁles, and decompress those which are undamaged. bzip2recover takes a single argument, the name of the damaged ﬁle, and writes a number of ﬁles rec0001file.bz2, rec0002file.bz2, etc, containing the extracted blocks. The output ﬁlenames are designed so that the use of wildcards in subsequent processing -- for example, bzip2 -dc rec*file.bz2 > recovered_data -- lists the ﬁles in the correct order. bzip2recover should be of most use dealing with large .bz2 ﬁles, as these will contain many blocks. It is clearly futile to use it on damaged single-block ﬁles, since a damaged block cannot be recovered. If you wish to minimise any potential data loss through media or transmission errors, you might consider compressing with a smaller block size.

2.7. PERFORMANCE NOTES
The sorting phase of compression gathers together similar strings in the ﬁle. Because of this, ﬁles containing very long runs of repeated symbols, like ""aabaabaabaab ..."" (repeated several hundred times) may compress more slowly than normal. Versions 0.9.5 and above fare much better than previous versions in this respect. The ratio between 6

How to use bzip2

worst-case and average-case compression time is in the region of 10:1. For previous versions, this ﬁgure was more like 100:1. You can use the -vvvv option to monitor progress in great detail, if you want. Decompression speed is unaffected by these phenomena. bzip2 usually allocates several megabytes of memory to operate in, and then charges all over it in a fairly random fashion. This means that performance, both for compressing and decompressing, is largely determined by the speed at which your machine can service cache misses. Because of this, small changes to the code to reduce the miss rate have been observed to give disproportionately large performance improvements. I imagine bzip2 will perform best on machines with very large caches.

2.8. CAVEATS
I/O error messages are not as helpful as they could be. bzip2 tries hard to detect I/O errors and exit cleanly, but the details of what the problem is sometimes seem rather misleading. This manual page pertains to version 1.0.6 of bzip2. Compressed data created by this version is entirely forwards and backwards compatible with the previous public releases, versions 0.1pl2, 0.9.0 and 0.9.5, 1.0.0, 1.0.1, 1.0.2 and 1.0.3, but with the following exception: 0.9.0 and above can correctly decompress multiple concatenated compressed ﬁles. 0.1pl2 cannot do this; it will stop after decompressing just the ﬁrst ﬁle in the stream. bzip2recover versions prior to 1.0.2 used 32-bit integers to represent bit positions in compressed ﬁles, so it could not handle compressed ﬁles more than 512 megabytes long. Versions 1.0.2 and above use 64-bit ints on some platforms which support them (GNU supported targets, and Windows). To establish whether or not bzip2recover was built with such a limitation, run it without arguments. In any event you can build yourself an unlimited version if you can recompile it with MaybeUInt64 set to be an unsigned 64-bit integer.

2.9. AUTHOR
Julian Seward, jseward@bzip.org The ideas embodied in bzip2 are due to (at least) the following people: Michael Burrows and David Wheeler (for the block sorting transformation), David Wheeler (again, for the Huffman coder), Peter Fenwick (for the structured coding model in the original bzip, and many reﬁnements), and Alistair Moffat, Radford Neal and Ian Witten (for the arithmetic coder in the original bzip). I am much indebted for their help, support and advice. See the manual in the source distribution for pointers to sources of documentation. Christian von Roques encouraged me to look for faster sorting algorithms, so as to speed up compression. Bela Lubkin encouraged me to improve the worst-case compression performance. Donna Robinson XMLised the documentation. Many people sent patches, helped with portability problems, lent machines, gave advice and were generally helpful.

7

3. Programming with libbzip2
Table of Contents
3.1. Top-level structure .......................................................................... 8 3.1.1. Low-level summary ....................................................................... 9 3.1.2. High-level summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9 3.1.3. Utility functions summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9 3.2. Error handling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10 3.3. Low-level interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11 3.3.1. BZ2_bzCompressInit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11 3.3.2. BZ2_bzCompress . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13 3.3.3. BZ2_bzCompressEnd . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16 3.3.4. BZ2_bzDecompressInit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16 3.3.5. BZ2_bzDecompress . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17 3.3.6. BZ2_bzDecompressEnd . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18 3.4. High-level interface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18 3.4.1. BZ2_bzReadOpen . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19 3.4.2. BZ2_bzRead . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20 3.4.3. BZ2_bzReadGetUnused . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21 3.4.4. BZ2_bzReadClose . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22 3.4.5. BZ2_bzWriteOpen . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22 3.4.6. BZ2_bzWrite . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23 3.4.7. BZ2_bzWriteClose . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23 3.4.8. Handling embedded compressed data streams . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24 3.4.9. Standard ﬁle-reading/writing code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25 3.5. Utility functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26 3.5.1. BZ2_bzBuffToBuffCompress . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26 3.5.2. BZ2_bzBuffToBuffDecompress . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27 3.6. zlib compatibility functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28 3.7. Using the library in a stdio-free environment . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28 3.7.1. Getting rid of stdio . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29 3.7.2. Critical error handling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29 3.8. Making a Windows DLL . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29 This chapter describes the programming interface to libbzip2. For general background information, particularly about memory use and performance aspects, you’d be well advised to read How to use bzip2 [2] as well.

3.1. Top-level structure
libbzip2 is a ﬂexible library for compressing and decompressing data in the bzip2 data format. Although packaged as a single entity, it helps to regard the library as three separate parts: the low level interface, and the high level interface, and some utility functions. The structure of libbzip2’s interfaces is similar to that of Jean-loup Gailly’s and Mark Adler’s excellent zlib library. All externally visible symbols have names beginning BZ2_. This is new in version 1.0. The intention is to minimise pollution of the namespaces of library clients. 8

Programming with libbzip2

To use any part of the library, you need to #include <bzlib.h> into your sources.

3.1.1. Low-level summary
This interface provides services for compressing and decompressing data in memory. There’s no provision for dealing with ﬁles, streams or any other I/O mechanisms, just straight memory-to-memory work. In fact, this part of the library can be compiled without inclusion of stdio.h, which may be helpful for embedded applications. The low-level part of the library has no global variables and is therefore thread-safe. Six routines make up the low level interface: BZ2_bzCompressInit, BZ2_bzCompress, and BZ2_bzCompressEnd for compression, and a corresponding trio BZ2_bzDecompressInit, BZ2_bzDecompress and BZ2_bzDecompressEnd for decompression. The *Init functions allocate memory for compression/decompression and do other initialisations, whilst the *End functions close down operations and release memory. The real work is done by BZ2_bzCompress and BZ2_bzDecompress. These compress and decompress data from a user-supplied input buffer to a user-supplied output buffer. These buffers can be any size; arbitrary quantities of data are handled by making repeated calls to these functions. This is a ﬂexible mechanism allowing a consumer-pull style of activity, or producer-push, or a mixture of both.

3.1.2. High-level summary
This interface provides some handy wrappers around the low-level interface to facilitate reading and writing bzip2 format ﬁles (.bz2 ﬁles). The routines provide hooks to facilitate reading ﬁles in which the bzip2 data stream is embedded within some larger-scale ﬁle structure, or where there are multiple bzip2 data streams concatenated end-to-end. For reading ﬁles, BZ2_bzReadOpen, BZ2_bzRead, BZ2_bzReadClose and BZ2_bzReadGetUnused are supplied. For writing ﬁles, BZ2_bzWriteOpen, BZ2_bzWrite and BZ2_bzWriteFinish are available. As with the low-level library, no global variables are used so the library is per se thread-safe. However, if I/O errors occur whilst reading or writing the underlying compressed ﬁles, you may have to consult errno to determine the cause of the error. In that case, you’d need a C library which correctly supports errno in a multithreaded environment. To make the library a little simpler and more portable, BZ2_bzReadOpen and BZ2_bzWriteOpen require you to pass them ﬁle handles (FILE*s) which have previously been opened for reading or writing respectively. That avoids portability problems associated with ﬁle operations and ﬁle attributes, whilst not being much of an imposition on the programmer.

3.1.3. Utility functions summary
For very simple needs, BZ2_bzBuffToBuffCompress and BZ2_bzBuffToBuffDecompress are provided. These compress data in memory from one buffer to another buffer in a single function call. You should assess whether these functions fulﬁll your memory-to-memory compression/decompression requirements before investing effort in understanding the more general but more complex low-level interface. Yoshioka Tsuneo (tsuneo@rr.iij4u.or.jp) has contributed some functions to give better zlib compatibility. These functions are BZ2_bzopen, BZ2_bzread, BZ2_bzwrite, BZ2_bzflush, BZ2_bzclose, BZ2_bzerror and BZ2_bzlibVersion. You may ﬁnd these functions more convenient for simple ﬁle reading and writing, than those in the high-level interface. These functions are not (yet) ofﬁcially part of the library, and are minimally documented here. If they break, you get to keep all the pieces. I hope to document them properly when time permits. 9

Programming with libbzip2

Yoshioka also contributed modiﬁcations to allow the library to be built as a Windows DLL.

3.2. Error handling
The library is designed to recover cleanly in all situations, including the worst-case situation of decompressing random data. I’m not 100% sure that it can always do this, so you might want to add a signal handler to catch segmentation violations during decompression if you are feeling especially paranoid. I would be interested in hearing more about the robustness of the library to corrupted compressed data. Version 1.0.3 more robust in this respect than any previous version. Investigations with Valgrind (a tool for detecting problems with memory management) indicate that, at least for the few ﬁles I tested, all single-bit errors in the decompressed data are caught properly, with no segmentation faults, no uses of uninitialised data, no out of range reads or writes, and no inﬁnite looping in the decompressor. So it’s certainly pretty robust, although I wouldn’t claim it to be totally bombproof. The ﬁle bzlib.h contains all deﬁnitions needed to use the library. In particular, you should deﬁnitely not include bzlib_private.h. In bzlib.h, the various return values are deﬁned. The following list is not intended as an exhaustive description of the circumstances in which a given value may be returned -- those descriptions are given later. Rather, it is intended to convey the rough meaning of each return value. The ﬁrst ﬁve actions are normal and not intended to denote an error situation. BZ_OK The requested action was completed successfully. BZ_RUN_OK, BZ_FLUSH_OK, BZ_FINISH_OK In BZ2_bzCompress, the requested ﬂush/ﬁnish/nothing-special action was completed successfully. BZ_STREAM_END Compression of data was completed, or the logical stream end was detected during decompression.

The following return values indicate an error of some kind. BZ_CONFIG_ERROR Indicates that the library has been improperly compiled on your platform -- a major conﬁguration error. Speciﬁcally, it means that sizeof(char), sizeof(short) and sizeof(int) are not 1, 2 and 4 respectively, as they should be. Note that the library should still work properly on 64-bit platforms which follow the LP64 programming model -- that is, where sizeof(long) and sizeof(void*) are 8. Under LP64, sizeof(int) is still 4, so libbzip2, which doesn’t use the long type, is OK. BZ_SEQUENCE_ERROR When using the library, it is important to call the functions in the correct sequence and with data structures (buffers etc) in the correct states. libbzip2 checks as much as it can to ensure this is happening, and returns BZ_SEQUENCE_ERROR if not. Code which complies precisely with the function semantics, as detailed below, should never receive this value; such an event denotes buggy code which you should investigate. BZ_PARAM_ERROR Returned when a parameter to a function call is out of range or otherwise manifestly incorrect. As with BZ_SEQUENCE_ERROR, this denotes a bug in the client code. The distinction between BZ_PARAM_ERROR and BZ_SEQUENCE_ERROR is a bit hazy, but still worth making. 10

Programming with libbzip2

BZ_MEM_ERROR Returned when a request to allocate memory failed. Note that the quantity of memory needed to decompress a stream cannot be determined until the stream’s header has been read. So BZ2_bzDecompress and BZ2_bzRead may return BZ_MEM_ERROR even though some of the compressed data has been read. The same is not true for compression; once BZ2_bzCompressInit or BZ2_bzWriteOpen have successfully completed, BZ_MEM_ERROR cannot occur. BZ_DATA_ERROR Returned when a data integrity error is detected during decompression. Most importantly, this means when stored and computed CRCs for the data do not match. This value is also returned upon detection of any other anomaly in the compressed data. BZ_DATA_ERROR_MAGIC As a special case of BZ_DATA_ERROR, it is sometimes useful to know when the compressed stream does not start with the correct magic bytes (’B’ ’Z’ ’h’). BZ_IO_ERROR Returned by BZ2_bzRead and BZ2_bzWrite when there is an error reading or writing in the compressed ﬁle, and by BZ2_bzReadOpen and BZ2_bzWriteOpen for attempts to use a ﬁle for which the error indicator (viz, ferror(f)) is set. On receipt of BZ_IO_ERROR, the caller should consult errno and/or perror to acquire operating-system speciﬁc information about the problem. BZ_UNEXPECTED_EOF Returned by BZ2_bzRead when the compressed ﬁle ﬁnishes before the logical end of stream is detected. BZ_OUTBUFF_FULL Returned by BZ2_bzBuffToBuffCompress and BZ2_bzBuffToBuffDecompress to indicate that the output data will not ﬁt into the output buffer provided.

3.3. Low-level interface
3.3.1. BZ2_bzCompressInit

11

Programming with libbzip2

typedef struct { char *next_in; unsigned int avail_in; unsigned int total_in_lo32; unsigned int total_in_hi32; char *next_out; unsigned int avail_out; unsigned int total_out_lo32; unsigned int total_out_hi32; void *state; void *(*bzalloc)(void *,int,int); void (*bzfree)(void *,void *); void *opaque; } bz_stream; int BZ2_bzCompressInit ( bz_stream *strm, int blockSize100k, int verbosity, int workFactor );

Prepares for compression. The bz_stream structure holds all data pertaining to the compression activity. A bz_stream structure should be allocated and initialised prior to the call. The ﬁelds of bz_stream comprise the entirety of the user-visible data. state is a pointer to the private data structures required for compression. Custom memory allocators are supported, via ﬁelds bzalloc, bzfree, and opaque. The value opaque is passed to as the ﬁrst argument to all calls to bzalloc and bzfree, but is otherwise ignored by the library. The call bzalloc ( opaque, n, m ) is expected to return a pointer p to n * m bytes of memory, and bzfree ( opaque, p ) should free that memory. If you don’t want to use a custom memory allocator, set bzalloc, bzfree and opaque to NULL, and the library will then use the standard malloc / free routines. Before calling BZ2_bzCompressInit, ﬁelds bzalloc, bzfree and opaque should be ﬁlled appropriately, as just described. Upon return, the internal state will have been allocated and initialised, and total_in_lo32, total_in_hi32, total_out_lo32 and total_out_hi32 will have been set to zero. These four ﬁelds are used by the library to inform the caller of the total amount of data passed into and out of the library, respectively. You should not try to change them. As of version 1.0, 64-bit counts are maintained, even on 32-bit platforms, using the _hi32 ﬁelds to store the upper 32 bits of the count. So, for example, the total amount of data in is (total_in_hi32 << 32) + total_in_lo32. Parameter blockSize100k speciﬁes the block size to be used for compression. It should be a value between 1 and 9 inclusive, and the actual block size used is 100000 x this ﬁgure. 9 gives the best compression but takes most memory. Parameter verbosity should be set to a number between 0 and 4 inclusive. 0 is silent, and greater numbers give increasingly verbose monitoring/debugging output. If the library has been compiled with -DBZ_NO_STDIO, no such output will appear for any verbosity setting. Parameter workFactor controls how the compression phase behaves when presented with worst case, highly repetitive, input data. If compression runs into difﬁculties caused by repetitive data, the library switches from

12

Programming with libbzip2

the standard sorting algorithm to a fallback algorithm. The fallback is slower than the standard algorithm by perhaps a factor of three, but always behaves reasonably, no matter how bad the input. Lower values of workFactor reduce the amount of effort the standard algorithm will expend before resorting to the fallback. You should set this parameter carefully; too low, and many inputs will be handled by the fallback algorithm and so compress rather slowly, too high, and your average-to-worst case compression times can become very large. The default value of 30 gives reasonable behaviour over a wide range of circumstances. Allowable values range from 0 to 250 inclusive. 0 is a special case, equivalent to using the default value of 30. Note that the compressed output generated is the same regardless of whether or not the fallback algorithm is used. Be aware also that this parameter may disappear entirely in future versions of the library. In principle it should be possible to devise a good way to automatically choose which algorithm to use. Such a mechanism would render the parameter obsolete. Possible return values: BZ_CONFIG_ERROR if the library has been mis-compiled BZ_PARAM_ERROR if strm is NULL or blockSize < 1 or blockSize > 9 or verbosity < 0 or verbosity > 4 or workFactor < 0 or workFactor > 250 BZ_MEM_ERROR if not enough memory is available BZ_OK otherwise

Allowable next actions: BZ2_bzCompress if BZ_OK is returned no specific action needed in case of error

3.3.2. BZ2_bzCompress
int BZ2_bzCompress ( bz_stream *strm, int action ); Provides more input and/or output buffer space for the library. The caller maintains input and output buffers, and calls BZ2_bzCompress to transfer data between them. Before each call to BZ2_bzCompress, next_in should point at the data to be compressed, and avail_in should indicate how many bytes the library may read. BZ2_bzCompress updates next_in, avail_in and total_in to reﬂect the number of bytes it has read. Similarly, next_out should point to a buffer in which the compressed data is to be placed, with avail_out indicating how much output space is available. BZ2_bzCompress updates next_out, avail_out and total_out to reﬂect the number of bytes output. You may provide and remove as little or as much data as you like on each call of BZ2_bzCompress. In the limit, it is acceptable to supply and remove data one byte at a time, although this would be terribly inefﬁcient. You should always ensure that at least one byte of output space is available at each call. 13

Programming with libbzip2

A second purpose of BZ2_bzCompress is to request a change of mode of the compressed stream. Conceptually, a compressed stream can be in one of four states: IDLE, RUNNING, FLUSHING and FINISHING. Before initialisation (BZ2_bzCompressInit) and after termination (BZ2_bzCompressEnd), a stream is regarded as IDLE. Upon initialisation (BZ2_bzCompressInit), the stream is placed in the RUNNING state. Subsequent calls to BZ2_bzCompress should pass BZ_RUN as the requested action; other actions are illegal and will result in BZ_SEQUENCE_ERROR. At some point, the calling program will have provided all the input data it wants to. It will then want to ﬁnish up -in effect, asking the library to process any data it might have buffered internally. In this state, BZ2_bzCompress will no longer attempt to read data from next_in, but it will want to write data to next_out. Because the output buffer supplied by the user can be arbitrarily small, the ﬁnishing-up operation cannot necessarily be done with a single call of BZ2_bzCompress. Instead, the calling program passes BZ_FINISH as an action to BZ2_bzCompress. This changes the stream’s state to FINISHING. Any remaining input (ie, next_in[0 .. avail_in-1]) is compressed and transferred to the output buffer. To do this, BZ2_bzCompress must be called repeatedly until all the output has been consumed. At that point, BZ2_bzCompress returns BZ_STREAM_END, and the stream’s state is set back to IDLE. BZ2_bzCompressEnd should then be called. Just to make sure the calling program does not cheat, the library makes a note of avail_in at the time of the ﬁrst call to BZ2_bzCompress which has BZ_FINISH as an action (ie, at the time the program has announced its intention to not supply any more input). By comparing this value with that of avail_in over subsequent calls to BZ2_bzCompress, the library can detect any attempts to slip in more data to compress. Any calls for which this is detected will return BZ_SEQUENCE_ERROR. This indicates a programming mistake which should be corrected. Instead of asking to ﬁnish, the calling program may ask BZ2_bzCompress to take all the remaining input, compress it and terminate the current (Burrows-Wheeler) compression block. This could be useful for error control purposes. The mechanism is analogous to that for ﬁnishing: call BZ2_bzCompress with an action of BZ_FLUSH, remove output data, and persist with the BZ_FLUSH action until the value BZ_RUN is returned. As with ﬁnishing, BZ2_bzCompress detects any attempt to provide more input data once the ﬂush has begun. Once the ﬂush is complete, the stream returns to the normal RUNNING state. This all sounds pretty complex, but isn’t really. Here’s a table which shows which actions are allowable in each state, what action will be taken, what the next state is, and what the non-error return values are. Note that you can’t explicitly ask what state the stream is in, but nor do you need to -- it can be inferred from the values returned by BZ2_bzCompress.

14

Programming with libbzip2

IDLE/any Illegal. IDLE state only exists after BZ2_bzCompressEnd or before BZ2_bzCompressInit. Return value = BZ_SEQUENCE_ERROR RUNNING/BZ_RUN Compress from next_in to next_out as much as possible. Next state = RUNNING Return value = BZ_RUN_OK RUNNING/BZ_FLUSH Remember current value of next_in. Compress from next_in to next_out as much as possible, but do not accept any more input. Next state = FLUSHING Return value = BZ_FLUSH_OK RUNNING/BZ_FINISH Remember current value of next_in. Compress from next_in to next_out as much as possible, but do not accept any more input. Next state = FINISHING Return value = BZ_FINISH_OK FLUSHING/BZ_FLUSH Compress from next_in to next_out as much as possible, but do not accept any more input. If all the existing input has been used up and all compressed output has been removed Next state = RUNNING; Return value = BZ_RUN_OK else Next state = FLUSHING; Return value = BZ_FLUSH_OK FLUSHING/other Illegal. Return value = BZ_SEQUENCE_ERROR FINISHING/BZ_FINISH Compress from next_in to next_out as much as possible, but to not accept any more input. If all the existing input has been used up and all compressed output has been removed Next state = IDLE; Return value = BZ_STREAM_END else Next state = FINISHING; Return value = BZ_FINISH_OK FINISHING/other Illegal. Return value = BZ_SEQUENCE_ERROR

That still looks complicated? Well, fair enough. The usual sequence of calls for compressing a load of data is: 1. Get started with BZ2_bzCompressInit.

15

Programming with libbzip2

2. Shovel data in and shlurp out its compressed form using zero or more calls of BZ2_bzCompress with action = BZ_RUN. 3. Finish up. Repeatedly call BZ2_bzCompress with action = BZ_FINISH, copying out the compressed output, until BZ_STREAM_END is returned. 4. Close up and go home. Call BZ2_bzCompressEnd. If the data you want to compress ﬁts into your input buffer all at once, you can skip the calls of BZ2_bzCompress ( ..., BZ_RUN ) and just do the BZ2_bzCompress ( ..., BZ_FINISH ) calls. All required memory is allocated by BZ2_bzCompressInit. The compression library can accept any data at all (obviously). So you shouldn’t get any error return values from the BZ2_bzCompress calls. If you do, they will be BZ_SEQUENCE_ERROR, and indicate a bug in your programming. Trivial other possible return values: BZ_PARAM_ERROR if strm is NULL, or strm->s is NULL

3.3.3. BZ2_bzCompressEnd
int BZ2_bzCompressEnd ( bz_stream *strm ); Releases all memory associated with a compression stream. Possible return values: BZ_PARAM_ERROR if strm is NULL or strm->s is NULL BZ_OK otherwise

3.3.4. BZ2_bzDecompressInit
int BZ2_bzDecompressInit ( bz_stream *strm, int verbosity, int small ); Prepares for decompression. As with BZ2_bzCompressInit, a bz_stream record should be allocated and initialised before the call. Fields bzalloc, bzfree and opaque should be set if a custom memory allocator is required, or made NULL for the normal malloc / free routines. Upon return, the internal state will have been initialised, and total_in and total_out will be zero. For the meaning of parameter verbosity, see BZ2_bzCompressInit. If small is nonzero, the library will use an alternative decompression algorithm which uses less memory but at the cost of decompressing more slowly (roughly speaking, half the speed, but the maximum memory requirement drops to around 2300k). See How to use bzip2 [2] for more information on memory management. Note that the amount of memory needed to decompress a stream cannot be determined until the stream’s header has been read, so even if BZ2_bzDecompressInit succeeds, a subsequent BZ2_bzDecompress could fail with BZ_MEM_ERROR. Possible return values:

16

Programming with libbzip2

BZ_CONFIG_ERROR if the library has been mis-compiled BZ_PARAM_ERROR if ( small != 0 && small != 1 ) or (verbosity <; 0 || verbosity > 4) BZ_MEM_ERROR if insufficient memory is available

Allowable next actions: BZ2_bzDecompress if BZ_OK was returned no specific action required in case of error

3.3.5. BZ2_bzDecompress
int BZ2_bzDecompress ( bz_stream *strm ); Provides more input and/out output buffer space for the library. The caller maintains input and output buffers, and uses BZ2_bzDecompress to transfer data between them. Before each call to BZ2_bzDecompress, next_in should point at the compressed data, and avail_in should indicate how many bytes the library may read. BZ2_bzDecompress updates next_in, avail_in and total_in to reﬂect the number of bytes it has read. Similarly, next_out should point to a buffer in which the uncompressed output is to be placed, with avail_out indicating how much output space is available. BZ2_bzCompress updates next_out, avail_out and total_out to reﬂect the number of bytes output. You may provide and remove as little or as much data as you like on each call of BZ2_bzDecompress. In the limit, it is acceptable to supply and remove data one byte at a time, although this would be terribly inefﬁcient. You should always ensure that at least one byte of output space is available at each call. Use of BZ2_bzDecompress is simpler than BZ2_bzCompress. You should provide input and remove output as described above, and repeatedly call BZ2_bzDecompress until BZ_STREAM_END is returned. Appearance of BZ_STREAM_END denotes that BZ2_bzDecompress has detected the logical end of the compressed stream. BZ2_bzDecompress will not produce BZ_STREAM_END until all output data has been placed into the output buffer, so once BZ_STREAM_END appears, you are guaranteed to have available all the decompressed output, and BZ2_bzDecompressEnd can safely be called. If case of an error return value, you should call BZ2_bzDecompressEnd to clean up and release memory. Possible return values:

17

Programming with libbzip2

BZ_PARAM_ERROR if strm is NULL or strm->s is NULL or strm->avail_out < 1 BZ_DATA_ERROR if a data integrity error is detected in the compressed stream BZ_DATA_ERROR_MAGIC if the compressed stream doesn’t begin with the right magic bytes BZ_MEM_ERROR if there wasn’t enough memory available BZ_STREAM_END if the logical end of the data stream was detected and all output in has been consumed, eg s-->avail_out > 0 BZ_OK otherwise

Allowable next actions: BZ2_bzDecompress if BZ_OK was returned BZ2_bzDecompressEnd otherwise

3.3.6. BZ2_bzDecompressEnd
int BZ2_bzDecompressEnd ( bz_stream *strm ); Releases all memory associated with a decompression stream. Possible return values: BZ_PARAM_ERROR if strm is NULL or strm->s is NULL BZ_OK otherwise

Allowable next actions: None.

3.4. High-level interface
This interface provides functions for reading and writing bzip2 format ﬁles. First, some general points. • All of the functions take an int* ﬁrst argument, bzerror. After each call, bzerror should be consulted ﬁrst to determine the outcome of the call. If bzerror is BZ_OK, the call completed successfully, and only then should the return value of the function (if any) be consulted. If bzerror is BZ_IO_ERROR, there was an error reading/writing the underlying compressed ﬁle, and you should then consult errno / perror to determine the cause of the difﬁculty. bzerror may also be set to various other values; precise details are given on a per-function basis below.

18

Programming with libbzip2

• If bzerror indicates an error (ie, anything except BZ_OK and BZ_STREAM_END), you should immediately call BZ2_bzReadClose (or BZ2_bzWriteClose, depending on whether you are attempting to read or to write) to free up all resources associated with the stream. Once an error has been indicated, behaviour of all calls except BZ2_bzReadClose (BZ2_bzWriteClose) is undeﬁned. The implication is that (1) bzerror should be checked after each call, and (2) if bzerror indicates an error, BZ2_bzReadClose (BZ2_bzWriteClose) should then be called to clean up. • The FILE* arguments passed to BZ2_bzReadOpen / BZ2_bzWriteOpen should be set to binary mode. Most Unix systems will do this by default, but other platforms, including Windows and Mac, will not. If you omit this, you may encounter problems when moving code to new platforms. • Memory allocation requests are handled by malloc / free. At present there is no facility for user-deﬁned memory allocators in the ﬁle I/O functions (could easily be added, though).

3.4.1. BZ2_bzReadOpen
typedef void BZFILE; BZFILE *BZ2_bzReadOpen( int *bzerror, FILE *f, int verbosity, int small, void *unused, int nUnused );

Prepare to read compressed data from ﬁle handle f. f should refer to a ﬁle which has been opened for reading, and for which the error indicator (ferror(f))is not set. If small is 1, the library will try to decompress using less memory, at the expense of speed. For reasons explained below, BZ2_bzRead will decompress the nUnused bytes starting at unused, before starting to read from the ﬁle f. At most BZ_MAX_UNUSED bytes may be supplied like this. If this facility is not required, you should pass NULL and 0 for unused and nUnused respectively. For the meaning of parameters small and verbosity, see BZ2_bzDecompressInit. The amount of memory needed to decompress a ﬁle cannot be determined until the ﬁle’s header has been read. So it is possible that BZ2_bzReadOpen returns BZ_OK but a subsequent call of BZ2_bzRead will return BZ_MEM_ERROR. Possible assignments to bzerror: BZ_CONFIG_ERROR if the library has been mis-compiled BZ_PARAM_ERROR if f is NULL or small is neither 0 nor 1 or ( unused == NULL && nUnused != 0 ) or ( unused != NULL && !(0 <= nUnused <= BZ_MAX_UNUSED) ) BZ_IO_ERROR if ferror(f) is nonzero BZ_MEM_ERROR if insufficient memory is available BZ_OK otherwise.

Possible return values: 19

Programming with libbzip2

Pointer to an abstract BZFILE if bzerror is BZ_OK NULL otherwise

Allowable next actions: BZ2_bzRead if bzerror is BZ_OK BZ2_bzClose otherwise

3.4.2. BZ2_bzRead
int BZ2_bzRead ( int *bzerror, BZFILE *b, void *buf, int len ); Reads up to len (uncompressed) bytes from the compressed ﬁle b into the buffer buf. If the read was successful, bzerror is set to BZ_OK and the number of bytes read is returned. If the logical end-of-stream was detected, bzerror will be set to BZ_STREAM_END, and the number of bytes read is returned. All other bzerror values denote an error. BZ2_bzRead will supply len bytes, unless the logical stream end is detected or an error occurs. Because of this, it is possible to detect the stream end by observing when the number of bytes returned is less than the number requested. Nevertheless, this is regarded as inadvisable; you should instead check bzerror after every call and watch out for BZ_STREAM_END. Internally, BZ2_bzRead copies data from the compressed ﬁle in chunks of size BZ_MAX_UNUSED bytes before decompressing it. If the ﬁle contains more bytes than strictly needed to reach the logical end-of-stream, BZ2_bzRead will almost certainly read some of the trailing data before signalling BZ_SEQUENCE_END. To collect the read but unused data once BZ_SEQUENCE_END has appeared, call BZ2_bzReadGetUnused immediately before BZ2_bzReadClose. Possible assignments to bzerror:

20

Programming with libbzip2

BZ_PARAM_ERROR if b is NULL or buf is NULL or len < 0 BZ_SEQUENCE_ERROR if b was opened with BZ2_bzWriteOpen BZ_IO_ERROR if there is an error reading from the compressed file BZ_UNEXPECTED_EOF if the compressed file ended before the logical end-of-stream was detected BZ_DATA_ERROR if a data integrity error was detected in the compressed stream BZ_DATA_ERROR_MAGIC if the stream does not begin with the requisite header bytes (ie, is not a bzip2 data file). This is really a special case of BZ_DATA_ERROR. BZ_MEM_ERROR if insufficient memory was available BZ_STREAM_END if the logical end of stream was detected. BZ_OK otherwise.

Possible return values: number of bytes read if bzerror is BZ_OK or BZ_STREAM_END undefined otherwise

Allowable next actions: collect data from buf, then BZ2_bzRead or BZ2_bzReadClose if bzerror is BZ_OK collect data from buf, then BZ2_bzReadClose or BZ2_bzReadGetUnused if bzerror is BZ_SEQUENCE_END BZ2_bzReadClose otherwise

3.4.3. BZ2_bzReadGetUnused
void BZ2_bzReadGetUnused( int* bzerror, BZFILE *b, void** unused, int* nUnused );

Returns data which was read from the compressed ﬁle but was not needed to get to the logical end-of-stream. *unused is set to the address of the data, and *nUnused to the number of bytes. *nUnused will be set to a value between 0 and BZ_MAX_UNUSED inclusive. This function may only be called once BZ2_bzRead has signalled BZ_STREAM_END but before BZ2_bzReadClose. Possible assignments to bzerror:

21

Programming with libbzip2

BZ_PARAM_ERROR if b is NULL or unused is NULL or nUnused is NULL BZ_SEQUENCE_ERROR if BZ_STREAM_END has not been signalled or if b was opened with BZ2_bzWriteOpen BZ_OK otherwise

Allowable next actions: BZ2_bzReadClose

3.4.4. BZ2_bzReadClose
void BZ2_bzReadClose ( int *bzerror, BZFILE *b ); Releases all memory pertaining to the compressed ﬁle b. BZ2_bzReadClose does not call fclose on the underlying ﬁle handle, so you should do that yourself if appropriate. BZ2_bzReadClose should be called to clean up after all error situations. Possible assignments to bzerror: BZ_SEQUENCE_ERROR if b was opened with BZ2_bzOpenWrite BZ_OK otherwise

Allowable next actions: none

3.4.5. BZ2_bzWriteOpen
BZFILE *BZ2_bzWriteOpen( int *bzerror, FILE *f, int blockSize100k, int verbosity, int workFactor );

Prepare to write compressed data to ﬁle handle f. f should refer to a ﬁle which has been opened for writing, and for which the error indicator (ferror(f))is not set. For the meaning of parameters blockSize100k, verbosity and workFactor, see BZ2_bzCompressInit. All required memory is allocated at this stage, so if the call completes successfully, BZ_MEM_ERROR cannot be signalled by a subsequent call to BZ2_bzWrite. Possible assignments to bzerror:

22

Programming with libbzip2

BZ_CONFIG_ERROR if the library has been mis-compiled BZ_PARAM_ERROR if f is NULL or blockSize100k < 1 or blockSize100k > 9 BZ_IO_ERROR if ferror(f) is nonzero BZ_MEM_ERROR if insufficient memory is available BZ_OK otherwise

Possible return values: Pointer to an abstract BZFILE if bzerror is BZ_OK NULL otherwise

Allowable next actions: BZ2_bzWrite if bzerror is BZ_OK (you could go directly to BZ2_bzWriteClose, but this would be pretty ← pointless) BZ2_bzWriteClose otherwise

3.4.6. BZ2_bzWrite
void BZ2_bzWrite ( int *bzerror, BZFILE *b, void *buf, int len ); Absorbs len bytes from the buffer buf, eventually to be compressed and written to the ﬁle. Possible assignments to bzerror: BZ_PARAM_ERROR if b is NULL or buf is NULL or len < 0 BZ_SEQUENCE_ERROR if b was opened with BZ2_bzReadOpen BZ_IO_ERROR if there is an error writing the compressed file. BZ_OK otherwise

3.4.7. BZ2_bzWriteClose

23

Programming with libbzip2

void BZ2_bzWriteClose( int *bzerror, BZFILE* f, int abandon, unsigned int* nbytes_in, unsigned int* nbytes_out ); void BZ2_bzWriteClose64( int *bzerror, BZFILE* f, int abandon, unsigned int* nbytes_in_lo32, unsigned int* nbytes_in_hi32, unsigned int* nbytes_out_lo32, unsigned int* nbytes_out_hi32 );

Compresses and ﬂushes to the compressed ﬁle all data so far supplied by BZ2_bzWrite. The logical end-ofstream markers are also written, so subsequent calls to BZ2_bzWrite are illegal. All memory associated with the compressed ﬁle b is released. fflush is called on the compressed ﬁle, but it is not fclose’d. If BZ2_bzWriteClose is called to clean up after an error, the only action is to release the memory. The library records the error codes issued by previous calls, so this situation will be detected automatically. There is no attempt to complete the compression operation, nor to fflush the compressed ﬁle. You can force this behaviour to happen even in the case of no error, by passing a nonzero value to abandon. If nbytes_in is non-null, *nbytes_in will be set to be the total volume of uncompressed data handled. Similarly, nbytes_out will be set to the total volume of compressed data written. For compatibility with older versions of the library, BZ2_bzWriteClose only yields the lower 32 bits of these counts. Use BZ2_bzWriteClose64 if you want the full 64 bit counts. These two functions are otherwise absolutely identical. Possible assignments to bzerror: BZ_SEQUENCE_ERROR if b was opened with BZ2_bzReadOpen BZ_IO_ERROR if there is an error writing the compressed file BZ_OK otherwise

3.4.8. Handling embedded compressed data streams
The high-level library facilitates use of bzip2 data streams which form some part of a surrounding, larger data stream. • For writing, the library takes an open ﬁle handle, writes compressed data to it, fflushes it but does not fclose it. The calling application can write its own data before and after the compressed data stream, using that same ﬁle handle. • Reading is more complex, and the facilities are not as general as they could be since generality is hard to reconcile with efﬁciency. BZ2_bzRead reads from the compressed ﬁle in blocks of size BZ_MAX_UNUSED bytes, and in doing so probably will overshoot the logical end of compressed stream. To recover this data once decompression has ended, call BZ2_bzReadGetUnused after the last call of BZ2_bzRead (the one returning BZ_STREAM_END) but before calling BZ2_bzReadClose.

24

Programming with libbzip2

This mechanism makes it easy to decompress multiple bzip2 streams placed end-to-end. As the end of one stream, when BZ2_bzRead returns BZ_STREAM_END, call BZ2_bzReadGetUnused to collect the unused data (copy it into your own buffer somewhere). That data forms the start of the next compressed stream. To start uncompressing that next stream, call BZ2_bzReadOpen again, feeding in the unused data via the unused / nUnused parameters. Keep doing this until BZ_STREAM_END return coincides with the physical end of ﬁle (feof(f)). In this situation BZ2_bzReadGetUnused will of course return no data. This should give some feel for how the high-level interface can be used. If you require extra ﬂexibility, you’ll have to bite the bullet and get to grips with the low-level interface.

3.4.9. Standard ﬁle-reading/writing code
Here’s how you’d write data to a compressed ﬁle: FILE* f; BZFILE* b; int nBuf; char buf[ /* whatever size you like */ ]; int bzerror; int nWritten; f = fopen ( ""myfile.bz2"", ""w"" ); if ( !f ) { /* handle error */ } b = BZ2_bzWriteOpen( &bzerror, f, 9 ); if (bzerror != BZ_OK) { BZ2_bzWriteClose ( b ); /* handle error */ } while ( /* condition */ ) { /* get data to write into buf, and set nBuf appropriately */ nWritten = BZ2_bzWrite ( &bzerror, b, buf, nBuf ); if (bzerror == BZ_IO_ERROR) { BZ2_bzWriteClose ( &bzerror, b ); /* handle error */ } } BZ2_bzWriteClose( &bzerror, b ); if (bzerror == BZ_IO_ERROR) { /* handle error */ }

And to read from a compressed ﬁle:

25

Programming with libbzip2

FILE* f; BZFILE* b; int nBuf; char buf[ /* whatever size you like */ ]; int bzerror; int nWritten; f = fopen ( ""myfile.bz2"", ""r"" ); if ( !f ) { /* handle error */ } b = BZ2_bzReadOpen ( &bzerror, f, 0, NULL, 0 ); if ( bzerror != BZ_OK ) { BZ2_bzReadClose ( &bzerror, b ); /* handle error */ } bzerror = BZ_OK; while ( bzerror == BZ_OK && /* arbitrary other conditions */) { nBuf = BZ2_bzRead ( &bzerror, b, buf, /* size of buf */ ); if ( bzerror == BZ_OK ) { /* do something with buf[0 .. nBuf-1] */ } } if ( bzerror != BZ_STREAM_END ) { BZ2_bzReadClose ( &bzerror, b ); /* handle error */ } else { BZ2_bzReadClose ( &bzerror, b ); }

3.5. Utility functions
3.5.1. BZ2_bzBuffToBuffCompress
int BZ2_bzBuffToBuffCompress( char* dest, unsigned int* destLen, char* source, unsigned int sourceLen, int blockSize100k, int verbosity, int workFactor );

Attempts to compress the data in source[0 .. sourceLen-1] into the destination buffer, dest[0 .. *destLen-1]. If the destination buffer is big enough, *destLen is set to the size of the compressed data, and BZ_OK is returned. If the compressed data won’t ﬁt, *destLen is unchanged, and BZ_OUTBUFF_FULL is returned. Compression in this manner is a one-shot event, done with a single call to this function. The resulting compressed data is a complete bzip2 format data stream. There is no mechanism for making additional calls to provide extra input data. If you want that kind of mechanism, use the low-level interface. 26

Programming with libbzip2

For the meaning of parameters blockSize100k, verbosity and workFactor, see BZ2_bzCompressInit. To guarantee that the compressed data will ﬁt in its buffer, allocate an output buffer of size 1% larger than the uncompressed data, plus six hundred extra bytes. BZ2_bzBuffToBuffDecompress will not write data at or beyond dest[*destLen], even in case of buffer overﬂow. Possible return values: BZ_CONFIG_ERROR if the library has been mis-compiled BZ_PARAM_ERROR if dest is NULL or destLen is NULL or blockSize100k < 1 or blockSize100k > 9 or verbosity < 0 or verbosity > 4 or workFactor < 0 or workFactor > 250 BZ_MEM_ERROR if insufficient memory is available BZ_OUTBUFF_FULL if the size of the compressed data exceeds *destLen BZ_OK otherwise

3.5.2. BZ2_bzBuffToBuffDecompress
int BZ2_bzBuffToBuffDecompress( char* dest, unsigned int* destLen, char* source, unsigned int sourceLen, int small, int verbosity );

Attempts to decompress the data in source[0 .. sourceLen-1] into the destination buffer, dest[0 .. *destLen-1]. If the destination buffer is big enough, *destLen is set to the size of the uncompressed data, and BZ_OK is returned. If the compressed data won’t ﬁt, *destLen is unchanged, and BZ_OUTBUFF_FULL is returned. source is assumed to hold a complete bzip2 format data stream. BZ2_bzBuffToBuffDecompress tries to decompress the entirety of the stream into the output buffer. For the meaning of parameters small and verbosity, see BZ2_bzDecompressInit. Because the compression ratio of the compressed data cannot be known in advance, there is no easy way to guarantee that the output buffer will be big enough. You may of course make arrangements in your code to record the size of the uncompressed data, but such a mechanism is beyond the scope of this library. BZ2_bzBuffToBuffDecompress will not write data at or beyond dest[*destLen], even in case of buffer overﬂow. Possible return values:

27

Programming with libbzip2

BZ_CONFIG_ERROR if the library has been mis-compiled BZ_PARAM_ERROR if dest is NULL or destLen is NULL or small != 0 && small != 1 or verbosity < 0 or verbosity > 4 BZ_MEM_ERROR if insufficient memory is available BZ_OUTBUFF_FULL if the size of the compressed data exceeds *destLen BZ_DATA_ERROR if a data integrity error was detected in the compressed data BZ_DATA_ERROR_MAGIC if the compressed data doesn’t begin with the right magic bytes BZ_UNEXPECTED_EOF if the compressed data ends unexpectedly BZ_OK otherwise

3.6. zlib compatibility functions
Yoshioka Tsuneo has contributed some functions to give better zlib compatibility. These functions are BZ2_bzopen, BZ2_bzread, BZ2_bzwrite, BZ2_bzflush, BZ2_bzclose, BZ2_bzerror and BZ2_bzlibVersion. These functions are not (yet) ofﬁcially part of the library. If they break, you get to keep all the pieces. Nevertheless, I think they work ok. typedef void BZFILE; const char * BZ2_bzlibVersion ( void );

Returns a string indicating the library version. BZFILE * BZ2_bzopen ( const char *path, const char *mode ); BZFILE * BZ2_bzdopen ( int fd, const char *mode );

Opens a .bz2 ﬁle for reading or writing, using either its name or a pre-existing ﬁle descriptor. Analogous to fopen and fdopen. int BZ2_bzread ( BZFILE* b, void* buf, int len ); int BZ2_bzwrite ( BZFILE* b, void* buf, int len );

Reads/writes data from/to a previously opened BZFILE. Analogous to fread and fwrite. int BZ2_bzflush ( BZFILE* b ); void BZ2_bzclose ( BZFILE* b );

Flushes/closes a BZFILE. BZ2_bzflush doesn’t actually do anything. Analogous to fflush and fclose. const char * BZ2_bzerror ( BZFILE *b, int *errnum )

Returns a string describing the more recent error status of b, and also sets *errnum to its numerical value. 28

Programming with libbzip2

3.7. Using the library in a stdio-free environment
3.7.1. Getting rid of stdio
In a deeply embedded application, you might want to use just the memory-to-memory functions. You can do this conveniently by compiling the library with preprocessor symbol BZ_NO_STDIO deﬁned. Doing this gives you a library containing only the following eight functions: BZ2_bzCompressInit, BZ2_bzCompress, BZ2_bzCompressEnd BZ2_bzDecompressInit, BZ2_bzDecompress, BZ2_bzDecompressEnd BZ2_bzBuffToBuffCompress, BZ2_bzBuffToBuffDecompress When compiled like this, all functions will ignore verbosity settings.

3.7.2. Critical error handling
libbzip2 contains a number of internal assertion checks which should, needless to say, never be activated. Nevertheless, if an assertion should fail, behaviour depends on whether or not the library was compiled with BZ_NO_STDIO set. For a normal compile, an assertion failure yields the message: bzip2/libbzip2: internal error number N. This is a bug in bzip2/libbzip2, 1.0.6 of 6 September 2010. Please report it to me at: jseward@bzip.org. If this happened when you were using some program which uses libbzip2 as a component, you should also report this bug to the author(s) of that program. Please make an effort to report this bug; timely and accurate bug reports eventually lead to higher quality software. Thanks. Julian Seward, 6 September 2010. where N is some error code number. If N == 1007, it also prints some extra text advising the reader that unreliable memory is often associated with internal error 1007. (This is a frequently-observed-phenomenon with versions 1.0.0/1.0.1). exit(3) is then called. For a stdio-free library, assertion failures result in a call to a function declared as: extern void bz_internal_error ( int errcode );

The relevant code is passed as a parameter. You should supply such a function. In either case, once an assertion failure has occurred, any bz_stream records involved can be regarded as invalid. You should not attempt to resume normal operation with them. You may, of course, change critical error handling to suit your needs. As I said above, critical errors indicate bugs in the library and should not occur. All ""normal"" error situations are indicated via error return codes from functions, and can be recovered from.

3.8. Making a Windows DLL
Everything related to Windows has been contributed by Yoshioka Tsuneo (tsuneo@rr.iij4u.or.jp), so you should send your queries to him (but perhaps Cc: me, jseward@bzip.org). 29

Programming with libbzip2

My vague understanding of what to do is: using Visual C++ 5.0, open the project ﬁle libbz2.dsp, and build. That’s all. If you can’t open the project ﬁle for some reason, make a new one, naming these ﬁles: blocksort.c, bzlib.c, compress.c, crctable.c, decompress.c, huffman.c, randtable.c and libbz2.def. You will also need to name the header ﬁles bzlib.h and bzlib_private.h. If you don’t use VC++, you may need to deﬁne the proprocessor symbol _WIN32. Finally, dlltest.c is a sample program using the DLL. It has a project ﬁle, dlltest.dsp. If you just want a makeﬁle for Visual C, have a look at makefile.msc. Be aware that if you compile bzip2 itself on Win32, you must set BZ_UNIX to 0 and BZ_LCCWIN32 to 1, in the ﬁle bzip2.c, before compiling. Otherwise the resulting binary won’t work correctly. I haven’t tried any of this stuff myself, but it all looks plausible.

30

4. Miscellanea
Table of Contents
4.1. 4.2. 4.3. 4.4. 4.5. Limitations of the compressed ﬁle format . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Portability issues . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Reporting bugs ............................................................................ Did you get the right package? .............................................................. Further Reading ........................................................................... 31 32 32 33 34

These are just some random thoughts of mine. Your mileage may vary.

4.1. Limitations of the compressed ﬁle format
bzip2-1.0.X, 0.9.5 and 0.9.0 use exactly the same ﬁle format as the original version, bzip2-0.1. This decision was made in the interests of stability. Creating yet another incompatible compressed ﬁle format would create further confusion and disruption for users. Nevertheless, this is not a painless decision. Development work since the release of bzip2-0.1 in August 1997 has shown complexities in the ﬁle format which slow down decompression and, in retrospect, are unnecessary. These are: • The run-length encoder, which is the ﬁrst of the compression transformations, is entirely irrelevant. The original purpose was to protect the sorting algorithm from the very worst case input: a string of repeated symbols. But algorithm steps Q6a and Q6b in the original Burrows-Wheeler technical report (SRC-124) show how repeats can be handled without difﬁculty in block sorting. • The randomisation mechanism doesn’t really need to be there. Udi Manber and Gene Myers published a sufﬁx array construction algorithm a few years back, which can be employed to sort any block, no matter how repetitive, in O(N log N) time. Subsequent work by Kunihiko Sadakane has produced a derivative O(N (log N)^2) algorithm which usually outperforms the Manber-Myers algorithm. I could have changed to Sadakane’s algorithm, but I ﬁnd it to be slower than bzip2’s existing algorithm for most inputs, and the randomisation mechanism protects adequately against bad cases. I didn’t think it was a good tradeoff to make. Partly this is due to the fact that I was not ﬂooded with email complaints about bzip2-0.1’s performance on repetitive data, so perhaps it isn’t a problem for real inputs. Probably the best long-term solution, and the one I have incorporated into 0.9.5 and above, is to use the existing sorting algorithm initially, and fall back to a O(N (log N)^2) algorithm if the standard algorithm gets into difﬁculties. • The compressed ﬁle format was never designed to be handled by a library, and I have had to jump though some hoops to produce an efﬁcient implementation of decompression. It’s a bit hairy. Try passing decompress.c through the C preprocessor and you’ll see what I mean. Much of this complexity could have been avoided if the compressed size of each block of data was recorded in the data stream. • An Adler-32 checksum, rather than a CRC32 checksum, would be faster to compute. It would be fair to say that the bzip2 format was frozen before I properly and fully understood the performance consequences of doing so. Improvements which I was able to incorporate into 0.9.0, despite using the same ﬁle format, are:

31

Miscellanea

• Single array implementation of the inverse BWT. This signiﬁcantly speeds up decompression, presumably because it reduces the number of cache misses. • Faster inverse MTF transform for large MTF values. The new implementation is based on the notion of sliding blocks of values. • bzip2-0.9.0 now reads and writes ﬁles with fread and fwrite; version 0.1 used putc and getc. Duh! Well, you live and learn. Further ahead, it would be nice to be able to do random access into ﬁles. This will require some careful design of compressed ﬁle formats.

4.2. Portability issues
After some consideration, I have decided not to use GNU autoconf to conﬁgure 0.9.5 or 1.0. autoconf, admirable and wonderful though it is, mainly assists with portability problems between Unix-like platforms. But bzip2 doesn’t have much in the way of portability problems on Unix; most of the difﬁculties appear when porting to the Mac, or to Microsoft’s operating systems. autoconf doesn’t help in those cases, and brings in a whole load of new complexity. Most people should be able to compile the library and program under Unix straight out-of-the-box, so to speak, especially if you have a version of GNU C available. There are a couple of __inline__ directives in the code. GNU C (gcc) should be able to handle them. If you’re not using GNU C, your C compiler shouldn’t see them at all. If your compiler does, for some reason, see them and doesn’t like them, just #define __inline__ to be /* */. One easy way to do this is to compile with the ﬂag -D__inline__=, which should be understood by most Unix compilers. If you still have difﬁculties, try compiling with the macro BZ_STRICT_ANSI deﬁned. This should enable you to build the library in a strictly ANSI compliant environment. Building the program itself like this is dangerous and not supported, since you remove bzip2’s checks against compressing directories, symbolic links, devices, and other not-really-a-ﬁle entities. This could cause ﬁlesystem corruption! One other thing: if you create a bzip2 binary for public distribution, please consider linking it statically (gcc -static). This avoids all sorts of library-version issues that others may encounter later on. If you build bzip2 on Win32, you must set BZ_UNIX to 0 and BZ_LCCWIN32 to 1, in the ﬁle bzip2.c, before compiling. Otherwise the resulting binary won’t work correctly.

4.3. Reporting bugs
I tried pretty hard to make sure bzip2 is bug free, both by design and by testing. Hopefully you’ll never need to read this section for real. Nevertheless, if bzip2 dies with a segmentation fault, a bus error or an internal assertion failure, it will ask you to email me a bug report. Experience from years of feedback of bzip2 users indicates that almost all these problems can be traced to either compiler bugs or hardware problems.

32

Miscellanea

• Recompile the program with no optimisation, and see if it works. And/or try a different compiler. I heard all sorts of stories about various ﬂavours of GNU C (and other compilers) generating bad code for bzip2, and I’ve run across two such examples myself. 2.7.X versions of GNU C are known to generate bad code from time to time, at high optimisation levels. If you get problems, try using the ﬂags -O2 -fomit-frame-pointer -fno-strength-reduce. You should speciﬁcally not use -funroll-loops. You may notice that the Makeﬁle runs six tests as part of the build process. If the program passes all of these, it’s a pretty good (but not 100%) indication that the compiler has done its job correctly. • If bzip2 crashes randomly, and the crashes are not repeatable, you may have a ﬂaky memory subsystem. bzip2 really hammers your memory hierarchy, and if it’s a bit marginal, you may get these problems. Ditto if your disk or I/O subsystem is slowly failing. Yup, this really does happen. Try using a different machine of the same type, and see if you can repeat the problem. • This isn’t really a bug, but ... If bzip2 tells you your ﬁle is corrupted on decompression, and you obtained the ﬁle via FTP, there is a possibility that you forgot to tell FTP to do a binary mode transfer. That absolutely will cause the ﬁle to be non-decompressible. You’ll have to transfer it again. If you’ve incorporated libbzip2 into your own program and are getting problems, please, please, please, check that the parameters you are passing in calls to the library, are correct, and in accordance with what the documentation says is allowable. I have tried to make the library robust against such problems, but I’m sure I haven’t succeeded. Finally, if the above comments don’t help, you’ll have to send me a bug report. Now, it’s just amazing how many people will send me a bug report saying something like: bzip2 crashed with segmentation fault on my machine

and absolutely nothing else. Needless to say, a such a report is totally, utterly, completely and comprehensively 100% useless; a waste of your time, my time, and net bandwidth. With no details at all, there’s no way I can possibly begin to ﬁgure out what the problem is. The rules of the game are: facts, facts, facts. Don’t omit them because ""oh, they won’t be relevant"". At the bare minimum: Machine type. Operating system version. Exact version of bzip2 (do bzip2 -V). Exact version of the compiler used. Flags passed to the compiler.

However, the most important single thing that will help me is the ﬁle that you were trying to compress or decompress at the time the problem happened. Without that, my ability to do anything more than speculate about the cause, is limited.

4.4. Did you get the right package?
bzip2 is a resource hog. It soaks up large amounts of CPU cycles and memory. Also, it gives very large latencies. In the worst case, you can feed many megabytes of uncompressed data into the library before getting any compressed output, so this probably rules out applications requiring interactive behaviour. These aren’t faults of my implementation, I hope, but more an intrinsic property of the Burrows-Wheeler transform (unfortunately). Maybe this isn’t what you want.

33

Miscellanea

If you want a compressor and/or library which is faster, uses less memory but gets pretty good compression, and has minimal latency, consider Jean-loup Gailly’s and Mark Adler’s work, zlib-1.2.1 and gzip-1.2.4. Look for them at http://www.zlib.org and http://www.gzip.org respectively. For something faster and lighter still, you might try Markus F X J Oberhumer’s LZO real-time compression/decompression library, at http://www.oberhumer.com/opensource.

4.5. Further Reading
bzip2 is not research work, in the sense that it doesn’t present any new ideas. Rather, it’s an engineering exercise based on existing ideas. Four documents describe essentially all the ideas behind bzip2: Michael Burrows and D. J. Wheeler: ""A block-sorting lossless data compression algorithm"" 10th May 1994. Digital SRC Research Report 124. ftp://ftp.digital.com/pub/DEC/SRC/research-reports/SRC-124.ps.gz If you have trouble finding it, try searching at the New Zealand Digital Library, http://www.nzdl.org. Daniel S. Hirschberg and Debra A. LeLewer ""Efficient Decoding of Prefix Codes"" Communications of the ACM, April 1990, Vol 33, Number 4. You might be able to get an electronic copy of this from the ACM Digital Library. David J. Wheeler Program bred3.c and accompanying document bred3.ps. This contains the idea behind the multi-table Huffman coding scheme. ftp://ftp.cl.cam.ac.uk/users/djw3/ Jon L. Bentley and Robert Sedgewick ""Fast Algorithms for Sorting and Searching Strings"" Available from Sedgewick’s web page, www.cs.princeton.edu/~rs

The following paper gives valuable additional insights into the algorithm, but is not immediately the basis of any code used in bzip2. Peter Fenwick: Block Sorting Text Compression Proceedings of the 19th Australasian Computer Science Conference, Melbourne, Australia. Jan 31 - Feb 2, 1996. ftp://ftp.cs.auckland.ac.nz/pub/peter-f/ACSC96paper.ps

Kunihiko Sadakane’s sorting algorithm, mentioned above, is available from: http://naomi.is.s.u-tokyo.ac.jp/~sada/papers/Sada98b.ps.gz

34

Miscellanea

The Manber-Myers sufﬁx array construction algorithm is described in a paper available from: http://www.cs.arizona.edu/people/gene/PAPERS/suffix.ps

Finally, the following papers document some investigations I made into the performance of sorting and decompression algorithms: Julian Seward On the Performance of BWT Sorting Algorithms Proceedings of the IEEE Data Compression Conference 2000 Snowbird, Utah. 28-30 March 2000. Julian Seward Space-time Tradeoffs in the Inverse B-W Transform Proceedings of the IEEE Data Compression Conference 2001 Snowbird, Utah. 27-29 March 2001.

35

</pre>
</body>
</html>
",False,
197,203,NomosTestfiles/BSD/New-BSD_ref_a.txt,BSD-3-Clause,"Code in:
lib/protobuf-java.jar

Protocol Buffers
URL: http://code.google.com/p/protobuf/
Version: 2.3.0
License: New BSD License

Description: Supporting libraries for protocol buffers,
an encoding of structured data.

Local Modifications: None
",False,"```
License: New BSD License
```"
198,204,NomosTestfiles/BSD/podd.h,SSLeay,"/* crypto/des/podd.h */
/* Copyright (C) 1995-1997 Eric Young (eay@mincom.oz.au)
 * All rights reserved.
 *
 * This package is an SSL implementation written
 * by Eric Young (eay@mincom.oz.au).
 * The implementation was written so as to conform with Netscapes SSL.
 * 
 * This library is free for commercial and non-commercial use as long as
 * the following conditions are aheared to.  The following conditions
 * apply to all code found in this distribution, be it the RC4, RSA,
 * lhash, DES, etc., code; not just the SSL code.  The SSL documentation
 * included with this distribution is covered by the same copyright terms
 * except that the holder is Tim Hudson (tjh@mincom.oz.au).
 * 
 * Copyright remains Eric Young's, and as such any Copyright notices in
 * the code are not to be removed.
 * If this package is used in a product, Eric Young should be given attribution
 * as the author of the parts of the library used.
 * This can be in the form of a textual message at program startup or
 * in documentation (online or textual) provided with the package.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *    ""This product includes cryptographic software written by
 *     Eric Young (eay@mincom.oz.au)""
 *    The word 'cryptographic' can be left out if the rouines from the library
 *    being used are not cryptographic related :-).
 * 4. If you include any Windows specific code (or a derivative thereof) from 
 *    the apps directory (application code) you must include an acknowledgement:
 *    ""This product includes software written by Tim Hudson (tjh@mincom.oz.au)""
 * 
 * THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 * 
 * The licence and distribution terms for any publically available version or
 * derivative of this code cannot be changed.  i.e. this code cannot simply be
 * copied and put under another distribution licence
 * [including the GNU Public Licence.]
 */

static const unsigned char odd_parity[256]={
  1,  1,  2,  2,  4,  4,  7,  7,  8,  8, 11, 11, 13, 13, 14, 14,
 16, 16, 19, 19, 21, 21, 22, 22, 25, 25, 26, 26, 28, 28, 31, 31,
 32, 32, 35, 35, 37, 37, 38, 38, 41, 41, 42, 42, 44, 44, 47, 47,
 49, 49, 50, 50, 52, 52, 55, 55, 56, 56, 59, 59, 61, 61, 62, 62,
 64, 64, 67, 67, 69, 69, 70, 70, 73, 73, 74, 74, 76, 76, 79, 79,
 81, 81, 82, 82, 84, 84, 87, 87, 88, 88, 91, 91, 93, 93, 94, 94,
 97, 97, 98, 98,100,100,103,103,104,104,107,107,109,109,110,110,
112,112,115,115,117,117,118,118,121,121,122,122,124,124,127,127,
128,128,131,131,133,133,134,134,137,137,138,138,140,140,143,143,
145,145,146,146,148,148,151,151,152,152,155,155,157,157,158,158,
161,161,162,162,164,164,167,167,168,168,171,171,173,173,174,174,
176,176,179,179,181,181,182,182,185,185,186,186,188,188,191,191,
193,193,194,194,196,196,199,199,200,200,203,203,205,205,206,206,
208,208,211,211,213,213,214,214,217,217,218,218,220,220,223,223,
224,224,227,227,229,229,230,230,233,233,234,234,236,236,239,239,
241,241,242,242,244,244,247,247,248,248,251,251,253,253,254,254};
",False,"```
/* Copyright (C) 1995-1997 Eric Young (eay@mincom.oz.au)
 * All rights reserved.
 *
 * This package is an SSL implementation written
 * by Eric Young (eay@mincom.oz.au).
 * The implementation was written so as to conform with Netscapes SSL.
 * 
 * This library is free for commercial and non-commercial use as long as
 * the following conditions are aheared to.  The following conditions
 * apply to all code found in this distribution, be it the RC4, RSA,
 * lhash, DES, etc., code; not just the SSL code.  The SSL documentation
 * included with this distribution is covered by the same copyright terms
 * except that the holder is Tim Hudson (tjh@mincom.oz.au).
 * 
 * Copyright remains Eric Young's, and as such any Copyright notices in
 * the code are not to be removed.
 * If this package is used in a product, Eric Young should be given attribution
 * as the author of the parts of the library used.
 * This can be in the form of a textual message at program startup or
 * in documentation (online or textual) provided with the package.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *    ""This product includes cryptographic software written by
 *     Eric Young (eay@mincom.oz.au)""
 *    The word 'cryptographic' can be left out if the rouines from the library
 *    being used are not cryptographic related :-).
 * 4. If you include any Windows specific code (or a derivative thereof) from 
 *    the apps directory (application code) you must include an acknowledgement:
 *    ""This product includes software written by Tim Hudson (tjh@mincom.oz.au)""
 * 
 * THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 * 
 * The licence and distribution terms for any publically available version or
 * derivative of this code cannot be changed.  i.e. this code cannot simply be
 * copied and put under another distribution licence
 * [including the GNU Public Licence.]
 */
```"
199,205,NomosTestfiles/BSD/purdue.txt,Purdue,"/*
* Copyright 2002 Purdue Research Foundation, West Lafayette,
* Indiana 47907. All rights reserved.
*
* Written by Victor A. Abell
*
* This software is not subject to any license of the American
* Telephone and Telegraph Company or the Regents of the
* University of California.
*
* Permission is granted to anyone to use this software for
* any purpose on any computer system, and to alter it and
* redistribute it freely, subject to the following
* restrictions:
*
* 1. Neither the authors nor Purdue University are responsible
* for any consequences of the use of this software.
*
* 2. The origin of this software must not be misrepresented,
* either by explicit claim or by omission. Credit to the
* authors and Purdue University must appear in documentation
* and sources.
*
* 3. Altered versions must be plainly marked as such, and must
* not be misrepresented as being the original software.
*
* 4. This notice may not be removed or altered.
*/
",False,"```
* Copyright 2002 Purdue Research Foundation, West Lafayette,
* Indiana 47907. All rights reserved.
*
* Written by Victor A. Abell
*
* This software is not subject to any license of the American
* Telephone and Telegraph Company or the Regents of the
* University of California.
*
* Permission is granted to anyone to use this software for
* any purpose on any computer system, and to alter it and
* redistribute it freely, subject to the following
* restrictions:
*
* 1. Neither the authors nor Purdue University are responsible
* for any consequences of the use of this software.
*
* 2. The origin of this software must not be misrepresented,
* either by explicit claim or by omission. Credit to the
* authors and Purdue University must appear in documentation
* and sources.
*
* 3. Altered versions must be plainly marked as such, and must
* not be misrepresented as being the original software.
*
* 4. This notice may not be removed or altered.
```"
